{"pageProps":{"postData":{"id":"TheHackersLabsTHLPWN","contentHtml":"<h1>THLPWN</h1>\n<blockquote>\n<p><a href=\"https://labs.thehackerslabs.com/machine/141\">https://labs.thehackerslabs.com/machine/141</a></p>\n</blockquote>\n<p><img src=\"/post-images/TheHackersLabsTHLPWN/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<h3>PortScan</h3>\n<pre><code class=\"hljs language-python\">➜  THLPWN nmap -sT -<span class=\"hljs-built_in\">min</span>-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.131</span>  \nStarting Nmap <span class=\"hljs-number\">7.95</span> ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">10</span>-<span class=\"hljs-number\">27</span> <span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">59</span> CST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.131</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.0023</span>s latency).\nNot shown: <span class=\"hljs-number\">65531</span> filtered tcp ports (no-response)\nPORT    STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp  <span class=\"hljs-built_in\">open</span>  ssh\n<span class=\"hljs-number\">25</span>/tcp  <span class=\"hljs-built_in\">open</span>  smtp\n<span class=\"hljs-number\">80</span>/tcp  <span class=\"hljs-built_in\">open</span>  http\n<span class=\"hljs-number\">110</span>/tcp <span class=\"hljs-built_in\">open</span>  pop3\n\nNmap done: <span class=\"hljs-number\">1</span> IP address (<span class=\"hljs-number\">1</span> host up) scanned <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">26.38</span> seconds\n</code></pre>\n<pre><code class=\"hljs language-python\">➜  THLPWN nmap -sT -A -p <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">25</span>,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">110</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.131</span>      \nStarting Nmap <span class=\"hljs-number\">7.95</span> ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">10</span>-<span class=\"hljs-number\">27</span> <span class=\"hljs-number\">23</span>:01 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.131</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00060</span>s latency).\n\nPORT    STATE SERVICE    VERSION\n<span class=\"hljs-number\">22</span>/tcp  <span class=\"hljs-built_in\">open</span>  ssh        OpenSSH <span class=\"hljs-number\">9.2</span>p1 Debian <span class=\"hljs-number\">2</span>+deb12u7 (protocol <span class=\"hljs-number\">2.0</span>)\n| ssh-hostkey: \n|   <span class=\"hljs-number\">256</span> af:<span class=\"hljs-number\">79</span>:a1:<span class=\"hljs-number\">39</span>:<span class=\"hljs-number\">80</span>:<span class=\"hljs-number\">45</span>:fb:b7:cb:<span class=\"hljs-number\">86</span>:fd:8b:<span class=\"hljs-number\">62</span>:<span class=\"hljs-number\">69</span>:4a:<span class=\"hljs-number\">64</span> (ECDSA)\n|_  <span class=\"hljs-number\">256</span> 6d:d4:9d:ac:0b:f0:a1:<span class=\"hljs-number\">88</span>:<span class=\"hljs-number\">66</span>:b4:ff:f6:<span class=\"hljs-number\">42</span>:bb:f2:e5 (ED25519)\n<span class=\"hljs-number\">25</span>/tcp  <span class=\"hljs-built_in\">open</span>  tcpwrapped\n|_smtp-commands: Couldn<span class=\"hljs-string\">'t establish connection on port 25\n80/tcp  open  http       nginx 1.22.1\n|_http-title: 403 Forbidden\n|_http-server-header: nginx/1.22.1\n110/tcp open  tcpwrapped\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: WAP|general purpose\nRunning: Actiontec embedded, Linux 2.4.X\nOS CPE: cpe:/h:actiontec:mi424wr-gen3i cpe:/o:linux:linux_kernel cpe:/o:linux:linux_kernel:2.4.37\nOS details: Actiontec MI424WR-GEN3I WAP, DD-WRT v24-sp2 (Linux 2.4.37)\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT     ADDRESS\n1   0.24 ms 192.168.111.2\n2   0.57 ms 192.168.56.131\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 53.40 seconds\n</span></code></pre>\n<h3>枚举</h3>\n<p>看来还运行着邮件服务</p>\n<p><img src=\"/post-images/TheHackersLabsTHLPWN/image1.png\" alt=\"image.png\"></p>\n<p>我们根据 <code>thl</code> 的默认规则即可访问</p>\n<p><img src=\"/post-images/TheHackersLabsTHLPWN/image2.png\" alt=\"image.png\"></p>\n<p>一番摸索后在网站下载页面中能下载到一个 ELF 文件</p>\n<p><img src=\"/post-images/TheHackersLabsTHLPWN/image3.png\" alt=\"image.png\"></p>\n<p>通过 <code>strings</code> 可以拿到疑似用户的账户密码</p>\n<p><img src=\"/post-images/TheHackersLabsTHLPWN/image4.png\" alt=\"image.png\"></p>\n<p>通过凭据 <code>thluser:9Kx7mP2wQ5nL8vT4bR6zY</code> 成功进入后台</p>\n<p><img src=\"/post-images/TheHackersLabsTHLPWN/image5.png\" alt=\"image.png\"></p>\n<p>读取 <code>user.txt</code></p>\n<pre><code class=\"hljs language-python\">thluser@thlpwn:~$ cat flag.txt \nTxxxxxxxxxxxxxxxxxxxxxxH}\n</code></pre>\n<h2>提权</h2>\n<p>查看 sudo 权限，666</p>\n<pre><code class=\"hljs language-python\">thluser@thlpwn:~$ sudo -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> thluser on thlpwn:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/<span class=\"hljs-built_in\">bin</span>\\:/usr/sbin\\:/usr/<span class=\"hljs-built_in\">bin</span>\\:/sbin\\:/<span class=\"hljs-built_in\">bin</span>, use_pty\n\nUser thluser may run the following commands on thlpwn:\n    (ALL) NOPASSWD: /<span class=\"hljs-built_in\">bin</span>/bash\n</code></pre>\n<p>直接 <code>root</code> 了</p>\n<pre><code class=\"hljs language-python\">thluser@thlpwn:~$ sudo /<span class=\"hljs-built_in\">bin</span>/bash -p\nroot@thlpwn:/home/thluser<span class=\"hljs-comment\"># </span>\n</code></pre>\n<p>我真没招了。。。</p>\n<p><img src=\"/post-images/TheHackersLabsTHLPWN/image6.png\" alt=\"image.png\"></p>","title":"TheHackersLabs - THLPWN","date":"2025-10-27","updated":"2025-10-27","tags":["TheHackersLabs","Linux","PWN"],"categories":"靶机","comments":true,"description":"THLPWN https://labs.thehackerslabs.com/machine/141 Recon PortScan 枚举 看来还运行着邮件服务 我们根据 thl 的默认规则即可访问 一番摸索后在网站下载页面中能下载到一个 ELF 文件 通过 strings 可以拿到疑似用户的账户密码..."},"recentPosts":[{"id":"TheHackersLabsLuna","title":"TheHackersLabs - Luna","date":"2025-10-28","isEncrypted":false,"year":"2025","month":"10","day":"28"},{"id":"TheHackersLabsTHLPWN","title":"TheHackersLabs - THLPWN","date":"2025-10-27","isEncrypted":false,"year":"2025","month":"10","day":"27"},{"id":"念念碎","title":"念念碎","date":"2025-10-26","isEncrypted":false,"year":"2025","month":"10","day":"26"},{"id":"HackTheBoxSeason9 - Conversor","title":"HackTheBox - Season9 - Conversor","date":"2025-10-26","isEncrypted":true,"year":"2025","month":"10","day":"26"},{"id":"HackMyVMSysadmin","title":"HackMyVM - Sysadmin","date":"2025-10-25","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"HackTheBoxSeason8 - Artificial","title":"HackTheBox - Machine - Artificial","date":"2025-06-28","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"HackTheBoxSeason8 - Puppy","title":"HackTheBox - Machine - Puppy","date":"2025-05-19","isEncrypted":false,"year":"2025","month":"10","day":"25"}]},"__N_SSG":true}