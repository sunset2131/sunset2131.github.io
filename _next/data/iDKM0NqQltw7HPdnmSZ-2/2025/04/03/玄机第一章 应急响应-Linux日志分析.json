{"pageProps":{"postData":{"id":"玄机第一章 应急响应-Linux日志分析","contentHtml":"<h1>第一章 应急响应-Linux日志分析</h1>\n<blockquote>\n<p><a href=\"https://xj.edisec.net/challenges/24\">https://xj.edisec.net/challenges/24</a></p>\n</blockquote>\n<h3>有多少IP在爆破主机ssh的root帐号，如果有多个使用\",\"分割</h3>\n<p><code>ssh</code>登录日志一般存储在<code>auth.log</code>中，那么爆破不应该就是第一次就成功的，那么肯定会存在失败的记录所以直接搜索存在<code>Failed</code>的语句</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-built_in\">cat</span> auth.log.1 | grep -a <span class=\"hljs-string\">\"Failed password for root\"</span> | awk <span class=\"hljs-string\">'{print $11}'</span> | <span class=\"hljs-built_in\">sort</span> | <span class=\"hljs-built_in\">uniq</span> -c\n      4 192.168.200.2\n      1 192.168.200.31\n      1 192.168.200.32\n</code></pre>\n<pre><code class=\"hljs language-bash\">flag{192.168.200.2,192.168.200.31,192.168.200.32}\n</code></pre>\n<h3>ssh爆破成功登陆的IP是多少，如果有多个使用\",\"分割</h3>\n<p>成功是<code>Accept</code></p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-built_in\">cat</span> auth.log.1 | grep -a <span class=\"hljs-string\">\"Accepted\"</span> | awk <span class=\"hljs-string\">'{print $11}'</span> | <span class=\"hljs-built_in\">uniq</span>\n192.168.200.2\n</code></pre>\n<pre><code class=\"hljs language-bash\">flag{192.168.200.2}\n</code></pre>\n<h3>爆破用户名字典是什么？如果有多个使用\",\"分割</h3>\n<p>根据登陆失败的记录来截取</p>\n<p>去掉<code>from</code>因为不是用户名，是语句截取的问题</p>\n<pre><code class=\"hljs language-scheme\">cat auth.log.1 | grep -a \"Failed\" | awk -F 'for invalid user|for' '{print $2}' | awk '{print $1}'| sort |uniq -c | sort -nr\n      6 root\n      5 user\n      5 hello\n      5 from\n      1 test3\n      1 test2\n      1 test1\n</code></pre>\n<p><code>flag</code>很玄学，不知道按什么排序的</p>\n<pre><code class=\"hljs language-bash\">flag{user,hello,root,test3,test2,test1}\n</code></pre>\n<h3>登陆成功的IP共爆破了多少次</h3>\n<p>我们知道成功爆破的ip是<code>192.168.200.2</code></p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-built_in\">cat</span> auth.log.1 | grep -a <span class=\"hljs-string\">\"Failed password for root\"</span> | awk <span class=\"hljs-string\">'{print $11}'</span> | <span class=\"hljs-built_in\">sort</span> | <span class=\"hljs-built_in\">uniq</span> -c\n      4 192.168.200.2\n      1 192.168.200.31\n      1 192.168.200.32\n</code></pre>\n<h3>黑客登陆主机后新建了一个后门用户，用户名是多少</h3>\n<pre><code class=\"hljs language-scheme\">root@ip-10-0-10-1:/var/log# cat auth.log.1 | grep -a \"new user\"\nAug  1 07:50:45 linux-rz useradd[7551]: new user: name=test2, UID=1000, GID=1000, home=/home/test2, shell=/bin/sh\nAug  1 08:18:27 ip-172-31-37-190 useradd[487]: new user: name=debian, UID=1001, GID=1001, home=/home/debian, shell=/bin/bash\n</code></pre>\n<pre><code class=\"hljs language-scheme\">root@ip-10-0-10-1:/var/log# cat /etc/passwd\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\nsystemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\nsystemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\nmessagebus:x:104:105::/nonexistent:/usr/sbin/nologin\nunscd:x:105:109::/var/lib/unscd:/usr/sbin/nologin\nntp:x:106:112::/nonexistent:/usr/sbin/nologin\nsshd:x:107:65534::/run/sshd:/usr/sbin/nologin\nsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\ntest2:x:1000:1000::/home/test2:/bin/sh\ndebian:x:1001:1001:Debian:/home/debian:/bin/bash\n</code></pre>\n<p>明显<code>test2</code></p>","title":"玄机 - 第一章 应急响应-Linux日志分析","date":"2025-04-04","updated":"2025-04-03","comments":true,"tags":["玄机","应急响应","日志分析"],"categories":"靶机","description":"第一章 应急响应-Linux日志分析\n\n https://xj.edisec.net/challenges/24\n \n\n有多少IP在爆破主机ssh的root帐号，如果有多个使用\",\"分割\n\n`ssh`登录日志一般存储在`auth.log`中，那么爆破不应该就是第一次就成功的，那么肯定会存在失败的记录所以直接搜索存在`Failed`的语句\n\n\n\n\n\nssh爆破成功登陆的IP是多少，如果有多个使用\",..."},"recentPosts":[{"id":"HackTheBoxSeason9 - Expressway","title":"HackTheBox - Season9 - Expressway","date":"2025-09-21","isEncrypted":true,"year":"2025","month":"09","day":"21"},{"id":"CyberstrikelabLab4","title":"Cyberstrikelab - Lab4","date":"2025-08-14","isEncrypted":false,"year":"2025","month":"08","day":"14"},{"id":"CyberstrikelabLab3","title":"Cyberstrikelab - Lab3","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"},{"id":"CyberstrikelabLab2","title":"Cyberstrikelab - Lab2","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"},{"id":"CyberstrikelabLab-1","title":"Cyberstrikelab - Lab1","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"},{"id":"HackTheBoxSeason8 - Cobblestone","title":"HackTheBox - Season8 - Cobblestone","date":"2025-08-11","isEncrypted":true,"year":"2025","month":"08","day":"11"},{"id":"TheHackersLabsShadowGate","title":"TheHackersLabs - ShadowGate","date":"2025-08-06","isEncrypted":false,"year":"2025","month":"08","day":"06"}]},"__N_SSG":true}